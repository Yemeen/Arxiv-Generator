                                                A CHARACTER FORMULA FOR REPRESENTATIONS OF
                                               LOOP GROUPS BASED ON NON-SIMPLY CONNECTED LIE
arXiv:math/0211122v3 [math.RT] 14 Jan 2004




                                                                  GROUPS

                                                                               ROBERT WENDT

                                                                             University of Toronto
                                                                          Department of Mathematics
                                                                            100 St. George Street
                                                                          Toronto, Ontario, M5S 3G3
                                                                                   Canada
                                                                      E-mail: rwendt@math.toronto.edu

                                                                              1. Introduction
                                                In this paper we compute characters of certain irreducible representations of
                                             loop groups based on non simply connected Lie groups. Apart from a general
                                             representation theoretic interest, our motivation to study these characters comes
                                             from the fact that they appear naturally in the theory of moduli spaces of semistable
                                             principal bundles over elliptic curves.
                                                The characters of highest weight representations of loop groups based on simply
                                             connected Lie groups are well understood due to the Kac-Weyl character formula:
                                             Let G be a simply connected complex Lie group whose Lie algebra is simple. We
                                             denote by L(G) the group of holomorphic maps from C∗ to G. This group possesses
                                                                            b
                                             a universal central extension L(G)  which, viewed as a manifold, is a non-trivial C∗ -
                                             bundle over L(G). The natural multiplicative action of C∗ on L(G) lifts uniquely to
                                                                 b
                                             an action of C∗ on L(G)   by group automorphisms. Let V be an irreducible highest
                                                                       b
                                             weight representation of L(G).    Such a representation extends to a representation
                                                                         b
                                             of the semidirect product L(G)    ⋊ C∗ . One can show that for any q with |q| < 1,
                                                                   b
                                             the element (g, q) ∈ L(G)  ⋊ C∗ viewed as an operator on V extends to a trace class
                                             operator on the Hilbert space completion of V . So one can deﬁne the character
                                             χV of V at a point (g, q) with |q| < 1 as the trace of the operator (g, q). This
                                             deﬁnes a holomorphic and conjugacy-invariant function on the space L(G)  b     × D∗ ,
                                                       ∗
                                             where D denotes the punctured unit disk in C. The Kac-Weyl character formula
                                             gives an explicit formula for the character χV restricted to a certain family of tori
                                                b
                                             in L(G)  ⋊ D∗ in terms of theta functions. This is enough to describe the character
                                                                                                 b
                                             completely since almost every conjugacy class in L(G)     × D∗ intersects this family
                                             of tori.
                                                If the group G is not simply connected, the loop group L(G) consists of several
                                             connected components which are labeled by the fundamental group of G. In this
                                             case, central extensions of L(G) have been constructed in [T]. We will review
                                             this construction in section 2. Let L(G)b    denote such a central extension. The
                                                                 ∗                          b
                                             natural action of C on L(G) does not lift to L(G).                              e ∗ of
                                                                                                   Instead, a ﬁnite covering C

                                               Date: September 4, 2017.
                                                                                       1
2                                        R. WENDT


              b
C∗ acts on L(G)      covering the natural C∗ -action on L(G). So similar to the simply
connected case, we can consider the semidirect product L(G)⋊   b       e ∗ . We are interested
                                                                       C
                         b
in representations of L(G)     ⋊C e ∗ which, restricted to the connected component of
b       e ∗
L(G)⋊ C containing the identity, decompose into a direct sum of irreducible highest
weight representations. These representations have been classiﬁed in [T]. Let V
be such a representation. For qe ∈ C      e ∗ , let q denote the image under the natural
projection C  e ∗ → C∗ . As in the simply connected case, one shows that any (g, qe) ∈
b         e ∗
L(G) ⋊ C with |q| < 1 extends to a trace class operator on the Hilbert space
completion of V . Thus, one can deﬁne the character χV of the representation V
exactly as in the simply connected case.
   The main goal of this paper is to give an explicit formula for the character χV
restricted to the connected components of L(G)       b    ⋊Ce ∗ which do not contain the
identity element. This gives a generalization of the Kac-Weyl character formula.
While the usual approach to the Kac-Weyl formula is rather algebraic, we work
in a completely geometric setting. In particular, we identify the characters with
sections in certain line bundles over an Abelian variety. To do this, we have to realize
the set of semisimple conjugacy classes in a connected component of L(G)          b       ⋊D e∗
as the total space of a line bundle over a family of Abelian varieties over D∗ .
Then we show that the characters have to satisfy a certain diﬀerential equation.
In the simply connected case, the diﬀerential equation has been derived in [EK].
Our main step is a generalization of this equation to the non-simply connected
case. Finally, we use the diﬀerential equation to obtain an explicit formula for the
character χV . In the simply connected case, this gives an easy proof of the Kac-
Weyl character formula which is similar to Weyl’s original proof of his character
formula for compact Lie groups. In the non-simply connected case, we obtain
a formula for the characters which very much resembles the Kac-Weyl character
formula (Theorem 5.5). The main diﬀerence is that the character restricted to a
connected component of L(G)  b     ⋊C e ∗ not containing the identity is not governed by
the root system ∆   e of the the Lie algebra of L(G) b    ⋊C e ∗ but by a new root system
e                                        e
∆σc which can be obtained from ∆ by a ”folding” process. It is interesting to
note that the Lie algebra corresponding to root system ∆         e σc can, in general, not be
realized as a subalgebra of the aﬃne Lie algebra corresponding to ∆.          e In this way,
the situation resembles the case of characters of irreducible representations of non-
connected compact Lie groups [W]. Also, Fuchs et al. [FRS], [FSS] have obtained
similar results calculating the characters of representations of Kac-Moody algebras
twisted by outer automorphisms. These so called ”twining characters” appear in a
conjecture concerning Verlinde formulas for non-simply connected Lie groups [FS].
   Our main motivation for the study of characters of irreducible representations
of loop groups based on non simply connected Lie groups comes from the theory of
moduli spaces of semistable G-bundles on elliptic curves. For a given group G and
an elliptic curve Eq = C∗ /q Z with q ∈ D∗ , the moduli space of semistable G-bundles
over Eq consists of several connected components which are labeled by the elements
of the fundamental group of G. The knowledge of the characters of L(G)⋊      b       e ∗ allows
                                                                                     C
to construct an analogue of a Steinberg cross section in each connected component
    b
of L(G)  × {e  q} for any qe ∈ C∗ such that q ∈ D∗ (see e.g. [Br] for the construction
of a Steinberg cross section in loop groups based on simply connected Lie groups
and [M] for the case of non-connected semisimple algebraic groups). It turns out
that there is a natural action of C∗ on this cross section, and that the space of
                               CHARACTER FORMULA                                    3


orbits of this action is isomorphic to the connected component of the moduli space
of semistable G–bundles on Eq which corresponds to a connected component of
b
L(G)  × {eq }. On the other hand, by construction, the cross section can be identiﬁed
with an aﬃne space Cr and the C∗ –action becomes linear in this identiﬁcation. So
the approach outlined above gives a new proof of a result of Friedman and Morgan
[FM2] which states that each component of the moduli space is isomorphic to a
weighted projective space. These ideas will be published elsewhere.
   The organization of this paper is as follows. In section 2, we review the construc-
                            b
tion of central extensions L(G)   of loop groups L(G) based on non simply connected
Lie groups G and describe their representation theory. In section 3 we study cer-
tain conjugacy classes in these groups. In section 4 we identify the characters of the
                    b
representations of L(G)    introduced in section 2 with sections of a line bundle over
a family of Abelian varieties and deduce a diﬀerential equation for these sections.
Finally, in section 5, we put everything together and deduce an explicit formula for
the characters. In particular, in 5.4 we describe how the ”folded” root system ∆  e σc
                                                                          e
appears for these characters. In the appendix we list the root systems ∆σc together
with some other data corresponding to non simply connected Lie groups.

                     2. Affine Lie groups and algebras
2.1. Affine Lie algebras. We begin by recalling some facts from the theory of
aﬃne Lie algebras. Let g be a complex ﬁnite dimensional simple Lie algebra and
let h ⊂ g be a Cartan subalgebra. We denote the root system of g with respect to
h by ∆ and let hR ⊂ h be the real vector space spanned by the co-roots of g.
   The loop algebra L(g) of g is the Lie algebra of holomorphic maps from C∗ to
g. The (untwisted) aﬃne Lie algebra corresponding to g is a certain extension of
L(g). Let us ﬁx some k ∈ C and consider the Lie algebra Le k (g) = Lg ⊕ CC ⊕ CD,
                         e k (g) is given by
where the Lie bracket on L
                                                                   d
                  [C, x(z)] = [C, D] = 0,          [D, x(z)] = z      x(z),
                                                                   dz
and                                            Z
                                          k                 d
              [x(z), y(z)] = [x, y](z) +               h      x(z), y(z)idz · C
                                         2πi   |z|=1       dz
Here [x, y](z) denotes the pointwise commutator of x and y, and h., .i is the nor-
malized invariant bilinear form on g (i.e. the Killing form on g normalized in such
a way that hα, αi = 2 for the long roots α of g). Note that the Lie algebras Le k (g)
are isomorphic for all k 6= 0. However, for diﬀerent k they deﬁne non-equivalent
central extensions of L(g) ⊕ CD. For k = 1, we usually omit the k and denote the
                                      e
corresponding Lie algebra simply by L(g).
                                  e
   If g is simple, the subalgebra L(g)pol = g ⊗ C[z, z −1 ] ⊕ CC ⊕ CD ⊂ L(g)e      of
polynomial loops is an untwisted aﬃne Lie algebra in the sense of [K], and L(g)e
can be viewed as a certain completion of it (see [GW]). The Lie algebra L(g)e pol
                                                             e
has a root space decomposition in the following sense: Set h = h ⊕ CC ⊕ CD and
choose an element δ ∈ (hR ⊕ RC ⊕ RD)∗ dual to D. Then the root system ∆        e of
e pol is given by
L(g)
                 e = {α + nδ | α ∈ ∆, n ∈ Z} ∪ {nδ | n ∈ Z \ 0}
                 ∆
4                                      R. WENDT


and we can write                               M
                               e pol = e
                               L(g)    h⊕             e αe
                                                      L(g)
                                               α  e
                                               e ∈∆
      e αe = gα ⊗ z if α
with L(g)             n
                            e = α + nδ, and gαe = h ⊗ z n if α = nδ.
   The set ∆e is an aﬃne root system. Let Π = {α1 , . . . αl } be a basis of ∆ and
let θ denote the highest root of ∆ with respect to this basis. Then we can deﬁne
e = {α0 = δ − θ, α1 , . . . , αl }, which is a basis of ∆.
Π                                                       e The Dynkin diagram of ∆
                                                                                e is
deﬁned in the usual sense and it turns out that it is the extended Dynkin diagram
corresponding to ∆ (see [K]). The aﬃne root system ∆       e decomposes into
                                    e =∆
                                    ∆  e+ ∪ ∆
                                            e− ,
              e + of positive roots is given by
where the set ∆
                    e + = ∆+ ∪ {α + nδ | α ∈ ∆ ∪ {0}, n > 0} ,
                    ∆
    e − = −∆
and ∆       e +.
                                         e
  By deﬁnition, the set of real roots of L(g) is the set
                            e re = {α + nδ | α ∈ ∆} ⊂ ∆
                            ∆                         e,
                                               e re
and the set of positive real roots is given by ∆     e re e
                                                 + = ∆ ∩ ∆+ .
   Sometimes we will need to consider twisted aﬃne Lie algebras. If the ﬁnite
dimensional Lie algebra g admits an outer automorphism σ of ﬁnite order ord(σ) =
r, one can deﬁne the twisted loop algebra
                                                             2
                   L(g, σ) = {X ∈ L(g) | σ(X(z)) = X(e r πi z)} .
                                    e σ) is constructed in a similar manner as
The corresponding aﬃne Lie algebra L(g,
the untwisted algebra. It has a root space decomposition which is only slightly
more complicated than in the untwisted case (see e.g. [K]).
2.2. Loop groups and affine Lie groups. Let G be a complex simply connected
semisimple Lie group with Lie algebra g and suppose that g is simple. The loop
group L(G) of G is the group of holomorphic maps from C∗ to G with pointwise
multiplication. This is a Lie group with Lie algebra L(g). Let L(G)     b      denote the
                                                                 b
universal central extension of L(G). The central extension L(G) can be deﬁned via
the embedding of L(G) into the “diﬀerentiable loop” group studied by Pressley and
Segal [PS]. Topologically, L(G)  b    is a non-trivial holomorphic principal C∗ -bundle
over L(G). In fact, there exists a central extension L   b k (G) of L(G) for each k ∈ N.
             b k
The group L (G) is called the level k central extension of L(G). Its Lie algebra
is given by Lb k (g) = L e k (g)/CD. The universal central extension is just the level 1
extension of L(G). The group C∗ acts naturally on L(G) by (q ◦ g)(z) = g(q −1 z)
and we can consider the semidirect product L(G) ⋊ C∗ . There is a C∗ -action on
b k (G) which covers the C∗ -action on LG, and we denote the semidirect product
L
b
Lk (G) ⋊ C∗ by L   e k (G). Its Lie algebra is the aﬃne Lie algebra L e k (g) described in
the last section
    Now assume that G is of the form G = G/Z,    e     where Ge is simply connected and
simple, and Z ⊂ G     e is a subgroup of the center of G. e Since the group Z may be
identiﬁed with the fundamental group of G, the loop group L(G) consists of |Z|
connected components. In particular, the connected component of L(G) containing
the identity element is isomorphic to L(G)/Z.  e       We shall now indicate, following
                               CHARACTER FORMULA                                     5


Toledano Laredo [T], how to construct certain central extensions of L(G). We
will ﬁrst consider the group LZ (G) e of holomorphic maps g : C → G       e such that
g(t)g(t + 1)−1 ∈ Z. Identifying the variable z with e2πit , we see that the group
                           e
L(G) is isomorphic to LZ (G)/Z.    Furthermore, the connected component of LZ (G)  e
containing the identity element is isomorphic to L(G).e
   The goal is to construct all central extensions of LZ (G) e and then see which
of these extensions are pullbacks of central extensions of L(G). To this end, let
Te ⊂ G e and T = Te/Z ⊂ G denote maximal tori of G        e and G, and let Λ(Te) =
              ∗ e                             ∗
Homalg grp (C , T ) and Λ(T ) = Homalg grp (C , T ) denote the respective co-character
lattices. Then Λ(T )/Λ(Te) ∼
                           = Z. The lattice Λ(T ) can be identiﬁed with a subgroup
        e by viewing it as a lattice in hR ⊂ h and identifying an element β ∈ Λ(T )
of LZ (G)
with the ”open loop” t 7→ exp(2πitβ). We can deﬁne a subgroup N ⊂ L(G)      e ⋊ Λ(T )
via
                             N = {(λ, λ−1 ) | λ ∈ Λ(Te)}.
Then we have                                  
                               e ∼
                           LZ (G)     e ⋊ Λ(T ) /N .
                                  = L(G)
                              b ) of the lattice Λ(T ) by C∗ . Any such central
   Choose a central extension Λ(T
extension is uniquely determined by a skew-symmetric Z-bilinear form (the com-
mutator map) ω on Λ(T ) which is deﬁned by
                                ω(λ, µ) = λ̂µ̂λ̂−1 µ̂−1 .
                                                       b ). Let L
Here, λ̂ and µ̂ are arbitrary lifts of λ, µ ∈ Λ(T ) to Λ(T      b k (G)
                                                                     e be the central
                 e                            b
extension of L(G) of level k. Suppose that Λ(T ) is a central extension of Λ(T ) such
that its commutator map satisﬁes
(1)            ω(λ, µ) = (−1)khλ,µi for all λ ∈ Λ(Te) and µ ∈ Λ(T ) .
Then one can construct a central extension of LZ (G)  e as follows: The group Λ(T ) ⊂
    e              e
LZ (G) acts on L(G) by conjugation. This action uniquely lifts to an action of
Λ(T ) on the central extension L  b k (G).
                                       e    We can consider the semidirect product
b (G)
L k e ⋊ Λ(T
          b ), where the action of Λ(T  b ) on L b k (G) factors through the action of
Λ(T ). Now, the lattice Λ(Te) is a subgroup of L(G)    e so that the restriction of the
                        e
central extension of L(G) to this lattice yields a central extension Λ( b Te) of Λ(Te).
On the other hand, we can restrict the central extension Λ(T     b ) of Λ(T ) to the
              e
sublattice Λ(T ). The compatibility condition of equation (1) implies in particular
that ω(λ, µ) = (−1)khλ,µi for all λ, µ ∈ Λ(Te). This implies that the two extensions
of Λ(Te) are equivalent ([PS], Proposition 4.8.1). We may therefore consider the
subgroup
                   N      b λ
                   b = {(λ, b−1 ) | λb ∈ Λ(
                                          b Te)} ⊂ L b k (G)
                                                          e ⋊ Λ(T
                                                              b ).
Now, using the full compatibility condition (1), one can check ([T], Proposition
            b is a normal subgroup in L
3.3.1) that N                          b k (G)
                                            e ⋊ Λ(T
                                                b ) . Therefore, the quotient
                                                  
(2)                       b kZ (G)
                          L     e = Lb k (G)
                                          e ⋊ Λ(T
                                               b ) /N b

                              e
is a central extension of LZ (G).
   We then have the following theorem ([T], Theorem 3.2.1 and Proposition 3.3.1).
6                                        R. WENDT


Theorem 2.1. Every central extension of LZ (G)   e is uniquely determined by the
                                                     e and by a commutator map
level k of the corresponding central extension of L(G)
ω deﬁning a central extension of Λ(T ) which satisﬁes the compatibility condition of
                                                          e is the one described in
equation (1). The corresponding central extension of LZ (G)
equation (2).
Remark 2.2. Note that Theorem 2.1 restricts the possible levels at which central
extensions of LZ (G)e can exist. For example, Lh−idi (SL(2, C)) does not posses any
central extensions of odd level. Indeed, we have Λ(Te) = αZ and Λ(T ) = α2 Z
with hα, αi = 2. Now, for odd level, the compatibility requirement of equation (1)
requires ω(α, α2 ) = −1 which is in contradiction to bilinearity and skew-symmetry
of ω.
Definition 2.3. Let kf be the smallest level at which a central extension on LZ (G)e
exists. This kf is called the fundamental level of G. Let kb be the smallest positive
integer such that the restriction of kb h·, ·i to Λ(T ) is integral. kb is called the
fundamental level of G.
   Obviously, for the fundamental level one has kf ∈ {1, 2}. One can show ([T])
that the basic level of G is always a multiple of the fundamental level of G. The
fundamental and basic levels of the simple Lie groups are computed in [T]. We list
the basic levels in the appendix of this paper. Finally, we have ([T], Proposition
3.5.1):

Proposition 2.4. A central extension of LZ (G)         e is a pull-back of a central extension
of L(G) only if its level k is a multiple of the basic level kb of G. Conversely, if kb |k,
the subgroup Z ⊂ L  b k (G)
                         e corresponding to the canonical embedding G          e ֒→ Lb k (G)
                                                                                          e is
                      Z                                                                Z
central and we have
                                L      e ∼
                                 b kZ (G)        b kZ (G)/Z)
                                          = π ∗ (L      e      .

  Let us ﬁx a commutator map ω satisfying the compatibility requirement from
equation (1) for the rest of this paper
    From now on let us assume that Z = hci is a cyclic group. The group C acts natu-
              e by translations. This action factors through an action of C/ord(c)Z.
rally on LZ (G)
We view C/ord(c)Z as an ord(c)-fold covering of C/Z ∼      = C∗ , which we denote by
f∗ . Thus, we can deﬁne the semidirect product LZ (G)
C                                                         e ⋊C  f∗ . The action of C f∗
         e                                                      b k e          e
on LZ (G) described above lifts to any central extension of LZ (G) of LZ (G) ([T],
Proposition 3.4.1). So we can deﬁne the group L   e k (G)
                                                       e =Lb k (G)
                                                                e ⋊C f∗ . Furthermore,
                                                    Z        Z
                                        b (G)
if the level k of the central extension L k e is a multiple of the basic level kb of G,
                                          Z
the group Z = hci is a central subgroup of L e Z (G)
                                                   e and we can deﬁne
                                   e k (G) = L
                                   L         e k (G)/Z
                                                  e    .
                                               Z

   Finally, note that C∗ acts naturally on the loop group L(G). However, contrary
to the simply connected case, this action does not necessarily lift to all central
extensions of L(G). In fact, we have ([T], 3.5.10)
Proposition 2.5. The rotation action of C∗ on L(G) lifts to a central extension
of L(G) of level k if and only if khλ, λi ∈ 2Z for all λ ∈ Λ(T ), i.e. if Λ(T ) endowed
with kh·, ·i is an even lattice.
                                CHARACTER FORMULA                                      7


2.3. The adjoint action of L    e k (G) on its Lie algebra. Suppose as before that
      e
G = G/Z     where Ge is simply connected, and Z = hci is a cyclic subgroup of the
           e
center of G. Consider the centrally extended loop group L      e k (G)
                                                                    e = Lb k (G)
                                                                               e ⋊C  e∗
                                                                 Z          Z
introduced in the last section. Since the center of any Lie group acts trivially in the
adjoint representation, the adjoint action of Le k (G)
                                                    e on its Lie algebra L
                                                                         e k (g) factors
                                                 Z
through LZ (G)e ⋊Cf . The C
                    ∗       f -part acts by translations, so the only interesting part
                             ∗
                      e
is the action of LZ (G). Let ζ be an element of LZ (G).e Then the adjoint action of
      e k
ζ on L (g) is given by ([T] Corollary 3.4.2, [PS])
                                      b
(3) Ad(ζ) : X + aC + bD 7→ ζXζ −1 −      ζ̇ζ −1 +
                                     2πi
                              Z 1
                            k
                       a+          hX(t), ζ −1 (t)ζ̇(t)idt
                           2πi 0
                                       Z 1
                                  kb                                       
                              − 22         hζ −1 (t)ζ̇(t), ζ −1 (t)ζ̇(t)idt C + bD .
                                8π i 0
Here, X is an element of the loop algebra L(g), and ζ̇ denotes the derivative of ζ
with respect to t. Finally, as before, we have identiﬁed C∗ with C/Z by identifying
the coordinate z with e2πit .
   We are interested in the action of a speciﬁc element of σc ∈ LZ (G)   e which is the
product ζc wc of an “open loop” ζc and an element wc ∈ G which are deﬁned as
follows. As before, let θ denote the highest root of g. The set of elements αi ∈ Π
                                                          Pl
which have coeﬃcient mj = 1 in the expansion θ = j=1 mj αj can be identiﬁed
with the non-trivial elements of the center of G.  e Indeed, let {λj } ⊂ h be the dual
                                 ∗
basis corresponding to Π ⊂ h . Then the condition mj = 1 implies that exp(2πiλj )
is an element of the center of G.  e
   Let αc denote the root α which is identiﬁed with the generator c of Z in this
identiﬁcation and let λc ∈ h denote the corresponding fundamental weight of g.
There exists a unique element wc ∈ W which permutes the set Π ∪ {−θ} and maps
−θ to αc (see [T], Proposition 4.1.2). Furthermore, let {eα | α ∈ ∆+ } be a Chevalley
basis of the Borel subalgebra n ⊂ g. Then we can choose a representative w̄c of wc
in N (T ) such that w̄c (eα ) = ewc (α) for all α ∈ Π. From now on, we will denote
both the Weyl group element wc as well as its representative w̄c ∈ NG (T ) simply
by wc . Finally, we can deﬁne an “open loop” ζc in G via ζc (t) = exp(2πitλc ). Now,
the element σc is deﬁned as
                                       σc = ζc−1 wc .
   The action of σc on L  e k (g) can be described explicitly in terms of the root space
decomposition: To each root α of g choose a co-root hα ∈ h. Set hα0 = h−θ + kC.
Since hλc , αc i = 1 and hλc , αi = 0 for all α ∈ Π with α 6= αc , we ﬁnd that the ation
of σc on eh is given by
                                                 k
                                 D 7→ D + λc − kλc k2 C ,
                                                 2
                         hα0 7→ hαc , hwc−1 (−θ) 7→ hα0 , and
                           hαi 7→ hwc (αi )   for all other i .
                           e pol is given by the set {eαe , fαe | α ∈ Π}
A set of generators for L(g)                                          e with eαe = eαi ⊗1
                                                                                i
for 1 ≤ i ≤ l and eαe 0 = e−θ ⊗ z, and accordingly fαe i = fαi ⊗ 1 for 1 ≤ i ≤ l and
fαe 0 = f−θ ⊗ z −1 . It is straight forward to check that σc permutes the eαe i according
to its action on Π e and similarly for the fαe .
                                                i
8                                     R. WENDT


2.4. Integrable representations and characters. As before, let θ denote the
highest root of g and ﬁx some non-negative integer k ∈ Z≥0 . Let P+ be the set of
dominant weights of g with respect to Π, and let P+k denote the set of λ ∈ P+ such
that hλ, θi ≤ k. To each pair (λ, k) with λ ∈ P+k , we can associate an irreducible
                                b pol such that the center of ĝ acts as the scalar k
highest weight module Vλ,k of L(g)
(see [K]). Letting D act on the highest weight vector of Vλ,k as an arbitrary scalar
uniquely determines an irreducible highest weight representation of L(g)e pol . We
will denote by Vλ,k the highest weight representation of L(g)e pol such that D acts
trivially on the highest weight vector.
   It was shown by H. Garland [G] that Vλ,k admits a positive deﬁnite Hermitian
form (., .) which is contravariant with respect to the anti-linear Cartan involution
    g . Let us denote by V ss the L2 -completion of Vλ,k with respect to this
on L(g)  pol                     λ,k
norm deﬁned by the Hermitian form. That is, if {vλkµi }i∈I(λ) is an orthonormal
basis of the weight subspace Vλ,k [µ] of Vλ,k , then
                              nX                X             o
                        ss
                       Vλ,k =      aµi vλkµi |     |aµi |2 < ∞ .
                                µ,i            µ,i

Analogously, we deﬁne the analytic completion of Vλ,k to be the space
       nX                                                                   o
  an
Vλ,k =       aµi vλkµi | there exists a 0 < q < 1 s.t. aµi = O q −D(µ) , µ → ∞ ,
          µ,i

where D(µ) denotes the (non-positive) degree of the weight µ in the homogeneous
                          ss                           an
grading. By deﬁnition, Vλ,k   is a Hilbert space and Vλ,k is a dense subspace in it. It
is known ([GW], [EFK]), that the action of L(g)e pol on Vλ,k extends by continuity
                e
to an action of L(g)       an
                     on Vλ,k                               ss
                               , but not to an action on Vλ,k .
   We now turn to the representation theory of the aﬃne Lie groups. We ﬁrst
consider the case that the corresponding ﬁnite dimensional Lie group is simply
connected. In this case, the following result is known (see e.g. [EFK], Theorem 2.2
and Lemma 2.3).
Theorem 2.6.
                                     b
   (i) The action of the Lie algebra L(g)       an
                                           on Vλ,k uniquely integrates to an action
          b
       of L(G).
                                                 b
  (ii) For any q ∈ C∗ with |q| < 1 and any g ∈ L(G),   the operator gq −D : Vλ,k
                                                                              an
                                                                                 →
         an                                                 ss
       Vλ,k uniquely extends to a trace class operator on Vλ,k .
                             e
   Let q ∈ C∗ and denote by L(G)                   e
                                  q the subset of L(G) of elements of the form (g, q)
          b                                                      e
with g ∈ L(G). This subset is invariant under conjugation in L(G).     Furthermore,
                                e
let us introduce the semigroup L(G)    <1 = ∪|q|<1
                                                   e
                                                   L(G)q . As a manifold,  e
                                                                           L(G) <1 is
               b         ∗           ∗
isomorphic to L(G) × D , where D denotes the punctured unit disk in C. Since
                e
any element in L(G)                                             ss
                     <1 extends to a trace class operator on Vλ,k , we can introduce
                 e
functions χλ,k : L(G)<1 → C via
                                                      −D
                                               an (gq
                            χλ,k (g, q) = T r|Vλ,k       ).
The function χλ,k is the character of the module Vλ,k .
Proposition 2.7 ([EFK], Lemma 2.4, Proposition 2.5). The functions χλ,k are
holomorphic and conjugacy invariant.
                                CHARACTER FORMULA                                     9


                                           e
   By deﬁnition, the central element C of L(g)              an
                                                 acts on Vλ,k  by scalar multiplication
                               b
with k. Therefore, if ι : C → L(G) denotes the identiﬁcation of C∗ with the center
                           ∗

   b
of L(G), we have χλ,k (ι(u)g) = uk χλ,k (g) for all u ∈ C∗ .
   Now let G = G/Z e     be non simply connected and let us ﬁx once and for all a
central extension L b Z (G)
                         e of LZ (G)
                                  e of level kf . Suppose that V is an irreducible
                    b    e
representation of LZ (G) of level k. Then k is necessarily a multiple of kf . Re-
stricting this representation to the connected component of Lb Z (G)
                                                                  e containing the
                                                    b G).
identity element yields a level k representation of L( e We shall always assume
that we can decompose V as
                                         M
(4)                               V ∼=           an
                                              Vλ,k
                                              k
                                         λ∈I⊂P+

                       b G).
as a representation of L( e Such representations are called negative energy repre-
              b   e
sentations of LZ (G).
   Remember the automorphism σc introduced in the last section. As we have seen,
σc acts as an automorphism of the Dynkin diagram of L(g)  e pol . So, σc permutes
          k                              b
the set P+ of level k-representations of L(g)pol . The following Theorem is essen-
tially Theorem 6.1 and Corollary 7.3. of [T] (note that [T] deals with projective
representations).
Theorem 2.8. Let k be a multiple of the fundamental level of G. To each σc -orbit
I ⊂ P+k there exist ord(c)/|I| diﬀerent irreducible negative energy representations
   b Z (G)
of L    e which, restricted to a representation of L(  b G)
                                                          e decompose according to
equation (4).
                            b Z (G)
   A representation VI,k of L    e factors through a representation of L
                                                                       b kb (G) if and
only if the level k is a multiple of the basic level kb of G and Z acts trivially on
VI,k .
   Suppose that the σc –orbit I consists of a single element λ. Then σc acts on
the highest weight subspace Vλ [λ]. Since Vλ [λ] is one–dimensional, σc acts by a
scalar. From now on, we shall assume that σc acts as the identity on Vλ [λ]. This
determines the L  b Z (G)–module
                       e         VI,k corresponding to I and k uniquely.
   Finally, letting D act trivially on all highest weight vectors vλ,k ∈ VI,k , we can
extend the representation VI,k of Lb Z (G)
                                        e to a representation of Le Z (G)
                                                                       e =L  b Z (G)⋊
                                                                                  e C f∗
                                             e
which factors through a representation of L(G) if Z acts trivially on VI,k and kb |k.
(Recall that Cf∗ denotes the ord(c)-fold covering of C∗ which acts on L b Z (G)
                                                                             e covering
              f∗                                    f ∗
the natural C -action on LZ (G)). For any qe ∈ C , let us denote by q its image
under the natural projection C f∗ → C∗ .
   It is easy to see that σc acts as a unitary operator in VI,k . So we have
                                                                   f∗ with |q| < 1
Corollary 2.9. Let k be a multiple of kf (resp. kb ). For any qe ∈ C
              b   e               b
and any g ∈ LZ (G) (resp. g ∈ L(G)), the operator ge  q −D     an     an
                                                           : VI,k → VI,k uniquely
                                       ss
                                           L      ss
extends to a trace class operator on VI,k = λ∈I Vλ,k
   As before, we can compute the traces of the trace class operators. Abusing
terminology slightly, we deﬁne the functions
                            χI,k (g, qe−D ) = T r|VI,k   q −D )
                                                    an (ge
10                                    R. WENDT


on Le Z (G)
         e <1 resp. L(G)
                    e    <1 not distinguishing the diﬀerent spaces they are deﬁned
on. (The semi groups L e Z (G)
                            e <1 and L(G)
                                      e    <1 are deﬁned analogously to the simply
connected case). Finally, again using the fact that σc acts as a unitary operator on
  ss
VI,k , we get

Corollary 2.10. The functions χI,k are holomorphic and conjugacy invariant.

   The main goal of this paper is to compute the functions χI,k explicitly which
will yield a generalization of the Kac-Weyl character formula. This will be done
in section 5.3. Here, we state a trivial observation: The character χI,k restricted
to the component of L e (G) e <1 containing the element (e, q) is just the sum of the
                   P Z                                    e
characters χI,k = λ∈I χλ,k of the characters χλ,k of L(G)       considered above. On
the other hand, σc permutes the highest weight vectors of the representations Vλ,k
with λ ∈ I. So if the σc -orbit I consists of more that one element, the function χI,k
restricted to the connected component of L    e Z (G)
                                                   e <1 containing the element (σc , qe)
vanishes.


                              3. Conjugacy classes
3.1. Conjugacy classes and principal bundles. Since the characters χI,k are
conjugacy invariant functions on L e k (G)q , it is necessary to have a good under-
standing of the conjugacy classes in Le k (G)q in order to understand the characters.
The fundamental result in this direction is an observation due to E. Looijenga
which gives a one-to-one correspondence between the L(G)-conjugacy classes in
L(G) × {q} ⊂ L(G) ⋊ C∗ and the isomorphism classes of holomorphic principal
                                                                             e
G-bundles over the elliptic curve Eq = C∗ /q Z . To be more precise, let G = G/Z, as
                       ∞
above. Then, up to C -isomorphism, every principal G-bundle over Eq is deter-
mined by its topological class, which is an element in π1 (G) ∼ = Z. We can classify
holomorphic principal G-bundles of a ﬁxed topological class c as follows. Consider
the connected component L(G)c of the loop group L(G) which corresponds to c.
The group L(G) ⋊ C∗ acts on the set L(G)c × {q} ⊂ L(G) ⋊ C∗ by conjugation.
Looijenga’s observation gives a one-to-one correspondence between the set of holo-
morphic G-bundles on Eq of topological type c and the set of L(G) × {1}-orbits
in L(G)c × {q}. This correspondence comes about as follows. For any element
(g, q) ∈ L(G)c × {q} consider the G-bundle Bg over Eq which is deﬁned as follows.
View Eq as the annulus |q| ≤ |z| ≤ 1 in the complex plane with the boundaries
identiﬁed via z 7→ qz. Then take the trivial bundle over the annulus and deﬁne
the bundle Bg over Eq by describing the gluing map which identiﬁes the ﬁbers over
the points identiﬁed under z 7→ qz. This is given by f (qz) = g(z)f (z), where f
takes values in G. Obviously, this construction gives a holomorphic G-bundle of
topological type c and the following theorem which is due to E. Loojienga is not
hard to prove (see e.g. [EF]).

Theorem 3.1.
      (i) Two elements (g1 , q), (g2 , q) ∈ L(G)c × {q} are conjugate under L(G) × {1}
          if and only if the corresponding holomorphic G-bundles Bg1 and Bg2 are
          isomorphic.
     (ii) For any holomorphic G-bundle over Eq of topological type c, there exists an
          element g ∈ L(G)c such that B ∼    = Bg .
                                 CHARACTER FORMULA                                       11


   Following [EFK], we call an L(G) × {1}-orbit in L(G)c × {q} semisimple if the
corresponding principal G-bundle over Eq comes from a representation of the fun-
damental group of Eq inside a maximal compact subgroup of G. We call an element
(g, q) ∈ L(G) × {q} semisimple if the corresponding L(G) × {1}-orbit is semisim-
ple. It is known that almost every conjugacy class is semisimple. To be more
precise, if {Bt }t∈T is a holomorphic family of holomorphic principal bundles on Eq
parametrized by a complex space T , then the set subset T0 of bundles which are
ﬂat and unitary is nonempty and Zariski open in T (see [R]).
3.2. The simply connected case. The set of semisimple L(G) × {1}-orbits in
L(G)c × {q} can be described more explicitly. We start with the case that G
is simply connected (the non-simply connected case will be considered in section
3.3). The aﬃne Weyl group W   f = W ⋉ Λ(T ) can be identiﬁed with the group
                ∗          ∗
NL(G)⋊C∗ (T × C )/(T × C ) where NL(G)⋊C∗ (T × C∗ ) denotes the normalizer of
                                               f is the Weyl group of L(G).
T × C∗ in L(G) ⋊ C∗ (see [PS]). In this sense, W                       e     It acts
on the torus T × C∗ via (w, β) : (ξ, q) 7→ (w(ξ)q −β , q). The following proposition
follows from the deﬁnition of semisimplicity and the classiﬁcation of stable and
unitary G-bundles over Eq ([EF], [FM1]).
Proposition 3.2. Let G be simply connected. Every semisimple element in L(G)×
{q} is L(G) × {1}–conjugate to an element of the form (ξ, q) with ξ ∈ T . Two
elements (ξ1 , q) and (ξ2 , q) with ξ1 , ξ2 ∈ T are conjugate if and only if they are in
the same orbit under the action of the aﬃne Weyl group W      f on T × C∗ .

Remark 3.3. We have T = (C∗ )r for some r ∈ N. The set T /q Λ(T ) is an Abelian
variety isomorphic to the product Eq ⊗Z Λ(T ) and there is a natural action of W
on Eq ⊗Z Λ(T ). In this way, the set of semisimple L(G) × {1}-conjugacy classes in
L(G) × {q} can be identiﬁed with the set Eq ⊗Z Λ(T )/W .
   Conjugacy classes in the centrally extended group L       e k (G) can be described as
follows. We are interested in the semisimple conjugacy classes in L     e k (G)q , i.e. con-
jugacy classes which project to semisimple conjugacy classes under the natural pro-
jection L e k (G)q → L(G) × {q}. The set L  e k (G)q is the total space of a ﬁber-bundle
                                   ∗
over L(G) × {q} with ﬁber C and conjugation with an element of L(G) × {1}
induces an automorphism of this bundle. So the set of semisimple L(G) × {1}-
orbits in L e k (G)q will be the total space of a C∗ –bundle over the set of semisimple
L(G) × {1}-orbits in L(G)q . Using equation (3), one can describe the bundle ex-
plicitly.
   Let Tbq be the set of all elements in L  e k (G)q which project to an element of the
form (ξ, q) with ξ ∈ T . As a complex manifold this set is isomorphic to T ×C∗ ×{q}.
Proposition 3.4. The set of semisimple conjugacy classes in L  e k (G)q is given by
the quotient Tbq /W
                  f , where (w, β) ∈ W
                                     f = W ⋉ Λ(T ) acts on Tbq as follows:
                               (w, 1)(ξ, u, q) = (w(ξ), u, q),
                                                                      
                    (1, β)(ξ, u, q) = ξq −β , uq −(k/2)hβ,βi β(ξ k ), q .
Here, β(·) denotes the value of β as a character of T and h and h∗ are identiﬁed
via the normalized invariant bilinear form on g.
Remark 3.5. The quotient Tbq /Λ(T ) described in Proposition 3.4 is the set of non-
zero vectors in a holomorphic line bundle Lk over the Abelian variety Eq ⊗Z Λ(T ).
12                                    R. WENDT


The action of the ﬁnite Weyl group W on this variety induces an action of W on
Lk .
3.3. The non-simply connected case. If G is not simply connected, the set of
semisimple conjugacy classes in the connected component L(G)c × {q} of L(G)⋊ C∗
can be described similarly to the simply connected case although the corresponding
analysis is slightly more involved. Throughout this section let us assume that G is
                   e
of the form G = G/Z,     where Ge is simply connected and Z = hci is a cyclic subgroup
                  e
of the center of G.
    Recall the the deﬁnition of the element σc = ζc−1 wc from section 2.3. The element
(σc , 1) ∈ L(G) ⋊ C∗ acts on the torus T × C∗ ⊂ L(G) ⋊ C∗ by conjugation. We       σc
                      σc
denote by T × C∗ 0 the connected component of the ﬁxed point set T × C∗
which contains the identity element.
    Denote by L(G)c × {q} the connected component of L(G) × {q} containing the
element (σc , q). The following lemma follows from the deﬁnition of semisimplicity
and the classiﬁcation of ﬂat and unitary G-bundles of topological type c on the
elliptic curve Eq ([S] Equation 2.5, [FM1]).
Lemma 3.6. Every semisimple element in L(G)c × {q} is conjugate under L(G)
                                                        σc
to an element of the form (σc ξ, q) ∈ (σc , 1) T × C∗ 0 .
                                                           σc
   It remains to check, which elements of (σc , 1) T × C∗ 0 are conjugate in L(G) ×
C∗ . Obviously, it is enough, to consider conjugation with elements of L(G)0 ⋊ C∗ ,
where L(G)0 denotes the connected component of L(G) containing the identity. In
particular, L(G)0 consists of loops which are contractible. So we have to study the
“twisted Weyl group”
                                                                
                 fσc = NL(G) ⋊C∗ (σc , 1) T × C∗ σc / T × C∗ σc
                 W               0                    0            0
                                        
                                       ∗ σc
and its action on the set (σc , 1) T ×C 0 . First, note that if some (g, q) normalizes
               σc                               σc
(σc , 1) T × C∗ 0 , then it normalizes T × C∗ 0 .
                                                                                  σc
Lemma 3.7. If some element (g, q) ∈ L(G) × C∗ normalizes the torus T × C∗ 0 ,
then it has to normalize the torus T × C∗ as well.
Proof. Conjugation by an element (g, q) ∈ L(G) ⋊ C∗ induces an automorphism of
the Lie algebra L(g) ⊕ CD of L(G) ⋊ C∗ which we will denote by gq . Consider the
root space decomposition
                                                M
                     L(g)pol ⊕ CD = (h ⊕ CD) ⊕      L(g)α .
                                                      e
                                                    α∈∆

The automorphism σc acts on L(g)⊕CD leaving h⊕CD invariant. We can choose an
element X ∈ (h⊕CD)σc such that α(X) 6= 0 for all α ∈ ∆.   e This choice of X insures
that the condition [X, Y ] = 0 already implies Y ∈ h ⊕ CD. But for Y ∈ h ⊕ CD and
g ∈ NL(G)⋊C∗ (T × C∗ )σ0 c we have [X, gq (Y )] = 0 so that gq indeed leaves h ⊕ CD
invariant. Finally, we can use the exponential map exp : L(g) ⊕ CD → L(G) ⋊ C∗
to go back to the group level.                                                    
                      f the group
     Let us denote by W
                        f = NL(G) ⋊C∗ (T × C∗ )/(T × C∗ ) .
                        W        0

Then we have the following Lemma.
                                  CHARACTER FORMULA                                     13


Lemma 3.8. The twisted Weyl group W    fσc is isomorphic to the semidirect product
                                                          
                      fσc ∼
                      W    =W f σc ⋉ (T × C∗ )/(T × C∗ )σc σc .
                                                        0
                                                                              
                                  f and the ﬁnite group (T × C∗ )/(T × C∗ )σc σc .
                          f σc of W
of the σc -invariant part W                                                 0

Proof. Lemma 3.7 allows to deﬁne a map
                                          fσc → W
                                        ϕ:W     f

via
                           (g, q)(T × C∗ )σ0 c 7→ (g, q)(T × C∗ ) .
It is easy to check that
             (σc , 1)ϕ ((g, q)(T × C∗ )σ0 c ) (σc , 1)−1 = ϕ ((g, q)(T × C∗ )σ0 c )
                       fσc → W
so that ϕ deﬁnes a map W      f σc . The kernel of ϕ is given by
                                                       σc
                      ker(φ) = (T × C∗ )/(T × C∗ )σ0 c     .

Finally, one can show that that the map ϕ : W       f σc is surjective and that the
                                              fσc → W
exact sequence
                                          σc          ϕ
           {1} −→ (T × C∗ )/(T × C∗ )σ0 c     −→ Wfσc −→   f σc −→ {1}
                                                           W
splits (see e.g. [W] or [M] for the case of ﬁnite Weyl groups).                         
                                                  f σc and ((T × C∗ )/(T × C∗ )σc )σc
  It remains to describe the action of the groups W                             0
                    σ
on (σc , 1)(T × C∗ )0 c . Note that conjugation by (σc , 1) maps an element (ξ, q) ∈
T × C∗ to (wc (ξ)q −λc , q). Let us choose some h0 ∈ hR such that wc (h0 ) = h0 + λc .
Then we can deﬁne a bijective map
                                 T0wc × C∗ → T × C∗ )σ0 c
via
                                (ξ, q) 7→ (ξq h0 , q) .
                                         σc                                      wc
This shows that (T × C∗ )/(T × C∗ )σ0 c       is in fact isomorphic to T /T0wc        . Let
Twc = T /(id − wc )T denote the torus of co-invariants under wc . There is a natural
                                                                         wc
projection T0wc → Twc whose kernel is isomorphic to T /T0wc                 . This projec-
tion allows us to embed the co-character
                                            lattice  Λ(T wc ) of T wc into  hwc such that
    wc                              wc wc                              σ
Λ(T0 ) ⊂ Λ(Twc ). The group T /T0            acts on (σc , 1) T ×C∗ )0 c via translations.
               f σc                  ∗ σc
The action of W on (σc , 1) T × C )0 is described in the following lemma.
Lemma 3.9. Suppose that σc is not the order n automorphism of the extended
                                                      f σc is isomorphic to a
Dynkin diagram corresponding to An−1 . Then the group W
semidirect product
                            f σc ∼
                            W    = W0 ⋉ Λ(Twc ) .
                                                                         f σc on
Here, W0 is a ﬁnite Weyl group acting irreducibly on hwc . The action of W
              ∗ σc
(σc , 1)(T × C )0 is given by
                                              
                    (w, 1) (σc , 1)(ξq h0 , q) = (σc , 1)(w(ξ)q h0 , q)
and
                                               
                     (1, β) (σc , 1)(ξq h0 , q) = (σc , 1)(ξq −β q h0 , q) .
14                                       R. WENDT


Proof. Fix some q 6= 1 in C∗ and view the tangent space of T × {q} as an aﬃne
subspace of the tangent space h ⊕ CD of T × C∗ . We can identify this space
with h. Since the Weyl group W        f maps T × {q} to itself, it acts on h by aﬃne
transformations. It is a standard fact that W     f acts on h by aﬃne reﬂections, and
                                               e
its lattice of translations is given by Λ(T ). Let a be a fundamental domain for
the induced action of W     f on hR . Then W  f is generated by the reﬂections in the
walls of a. Now, σc induces an aﬃne map on hR which maps the set of reﬂection
hyperplanes of W   f to itself. Furthermore, we can choose a fundamental domain a0
which is mapped to itself by σc . So a0 ∩ hσRc 6= ∅. We claim that the action of W       f σc
      σc                                                               σc
on hR is generated by the set of reﬂections in the walls of a0 ∩hR . Indeed, let hν be
a wall of a0 ∩ hσRc which is the intersection of the walls h1 , . . . , hr of a0 . Since each
x ∈ h1 ∩ . . . ∩ hr is ﬁxed under σc , the map σc permutes the hyperplanes h1 , . . . , hr .
Furthermore, since h1 ∩ . . . ∩ hr is supposed to be a wall of a0 ∩ hσRc (i.e. an aﬃne
subspace of hσc of codimension 1), we can assume the hi to consist of a single σc -
orbit. Let si : hR → hR denote the reﬂection in the aﬃne hyperplane hi . Since σc
is not the order n-automorphism of the extended Dynkin diagram corresponding
to An−1 , we have that either for all simple roots α           e the simple roots α
                                                          ei ∈ Π,                      ei and
σc (e                                                        e
     αi ) are non connected in the Dynkin diagram of ∆ in which case si and sσc (i)
commute. Or the σc -orbit through α       ei consists of exactly two elements s1 and s2
say, and (s1 s2 )3 = 1. In the ﬁrst case, s1 s2 · · · sr commutes with σc . Furthermore,
the restriction of s1 s2 · · · sr leaves an aﬃne hyperplane of hσc invariant so that it
acts as an aﬃne reﬂection on hσc . In the second case, we have to consider the
element s1 s2 s1 ∈ W   f which commutes with σc and acts as an aﬃne reﬂection on
  σc                  σc
h . Since a0 ∩ hR is a fundamental domain for the action of W           f σc acting on hσc ,
the subgroup of W     f σc generated by the reﬂections in the walls of a0 ∩ hσc generate
                                                                                  R
the whole of W  f c.σ

    Finally, it is straight forward to check that the lattice of translations of the action
of Wf σc on hσc is given by the lattice
                                          ord(wc )
                                     1      X
                    Λ(Twc ) = {                    wci (β) | β ∈ Λ(Te)} .
                                  ord(wc ) i=1
                                                                                          
   Putting everything together, we get the analogue of Proposition 3.2 in the non-
simply connected case.
Proposition 3.10. Let G be of the form G = G/Z.         e    Every semisimple element in
L(G)c × {q} is conjugate to an element of the form (σc ξq h0 , q), where ξ ∈ T0wc and
h0 ∈ hR is chosen such that wc (h0 ) = h0 + λc .
   Two elements (σc ξ1 q h0 , q) and (σc ξ2 q h0 , q) are conjugate if and only if they are
in the same orbit under the action of the group W       fσc on (σc , 1)(T × C∗ )σc .
                                                                   wc
Remark 3.11. Remember that we have identiﬁed T /T0wc                     with a ﬁnite sub-
                                                wc
group of T0wc . The quotient T0wc / T /T0wc          is isomorphic to the torus Twc of co-
invariants. So analogously to Remark 3.3, the set of semisimple conjugacy classes
in L(G)c × {q} can be identiﬁed with the quotient Eq ⊗Z Λ(Twc )/W0 .

  Finally, let us consider semisimple conjugacy classes in a central extension L e k (G).
Remember that L                                            e k (G) ∼
                  e k (G) is given as a semidirect product L       =Lb k (G) ⋊ C
                                                                               f∗ where
                                   CHARACTER FORMULA                                      15


b k (G) denotes a level k central extension of L(G) corresponding to some com-
L
mutator map ω, and C     f∗ is the ord(c)-fold covering of C∗ . Let L(G)c denote the
connected component of the loop group L(G) corresponding to the element c ∈ Z
and denote by L  b k (G)c the set of elements in Lb k (G) which project to an element
                                          f ∗
in L(G)c . Furthermore, ﬁx some qe ∈ C . Since conjugation in L         e k (G) leaves the
sets Lb (G) × {e
       k
               q} invariant, we can consider the connected component L        b k (G)c × {e
                                                                                          q}
which is also invariant under conjugation. The set of semisimple conjugacy classes
in this component will be the total space of a C∗ -bundle over the space of semisim-
ple conjugacy classes in L(G)c × {e   q}. For any element qe ∈ C  f∗ , let q ∈ C∗ denote
                                                  f∗       ∗
the image of qe under the natural projection C → C . Since qe acts on L(G) via
rotation by q, the set of semisimple conjugacy classes in L(G)c × {e     q } is isomorphic
to the set of semisimple conjugacy classes in L(G)c × {q}.
    Recall from Lemma 3.9 and Remark 3.11 that W      fσc = (W0 ⋉ Λ(Twc )) ⋉ (T /T wc ),
                                                                                        0
                                                    wc
where Λ(Twc ) is identiﬁed with a sublattice of hR .
    Let us denote by Tbqwc the set of elements of L  b k (G)c × {e
                                                                 q} which project to an
                             h0                wc
element of the form (σc ξq , qe) with ξ ∈ T0 . As a complex manifold, this set is
isomorphic to T0wc × C∗ . Using Lemma 3.9, Remark 3.11 and formula (3), we ﬁnd
the analogue of Proposition 3.4 in the non-simply connected case.
Proposition 3.12. The set of semisimple L(G)-conjugacy classes in the connected
component of L  b k (G)×{eq } corresponding to c ∈ Z is given by the quotient Tbqwc /W
                                                                                     fσc ,
where (w, ξ0 , β) ∈ W fσc = (W0 ⋉ Λ(Twc )) ⋉ (T /T wc ) acts as follows:
                                                    0

                               (w, 1, 1)(ξ, u, qe) = (wξ, u, qe) ,
                                                               
         (1, β, 1)(ξ, u, qe) = ξq −β , uq −(k/2)hβ,βiβ(ξ k ), qe     for β ∈ Λ(T0wc ) .
and
                           (1, 1, ξ0 )(ξ, u, qe) = (ξξ0 , u, qe) ,
Here, β(·) denotes the value of β as a character of Twc and h and h∗ are identiﬁed
via the normalized invariant bilinear form on g.
Remark 3.13. The quotient Tbqwc /Λ(Twc ) described in Proposition 3.12 is the set
of non-zero vectors in a line bundle Lkwc over the Abelian variety Eq ⊗Z Λ(Twc )
introduced in Remark 3.3. The action of the ﬁnite Weyl group W0 on this variety
induces an action of W0 on Lkwc .

           4. The differential equation for affine characters
4.1. The characters as sections of a line bundle. Throughout this section, we
shall assume that G is of the form G = G/Z,    e    where Z = hci is a cyclic subgroup
                  e
of the center of G. The simply connected case follows from the calculations below
by setting c = id. As before, let k be a multiple of the basic level of G, and
let χI,k denote the character of the L   e kb (G)-module VI,k . Here, I is a σc -orbit in
  k
P+ . So the representation VI,k restricted to the connected component L       e kb (G)0 of
e kb (G) containing the identity decomposes into a direct sum VI,k = ⊕λ∈I Vλ,k of
L
irreducible highest weight representations of L   e kb (G)0 . We have seen in the end of
section 2.4 that if I consist of more than one element, the character χI,k restricted
to the connected component of L    e kb (G) corresponding to the element c vanishes.
So the only interesting characters on this component are the ones coming from
16                                          R. WENDT


representations VI,k , where I consists of a single element λ which is necessarily
invariant under σc . Let us denote the corresponding character by χλ,k .
   As before, let Lk (G)c denote the connected component of L(G) containing the
element σc , and let L b kb (G)c be the connected component of L       b kb (G) which consists
of elements which project to some g ∈ L(G)c . Fix some qe ∈ C            e ∗ and let q denote
                                                     e ∗       ∗
the image of qe under the natural projection C → C . Let us assume that |q| < 1.
Then the character χλ,k deﬁnes a holomorphic function on L              b kb (G) × {e
                                                                                    q}. Since
                              b kb
almost every element in L (G) × {e        q} is semisimple, the function χλ,k is uniquely
determined by its values on Tbqwc × {e       q }. As before, ﬁx some h0 ∈ h such that
wc (h0 ) = h0 + λc . Remember that Tqwc × {eb        q } was deﬁned as the set of elements
   b kb (G)c × {e
of L            q} which project to an element of the form (σc ξq h0 , qe) with ξ ∈ T0wc
under the natural projection L     b kb (G) × {eq } → L(G) × {e  q }.
   Finally, recall the identiﬁcation ι : C∗ → L     b kb (G) of C∗ with the center of L
                                                                                      b kb (G).
If g = (σc ξq , u, qe) ∈ Tbq c , we can use the identity
             h0              w


                         χλ,k (σc ξq h0 , u, qe) = uk χλ,k (σc ξq h0 , 1, qe)
to get rid of the central variable. Thus, for ﬁxed qe, we can view the character χλ,k
as a section of the line bundle Lkwc introduced in Remark 3.13. We shall abuse
notation slightly and denote this section by χλ,k as well. So locally, we can view
                                ∗ σc
χλ,k as a function on T × C 0 . We will derive a diﬀerential equation for this
function in section 4.3 by varying the variable qe.
   Let us change our notation slightly. For q ∈ C∗ with |q| < 1 ﬁx τ ∈ C with
Im(τ ) > 0 such that q = e2πiτ . Let L ⊂ C be the lattice generated by 1 and τ .
Then the elliptic curve Eτ = C/L is isomorphic to the curve Eq considered in the
last paragraph via the map x 7→ e2πix . This allows to identify the Abelian variety
Eq ⊗Z Λ(Twc ) with hwc / (Λ(Twc ) ⊕ τ Λ(Twc )). In this identiﬁcation, we can view the
character χλ,k at some ﬁxed qe as a function χσλ,kc
                                                    (·; qe) on hwc which has to satisfy
the following identity:
          χσλ,k
             c
                (h + β + τ β ′ ; qe) = exp(−2πikhβ ′ , vi − πikτ hβ ′ , β ′ i)χσλ,k
                                                                                 c
                                                                                    (h; qe)
for any β, β ′ ∈ Λ(Twc ). From now on, we shall switch between the diﬀerent view-
points for the characters freely.
4.2. The action of σc on the derivation D. Throughout this section, let k be
a multiple of the basic level of G and let λ ∈ P+k be a highest weight of g which is
invariant under σc . So the σc -orbit I through λ consists of a single element.
   Let h1 , . . . , hl be an orthonormal basis of h and choose eα ∈ gα and fα ∈ g−α
for each α ∈ ∆+ such that the set {eα , fα , hj | α ∈ ∆+ and 1 ≤ j ≤ l} is an
orthonormal basis of g. We can make this choice in such a way that wc (eα ) =
±ewc (α) for all α ∈ ∆ and similarly for the fα (see section 2.3).
       e = α + nδ ∈ ∆
   For α                   e re let us deﬁne
                             +
                            (
                                 eα ⊗ z n if α ∈ ∆+ , n ≥ 0 ,   and
                      eαe =             n
                                 fα ⊗ z    if α ∈ ∆− , n > 0 .

Similarly for α            e re
              e = α + nδ ∈ ∆ + , we set
                      (
                         fα ⊗ z −n if α ∈ ∆+ , n ≥ 0 ,                          and
                fαe =
                         eα ⊗ z −n if α ∈ ∆− , n > 0.
                                         CHARACTER FORMULA                                                               17


We use the usual notation X ⊗ z n = X (n) for X ∈ g. Then, using the explicit
expression of the Kac-Casimir operator ([K], 12.8) on Vλ,k , we can express D as an
                                                      e
operator on the highest weight representation Vλ,k of L(g)   via

                                        X                     ∞ X
                                                              X l                         l
                                                                                          X                  X
                                                                               (−n) (n)
(5) 2(k+h∨ )D = c(λ)Id−2                         fαe eαe −2                 hj     hj −         (hj )2 −          hα ,
                                       α  e re
                                       e ∈∆                   n=1 j=1                     j=1              α∈∆+
                                            +



where c(λ) = kλ + ρk2 − kρk2 and h∨ denotes the dual Coxeter number of g.
   In this section, we determine how the expression (5) for the derivation D behaves
                                 e
under the automorphism σc of L(g).      Let (∆                                      e re .
                                              e re+ )σc be the set of σc -orbits in ∆
                                                                                      +
Let mαe = |[eα]| denote the cardinality of the σc -orbit through α
                                                                 e. Let ǫαe be a mαe -th
root of unity. Then we set
                                                     mα
                                                     Xe
                                            ǫα
                                           eα
                                            e =
                                             e
                                                           ǫjαe σcj (eαe ) ,
                                                     j=1

and accordingly
                                                     mα
                                                     Xe

                                          fαeǫαe =         ǫjαe σcj (fαe ) .
                                                     j=1

             ǫα      ǫα            −1
Obviously, eαe and fα
              e
                     e lie in the ǫα
                      e
                                   e –eigenspace of σc . Similarly, recall that σc acts
linearly on the space h ⊕ CC. For h ∈ h ⊕ CC and any ord(σc )-th root of unity ǫ
we deﬁne
                                                   ord(σc )
                                                     X
                                          hǫ =                ǫj σcj (h) .
                                                     j=1

   Finally, we can decompose h = h0 ⊕ . . . ⊕ hord(wc )−1 where hj denotes the
        j
 2πi ord(σ
e          –eigenspace of the action of the Weyl group element wc acting on h.
           c)

Furthermore, we can choose the basis h1 , . . . hl of h such that it is adapted to this
decomposition of h. That is, let hj,1 , . . . hj,lj be an orthonormal basis of the space
hj . Then the set {hj,s | 0 ≤ j ≤ ord(wc ) − 1, 1 ≤ s ≤ lj } is an orthonormal basis of
h.
    Let us ﬁx a representative α e for each σc -orbit [e        e re . Furthermore, from
                                                          α] in ∆ +
                                                                        1                          1
                                                                 2πi
now on let us ﬁx the roots of unity ǫαe = e mαe and ǫ = e2πi ord(σc ) Using the
expression from equation (5) for the derivation D and the fact that σc acts as an
                                                    e
automorphism on the universal enveloping algebra of L(g), we can write

                 ord(σc )
       2(k + h∨ ) X j
(6)                       σ (D) =
        ord(σc ) j=1 c
                                                             ∞ ord(w   lj
                    X            1 X
                                    mαe
                                         ǫjα  −j
                                             ǫα       2     X    Xc ) X
   c(λ) − 2                             f ee  e
                                                 −                        ǫ2rj hj,s (−n) hj,s (n)
                                mαe j=1 αe αe      ord(σc ) n=1 j,r=1 s=1
                [e   e re )σc
                 α]∈(∆ +

                                  ord(σc ) lj ord(σc )                                            ord(σc )
                           1        X X X                 r     −r      1     X                    X
                    −           2
                                                       hǫj,s hǫj,s −                                         σ j (hα )
                        ord(σc ) j=1 s=1 r=1                         ord(σc )                       j=1
                                                                                      α∈∆+
18                                         R. WENDT


4.3. The differential equation. We now derive a diﬀerential equation for the
character χλ,k .
   Recall that σc acts on e
                          h. Fix some h ∈ hwc and some τ ∈ C. Then the element
                                                    ord(σc )
                                               1      X
                            e0 = h − τ
                            H                                σ j (D)
                                            ord(σc ) j=1 c

                            e 0 contains a non-zero central term which comes from
is invariant under σc . But H
Pord(σc ) j
   j=1    σc (D). Let C(D) denote this central term. Then
                                  e 0 − C(D) ∈ hwc ⊕ CD ,
                             H0 = H
and H0 is invariant under the residual action of σc on h ⊕ CD ∼    =eh/CC. Therefore
we have                                  P ord(σc ) j
                                    1
             e2πiH0 = e2πih q (− ord(σc ) j=1 σc (D)) q C(D) ∈ (T × C∗ )σc
where we have set q = e2πiτ as usual. If Im(τ ) > 0, we have |q| < 1 so that
the character χλ,k (σc eπiH0 ) converges. (Remember that we have identiﬁed the
character χλ,k with a section of the family of line bundle Lkwc which we view locally
as a function on (T × C∗ )σ0 c .)
   We now want to calculate the derivative
                             2(k + h∨ ) ∂
                                             χλ,k (σc e2πiH0 ) .
                                  2πi     ∂τ
                                             ∨                           e
For simplicity, we will calculate 2(k+h
                                     2πi
                                         ) ∂
                                           ∂τ χλ,k (σc e
                                                         2πiH0
                                                               ) and disregard all central
terms which come from the action of σc on the derivation D. Using equation (6),
we can compute

                                                                     ∨ ord(σ
                                                                         Xc )
       2(k + h∨ ) ∂               e0
                               2πiH                       e 0 2(k + h )
                                                       2πiH
                                                                                     
(7)                 χλ,k (σc e       ) = −T rVλ,k σc e                        σ j (D)
          2πi    ∂τ                                            ord(σc ) j=1 c
                                                e
                                                                   X          1
                     = −c(λ)χλ,k (σc e2πiH0 ) + 2                                A[eα]
                                                                             mαe
                                                            [e   e re )σc
                                                             α]∈(∆ +


                                             X∞ ord(w
                                                  Xc )
                                       2
                                +                      Bn,j
                                    ord(σc ) n=1 j=1
                                                  ord(σc )                                 ord(σc )
                                           1        X              1     X                  X
                                    +           2
                                                           Cj +                                       Eα,j ,
                                        ord(σc ) j=1            ord(σc )                    j=1
                                                                                    α∈∆+

where we have set
                                                    mα
                                                    Xe

                                        A[eα] =           Aαe ,j
                                                    j=1
with
                                                            e      ǫj   ǫ−j 
                            Aαe ,j = T rVλ,k σc e2πiH0 fαeαe eαeαe
for some ﬁxed αe ∈ [e
                    α]. It is clear that A[eα] does not depend on the choice of the
representative α
               e. Similarly,
                                        dim(hj ) ord(wc )
                                         X          X
                             Bn,j =                          ǫ2jr Bn,j,s
                                          s=1       r=1
                                             CHARACTER FORMULA                                        19


with
                                                      e   (−n) (n) 
                              Bn,j,s = T rVλ,k σc e2πiH0 hs,j hs,j ,
and
                                                       lj ord(σc )
                                                       X    X
                                             Cj =                              Cj,r,s
                                                       s=1        r=1
with                                                                                          
                                                                               e    r    −r
                               Cj,s,r = T rVλ,k σc e2πiH0 hǫj,s hǫj,s                             .
Finally,
                                                      e         
                            Eα,j = T rVλ,k σc e2πiH0 σcj (hα ) .
    We can compute the summands of equation (7) more explicitly. Let us ﬁrst note
that since H e 0 is invariant under σc , we have σcj (e α)(He0 ) = α   e 0 ) for all j ∈ N, so
                                                                     e(H
that for any root α        e the value of H
                      e ∈ ∆,                   e 0 on the σc -orbit through α   e is constant.
Furthermore, for any real root α          e re
                                   e ∈ ∆ , we have chosen the eαe and fαe such that
σc (eαe ) = ±eαe and similarly for fαe . Let us deﬁne
                            (
                              −1 if σc (e    α) = α e and σc (eαe ) = −eαe
(8)                  s(e
                       α) =
                              1    in all other cases
If s(e
     α) = 1, we can calculate
                                                 e     ǫj   ǫ−j 
            Aαe ,j = T rVλ,k σc e2πiH0 fαeαe eαeαe
                                    ǫ−j                e     ǫj   
                   = T rVλ,k eαeαe σc e2πiH0 fαeαe
                                                 ǫ−j        e         ǫj   
                   = ǫ−j
                      e T rVλ,k σc eα
                      α             e e
                                     e
                                     α  2πiH0 α
                                             fαe e
                                         e                                 e       ǫ−j   ǫj   
                   = ǫ−j
                      e e
                      α
                          −2πie
                              α(H0 )
                                     T rVλ,k σc e2πiH0 eαeαe fαeαe
                                e 0)                e     ǫj ǫ−j        ǫ−j      ǫj 
                   = ǫ−j
                      e e
                      α
                          −2πie
                              α(H
                                     T rVλ,k σc e2πiH0 (fαeαe eαeαe + [eαeαe , fαeαe ]) .
In the ﬁrst step, we have used the cyclic property of the trace. In the second step
                                             ǫ−j
we have used the fact, that eαeαe lies in the ǫjαe –eigenspace of the action of σc on
e
L(g). The remaining steps are the standard commutation relations in L(g).  e     The
commutator in the last step can be computed as follows:
                                                 mα
                                                 X  mα
                                                  e Xe
                            ǫ−j     ǫj
                         [eαeαe , fαeαe ] =                  ǫ−js
                                                              e ǫα
                                                              α
                                                                  jr s
                                                                  e [σc (eα
                                                                                r
                                                                          e ), σc (fα
                                                                                    e )]
                                                 s=1 r=1
                                                 mα
                                                 Xe

                                             =         σcs ([eαe , fαe ]) ,
                                                 s=1

since we have   [σcs (eαe ), σcr (fαe )]
                                    = 0 whenever s 6= r. Indeed, by assumption, we have
σcs (e
     α) 6= σcr (e
                α) for s 6= r. Since σc acts as a diagram automorphism on the Dynkin
diagram of the aﬃne root system ∆,     e there exists a root basis Π
                                                                   e ′ of ∆
                                                                          e which contains
         s
both σc (e            r
           α) and σc (e  α). Now, we can ﬁnd some element w in the Weyl group of ∆           e
                e ′     e                                      s         r
such that w(Π ) = Π ([K], Proposition 5.9). So we have [σc (eαe ), σc (fαe )] = [eαe i , fαe j ]
for two simple roots α     ei 6= α    e The last commutator has to vanish due to the
                                 ej ∈ Π.
Serre relations for L(g)e pol (see [K], 1.2).
       e = α + nδ with α ∈ ∆+ , we have
    If α
                                              [eαe , fαe ] = hα + nC ,
20                                                        R. WENDT


where hα ∈ h is the co-root of g corresponding to the root α ∈ ∆. Similarly, if
e = α + nδ with α ∈ ∆− , one has
α
                                                  [eαe , fαe ] = −hα + nC .
Let us write n(e          e = α + nδ and hαe = hα if α ∈ ∆+ and hαe = −hα if
               α) = n for α
α ∈ ∆− . Then the calculations above give us
                               e
     Aαe ,j = ǫ−j
               e e
               α
                   −2πie
                       α(H0 )
                              Aαe ,j +
                                                                 mα
                                                                 X                                  e            
                                                                  e
                                                           e
                                       T rVλ,k σc e2πiH0                  σcs (hαe ) + χλ,k (σc e2πiH0 ) kmαe n(e
                                                                                                                α) ,
                                                                 s=1

or equivalently
                                   e                                       mα
                  ǫ−j
                   e e
                       −2πie
                           α(H0 )
                                                                      e
                                                                           Xe
                                                                                           
     Aαe ,j =      α
                                                 T rVλ,k σc e2πiH0               σcs (hαe )
                1−   ǫ−j
                      e e
                      α
                          −2πie e 0)
                              α(H
                                                                           s=1
                                                                                                      e            
                                                                                       + χλ,k (σc e2πiH0 )kmαe n(e
                                                                                                                 α)
Summing over the j’s, we can write
                                   e                                      mα
                                                                          X
                mαe e−2πimαe αe (H0 )                              e0
                                                                2πiH
                                                                           e
                                                                                          
     A[eα] =                                 T rVλ,k σc e                       σcs (hαe )
                1−   e−2πimαe αe (He 0 )                                  s=1
                                                                                                    e
                                                                    km2αe n(e
                                                                            α)e−2πimαe αe (H0 )                      e 
                                                                +                                       χλ,k (σc e2πiH0 ) .
                                                                       1−     e−2πimαe αe (He 0 )
Since
                                           mα
                                           Xe                   mα
                                                                Xe

                                                 σcs (hαe ) =         wcs (hαe ) + yαe C
                                           s=1                  s=1

for some yα ∈ C, we can ﬁnally write
                                    e      mα
                   mαe e−2πimαe αe (H0 ) X   e
                                                1      ∂                    e
(9) A[eα] =                                                    χλ,k (σc e2πiH0 )+
                   1 − e−2πimαe αe (He 0 ) s=1 2πi ∂wcs (hαe )
                                                                                           e
                                                        km2αe n(e
                                                                α)e−2πimαe αe (H0 )                              e
                                                                                                χλ,k (σc e2πiH0 ) + Y[eα] C
                                                           1−       e−2πimαe αe (He 0 )
for some Y[eα] ∈ C which comes from the action of σc on the derivation D.
        α) = −1, we necessarily have mαe = 1. A similar calculation as above gives
   If s(e
                                       e
                      −e−2πieα(H0 )           1      ∂                    e
(10) A[eα] =                                                 χλ,k (σc e2πiH0 )−
                     1+   e−2πieα(He 0 )     2πi ∂wcs (hαe )
                                                                                       e
                                                                    α)e−2πieα(H0 )
                                                                 kn(e                                        e
                                                                                               χλ,k (σc e2πiH0 ) + Y[eα] C .
                                                                    1 + e−2πieα(He 0 )
     A similar calculation for the Bn,j,s gives
                            e                     
     Bn,j,s =T rVλ,k σc e2πiH0 hj,s (−n) hj,s (n)
                             e                   e                                                
                =ǫ−j e−2πinδ(H0 ) T rVλ,k σc e2πiH0 (hj,s (−n) hj,s (n) + [hj,s (n) , hj,s (−n) ]) .
                                      CHARACTER FORMULA                                                 21


                      e 0 ) = −τ and [hj,s (n) , hj,s (−n) ] = nC, we get
Using the fact that δ(H
                                                                       e
                                          ǫ−j q n nkχλ,k (σc e2πiH0 )
(11)                         Bn,j,s =
                                                   1 − ǫ−j q n
This shows that Bn,j,s in fact does not depend on s. So we get
                                       ord(σc )                                    e
                                         X               ǫ−j q n nkχλ,k (σc e2πiH0 )
(12)             Bn,j = dim(hj )                  ǫ2jr                               .
                                         r=1
                                                                  1 − ǫ−j q n

This sum vanishes if ord(σc ) 6 |2j, otherwise we get
                                                                               e
                                                     ǫ−j q n nkχλ,k (σc e2πiH0 )
(13)               Bn,j = ord(σc ) dim(hj )                                      .
                                                              1 − ǫ−j q n
                    r
   Finally, since hǫj,s is in the ǫ−r –eigenspace of the action of σc on h⊕CC, a similar
calculation gives
                                              e    r     −r 
                     Cj,s,r = T rVλ,k σc e2πiH0 hǫj,s hǫj,s = ǫ−r Cj,s,r .
This shows that Cj,s,r = 0 unless ǫr = 1. Now, if j = 0, we have h1j,s = ord(σc )hj,s ,
so that we get
                           l0
                           X                 ord(σc )2                  e
(14)               C0 =          C0,s,0 =              ∆h0 χλ,k (σc e2πiH0 ) ,
                           s=1
                                              (2πi)2

where ∆h0 denotes the Laplace operator on h0 . On the other hand, for j 6= 0, we
have h1j,s = ys,j C for some ys,j ∈ C so that we can drop these terms since they
come from the action of σc on D.
   Since all roots α                           e
                   e vanish on the center C of L(g), we have α e0 ) = α
                                                             e(H      e(H0 ) for all
     e
e ∈ ∆. So putting the calculations above together, reordering the terms slightly,
α
and keeping in mind that we have to disregard all central terms coming from the
action of σc on the derivation D, we get

       2(k + h∨ ) ∂                  
(15)                χλ,k (σc e2πiH0 ) =
          2πi    ∂τ
                                                                            1      
                                 − c(λ) + A1 + A2 + B + E −                   2
                                                                                ∆h0 χλ,k (σc e2πiH0 )
                                                                           4π
where we have set
                         X                                     mα
                                         α)2e−2πimαe αe (H0 ) X
                                       s(e                       e
                                                                    1      ∂
              A1 =                                                                 ,
                                           α)e−2πimαe αe (H0 ) s=1 2πi ∂wcs (hαe )
                                     1 − s(e
                     [e   e re )σc
                      α]∈(∆ +

                         X           s(e         α)e−2πimαe αe (H0 )
                                       α)2kmαe n(e
              A2 =                                                   ,
                                              α)e−2πimαe αe (H0 )
                                        1 − s(e
                     [e   e re )σc
                      α]∈(∆ +

                     ∞ ord(σ
                     X   Xc )                       ǫ−j q n nk
               B=                    2 dim(hj )                ,
                     n=1   j=1
                                                   1 − ǫ−j q n
                                        ord(σc )
                        1     X          X          1     ∂
               E=                                        j
                                                                 .
                     ord(σc )             j=1
                                                   2πi ∂wc (hα )
                               α∈∆+
22                                               R. WENDT


   Equation (15) is the desired diﬀerential equation for the characters. We will now
simplify the equation.
               P        To do this, let us make some deﬁnitions. First, recall the
element ρ = 21 α∈∆+ α and set
                                                       ord(wc )
                                                  1      X
                                     ρwc =                      wc (ρ) .
                                               ord(wc ) j=1

Then we can deﬁne the function
                                                                            ∞         ord(wc )
                                     Y                                     Y           Y
                2πiρwc (H0 )                              −2πimα
                                                               eαe (H0 )
Fwc (H0 ) = e                                  1−s(e
                                                   α)e                                       (1−ǫ−j q n )dim(hj ) .
                               [e   e re )σc
                                α]∈(∆                                        n=1       j=1
                                      +


                                                              e(H0 ) = α(H0 ) − τ n
By the deﬁnition of H0 and invariance of δ under σc , we have α
for α
    e = α + nδ. Hence we get
                        1 ∂                  1       1 
                              Fwc (H0 ) = −    A2 +    B Fwc (H0 ) .
                       2πi ∂τ               2k      2k
                                                             ∨
Now, Fwc is a section of the line bundle Lhwc from remark 3.13, so χλ,k Fwc is a
                ∨
section of Lk+h
            wc    . Therefore we get

         1 2(k + h∨ ) ∂         
(16)                    χλ,k Fwc =
        Fwc   2πi    ∂τ
                                                    
                        2(k + h∨ ) ∂χλ,k   χλ,k ∂Fwc
                                         +
                           2πi      ∂τ     Fwc ∂τ
                                                                                              1       
                                                          = − c(λ) + A1 + E −                   2
                                                                                                  ∆hwc χλ,k
                                                                                             4π
     Next, we take care of the Laplacian. We use the formula
        ∆hwc (χλ,k Fwc ) = (∆hwc χλ,k )Fwc + 2h∇χλ,k , ∇Fwc i + χλ,k (∆hwc Fwc ) .
But we have
                       dim(h0 )
          1              X
(17)         ∇(Fwc ) =          ρwc (h0,s )Fwc h0,s +
         2πi             s=1
                          dim(h0 )
                               X         X                               α)e−2πimαe αe (H0 )
                                                                       s(e
(18)                                                 mαe α
                                                         e(h0,s )                               Fw h0,s
                               s=1
                                                                           α)e−2πimαe αe (H0 ) ) c
                                                                    (1 − s(e
                                     [e   e re )σc
                                      α]∈(∆ +

                                                X                    α)e−2πimαe αe (H0 )
                                                                   s(e
(19)                   =Fwc hρwc +                        mαe                               F w hα
                                                                       α)e−2πimαe αe (H0 ) ) c
                                                                (1 − s(e
                                          [e   e re )σc
                                           α]∈(∆ +


where we have used the notation from before for an orthogonal basis h0,s of h0 =
hwc . Since h0,s ∈ h, we have α
                              e(h0,s ) = α(h0,s ) for α
                                                      e = α + nδ. Now, since we have
                                                            ∂
                                         h∇χλ,k , hi =         χλ,k
                                                            ∂h
and
                                                             ord(wc )
                                            1      X             X
                               hρwc =                                   wcj (hα ) ,
                                         2ord(σc )               j=1
                                                      α∈∆+
                                CHARACTER FORMULA                                    23


we get
                  1           1          1             1
(20)         h       ∇χλ,k ,     ∇Fwc i = (Eχλ,k )Fwc + (A1 χλ,k )Fwc
                 2πi         2πi         2             2
So putting everything together, we get
                                                              
 1    2(k + h∨ ) ∂               1                  1
                    χλ,k Fwc + 2 ∆h0 (χλ,k Fwc − χλ,k 2 ∆h0 Fwc = −c(λ)χλ,k .
Fwc       2πi   ∂τ               4π                  4π
A direct calculation gives
                               1
                                  ∆h Fw = −|ρwc |2 Fwc
                              4π 2 0 c
so that we arrive at the ﬁnal equation:
Theorem 4.1. Let k be a multiple of the basic level of G, and let λ ∈ P+k be a
highest weight of Ge which is invariant under the action of σc . Then the character
                                                                      σc
χλ,k of the representation Vλ,k restricted to the torus (σc , 1) T ×C∗ 0 has to satisfy
the following diﬀerential equation:
                                                      
         1      2(k + h∨ ) ∂        1                2
(21)          −               +         ∆h − |ρwc | χλ,k Fwc = c(λ)χ?lambda, k
        Fwc        2πi     ∂τ    (2πi)2 0
Remark 4.2. If we set σc = id theorem 4.1 gives a diﬀerential equation for the char-
acters of highest weight representations of loop groups based on simply connected
Lie groups. This case is treated in more generality in [EK] (see also [EFK]), where
a diﬀerential equation for traces of intertwining maps between representations of
loop groups is derived. Introducing the automorphism σc , one can ﬁnd a diﬀeren-
tial equation for traces of intertwining maps between representations of loop groups
based on non-simply connected Lie groups.
Remark 4.3. We have only treated the case of automorphisms σc associated to the
                                         e The same calculations work if one
center of the simply connected Lie group G.
replaces the automorphism σc by an arbitrary ﬁnite order automorphism σ of the
             e
Lie algebra L(g) which comes from an automorphism of the Dynkin diagram of
e
L(g).

                             5. Character formulas
5.1. Theta functions. The line bundle Lk introduced in Remark 3.5 has been
studied in [Lo]. Here we give a brief account of the main results. As in the end
of section 4.1 ﬁx some τ ∈ C with Im(τ ) > 0 and let q = e2πiτ . Let L ⊂ C be
the lattice generated by 1 and τ . Then the elliptic curve Eτ = C/L is isomorphic
to the curve Eq considered in the last paragraph via the map x 7→ e2πix . Denote
by Γ(Lk ) the space of holomorphic sections of Lk . Let Γ(Lk )W , resp. Γ(Lk )−W
denote the spaces of holomorphic W -invariant, resp. W -anti invariant sections of
Lk . Looijenga’s theorem describes the set Γ(Lk )−W explicitly in terms of theta
functions. Since we also want to consider sections in the line bundles Lkwc from
Remark 3.13, we start with some general statements.
   Let V be a ﬁnite dimensional Euclidean vector space and denote the bilinear form
in V by h , i. In what follows, we will freely identify V and V ∗ via the bilinear
form h , i. Let M be some integer lattice in V . Let us denote by M ∗ ⊂ V the dual
24                                          R. WENDT


lattice corresponding to M . That is, M ∗ = {λ ∈ V | hα, λi ∈ Z for all α ∈ M }.
For µ ∈ M ∗ and k ∈ N, deﬁne the theta function Θµ,k on V ⊗ C via
                       1             X                            1
       Θµ,k (v) = exp(− πiτ hµ, µi)       exp(2πikτ (hγ, τ −1 vi + hγ, γi)) .
                       k             1
                                                                  2
                                         γ∈ k µ+M

This function converges absolutely on compact sets and satisﬁes the identity
(22)         Θµ,k (v + β + τ β ′ ) = exp(−2πikhβ ′ , vi − πikτ hβ ′ , β ′ i)Θµ,k (v)
for any β, β ′ ∈ Λ(T ). To emphasize the dependence of Θµ,k on τ , we will write
Θµ,k (v; τ ).
   Now suppose that G is a simply connected Lie group and take VR = hR endowed
with the normalized Killing form h , i. Since Λ(T ) is an integer lattice with respect
to h , i, we can take M to be Λ(T ). It is clear from equation (22) that in this
situation, the functions Θµ,k ( · ; τ ) deﬁne holomorphic sections of the line bundle
Lk .
   We can deﬁne the anti-invariant theta functions
                                          X
                           AΘµ,k =           (−1)l(w) Θwµ ,
                                             w∈W

where W the Weyl group of G, and l(w) denotes the length of w in W .
  Let a ⊂ hR be a fundamental alcove for the action of the aﬃne Weyl group
f = W ⋉ Λ(T ). Then the following result is due to [Lo].
W
Proposition 5.1. Let k be a positive integer. The anti-invariant theta functions
AΘµ,k with µ ∈ Λ(T )∗ ∩ ka form a basis in Γ(Lk )−W .
   Let h∨ P
          denote the dual Coxeter number of the root system ∆ of g. As usual, we
set ρ = 12 α∈∆+ α, where ∆+ denotes the set of positive roots of ∆ with respect
to the Weyl chamber containing the fundamental alcove a. For σc = id and h ∈ h,
the function F = Fid which was deﬁned in section 4.3 can be written as
                                      ∞
                                      Y                       Y
                                                          l
     Fid (h − τ D) = exp(2πihρ, hi)         (1 − q n ))              (1 − exp(−2πihα, hi))
                                      n=1                     α∈∆+
                                                                ∞
                                                              Y Y
                                                                        (1 − q n exp(−2πihα, zi)) ,
                                                              α∈∆ n=1

where, as before, l denotes the rank of g. It is well known that F is a holomorphic,
                               ∨
W anti-invariant section of Lh (see [Lo]).
                             e
   If G is of the form G = G/Z,   where Z = hci is a cyclic subgroup of the center of
the simply connected group G,  e we have to consider the lattice Λ(Twc ) ⊂ hwc . Let
h , i denote the normalized Killing form restricted to hwR . As before, let kb denote
                                                            c


the basic level of G. A case by case check shows that Λ(Twc ) is an integral lattice
with respect to the bilinear form kb h , i. Denote by Λ(Twc )∗kb ⊂ hw
                                                                    R the dual lattice
                                                                     c


of Λ(Twc ) with respect to the bilinear form kb h , i. Then, for µ ∈ Λ(Twc )∗kb and k
a multiple of kb , the theta function Θµ,k is a section of the line bundle Lkwc which
was deﬁned in Remark 3.13. As before, we deﬁne the anti-invariant theta functions
                                         X
                            A0 Θµ,k =        (−1)l(w) Θwµ ,
                                             w∈W0
                                  CHARACTER FORMULA                                        25


where W0 is the ﬁnite Weyl group introduced in Proposition 3.9, and l(w) denotes
the length of w in W0 . Let awc ⊂ hw
                                   R be a fundamental alcove for the action of the
                                    c


aﬃne Weyl group W  f σc = W0 ⋉ Λ(Twc ). Then we have (see [K], Chapter 13):

Proposition 5.2. Let k be a multiple of the basic level kb of G. The anti-invariant
theta functions A0 Θµ,k with µ ∈ Λ(Twc )∗kb ∩ kawc form a basis in Γ(Lkwc )−W0 .

   Finally, the following proposition is straight forward to check.
Proposition 5.3. The function Fwc deﬁnes a W0 –anti-invariant holomorphic sec-
                           ∨
tion of the line bundle Lhwc .
5.2. The Kac-Weyl character formula. Throughout this section let G be simply
                                                   e
connected. Let χλ,k denote the character of the L(G)-module      Vλ,k of highest weight
λ and level k. The goal of this section is to ﬁnd an explicit formula for the character
χλ,k viewed as a section of the family of line bundles Lk as described in Section 5.1.
                                                        ∨
   Since F = Fid is a W -anti-invariant section of Lh , the product χλ,k F deﬁnes a
                                                ∨
W -anti-invariant section of the bundle L(k+h ) . By Proposition (5.1), we can write
this product uniquely as
                                         X
(23)         χλ,k (h; τ )F (h; τ ) =                fµ (τ )AΘµ,k+h∨ (h; τ ) .
                                    µ∈Λ(T )∗ ∩(k+h∨ )a

We can naturally identify the lattice Λ(T )∗ , with the weight lattice P of g. So the
sum in equation (23) ranges over P ∩ (k + h∨ )a.
   Now we let τ vary in the upper half plane. In the situation at hand, the diﬀer-
ential equation from theorem 4.1 reads
                                             
           2(k + h∨ ) ∂      1
(24)     −              +        ∆h − hρ, ρi (χλ,k (h, τ )F (h, τ )) =
              2πi    ∂τ   (2πi)2
                                                      hλ, λ + 2ρiχλ,k (h, τ )F (h, τ ),
where ∆h is the Laplacian on h.
   Substituting equation (23) into diﬀerential equation (24) and keeping in mind
that the AΘµ,k are linearly independent, we ﬁnd
                                                                    
                                   2πiτ
(25)          fµ (τ ) = aµ exp              (hλ + ρ, λ + ρi − hµ, µi) ,
                                 2(k + h∨ )
where aµ is a constant depending only on µ. So we get
(26) χλ,k (h, τ )F (h, τ ) =
           X                                                        
                                   2πiτ
                     aµ exp                 (hλ + ρ, λ + ρi − hµ, µi)  AΘµ,k+h∨ (h; τ ).
                                 2(k + h∨ )
        µ∈P ∩(k+h∨ )a

   By deﬁnition of χλ,k , we can write
                             X
(27)         χλ,k (h, τ ) =        dim Vλ,k [µ̃] · q −D(µ̃) exp(2πihµ̃, hi),
                            µ̃∈P (λ,k)

where P (λ, k) ⊂ (h ⊕ CC ⊕ CD)∗ denotes the set of weights of Vλ,k , and for µ̃ ∈
P (λ, k), the space Vλ,k [µ̃] denotes the corresponding weight space. Since Vλ,k is
a highest weight module of highest weight (λ, k, 0), we know that for all weights
e ∈ P (λ, k), the diﬀerence (λ, k, 0) − µ
µ                                                                              e
                                        e has to be a sum of positive roots of L(g).
26                                      R. WENDT


     For any mu ∈ P , let us set
                                                         
                                          kλ + ρk2 − kµk2
                          e = µ, k + h∨ ,
                          µ
                                             2(k + h∨ )
It follows from equation (27) that, whenever aµ 6= 0 in equation (26), then (λ+ρ, k+
h∨ , 0) − µ                                        e
          e has to be a sum of positive roots of L(g).  Furthermore, we have keµk 2 =
               ∨     2
k(λ + ρ, k + h , 0)k and he     ei ≥ 0 for all α
                             α, µ                     e
                                                 e ∈ Π. Together, these observations
imply that µ e = (λ + ρ, k + h∨ , 0) (see e.g. [PS], Lemma 14.4.7).
    Putting everything together, we have proved the following theorem.
Theorem 5.4 (Kac-Weyl character formula). The character χλ,k of the integrable
highest weight module Vλ,k of highest weight λ and level k at the point (h, τ ) ∈ h×H,
where H denotes the upper half plane in C, is given by
                                            AΘλ+ρ,k+h∨ (h, τ )
                           χλ,k (h; τ ) =                      .
                                               F (h, τ )
5.3. Characters for non-connected loop groups. In this section we want to
derive an analogue of the Kac-Weyl character formula in the case that G not simply
connected. As always, let G = G/Z  e where Z = hci is a cyclic subgroup of the center
of the simply connected Lie group G.  e Let k be a multiple of the basic level of G,
and let λ ∈ P+k be invariant under the action of σc on P+k . Let χλ,k denote character
of the L e kb (G)–module Vλ,k . One checks directly, that under the action of σc on
Vλ,k , the weight space Vλ,k [e
                              µ] is mapped to Vλ,k [σc (e µ)]. Recall the deﬁnition of H0
from the beginning of section 4.3. By deﬁnition of the character χσλ,k     c
                                                                             (see section
4.1), we can write
                                     X
(28)                 χσλ,k
                        c
                           (H0 ) =       T r(σc )|Vλ,k [eµ] e2πiheµ,H0 i .
                                  µ
                                  e ∈P (λ,k)
                                  σc (e
                                      µ)=eµ

   On the other hand, W0 -anti-invariance of χσλ,k
                                                c
                                                   , and the diﬀerential equation from
Theorem 4.1 together with Proposition 5.2 imply that we can write
                                          X
(29)        χσλ,k
               c
                  (H0 )Fwc (H0 ) =                        aµ fµ A0 Θµ,k+h∨
                                    µ∈Λ(Twc )∗
                                             k
                                               ∩(k+h∨ )awc
                                                b


where aµ is a constant depending only on µ, and
                                                                     
                            2πiτ
               fµ = exp              (hλ + ρ wc , λ + ρ wc i − hµ, µi)  .
                          2(k + h∨ )
     Let us set                                         
                                                2      2
                                    ∨ kλ + ρwc k − kµk
                        µ
                        e = µ, k + h ,
                                          2(k + h∨ )
Similar to the simply connected case, it follows from equations (28) and (29) that
whenever aµ 6= 0 in equation (29), then (λ + ρwc , k + h∨ , 0) − µ
                                                                 e has to be a σc -
                                   e
invariant sum of positive roots of L(g). Furthermore, we have
                            k(λ + ρwc , k + h∨ , 0)k2 = ke
                                                         µk 2
and he  ei ≥ 0 for all α
     α, µ                  e As in the simply connected case, these observations
                       e ∈ Π.
imply λ + ρwc = µ. So we have proved the following theorem.
                                  CHARACTER FORMULA                                       27


Theorem 5.5. The character χλ,k of the integrable highest weight module Vλ,k of
highest weight λ and level k at the point (σc H0 ) is given by
                                            A0 Θλ+ρwc ,k+h∨ (H0 )
                            χσλ,k
                               c
                                  (H0 ) =                         .
                                                 Fwc (H0 )
5.4. The root system ∆     e σc . Finally, let us take a closer look at the denominator
Fwc (H0 ) appearing in Theorem 5.5. We have to distinguish two cases. First, let us
suppose that for any simple root α   e ∈ Π,e the roots α  e and σc (e
                                                                    α) are not connected
in the Dynkin diagram of ∆. e In this case, one can easily show that σc (eαe ) = eσ (eα) ,
                                                                                    c

so that s(eα) = 1 for all real roots α ∈ ∆   e re . For any root α
                                                                 e∈∆  e let us denote by
eσc its restriction to the subspace e
α                                     hσc ⊂ e h. Then the set
                                         eσc | α
                                    {mαe α       e re }
                                               e∈∆
is the set of real roots of an aﬃne root system which we will denote by ∆         e σc .
   Now suppose that there exists some α           e
                                            e ∈ ∆ such that α    e 6= σc (e
                                                                          α) are not orthog-
onal. Since we have excluded the case that σc is the order n + 1 automorphism of
the extended Dynkin diagram of An , we can assume that σc2 (e         α) = α e. In this case,
one can show that
                               σc (eαe ) = −1ht(eα)+1 eσc (eα) ,
where ht(e α) denotes the height of the root α    e with respect to the basis Π    e (see
e.g.[K], 7.10.1 for the case of ﬁnite root systems). Looking at the ecplicit form of
the automorphism σc , we see that if there exists a simple root α e such that αe 6= σc (e
                                                                                        α)
are not orthogonal, then we have α  e 6= σc (e                           e
                                             α) for all simple roots of ∆. Therefore, if
σc (e
    α) = αe, then there exists some βe ∈ ∆           e 6= βe and βe + σc (β)
                                         e with σc (β)                    e =α e. Hence,
in this case ht(eα) is necessarily even so that s(e α) = −1 whenever σc (e   α) = αe. As
above, the set

       eσc | α
  {mαe α         e σc (e
             e ∈ ∆,    α) 6= α
                             e, and α         α) are orthogonal} ∪
                                    e and σc (e
                   eσc | α
             {2mαe α         e σc (e
                         e ∈ ∆,    α) 6= α
                                         e, and α
                                                e and σc (e
                                                          α) are not orthogonal}

is the set of real roots of an aﬃne root system which we also denote by ∆   e σc . In
                                                     e
both cases, the smallest positive imaginary root of ∆σc is given by δσc = ord(σc )δ,
where δ denotes the smallest positive imaginary root of ∆.e We will list the types
of ∆e σc in the end of this paper.
   Now, using (1 + x)(1 − x) = (1 − x2 ), we can write
                 Y                                  Y                    
                               α)e−2πimαe αe (H0 ) =
                         1 − s(e                         1 − e−2παe (H0 )
            [e   e re )σc
             α]∈(∆                                       α  e re
                                                         e ∈∆
                   +                                          σc +


From this, we see that up to the factor
                            Q∞ Qord(wc )
                                  n=1       j=1   (1 − ǫ−j q n )dim(hj )
                        f (q) =   Q∞                                       ,
                                    n=1 (1   − q ord(σc )n )mult(nδσc )
the function Fwc can be identiﬁed with the Kac-Weyl denominator corresponding to
the aﬃne root system ∆e σc . Similarly, the group W fσc = W0 ⋉ Λ(Twc ) is isomorphic
to the Weyl group of the root system ∆    e σc . So the character χλ,k closely resem-
bles a character of an irreducible highest weight module of an aﬃne Lie algebra
corresponding to the root system ∆ e σc .
28                                       R. WENDT


Remark 5.6. Since we are mainly interested in the case of loop groups based on
connected but not necessarily simply connected Lie groups G, we restricted our
attention to automorphisms σc of the extended Dynkin diagram of ∆ which are
                                                            e of G. The arguments
associated to elements of the center of the universal cover G
in this section can be extended to the case of characters of loop groups based on
non connected Lie groups. In this case, one has to consider the full automorphism
group of the extended Dynkin diagram of ∆.
Remark 5.7. If ∆ e is the root system of an aﬃne Lie algebra L(g),e     and σ is an
automorphism of the Dynkin diagram of ∆   e then the aﬃne Lie algebra corresponding
to the root system ∆e σ is often called the orbit Lie algebra corresponding to L(g)
                                                                               e
                                               e
and σ. The appearance of the root system ∆σ was also realized in [FRS] [FSS],
where for an outer automorphism σ of a (generalized) Kac-Moody Lie algebra g,
the σ-twisted characters of highest weight representations are calculated. It turns
out that these twisted characters can be identiﬁed with untwisted characters of the
orbit Lie algebra corresponding to g and σ.

         6. Appendix: Some data on affine root systems and their
                              automorphisms
   The following table lists some data corresponding to the non-simply connected
Lie groups. The basic levels of non-simply connected Lie groups have been calcu-
                                                            e σ for general automor-
lated in [T]. See also [FSS] for a list of the root systems ∆
                                       e
phisms σ of the Dynkin diagram of ∆. The notation for aﬃne root systems in the
table below is the same as in [K].

  e
  G                    hci       e
                             G = G/hci kb                      e
                                                               ∆         e σc
                                                                         ∆
                                                                (1)        (1)
  SLn         n ≥ 2 Zr                      smallest k with    An−1      An/r−1 if r 6= n
                                            n(n−1)
                                              r2   k   ∈Z                ∅ if r = n
                                                                (1)        (2)
  Spin2n+1    n ≥ 2 Z2       SO2n+1         1                  Bn        A2(n−1)
                                                                 (1)       (2)
  Sp4n        n ≥ 1 Z2                      1                  C2n       A2n
                                                                 (1)       (1)
  Sp4n+2      n ≥ 1 Z2                      2                  C2n+1     Cn
                                                                 (1)       (1)
  Spin4n      n ≥ 2 Z02      SO4n           1                  D2n       C2n−2
                                                                 (1)       (1)
  Spin4n      n ≥ 2 Z±
                     2                      1 if n even        D2n       Bn
                                            2 if n odd
                                                                 (1)       (1)
  Spin4n+2    n ≥ 2 Z2       SO4n+2         1                  D2n+1     C2n−1
                                                                 (1)       (1)
  Spin4n+2    n ≥ 2 Z4       PSO4n+2        4                  D2n+1     Cn
                                                                 (1)       (1)
  E6                   Z3                   3                  E6        G2
                                                                 (1)       (1)
  E7                   Z2                   2                  E7        F4

                                       References
[B]      N. Bourbaki, Groupes et algebres de Lie, Chap.4,5, et 6, Masson, Paris, 1981.
[Br]     G. Brüchert, Trace class elements and cross sections in Kac-Moody groups, Canad. J.
         Math. 50 (1998), 972-1006.
[DK]     J.J. Duistermaat, J.A. Kolk Lie Groups, Springer, Heidelberg, New York, 2000.
                                   CHARACTER FORMULA                                             29


[EF]    P.I. Etingof, I.B. Frenkel, Central extensions of current groups in two dimensions,
        Comm. Math. Phys. 165 (1994), 429-444.
[EFK]   P.I. Etingof, I.B. Frenkel, A.A. Kirillov Jr., Spherical functions on affine Lie groups,
        Duke Math. J. 80 (1995), 59-90.
[EK]    P.I. Etingof, A.A. Kirillov Jr., Representations of affine Lie algebras, parabolic differen-
        tial equations, and Lamé functions, Duke Math. J. 74 (1994), 585-614.
[FM1]   R. Friedman, J.W. Morgan Principal bundles over elliptic curves, e-print
        math.AG/9811130
[FM2]   R. Friedman, J.W. Morgan, Holomorphic principal bundles over elliptic curves. II. The
        parabolic construction, J. Differential Geom. 56 (2000), 301–379.
[FRS]   J. Fuchs, U. Ray, C. Schweigert, Some automorphisms of generalized Kac-Moody alge-
        bras, J. Algebra 191 (1997), 518-540.
[FS]    J. Fuchs, C. Schweigert, The action of Outer Automorphisms on Bundles of Chiral
        Blocks, Comm. Math. Phys. 206 (1999), 691-736.
[FSS]   J. Fuchs, C. Schweigert, B. Schellekens, From Dynkin diagram symmetries to fixed point
        structures, Comm. Math. Phys. 180 (1996), 39-97.
[G]     H. Garland, The arithmetic theory of loop algebras, J. Algebra 53 (1978), 480-551.
[G2]    H. Garland, The arithmetic theory of loop groups, Publ. Math. IHES 52 (1980), 5-136.
[GW]    R. Goodman, N. Wallach, Structure of unitary cocycle representations of loop groups and
        the group of diffeomorphisms of the circle, J. Reine Angew. Math. 437 (1984), 69-133.
[HS]    S. Helmke, P. Slodowy, On unstable bundles over elliptic curves, Publ. Res. Inst. Math.
        Sci. 37 (2001), 349-395.
[K]     V.G. Kac, Infinite-dimensional Lie Algebras, 3rd edition, Cambridge University Press,
        Cambridge, 1990.
[Ko]    B. Kostant Lie algebra cohomology and the generalized Borel-Weil theorem,
        Ann. of Math. 74 (1961), 329-387.
[Lo]    E. Looijenga, Root Systems and Elliptic Curves, Invent. Math. 38 (1976), 17-32.
[M]     S. Mohrdieck, Conjugacy classes of non-connected semisimple algebraic groups, PhD
        thesis, Univ. Hamburg, 2000.
[PS]    A. Pressley, G. Segal, Loop Groups, Oxford University Press, Oxford, 1986.
[R]     A. Ramanathan, Stable principal bundles on a compact Riemann surface, Math. Ann.
        213 (1975), 129-152.
[S]     C. Schweigert, On moduli spaces of flat connections with non-simply connected structure
        group, Nucl. Phys. B 492 (1997), 743-755.
[T]     V. Toledano Laredo, Positive energy representations of the loop groups of non simply
        connected Lie groups, Comm. Math. Phys. 207 (1999), 307-339.
[W]     R. Wendt, Weyl’s character formula for non-connected Lie groups and orbital theory for
        twisted affine Lie algebras, J. Funct. Anal. 180 (2001), 31-65.
