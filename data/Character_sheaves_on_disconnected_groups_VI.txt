                                               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI
arXiv:math/0406115v1 [math.RT] 7 Jun 2004




                                                                                    G. Lusztig


                                                                                  Introduction
                                               Throughout this paper, G denotes a fixed, not necessarily connected, reductive
                                            algebraic group over an algebraically closed field k. This paper is a part of a series
                                            [L9] which attempts to develop a theory of character sheaves on G.
                                               In Section 28 we define the character sheaves on a connected component of G
                                            generalizing the definition in [L3, I,§2]. In Section 29 we prove a semisimplicity
                                            property of the restriction functor, generalizing one in [L3, I,§3]. In Section 30 we
                                            show that any character sheaf is admissible, generalizing a result in [L3, I,§4]. In
                                            Section 31 we show that the restriction functor takes a character sheaf to a direct
                                            sum of character sheaves, generalizing a result in [L3, I,§6].
                                               We adhere to the notation of [L9] and [BBD]. Here is some additional notation.
                                            If K ∈ D(X) and A is a simple perverse sheaf on X we write A ⊣ K instead of
                                            ”A is a subquotient of p H i (K) for some i ∈ Z.” Let M(X) be the subcategory of
                                            D(X) whose objects are the perverse sheaves on X.

                                                                                     Contents
                                               28.   Definition of character sheaves.
                                               29.   Restriction functor for character sheaves.
                                               30.   Admissibility of character sheaves.
                                               31.   Character sheaves and Hecke algebras.

                                                                  28. Definition of character sheaves
                                            28.1. Let T be a torus. For any n ∈ N∗k , let sn (T ) be the category whose objects
                                            are the local systems of rank 1 on T that are equivariant for the transitive T -action
                                            z : t 7→ z n t on T ; let s(T ) be the category whose objects are the local systems on
                                            T that are in sn (T ) for some n as above.
                                               If f : T −  → T ′ is a morphism of tori and L′ ∈ s(T ′ ) then f ∗ L′ ∈ s(T ). The
                                            set s(T ) of isomorphism classes of objects in s(T ) is an abelian group for tensor

                                               Supported in part by the National Science Foundation. The author thanks the Institut des
                                            Hautes Études Scientifiques for its hospitality during a visit (may 2004) when part of the work
                                            on this paper was done.

                                                                                                                     Typeset by AMS-TEX
                                                                                           1
2                                    G. LUSZTIG

product of local systems. Let X = Hom(T, k∗ ) (homomorphisms of algebraic
groups). From the definitions we see that
                                                                ∼
   (a) κ ⊗ E 7→ κ∗ E defines a group isomorphism X ⊗ s(k∗ ) −→ s(T ).
We show:
   (b) for L ∈ s(T ) there exists κ ∈ X and E ∈ s(k∗ ) such that L ∼ = κ∗ E.
Indeed by (a) there exist κi ∈ X , Ei ∈ s(k ), (i ∈ [1, m]) such that L ∼
                                             ∗
                                                                        = ⊗m      ∗
                                                                             i=1 κi Ei .
By 5.3 we have s(k∗ ) = Hom(µ∞ (k∗ ), Q̄∗l ) ∼  = Q′ /Z where Q′ = ∪n∈N∗k n1 Z ⊂ Q.
Hence we can find E ∈ s(k∗ ), ni ∈ Q   N∗k such that Ei ∼
                                                        = E ⊗ni for i ∈ [1, m]. Then
L∼ = ⊗i=1 κi E i ∼
       m    ∗ ⊗n       ∗                 m   n
                   = κ E where κ = i=1 κi and (b) follows.
                                               i


   For any τ ∈ T define hτ : T − → T by hτ (t) = τ t. We show:
   (c) if τ ∈ T, L ∈ s(T ), then h∗τ L ∼
                                       = L.
Let n be such that L ∈ sn (T ). Then for any z ∈ T we have hz n L ∼    = L. We can
                         n
find z ∈ T such that z = τ . This proves (c).
28.2. Let L ∈ s(T ), let κ, E be as in 28.1(b) and let n be the order of E in s(k∗ ).
Then E ∈ sn (k∗ ). We show that the following two conditions for a morphism
f :T −  → T of tori are equivalent:
   (i) f ∗ L ∼
             = L;
   (ii) there exists κ1 ∈ X such that κ ◦ f = κκn1 .
Condition (i) is equivalent to f ∗ κ∗ E ∼ = κ∗ E that is, (κ ◦ f )∗ E ∼
                                                                      = κ∗ E. Using the
injectivity of the map 28.1(a) we see that this is equivalent to (κ ◦ f ) ⊗ (n′ /n) =
κ ⊗ (n′ /n) in X ⊗ Q′ /Z (here n′ ∈ Z, 0 < n′ ≤ n and n′ /n is irreducible) which is
clearly equivalent to condition (ii).
   Assuming that (i),(ii) hold, we show:
   (a) L is T -equivariant for the T -action t0 : t 7→ f (t0 )tt−1
                                                                0 on T .
                       ∗
The map κ : T −    → k is compatible with the T -action (a) on T and the T -action
t0 : z 7→ κ1 (t0 ) z on k∗ . Hence to show that L = κ∗ E is T -equivariant it suffices
                  n

to show that E is T -equivariant. Since the T -action on k∗ comes via κ1 from the
k∗ -action z0 : z 7→ z0n z on k∗ , it suffices to show that E is k∗ -equivariant. This
holds since E ∈ sn (k∗ ).
                    Q
28.3. G acts on B∈B B/UB by

                                                ′
                           x : (gB UB )B∈B 7→ (gB UB )B∈B

       ′                    −1
where gxBx−1 UxBx−1 = xgB x    UxBx−1 . Let
                                        Y              0
                                 T=(         B/UB )G
                                       B∈B

                                                                        ∼
(fixed point set of G0 ). For any B ′ ∈ B we define fB′ : T −→ B ′ /UB′ by
fB′ ((gB UB )B∈B ) = gB′ UB′ . We use fB′ to transport the algebraic group structure
of B ′ /UB′ to an algebraic group structure of T. This structure is independent   of
                ′
                                                                        Q
the choice of B . Thus T is naturally a torus over k. The G action on B∈B B/UB
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                          3

induces a G/G0 -action D : t 7→ D(t) on T, respecting the algebraic group structure
of T. We say that T is the canonical torus of G0 .
                                                             ∼
   For w ∈ W (see 26.1) there is a unique isomorphism T −→ T (denoted again by
w) such that for any (B, B ′ ) ∈ B × B with pos(B, B ′ ) = w we have a commutative
diagram
                          w
                  T    −−−−→                            −−−−→ T
                                                                 
              fB ′ y                                           fB y
                                                                 
                          ∼                              ∼
              B ′ /UB′ ←−−−− (B ∩ B ′ )/(UB ∩ UB′ ) −−−−→ B/UB
where the isomorphisms in the bottom row are induced by the obvious inclusions.
We use this to identify W with a subgroup of the group Aut(T) of automorphisms
of the torus T. Let
                   W• = {wD; w ∈ W, D ∈ G/G0 } ⊂ Aut(T).
This is a subgroup of Aut(T) normalizing W since Dw = ǫD (w)D : T −        → T for
               0
any D ∈ G/G , w ∈ W; here ǫD is as in 26.2.
   Let h, i : Hom(k∗ , T) × Hom(T, k∗ ) −    → Z be the standard pairing. Define
              +                ∗
subsets R, R of Hom(T, k ) as follows. Let B ∈ B and let T be a maximal torus
                                        ∼                            ∼
of B. Consider the isomorphism T −→ T (composition of fB : T −→ B/UB with
                                     ∼
the obvious isomorphism B/UB −→ T ). We require that the subset of Hom(T, k∗ )
corresponding to R (resp. R+ ) under this isomorphism is the set of roots of G0
with respect to T (resp. the set of roots of G0 with respect to T such that the
corresponding root subgroup is contained in B). Let R− = R−R+ . For any α ∈ R
there is a unique α̌ ∈ Hom(k∗ , T) and a unique sα ∈ W such that hα̌, αi = 2 and
sα (t) = tα̌(α(t−1 )) for all t ∈ T. Then s2α = 1 and for L ∈ s(T) we have
(a)                            L∼
                                = s∗α L ⊗ α∗ (α̌∗ L).
For L ∈ s(T) let
                            RL = {α ∈ R; α̌∗ L ∼
                                               = Q̄l }.
Pick κ ∈ Hom(T, k∗ ), E ∈ s(k∗ ) such that L ∼= κ∗ E, see 28.1(b). Let n ∈ N∗k be
the order of E in s(k∗ ). We show:
                           RL = {α ∈ R; hα̌, κi ∈ nZ}.
Indeed, for α ∈ R we have α̌∗ L = α̌∗ κ∗ E = (κ ◦ α̌)∗ E = f ∗ E where f : k∗ −→ k∗
          hα̌,κi
is z 7→ z        . We now use the fact that, for s ∈ Z, the inverse image of E under
  ∗      ∗
k − → k ,z −   → z s is Q̄l if and only if s ∈ nZ.
    Let WL = {a ∈ W• ; (a−1 )∗ L ∼
            •
                                      = L}. Let WL be the subgroup of W generated
by {sα ; α ∈ RL }. From (a) we see that
                                         •
(b)                                WL ⊂ WL .
                                      •
Moreover, WL is a normal subgroup of WL .
4                                         G. LUSZTIG

28.4. In the remainder of this section we fix a connected component D of G. Let
w ∈ W. Let
                                                   −1
    Zw
     D = {(B, ξ); B ∈ B, ξ ∈ UB \D/UB , pos(B, gBg    ) = w for some/any g ∈ ξ}.

28.5. Let B ∗ ∈ B and let T be a maximal torus of B ∗ . We set U ∗ = UB∗ ,
WT = NG0 T /T . For any w ∈ WT we denote by ẇ a representative of w in NG0 T ;
we take 1̇ = 1. We identify WT = W by w ↔ G0 -orbit of (B ∗ , ẇB ∗ ẇ−1 ) and
T = T by

(a)                               t1 ↔ t, t1 U ∗ = fB∗ (t).

Any α ∈ R becomes a root α of G0 with respect to T and α̌ becomes the cor-
responding coroot k∗ −
                     → T . We fix d ∈ ND B ∗ ∩ ND T . For w ∈ W we have a
diagram
                                 φ     ρ
                             T ← − Ẑw → Zw
                                     D −  D

where
                                 ∗        ∗      ∗
                       Ẑw                    0
                         D = {(hU , g); hU ∈ G /U , g ∈ ẇdT },

             ρ(hU ∗ , g) = (hB ∗ h−1 , hU ∗ gU ∗ h−1 ), φ(hU ∗ , g) = d−1 ẇ−1 g.
Now φ is T -equivariant with respect to the T -action
   t0 : (hU ∗ , g) 7→ (ht−1 ∗       −1
                         0 U , t0 gt0 )
on Ẑw
     D and the T -action t0 : Ad(d      ẇ )(t0 )tt−1
                                      −1 −1
                                                   0 on T . Hence if LT ∈ s(T ) satisfies
          −1 ∗       ∼              ∗
Ad((ẇd) ) LT = LT , then φ LT is a T -equivariant local system on Ẑw         D . (See
28.2(a).) Since ρ is a principal T -bundle, there is a well defined local system L̃T
                      ∗       ∗
on ZwD such that ρ L̃T = φ LT .
                                                                   •
28.6. Let w ∈ W. Let L ∈ s(T) be such that wD ∈ WL                   . We associate to L a
                                      w                   ∗   ∗
local system of rank 1 L̃ on ZD as follows. Let B , U , T, d, ẇ be as in 28.5. Using
the identification T = T in 28.5, we transport L to a local system LT in s(T ).
Then L̃T is defined as in 28.5. Let L̃ = L̃T (a local system on Zw       D ). We show:
   (a) the isomorphism class of L̃ is independent of the choice of B ∗ , T, ẇ, d.
Let us replace B ∗ , T, ẇ, d by xB ∗ x−1 , xT x−1 , xẇx−1 , xdx−1 where x ∈ G0 . Define
′ w ′
 ẐD , φ, ′ ρ, ′ LT , ′ L̃T in terms of this new choice in the same way as Ẑw
                                                                             D , φ, ρ, LT , L̃T
                                   ∗
were defined in terms of B , T, ẇ, d. We have a commutative diagram
                             a                 φ               ρ
                      T −−−−→         T     ←−−−− Ẑw        w
                                                    D −−−−→ ZD
                                                          
                     =y                           cy       =y
                                                          
                                     by
                                               ′              ′
                             a′                    φ              ρ
                      T −−−−→ xT x−1 ←−−−− ′ Ẑw        w
                                               D −−−−→ ZD

where b(t) = xtx−1 , c(hU ∗ , g) = (hx−1 xU ∗ x−1 , xgx−1 ), a is given by 28.5(a) and a′
is the analogous isomorphism defined in terms of xB ∗ x−1 , xT x−1 instead of B ∗ , T .
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                   5

Then ′ LT = b∗ LT , ′ φ∗′ LT = c∗ φ∗ LT and ′ L̃T = L̃T . Hence to prove (a) it suffices
to show that if B ∗ , T, ẇ, d are replaced by B ∗ , T, ẇt1 , dt2 where t1 , t2 ∈ T then
the isomorphism class of L̃T does not change. Note that Ẑw       D , ρ remain unchanged
under the replacement above. However the map φ defined in terms of B ∗ , T, ẇ, d
is replaced by the composition of φ with a left translation on T . It remains to use
that the inverse image of LT under a left translation of T is isomorphic to LT , see
28.1(c).
28.7. Let J be a subset of I. For any B ∈ B we denote by QJ,B the unique
parabolic in PJ that contains B; we write UJ,B instead of UQJ,B . Let w ∈ W. Let
 w
Z∅,J,D  be the set of all triples (B, B ′ , gUJ,B ) where B ∈ B, B ′ ∈ B, g ∈ D, gBg −1 =
B ′ , pos(B, B ′ ) = w. The map
                       w
                  ζ : Z∅,J,D → Zw
                             −  D,        (B, B ′ , gUJ,B ) 7→ (B, UB gUB )
is an affine space bundle.
                                   •
   Let L ∈ s(T) be such that wD ∈ WL . Then ζ ∗ L̃ is a local system on Z∅,J,D
                                                                         w

denoted again by L̃.
28.8. Let w = (w1 , w2 , . . . , wr ) be a sequence in W, let [w] = w1 w2 . . . wr and
let
     w
    Z∅,J,D ={(B0 , B1 , . . . , Br , gUJ,B0 ); Bi ∈ B(i ∈ [0, r]), g ∈ D, gB0 g −1 = Br ,
             pos(Bi−1 , Bi ) = wi (i ∈ [1, r])}.
We define a morphism
          w           [w]
     ζ : Z∅,J,D −
                → ZD , (B0 , B1 , . . . , Br , gUJ,B0 ) 7→ (B0 , UB0 n1 n2 . . . nr nUB0 )
where hi ∈ G0 (i ∈ [1, r]) are such that Bi = hi B0 h−1 i , h0 = 1, T0 is a maximal
torus of B0 , ni ∈ NG0 T0 (i ∈ [1, r]) are given by h−1 i−1 hi ∈ UB0 ni UB0 and n ∈
                                 −1
ND B0 ∩ ND T0 is given by hr g ∈ UB0 n.
    This is independent of the choices. (Another choice for hi , g, T0 must be of
the form h′i = hi ui ti , g ′ = gu′ , T ′ = uT0 u−1 where ui ∈ UB0 (i ∈ [1, r]), ti ∈
T0 (i ∈ [1, r]), u ∈ UB0 , u′ ∈ UJ,B0 . Define n′i , n′ in terms of this new choice
in the same way as ni , n were defined in terms of the original choice. We have
n′i = ut−1 i−1 ni ti u
                       −1
                          where t0 = 1 and n′ = ut−1r nu
                                                         −1
                                                            . Hence n′1 n′2 . . . n′r n′ =
un1 n2 . . . nr nu−1 and
                     UB0 n′1 n′2 . . . n′r n′ UB0 = UB0 n1 n2 . . . nr nUB0 ,
                                                                            w
as required.) It is easy to see that ζ is an affine space bundle. Hence Z∅,J,D   is
smooth, connected.
                                         •
   Let L ∈ s(T) be such that [w]D ∈ WL     . The inverse image under ζ of the local
               [w]                       w
system L̃ on ZD is a local system on Z∅,J,D denoted again by L̃.
                                             w        w
   When w has a single term w, we have Z∅,J,D     = Z∅,J,D and L̃ defined above is
the same as L̃ defined in 28.7.
6                                          G. LUSZTIG

28.9. Let s = (s1 , s2 , . . . , sr ) be a sequence in I ∪ {1} and let
        s
      Z̄∅,J,D ={(B0 , B1 , . . . , Br , gUJ,B0 ); Bi ∈ B(i ∈ [0, r]), g ∈ D, gB0 g −1 = Br ,
                pos(Bi−1 , Bi ) = 1 or si (i ∈ [1, r])}.

Let J 0 = {j ∈ [1, r]; sj ∈ I}. For any subset J ⊂ J 0 we consider the sequence
sJ = (s′1 , s′2 , . . . , s′r ) in I ∪ {1} given by s′i = si if i ∈
                                                                  / J and s′i = 1 if i ∈ J ; let
         ′ ′           ′             sJ                                                   s
[sJ ] = s1 s2 . . . sr . Then Z∅,J,D (see 28.8) is the locally closed subvariety of Z̄∅,J,D
defined by the conditions

                     Bi−1 = Bi if i ∈ J , pos(Bi−1 , Bi ) = si if i ∈
                                                                    / J.
            sJ
The sets Z∅,J,D   (J ⊂ J 0 ) form a partition of Z̄∅,J,D
                                                      s
                                                          . We have s∅ = s and the
                           s∅        s                        s
corresponding piece Z∅,J,D = Z∅,J,D is open dense in Z̄∅,J,D       . Let L ∈ s(T) be
                       •                                  s
such that [s]D ∈ WL      . Let L̃ be the local system on Z∅,J,D defined as in 28.8. Let
          s                   s
L̄ = IC(Z̄∅,J,D , L̃) ∈ D(Z̄∅,J,D ). Let

                   Js = {j ∈ J 0 ; sr sr−1 . . . sj . . . sr−1 sr ∈ ǫD (WL )}.
                                                 s
Lemma 28.10. L̄ is a constructible sheaf on Z̄∅,J,D    . More precisely, L̄ is a local
                                     sJ       s
system on the open subset ∪J ⊂Js Z∅,J,D of Z̄∅,J,D and is 0 on its complement; its
                sJ
restriction to Z∅,J,D (for J ⊂ Js ) is isomorphic to L̃ (defined as in 28.8 in terms
of sJ ).
   For the statement above to make sense, we must verify that, if J ⊂ Js , then
[sJ ]D ∈ WL   •
                . This follows from [s]D ∈ WL     •
                                                    and D −1 sr sr−1 . . . sj . . . sr−1 sr D ∈
   •
WL   for all j ∈ J . (See 28.3(b).)
   Let B ∗ , U ∗ , T, ṡj , d be as in 28.5. Using the identification T = T in 28.5 we
transport L to a local system LT ∈ s(T ). Let

               Z̃ s ={(h0 , h1 , . . . , hr , g) ∈ G0 × . . . × G0 × D;
                     h−1        ∗     ∗   ∗               −1          ∗
                      i−1 hi ∈ B ṡi B ∪ B (i ∈ [1, r]), hr gh0 ∈ NG B }.


The map Z̃ s −   s
             → Z̄∅,J,D ,

(a)        (h0 , h1 , . . . , hr , g) 7→ (h0 B ∗ h−1      ∗ −1              ∗ −1
                                                  0 , h1 B h1 , . . . , hr B hr , gUJ,B0 )

is a locally trivial fibration with connected, smooth fibres. For J ⊂ J 0 , the inverse
                                         sJ
image under (a) of the subvariety Z∅,J,D            s
                                               of Z̄∅,J,D is the subvariety Z ′sJ of Z̃ s
defined by the conditions

                  h−1        ∗     ∗                    −1        ∗
                   i−1 hi ∈ B ṡi B (i ∈ [1, r] − J ), hi−1 hi ∈ B (i ∈ J ).
                  CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                        7

It suffices to prove the statement analogous to that in the lemma for the inverse
image under (a) of L̄. For J ⊂ J 0 , define ψJ : Z ′sJ −
                                                       → T by

                            (h0 , h1 , . . . , hr , g) 7→ d−1 ṡ−1
                                                                J n1 n2 . . . nr n


where ni ∈ NG0 T are given by h−1               ∗    ∗                ∗
                                      i−1 hi ∈ U ni U and n ∈ NG B ∩ NG T is given
by hr gh0 ∈ U n. (Here, we write ṡJ = ṡ1 ṡ2 . . . ṡr for sJ = (s′1 , s′2 , . . . , s′r ).) It
      −1           ∗                            ′ ′    ′

suffices to prove the following statement:
   IC(Z̃ s , ψ∅∗ LT ) is a local system on the open subset ∪J ⊂Js Z ′sJ of Z̃ s and is 0
on its complement; its restriction to Z ′sJ (for J ⊂ Js ) is isomorphic to ψJ          ∗
                                                                                           (LT ).
By the change of variables
                                       −1                             −1
                  utd = h−1
                         r gh0 , yi = hi−1 hi (i ∈ [1, r − 1]), yr = hr−1 hr t,


Z̃ s becomes

  {(h0 , y1 , . . . , yr , u, t) ∈ G0 × . . . × G0 × U ∗ × T ; yi ∈ B ∗ ṡi B ∗ ∪ B ∗ (i ∈ [1, r])}

and for J ⊂ J 0 , Z ′sJ becomes the subset of Z̃ s defined by the conditions

                          yi ∈ B ∗ ṡi B ∗ (i ∈ [1, r] − J ), yi ∈ B ∗ (i ∈ J ).

Moreover, ψJ becomes

                           (h0 , y1 , . . . , yr , u, t) 7→ d−1 ṡ−1
                                                                  J n1 n2 . . . nr d


where ni ∈ NG0 T are given by yi ∈ U ∗ ni U ∗ . Since h0 , u, t now play passive roles,
we can omit them. Thus, we set
         ′
             Z̄ s = {(y1 , . . . , yr ) ∈ G0 × . . . × G0 ; yi ∈ B ∗ ṡi B ∗ ∪ B ∗ (i ∈ [1, r])}

and, for J ⊂ J 0 , we denote by ′ Z sJ the subset of ′ Z̄ s defined by the conditions

                          yi ∈ B ∗ ṡi B ∗ (i ∈ [1, r] − J ), yi ∈ B ∗ (i ∈ J ).

Define ′ ψJ : ′ Z sJ −      → T by (y1 , . . . , yr ) 7→ ṡ−1
                                                           J n1 n2 . . . nr where ni ∈ NG0 T are
                       ∗      ∗        ′            −1 ∗
given by yi ∈ U ni U . Let L = Ad(d ) LT . It suffices to prove the following
statement:
   IC(′ Z̄ s , ′ ψ∅∗ L′ ) is a local system on the open subset ∪J ⊂Js ′ Z sJ of ′ Z̄ s and is 0
on its complement; its restriction to ′ Z sJ (for J ⊂ Js ) is isomorphic to ψJ           ∗ ′
                                                                                           L.
                                                     0    ′ s{j}           0
The closures ∆j of the subvarieties ∆j = Z                       (j ∈ J ) are smooth divisors
with normal crossing in ′ Z̄ s . Using [L3, I,1.6] we see that it suffices to prove the
following statement.
8                                                 G. LUSZTIG

   (b) For j ∈ J 0 , the monodromy of ′ ψ∅∗ L′ around the divisor ∆j is trivial if and
only if j ∈ Js ; if this condition is satisfied, then there exists a local system F on
the smooth variety Z = ′ Z s∅ ∪ ∆0j such that F |′ Z s∅ ∼
                                                        = ′ ψ∅∗ L′ and F |∆0j ∼
                                                                              = ′ ψ{j}
                                                                                   ∗
                                                                                       L′ .
Let Uj be the root subgroup of U ∗ with repect to T such that ṡj Uj ṡ−1                ∗
                                                                                    j ∩ U = {1}
                    ∼
and let x : k −→ Uj be an isomorphism. Let α be the root of G0 with respect
to T such that tx(a)t−1 = x(α(t)a) for all t ∈ T , a ∈ k. For a ∈ k we set
y(a) = (ṡ1 , . . . , ṡj−1 , ṡj x(a)ṡ−1                                       ∗
                                        j , ṡj+1 , . . . , ṡr ) ∈ Z. Then y : k −→ Z is a cross
               0                                     0                   0
section to ∆j in Z; we have y(0) ∈ ∆j , y(a) ∈ Z − ∆j for a 6= 0. For a 6= 0 we
have ṡj x(a)ṡ−1         ∗
               j ∈ U ṡj α̌(a)U . Hence
                                        ∗


′                                                                           −1
    ψ∅ (y(a)) = ṡ−1 ṡ1 . . . ṡj−1 ṡj α̌(a)ṡj+1 . . . ṡr = ṡ−1
                                                                  r . . . ṡj+1 α̌(a)ṡj+1 . . . ṡr = t0 β̌j (a)


where βj is the root of G0 with respect to T that corresponds to the reflection
sr . . . sj+1 sj sj+1 . . . sr and t0 is a fixed element of T . We see that y ∗′ ψ∅∗ L′ ∼ = β̌j∗ L′ .
Thus, y ∗′ ψ∅∗ L′ ∼ = Q̄l if and only if β̌j∗ L′ ∼ = Q̄l that is, if sr . . . sj+1 sj sj+1 . . . sr ∈
ǫD (WL ) that is, if j ∈ Js . This proves the first assertion of (b).
    The second assertion of (b) involves only the component G0 of G. Hence to
prove it, we may assume that G = G0 . Let G̃ −         → G be a surjective homomorphism
of connected reductive groups whose kernel is a central torus in G̃ and such that
G̃ has simply connected derived group. The second assertion of (b) for G follows
from the analogous assertion for G̃. Thus, we may assume that G = G0 has
simply connected derived group. We may assume that L′ = κ∗ E where κ ∈
Hom(T, k∗ ), E ∈ s(k∗ ). Let m be the order of E in s(k∗ ). By assumption, we
have β̌j∗ L′ ∼ = Q̄l hence hβ̌j , κi = mm1 with m1 ∈ Z. Since G has simply connected
derived group, we can find κ1 ∈ Hom(T, k∗ ) such that hβ̌j , κ1 i = m1 . Then
hβ̌j , κκ−m                              −m ∗    ∼ ∗                                       −m
          1 i = 0. We have (κκ1 ) E = κ E. Hence replacing κ by κκ1 , we
may assume that hβ̌j , κi = 0. Then there is a unique homomorphism of algebraic
groups χ : B ∗ ṡj B ∗ ∪ B ∗ −   → k∗ such that
                                                −1
                           χ(t) = κ(ṡ−1
                                      r . . . ṡj+1 tṡj+1 . . . ṡr ) for all t ∈ T.


We may assume that ṡj is in the derived subgroup of B ∗ ṡj B ∗ ∪B ∗ . Then χ(ṡj ) = 1.
Define a morphism f˜ : Z −→ k∗ by

          f˜(y1 , . . . , yr ) = χ(ṡ−1  −1          −1                                    −1        −1
                                     j ṡj−1 . . . ṡ1 n1 n2 . . . nj−1 yj nj+1 . . . nr ṡr . . . ṡj+1 )

           = χ(ṡ−1  −1          −1                                    −1        −1
                 j ṡj−1 . . . ṡ1 n1 n2 . . . nj−1 nj nj+1 . . . nr ṡr . . . ṡj+1 ),

where ni ∈ NG T are given by yi ∈ U ∗ ni U ∗ . If yj ∈ B ∗ ṡj B ∗ , we have

          f˜(y1 , . . . , yr ) = κ(ṡ−1        −1 −1 −1              −1
                                     r . . . ṡj+1 ṡj ṡj−1 . . . ṡ1 n1 n2 . . . nj−1 nj nj+1 . . . nr )
          = κ(′ ψ∅ (y1 , . . . , yr )).
                    CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                               9

If yj ∈ B ∗ , we have
  f˜(y1 , . . . , yr ) = χ(ṡ−1          −1                                    −1        −1
                             j−1 . . . ṡ1 n1 n2 . . . nj−1 nj nj+1 . . . nr ṡr . . . ṡj+1 )
                      −1 −1             −1
      = κ(ṡ−1                                                                    ′
            r . . . ṡj+1 ṡj−1 . . . ṡ1 n1 n2 . . . nj−1 nj nj+1 . . . nr ) = κ( ψ{j} (y1 , . . . , yr )).

Hence the local system F = f˜∗ (E) on Z has the required properties and (b) is
verified. The lemma is proved.
Lemma 28.11. In the setup of 28.9 assume that r ≥ 2, that j ∈ [2, r] and
                                             s
sj−1 = sj ∈ I. Let Z1 be the open subset of Z∅,J,D defined by pos(Bj−2 , Bj ) = sj .
                                                                                  ′
Let s′ = (s1 , s2 , . . . , sj−1 , sj+1 , . . . , sr ). Define δ : Z1 −  s
                                                                      → Z∅,J,D by
        (B0 , B1 , . . . , Br , gUJ,B0 ) 7→ (B0 , B1 , . . . , Bj−2 , Bj , Bj+1 , . . . , Br , gUJ,B0 ).
                                   s
Let L̃ be the local system on Z∅,J,D     associated to L as in 28.8; in the case where
               ′                                       s′
j ∈ Js , let L̃ be the analogous local system on Z∅,J,D         associated to L. Let L̃1 be
the restriction of L̃ to Z1 . If j ∈ Js , then L̃1 ∼
                                                   = δ ∗ L̃′ . If j ∈
                                                                    / Js , then δ! L̃1 = 0.
                                     s
                                    {j}        s  s
                           ∅
      Consider the union Z∅,J,D ∪ Z∅,J,D inside Z̄∅,J,D . Recall that we may identify
  s
  ∅       s         {j}    ss             ′
Z∅,J,D = Z∅,J,D , Z∅,J,D = Z∅,J,D . For
                                                                                      ′
                                                                                    s
                     (B0 , B1 , . . . , Bj−2 , Bj , Bj+1 , . . . , Br , gUJ,B0 ) ∈ Z∅,J,D ,

        F ={(B0 , B1 , . . . , Bj−2 , B, Bj , Bj+1 , . . . , Br , gUJ,B0 ); pos(Bj−2 , B) = sj ,
              pos(B, Bj ) = 1 or sj }
                                 s
                                {j}           s                         {j}   s
is a cross section to Z∅,J,D          in Z̄∅,J,D     which intersects Z∅,J,D in the point π de-
fined by B = Bj . If j ∈          / Js , then the proof of Lemma 28.10 shows that the
restriction of L̃ to F − {π} ∼          = k∗ is a local system in s(k∗ ) not isomorphic to
Q̄l . Hence Hci (F − {π}, L̃) = 0 for all i. Now F − {π} is the fibre of δ at
(B0 , B1 , . . . , Bj−2 , Bj , Bj+1 , . . . , Br , gUJ,B0 ). We see that the cohomology with
compact support of any fibre of δ with coefficients in L̃ is 0. Thus, δ! L̃ = 0 as
required.
    Assuming that j ∈ Js , the same argument shows that the restriction of L̃1
to any fibre of δ is Q̄l . Hence L̃ = δ ∗ E where E is a local system of rank 1 on
  s′
Z∅,J,D . The proof of Lemma 28.10 shows that there exists a local system F on
                ′
 s
Z∅,J,D   s
       ∪Z∅,J,D such that F |Z∅,J,D
                             s     = L̃ and F |Z s′                    = L̃′ . Let V be the open subset
                                                               ∅,J,D
     s
of Z̄∅,J,D defined by pos(Bi−1 , Bi ) = si if i ∈ [1, r], i 6= j and pos(Bj−2 , Bj ) = sj .
                       s′
We have V = Z1 ∪ Z∅,J,D    . Then F 1 := F |V is a local system on V such that
                                                                         ′
F 1 |Z1 = L̃1 and F 1 |Z s′              = L̃′ . Define δ̃ : V −  s
                                                               → Z∅,J,D by the same formula as
                               ∅,J,D

δ. Then F 1 , δ̃ ∗ E are local systems on V with the same restriction L̃1 on the open
dense subset Z1 of V . Hence F 1 ∼       = δ̃ ∗ E. Since F 1 |Z s′   = L̃′ , δ̃ ∗ E|Z s′   = E, we
                                                               ∅,J,D                 ∅,J,D

see that L̃′ ∼
             = E. Thus, L̃ ∼  = δ ∗ L̃′ . The lemma is proved.
10                                           G. LUSZTIG

28.12. Let ǫD , ZJ,D be as in 26.2. Let L ∈ s(T). For w ∈ W we define
                  w
             π : Z∅,J,D → ZJ,D , (B, B ′, gUJ,B ) 7→ (QJ,B , QǫD (J),B′ , gUJ,B ).
                        −

                      •             w,L
If w satisfies wD ∈ WL  , we set KJ,D     = π! L̃ ∈ D(ZJ,D ) where L̃ is the local system
      w
on Z∅,J,D defined in 28.7.
                                                                     w
   For a sequence w = (w1 , w2 , . . . , wr ) in W we define πw : Z∅,J,D   −
                                                                           → ZJ,D by

(a)              (B0 , B1 , . . . , Br , gUJ,B0 ) 7→ (QJ,B0 , QǫD (J),Br , gUJ,B0 ).

                                     •              w,L
If w satisfies w1 w2 . . . wr D ∈ WL    , we set KJ,D   = πw! L̃ ∈ D(ZJ,D ) where L̃ is the
                   w
local system on Z∅,J,D defined in 28.8.
                                                                           s
   For a sequence s = (s1 , s2 , . . . , sr ) in I ∪ {1} we define π̄s : Z̄∅,J,D −
                                                                                 → ZJ,D by
                                        •            s,L
(a). If s satisfies s1 s2 . . . sr D ∈ WL , we set K̄J,D = π̄s! L̄ ∈ D(ZJ,D ) where L̄ is as
in 28.9. Then
          s,L
   (b) K̄J,D  ∈ D(ZJ,D ) is a semisimple complex.
This follows by applying the decomposition theorem [BBD, 5.4.5, 5.3.8] to the
proper map π̄.
Proposition 28.13. Let L ∈ s(T) and let A be a simple perverse sheaf on ZJ,D .
The following conditions on A are equivalent:
            w,L                                                  •
  (i) A ⊣ KJ,D    for some w ∈ W such that wD ∈ WL                 ;
               w,L
  (ii) A ⊣ KJ,D for some w = (w1 , w2 , . . . , wr ) with wi ∈ W, w1 w2 . . . wr D ∈
  •
WL  ;
              s,L                                                                             •
  (iii) A ⊣ KJ,D   for some s = (s1 , s2 , . . . , sr ) with si ∈ I∪{1}, s1 s2 . . . sr D ∈ WL  ;
              s,L                                                                             •
  (iv) A ⊣ K̄J,D for some s = (s1 , s2 , . . . , sr ) with si ∈ I∪{1}, s1 s2 . . . sr D ∈ WL .
             s,L                                                                          •
  (v) A ⊣ K̄J,D   for some s = (s1 , s2 , . . . , sr ) with si ∈ I, s1 s2 . . . sr D ∈ WL   .
                                                                  w,L          w,L
   If in (ii), w reduces to a single element w then KJ,D                 = KJ,D      . Thus, (i) =⇒ (ii).
The implication (iii) =⇒ (ii) is trivial. We now prove the implication (ii) =⇒ (iii).
                                                                                                       •
Let w = (w1 , w2 , . . . , wr ) be a sequence in W such that w1 w2 . . . wr D ∈ WL
and let for some i ∈ [1, r], wi′ , wi′′ be elements of W such that wi = wi′ wi′′ and
l(wi ) = l(wi′ ) + l(wi′′ ). Let w̃ = (w1 , . . . , wi−1 , wi′ , wi′′ , wi+1 , . . . , wr ). The map

      (B0 , B1 , . . . , Br+1 , gUJ,B0 ) 7→ (B0 , B1 , . . . , Bi−1 , Bi+1 , . . . , Br+1 , gUJ,B0 )
                           w̃       w  ∼
defines an isomorphism ZJ,D   −→ ZJ,D   compatible with the maps πw̃ , πw and with
                                 w̃     w
the local systems L̃ defined on ZJ,D , ZJ,D in terms of L as in 28.8. Hence
                                            w̃,L    w,L
(a)                                        KJ,D  = KJ,D .
                                                                          ′
                                     w,L              w ,L
Applying (a) repeatedly we see that KJ,D is equal to KJ,D  for some sequence w′
in I. Thus, (ii) =⇒ (iii).
                 CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                             11

   We prove the equivalence of (iii),(iv). Let s = (s1 , s2 , . . . , sr ) be a sequence in
                                      •
I ∪ {1} such that s1 s2 . . . sr D ∈ WL . Let L̄ be as in 28.9.
                      0         1                               s
   Define a sequence Z ⊃ Z ⊃ . . . of closed subsets of Z̄∅,J,D          by

                                       i                        sJ
                                           Z = ∪J ⊂J 0 ;|J |≥i Z∅,J,D .

Let f i : i Z −   w
              → Z̄∅,J,D , f ′i : i Z − i+1 Z −   s
                                             → Z̄∅,J,D be the inclusions. The natural
distinguished triangle in D(ZJ,D )

                        (π̄s! f ′i! (f ′i )∗ L̄, π̄s! f!i (f i )∗ L̄, π̄s! f!i+1 (f i+1 )∗ L̄)

gives rise for any i ≥ 0 to a long exact sequence in M(ZJ,D ):
                                                                  sJ ,L
     → p H j−1 (π̄s! f!i+1 (f i+1 )∗ L̄) −
 ... −                                   → ⊕J ⊂Js ;|J |=i p H j (KJ,D   )
(b)
                                                                                     sJ ,L
 −                              → p H j (π̄s! f!i+1 (f i+1 )∗ L̄) −
  → p H j (π̄s! f!i (f i )∗ L̄) −                                 → ⊕J ⊂Js p H j+1 (KJ,D   )−
                                                                                            → ....
                                                                               |J |=i

                                                                                                 s ,L
Here we have used the isomorphism π̄s! f ′i! (f ′i )∗ L̄ = ⊕J ⊂Js ;|J |=i KJ,D J
                                                                                    which
follows from Lemma 28.10. Note that
                               s,L
   (∗) π̄s! f!0 (f 0 )∗ L̄ = K̄J,D , π̄s! f!i (f i )∗ L̄ = 0 for i large.
                                                                          s     s
We set m(s) = ♯(i ∈ [1, r]; si ∈ I). If m(s) = 0 then Z∅,J,D                = Z̄∅,J,D and
   s,L              s,L                                               s,L                           s,L
KJ,D      = K̄J,D        . Hence in this case we have A ⊣ KJ,D            if and only if A ⊣ K̄J,D       . It
suffices to verify the following statement.
    (c) Assume that s satisfies m(s) = m ≥ 1 and that for any sequence s′ =
(s′1 , s′2 , . . . , s′r ) in I ∪ {1} with s′1 s′2 . . . s′r D ∈ WL  •
                                                                        and with m(s′ ) < m we have
             ′
            s ,L                    s,L                             s,L
A 6⊣ KJ,D         . Then A ⊣ KJ,D       if and only if A ⊣ K̄J,D        .
Using (b) and our hypothesis we see that for any i > 0 we have A ⊣ π̄s! f!i (f i )∗ L̄ if
and only if A ⊣ π̄s! f!i+1 (f i+1 )∗ L̄. Applying this repeatedly for i = N, N − 1, . . . , 1
(with N large) we see that A 6⊣ π̄s! f!1 (f 1 )∗ L̄. Using this, together with (b) we see
                      s,L                                                          s,L
that A ⊣ KJ,D               if and only if A ⊣ π̄s! f!0 (f 0 )∗ L̄ that is, A ⊣ K̄J,D   (see (∗)). This
proves (c). The equivalence of (iii),(iv) is established.
    The equivalence of (iv),(v) is obvious.
                                                                                               •
    Let s = (s1 , s2 , . . . , sr ) be a sequence in I such that s1 s2 . . . sr D ∈ WL           . Assume
that r ≥ 2 and that, for some j ∈ [2, r] we have sj−1 = sj . We have a partition
  s                                                                                                    s
Z∅,J,D       = Z1 ∪ Z2 where Z1 (resp. Z2 ) is the open (resp. closed) subset of Z∅,J,D
defined by pos(Bj−2 , Bj ) = sj (resp. by Bj−2 = Bj ). Let π1 , π2 be the restrictions
                                                                                s,L
of πs to Z1 , Z2 . The natural distinguished triangle (π1! L̃, KJ,D                 , π2! L̃) in D(ZJ,D )
                                                   s
(where the restrictions of L̃ from Z∅,J,D to Z1 , Z2 are denoted again by L̃) gives
rise to a long exact sequence in M(ZJ,D ):
                                       s,L
            → p H i (π1! L̃) −
        ... −                → p H i (KJ,D  → p H i (π2! L̃) −
                                           )−                → p H i+1 (π1! L̃) −
                                                                                → ....
12                                                   G. LUSZTIG

Let s′ = (s1 , s2 , . . . , sj−1 , sj+1 , . . . , sr ), s′′ = (s1 , s2 , . . . , sj−2 , sj+1 , . . . , sr ). Then
      δ : (B0 , B1 , . . . , Br , gUJ,B0 ) 7→ (B0 , B1 , . . . , Bj−2 , Bj , Bj+1 , . . . , Br , gUJ,B0 )
                                                                         ′
makes Z1 into a locally trivial k∗ -bundle over Z∅,J,D
                                                 s
                                                       and
          (B0 , B1 , . . . , Br , gUJ,B0 ) 7→ (B0 , B1 , . . . , Bj−2 , Bj+1 , . . . , Br , gUJ,B0 )
                                                                                    ′′
                                                         s
makes Z2 into a locally trivial affine line bundle over Z∅,J,D . The local system L̃
                                                                                   ′′
                                                       s
on Z2 is the inverse image of the local system L̃ on Z∅,J,D  defined as in 28.8 in
terms of L. By Lemma 28.11, if j ∈ Js , the local system L̃ on Z1 is the inverse
                                          s′
image under δ of the local system L̃ on Z∅,J,D defined as in 28.8 in terms of L; if
j∈/ Js , then δ! L̃ = 0. It follows that
                                                                ′′
                                                           s ,L
                                                 π2! L̃ = KJ,D  [[−1]]

and, if j ∈/ Js , we have π1! L̃ = 0. If j ∈ Js , we have a natural distinguished
                    s′ ,L          s′,L
triangle (π1! L̃, KJ,D    [[−1]], KJ,D  ) in D(ZJ,D ). Hence we have long exact sequences
in M(ZJ,D ):
(d)
                                    s,L                s′′ ,L
      → p H i (π1! L̃) −
  ... −                  → p H i (KJ,D  )− → p H i−2 (KJ,D          → p H i+1 (π1! L̃) −
                                                              )(−1) −                  → ...,
(e)
                                   s′ ,L                 s′ ,L
      → p H i (π1! L̃) −
  ... −                → p H i−2 (KJ,D         → p H i (KJ,D
                                         )(−1) −                → p H i+1 (π1! L̃) −
                                                               )−                  → ...,
if j ∈ Js , and isomorphisms
                                                      ∼                  ′′
                                   p         s,L                s ,L
(f)                                    H i (KJ,D ) −→ p H i−2 (KJ,D  )(−1)
if j ∈
     / Js .
                                                                  s,L
    We prove that (v) =⇒ (i). Assume that A ⊣ KJ,D                     where s = (s1 , s2 , . . . , sr )
is as in (v). We may assume that r is minimum possible. We want to show that
(i) holds. Assume first that l(s1 s2 . . . sr ) < r. We show that this contradicts the
minimality of r. We can find j ∈ [2, r] such that l(sj sj+1 . . . sr ) = r − j + 1 and
l(sj−1 sj . . . sr ) < r−j +2. We can find s′j , s′j+1 , . . . , s′r ∈ I such that s′j s′j+1 . . . s′r =
sj sj+1 . . . sr = y and s′j = sj−1 . Let
           u′ = (s1 , s2 , . . . , sj−1 , s′j , s′j+1 , . . . , s′r ),   u′′ = (s1 , s2 , . . . , sj−1 , y).
                                             ′             ′′
                  s,L    u ,L    u ,L
From (a) we have KJ,D = KJ,D  = KJ,D  . Hence we may assume that sj−1 = sj .
                                                          ′′
                                          s ,L
If j ∈
     / Js then (f) shows that A ⊣ KJ,D         ; since the sequence s′′ has r − 2 terms,
this contradicts the minimality of r. Assume now that j ∈ Js . By the minimality
                    s′ ,L
of r we have A 6⊣ KJ,D    . From (e) it follows that A 6⊣ π1! L̃. This, together with (d)
                            ′′
                        s ,L
shows that A ⊣ KJ,D          . This again contradicts the minimality of r. We see that
                                            s,L      w,L
l(s1 s2 . . . sr ) = r. By (a), we have KJ,D    = KJ,D   where w = s1 s2 . . . sr and the
desired conclusion follows. Thus, we have (v) =⇒ (i). The proposition is proved.
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                           13

28.14. Let A be a simple perverse sheaf on ZJ,D and let L ∈ s(T). We write A ∈
  L
ŽJ,D  if A satisfies the equivalent conditions (i)-(v) in 28.13. We write A ∈ ŽJ,D if
        L
A ∈ ŽJ,D   for some L ∈ s(T); we then say that A is a parabolic character sheaf on
ZJ,D (see [L10]).
    In the case where J = I we identify D = ZJ,D by g 7→ (G0 , G0 , g); we write
A ∈ ĎL , A ∈ Ď instead of A ∈ ŽJ,D
                                    L
                                       , A ∈ ŽJ,D . We say that A is a character sheaf
on D if A ∈ Ď.
                                             w,L     s,L     s,L             w,L    s,L
    In the case where J = I we write KD          , KD    , K̄D   instead of KJ,D , KJ,D ,
   s,L
K̄J,D .
28.15. Let A ∈ ŽJ,D . We can find n ∈ N∗k and L ∈ sn (T) such that A ∈ ŽJ,D
                                                                          L
                                                                              .
We show that
  (a) A is equivariant for the action

              (z, x) : (P, P ′ , gUP ) 7→ (xP x−1 , xP ′ x−1 , xz n gx−1 UxP x−1 )

of H = D ZG0
             0 × G
                  0
                    on ZJ,D .
                                       •
We can find w ∈ W such that wD ∈ WL      and A ⊣ π! L̃ where L̃ is the local system
     w                             w
on Z∅,J,D defined in 28.7 and π : Z∅,J,D −
                                         → ZJ,D is as in 28.12. Now H acts on
  w
Z∅,J,D and on ZwD  by

           (z, x) : (B, B ′ , gUJ,B ) 7→ (xBx−1 , xB ′ x−1 , xz n gx−1 UJ,xBx−1 ),

               (z, x) : (B, UB gUB ) 7→ (xBx−1 , UxBx−1 xz n gx−1 UxBx−1 )
                      w
and π and ζ : Z∅,J,D       → Zw
                           −   D (see 28.7) are compatible with the H-actions. It then
suffices to show that the local system L̃ on Zw     D (see 28.6) is H-equivariant. Let
B ∗ , U ∗ , T, d, ẇ be as in 28.5. Let LT ∈ s(T ) be as in 28.6. We have LT ∈ sn (T ).
                                                                                      φ           ρ
It suffices to show that L̃T (see 28.5) is H-equivariant. Let T ← − ẐwD −→ Zw  D
be as in 28.5. Now H acts on T by (z, x) : t 7→ z n t and on Ẑw   D  by (z, x)  :
     ∗            ∗ n
(hU , g) 7→ (xhU , z g); note that φ, ρ are compatible with the H-actions. Using
the definitions we see that it suffices to show that LT is H-equivariant. This
follows from the fact that LT ∈ sn (T ). This proves (a).
                                                                                           •
28.16. Consider a sequence s = (s1 , s2 , . . . , sr ) in I ∪ {1} with s1 s2 . . . sr D ∈ WL .
     ′                                                                            •        •
Let s = (s2 , s3 , . . . , sr , ǫD (s1 )). We have s2 s3 . . . sr ǫD (s1 )D ∈ s1 WL s1 = WL′
where L′ = s∗1 L ∈ s(T). We have an isomorphism
                 ∼       ′
         s
        Z∅,I,D     s
               −→ Z∅,I,D , (B0 , B1 , . . . , Br , g) 7→ (B1 , B2 , . . . , Br , gB1 g −1 , g),

                                    s
under which the local system L̃ on Z∅,I,D defined in 28.8 in terms of L corresponds
                                                 ′
to the analogous local system L̃′ on Z∅,I,D
                                      s
                                            defined in terms of L′ . It follows that
                     ′   ′
        s,L    s ,L
   (a) KD   = KD    .
14                                      G. LUSZTIG

28.17. Let s = (s1 , s2 , . . . , sr ) be a sequence in I ∪ {1} such that s1 s2 . . . sr D ∈
  •
WL  . Let m = ♯(i ∈ [1, r]; si 6= 1) + dim G. For any j ∈ Z we have:

                             p          s,L ∼ p 2m−j    s,L
(a)                              H j (K̄D  )= H      (K̄D   )

(in M(D)). This is a special case of the ”relative hard Lefschetz theorem” [BBD,
                                                   s
6.2.10] applied to the projective morphism π̄s : Z̄∅,I,D −
                                                         → D and to the perverse
                 s
sheaf L̄[m] on Z̄∅,I,D .

              29. Restriction functor for character sheaves
29.1. Let D be a connected component of G and let P be a parabolic of G0
such that ND P 6= ∅. Let L be a Levi of P . Let G′ = NG P ∩ NG L, a reductive
group with G′0 = L. Let D′ = G′ ∩ D, a connected component of G′ . Let
     ′
resDD : D(D) −  → D(D′ ) be as in 23.3. Let α = dim UP . We write ǫ : W −           →W
instead of ǫD : W −  → W (see 26.2).
                                                 ′
   In this section we begin the study of resD  D (A) where A is a character sheaf on
                                                          ′
D. One the the main result of this section is that resD  D (A) is a direct sum of shifts
of character sheaves on D′ . (Here the words ”shifts of” can be omitted but this
will only come after further work in section 31.) The results in this section extend
results in the connected case that appeared in [L3, I,§3]. An obscure point in the
proof in [L3, I, 3.5] (pointed out to me by J.G.M. Mars in 1985) is here eliminated
following in part [L11].
   Let B† be the variety of Borel subgroups of L. We show that the canonical
torus T of G0 (see 28.3) is canonically isomorphic         to the analogously      defined
                     †
canonical torus T of L. We define a map B∈B B/UB −                 →
                                                   Q                   Q
                                                                          β∈B † β/Uβ by
                                              †
(gB UB )B∈B 7→ (hβ Uβ ) where, for β ∈ B , hβ is the image of gβUP under the
obvious homomorphism βUP −      → β. This map restricts to a map T −     → T† which is
                                                                    †
an isomorphism of tori. We use this isomorphism to identify T = T.
   Similarly, the Weyl group W of G0 (see 26.1) contains the analogously defined
Weyl group W† of L as a subgroup. The imbedding W† −              → W is obtained by
associating to the L-orbit of (β, β ′ ) ∈ B† ×B† the G0 -orbit of (βUP , β ′ UP ) ∈ B ×B.
If J is the subset of W† analogous to the subset I of W, then the imbedding
W† −   → W restricts to an imbedding J ⊂ I. The length function of W† is just
the restriction of the length function of W. With the notation of 26.1, we have
W† = WJ . Define pos† : B† × B† −          → WJ in terms of L in the same way as
pos : B × B −→ W was defined in terms of G0 .
   For any Borel B of G0 we set P B = (P ∩ B)UP , a Borel of P .
                                                                       ∼
   Let J W be as in 26.1. Then y 7→ WJ y is a bijection J W −→ WJ \W. We
also have a bijection from the set of P -orbits on B (for the conjugation action) to
WJ \W: the P -orbit of B ∈ B corresponds to the WJ coset of pos(P B , B) ∈ W.
Let v(y) be the P -orbit on B corresponding to WJ y, y ∈ W.
   If y ∈ J W and s ∈ I, there are three possibilities for ys:
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                  15

   (i) ys ∈ J W and l(ys) > l(y); then v(y) ⊂ v(ys) − v(ys).
   (ii) ys ∈ J W and l(ys) < l(y); then v(ys) ⊂ v(y) − v(y).
            / J W; then ysy −1 ∈ J and v(ys) = v(y).
   (iii) ys ∈
For any y ∈ W, g ∈ D we have gv(y)g −1 = v(ǫ(y)).
   Define a homomorphism π : NG P −    → G′ by π(zω) = z where z ∈ G′ , ω ∈ UP
(see 1.26).
29.2. Until the end of 29.9 we fix a sequence s = (s1 , s2 , . . . , sr ) in I and L ∈ s(T)
                              •
such that s1 s2 . . . sr D ∈ WL . Let Js ⊂ [1, r] be as in 28.9.
                       s            s
    We shall write Z̄ instead of Z̄∅,I (see 28.9). For any subset T of [1, r] let Z sT be
the subset of Z̄ s defined by the conditions Bi−1 = Bi if i ∈ T , pos(Bi−1 , Bi ) = si
     / T . We have a partition Z̄ s = ⊔T ⊂[1,r] Z sT . Let
if i ∈

                       Z̄ ′ = {(B0 , B1 , . . . , Br , g) ∈ Z̄ s ; g ∈ ND P }.

Define π̄ ′ : Z̄ ′ −
                   → D′ by (B0 , B1 , . . . , Br , g) 7→ π(g).
   Any sequence y = (y0 , y1 , . . . , yr ) in J W defines a locally closed subvariety Z̄y′
of Z̄ ′ :

          Z̄y′ = {(B0 , B1 , . . . , Br , g) ∈ Z̄ s ; g ∈ ND P, Bi ∈ v(yi )(i ∈ [0, r])}.

Clearly, Z̄y′ = ∅ unless y satisfies

(a)              yi = yi−1 or yi = yi−1 si for all i ∈ [1, r], ǫ(y0) = yr .

Let iy : Z̄y′ −
              → Z̄ s be the inclusion. Let π̄y′ : Z̄y′ −
                                                       → D′ be the restriction of π̄ ′ .
29.3. Until the end of 29.11 we fix a sequence y satisfying 29.2(a). We set

               d(y) = α + ♯(i ∈ [1, r]; yi−1 si ∈ J W, l(yi−1 si ) < l(yi−1 )
                     = α + ♯(i ∈ [1, r]; yisi ∈ J W, l(yi si ) < l(yi )).

We show that these two definitions of d(y) are equivalent. Let
   c = ♯(i ∈ [1, r]; yi−1 = yi , yi si ∈ J W, l(yi−1 si ) < l(yi−1 )),
   d = ♯(i ∈ [1, r]; l(yi) − l(yi−1 ) = −1),
   e = ♯(i ∈ [1, r]; l(yi) − l(yi−1 ) = 1).
The two definitions of d(y) are α + c + d, α + c + e. Hence it suffices to show that
d = e. Clearly, l(yr ) − l(y0 ) = e − d. Since yr = ǫ(y0 ), we have l(yr ) = l(y0 ) hence
e = d, as required. An equivalent definition of d(y) is

                d(y) = α + ♯(i ∈ [1, r]; v(yisi ) ⊂ v(yi ) − v(yi ))
                      = α + ♯(i ∈ [1, r]; v(yi−1si ) ⊂ v(yi−1 ) − v(yi−1 )).
16                                           G. LUSZTIG

We define a sequence (s̃1 , s̃2 , . . . , s̃r ) in I ∪ {1} by

                   s̃i = si if yi−1 si ∈ WJ yi ,       s̃i = 1 if yi−1 si ∈
                                                                          / WJ yi .

Define t = (t1 , t2 , . . . , tr ) by ti = yi−1 s̃i yi−1 . Then ti ∈ J ∪ {1} and

                          −1
            ti = yi−1 si yi−1 if yi−1 si ∈ WJ yi−1 , ti = 1 if yi−1 si ∈
                                                                       / WJ yi−1 .

Let

      Z̄ t† = {(β0 , β1 , . . . , βr , h) ∈ B† × . . . × B† × D′ ; pos† (βi−1 , βi ) = 1 or ti ,
           βr = hβ0 h−1 }.

                         s
This is a variety like Z̄∅,I in 28.9 with G, D, s, I replaced by G′ , D′ , t, J. Define

      ρ : Z̄y′ −
               → Z̄ t† , (B0 , B1 , . . . , Br , g) 7→ (π(P B0 ), π(P B1 ), . . . , π(P Br ), π(g)).

Lemma 29.4. ρ is an iterated affine space bundle with fibres of dimension d(y).
  Let F be the fibre of ρ over (β0 , β1 , . . . , βr , h) ∈ Z̄ t† . We show only that
  (a) F is an iterated affine space bundle over a point and dim F = d(y).
For any k ∈ [0, r] let Fk be the set of all sequences (B0 , B1 , . . . , Bk ) in B such that

 pos(Bi−1 , Bi ) = 1 or si (i ∈ [1, k]), Bi ∈ v(yi )(i ∈ [0, k]), π(P Bi ) = βi (i ∈ [0, k]).

Let Fr+1 = F . We have obvious maps

                                     ξr+1        ξr           ξr−1        ξ1
                       F = Fr+1 −−−→ Fr −→ Fr−1 −−−→ . . . −→ F0 .

It is easy to see that F0 ∼   = kl(y0 ) and that ξr+1 : Fr+1 −
                                                             → Fr is an affine space
bundle with fibres of dimension α − l(yr ) = α − l(y0 ). Moreover, for i ∈ [1, r],
   (b) ξi : Fi −   → Fi−1 is an affine space bundle with fibres of dimension 1 if
v(yi si ) ⊂ v(yi ) − v(yi ) and of dimension 0, otherwise.
Now (a) follows from (b). This completes the proof.
29.5. Let J = {i ∈ [1, r]; s̃i = 1}. We have J = J1 ⊔ J2 where

                      J1 = {i ∈ J ; v(yi−1 ) ⊂ v(yi−1 si ) − v(yi−1 si )},
                      J2 = {i ∈ J ; v(yi−1 si ) ⊂ v(yi−1 ) − v(yi−1 )}.

Let K0 = {i ∈ [1, r]; ti ∈ J}. We have

                                             J ∩ K0 = ∅.
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                       17

Indeed, if i ∈ J ∩ K0 then s̃i = 1 hence v(yi ) 6= v(yi−1 si ), v(yi ) = v(yi−1 ),
v(yi−1 ) 6= v(yi−1 si ) and ti ∈ J, s̃i = 1 hence v(yi−1 si ) = v(yi−1 ), a contradiction.
   We show:
   (a) If i ∈ K0 then v(yi si ) = v(yi ). If i ∈ J1 then v(yi ) ⊂ v(yi si ) − v(yi si ). If
i ∈ J2 then v(yi si ) ⊂ v(yi ) − v(yi ).
Assume first that i ∈ K0 . Then ti 6= 1, v(yi−1 si ) = v(yi−1 ), si 6= 1. If v(yi ) =
v(yi−1 ) we get v(yi si ) = v(yi ); if v(yi ) = v(yi−1 si ) we get again v(yi si ) = v(yi ).
   Assume next that i ∈ J1 . Then v(yi−1 ) ⊂ v(yi−1 si ) − v(yi−1 si ), s̃i = 1,
v(yi ) 6= v(yi−1 si ) hence v(yi ) = v(yi−1 ) and v(yi ) ⊂ v(yi si ) − v(yi si ).
   Finally, assume that i ∈ J2 . Then v(yi−1 si ) ⊂ v(yi−1 ) − v(yi−1 ), s̃i = 1,
v(yi ) 6= v(yi−1 si ) hence v(yi ) = v(yi−1 ) and v(yi si ) ⊂ v(yi ) − v(yi ).
29.6. For any subset K ⊂ K0 let

        Z tK † = {(β0 , β1 , . . . , βr , h) ∈ Z̄ t† ; pos† (βi−1 , βi ) = ti (i ∈ [1, r] − K),
              βi−1 = βi (i ∈ K)}.

We shall write Z t† instead of Z t∅ † . We have Z̄ t† = ⊔K⊂K0 Z tK † . Hence Z̄y′ =
            ′              ′
⊔K⊂K0 Zy,K      where Zy,K     = ρ−1 (Z tK † ). We show that for (B0 , B1 , . . . , Br , h) ∈
  ′
Z̄y,K  , conditions (i),(ii) below are equivalent:
    (i) K ∪ J1 ⊂ {i ∈ [1, r]; Bi−1 = Bi } ⊂ K ∪ J ;
    (ii) {i ∈ K0 ; π(P Bi−1 ) = π(P Bi )} = K.
Assume that (i) holds. If i ∈ K, then by (i) we have Bi−1 = Bi hence π(P Bi−1 ) =
π(P Bi ). Conversely, let i ∈ K0 be such that π(P Bi−1 ) = π(P Bi ). Using 29.4(b)
we see that Bi−1 = Bi (since v(yi si ) 6⊂ v(yi ) − v(yi ), by 29.5(a)). Using (i) we see
that i ∈ K ∪ J . Since K0 ∩ J = ∅ we deduce that i ∈ K. We see that (i) =⇒ (ii).
    Assume that (ii) holds. If i ∈ K then, by (ii), we have π(P Bi−1 ) = π(P Bi );
using (b) we see that Bi−1 = Bi (since v(yi si ) 6⊂ v(yi ) − v(yi ), by (c)). If i ∈ J1
then s̃i = 1, v(yi ) 6= v(yi−1 si ) hence v(yi ) = v(yi−1 ) and v(yi−1 ) 6= v(yi−1 si ).
Then ti = 1 hence π(P Bi−1 ) = π(P Bi ). Using (b) we see that Bi−1 = Bi (since
v(yi si ) 6⊂ v(yi ) − v(yi ), by (c)). Thus, the first inclusion in (i) holds. Conversely,
if i ∈ K0 , Bi−1 = Bi then π(P Bi−1 ) = π(P Bi ) and using (ii) we see that i ∈ K. If
i ∈ [1, r] − K0 , Bi−1 = Bi , then ti = 1, v(yi−1 si ) 6= v(yi−1 ), v(yi ) = v(yi−1 ) hence
v(yi ) 6= v(yi−1 si ), s̃i = 1 hence i ∈ J . Thus the second inclusion in (i) holds. We
see that (ii) =⇒ (i).
    The equivalence of (i),(ii) can be also formulated as follows:
                              ′
(a)                          Zy,K = ⊔J ′ ;J ′ ⊂J2 Z sK∪J1 ∪J ′ ∩ Z̄y′ .

29.7. Let (β0 , β1 , . . . , βr , h) ∈ Z̄ tK † and let F, Fk , ξk be as in 29.4. From 29.6(a)
we see that
                                F = ⊔J ′ ;J ′ ⊂J2 (F ∩ Z sK∪J1 ∪J ′ ).
For i ∈ [1, r], let F i = {(B0 , B1 , . . . , Br , g) ∈ F ; Bi−1 = Bi }. We show:
18                                             G. LUSZTIG

   (a) For i ∈ J2 , F i is a smooth hypersurface in F . For i ∈ K ∪ J1 we have
F i = F . For i ∈ [1, r] − (K ∪ J ) we have F i = ∅.
If F i 6= ∅ then, using F ⊂ ∪J ′ ⊂J2 Z sK∪J1 ∪J ′ , we see that i ∈ K ∪ J1 ∪ J ′ for some
J ′ ⊂ J2 ; thus, i ∈ K ∪ J . In the rest of the proof we assume that i ∈ K ∪ J .
   For each k ∈ [i, r] let Fki be the set of all (B0 , B1 , . . . , Bk ) ∈ Fk such that
                     i
Bi−1 = Bi . Let Fr+1    = F i . From the definitions we see that for k ∈ [i + 1, r + 1]
we have a cartesian diagram
                                         Fki     −−−−→     Fk
                                                           
                                                         ξk y
                                                           
                                         y
                                        i
                                       Fk−1 −−−−→ Fk−1
where the horizontal maps are inclusions.
   Assume first that i ∈ J2 . Using the cartesian diagram above, it suffices to
show that Fii is a smooth hypersurface in Fi . From 29.5(a) we see that v(yi si ) ⊂
v(yi ) − v(yi ); hence ξi : Fi −
                               → Fi−1 is an affine line bundle (see 29.4(b)). It suffices
                                                       ∼
to show that ξi restricts to an isomorphism Fii −→ Fi−1 . Let (B0 , B1 , . . . , Bi−1 ) ∈
Fi−1 . It suffices to show that (B0 , B1 , . . . , Bi−1 , Bi−1 ) ∈ Fi . Hence it suffices to
show that v(yi−1 ) = v(yi ) and βi−1 = βi . Since i ∈ J we have s̃i = 1 hence
v(yi ) 6= v(yi−1 si ) hence v(yi ) = v(yi−1 ) and ti = 1. Since pos† (βi−1 , βi ) = 1 or ti ,
we see that βi−1 = βi , as required.
   Assume next that that i ∈ K ∪ J1 . Using the cartesian diagram above, it
suffices to show that Fii = Fi . From 29.5(a) we see that v(yi si ) 6⊂ v(yi ) − v(yi );
hence ξi : Fi −   → Fi−1 is an isomorphism (see 29.4(b)). It suffices to show that
                                         ∼
ξi restricts to an isomorphism Fii −→ Fi−1 . If i ∈ J1 this is shown exactly as
in the first part of the proof. Assume now that i ∈ K. We have ti 6= 1 hence
v(yi−1 si ) = v(yi−1 ) = v(yi ). From the definitions we have βi−1 = βi . Hence
     ∼
Fii −→ Fi−1 as in the first part of the proof. This proves (a).
Lemma 29.8. The map ρ1 : Z̄y′ ∩ Z sJ −
                                     → Z t† (restriction of ρ) is an iterated
affine space bundle.
   Let (β0 , β1 , . . . , βr , h) ∈ Z t† . We show only that the fibre F̄ of ρ1 at
(β0 , β1 , . . . , βr , h) is an iterated affine space bundle over a point and

                   dim F̄ = α + ♯(i ∈ [1, r] − J ; v(yi si ) ⊂ v(yi ) − v(yi )).
For any k ∈ [0, r] let

     F̄k ={(B0 , B1 , . . . , Bk ) ∈ Bk+1 ; pos(Bi−1 , Bi ) = si (i ∈ [1, k], i ∈
                                                                                / J ),
           Bi−1 = Bi (i ∈ [1, k] ∩ J ), Bi ∈ v(yi )(i ∈ [0, k]), π(P Bi ) = βi (i ∈ [0, k])}.

Let F̄r+1 = F̄ . We have obvious maps
                            F̄ = F̄r+1 −
                                       → F̄r −
                                             → F̄r−1 −
                                                     → ... −
                                                           → F̄0 .
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                                19

It is easy to see that F̄0 ∼
                           = kl(y0 ) and that F̄r+1 −
                                                    → F̄r is an affine space bundle
with fibres of dimension α − l(yr ) = α − l(y0 ). Moreover, for i ∈ [1, r], F̄i − → F̄i−1
is an affine space bundle with fibres of dimension 1 if v(yi si ) ⊂ v(yi ) − v(yi ), i ∈
                                                                                       /J
and of dimension 0, otherwise. This completes the proof.
29.9. For k ∈ [1, r] we set

      sr,k = sr sr−1 . . . sk . . . sr−1 sr ,   s̃r,k = s̃r s̃r−1 . . . s̃k+1 sk s̃k+1 . . . s̃r−1 s̃r .

Let Γ be a subgroup of W such that
    k ∈ [1, r], s̃k = 1 =⇒ sr,k ∈ Γ.
We show:
    (a) For i ∈ [1, r] we have sr,i ∈ Γ if and only if s̃r,i ∈ Γ.
We argue by induction on r − i. If r − i = 0 we have sr,i = s̃r,i so the result is
obvious. Assume now that r − i ≥ 1. We have
    k ∈ [1, r − 1], s̃k = 1 =⇒ sr−1,k ∈ sr Γsr .
By the induction hypothesis we have sr−1,i ∈ sr Γsr if and only if s̃r−1,i ∈ sr Γsr .
If s̃r = sr then sr−1,i = sr sr,i sr , s̃r−1,i = sr s̃r,i sr . Hence we have sr,i ∈ Γ if and
only if s̃r,i ∈ Γ. If s̃r = 1 then sr−1,i = sr sr,i sr , s̃r−1,i = s̃r,i . Hence we have
sr,i ∈ Γ if and only if s̃r,i ∈ Γ. (We use that sr ∈ Γ.) This proves (a).
    We show:
    (b) If i ∈ [1, r] and ti 6= 1 then tr tr−1 . . . ti . . . tr−1 tr = yr s̃r,i yr−1 .
We argue by induction on r −i. If r −i = 0 we have tr 6= 1 hence tr = yr−1 s̃r yr−1 =
         −1
yr−1 sr yr−1  . We see that yr−1 = yr s̃r sr = yr sr s̃r and tr = yr sr yr−1 as required.
    Assume now that r − i ≥ 1. By the induction hypothesis the left hand side of
                                        −1
the equality in (b) is tr yr−1 s̃r−1,i yr−1 tr and the right hand side is yr s̃r s̃r−1,i s̃r yr−1 .
It then suffices to show that tr yr−1 = yr s̃r ; this folows from the definitions since
tr = t−1
       r . This proves (b).

29.10. We set y = y0 . In the case where J ⊂ Js we set y L = Ad(y −1 )∗ L ∈ s(T)
and we show:

(a)                                    t1 t2 . . . tr D ∈ Wy•L .

For i ∈ [1, r] define ui ∈ W by ui = ǫ−1 (sr sr−1 . . . si . . . sr−1 sr ) if i ∈ J and by
                                                           •
ui = 1 if i ∈
            / J . If i ∈ J we have i ∈ Js hence ui ∈ WL       . Then

                                                                               •
                       s̃1 s̃2 . . . s̃r D = s1 s2 . . . sr Du1 u2 . . . ur ∈ WL .

We have s̃1 s̃2 . . . s̃r = y −1 t1 t2 . . . tr yr hence y −1 t1 t2 . . . tr yr D ∈ WL•
                                                                                        . Since yr =
                                          −1                       •
ǫ(y) we have yr D = Dy hence y t1 t2 . . . tr Dy ∈ WL and (a) follows.
                                                                                               t,y L
   Using (a) we can define a constructible sheaf y L̄ on Z̄ t† and a complex K̄D                 ′   ∈
     ′                     y      ′                                         s       s,L
D(D ) in terms of t, L, G in the same way as L̄ on Z̄ and K̄D ∈ D(D) are
defined in 28.12 in terms of s, L, G.
20                                            G. LUSZTIG

                                   ′ ∗
Lemma 29.11. (a) If J 6⊂ Js then π̄y! iy L̄ = 0.
                                              y
                          ′ ∗          t, L
     (b) If J ⊂ Js then π̄y! iy L̄ = K̄D ′  [[−d(y)]].
    Let π̄t : Z̄ t† −→ D′ be the obvious projection. We have π̄y!    ′
                                                                       = π̄t! ρ! and
    ∗ y       y
ρ! ρ ( L̄) = L̄[[−d(y)]] (we use 29.4). Hence it suffices to prove:
    (a′ ) If J 6⊂ Js then ρ! (i∗y L̄) = 0.
    (b′ ) If J ⊂ Js then i∗y L̄ ∼= ρ∗ (y L̄).
We prove (a′ ). Let F be the fibre of ρ over a point of Z tK † (K ⊂ K0 ). We must
show that Hc∗ (F, L̄|F ) = 0. (We write L̄ instead of i∗y L̄.) If K ∪ J2 6⊂ Js then
L̄|F = 0 (we use 29.6(a) and Lemma 28.10) and the desired vanishing follows.
Assume now that K ∪ J2 ⊂ Js but J 6⊂ Js . Using 29.6(a) and Lemma 28.10 we
see that L̄|F is a local system on

                                ⊔J ′ ;J ′ ⊂J2 ;J ′ ⊂Js (F ∩ Z sK∪J1 ∪J ′ )

and is zero elsewhere. Hence L̄|F is a local system on F − ∪j∈J2 −Js F j (F j as in
29.7) and is zero on ∪j∈J2 −Js F j . Let i be the largest number in J2 −Js . It suffices
to show that for any (B0 , B1 , . . . , Bi−1 ) ∈ Fi−1 (see 29.4) we have Hc∗ (F ′ , L̄|F ′ ) = 0
where F ′ is the fibre of the obvious map F −            → Fi−1 at (B0 , B1 , . . . , Bi−1 ). Let
F ′i = F ′ ∩F i . If Bj−1 = Bj for some j < i, j ∈ J2 −Js then F ′ ⊂ F j and L̄|F ′ = 0;
the desired vanishing follows. Thus we may assume that pos(Bj−1 , Bj ) = sj
for all j < i, j ∈ J2 − Js . Then L̄|F ′ −F ′i is a local system and L̄|F ′i = 0.
Let F ′′ be the fibre of ξi : Fi −        → Fi−1 (see 29.4) at (B0 , B1 , . . . , Bi−1 ). Let
F = {(B0 , B1 , . . . , Bi−1 , Bi−1 )}, a point on the affine line F ′′ . Let u : F ′ −
  ′′i
                                                                                            → F ′′
be the restriction of the obvious map F −             → Fi . Then u is an iterated affine
                                       ′i     −1     ′′i
space bundle (see 29.4(a)), F = u (F ), and there is a well defined local
system E on F ′′ − F ′′i ∼      = k∗ such that E ∈ s(k∗ ), L̄|F ′ −F ′i = u∗ (E). Then
                      = Hc∗ (k∗ , E) and it suffices to show that E 6∼
Hc∗ (F ′ − F ′i , L̄) ∼                                              = Q̄l . It also suffices to
show that L̄|F ′ −F ′i has non-trivial monodromy around the smooth hypersurface
F ′i of F ′ . This is the same as the monodromy of L̄|Z s around the hypersurface
Z s{i} . This monodromy is non-trivial by 28.10(b). This proves (a′ ).
    We prove (b′ ). We define WJ,y L in terms of G′ , WJ , y L in the same way as
WL was defined in terms of G0 , W, L. Let

                 Jt = {i ∈ [1, r]; ti ∈ J, tr tr−1 . . . ti . . . tr−1 tr ∈ ǫ(WJ,y L )}
                     = {i ∈ [1, r]; ti ∈ J, tr tr−1 . . . ti . . . tr−1 tr ∈ ǫ(Wy L )}.

(The two definitions coincide since tr tr−1 . . . ti . . . tr−1 tr is a reflection in WJ .)
We show:

(c)                                         Jt = Js ∩ K 0 .

Using 29.9(b) it suffices to show that for i ∈ [1, r] such that ti 6= 1, we have

      yr s̃r . . . s̃i+1 si s̃i+1 . . . s̃r yr−1 ∈ ǫ(Wy L ) ↔ sr sr−1 . . . si . . . sr−1 sr ∈ ǫ(WL ).
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                             21

Using 29.9(a), we see that it suffices to show that ǫ−1 (yr−1 )Wy L ǫ−1 (yr ) = WL or
that y L = Ad(ǫ−1 (yr−1 ))∗ L. This follows from the definitions using yr = ǫ(y).
   Using Lemma 28.10 for G′ instead of G, we see that y L̄ is a local system on
Z 1 = ∪K⊂Jt Z tK † and is zero on its complement in Z̄ t† . Using Lemma 28.10 and
29.6(a) we see that i∗y L̄ is a local system on

                    Z 2 = ∪J ′ ⊂J2 ;K⊂Js Z sK∪J1 ∪J ′ ∩ Z̄y′ = ∪K⊂Jt Zy,K
                                                                      ′



and is zero on its complement in Z̄y′ . (We have used (c).) Since Z 2 is an iterated
affine space bundle over Z 1 (via ρ) and the restriction of i∗y L̄ to any fibre of
ρ : Z2 −→ Z 1 is a local system of rank 1 with finite monodromy of order invertible
in k (hence it is Q̄l ) we see that i∗y L̄|Z 2 = ρ∗ E for a well defined local system E
of rank 1 on Z 1 . It suffices to show that E ∼    = y L̄|Z 1 . Since Z 1 is smooth and Z t†
is open dense in Z , it suffices to show that E|Z t† ∼
                      1
                                                           = y L̄|Z t† . Let Z 3 = Z sJ ∩ Z̄y′ .
This is a closed subsetof the open subset ρ−1 (Z t† ) of Z2 . Since the restriction
of ρ is an iterated affine space bundle ρ1 : Z 3 −        → Z t† (see 29.8), it suffices to
show that ρ1 (E|Z t† ) ∼
              ∗                 ∗ y                 ∗
                          = ρ1 ( L̄|Z t† ). Since ρ1 (E|Z t† ) = L̄|Z 3 , it suffices to show
            ∼
that L̄|Z 3 = ρ1 ( L̄|Z t† ). Using Lemma 28.10, once for G and once for G′ , we see
                ∗ y

that L̄|Z 3 = L̃|Z 3 , y L̄|Z t† = y L̃ where L̃ (on Z sJ ) is defined as in 28.8 in terms
of G, sJ , L and y L̃ (on Z t† ) is defined analogously in terms of G′ , t, y L. Thus it
suffices to show that

(d)                                           L̃|Z 3 ∼
                                                     = ρ∗1 (y L̃).

To prove (d), we choose B ∗ , T, d and ẇ (for w ∈ W) as in 28.5, in such a way
that B ∗ ⊂ P, T ⊂ L. We have necessarily d ∈ D′ . Let β † = π(B ∗ ) ∈ B† . Let
U ∗ = UB∗ , U † = Uβ † . Let

                                                                                 ∗˙
      Z ={(h0 U ∗ , h1 U ∗ , . . . , hr U ∗ , g) ∈ (G0 /U ∗ )r+1 × D; h−1
                                                                       i−1 hi ∈ B s̃i B
                                                                                        ∗

            for i ∈ [1, r], h−1          ∗                        ∗
                             r gh0 ∈ NG B , g ∈ NG P, hi ∈ P ẏi U for i ∈ [0, r]},




                Z ′ = {(h′0 U † , h′1 U † , . . . , h′r U † , g ′ ) ∈ (L/U † )r+1 × D′ ;
                    h′i−1 −1 h′i ∈ β † ṫi β † for i ∈ [1, r], h′r −1 g ′ h′0 ∈ NG β † }.

             → Z ′ by
Define ζ : Z −

               (h0 U ∗ , h1 U ∗ , . . . , hr U ∗ , g) 7→ (h′0 U † , h′1 U † , . . . , h′r U † , g ′ )

where hi ∈ pi ẏi U ∗ , pi ∈ P, h′i = π(pi ), g ′ = π(g). (We show that h′i U † is well
defined or equivalently that pi U ∗ is well defined. It suffices to show that pẏi U ∗ =
p′ ẏi U ∗ , p, p′ ∈ P =⇒ p′ U ∗ = pU ∗ . It also suffices to show that P ∩ ẏi U ∗ ẏi−1 ⊂ U ∗ .
22                                                     G. LUSZTIG

                                                                   ∗ −1
Since yi ∈ J W and B ∗ ⊂ P we have P ẏi B ẏi = B ∗ . Hence P ∩ ẏi B ∗ ẏi−1 ⊂ B ∗ .
Thus P ∩ ẏi U ∗ ẏi−1 is contained in the set of unipotent elements of B ∗ that is, in
U ∗ .) We have a commutative diagram
                                                               ζ
                                                    Z −−−−→ Z ′
                                                             
                                                   ay      a′ y
                                                             
                                                              ρ1
                                                    Z 3 −−−−→ Z t†

where a : (h0 U ∗ , h1 U ∗ , . . . , hr U ∗ , g) 7→ (h0 B ∗ h−1      ∗ −1              ∗ −1
                                                             0 , h1 B h1 , . . . , hr B hr , g),

     a′ : (h′0 U † , h′1 U † , . . . , h′r U † , g ′ ) 7→ (h′0 β † h′0 −1 , h′1 β † h′1 −1 , . . . , h′r β † h′r −1 , g ′ ).

Since a is a locally trivial fibration with smooth connected fibres, to prove (d) it
                                    = a∗ ρ∗1 (y L̃) or that a∗ (L̃|Z 3 ) ∼
suffices to prove that a∗ (L̃|Z 3 ) ∼                                    = ζ ∗ a′∗ (y L̃). Define
ξ:Z −  → T by

                (h0 U ∗ , h1 U ∗ , . . . , hr U ∗ , g) 7→ d−1 (ṡ′1 ṡ′2 . . . ṡ′r )−1 n1 n2 . . . nr n

where ni ∈ NG0 T are given by h−1         ∗    ∗            ∗
                                i−1 hi ∈ U ni U and n ∈ NG B ∩ NG T is given
by h−1       ∗                ′
    r gh0 ∈ U n. Define ξ1 : Z − → T by

                (h′0 U † , h′1 U † , . . . , h′r U † , g ′ ) 7→ d−1 (ṫ1 ṫ2 . . . ṫr )−1 n̄1 n̄2 . . . n̄r n̄

where n̄i ∈ NL T are given by h′i−1 −1 h′i ∈ U † n̄i U † and n̄ ∈ NG β † ∩ NG T is given
by h′r −1 g ′ h′0 ∈ U † n̄. From the definitions we have

                             a∗ (L̃|Z 3 ) = ξ ∗ LT , a′∗ (y L̃) = ξ1∗ Ad(ẏ −1 )∗ LT

where LT ∈ s(T ) is as in 28.6. Therefore it suffices to show that

                                           ξ ∗ LT ∼
                                                  = ζ ∗ ξ1∗ Ad(ẏ −1 )∗ LT .

Define ξ ′ : Z −
               → T by

                 (h0 U ∗ , h1 U ∗ , . . . , hr U ∗ , g) 7→ d−1 (ṫ1 ṫ2 . . . ṫr )−1 n̄1 n̄2 . . . n̄r n̄

where hi ∈ pi ẏi U ∗ , pi ∈ P , p−1        ∗     ∗   −1       ∗
                                  i−1 pi ∈ U n̄i U , pr gp0 ∈ U n̄, n̄i ∈ NL T , n̄ ∈
NG B ∗ ∩ NG T . Then ξ ′ = ξ1 ζ and it suffices to show that

                                            ξ ∗ LT ∼
                                                   = ξ ′∗ Ad(ẏ −1 )∗ LT .

Using 28.1(c) it suffices to show that there exists t ∈ T such that

                                    tξ(z) = Ad(ẏ −1 )ξ ′ (z) for all z ∈ Z.
                 CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                                23

Let (h0 , h1 , . . . , hr , g) ∈ (G0 )r+1 ×D be such that z = (h0 U ∗ , h1 U ∗ , . . . , hr U ∗ , g) ∈
Z. We define pi , ni , n, n̄i, n̄ in terms of hi as in the definition of ξ, ξ ′. From
h−1                ∗        −1          ∗                −1 −1
 r gh0 ∈ U n, pr gp0 ∈ U n̄, we deduce ẏr pr gp0 ẏ ∈ U n, U n̄ẏU
                                                                              ∗           ∗       ∗
                                                                                                     =
  ∗       ∗
U ẏr nU hence n̄ẏ = ẏr n. We show that

                                   n̄i = ẏi−1 ni ẏi−1 for any i ∈ [1, r].

From h−1               ∗   ∗     −1          ∗   ∗               −1 −1
        i−1 hi ∈ U ni U , pi−1 pi ∈ U n̄i U , we deduce ẏi−1 pi−1 pi ẏi ∈ U ni U
                                                                                  ∗    ∗

hence ẏi−1 uni u′ ẏi−1 ∈ U ∗ n̄i U ∗ for some u, u′ ∈ U ∗ . Assume first that ti 6= 1.
Then

         yi = yi−1 , yi−1 si = ti yi , l(yi−1 si ) = l(ti yi ) = l(yi−1 ) + 1 = l(yi ) + 1,

hence
                      ẏi−1 uni u′ ∈ U ∗ ẏi−1 ni U ∗ , U ∗ n̄i U ∗ ẏi ⊂ U ∗ n̄i ẏi U ∗ .
Thus, U ∗ ẏi−1 ni U ∗ = U ∗ n̄i ẏi U ∗ and ẏi−1 ni = n̄i ẏi , as required. Next, assume
that ti = 1, s̃i 6= 1. Then yi = yi−1 si 6= yi−1 , n̄i ∈ T . If l(yi−1 si ) = l(yi−1 ) + 1,
then ẏi−1 uni u′ ∈ U ∗ ẏi−1 ni U ∗ and U ∗ n̄i U ∗ ẏi ⊂ U ∗ n̄i ẏi U ∗ so that U ∗ ẏi−1 ni U ∗ =
U ∗ n̄i ẏi U ∗ and ẏi−1 ni = n̄i ẏi , as required. If l(yi−1 si ) = l(yi−1 )−1, then l(si yi−1 ) =
l(yi−1 ) + 1. We have uni u′ ẏi−1 ∈ U ∗ ni ẏi−1 U ∗ and ẏi−1      −1                      −1
                                                                         U ∗ n̄i U ∗ ⊂ U ∗ ẏi−1 n̄i U ∗ so
                               −1
that U ∗ ni ẏi−1 U ∗ = U ∗ ẏi−1                            −1
                                    n̄i U ∗ and ni ẏi−1 = ẏi−1 n̄i , as required. Finally, assume
that s̃i = 1. Then ti = 1, yi−1 si 6= yi−1 = yi , ni ∈ T , n̄i ∈ T . We have ẏi−1 uni u′ ∈
U ∗ ẏi−1 ni U ∗ and U ∗ n̄i U ∗ ẏi ⊂ U ∗ n̄i ẏi U ∗ so that U ∗ ẏi−1 ni U ∗ = U ∗ n̄i ẏi U ∗ and
ẏi−1 ni = n̄i ẏi , as required.
    We have

             Ad(ẏ −1 )ξ ′ (z) = ẏ −1 d−1 (ṫ1 ṫ2 . . . ṫr )−1 n̄1 n̄2 . . . n̄r n̄ẏ
              = ẏ −1 d−1 (ṫ1 ṫ2 . . . ṫr )−1 (ẏn1 ẏ1−1 )(ẏ1 n2 ẏ2−1 ) . . . (ẏr−1 nr ẏr−1 )ẏr n
              = ẏ −1 d−1 (ṫ1 ṫ2 . . . ṫr )−1 ẏn1 n2 . . . nr n
              = td−1 (s̃˙ 1 s̃˙ 2 . . . s̃˙ r )−1 n1 n2 . . . nr n = tξ(z)

where
                              t = ẏ −1 d−1 (ṫ1 ṫ2 . . . ṫr )−1 ẏ(s̃˙ 1 s̃˙ 2 . . . s̃˙ r )d.
We have t ∈ T . (Equivalently, ys̃1 s̃2 . . . s̃r = t1 . . . tr yr , which is clear from the
definitions.) This completes the proof of (d) hence that of (b′ ). The lemma is
proved.
29.12. We consider the sequence Z0 ⊂ Z1 ⊂ . . . of closed subsets of Z̄ ′ defined
by Zi = ∪y;c(y)≤i Z̄y′ where y is a sequence (y0 , y1 , . . . , yr ) of elements in J W
satisfying 29.2(a) and c(y) = i∈[0,r] dim v(yi ). Let ki : Zi −                       → Z̄ ′ (i ≥ 0) and ki′ :
                                       P

Zi − Zi−1 −→ Z̄ ′ (i ≥ 1) be the inclusions. For any i ≥ 1, the natural distinguished
triangle
                                                                              ∗
                         (π̄!′ ki!′ ki′ ∗ L̄, π̄!′ ki! ki∗ L̄, π̄!′ (ki−1 )! ki−1 L̄)
24                                              G. LUSZTIG

in D(D′ ) gives rise to a long exact sequence in M(D′ ):

                                                           δ
                    → p H j−1 (π̄!′ (ki−1 )! ki−1
                ... −                         ∗
                                                  L̄) −                    ′ ∗
                                                      → ⊕y;c(y)=i p H j (π̄y! iy L̄) −
                                                                                     →
                                                                       δ
(a)            p
                   H j (π̄!′ ki! ki∗ L̄) −
                                         → p H j (π̄!′ (ki−1 )! ki−1
                                                                 ∗
                                                                     L̄) −
                                                                         → ....

We now prove the following result.
Lemma 29.13. (a) The maps δ in 29.12(a) are zero.
  (b) For i ≥ 0, π̄!′ ki! ki∗ L̄ ∈ D(D′ ) is a semisimple complex; it is isomorphic to
            ′ ∗
⊕y;c(y)≤i π̄y! iy L̄.
  (c) π̄! L̄ ∈ D(D′ ) is a semisimple complex; it is isomorphic to ⊕y π̄y!
        ′                                                                  ′ ∗
                                                                             iy L̄.
   (c) is a special case of (b), for large i. Assuming that (a) and the first assertion
of (b) are proved, we prove the second assertion of (b) as follows. Since both
complexes in question are semisimple (see 29.11 and 28.12(b)), it suffices to show
that they have the same p H j for any j. Using (a) we see that 29.12(a) decomposes
into short exact sequences of semisimple objects in M(D′ ). Hence
          p
              H j (π̄!′ ki! ki∗ L̄) ∼
                                    = p H j (π̄!′ (ki−1 )! ki−1
                                                            ∗                            ′ ∗
                                                                L̄) ⊕ ⊕y;c(y)=i p H j (π̄y! iy L̄).

This proves the desired equality for p H j by induction on i. (The case where i = 0
is trivial.)
    It remains to prove (a) and the first assertion of (b). By general principles,
we may assume that k is an algebraic closure of a finite field Fq , that G, P, D
are defined over Fq and that G0 is split over Fq . By taking Fq large enough, we
may assume that 29.12(a) and the isomorphisms in 29.11(a),(b) are realized in
                                                                                  t,y0 L
the category of mixed perverse sheaves with L pure of weight 0. Now K̄D             ′    in
29.11(b) is pure of weight 0 (by Deligne’s theorem [D, 6.2.6]) since it is a direct
image under a proper map of y0 L̄ which is pure of weight 0; after applying to it
[[−d(y)]], it remains pure of weight 0, see [BBD, 6.1.4]. Hence by 29.11, π̄y′ ! (i∗y L̄)
is pure of weight 0; it follows that
                           ′ ∗
    (d) ⊕y;c(y)=i p H j (π̄y! iy L̄) is pure of weight j.
We now show by induction on i that p H j (π̄!′ ki! ki∗ L̄) is pure of weight j for any i.
For i = 0 this follows from (d). If we assume that this holds for i − 1 where i ≥ 1
then the statement for i follows from the statement for i − 1 and 29.12(a) (using
(d)); we also use the following fact: if K1 −       → K2 −→ K3 is an exact sequence of
mixed perverse sheaves with K1 , K3 pure of weight j, then K2 is pure of weight
j. Using [BBD, 5.4.4] it follows that π̄!′ ki! ki∗ L̄ is pure of weight 0. Using the
decomposition theorem [BBD, 5.4.5, 5.3.8] it follows that π̄!′ ki! ki∗ L̄ is a semisimple
complex. The vanishing of δ in 29.12(a) follows from the fact that δ is a morphism
between two pure perverse sheaves of different weights. The lemma is proved.
                                                               ′                      y0
                                                  s,L ∼        t, L
Proposition 29.14. In D(D′ ) we have resD    D (K̄D ) = ⊕y K̄D′        [[−d(y)]] where
y runs over all sequences satisfying 29.2(a) such that {i ∈ [1, r], s̃i = 1} ⊂ Js and
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                           25

                                                                   ′ s,L
s̃i , t are defined in terms of y as in 29.3. In particular, resD
                                                                D (K̄D ) is a direct
sum of shifts of character sheaves on D′ .
                                        ′
                                        s,L     ′
   From the definitions we have resD
                                   D (K̄D ) = π̄! L̄(α). The result follows from
29.13(c) and 29.11.
                                                                       ′
                                                                     ′
Proposition 29.15. Let A be a character sheaf on D. Then resD
                                                            D A ∈ D(D ) is
a direct sum of shifts of character sheaves on D′ .
                                                    s,L
   We can find s, L as in 29.2 such that A ⊣ K̄D        . Using 28.12(b) we see that
                                                   s,L              ′
for some j ∈ Z, A[−j] is a direct summand of K̄D . Hence resD     D A[−j] is a direct
                     ′   s,L
summand of resD     D (K̄D ), which is a semisimple complex by 29.14. It follows
          ′
                                                         D′
that resD                                      p i
        D A is a semisimple complex. Now H (resD A) is a direct summand of
             ′   s,L
p i+j                                                                               ′
 H (resD   D (K̄D )) which, by 29.14, is a direct sum of character sheaves on D .
                  ′
                                                                ′
Hence p H i (resD
                D A) is a direct sum of character sheaves on D . This completes the
proof.

                   30. Admissibility of character sheaves
30.1. In this section we fix a connected component D of G. We write ǫ : W −
                                                                          →W
instead of ǫD : W −→ W (see 26.2).
Lemma 30.2. Let H = D ZG     0      0
                               0 × G . Let A be a simple perverse sheaf on D which

is cuspidal (see 23.3). Assume that there exists n ∈ N∗k such that A is equivariant
for the H-action (z, x) : g 7→ xz n gx−1 on D. Let Z = suppA, m = dim Z.
There exists a unique pair (S, E) where S is an isolated stratum S of D and E
is an irreducible cuspidal local system E ∈ S(S) (up to isomorphism) such that
A[−m] = IC(S̄, E) extended by 0 on D − S̄.
   The intersections of Z with the various strata of D form a finite partition of
Z into locally closed subsets. Since Z is irreducible, one of these intersections is
open dense in Z. Thus there exists (L, S) ∈ A such that S ⊂ D and YL,S ∩ Z is
open dense in Z. Let P be a parabolic of G0 with Levi L such that S ⊂ NG P . Let
a = dim UP . We can find an open dense smooth subset V of Z and an irreducible
local system E on V such that A = IC(Z, E)[m] extended by 0 on D−Z. Replacing
if necessary V, E by V ∩ YL,S , E|V ∩YL,S , we may assume that V ⊂ YL,S . For any
h ∈ H, the h-translate h V of V is an open dense smooth subset of Z. Hence
V ′ = ∪h h V is an open dense smooth subset of Z. Since V ⊂ YL,S and YL,S is
H-stable, we have h V ⊂ YL,S for h ∈ H hence V ′ ⊂ YL,S . Now A′ = A[−m]|V
is an H-equivariant intersection cohomology complex on V ′ such that A′ |V is a
local system and A′ |h V is automatically a local system for any h ∈ H. Since
∪h h V is an open covering of V ′ , we see that A′ is a local system on V ′ . Replacing
V, E by V ′ , A′ , we see that we may assume in addition that V is H-stable and
E is an H-equivariant local system on V . Define f : G0 × (V ∩ S ∗ ) −         → V by
(y, g) 7→ ygy −1 . Then f is surjective since V ⊂ YL,S . Moreover, f is a principal
bundle with group Γ = {x ∈ NG0 L; xSx−1 = S} which acts on G0 × (V ∩ S ∗ )
26                                      G. LUSZTIG

by x : (y, g) 7→ (yx−1 , xgx−1 ). (We show this only at the level of sets. It suffices
to show that, if (y, g), (y ′, g ′ ) are elements of V ∩ S ∗ such that ygy −1 = y ′ g ′ y ′−1 ,
then the element x = y ′−1 y ∈ G0 satisfies xLx−1 = L, xSx−1 = S. We have
xgx−1 = g ′ . Since g ∈ S ∗ , g ′ ∈ S ∗ , we have L = L(g) = L(g ′ ), see 3.9, and
L(g ′ ) = xL(g)x−1 hence xLx−1 = L. Since xSx−1 , S are strata of NG L with a
common element g, we must have xSx−1 = S, as required.) Since V is irreducible
and Γ is of pure dimension dim L, it follows that V ∩ S ∗ is non-empty, of pure
dimension m − 2a: we have

 dim(V ∩ S ∗ ) + dim G0 = dim V + dim Γ = dim V + dim L = m + dim G0 − 2a.

Let g ∈ V ∩ S ∗ . Let U ′ be the orbit of g under UP -conjugation. Since U ′ is an
orbit of an action of a unipotent group on an affine variety, U ′ is closed in D. We
have U ′ ⊂ gUP . (Indeed if x ∈ UP then xgx−1 = g(g −1 xg)x−1 and g −1 xg ∈ UP
since g ∈ NG P .) The isotropy group UP,g of g in UP is contained in

                     UP ∩ ZG (g) ⊂ UP ∩ ZG (gs ) ⊂ UP ∩ ZG (gs )0

(the last inclusion follows from 1.11). Since g ∈ S ∗ , we have ZG (gs )0 ⊂ L hence
UP,g ⊂ UP ∩ L = {1}. Thus, UP,g = {1}. We see that dim U ′ = dim UP . Since
U ′ is closed in gUP , we have U ′ = gUP . Since V is stable under UP -conjugation
and U ′ is the UP -orbit of g ∈ V , it follows that U ′ ⊂ V . Thus, gUP ⊂ V . Now
E|gUP is a UP -equivariant local system (for the conjugation action of UP which
has trivial isotropy group). It follows that E|gUP ∼   = Q̄cl for some c ≥ 1. Hence
   2a                               2a−m
Hc (gUP , E) 6= 0. Equivalently, Hc       (gUP , A) 6= 0.
                                     i
     For any i ∈ Z, we denote by X the set of all UP -cosets R in ND P such that
Hc (R, A) 6= 0. Then, for any g ∈ V ∩ S ∗ , we have gUP ∈ X 2a−m . The map
   i


                             V ∩ S∗ −
                                    → ND P/UP , g 7→ gUP

is injective: if g, g ′ ∈ V ∩ S ∗ and gUP = g ′ UP then

                          g −1 g ′ ∈ (NG P ∩ NG L) ∩ UP = {1},

see 1.26, hence g = g ′ . We see that dim X 2a−m ≥ dim(V ∩S ∗ ) hence dim X 2a−m ≥
m − 2a. Thus,
                                               ′
                          dim(suppH2a−m (resD D A)) ≥ m − 2a

where D′ = ND P ∩ ND L. If P 6= G0 then our assumption that A is cuspidal gives
                                                   ′
                          dim(suppH2a−m (resD
                                            D A)) < m − 2a,

a contradiction. Thus, P = G0 , L = G0 and S must be an isolated stratum of D,
so that YL,S = S. Since V is H-stable, contained in S and S is a single H-orbit, it
follows that V = S and E is an H-equivariant local system on S that is, E ∈ S(S).
Using 23.3(a), we see that E is a cuspidal local system. The lemma is proved.
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                             27

30.3. For J ⊂ I such that ǫ(J) = J, let
                      VJ,D = {(P, gUP ); P ∈ PJ , gUP ∈ ND P/UP }.
Let P0 ∈ PJ . Since ǫ(J) = J, ND P0 is a connected component of NG P0 and
D0 = ND P0 /UP0 is a connected component of NG P0 /UP0 . Consider the diagram
                                            a               b
                                       − G0 × D0 −
                                    D0 ←         → VJ,D
where a(x, gUP0 ) = gUP0 , b(x, gUP0 ) = (xP x−1 , xgx−1 UxP x−1 ) with x ∈ G0 ,
g ∈ ND P0 . Then a, b are smooth morphisms with connected fibres; more pre-
cisely, b is a principal P0 -bundle where P0 acts on G0 × D0 by p : (x, gUP0 ) 7→
(xp−1 , pgp−1 UP0 ). Let A0 be a perverse sheaf on D0 equivariant for the conjuga-
tion action of P0 /UP0 . Then a⋆ A0 = b⋆ A♭0 for a well defined perverse sheaf A♭0
on VJ,D .
30.4. For any J ⊂ J ′ ⊂ I such that ǫ(J) = J, ǫ(J ′ ) = J ′ let VJ,J ′ ,D be the variety
consisting of all pairs (P, gUQ) where P ∈ PJ , gUQ ∈ ND P/UQ and Q is the unique
parabolic in PJ ′ such that P ⊂ Q. We have a diagram
                                                c           d
                                   VJ,D ←
                                        − VJ,J ′ ,D −
                                                    → VJ ′ ,D
where c(P, gUQ ) = (P, gUP ), d(P, gUQ) = (Q, gUQ). Define
                f˜J,J ′ : D(VJ,D ) −
                                   → D(VJ ′ ,D ), ẽJ,J ′ : D(VJ ′ ,D ) −
                                                                        → D(VJ,D )
by f˜J,J ′ A = d! c∗ A, ẽJ,J ′ A′ = c! d∗ A′ . Define
                fJ,J ′ : D(VJ,D ) −
                                  → D(VJ ′ ,D ), eJ,J ′ : D(VJ ′ ,D ) −
                                                                      → D(VJ,D )
by fJ,J ′ A = f˜J,J ′ A[α] = d! c⋆ A, eJ,J ′ A′ = ẽJ,J ′ A′ [α](α) where α = dim PJ −
dim PJ ′ .
   Let P0 ∈ PJ , P0′ ∈ PJ ′ be such that P0 ⊂ P0′ . Let D0 = ND P0 /UP0 , D0′ =
ND P0′ /UP0′ . We have α = dim UP0 − dim UP0′ . We show:
   (a) If A ∈ M(VJ,D ) is of the form A = A♭0 where A0 is a direct sum of admissible
simple perverse sheaves on D0 then A′ := fJ,J ′ A is of the form A′0 ♭ where A′0 =
   D′
indD00 A0 is a direct sum of admissible simple perverse sheaves on D0′ . In particular,
fJ,J ′ A ∈ M(VJ ′ ,D ).
We have a commutative diagram
                            r                         s                 t
                D0       ←−−−−         V1           −−−−→        V2   −−−−→    D0′
                 x                     x                         x               x
                a                    j                                      a′ 
                                                                              
                                                                h

                           1×r                       1×s               1×t
             G0 × D0 ←−−−− G0 × V1 −−−−→ G0 × V2 −−−−→ G0 × D0′
                                                         
                                                        b′ y
                                                         
               by                         ky

                            c                                           d
               VJ,D      ←−−−−                      ←−−−− VJ,J ′ ,D −−−−→     VJ ′ ,D
28                                            G. LUSZTIG

Here
   V1 = P0′ /UP0′ × ND P0 /UP0′ ,
   V2 = {(P, gUP0′ ); P ∈ PJ , P ⊂ P0′ , g ∈ ND P },
   b is as in 30.3, b′ is the analogous map (with P0 replaced by P0′ ),
   a, j, h, a′, r, t are given by the second projection,
   s(p′ UP0′ , gUP0′ ) = (p′ P0 p′−1 , p′ gp′−1 UP0′ ) where p′ ∈ P0′ , g ∈ ND P0 ,
   k(x, P, gUP ′ ) = (xP x−1 , xgx−1 UxP0′ x−1 ) where x ∈ G0 , (P, gUP ′ ) ∈ V2 .
All morphisms in this diagram (except t, 1×t, d) are smooth with connected fibres.
Moreover, s, b, k, b′ are principal bundles with group P0 /UP0′ , P0 , P0′ , P0′ . We may
assume that A0 , A are simple. There is a well defined simple perverse sheaf A1
on V2 such that r ⋆ A0 = s⋆ A1 . We have A′0 = t! A1 . Using the commutativity of
the diagram above we see that h⋆ A1 = k ⋆ (c⋆ A). Since the squares (h, t, 1 × t, a′)
and (1 × t, b′ , k, d) are cartesian we have (1 × t)! h⋆ A1 = a′⋆ A0 , (1 × t)! k ⋆ (c⋆ A) =
b′⋆ d! (c⋆ A) = b′⋆ A′ . It follows that a′⋆ A0 = b′⋆ A′ . From 27.2(d) we see that
           D′
A′0 = indD00 A0 is a direct sum of admissible simple perverse sheaves on D0′ . Hence
a′⋆ A0 = b′⋆ A′ is a direct sum of simple perverse sheaves on G0 × D0′ . Hence A′
is a direct sum of simple perverse sheaves on VJ ′ ,D . This proves (a).
   We show:
   (b) Let C0 be a P0′ /UP0′ -equivariant simple perverse sheaf on D0′ and let C = C0♭
be the corresponding simple perverse sheaf on VJ ′ ,D . Then for any i ∈ Z we have
 H (eJ,J ′ C) = (p H i (resD
p i                                    ♭
                              D0′ C0 )) (equality of perverse sheaves on VJ,D ).
                               0


We have a commutative diagram

                                       f′                     f
                          D0        ←−−−−         V3      −−−−→         D0′
                           x                      x                       x
                          a                     v                     ′
                                                                        
                                                                       a

                                      1×f ′                  1×f
                       G0 × D0 ←−−−− G0 × V3 −−−−→ G0 × D0′
                                                     
                                      my            b′ y
                                                     
                         by

                                        c                     d
                          VJ,D      ←−−−− VJ,J ′ ,D −−−−→              VJ ′ ,D

where a, b, a′ , b′ , c, d are as above, V3 = ND P0 /UP0′ , f, f ′ are the obvious maps, v
is the second projection and

                          m(x, pUP0′ ) = (xP0 x−1 , xpx−1 UxP0′ x−1 ).

From this commutative diagram we see that v ∗ f ∗ C0 [dim UP0′ ] = m∗ d∗ C (we use
that b′∗ C = a′∗ C0 [dim UP0′ ]). Since the squares (f ′ , a, 1 × f ′ , v) and (v, f, 1 × f, a′ )
are cartesian we have

            a∗ f!′ (f ∗ C0 ) = (1 × f ′ )! v ∗ (f ∗ C0 ), b∗ c! d∗ C = (1 × f ′ )! m∗ (d∗ C)
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                             29

hence a∗ f!′ (f ∗ C0 )[dim UP0′ ] = b∗ c! d∗ C. Thus,

                    a∗ (resD0
                                             ′
                                                    ∗
                           D′ C0 )(−α)[dim UP0 ] = b (eJ,J C)[−α](−α).
                                                          ′
                               0



Hence a∗ (resD0                   ∗     ′
                                                 ⋆     ′
                                                              ⋆    D0
             D′ C0 )[dim UP0 ] = b (eJ,J C) and b (eJ,J C) = a (resD′ C0 ),
                0                                                                   0


                           p
                               H i (b⋆ (eJ,J ′ C)) = p H i (a⋆ (resD
                                                                   D′ C0 )).
                                                                    0
                                                                    0



Using this and [L3, I,(1.8.1)] we have

           b⋆ (p H i (eJ,J ′ C)) = a⋆ (p H i (resD           ⋆ p i     D0      ♭
                                                 D′ C0 )) = b (( H (resD′ C0 )) ).
                                                  0
                                                      0                        0



Since β ⋆ is fully faithful [L3, I,(1.8.3)], we deduce the required equality
 H (eJ,J ′ C) = (p H i (resD
p i                                ♭
                           D′ C0 )) .
                            0
                                   0

Lemma 30.5. Let A ∈ D(VJ,D ), A′ ∈ D(VJ ′ ,D ). We have

                    HomD(VJ,D ) (eJ,J ′ A′ , A) = HomD(VJ ′ ,D ) (A′ , fJ,J ′ A).


  Using the fact that d is proper (hence d∗ = d! ) and that c is an affine space
bundle with fibres of dimension α (hence c! A = c∗ A[2α](α)), we have

 Hom(c! d∗ A′ [α](α), A) = Hom(d∗ A′ [α](α), c! A) = Hom(d∗ A′ [α](α), c∗ A[2α](α))
  = Hom(d∗ A′ , c∗ A[α]) = Hom(A′ , d∗ c∗ A[α]) = Hom(A′ , d! c∗ A[α]).

The lemma is proved.
Theorem 30.6. Let A be a character sheaf on D.
   (a) Let P0 be a parabolic of G0 such that ND P0 6= ∅ and let D0 = ND P0 /UP0 ,
a connected component of NG P0 /UP0 . Let A1 be a character sheaf on D0 . Then
indD
   D0 A1 ∈ M(D).
   (b) Let P0 , D0 be as in (a). Then resD D A ∈ D(D0 )
                                            0           ≤0
                                                           .
   (c) Let P0 , D0 be as in (a). Let A1 be a character sheaf on D0 . Then
   HomD(D0 ) (resD                             D
                  D A, A1 ) = HomD(D) (A, indD0 A1 ).
                   0


   (d) There exist P0 , D0 as in (a) and a cuspidal character sheaf A1 on D0 such
that A is a direct summand of indD  D0 A1 .
   (e) A is admissible.
   If G0 = {1}, the theorem is obvious. Assume now that dim G > 0 and that the
theorem is true when G is replaced by a reductive group of dimension < dim G.
The proof of the theorem for G assuming this inductive assumption is given in
30.7-30.11.
30                                    G. LUSZTIG

30.7. We show that 30.6(a) holds for G. If P0 = G0 we have D = D0 , indD  D0 A1 =
                                                      0
A1 and the result is obvious. Assume now that P0 6= G . By 30.6(e) for NG P0 /UP0 ,
A1 is admissible on D0 . Using 27.2(d) we see that indDD0 A1 ∈ M(D), as required.

30.8. We show that 30.6(b) holds for G. If P0 = G0 we have resD          D A = A ∈
                                                                           0

                                     0
M(D0 ). Assume now that P0 6= G . Let J be such that P0 ∈ PJ . We identify
VI,D = D in the obvious way. We show:
   (a) p H i (eJ,I A) = 0 for i > 0.
Assume that this is not so; let i be the largest integer such that p H i (eJ,I A) 6= 0.
Then i > 0 and there exists a nonzero morphism eJ,I A −   → p H i (eJ,I A)[−i]. Using
Lemma 30.5 we deduce that

                      HomD(D) (A, fJ,I (p H i (eJ,I A)[−i])) 6= 0.

Using 30.4(b) we have

                     fJ,I (p H i (eJ,I A)) = fJ,I ((p H i (resD    ♭
                                                              D A)) ).
                                                               0




By 29.15, p H i (resD
                    D A) is a finite direct sum of character sheaves on D0 hence,
                     0


by 30.6(e) for NG P0 /UP0 it is a finite direct sum of admissible complexes on D0 .
Using 30.4(a), we see that C := fJ,I ((p H i (resD      ♭
                                                  D A)) ) ∈ M(D). Thus we have
                                                   0


HomD(D) (A, C[−i]) 6= 0 with A, C ∈ M(D), i > 0. This contradicts [L3, II,7.4].
Thus, (a) holds.
  Using (a) and 30.4(b) we see that for i > 0 we have (p H i (resD     ♭
                                                                  D A)) = 0 hence
                                                                    0

       D                               D
 H (resD0 A) = 0. It follows that resD0 A ∈ D(D0 )≤0 . Thus, 30.6(b) holds for G.
p i


30.9. We show that 30.6(c) holds for G. If P0 = G0 the result is obvious. Assume
now that P0 6= G0 . Let J be as in 30.8. By 30.6(e) for NG P0 /UP0 , A1 is admissible
on D0 . Let A♭1 be the simple perverse sheaf on VJ,D corresponding to A1 as in
30.3. From 30.4 we have
                                                          D0
(a)                  indD             ♭    ⋆          ⋆
                        D0 A1 = fJ,I A1 , a eJ,I A = b resD A,


where a, b are as in 30.3. We have

            HomD(D0 ) (resD                           ⋆   D0    ⋆
                          D A, A1 ) = HomD(G0 ×D0 ) (b resD A, b A1 )
                           0



            = HomD(G0 ×D0 ) (a⋆ eJ,I A, a⋆ A♭1 ) = HomD(VJ,D ) (eJ,I A, A♭1 )
            = HomD(D) (A, fJ,IA♭1 ) = HomD(D) (A, indD
                                                     D0 A1 );


the first equality comes from [L3, I,(1.8.2)] and 30.6(b); the second equality comes
from (a); the third equality comes from [L3, I,(1.8.2)] and 30.8(a); the fourth
equality comes from 30.5; the fifth equality comes from (a). We see that 30.6(c)
holds for G.
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                         31

30.10. We show that 30.6(d) holds for A. If A is cuspidal, we can take P =
G0 , A1 = A and the desired result holds. Thus, we may assume that A is
not cuspidal. Then there exist P0 , D0 as in 30.6(a) such that P 6= G0 and
resD
   D A[−1] ∈
     0
               / D(D0 )≤0 . Then p H i (resDD A) 6= 0 for some i ≥ 0. By 30.6(b)
                                              0


we have p H j (resD                                       p 0     D0
                   D A) = 0 for all j > 0. It follows that H (resD A) 6= 0 and there
                    0


exists a non-zero morphism resD  D A −
                                   0
                                       → p H 0 (resD                    p 0    D0
                                                   D A) in D(D0 ). Since H (resD A)
                                                    0


is a direct sum of character sheaves on D0 (see 29.15) it follows that there exists
a character sheaf A2 on D0 and a non-zero morphism resD       D A −
                                                                0
                                                                     → A2 in D(D0 ).
Using 30.6(c) it follows that there exists a non-zero morphism A −     → indD
                                                                            D0 A2 in
D(D). By 30.6(a) this is a non-zero morphism in M(D). This must be injective
since A is simple. By the induction hypothesis, A2 is a direct summand of a com-
plex of the form indD  D1 A3 where D1 = ND0 Q/UQ , Q is a parabolic of NG P/UP
                        0


such that ND0 Q 6= ∅ and A3 is a cuspidal character sheaf on D1 . By the induc-
tion hypothesis, A3 is admissible. By the transitivity property 27.3(a) we have
            D0
indD                    D                D
    D0 (indD1 A3 ) = indD1 A3 . Since indD0 commutes with direct sums, we see that
indD                                   D
    D0 A2 is a direct summand of indD1 A3 . Hence A is isomorphic to a subobject of
indD                                       D
    D1 A3 . From 27.2(d) we see that indD1 A3 is a semisimple perverse sheaf hence
A is a direct summand of it. Thus, 30.6(d) holds for G.

30.11. We show that 30.6(e) holds for A. Assume first that A is cuspidal. Then A
is admissible by Lemma 30.2, which is applicable, in view of 28.15(a) with J = I.
Next assume that A is not cuspidal. Then, by 30.6(d) and its proof, we see that
there exist P0 , D0 as in 30.6(a) and a cuspidal character sheaf A1 on D0 such that
P0 6= G0 and A is a direct summand of indD     D0 A1 . By the induction hypothesis,
A1 is admissible. Using 27.2(d) we see that A is admissible. Thus 30.6(e) holds.
Theorem 30.6 is proved.

Corollary 30.12. Let J ⊂ I and let X be a parabolic character sheaf on ZJ,D
(see §26). Then X is admissible in the sense of 26.3.

   By [L10, 4.13] we have X = Â where Â is obtained from some t, C, A as in 26.3
except that A is a character sheaf on C instead of being an admissible complex on
C. However, by 30.6(e), A is automatically admissible on C hence Â is admissible
on ZJ,D , by the definition in 26.3.


               31. Character sheaves and Hecke algebras
31.1. In this section we show that the restriction functor studied in §29 takes
a character sheaf to a direct sum of character sheaves (Theorem 31.14). In the
connected case this result appeared in [L3, I,§6] with a proof based on a connection
of character sheaves with Hecke algebras. The present proof in the general case is
an extension of the proof in [L3, I,§6], taking also into account the approach given
later by Mars and Springer [MS, §9].
32                                       G. LUSZTIG

31.2. Until the end of 31.13 we fix n ∈ N∗k . We write sn instead of sn (T). Let sn
be the set of isomorphism classes of objects in sn . We have canonically
                                  sn = Hom(µn (T), Q̄∗l )
(notation of 5.3). Thus ♯(sn ) = ndim T < ∞. Now W• acts on sn by a : λ 7→ aλ
where λ is the isomorphism class of L ∈ sn and aλ is the isomorphism class of
(a−1 )∗ L ∈ sn . For λ ∈ sn we set Wλ = WL (see 28.3) where λ is the isomorphism
class of L ∈ sn (this is independent of the choice of L).
   Let A = Z[v, v −1 ] where v is an indeterminate. We now introduce an associative
A-algebra Hn closely related to the algebra of double cosets of a finite Chevalley
group with respect to a maximal unipotent subgroup, studied in [Y]. We define
Hn by the generators Tw (w ∈ W), 1λ (λ ∈ sn ) and the relations
   1λ 1λ′ = δλ,λ′ 1λ for λ, λ′ ∈ sn ,
   Tw Tw′ = Tww′ for w, w′ ∈ W with l(ww′ ) = l(w) + l(w′ ),
   Tw 1λ = 1wλ Tw for w ∈  PW, λ ∈ sn ,
     2     2        2
   Ts = v T1 + (v − 1) λ;s∈Wλ Ts 1λ for s ∈ I,
         P
   T1 = λ 1λ . P
Note that T1 = λ 1λ is the unit element of Hn and that
   (a) {Tw 1λ ; w ∈ W, λ ∈ sn } is an A-basis of Hn .
In the case where n = 1, Hn is just the Hecke algebra attached to W and the
proof of (a) is standard (see for example [L12, 3.3]). The proof in the general case
is quite similar. Consider the free A-module M with basis
                         {[λ′ , w, λ]; λ, λ′ ∈ sn , w ∈ W, wλ = λ′ }.
If (a) is true, then M may be identified with Hn so that [λ′ , w, λ] ∈ M corresponds
to Tw 1λ = 1λ′ Tw ∈ Hn ; hence M is naturally an (Hn , Hn ) bimodule. Conversely,
if we can make M naturally into an (Hn , Hn ) bimodule then (a) can be easily
deduced. For any s ∈ I we define A-linear maps m 7→ Ts m and m 7→ mTs of M
into itself by
    Ts [λ′ , w, λ] = [sλ′ , sw, λ] if l(sw) = l(w) + 1,
    Ts [λ′ , w, λ] = v 2 [sλ′ , sw, λ] + (v 2 − 1)[sλ′ , w, λ] if l(sw) = l(w) − 1, s ∈ Wλ′ ,
    Ts [λ′ , w, λ] = v 2 [sλ′ , sw, λ] if l(sw) = l(w) − 1, s ∈       / Wλ′ ,
       ′                 ′
    [λ , w, λ]Ts = [λ , ws, sλ] if l(ws) = l(w) + 1,
    [λ′ , w, λ]Ts = v 2 [λ′ , ws, sλ] + (v 2 − 1)[λ′ , w, sλ] if l(ws) = l(w) − 1, s ∈ Wλ ,
    [λ′ , w, λ]Ts = v 2 [λ′ , ws, sλ] if l(ws) = l(w) − 1, s ∈        / Wλ .
For any λ̃ ∈ sn we define A-linear maps m 7→ 1λ̃ m, m 7→ m1λ̃ of M into itself by
    1λ̃ [λ′ , w, λ] = δλ̃,λ′ [λ′ , w, λ], [λ′, w, λ]1λ̃ = δλ̃,λ [λ′ , w, λ].
One shows that this defines an (Hn , Hn ) bimodule structure on M . We omit
further details.
    Remark. In [MS, 3.3.1] an algebra structure on M (with λ restricted in a fixed
W -orbit) is considered which is similar to the one above, coming from Hn , but
differs from it in the following way: for s ∈ I and λ such that s ∈           / Wλ , [sλ, s, λ]2
                                           2
is equal, in our definition, to v [sλ, 1, λ], while in the definition of [MS] it equals
[sλ, 1, λ].
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                         33

31.3. We return to the general case. For s ∈ I, Ts is invertible in Hn ; we have

                     Ts−1 = v −2 Ts + (v −2 − 1)
                                                  X
                                                        1λ .
                                                              λ;s∈Wλ

Moreover,                                                      X
                       Ts−1 Ts−1 = v −2 + (v −2 − 1)                  Ts−1 1λ .
                                                            λ;s∈Wλ

It follows that that Tw is invertible in Hn for any w ∈ W and that
                Ty−1  −1      −1
                  −1 Tw −1 = T(yw)−1 if y, w ∈ W, l(yw) = l(y) + l(w).



For any w ∈ W, λ ∈ sn we have Tw−1                 −1
                                      −1 1λ = 1wλ Tw −1 . Hence there is a unique ring

homomorphism¯: Hn −    → Hn such that Tw = Tw−1    −1 for all w ∈ W, v
                                                                        m 1 = v −m 1
                                                                           λ         λ
for all λ and all m ∈ Z. Note that
   (a)¯: Hn −→ Hn has square 1. In particular, it is an isomorphism of rings.
Indeed, the generators v, v −1 , Tw (w ∈ W) and 1λ (λ ∈ sn ) are mapped to them-
selves by the square of¯.
31.4. In the remainder of this section we fix a connected component D of G. We
write ǫ : W −→ W instead of ǫD : W −  → W. Let ω be the order of ιD : T −   → T.
The assignment 1λ 7→ 1Dλ , Tw 7→ Tǫ(w) defines an automorphism of the algebra Hn
denoted by h 7→ aD (h). We have aωD = 1. Let Hn h[D]i be the free left Hn -module
with basis {[D]i ; i ∈ Z/ωZ}. We regard Hn h[D]i as an associative A-algebra with
unit 1 = [D]0 such that
                                               ′                         ′
                            (h[D]i )(h′ [D]i ) = haiD (h′ )[D]i+i
for h, h′ ∈ Hn , i, i′ ∈ Z/ωZ. We write [D] instead of D1 . We have aD (h) =
[D]h[D]−1 in Hn h[D]i. Define a group involution¯: Hn h[D]i −
                                                            → Hn h[D]i by h[D]i =
h[D]i where h ∈ Hn , i ∈ Z/ωZ and¯: Hn −  → Hn is as in 31.3. Then¯: Hn h[D]i −→
Hn h[D]i is a ring involution (we use the fact that ¯ : Hn −→ Hn commutes with
aD ).
31.5. For s ∈ I ∪ {1}, λ ∈ sn we set
                         Cλs = (Ts + u)1λ = 1sλ (Ts + u) ∈ Hn ,
where u = 1 if s ∈ Wλ ∩ I and u = 0 if s ∈
                                         / Wλ . We have

(a)                         Cλs = v −2 Cλs if s ∈ I,         Cλ1 = Cλ1 .
If s = (s1 , s2 , . . . , sr ) is a sequence in I ∪ {1} and λ ∈ sn , we set
                       Cλs = (Css21...sr λ )(Css32...sr λ ) . . . (Cλsr ) ∈ Hn .
It is easy to check that
   (b) the A-module of Hn is generated by the elements Cλs with s, λ as above.
34                                        G. LUSZTIG

31.6. If A is a simple perverse sheaf on an algebraic variety V and K is a perverse
sheaf on V we write (A : K) for the multiplicity of A in a Jordan-Hölder series of
K.
   Until the end of 31.9, A denotes a fixed character sheaf on D. For
   (a) λ ∈ sn and a sequence s = (s1 , s2 , . . . , sr ) in I ∪ {1} with s1 s2 . . . sr Dλ = λ
we set
                                                           s,L
                               X
                      γλ (s) =    (−v)j (A : p H j (K̄D        )) ∈ A
                                  j∈Z

where L ∈ sn is in the isomorphism class λ.
Proposition 31.7. There is a unique A-linear map ζ A : Hn [D] −           → A such that
for any λ ∈ sn and any sequence s = (s1 , s2 , . . . , sr ) in I ∪ {1} we have

                  ζ A (CDλ
                        s
                           [D]) = v − dim G γλ (s) if s1 s2 . . . sr Dλ = λ,

                         ζ A (CDλ
                               s
                                  [D]) = 0 if s1 s2 . . . sr Dλ 6= λ.

    Let X be the free A-module with basis [λ′ , s, λ] where s = (s1 , s2 , . . . , sr ) is
a sequence in I ∪ {1} and λ, λ′ ∈ sn are such that s1 s2 . . . sr Dλ = λ′ . Define a
A-linear map c : X −    → Hn [D] by c[λ′ , s, λ] = CDλ   s
                                                           [D]. Define a A-linear map
 ′                 ′ ′           − dim G
c :X−   → A by c [λ , s, λ] = v          γλ (s) if λ = λ, c [λ , s, λ] = 0 if λ′ 6= λ. Since
                                                    ′      ′ ′

c is surjective (see 31.5(b)) we see that it suffices to prove the following statement.
    (a) If ξ ∈ ker(c) then ξ ∈ ker(c′ ).
By a standard argument [BBD, §6], to prove (a), we may assume that
    (b) k is an algebraic closure of a finite field Fq , that G has a fixed Fq -structure
with Frobenius map F : G −      → G which induces the identity map on W and on
G/G and the map t 7→ t on T and that F ∗ L ∼
      0                     q
                                                      = L for any L ∈ sn .
(We use that sn is a finite set.) Then each L as in (a) may be regarded as pure
                          L,w     L,w     L,s
of weight 0 and each KD       , KD    , K̄D   (as in 28.13) may be regarded as a mixed
complex on D. For any mixed complex K on D we denote by p Hji (K) the j-th
subquotient of the weight filtration of p H i (K) so that p Hji (K) is a pure perverse
sheaf of weight j; we set
                                   X
                        χA
                         v (K) =          (−1)i (A : p Hji (K))v j ∈ A.
                                    i,j


Define a A-linear map ζ̃ A : Hn [D] −
                                    → A by

                                                     w,L
                  ζ̃ A (Tw 1Dλ [D]) = v − dim G χA
                                                 v (KD ), if wDλ = λ,


                             ζ̃ A (Tw 1Dλ [D]) = 0 if wDλ 6= λ
where L ∈ sn is in the isomorphism class λ.
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                    35

   Let λ, L, s, r be as in 31.6(a); we will show that

                           s,L
(c)                   χA
                       v (KD ) = v
                                   dim G A
                                        ζ̃ (Ts1 Ts2 . . . Tsr 1Dλ [D]),


                                   s,L
(d)                          χA
                              v (K̄D ) = v
                                           dim G A   s
                                                ζ̃ (CDλ )[D]).

We prove (c) by induction on r. We may assume that all si are in I. If r = 0 we
      s,L     1,L
have KD   = KD    and the result is clear; we have

                                   1,L
                              χA
                               v (KD ) = v
                                           dim G A
                                                ζ̃ (1Dλ [D]).

Assume that r ≥ 1. Assume first that l(s1 s2 . . . sr ) = r. Using 28.13(a) repeatedly
                s,L        w,L
we have KD            = KD       where w = s1 s2 . . . sr . Then the right hand side of (c)
           dim G A
equals v           ζ̃ (Tw 1Dλ ); the result follows. Assume next that l(s1 s2 . . . sr ) < r.
We can find j ∈ [2, r] such that sj . . . sr−1 sr is a reduced expression in W and
sj−1 sj . . . sr−1 sr is not a reduced expression. We can find s′j , . . . , s′r−1 , s′r in I such
that s′j . . . s′r−1 s′r = sj . . . sr−1 sr and s′j = sj−1 . Let

                          u = (s1 , s2 , . . . , sj−1 , s′j , . . . , s′r−1 , s′r ).

                                                                    s,L    u,L
As in the proof of the implication (v) =⇒ (i) in 28.13 we see that KD   = KD   .
Hence
                                   s,L         u,L
                             χA           A
                              v (KD ) = χv (KD ).

Moreover, both the right hand side of (c) and the analogous expression obtained
by replacing s by u are equal to

                       v dim G ζ̃ A ((Ts1 . . . Tsj−1 Tsj sj+1 ...sr 1Dλ )[D]).

Hence to prove the lemma for s it suffices to prove it for u. Thus we are reduced to
the case where sj = sj−1 . In this case we will use the notation in 28.13(d),(e),(f)
with J = I.
                                                       s,L                 s′′ ,L
        / Js , then from 28.13(f) we have χA
   If j ∈                                        v (K  D   ) =   v 2 A
                                                                    χ v (K D      ). In this case
we have
                        Tsj−1 Tsj 1sj+1 ...sr Dλ = v 2 1sj+1 ...sr Dλ
since sj ∈
         / Wsj+1 ...sr Dλ . Hence the right hand side of (c) is equal to

                     v 2 v dim G ζ̃ A (Ts1 . . . Tsj−2 Tsj+1 Tsj+2 Tsr 1Dλ [D])
                                                                               ′′
                                                       s ,L
which by the induction hypothesis is equal to v 2 χA
                                                   v (KD    ). Thus, (c) holds in
this case.
36                                            G. LUSZTIG

     If j ∈ Js , then from 28.13(d),(e) we have
                                              ′′                  ′                                ′
      s,L                        s ,L                            s ,L                     s ,L
 χA          A             2 A
  v (KD ) = χv (π1! L̃) + v χv (KD    ),                v 2 χA          A             A
                                                             v (KD ) = χv (π1! L̃) + χv (KD ).

(Indeed since the weight filtrations are strictly compatible with morphisms [BBD,
5.3.5], the exact sequences 28.13(d),(e) remain exact when each p H i is replaced
by its pure subquotient of a fixed weight.) It follows that
                                                   ′′                        ′
                            s,L          s ,L                   s ,L
                       χA          2 A
                        v (KD ) = v χv (KD    ) + (v 2 − 1)χA
                                                            v (KD ).

Using the induction hypothesis for s′′ , s′ we see that
                ′′                        ′
              s ,L                   s ,L
     v 2 χA
          v (KD    ) + (v 2 − 1)χA          2 dim G A
                                 v (KD ) = v v     ζ̃ (Ts1 . . . Tsj−2 Tsj+1 Tsr 1Dλ [D])
     + (v 2 − 1)v dim G ζ̃ A (Ts1 . . . Tsj−1 Tsj+1 . . . Tsr 1Dλ [D]).

Substituting here

          v 2 T1 1sj+1 ...sr Dλ ) + (v 2 − 1)Tsj−1 1sj+1 ...sr Dλ ) = Tsj−1 Tsj 1sj+1 ...sr Dλ )
                                                                                        ′′
                                                                    s ,L
which holds since sj−1 = sj ∈ Wsj+1 ...sr Dλ , we see that v 2 χA
                                                                v (KD    ) + (v 2 −
            ′
       s ,L
1)χA
   v (KD ) is equal to the right hand side of (c). Thus (c) holds.
  We prove (d). We will use the notation in 28.13(b) with J = I. Using 28.13(b)
we get
                    i i ∗                  i+1 i+1 ∗               sJ ,L
                                                           X
        χAv (π̄   f
                s! ! (f ) L̄) = χA
                                 v (π̄   f
                                       s! !   (f  )  L̄) +   χAv (KD     )
                                                                  J ⊂Js ;|J |=i

for any i. Summing these equalities over all i ≥ 0 we find
                                 s,L              sJ ,L
                                         X
                        χAv ( K̄ D   ) =    χAv (KD     ).
                                                   J ⊂Js

                                                                      s,L
We now use (c) for each sJ in the last sum. We see that χA       v (K̄D ) is a sum of
2k terms (each term is v dim G times a product of basis elements of Hn times [D])
where k = |Js |. Clearly, the right hand side of (d) is the sum of the same 2k terms.
This proves (d).
                                  s,L                                      s,L
   As in the proof of 29.14, K̄D      is pure of weight 0 hence p Hji (K̄D     ) equals
p i    s,L
 H (K̄D ) if i = j and equals 0 if i 6= j. It follows that
                                               s,L
                                         χA
                                          v (K̄D ) = γλ (s)

hence (d) implies c′ [λ, s, λ] = ζ̃ A (CDλs
                                             )[D]) = ζ̃ A (c[λ, s, λ]). Clearly, c′ [λ′ , s, λ] =
ζ̃ A (c[λ′ , s, λ]) if λ 6= λ′ (both sides are 0). We see that c′ = ζ̃ A ◦ c. Hence (a)
holds. The proposition is proved.
                   CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                  37

Lemma 31.8. For any h, h′ ∈ Hn we have ζ A (hh′ [D]) = ζ A (h′ [D]h).
   By 31.5(b), we may assume that h = a1 . . . ap−1 , h′ = ap ap+1 . . . ar where

                               ai = Cssi                      for i ∈ [1, p − 1],
                                           i+1 ...sp−1 D λ̃



                                   ai = Cssi+1
                                           i
                                               ...sr Dλ for i ∈ [p, r];

here s = (s1 , s2 , . . . , sr ) is a sequence in I, 1 ≤ p ≤ r and λ, λ̃ ∈ sn . If sp . . . sr Dλ 6=
Dλ̃ or s1 . . . sp−1 Dλ̃ 6= λ then ζ A (hh′ [D]) = 0 and ζ A (h′ [D]h) = 0. Thus we may
assume that Dλ̃ = sp . . . sr Dλ and s1 . . . sp−1 Dλ̃ = λ. Then we have

                                      ai = Cssi+1
                                              i
                                                  ...sr Dλ for i ∈ [1, r]

                                                                                     s,L
and s1 s2 . . . sr Dλ = λ. Hence, setting s = (s1 , s2 , . . . , sr ), we see that K̄D   is
defined (with L ∈ sn in the isomorphism class λ). Let

                            s′ = (sp , sp+1 , . . . , sr , ǫ(s1 ), . . . , ǫ(sp−1 )),

let λ′ = sp−1 . . . s1 λ and let L′ ∈ sn be in the isomorphism class λ′ . Then

                              sp sp+1 . . . sr ǫ(s1 ) . . . ǫ(sp−1 )Dλ′ = λ′
           ′   ′                                                                        ′   ′
         s ,L                                                     s,L          s ,L
hence K̄D     is defined. Using 28.16(a) p − 1 times, we have K̄D      = K̄D        . Hence
              ′                      A                       A ′ ′          ′
γλ (s) = γλ (s ). By 31.7, we have ζ (a1 a2 . . . ar [D]) = ζ (a1 a2 . . . ar [D]) with ai
            ′

as above and
                              s                                    s
                     a′i = Csp+i
                             p+i−1                           p+i−1
                                 ...sr ǫ(s1 ...sp−1 )Dλ′ = Csp+i ...sr Dλ = ap+i−1


for i ∈ [1, r − p + 1],

                      ǫ(s         )                  ǫ(s           )
           a′i = Cǫ(si−r+p
                     i−r+p−1                 i−r+p−1
                           ...sp−1 )Dλ′ = CDsi−r+p ...sr Dλ = [D]ai−r+p−1 [D]
                                                                              −1



for i ∈ [r − p + 2, r]. We have therefore ζ A (hh′ [D]) = ζ A (h′ [D]h). The lemma is
proved.
Lemma 31.9. For any h ∈ Hn we have ζ A (h[D]) = ζ A (h[D]). Here ¯: A −
                                                                      → A is
the ring homomorphism such that v m = v −m for all m.
   Using 31.5(b) we may assume that h = Cλs where s = (s1 , s2 , . . . , sr ) is a
sequence in I and λ ∈ sn . Using 31.5(a) we see that h = v −2r h. Hence it suffices
to show that ζ A (h[D]) = v −2r ζ A (h[D]). If s1 s2 . . . sr Dλ 6= λ then ζ A (h[D]) = 0
and the result is obvious. Thus we may assume that s1 s2 . . . sr Dλ = λ so that
38                                            G. LUSZTIG

  s,L
K̄D   is defined (with L ∈ sn in the isomorphism class λ). By Lemma 31.7 we have
ζ (h[D]) = v − dim G γλ (s). Hence it suffices to show that
 A


                                       γλ (s) = v −2m γλ (s)
where m = r + dim G. Using 28.17(a) we have
                                      s,L                                s,L
               X                               X
      γλ (s) =   (−v)−j (A : p H j (K̄D   )) =   (−v)−j (A : p H 2m−j (K̄D   ))
                    j                                          j
                                        s,L
                                            )) = v −2m γλ (s).
             X
         =       (−v)j−2m (A : p H j (K̄D
             j

The lemma is proved.
Lemma 31.10. Let J ⊂ I, y ∈ J W, s ∈ I, λ′ ∈ sn . We have

                                         (Cyt11 λ′ )Ty1 ;
                                       X
(a)                  Ty Cλs′ = v 2δ(y)
                                                          y1

here δ(y) is 1 if ys < y, ys ∈ J W and is 0 otherwise; the sum is taken over all
y1 ∈ J W ∩ {y, ys} such that
                               ys ∈
                                  / WJ y, y1 = y =⇒ s ∈ Wλ′ ;
t1 ∈ J ∪ {1} is defined by ys = t1 y if ys ∈ WJ y and t1 = 1 if ys ∈
                                                                   / WJ y.
   If s ∈/ Wλ′ , ys > y then both sides of (a) are equal to Tys 1λ′ . If s ∈
                                                                           / Wλ′ , ys < y
then both sides of (a) are equal to v 2 Tys 1λ′ . If s ∈ Wλ′ , ys > y then both sides of
(a) are equal to (Tys + Ty )1λ′ . If s ∈ Wλ′ , ys < y then both sides of (a) are equal
to v 2 (Tys + Ty )1λ′ . The lemma is proved.
Lemma 31.11. Let J ⊂ I, y ∈                   J
                                                  W, λ′ ∈ sn and let s = (s1 , s2 , . . . , sr ) be a
sequence in I. We have
                                              X
                                 Ty Cλs ′ =           v 2δ(y) (Cytr λ′ )Tyr ;
                                                  y

here the sum is taken over all sequences y = (y0 , y1 , . . . , yr ) in J W such that y = y0
and yi ∈ {yi−1 , yi−1 si } for i ∈ [1, r], t = (t1 , t2 , . . . , tr ) is the sequence in J ∪ {1}
defined by yi−1 si = ti yi−1 if yi−1 si ∈ WJ yi−1 and ti = 1 if yi−1 si ∈             / WJ yi−1 ;
these are subject to the requirement
                     i ∈ [1, r], ti = 1, yi−1 = yi =⇒ si ∈ Wsi+1 ...sr λ′ ;
moreover,
(a)                     δ(y) = ♯(i ∈ [1, r]; yi−1si < yi−1 , yi−1 si ∈ J W).

     This follows by applying r times Lemma 31.10.
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                                39

31.12. Until the end of 31.14 we fix D, P, L, G′ , D′ as in 29.1. Let J ⊂ I be
such that P ∈ PJ . Let HJ,n be the A-algebra defined in terms of L in the same
way as Hn was defined in 31.2 in terms of G0 . Since the Weyl group of L is
naturally the subgroup WJ of W and the canonical torus of L may be identified
with T as in 29.1, we may identify HJ,n with the subalgebra of Hn generated as
an A-submodule by
   (a) {Tw 1λ ; w ∈ WJ , λ ∈ sn }.
Then Hn is naturally a left HJ,n -module (using left multiplication). This HJ,n -
module is free with basis {Ty ; y ∈ J W}. (The elements bTy where b runs through
the set (a) and y ∈ J W, form the A-basis 31.2(a) of Hn .) Applying to this basis
the ring involution ¯ : Hn −→ Hn which restricts to a ring involution of HJ,n we
                 −1      J
deduce that {Ty−1 ; y ∈ W} is a basis of the left HJ,n -module Hn .
Lemma 31.13. Let λ ∈ sn and let s = (s1 , s2 , . . . , sr ) be a sequence in I such that
s1 s2 . . . sr Dλ = λ. Let L ∈ sn be in the isomorphism class λ. Let m = r + dim G.
For any j ∈ Z we have
                                     ′
                       p
                           H j (resD    s,L  ∼ p 2m−j (resD′ (K̄ s,L )).
                                   D (K̄D )) = H          D     D


    Let Ξ be the set of all pairs (y, t) where y = (y0 , y1 , . . . , yr ) is a sequence in
J
  W such that yr = ǫ(y0 ) and yi ∈ {yi−1 , yi−1 si } for i ∈ [1, r], t = (t1 , t2 , . . . , tr ) is
the sequence in J ∪ {1} defined by yi−1 si = ti yi−1 if yi−1 si ∈ WJ yi−1 and ti = 1
if yi−1 si ∈
           / WJ yi−1 ; these are subject to the requirement

                   i ∈ [1, r], ti = 1, yi−1 = yi =⇒ si ∈ Wsi+1 ...sr Dλ .

Using 29.14 we see that it suffices to show that for any j we have
                                           y0                                                 y0
                                   t,
           ⊕(y,t)∈Ξ p H j−2d(y) (K̄D  ′
                                              L
                                                  )) ∼                            t,
                                                     = ⊕(y,t)∈Ξ p H 2m−j−2d(y) (K̄D′
                                                                                                 L
                                                                                                     )).

Here both sides are semisimple complexes (see 28.12); hence it suffices to show
that for any character sheaf A′ on D′ we have
                                                     t,y0 L
                    X
                          (−v)j (A′ : p H j−2d(y) (K̄D ′    ))
                      (y,t)∈Ξ;j
                                                                                y0
                                                                     t,            L
                                       (−v)j (A′ : p H 2m−j−2d(y) (K̄D
                              X
                      =                                                 ′              )).
                           (y,t)∈Ξ;j

or equivalently
                                                                    y0
                                                               t,      L
                                X
                    v 2d(y)               (−v)j (A′ : p H j (K̄D  ′        ))
                              (y,t)∈Ξ;j
                                                                                 y0
                                                                           t,       L
                                                     (−v)−j (A′ : p H j (K̄D
                                           X
                           2m−2d(y)
                     =v                                                       ′         )).
                                        (y,t)∈Ξ;j
40                                              G. LUSZTIG

Using 31.7 for G′ , A′ , t instead of G, A, s, we see that it suffices to show
     X       ′                                 X
          ζ A (CDy
                t
                    0 λ [D])v dim L 2d(y)
                                   v      =         ζ A′ (CDy
                                                           t
                                                             0λ
                                                                [D])v dim L v 2d(y) v 2m .
      (y,t)∈Ξ                                             (y,t)∈Ξ

          ′
                    → A is defined as in 3.7 for G′ , A′ instead of G, A. Here we
Here ζ A : HJ,n [D] −
substitute d(y) = δ(y) + dim UP with δ(y) as in 31.11(a), and use Dy0 λ = yr Dλ
and dim L + 2 dim UP = dim G; we see that it suffices to show
                                          ′
                                       ζ A (Ψ[D]) = ζ A′ (Ψ[D])v 2r

where Ψ = (y,t)∈Ξ Cytr Dλ v 2δ(y) ∈ HJ,n . We write the matrix of right multiplica-
           P
         s
tion by CDλ in Hn (an HJ,n -linear map) in the HJ,n -basis {Ty ; y ∈ J W}:
                                                          X
                                            s
(a)                                     Ty CDλ =                   ay,y′ Ty′
                                                     y ′ ∈J W


where  y ∈ J W and ay,y′ ∈ HJ,n . Using Lemma 31.11 (with λ′ = Dλ) we see that
                                  J
  y ay,ǫ(y) = Ψ where y runs over W. Hence it suffices to show that
P

                           ′   X                               X
                      ζA (             ay,ǫ(y) [D]) = ζ A′ (               ay,ǫ(y) [D])v 2r .
                               y                                   y


Using Lemma 31.9 (for G′ , A′ instead of G, A) we see that
                                 X                             ′    X
                        ζ A′ (          ay,ǫ(y) [D]) = ζ A (                 ay,ǫ(y) [D]).
                                   y                                   y


Hence it suffices to show that
                     X ′                    X ′
                        ζ A (ay,ǫ(y) [D]) =  ζ A (ay,ǫ(y) [D])v 2r .
                       y                                   y


Applying ¯ : Hn −                                   s
                → Hn to the equality (a) and using CDλ = v −2r CDλ
                                                                s
                                                                   (see the
proof of Lemma 31.9) we see that

                               v −2r Ty−1                              ay,y′ Ty−1
                                                            X
                                           s
                                       −1 CDλ =                                ′ −1 .

                                                          y ′ ∈J W


Since {Ty ; y ∈ J W}, {Ty−1
                         −1 ; y ∈
                                  J
                                    W} are two HJ,n -bases of Hn , we have

                                         cy,y′ Ty−1         Ty−1
                                   X                                         X
                       Ty =                      ′ −1 ,       −1 =                 dy,y′ Ty′
                                   y′                                         y′
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VI                                                                      41

where y, y ′ run over J W and cy,y′ , dy,y′ ∈ HJ,n . For any y we have

          ay,y′ Ty−1       −2r −1 s
                              Ty−1 CDλ = v −2r
     X                                         X
                                                                 s
                  ′ −1 = v                          dy,y′′ Ty′′ CDλ
        y′                                                                y ′′

        = v −2r                              ay′′ ,y1 Ty1 = v −2r                                               cy1 ,y′ Ty−1
                  X                     X                               X                  X               X
                               dy,y′′                                            dy,y′′         ay′′ ,y1                  ′ −1

                   y ′′                 y1                               y ′′              y1              y′

hence
                                         ay,y′ = v −2r
                                                            X
                                                                      dy,y′′ ay′′ ,y1 cy1 ,y′
                                                           y ′′ ,y1

for any y, y ′ . Hence it suffices to show that
                X ′                    X ′ X
                   ζ A (ay,ǫ(y) [D]) =    ζA (  dy,y′′ ay′′ ,y1 cy1 ,ǫ(y) [D]).
                   y                                   y              y ′′ ,y1

By Lemma 31.8 (for G′ , A′ instead of G, A) we have
                           ′                                               ′
                  ζ A (dy,y′′ ay′′ ,y1 cy1 ,ǫ(y) [D]) = ζ A (ay′′ ,y1 cy1 ,ǫ(y) [D]dy,y′′ )

Hence it suffices to show that
               X ′                        ′  X
                   ζ A (ay,ǫ(y) [D]) = ζ A (   ay′′ ,y1 cy1 ,ǫ(y) [D]dy,y′′ ).
                       y                                       y,y ′′ ,y1

We have
                                                   −1           −1
               X
                                                                         −1
                           dǫ(y),ǫ(y′ ) Tǫ(y′ ) = Tǫ(y)−1 = [D]Ty −1 [D]

                  y′
                       X                                                         X
                  =              [D]dy,y′ [D]−1 [D]Ty′ [D]−1 =                         [D]dy,y′ [D]−1 Tǫ(y′ )
                           y′                                                     y′

hence dǫ(y),ǫ(y′ ) = [D]dy,y′ [D]−1 . Hence it suffices to show that
            X ′                          ′  X
(b)               ζ A (ay,ǫ(y) [D]) = ζ A (     ay′′ ,y1 cy1 ,ǫ(y) dǫ(y),ǫ(y′′ ) [D]).
               y                                           y,y ′′ ,y1

From the definitions, y cy1 ,ǫ(y) dǫ(y),ǫ(y′′ ) is 1 if y1 = ǫ(y ′′ ) and is 0, otherwise.
                     P

Hence (b) holds. The lemma is proved.
Theorem 31.14. Let D, P, L, G′ , D′ be as in 29.1. Let A be a character sheaf on
             ′
                                                         ′
D. Then resD
           D A is a direct sum of character sheaves on D .

    We can find L ∈ s(T) and a sequence s = (s1 , s2 , . . . , sr ) in I such that
                    •
s1 s2 . . . sr D ∈ WL and such that A is a direct summand of p H i (K) for some
                      s,L                                    ′
i ∈ Z, where K = K̄D      [m], m = r + dim G. Let K ′ = resD
                                                           D (K). For any i, let
                                                                                       ′
                                             Ki = p H i (K), Ki′ = resD
                                                                      D (Ki ).
42                                       G. LUSZTIG

For any character sheaf A′ on D′ , let bi,j = (A′ : p H j (Ki′ )), bj = (A′ : p H j (K ′ )).
From 28.12(b) we have
                                               ′
                 p
                     H j (K ′ ) = p H j (⊕i resD                p j−i
                                               D (Ki )[−i]) = ⊕i H    (Ki′ )
hence bj =      i bi,j−i . Using 31.13, which is applicable since L ∈ sn for some
             P
n ∈ N∗k , we get bj = b−j for all j hence
                           X         X            X
(a)                    0=      jbj =    jbi,j−i =   (i + j)bi,j .
                               j         i,j            i,j

From 28.17(a) we have Ki = K−i . It follows that bi,j = b−i,j so that i,j ibi,j = 0.
                                                                         P
                                     P
Introducing this into (a) we find i,j jbi,j = 0. From 28.12(b) and 30.6(b) we see
that bi,j = 0 for all j > 0. Therefore we have i,j;j≤0 jbi,j = 0. Since jbi,j ≤ 0
                                                    P
for all terms of the previous sum, we must have jbi,j = 0 for all i, j. It follows
that bi,j = 0 for j 6= 0. Since p H j (Ki′ ) is a direct sum of character sheaves, by
29.15, it follows that p H j (Ki′ ) = 0 for j 6= 0. In other words, for any i, Ki′ is
a perverse sheaf on D′ which is a direct sum of character sheaves. Since A is
                                                           ′
a direct summand of Ki for some i, we see that resD       D A is a direct summand of
     ′
                ′           D′                               ′
resD
   D (Ki ) = Ki hence resD A is a perverse sheaf on D which is a direct sum of
character sheaves. The theorem is proved.
Corollary 31.15. Let A be a character sheaf on D. Then A is cuspidal (see 23.3)
if and only if it is strongly cuspidal (see 23.3).
   We may assume that A is cuspidal. Let P, L, D′ be as in 31.14 such that
                                                  ′
P 6= G0 . Since A is cuspidal we have p H i (resD
                                                D A) = 0 for all i ≥ 0. By 31.14 we
                 ′
                                                      D′
have p H i (resD                               p i
               D A) = 0 for all i 6= 0. Hence H (resD A) = 0 for all i. It follows
           ′
that resD
        D A = 0. Thus, A is strongly cuspidal. The corollary is proved.

                                        References
[BBD] A.Beilinson, J.Bernstein and P.Deligne, Faisceaux pervers, Astérisque 100 (1982).
[D]   P.Deligne, La conjecture de Weil,II, Publ.Math.I.H.E.S. 52 (1980), 137-252.
[L3]  G.Lusztig, Character sheaves,I, Adv.Math. 56 (1985), 193-237; II, 57 (1985), 226-265;
      III, 57 (1985), 266-315; IV, 59 (1986), 1-63; V, 61 (1986), 103-155.
[L9]  G.Lusztig, Character sheaves on disconnected groups,I, Represent.Th. (electronic) 7
      (2003), 374-403; II, 8 (2004), 72-124; III, (2004), 125-144; IV, 8 (2004), 145-178; V,
      math.RT/0403048.
[L10] G.Lusztig, Parabolic character sheaves,I, Moscow Math.J., math.RT/0302151 (to ap-
      pear).
[L11] G.Lusztig, Letter to J.G.M.Mars, 11/23/1985.
[L12] G.Lusztig, Hecke algebras with unequal parameters, Amer.Math.Soc., 2003, CRM Mono-
      graph Ser.18.
[MS] J.G.M.Mars and T.A.Springer, Character sheaves, Astérisque 173-174 (1989), 111-198.
[Y]   T.Yokonuma, Sur la structure des anneaux de Hecke d’un groupe de Chevalley fini,
      C.R.Acad.Sci.Paris Ser.A-B 264 (1967), A344-A347.

     Department of Mathematics, M.I.T., Cambridge, MA 02139
