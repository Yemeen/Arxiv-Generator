                                                                CLASSIFICATION OF UNIPOTENT
                                                   REPRESENTATIONS OF SIMPLE p-ADIC GROUPS, II
arXiv:math/0111248v1 [math.RT] 23 Nov 2001




                                                                                  G. Lusztig


                                                                                Introduction
                                             0.1. Let K be a nonarchimedean local field with a residue field of cardinal q. Let
                                             G(K) be the group of K-rational points of a connected, adjoint simple algebraic
                                             group G defined over K which becomes split over an unramified extension of K.
                                             Let U(G(K)) be the set of isomorphism classes of unipotent representations of
                                             G(K) (see [L4, 1.21]). Let G be a simply connected almost simple algebraic group
                                             over C of the type dual to that of G (in the sense of Langlands); let ϑ : G −    →G
                                             be the ”graph automorphism” of G associated to the K-rational structure of G as
                                             in [L4, 8.1]. One of the main results of this paper is the construction of a bijection
                                             between U(G(K)) and a set of parameters defined in terms of G and ϑ. (See 10.11,
                                             10.12.) This result (or rather a close variant of it) was stated without proof in
                                             [L4, 8.1] and was proved in [L4] assuming that ϑ = 1; it supports the Langlands
                                             philosophy. See [L4, 0.3] for historical remarks concerning this bijection. One of
                                             the main observations of [L4] and the present paper is that the various affine Hecke
                                             algebras which arise in connection with unipotent representations of G(K) can be
                                             also found in a completely different way, in terms of G, ϑ and certain cuspidal
                                             local systems. Then the problem reduces to classifying the simple modules of these
                                                                                                           √
                                             ”geometric affine Hecke algebras” with parameter equal to q. This last problem
                                                                             √
                                             makes sense in the case where q is replaced by any v0 ∈ C∗ . This problem was
                                             solved in [L4] assuming that ϑ = 1 and v0 ∈ R>0 . In the present paper we treat
                                             more generally the case where ϑ is arbitrary and v0 is either 1 or is not a root of 1.
                                             Moreover, using results of [L5], we determine which representations are tempered
                                             or square integrable.
                                             0.2. Notation. All algebraic groups are assumed to be affine. All algebraic
                                             varieties (in particular, all algebraic groups) are assumed to be over C. If G
                                             is an algebraic group, G0 denotes the identity component of G, Ḡ the group of
                                             components of G, UG the unipotent radical of G0 , ZG the centre of G, G the Lie
                                             algebra of G. For x ∈ G let ZG (x) be the centralizer of x in G. For x, x′ ∈ G let

                                                Supported in part by the National Science Foundation. This paper was written while the
                                             author enjoyed the hospitality of the Institut des Hautes Études Scientifiques.

                                                                                                                 Typeset by AMS-TEX
                                                                                        1
2                                      G. LUSZTIG

ZG (x, x′ ) = ZG (x) ∩ ZG (x′ ). If G′ is another algebraic groups, let Hom(G, G′ ) be
the set of homomorphisms of algebraic groups from G to G′ . If G′ is a subgroup
of G and g ∈ G, we denote by ZG′ (g) the centralizer of g in G′ ; let NG (G′ ) be
the normalizer of G′ in G. Let IG be the category of finite dimensional rational
representations of G. If V ∈ IG , then V is also a G-module.
   If A is a subgroup of C∗ , let GA be the set of all g ∈ G such that for any
V ∈ IG , any eigenvalue of g : V −   → V is in A. If A is a subgroup of C, let GA be
the set of all x ∈ G such that for any V ∈ IG , any eigenvalue of x : V −  → V is in
                exp(A)
A; let GA = G          .
   If X is an abelian
               √         group we write XQ , XC instead of X ⊗ Q, X ⊗ C.
   Let κ = 2π −1     ∈
                  √ C.
   Let z = a + −1b where a, b ∈ R. We say that z ≥ 0 if either a > 0, or
a = 0, b ≥ 0. We say that z > 0 if either a > 0, or a = 0, b > 0.

                                       Contents
    1. Preliminaries on affine Hecke algebras and graded Hecke algebras.
    2. A review of [L2,§8,§9].
    3. Some consequences of the first reduction theorem of [L2].
    4. Some consequences of the second reduction theorem of [L2].
    5. Geometric graded Hecke algebras.
    6. The subgroups GJ .
    7. The set R(Gτ, GJ , C, F ).
    8. Geometric affine Hecke algebras.
    9. A bijection.
    10. The main results.
    11. Tables.
    Appendix.

                       1. Preliminaries on affine Hecke
                     algebras and graded Hecke algebras
1.1. (a) A root system (R, Ř, X, Y ) consists of two finitely generated free abelian
groups X, Y , a perfect pairing h, i : X × Y −   → Z, finite subsets R ⊂ X − {0}, Ř ⊂
Y − {0} and a bijection α ↔ α̌ between R and Ř such that for any α ∈ R we have
hα, α̌i = 2 and sα : X − → X, x 7→ x − hx, α̌iα (resp. sα : Y −      → Y, y 7→ y − hα, yiα̌)
leaves R (resp. Ř) stable.
   We sometimes write (R, X) instead of (R, Ř, X, Y ).
   (b) A Q-root system (R, Ř, E, E ′) consists of two finite dimensional Q-vector
spaces E, E ′ , a perfect bilinear pairing h, i : E × E ′ −     → Q, finite subsets R ⊂
E−{0}, Ř ⊂ E −{0} and a bijection α ↔ α̌ between R and Ř such that hα, α̌′ i ∈ Z
                 ′

for any α, α′ ∈ R and for any α ∈ R we have hα, α̌i = 2 and sα : E −                  → E,
e 7→ e − he, α̌iα (resp. sα : E ′ −
                                  → E ′ , e′ 7→ e′ − hα, e′ iα̌) leaves R (resp. Ř) stable.
   We sometimes write (R, E) instead of (R, Ř, E, E ′).
Classification of unipotent representations

                               ′
   We set EC = E ⊗Q C, EC         = E ′ ⊗Q C. We denote the C-bilinear pairing
         ′
EC × EC    −
           → C defined by h, i again by h, i.
   Unless otherwise indicated, in both cases (a),(b) it is assumed that α ∈ R =⇒
2α ∈/ R.
   In the case (a) (resp. (b)) the Weyl group W0 is defined as the subgroup of
GL(X) or GL(Y ) (resp. GL(E) or GL(E ′ )) generated by {sα ; α ∈ R}. In both
cases one has the standard notion of ”basis” (or ”set of simple roots”) of R and
the corresponding notion of positive roots R+ and positive coroots Ř+ . A basis
of R always exists. If a basis of R is given then W0 is naturally a (finite) Coxeter
group with length function l : W0 − → N.
1.2. Assume that we are given a root system (R, Ř, X, Y ) and a basis Π for it. A
parameter set consists of a function λ : Π − → N such that λ(α) = λ(α′ ) whenever
hα, α̌′ i = hα′ , α̌i = −1 together with a function λ∗ : {α ∈ Π; α̌ ∈ 2Y } −
                                                                           → N. If
                                      λ,λ∗
such (λ, λ ) is given, we define HR,X to be the associative algebra over C[v, v −1 ]
            ∗

(v is an indeterminate) defined by the generators Tw , w ∈ W0 and θx , x ∈ X and
by the relations
   Tw Tw′ = Tww′ for all w, w′ ∈ W0 such that l(ww′ ) = l(w) + l(w′ ),
   (Tsα + 1)(Tsα − v 2λ(α) ) = 0 for all α ∈ Π,
   θx1 θx2 = θx1 +x2 for all x1 , x2 ∈ X,
   θx (Tsα + 1) − (Tsα + 1)θsα (x) = (θx − θsα (x) )G(α)
for all x ∈ X, α ∈ Π where, for α ∈ Π, G(α) equals
                                                  ∗                           ∗
  θα v 2λ(α)−1                (θα v 2λ(α)+λ           (α)
                                                            − 1)(θα v 2λ(α)−λ     (α)
                                                                                        + 1)
               if α̌ ∈
                     / 2Y and                                                                  if α̌ ∈ 2Y.
    θα − 1                                                  θ2α − 1

(Note that (θx − θsα (x) )G(α) is a Z-linear combination of elements θx1 , x1 ∈ X.)
                                 λ,λ∗
Now θ0 is a unit element for HR,X     .
   Let T = Y ⊗ C∗ . Let O be the algebra of regular functions T × C∗ −       → C. We
                                −1                     λ,λ∗
may identify O with the C[v, v ]-submodule of HR,X spanned by {θx , x ∈ X} (a
commutative subalgebra): to v n θx corresponds the regular function (t, a) 7→ an x(t)
               Q hx,y i              P                                ∗
where x(t) = n an n for t =             n yn ⊗ an , yn ∈ Y, an ∈ C . Now      W0 acts
                                                   W0                    λ,λ∗
naturally on O and the algebra of invariants O         is the centre of HR,X . For any
                               ∗
W0 -orbit Σ on T and v0 ∈ C let JΣ,v0 be the maximal ideal of OW0 consisting
of the functions in OW0 that vanish at all points of Σ × {v0 }. Let (OW0 )ˆ be the
                                                λ,λ∗
JΣ,v0 -adic completion of OW0 and let Ĥ = HR,X       ⊗OW0 (OW0 )ˆ.
                                          ∗                                       ∗
                              λ,λ                     λ,λ
1.3. For v0 ∈ C∗ , let Modv0 HR,X be the category of HR,X -modules that are
                                                                                                  ∗
                                                                        λ,λ
finite dimensional over C and in which v acts as v0 times 1. Let Irrv0 HR,X be the
                                                                          ∗
                                                       λ,λ
set of isomorphism classes of simple objects of Modv0 HR,X .
                        ∗                                     ∗                                       ∗
                λ,λ                     λ,λ                     λ,λ
   Let ModΣ,v0 HR,X be the category of HR,X -modules M ∈ Modv0 HR,X that
                                              ∗
                                  λ,λ
satisfy JΣ,v0 M = 0. Let IrrΣ,v0 HR,X be the set of isomorphism classes of simple
4                                       G. LUSZTIG

                           ∗
                    λ,λ
objects of ModΣ,v0 HR,X . We have

                                         ∗                    ∗
                                      λ,λ               λ,λ
(a)                            Irrv0 HR,X = ⊔Σ IrrΣ,v0 HR,X

where Σ runs over the W0 -orbits in T .
                       λ,λ∗
   For M ∈ Modv0 HR,X       and for t ∈ T let Mt be the subspace of all m ∈ M
such that for any x ∈ X, m is in the generalized eigenspace of θx : M −      → M
corresponding to the eigenvalue x(t) ∈ C∗ . We say that Mt is a weight space of
M . We have M = ⊕t Mt where t runs over T .
   Let ζ : C∗ − → R be a group homomorphism such that ζ(v0 ) 6= 0. Let X + be
the set of all x ∈ X such that hx, α̌i ≥ 0 for all α ∈ Π. We say that M (as above)
is ζ-tempered if the following holds: for any t ∈ T such that Mt 6= 0 and any
x ∈ X + we have ζ(x(t))/ζ(v0 ) ≥ 0. In the case where R generates a subgroup of
finite index of X, we say that M is ζ-square integrable if the following holds: for
any t ∈ T such that Mt 6= 0 and any x ∈ X + − {0} we have ζ(x(t))/ζ(v0 ) > 0.
1.4. Assume that we are given a Q-root system (R, Ř, E, E ′) and a basis Π for
it. A parameter set is a function µ : Π −          → Z such that µ(α) = µ(α′ ) whenever
       ′        ′                                                   µ
hα, α̌ i = hα , α̌i = −1. If such µ is given, we define H̄R,E            to be the associative
algebra over C[r] (r is an indeterminate) defined by the generators tw , w ∈ W0 and
                                                        ′
(f ), f ∈ Ō (the algebra of regular functions EC         ⊕C − → C) and by the relations
                                   ′
    tw tw′ = tww′ for all w, w ∈ W0 ;
    (f1 )(f2 ) = (f1 f2 ) for all f1 , f2 ∈ Ō;
    (a1 f1 + a2 f2 ) = a1 (f1 ) + a2 (f2 ) for f1 , f2 ∈ Ō and a1 , a2 ∈ C[r];
    (f )tsα − tsα (sα (f )) = µ(α)r f −sαα (f )
                                                                            ′
for all f ∈ Ō, α ∈ Π, where α is regarded as a linear form on EC             ⊕ C (zero on the
                            f −sα (f )
second factor) so that         α       ∈ Ō. (We regard Ō as a C[r]-algebra, by identifying
                                        ′                                                 µ
r with the second projection EC           ⊕C−   → C.) Now (0) is a unit element for H̄R,E    .
                                                               µ
    We may identify Ō with the C[r]-submodule of H̄R,E consisting of all (f ) with
f ∈ Ō (a commutative subalgebra): to (f ) corresponds f . Now W0 acts naturally
                                                                       µ
on Ō and the algebra of invariants ŌW0 is the centre of H̄R,E            . For any W0 -orbit
Σ̄ on EC and r0 ∈ C let J¯Σ̄,r0 be the maximal ideal of Ō 0 consisting of functions
          ′                                                       W

in ŌW0 that vanish at all points of Σ̄ × {r0 }.
                                µ                          µ
1.5. For r0 ∈ C let Modr0 H̄R,E       be the category of H̄R,E -modules that are finite
                                                                     µ
dimensional over C and in which r acts as r0 times 1. Let Irrr0 H̄R,E     be the set of
                                                      µ
isomorphism classes of simple objects of Modr0 H̄R,E .
                   µ                             µ                            µ
   Let ModΣ̄,r0 H̄R,E    be the category of H̄R,E   -modules M̄ ∈ Modr0 H̄R,E     that
                                      µ
satisfy JΣ̄,r0 M̄ = 0. Let IrrΣ̄,r0 H̄R,E be the set of isomorphism classes of simple
                       µ
objects of ModΣ̄,r0 H̄R,E  . We have

                                       µ                    µ
(a)                            Irrr0 H̄R,E = ⊔Σ̄ IrrΣ̄,r0 H̄R,E
Classification of unipotent representations

                                          ′
where Σ̄ runs over the W0 -orbits in EC     .
                       µ              ′       ′
   For M̄ ∈ Modr0 H̄R,E and for e ∈ EC          let M̄e′ be the subspace of all m ∈ M̄
such that for any f ∈ Ō, m is in the generalized eigenspace of (f ) : M̄ −       → M̄
                                        ′
corresponding to the eigenvalue f (e , r0 ). We say that M̄e is a weight space of M̄ .
                                                               ′

We have M̄ = ⊕e′ ∈EC  ′ M̄e′ .

   Let τ : C −→ R be a group homomorphism such that τ (r0 ) 6= 0. We say that M̄
(as above) is τ -tempered if the following holds: for any e′ ∈ EC  ′
                                                                     such that M̄e′ 6= 0
and any e ∈ E such that he, α̌i ≥ 0 for all α ∈ Π we have τ (he, e′ i)/τ (r0 ) ≥ 0.
In the case where R generates E as a vector space, we say that M̄ is τ -square
integrable if the following holds: for any e′ ∈ EC      ′
                                                          such that M̄e′ 6= 0 and any
e ∈ E − {0} such that hx, α̌i ≥ 0 for all α ∈ Π we have τ (he, e′ i)/τ (r0 ) > 0.

                                2. A review of [L2,§8,§9]
2.1. Let ♠ be a Q-subspace of C such that κQ ∩ ♠ = 0. Let ♠       ˜ be the image of
                        ∗                                                  ∼ ˜
♠ under exp : C −   → C . Then exp restricts to a group isomorphism ♠ −→ ♠.
   If T is a torus, we have canonically T = L⊗C∗ where L is the free abelian group
Hom(C∗ , T ). We have T♠ = L⊗♠.   ˜ If t = T we have canonically t = LC , t♠ = L⊗♠
                                                                       ∼
and exp : t − → T (denoted also by expT ) induces an isomorphism t♠ −→ T♠ .
2.2. In this section we will refer to a subsection of [L2] such as [L2, 8.13] simply
as [8.13].
    Now [L2,§6,§9] gives a method which allows one to reduce a number of questions
on representations of an affine Hecke algebra to analogous questions on graded
Hecke algebras. Here we shall give a variation of this method. We will indicate
how to modify §8 and §9 of [L2] (for example [8.13] will become [8.13]′ ) to obtain
this variation.
    [8.1]′ . From now on we assume that
    (a) Y is generated by Ř ∪ ( 21 Ř ∩ Y ).
Assume that a W0 -orbit Σ in T and an element v0 ∈ ♠        ˜ are given. We define
an equivalence relation on Σ as follows: we say that t, t′ ∈ Σ are equivalent if
t′ t−1 ∈ T♠ . Let P be the set of equivalence classes. Note that W0 acts transitively
on P.
    Let c ∈ P. We choose t ∈ c and we define

                                   ˜ if α̌ ∈
               Rc = {α ∈ R; α(t) ∈ ♠                     ˜ if α̌ ∈ 2Y }.
                                           / 2Y, α(t) ∈ ±♠

This clearly does not depend on the choice of t. We set Řc = {α̌; α ∈ Rc }. There
is a unique subset Πc of Rc ∩ R+ such that (Rc , Řc , X, Y, Πc) is a root system. Let
W0c be the Weyl group of this root system (a subgroup of W0 ). Using (a) and [L4,
4.5] we see that W0c = {w ∈ W0 ; w(c) = c}. Now c is a W0c -orbit in T .
   [8.2]′ is empty.
   [8.3]′ is the same as [8.3] except that the last four lines of [8.3] are replaced by:
6                                     G. LUSZTIG

   Let Tw,c θx (w ∈ W0c , x ∈ X) be the basis elements of Hc analogous to the basis
elements Tw θx (w ∈ W0 , x ∈ X) of H.
   [8.4]′ is the same as [8.4] except that the last three lines of [8.4] are deleted.
   [8.5]′ . If A is an associative ring with 1, denote by An the ring of all n × n
                                                Wc                    Wc
matrices with entries in A. We have Ẑc = Ôc 0 . Thus Ĥc is a Ôc 0 -algebra. The
identity map O → O extends continuously to a ring homomorphism i : Ô −           → Ôc
                                                                   W0 ∼       W0c
(since JΣ,v0 ⊂ Jc,v0 ). This restricts to a ring isomorphism Ô        −→ Ôc (since
   c                                                                 W0
W0 ⊂ W0 ). Via this isomorphism we can regard Ĥc also as a Ô -algebra.
   [8.6]′ . Theorem. If c ∈ P, there exists an isomorphism of ÔW0 -algebras Ĥ ∼     =
(Ĥc )n where n = card(P).
   [8.7]′ =[8.7].
   [8.8]′ is the same as [8.8] except that the reference to [8.2](b) is deleted.
   [8.9]′ =[8.9].
   [8.10]′ remains unchanged except that formula (a) should be replaced by:
                    s   (c)    sα    ...sα sα (c)
   (a) Twc = Tscα Tsαα21 . . . Tsαpp−1       2   1
                                                     .
                    1
           ′                ′
   [8.11] =[8.11], [8.12] =[8.12].
   [8.13]′ is deleted except for the line (e) and the three lines following it which
are left unchanged.
   [8.14]′ =[8.14], [8.15]′ =[8.15].
   [8.16]′ . Lines 2,3 of 8.16 are replaced by
   For any c′ ∈ P let w ∈ W0 be the unique element of minimal length such that
w(c) = c′ . If sα1 sα2 . . . sαp = w is a reduced expression in W0 , then
                                          6 sα1 sα2 . . . sαp (c) = c′ .
   c 6= sαp (c) 6= sαp−1 sαp (c) 6= · · · =
   The rest of [8.16] remains unchanged except that [Γ(c)], γ, γ ∈ Γ(c), Tγc are
deleted.
   [8.17]′ is empty.
   [9.1]′ . We preserve the setup of §3. Assume that we are given a W0 -orbit Σ in
T and an element v0 ∈ ♠       ˜ such that for any t ∈ Σ and any α ∈ R we have
   α(t) ∈ ♠  ˜ if α̌ ∈/ 2Y, α(t) ∈ ±♠˜ if α̌ ∈ 2Y.
        ′
   [9.2] . The text of [9.2] except for the last three lines is replaced by the following:
   Define r0 ∈ ♠ by exp(r0 ) = v0 . Let t = T . We show that there exists a
W0 -invariant element t0 ∈ T and a W0 -orbit Σ̄ in t♠ such that t0 expT (Σ̄) = Σ.
   Choose a Q-subspace ⋄ of C complementary to ♠, and consider the subgroup
exp(⋄) of C∗ . Then C∗ = exp(⋄) × ♠         ˜ and we have a W0 -invariant decomposition
T = T⋄ × T♠ . For any α ∈ R we have α(T⋄ ) ∈ exp(⋄) and α(T♠ ) ∈ ♠.           ˜ Hence if
pr1 : T − → T⋄ is the first projection, we have for any t ∈ Σ

                α(pr1 (t)) = 1 if α̌ ∈
                                     / 2Y,    α(pr1 (t)) = ±1 if α̌ ∈ 2Y.

It follows that pr1 (t) is W0 -invariant for any t ∈ Σ. Since pr1 (Σ) is a single
W0 -orbit, it follows that pr1 (Σ) = {t0 } for some W0 -invariant t0 ∈ T⋄ . Let Σ̄ be
the unique subset of t♠ such that expT (Σ̄) = t−1 0 Σ. Then t0 , Σ̄ are as required.
Classification of unipotent representations

Another choice for t0 , Σ̄ must be of form t0 expT (ξ0 ), Σ̄ − ξ0 where ξ0 ∈ t♠ is
W0 -invariant.
    The last three lines of [9.2] remain unchanged.
    [9.3]′ =[9.3], [9.4]′ =[9.4].
    [9.5]′ is the same as [9.5] except that the last three lines of [9.5] are replaced by
the following.
    Assume for example that α̌ ∈   / 2Y and
    (c) α(t̄) + 2λ(α)r0 ∈ κZ − {0}.
Since t̄ ∈ t♠ , we have α(t̄) ∈ ♠. Since r0 ∈ ♠ and λ(α) ∈ N, it follows that the
left hand side of (c) is contained in ♠. But the right hand side of (c) is not in
♠ and we have a contradiction. Similarly we see that the other statements (a),(b)
hold.
    [9.6]′ is the same as [9.6] except that the reference to [9.2](c) is deleted.
    [9.7]′ is empty.

     3. Some consequences of the first reduction theorem of [L2]
                                                            ˜ Let
3.1. We place ourselves in the setup of 2.1 and we fix v0 ∈ ♠.

                               X, Y, R, Ř, Π, W0 , O, λ, λ∗ , T
                                                ∗
                                              λ,λ
be as in 1.2. We write H instead of HR,X          . We assume that
    (a) Y is generated by Ř ∪ ( 12 Ř ∩ Y ).
Let Σ be a W0 -orbit on T . Let P be as in [8.1]′ (see 2.2). Let c ∈ P. Recall that
c is a W0c -orbit on T . Let Rc , Řc′ , Πc , W0c be as in [8.1]′ (see 2.2). Let Hc be the
algebra defined in the same way as H, but in terms of (X, Y, Rc, Řc , Πc ) instead
of (X, Y, R, Ř, Π); the parameter set (λc , λ∗c ) that we use to define Hc is given by
λc (α) = λ(α′ ), λ∗c (α) = λ∗ (α′ ), where α ∈ Πc , α′ ∈ Π are in the same W0 -orbit.
(This does not depend on the choice of α′ .) Note that O is a subalgebra of Hc in
the same way as O is a subalgebra of H.
                                                   c
    Let Jc,v0 be the maximal ideal of OW0 (the centre of Hc ) consisting of the
                  c                                                     c
functions in OW0 that vanish at all points of c × {v0 }. Let (OW0 )ˆbe the Jc,v0 -adic
                     c                                  c
completion of OW0 and let Ĥc = Hc ⊗OW0c (OW0 )ˆ.
    Assume that M ∈ Modc,v0 Hc . In particular in the Hc -module M we have
Jc,v0 M = 0. Hence M extends naturally to an Ĥc -module. The C[v, v −1 ]-module
M P = M ⊕M ⊕. . .⊕M (one summand for each c′ ∈ P) is naturally a module over
the algebra of matrices with entries in Ĥc indexed by P × P. The first reduction
theorem [L2, 8.6], in the variant [8.6]′ (see 2.2), gives an explicit isomorphism ι of
this algebra of matrices with the algebra Ĥ (see 1.3). Via this isomorphism, M P
becomes an Ĥ-module and, by restriction, an H-module in ModΣ,v0 H. From the
definition we see that, if f ∈ O (regarded as an element of Ĥ), then the (c′ , c′′ )-
entry of ι−1 (f ) (for c′ , c′′ in P) is 0 if c′ 6= c′′ and is w′−1 (f ) if c′ = c′′ ; here
w′ ∈ W0 is the unique element of minimal length of W0 such that w′ (c) = c′ .
8                                         G. LUSZTIG

                                                                              ∼
Lemma 3.2. The rule M 7→ M P is a bijection Irrc,v0 Hc −→ IrrΣ,v0 H.
   This is an immediate consequence of the definitions and of [L2, 8.6], in the
variant [8.6]′ (see 2.2).
   Let S be the set of all w ∈ W0 such that the length of w is minimal in wW0c ,
or equivalenty, such that w(α̌) ∈ Ř+ for any α ∈ Πc .
Lemma 3.3. Let x ∈ X be such that hx, α̌i ≥ 0 for all α ∈ Πc . Let w ∈ W0 and
x′ ∈ X be such that x = w−1 (x′ ), hx′ , α̌′ i ≥ 0 for all α′ ∈ Π and w−1 (α̌′ ) ∈ Ř+
for any α′ ∈ Π for which hx′ , α̌′ i = 0. Then w ∈ S.

P If w ∈/ S then there exists α ∈ Πc such that w(α̌) ∈ −Ř+ that is, w(α̌) =
            ′
 α′ ∈Π nα α̌ where −nα ∈ N. It follows that
         ′             ′


                                                         X
                        0 ≤ hx, α̌i = hx′ , w(α̌)i =             nα′ hx′ , α̌′ i.
                                                          α′


Since nα′ hx′ , α̌′ i ≤ 0 for all α′ , it follows that nα′ hx′ , α̌′ i = 0 for all α′ . Hence for
any α′ ∈ Π such that hx′ , α̌′ i = 6 0 we have nα′ = 0. In other words,
                                                X
                                w(α̌) =                        nα′ α̌′ .
                                          α′ ∈Π;hx′ ,α̌′ i=0


Hence α̌ = α′ ∈Π;hx′ ,α̌′ i=0 nα′ w−1 (α̌′ ). For each α′ in the sum, we have w−1 (α̌′ ) ∈
          P

Ř+ and nα′ ≤ 0 hence α̌ ∈ −Ř+ , a contradiction. The lemma is proved.
Lemma 3.4. Let M ∈ Modc,v0 Hc . Assume that ζ : C∗ −      → R is a homomorphism
such that ζ(v0 ) 6= 0. The following two conditions are equivalent:
   (i) the Hc -module M is ζ-tempered;
   (ii) the H-module M P is ζ-tempered.
   Let D (resp. D′ ) be the set of all t ∈ T such that Mt 6= 0 (resp. MtP 6= 0).
By the description of ι−1 (f ) given in 3.1, we see that D′ = ∪w∈S w(D) where S
consists of all elements w ∈ W0 such that the length of w is minimal in wW0c , or
equivalenty, such that w(α̌) ∈ Ř+ for any α ∈ Πc . Hence (ii) is equivalent to the
following condition:
   for any t ∈ D, any w ∈ S and any x ∈ X + , we have ζ(x(w(t)))/ζ(v0) ≥ 0, or
equivalently ζ((w−1 x)(t))/ζ(v0 ) ≥ 0.
   We see that it is enough to show that the following two conditions for x ∈ X
are equivalent:
   (iii) hx, α̌i ≥ 0 for all α ∈ Πc ;
   (iv) there exists w ∈ S and x′ ∈ X + such that x = w−1 (x′ ).
   Assume first that (iv) holds. Write x = w−1 (x′ ) as in (iv). Let α ∈ Πc . Since
w ∈ S, we have w(α̌) ∈ Ř+ . Using (iv) we deduce that hx′ , w(α̌)i ≥ 0. Thus
hw−1 (x′ ), α̌i ≥ 0 so that (iii) holds.
Classification of unipotent representations

   Assume next that (iii) holds. We can write uniquely x = w−1 (x′ ) where x′ ∈ X
satisfies hx′ , β̌i ≥ 0 for all β ∈ Π and w ∈ W0 is such that w−1 (β̌) ∈ Ř+ for any
β ∈ Π for which hx′ , β̌i = 0. By 3.3 we have w ∈ S. Hence (iv) holds. The lemma
is proved.
Lemma 3.5. Assume that R generates a subgroup of finite index in X. Let M ∈
Modc,v0 Hc . Assume that ζ : C∗ −→ R is a homomorphism such that ζ(v0 ) 6= 0.
The following two conditions are equivalent:
   (i) Rc generates a subgroup of finite index of X and the Hc -module M is ζ-
square integrable;
   (ii) the H-module M P is ζ-square integrable.
    Assume that (ii) holds but Rc generates a subgroup of infinite index of X. Then
Řc generates a subgroup of infinite index of Y hence we can find z ∈ X − {0} such
that hz, α̌i = 0 for any α ∈ Πc . We can write uniquely z = w′−1 (x′ ) where x′ ∈
X − {0} satisfies hx′ , β̌i ≥ 0 for all β ∈ Π and w′ ∈ W0 is such that w′−1 (β̌) ∈ Ř+
for any β ∈ Π for which hx′ , β̌i = 0. By 3.3, we have w′ ∈ S. Thus, z = w′−1 (x′ )
where x′ ∈ X − {0} satisfies hx′ , β̌i ≥ 0 for all β ∈ Π and w′ ∈ S. The same
argument can be applied to −z instead of z. We see that −z = w′′−1 (x′′ ) where
x′′ ∈ X − {0} satisfies hx′′ , β̌i ≥ 0 for all β ∈ Π and w′′ ∈ S.
    Since (ii) holds, and D′ = ∪w∈S w(D) (D, D′ as in the proof of 3.4), we see that,
for any t ∈ D, any w ∈ S and any x ∈ X + − {0}, we have ζ(x(w(t)))/ζ(v0 ) > 0
that is, ζ((w−1 x)(t))/ζ(v0 ) > 0. In particular, for any t ∈ D we have

               ζ((w′−1 x′ )(t))/ζ(v0 ) > 0 and ζ((w′′−1 x′′ )(t))/ζ(v0 ) > 0.

We have 0 = z − z = w′−1 (x′ ) + w′′−1 (x′′ ) hence

       0 < ζ((w′−1 x′ )(t))/ζ(v0 ) + ζ((w′′−1 x′′ )(t))/ζ(v0 )
        = ζ((w′−1 x′ )(t)(w′′−1 x′′ )(t))/ζ(v0 )
        = ζ((w′−1 x′ + w′′−1 x′′ )(t))/ζ(v0 ) = ζ(0(t))/ζ(v0 ) = ζ(1)/ζ(v0 ) = 0.

This is a contradiction. We see that (ii) implies the first condition in (i). Now the
proof continues exactly as in 3.4; in particular we see that the equivalence of (i)
and (ii) follows from the equivalence of 3.4(iii) and 3.4(iv). The lemma is proved.

    4. Some consequences of the second reduction theorem of [L2]
                                                            ˜ Define r0 ∈ ♠ by
4.1. We place ourselves in the setup of 2.1 and we fix v0 ∈ ♠.
exp(r0 ) = v0 . Let
                           X, Y, R, Ř, Π, W0 , λ, λ∗ , T
                                              ∗
                                       λ,λ
be as in 1.2. We write H instead of HR,X   . Let t = T . Assume that we are given
a W0 -orbit Σ in T such that for any t ∈ Σ and any α ∈ R we have
                              ˜ if α̌ ∈
                       α(t) ∈ ♠       / 2Y,           ˜ if α̌ ∈ 2Y.
                                              α(t) ∈ ±♠
10                                   G. LUSZTIG

As in [9.2]′ (see 2.2) we can find t0 ∈ T (W0 -invariant) and a W0 -orbit Σ̄ in t♠
such that Σ = t0 expT (Σ̄).
   Now (R, Ř, XQ , YQ ) is a Q-root system with basis Π and with a parameter set
µ:Π−  → Z defined by
                            / 2Y and µ(α) = λ(α) + α(t0 )λ∗ (α) if α̌ ∈ 2Y.
         µ(α) = 2λ(α) if α̌ ∈
                                                                                 µ
(In the last equality we have α(t0 ) = ±1 since sα (t0 ) = t0 .) Let H̄ = H̄R,E     .
                                                                                ∗
Let Ō ⊂ H̄ be as in 1.4. We have YC = t. Define Ψ : t ⊕ C −         → T × C by
  ′                   ′
(e , z) 7→ (t0 expT (e ), exp(z)).
    Let (ŌW )ˆ be the JΣ̄,r0 -adic completion of ŌW . Let M̄ ∈ ModΣ̄,r0 H̄. Since
J     M̄ = 0, M̄ extends naturally to a module over H̄  ˆ = H̄ W (ŌW )ˆ. The second
 Σ̄,r0                                                                 Ō
reduction theorem [L2, 9.3], in the variant [9.3]′ (see 2.2), gives an explicit algebra
isomorphism of Ĥ (as in 1.2) with H̄ ˆ . Via this isomorphism, M̄ becomes an Ĥ-
module and, by restriction, an H-module M̄ † ∈ ModΣ,v0 H. Note that M̄ † and M̄
have the same underlying C-vector space. Let e′ ∈ YC = t. From the definitions
we see that the e′ -weight space M̄e′ of M̄ is equal to the t-weight space M̄t† of M̄ †
where t ∈ T is defined by
(a)                            x(t) = x(t0 ) exphx, e′ i
for all x ∈ X.
                                                                   ∼
Lemma 4.2. The rule M̄ 7→ M̄ † is a bijection IrrΣ̄,r0 H̄ −→ IrrΣ,v0 H.
   This is an immediate consequence of the definitions and of [L2, 9.3], in the
variant [9.3]′ (see 2.2).
Lemma 4.3. Let M̄ ∈ ModΣ̄,r0 H̄. Assume that ζ : C∗ −      → R is a homomorphism
                                          Kerζ
such that ζ(v0 ) 6= 0. Assume that t0 ∈ T      . Define a homomorphism τ : C −  →R
by τ (z) = ζ(exp(z)). Then τ (r0 ) 6= 0. The following two conditions are equivalent:
   (i) the H̄-module M̄ is τ -tempered;
   (ii) the H-module M̄ † is ζ-tempered.
   In view of 4.1(a) it is enough to show that for e′ ∈ YC , the following two
conditions are equivalent:
   (iii) for any e ∈ XQ such that he, α̌i ≥ 0 for all α ∈ Π we have
ζ(exphe, e′ i)/ζ(v0 ) ≥ 0;
   (iv) for any x ∈ X + we have ζ(x(t0 ) exphx, e′ i)/ζ(v0 ) ≥ 0.
   Since t0 ∈ T Kerζ , for any x ∈ X we have ζ(x(t0 )) = 0 and in (iv) we have
(a)                      ζ(x(t0 ) exphx, e′ i) = ζ(exphx, e′ i).
Since X ⊂ XQ it follows that, if (iii) holds then (iv) holds.
   Assume now that (iv) holds. Let e ∈ XQ be such that he, α̌i ≥ 0 for all α ∈ Π.
We can find n ∈ N − {0} such that ne ∈ X + . Since (iv) holds, it follows that
ζ(exphne, e′ i)/ζ(v0 ) ≥ 0. (We use (a).) Hence nζ(exphe, e′ i)/ζ(v0 ) ≥ 0 so that
ζ(exphe, e′ i)/ζ(v0 ) ≥ 0. Thus (iii) holds. The lemma is proved.
Classification of unipotent representations

Lemma 4.4. Let M̄ ∈ ModΣ̄,r0 H̄. Assume that ζ : C∗ −  → R is a homomorphism
such that ζ(v0 ) 6= 0. Define a homomorphism τ : C − → R by τ (z) = ζ(exp(z)).
Then τ (r0 ) 6= 0. Assume that R generates XQ as a Q-vector space. The following
two conditions are equivalent:
   (i) the H̄-module M̄ is τ -square integrable;
   (ii) the H-module M̄ † is ζ-square integrable.
   In view of 4.1(a) it is enough to show that for e′ ∈ YC , the following two
conditions are equivalent:
   (iii) for any e ∈ XQ − {0} such that he, α̌i ≥ 0 for all α ∈ Π we have
ζ(exphe, e′ i)/ζ(v0 ) > 0;
   (iv) for any x ∈ X + − {0} we have ζ(x(t0 ) exphx, e′ i)/ζ(v0 ) > 0.
   This is shown in the same way as in the proof of 4.3. (In this case we have
automatically ζ(x(t0 )) = 0. Indeed, since t0 is W0 -invariant and R generates XQ ,
we see that t0 has finite order in T hence ζ(x(t0 )) has finite order in R hence
ζ(x(t0 )) = 0.) The lemma is proved.

                      5. Geometric graded Hecke algebras
5.1. If G is an algebraic group, the exponential map exp : G −
                                                             → G restricts to a
              ∼
bijection G♠ −→ G♠ .
5.2. In this section we review some results of [L1], [L5] and give some variants of
them.
   Assume that G is a connected reductive algebraic group. Let g = G. Let L be
the Levi subgroup of some parabolic subgroup of G. Let C be a nilpotent L-orbit
in L and let F be an irreducible L-equivariant cuspidal local system (over C) on
C. Let T = ZL0 . Let t = T . We have g = ⊕α∈t∗ gα where

                          gα = {x ∈ g; [y, x] = α(y)x ∀y ∈ t}.

Let R′ = {α ∈ t∗ − {0}; gα 6= 0}, R = {α ∈ R′ ; α/2 ∈    / R′ }. The group W =
N (T )/L, where N (T ) is the normalizer of T in G, acts naturally on t and t∗ . For
any α ∈ R there is a unique element sα ∈ W which acts on t∗ as a reflection
sending α to −α; there is a unique element α̌ ∈ t such that sα (x) = x − x(α̌)α for
all x ∈ t∗ . Let Ř = {α̌; α ∈ R}. We have canonically T = Y ⊗ C∗ , t = YC where
Y is the group of all one-parameter subgroups of T . Let

                      tQ = YQ , t∗Q = {x ∈ t∗ ; x(z) ∈ Q   ∀z ∈ tQ }.

Then (R, Ř, t∗Q , tQ ) is a Q-root system. Let Π a basis for it. Let y0 ∈ C. For any
α ∈ Π we denote by c(α) the integer ≥ 2 such that ad(y)c(α)−2 : gα ⊕g2α −  → gα ⊕g2α
is 6= 0 and ad(y)c(α)−1 : gα ⊕ g2α −   → gα ⊕ g2α is 0. (This is independent of the
choice y0 .) Then α 7→ c(α) is a parameter set (see 1.4) for our Q-root system.
                                 c
The corresponding algebra H̄R,t∗ (see 1.4) is denoted by H̄(G, L, C, F ).
                                      Q
12                                      G. LUSZTIG

5.3. Let r0 ∈ C. Let σ be a semisimple element of g and let y be a nilpotent
element of g such that [σ, y] = 2r0 y. Let P be a parabolic subgroup P of G with
Levi subgroup L. Let

(a)             Xσ,y = {g ∈ G; Ad(g −1 )y ∈ C + UP , Ad(g −1 )σ ∈ P }.

We have an obvious map Xσ,y −   → C which takes g to the image of Ad(g −1 )y under
C +UP −→ C, a+b 7→ a. The inverse image of F under this map is denoted again by
F . On Xσ,y we have a free P -action by right translation and F is P -equivariant
hence it descends to a local system F̃ on Xσ,y /P . The group ZG (σ, y) acts on
Xσ,y /P by left translation and F̃ is naturally a ZG (σ, y)-equivariant local system.
Then Z̄G (σ, y) acts naturally on the cohomology

(b)                                ⊕n Hcn (Xσ,y /P, F̃).

The set of irreducible representations (up to isomorphism) of Z̄G (σ, y) which ap-
pear in the representation (b) is denoted by Irr0 Z̄G (σ, y). (This set is indepen-
dent of the choice of P since another choice of P is of the form nP n−1 where
nLn−1 = L, Ad(n)C = C.)
  Let S(G, L, C, F , r0) be the set consisting of all triples (σ, y, ρ) (modulo the
natural action of G) where σ, y are as above and ρ ∈ Irr0 Z̄G (σ, y).
  In [L5] a canonical bijection

(c)                     Irrr0 H̄(G, L, C, F ) ↔ S(G, L, C, F , r0)

is established using geometric methods (equivariant homology).
5.4. We fix elements e0 , h0 , f 0 in L which satisfy the standard relations of sl2 and
e0 ∈ C. Let

      Z = {g ∈ G; Ad(g)e0 = e0 , Ad(g)h0 = h0 , Ad(g)f 0 = f 0 },
      Z̃ = {(g, a) ∈ G × C∗ ; Ad(g)e0 = a2 e0 , Ad(g)h0 = h0 , Ad(g)f 0 = a−2 f 0 }.

We have

          Z = {x ∈ G; [x, e0 ] = 0, [x, h0 ] = 0, [x, f 0] = 0},
          Z̃ = {(x, a) ∈ g × C; [x, e0 ] = 2ae0 , [x, h0 ] = 0, [x, f 0] = −2af 0 }.
                                                                           ∼
There is a unique isomorphism of algebraic groups ι : Z 0 × C∗ −→ Z̃ 0 such that
                                            ∼
the induced Lie algebra isomorphism Z ⊕ C −→ Z̃ is given by (x, a) 7→ x + ah0 .
Lemma 5.5. The inclusion Z̃ 0 −   → G × C∗ induces an injective map from the set
of semisimple Z̃ -orbits in Z̃ to the set of semisimple G × C∗ -orbits in g ⊕ C.
                0

  This has been stated without proof and used in [L1, 14.3(a)], [L3, 8.13]. The
proof is given in the appendix.
Classification of unipotent representations

5.6. Let Σ̄ be a W -orbit on t and let M̄ ∈ IrrΣ̄,r0 H̄(G, L, C, F ). Assume that M̄
corresponds to σ, y, ρ under 5.3(c).
   The centre ŌW of M̄ ∈ IrrΣ̄,r0 H̄(G, L, C, F ) acts on M̄ via a character which
may be identified with the W -orbit Σ̄ × {r0 } on t × C. By [L3, 8.13], the centre
ŌW (as in 1.4) of H̄ is identified with the equivariant cohomology HZ∗ 0 ×C∗ (point)
which via ι is identified with HZ̃∗ 0 (point); from the definitions, the natural action
of HZ̃∗ 0 (point) on M̄ is via a character that may be identified with a semisimple
orbit in Z̃ which is contained in the Ad(G × C∗ )-orbit of (σ, r0 ) in g ⊕ C.
   Thus, σ is related to Σ̄ as follows: there exists (σ ′ , r0 ) ∈ Z̃ such that σ, σ ′ are
conjugate under G and ι−1 (σ ′ , r0 ) = (σ ′ − r0 h0 , r0 ) ∈ Σ̄ × {r0 }.
   We define a map

(a)                                S(G, L, C, F , r0) −
                                                      → t/W.

Consider an element u of S(G, L, C, F , r0) represented by (σ, y, ρ). We can find
    (b) σ ′ in the G-orbit of σ such that σ ′ − r0 h0 ∈ t.
Indeed, since Xσ,y 6= ∅, there exists g ∈ G such that σ1 = Ad(g −1 )σ ∈ L, y ′ =
Ad(g −1 )y ∈ e0 + UP . From [σ1 , y ′ ] = 2r0 y ′ we deduce that [σ1 , e0 ] = 2r0 e0 . Now
we can find l ∈ L such that Ad(l)e0 ∈ C∗ e0 and such that σ ′ = Ad(l)σ1 satisfies
σ ′ ∈ L, [σ ′ , e0 ] = 2r0 e0 , [σ ′ , h0 ] = 0, [σ ′ , f 0 ] = −2r0 f 0 . Since e0 is distinguished in
L, it follows that σ ′ − r0 h0 ∈ t, as required.
    Let σ ′ be as in (b) and let Σ̄ be the W -orbit of σ ′ − r0 h0 in t. Let σ̃ ′ be another
element like σ ′ and let Σ̄     ˜ be the W -orbit of σ̃ ′ − r h0 in t. Then (σ ′ , r ), (σ̃ ′ , r )
                                                                     0                       0       0
                                                                              ∗
are semisimple elements of Z̃ and are in the same G × C -orbit in g ⊕ C hence,
by 5.5, there exists (g ′ , a) ∈ Z̃ 0 such that Ad(g ′ )σ ′ = σ̃ ′ . Since h0 is central in
Z̃, we have Ad(g ′ )σ ′ = σ̃ ′ . Since (h0 , 1) is central in Z̃, we have Ad(g ′ )h0 = h0 .
Hence Ad(g ′ )(σ ′ − r0 h0 ) = σ̃ ′ − r0 h0 . Since σ ′ − r0 h0 , σ̃ ′ − r0 h0 belong to t hence
to the Cartan subalgebra t ⊕ Ch0 , they are in the same orbit of the Weyl group of
Z̃ 0 with respect to that Cartan subalgebra, which may be identified with W . It
follows that Σ̄ = Σ̄   ˜ . Thus we have a map u 7→ Σ̄ as in (a).
    For any W -orbit Σ̄ in t let S(G, L, C, F , Σ̄, r0 ) be the inverse image of Σ̄ under
the map (a). The previous discussion yields the following result.
Lemma 5.7. Let Σ̄ be a W -orbit in t. The bijection 5.3(c) restricts to a bijection
IrrΣ̄,r0 H̄(G, L, C, F ) ↔ S(G, L, C, F , Σ̄, r0 ).
Lemma 5.8. In the setup of 2.1, assume that r0 ∈ ♠. The bijection 5.3(c)
restricts to a bijection

                          Irr♠                     ♠
                             r0 H̄(G, L, C, F ) ↔ S (G, L, C, F , r0)

where Irr♠
         r0 H̄(G, L, C, F ) = ⊔IrrΣ̄;r0 H̄(G, L, C, F ) (union over all W -orbits Σ̄ in
t♠ ) and S♠ (G, L, C, F , r0) consists of all (σ, y, ρ) in S(G, L, C, F , r0) such that
σ ∈ g♠ .
14                                    G. LUSZTIG

   Using 5.7 we see that it is enough to show that, if (σ, y, ρ) ∈ S(G, L, C, F , r0)
and Σ̄ ∈ t/W correspond to each other under 5.6(a), then we have σ ∈ g♠ if and
only if Σ̄ ⊂ t♠ . We may assume that σ − r0 h0 ∈ Σ̄. Now r0 h0 has eigenvalues in
Zr0 in any V ∈ IG (a property of sl2 ) hence r0 h0 ∈ g♠ (since r0 ∈ ♠). If we have
two elements of g♠ that commute, then their sum is again in g♠ . Applying this to
the commuting elements σ, −r0 h0 and to the commuting elements σ − r0 h0 , r0 h0
we deduce that σ ∈ g♠ if and only if σ − r0 h0 ∈ g♠ that is, if and only if Σ̄ ⊂ g♠ .
It remains to observe that g♠ ∩ t = t♠ . The lemma is proved.
   The following result is closely related to [L5, 1.21].
Lemma 5.9. Assume that τ : C −           → R is a group homomorphism such that
τ (r0 ) 6= 0. Let M̄ ∈ Irrr0 H̄(G, L, C, F ) and let (σ, y, ρ) correspond to M̄ under
5.3(c). The following two conditions are equivalent.
    (i) M̄ is τ -tempered;
    (ii) there exists h ∈ g, ỹ ∈ g such that [y, ỹ] = h, [h, y] = 2y, [h, ỹ] = −2ỹ,
[σ, h] = 0, [σ, ỹ] = −2r0 ỹ and such that σ − r0 h ∈ gKerτ .
   Assume that the lemma holds for (Gi , Li , Ci , Fi ), i = 1, 2, (two data like
(G, L, C, F )). Then one checks easily that it also holds also for (G1 × G2 , L1 ×
L2 , C1 × C2 , F1 ⊠ F2 ). Without loss of generality we can assume that G = C × G′
where G′ is semisimple and C is a torus. Hence it is enough to prove the lemma
assuming that G is either semisimple or a torus.
   Assume first that G is a torus. Then G = L = T . In this case, we must verify
that for any e′ ∈ t, the following two conditions are equivalent.
   (iii) For any e ∈ t∗Q we have τ (he, e′ i)/τ (r0 ) ≥ 0;
   (iv) e′ ∈ tKerτ = Y ⊗ Kerτ .
   Now (iii) is equivalent to the condition that, for any e ∈ t∗Q , we have τ (he, e′ i) =
0. One checks easily that this is equivalent to (iv).
   Next, assume that G is semisimple. The condition that M̄ is τ -tempered (as
given in 1.5) is in this case equivalent to the condition that M̄ is τ -tempered
according to the definition in [L5, 1.20]. (This follows easily from [L5, 3.6].) Using
[L5, 1.21] we are therefore reduced to verifying the following statement.
   If x ∈ g and any eigenvalue ν of ad(x) : g −     → g satisfies τ (ν) = 0, then for any
V ∈ IG ,
   (a) any eigenvalue ν of x : V − → V satisfies τ (ν) = 0 (that is, x ∈ gKerτ ).
   Clearly, if (a) holds for V then it also holds for V ⊗n for any n ≥ 0. Since (a)
holds for the adjoint representation it also holds for tensor powers of the adjoint
representations, hence for any direct summand of such a tensor power, hence for
any irreducible V on which ZG acts trivially, hence for any V on which ZG acts
trivially. If V ∈ IG , n ≥ 1 and (a) holds for V ⊗n then it also holds for V . (Indeed,
if ν is an eigenvalue of x : V − → V then nν is an eigenvalue of x : V ⊗n −      → V ⊗n
hence τ (nν) = 0 hence nτ (ν) = 0 hence τ (ν) = 0.) If V ∈ IG then there exists
n ≥ 1 such that ZG acts trivially on V ⊗n . As we have seen earlier, (a) holds for
V ⊗n hence it holds for V . Thus (a) holds in general. The lemma is proved.
Classification of unipotent representations

   The following result is closely related to [L5, 1.22].
Lemma 5.10. Assume that G is semisimple. Assume that τ : C −        → R is a group
homomorphism such that τ (r0 ) 6= 0. Let M̄ ∈ Irrr0 H̄(G, L, C, F ) and let (σ, y, ρ)
correspond to M̄ under 5.3(c). The following two conditions are equivalent.
   (i) M̄ is τ -square integrable;
   (ii) there exists h ∈ g, ỹ ∈ g such that [y, ỹ] = h, [h, y] = 2y, [h, ỹ] = −2ỹ,
σ = r0 h; moreover, y is distinguished.
   Using [L5, 3.6], we see that the condition that M̄ is τ -square integrable (as given
in 1.5) is in our case equivalent to the condition that M̄ is τ -square integrable
according to the definition in [L5, 1.20]. Hence the lemma follows from [L5, 1.22].
5.11. For any ξ ∈ g let

(a)                      Yξ = {g ∈ G; Ad(g −1 )ξ ∈ C + t + UP }.

We have an obvious map Yξ −   → C which takes g to the image of Ad(g −1 )y under
C + t + UP −
           → C, a + b + c 7→ a. The inverse image of F under this map is denoted
again by F . On Yξ we have a free P -action by right translation and F is P -
equivariant hence it descends to a local system F̃ on Yξ /P . The group ZG (ξ) acts
on Yξ /P by left translation and F̃ is naturally a ZG (ξ)-equivariant local system.
Then Z̄G (ξ) acts naturally on the cohomology

(b)                                    ⊕n Hcn (Yξ /P, F̃).

The set of irreducible representations (up to isomorphism) of Z̄G (ξ) which appear
in the representation (b) is denoted by Irr0 Z̄G (ξ).
5.12. Let σ, y be two elements of g such that σ is semisimple, y is nilpotent and
[σ, y] = 2r0 y. We choose (as we may) elements h, ỹ in g such that

(a)          [y, ỹ] = h, [h, y] = 2y, [h, ỹ] = −2ỹ, [σ, h] = 0, [σ, ỹ] = −2r0 ỹ

and we set ξ1 = σ−r0 h. This is a semisimple element of g (since σ, h are commuting
semisimple elements) and it commutes with y, h, ỹ. We set ξ = ξ1 + y. If we make
another choice h′ , ỹ ′ instead of h, ỹ then, as it is known, there exists an element
g ∈ ZG (σ, y) such that Ad(g)h = h′ , Ad(g)ỹ = ỹ ′ . Let ξ1′ = σ − r0 h′ . We have
Ad(g)ξ1 = ξ1′ . Let ξ ′ = ξ1′ + y. We have Ad(g)ξ = ξ ′ . Thus, the G-orbit of ξ is
well defined by σ, y (in fact, it depends only on the G-orbit of (σ, y).
   Conversely, assume that ξ ∈ g is given. We can write uniquely ξ = ξ1 + y where
ξ1 ∈ g is semisimple, y ∈ g is nilpotent and [ξ1 , y] = 0. We choose (as we may)
elements h, ỹ in g such that

(b)            [y, ỹ] = h, [h, y] = 2y, [h, ỹ] = −2ỹ, [ξ1 , h] = 0, [ξ1 , ỹ] = 0.
16                                      G. LUSZTIG

Let σ = ξ1 + r0 h. Then σ is a semisimple element (since ξ1 , h are commuting
semisimple elements) and [σ, y] = 2r0 y, [σ, h] = 0, [σ, ỹ] = −2r0 ỹ. If we make
another choice h′ , ỹ ′ instead of h, ỹ then, as it is known, there exists g ′ ∈ ZG (ξ1 , y)
such that Ad(g ′ )h = h′ , Ad(g ′ )ỹ = ỹ ′ . Let σ ′ = ξ1 + r0 h′ . We have Ad(g ′ )σ = σ ′ .
Thus the G-orbit of (σ, y) is well defined by ξ (in fact, it depends only on the
G-orbit of ξ.) Thus we have defined a bijection σ, y ↔ ξ between the set of G-
orbits of pairs (σ, y) of elements of g such that σ is semisimple, y is nilpotent and
[σ, y] = 2r0 y, on the one hand, and the set of G-orbits in g, on the other hand.
Lemma 5.13. Assume that (σ, y) corresponds to ξ as above. Then the groups
Z̄G (σ, y) and Z̄G (ξ) may be naturally identified so that Irr0 Z̄G (σ, y) = Irr0 Z̄G (ξ).
   We may assume that σ, y, ξ are related as follows: there exist h, ỹ in g so
that 5.12(a) holds and ξ = ξ1 + y where ξ1 = σ − r0 h. It is known that
Z ′ = {g ∈ G; Ad(g)y = y, Ad(g)h = h, Ad(g)ỹ = ỹ, Ad(g)σ = σ} is a maxi-
mal reductive subgroup of ZG (σ, y) hence it has the same group of components as
ZG (σ, y). Similarly, since ZG (ξ1 ) is connected, reductive, Z ′′ = {g ∈ G; Ad(g)y =
y, Ad(g)h = h, Ad(g)ỹ = ỹ, Ad(g)ξ1 = ξ1 } is a maximal reductive subgroup of
{g ∈ G; Ad(g)y = y, Ad(g)ξ1 = ξ1 } = ZG (ξ) hence Z ′′ has the same group of
components as ZG (ξ). Now Z ′ = Z ′′ . It follows that ZG (σ, y) and ZG (ξ) have the
same group of components. Note that

(a)           Yξ = {g ∈ G; Ad(g −1 )ξ1 ∈ t + UP , Ad(g −1 )y ∈ C + UP }.

Now in the presence of the condition Ad(g −1 )y ∈ C + UP , the conditions
    (b) Ad(g −1 )ξ1 ∈ t + UP ,
    (c) Ad(g −1 )ξ1 ∈ P ,
are equivalent. Indeed, it is clear that if (b) holds then (c) holds. Conversely,
assume that (c) holds. Then Ad(g −1 )ξ1 = l mod UP where l ∈ L. By our
assumption we have Ad(g −1 )y = y0 mod UP where y ∈ C. Since [ξ1 , y] = 0,
we have [Ad(g −1 )x1 , Ad(g −1 )y] = 0 and taking images under P −     → L we deduce
[l, y0 ] = 0. Since y0 is distinguished in L, its centralizer in L is t. Thus, l ∈ t so
that (b) holds. We see that (a) can be rewritten as follows:

                 Yξ = {g ∈ G; Ad(g −1 )ξ1 ∈ P , Ad(g −1 )y ∈ C + UP }.

Let s ∈ Hom(C∗ , G) be such that the tangent map C −→ g of s carries 1 to h. We
define a C -action of Yξ by a : g 7→ s(a)g. This induces a C∗ -action on Yξ /P
          ∗

whose fixed point set is

       Y ′ = {g ∈ G; Ad(g −1 )ξ1 ∈ P , Ad(g −1 )y ∈ C + UP , Ad(g −1 )h ∈ P }/P.

Similarly, we define a C∗ -action on Xσ,y by a : g 7→ s(a)g. This induces a C∗ -
action on Xσ,y /P whose fixed point set is

       X′ = {g ∈ G; Ad(g −1 )y ∈ C + UP , Ad(g −1 )σ ∈ P , Ad(g −1 )h ∈ P }/P.
Classification of unipotent representations

In the presence of the condition Ad(g −1 )h ∈ P , the conditions Ad(g −1 )σ ∈ P and
Ad(g −1 )ξ1 ∈ P are equivalent (since ξ1 = σ − r0 h). It follows that Y ′ = X′ . Thus
the C∗ -actions on Yξ /P and on Xσ,y /P have the same fixed point set. They also
have the same action of Z ′ = Z ′′ .
   The restriction of the local system F̃ on Yξ /P (see 5.3) to this fixed point set is
the same as the restriction of the local system F̃ on Xσ,y /P (see 5.11) to this fixed
point set; the restriction is denoted again by F̃. By the principle of conservation
of Euler characteristics by passage to the fixed point set of a torus action, we have
                 X                             X
                     (−1)n Hcn (Xσ,y /P, F̃) =    (−1)n Hcn (X′ , F̃)
                     n                                           n
                         X                                   X
                    =        (−1)   n
                                        Hcn (Y ′ , F̃)   =       (−1)n Hcn (Yξ /P, F̃)
                         n                                   n


as virtual representations of Z̄G (σ, y) = Z̄G (ξ). Hence for an irreducible represen-
tation ρ of Z̄G (σ, y) = Z̄G (ξ), the conditions
   ρ appears in n (−1)n Hcn (Xσ,y /P, F̃),
                 P

   ρ appears in n (−1)n Hcn (Yξ /P, F̃)
                 P

are equivalent. For n odd we have Hcn (Xσ,y /P, F̃) = 0 and Hcn (Yξ /P, F̃) = 0.
(Indeed, both Xσ,y /P and Yξ /P can be regarded as fixed point sets of torus
actions on the variety denoted by Py in [L1], and it suffices to use the odd vanishing
theorem [L1, 8.6] for Py together with [L3, 4.4]). It follows that the conditions
   ρ appears in n Hcn (Xσ,y /P, F̃),
                 P

   ρ appears in n Hcn (Yξ /P, F̃)
                 P
are equivalent. The lemma is proved.
5.14. Let T(G, L, C, F ) be the set consisting of all pairs (ξ, ρ) (modulo the natural
action of G) where ξ ∈ g and ρ ∈ Irr0 Z̄G (ξ). By 5.12 and 5.13 we have a canonical
bijection

(a)                           S(G, L, C, F , r0) ↔ T(G, L, C, F ).

Composing this with the bijection 5.3(c) we obtain a bijection

(b)                          Irrr0 H̄(G, L, C, F ) ↔ T(G, L, C, F ).

In the setup of 2.1 and assuming that r0 ∈ ♠, let T♠ (G, L, C, F ) be the set of all
(ξ, ρ) in T(G, L, C, F ) such that ξ ∈ g♠ . Then (a) restricts to a bijection

(c)                          S♠ (G, L, C, F , r0) ↔ T♠ (G, L, C, F ).

Indeed, let ξ ∈ g and write ξ = ξ1 +y where ξ1 ∈ g is semisimple, y ∈ g is nilpotent
and [ξ1 , y] = 0. Let h, ỹ in g such that 5.12(b) holds and let σ = ξ1 +r0 h. We must
show that ξ ∈ g♠ if and only if σ ∈ g♠ . Clearly, ξ ∈ g♠ if and only if ξ1 ∈ g♠ . As
18                                    G. LUSZTIG

in 5.8, we have r0 h ∈ g♠ . (The eigenvalues of h in any V ∈ IG are integers.) As
in 5.8, if we have two elements of g♠ that commute then their sum is again in g♠ .
Applying this to the commuting elements ξ1 , r0 h0 and to the commuting elements
σ, −r0 h0 we deduce that σ ∈ g♠ if and only if ξ1 ∈ g♠ . This yields (c).
   Composing (c) with the bijection in 5.8 we obtain a bijection

(d)                     Irr♠                     ♠
                           r0 H̄(G, L, C, F ) ↔ T (G, L, C, F ).


(Notation of 5.8.) We can now reformulate Lemmas 5.9 and 5.10 as follows.
Lemma 5.15. Assume that τ : C −        → R is a group homomorphism such that
τ (r0 ) 6= 0. Let M̄ ∈ Irrr0 H̄(G, L, C, F ) and let (ξ, ρ) correspond to M̄ under
5.14(b). The following two conditions are equivalent:
    (i) M̄ is τ -tempered;
    (ii) ξ ∈ gKerτ .
   By 5.9, condition (i) is equivalent to the condition that the semisimple part ξ1
of ξ satisfies ξ1 ∈ gKerτ . But this is clearly equivalent to condition (ii).
Lemma 5.16. Assume that G is semisimple. Assume that τ : C −     → R is a group
homomorphism such that τ (r0 ) 6= 0. Let M̄ ∈ Irrr0 H̄(G, L, C, F ) and let (ξ, ρ)
correspond to M̄ under 5.14(b). The following two conditions are equivalent:
   (i) M̄ is τ -square integrable;
   (ii) ξ is a distinguished nilpotent element.
5.17. The local system on exp(C) (a unipotent class in L) that corresponds to F
under exp : L −
              → L is denoted again by F . For any f ∈ G, let

(a)                     Ẏf = {g ∈ G; g −1 f g ∈ exp(C)T UP }.

Consider the map Ẏf −   → exp(C) which takes g to the image of g −1 f g under
exp(C)T UP − → exp(C), abc 7→ a. The inverse image of F under this map is denoted
again by F . On Ẏf we have a free P -action by right translation and F is P -
equivariant hence it descends to a local system F̃ on Ẏf /P . The group ZG (f )
acts on Ẏf /P by left translation and F̃ is naturally a ZG (f )-equivariant local
system. Then Z̄G (f ) acts naturally on the cohomology

(b)                                ⊕n Hcn (Ẏf /P, F̃).

The set of irreducible representations (up to isomorphism) of Z̄G (f ) which appear
in the representation (b) is denoted by Irr0 Z̄G (f ).
   In the setup of 2.1, let Ṫ♠ (G, L, C, F ) be the set of all (f, ρ) (modulo the natural
action of G) where f ∈ G♠ and ρ ∈ Irr0 Z̄G (f ).
   If f ∈ G♠ corresponds to ξ ∈ g♠ under the bijection 5.1, we have ZG (f ) = ZG (ξ)
hence Z̄G (f ) = Z̄G (ξ); we also have Ẏf = Ẏξ . (We use that exp : P −   → P restricts
Classification of unipotent representations

                               ∼
to a bijection C +t♠ +UP −→ exp(C)T♠ UP .) It follows that Irr0 Z̄G (f ) = Irr0 Z̄G (ξ).
We see that (ξ, ρ) 7→ (exp(ξ), ρ) defines a bijection
                                              ∼
(c)                         T♠ (G, L, C, F ) −→ Ṫ♠ (G, L, C, F ).

Composing this with the bijection 5.14(d) we obtain a bijection

(d)                       Irr♠                      ♠
                             r0 H̄(G, L, C, F ) ↔ Ṫ (G, L, C, F ).

   We can now state the following variant of Lemma 5.15.
Lemma 5.18. Assume that ζ : C∗ −       → R is a group homomorphism such that
                                    → R. Let M̄ ∈ Irr♠
ζ(exp(r0 )) 6= 0. Let τ = ζ exp : C −                r0 H̄(G, L, C, F ) and let (f, ρ)
correspond to M̄ under 5.17(d). The following two conditions are equivalent.
   (i) M̄ is τ -tempered;
   (ii) f ∈ GKerζ .
   Using 5.15 we see that it is enough to verify the following statement: for ξ ∈ g,
we have ξ ∈ gKerτ if and only if exp(ξ) ∈ GKerζ . This is immediate. The lemma is
proved.

                                   6. The subgroups GJ
6.1. We fix an algebraic group Ĝ such that Ĝ0 is simply connected, almost simple.
We set G = Ĝ0 . We assume that we are given an element ϑ ∈ Ĝ of finite order d
such that G × Z/dZ −     → Ĝ, (g, j) 7→ gϑj is a bijection and such that the following
holds: there exists a set of Chevalley generators {ei′ , hi′ , fi′ ; i′ ∈ I ′ } for g = Ĝ = G
                                                       ∼
(with standard notation) and a bijection I ′ −→ I ′ , i′ 7→ ϑ i′ of order d, such that
   Ad(ϑ)(ei′ ) = eϑ i′ , Ad(ϑ)(hi′ ) = hϑ i′ , Ad(ϑ)(fi′ ) = fϑ i′
for all i′ ∈ I ′ . It follows that Ĝ/G is a cyclic group of order d generated by
the image of ϑ. Let G1 be the connected component of Ĝ that contains ϑ. The
subspace t′ of g spanned by {hi′ ; i′ ∈ I ′ } is T ′ for a maximal torus T ′ of G.
Let Y ′ = Hom(C∗ , T ′ ), X ′ = Hom(T ′ , C∗ ). We have canonically T ′ = Y ′ ⊗ C∗ ,
t′ = YC′
         , t′∗ = XC′
                     . Hence we may identify Y ′ with a subgroup of t′ and X ′ with a
subgroup of t′∗ . Let Ř′ ⊂ Y ′ ⊂ t′ (resp. R′ ⊂ X ′ ⊂ t′∗ ) be the set of coroots (resp.
roots) of G with respect to T ′ . For α ∈ R′ let hα be the corresponding coroot
and let gα be the corresponding root subpace of g. For i′ ∈ I ′ define αi′ ∈ R′ by
gαi′ = Cei′ . Then (R′ , Ř′ , X ′ , Y ′ ) is a root system with basis {αi′ ; i′ ∈ I ′ }. Now ϑ
                                                                                        j
normalizes T ′ . For any j ∈ [0, d − 1] we have a bijection R′ −      → R′ , α 7→ ϑ α given
     j
by ϑ α(ϑj tϑ−j ) = α(t) for t ∈ T, α ∈ R′ , that is, Ad(ϑj )gα = gϑj α for α ∈ R′ .
6.2. Let Gϑ = ZG (ϑ), T = ZT ′ (ϑ) = T ′ ∩ Gϑ , t = T = {x ∈ t′ ; Ad(ϑ)x = x}. It is
known that
   (a) Gϑ is connected and T is a maximal torus of Gϑ . Moreover, T ′ = ZG (T );
in particular, NG (T ) ⊂ NG (T ′ ).
20                                         G. LUSZTIG

                                                                                             ∼
    Let W ′ = NG (T ′ )/T ′ . Conjugation by ϑ induces an isomorphism W ′ −→ W ′
whose fixed point set is denoted by W ′ϑ . Let W = NGϑ (T )/T . It is known that
    (b) the obvious maps NG (T )/T ′ ←        −W −  → W ′ϑ are isomorphisms.
    Let ′ Y = Hom(C∗ , T ), ′ X = Hom(T, C∗ ). For β ∈ ′ X we set gβ = {x ∈
g; Ad(t)x = β(t)x ∀t ∈ T }. Then g = ⊕β∈′ X gβ and g0 = t′ . Let ′ R = {β ∈
′
  X − {0}; gβ 6= 0}. There is a unique subset ′ Ř of ′ Y − {0}, in bijection ′ hβ ↔ β
with ′ R, such that (′ R, ′ Ř, ′ X , ′ Y) is a (not necessarily reduced) root system whose
associated Weyl group is W . We have canonically T = ′ Y ⊗C∗ , t = ′ YC , t∗ = ′ XC .
Hence we may identify ′ Y with a subgroup of t and ′ X with a subgroup of t∗ and
we may regard ′ R ⊂ t∗ , ′ Ř ⊂ t.
                                                                            d−1
Lemma 6.3. Define ψ : R′ −    → t′∗ by α 7→ α + ϑ α + · · · + ϑ                   α. If α, α′ ∈ R′
                                 j
satisfy ψ(α) = ψ(α′ ) then α′ = ϑ α for some j ∈ [0, d − 1].
   Let R0′ be a set of representatives for the orbits of bijection R′ −
                                                                      → R′ , α 7→ ϑ α.
                                                               ′     ′∗
It is enough to show that α 7→ ψ(α) is an injective map R0 −     → t . This can be
easily checked in every case (we may assume that d ≥ 2).
6.4. If α ∈ R′ ⊂ t′∗ , then α|t ∈ ′ R. We thus obtain a map R′ −                     → ′ R, α 7→ α|t
which is constant on the orbits of α 7→ ϑ α. In fact, using 6.3, we see that this map
induces a bijection from the set of orbits of α 7→ ϑ α on R′ onto ′ R.
    For β ∈ ′ R let d′β be the cardinal of the corresponding orbit in R′ ; thus d′β =
dim gβ . For β ∈ ′ R we set d′′β = 2 if either 2β ∈ ′ R or 21 β ∈ ′ R and we set d′′β = 1
if 2β ∈ / ′ R, 12 β ∈
                    / ′ R. We also set dβ = d′β d′′β .
    If α ∈ R′ and β = α|t , we have
    ′
      hβ = hα if β ∈ ′ R − ′ R∗ or if d′β = 1,
    ′
      hβ = hα + hϑ α if d′β = 2, d′′β = 1,
    ′
      hβ = 2hα + 2hϑ α if dβ = 4,
    ′
      hβ = hα + hϑ α + hϑ2 α if dβ = 3.
    Let I¯′ be the set of orbits of the bijection I ′ −          → I ′ , i′ 7→ ϑ i′ . For i ∈ I¯′ let
βi = αi′ |t where i′ is any element of the orbit i. Then {βi ; i ∈ I¯′ } is a basis of the
root system (′ R, ′ Ř, ′ X , ′ Y).
    Let R be the subset of t∗ consisting of the vectors dβ β for various β ∈ ′ R.
For γ ∈ R we set hγ = d1β ′ hβ where γ = dβ β, β ∈ ′ R. Let Ř be the subset of t
consisting of the vectors hγ for various γ ∈ R.
    For i ∈ I¯′ let d′i = d′βi , d′′i = d′′βi , di = d′i d′′i = dβi and let γi = di βi . Let Y be
the subgroup of t generated by {hgi ; i ∈ I¯′ }. Let X be the set of all ξ ∈ t∗ that
take integer values on Y. Then R ⊂ X , Ř ⊂ Y and (R, Ř, X , Y) is a (reduced)
root system with Weyl group W and with basis {γi ; i ∈ I¯′ }. It is also irreducible.
(If d = 1 we have R′ = ′ R = R. If d = 2 and R′ is of type A2n−1 , then ′ R, R are
of type Cn , Bn . If d = 2 and R′ is of type A2n , then ′ R, R are of type BCn , Cn .
If d = 2 and R′ is of type Dn , then ′ R, R are of type Bn−1 , Cn−1 . If d = 2 and R′
is of type E6 , then ′ R, R are of type F4 , F4 . If d = 3 and R′ is of type D4 , then
′
  R, R are of type G2 , G2 .)
Classification of unipotent representations

   Let γ0 ∈ R be the negative of the highest root of R relative to {γi ; i ∈ I¯′ }. Then
γ0 = d0 β0 for a unique β0 ∈ ′ R such that 2β0 ∈
                                               / ′ R. Here d0 = dβ0 = d. Setting
   I = I¯ ⊔ {0},
         ′

there are unique integers ni ∈ Z>0 (i ∈ I) with n0 = 1, such that
                                           X
                                                 ni γ i = 0
                                           i∈I
     P
and i∈I ni is maximum possible (the Coxeter number of W ).
   For i ∈ I, we set hi = hγi .
   Let V be a C-vector space with basis {bi ; i ∈ I}. Let V ′ be the dual vector
space with dual basis {b′i ; i ∈ I}. The canonical pairing     V ×V′ −
                                                                     → C is denoted
         ′       ′                            ′                   ′
                                                       P
by x, x 7→ x(x ). We imbedd P t into V byPy 7→ i∈I γi (y)bi; we identify t with
its image, the subspace { i ci b′i ; ci ∈ C, i ni ci = 0} of V ′ . In particular, we
may regard hi as a vector in V ′ with bi (hi ) = 2. We have bi (x′ ) = γi (x′ ) for any
x′ ∈ t, i ∈ I. Let              X                   X
                        t1 = {     ci b′i ; ci ∈ C,   ni ci = 1}.
                                    i                     i

For i ∈ I define si : V −  → V by si (x) = x − x(hi )bi and its contragredient
      ′
si : V −→ V by si (x ) = x′ − bi (x′ )hi . Let W a be the subgroup of GL(V ) or
             ′          ′
      ′
GL(V ) generated by {si ; i ∈ I} (an affine Weyl group). Note that t, t1 are W a -
stable subsets of V ′ . We obtain a homomorphism W a −    → GL(t) whose image
coincides with W .
6.5. For any S ⊂ I, S 6= ∅ let
                                        X
              CS = {x′ ∈ t1 ; x′ =            ci b′i with ci ∈ C, ci > 0 ∀i ∈ S}.
                                        i∈S

The sets CS are disjoint. Let

                                        C ′ = ∪S⊂I;S6=∅ CS .

For J ⊂ I, J 6= I, let WJ be the subgroup of W a generated by {si ; i ∈ J} (a finite
Coxeter group). For S as above and x′ ∈ CS , we have
  (a) {w ∈ W a ; w(x′ ) = x′ } = WI−S .
Lemma 6.6. Let x′ ∈ t1 . The W a -orbit W a x′ meets C ′ in exactly one point.
    Let VR′ = i∈I Rb′i , tR = t ∩ VR′ , t1R = t1 ∩ VR′ .
               P
    The following R-analogue of the lemma is well known.
    (a) Let x′1 ∈ t1R . The W a√-orbit W a x′1 meets C ′ ∩ t1R in exactly one point.
    We can write x′ = x′1 + −1x′2 where x′1 ∈ t1R√      , x′2 ∈ tR . Using (a) we can find
        a                                     ′    ′
w ∈ W and S ⊂ I, S 6= ∅ such that w(x ) = x3 + −1x′4 where x′3 ∈ CS ∩t1R , x′4 ∈
tR . By a well known property of Weyl chambers applied to WI−S , we can find
22                                     G. LUSZTIG

w′ ∈ WI−S such that w′ (x4 )(bi ) ∈ R≥0 for all   √ i ∈ I − S. By 6.5(a)√we have
  ′ ′        ′          ′      ′
w (x3 ) = x3 . Thus, w (w(x ))(bi ) is in R>0 + −1R if i ∈ S and is in −1R≥0
if i ∈ I − S. Hence w′ (w(x′ )) ∈ CS ′ for some S ′ , S ⊂ S ′ ⊂ I. We see that
W a x′ ∩ C ′ 6= ∅.
                 ′                   ′              ′
   Now let√z, z be two    points
                              √ of C′ that w(z) =′ z for some w ∈ W a . We can write
                    ′      ′                           ′
z = z1 + −1z2 , z = z1 + −1z2 where z1 , z1 ∈ C ∩ t1R , z2 , z2′ ∈ tR . Since z1 , z1′
are in the same W a -orbit, we see using (a) that z1 = z1′ . We can find S ⊂ I, S 6= ∅
such that z1 = z1′ ∈ CS ∩ t1R . Since z, z ′ ∈ CS , we have z2 (bi ) ≥ 0, z2′ (bi ) ≥ 0 for
all i ∈ I − S. Moreover, we have w(z1 ) = z1′ = z1 (hence w ∈ WI−S , see 6.5(a))
and w(z2 ) = z2′ . Using a well known property of Weyl chambers applied to WI−S ,
we deduce that z2 = z2′ . Thus, z = z ′ . The lemma is proved.
6.7. Let N = {g ∈ G; gT ϑg −1 = T ϑ}, N ′ = N ∩ T ′ . Clearly, NGϑ (T ) ∩ N ′ = T .
Lemma 6.8. N = NGϑ (T )N ′ = N ′ NGϑ (T ).
   If g ∈ N then g normalizes the subgroup generated by T ϑ hence it also nor-
malizes the identity component T of that subgroup. Since T ′ = ZG (T ), it follows
that g normalizes T ′ . Thus, N ⊂ NG (T ′ ). It also follows that N ′ is normal in N
hence NGϑ (T )N ′ = N ′ NGϑ (T ).
   Let g ∈ N . We set a = g −1 ϑgϑ−1 , a′ = ϑ2 g −1 ϑ−1 gϑ−1 . For t ∈ T we have
ϑgtϑg −1 = gtϑg −1 ϑ hence ata′ = t. Taking t = 1, we get aa′ = 1. Hence ata−1 = t
for all t ∈ T . Thus, a ∈ ZG (T ) = T ′ . Thus,
   (a) ϑgϑ−1 = ga for some a ∈ T ′ .
Let ḡ be the image of g in W ′ = NG (T ′ )/T ′ . Then ḡ ∈ W ′ϑ (see (a) and 6.2).
           ∼
Since W −→ W ′ϑ (see 6.2(b)), there exists g ′ ∈ NGϑ (T ), t′ ∈ T ′ such that g = g ′ t′ .
We have t′ ∈ T ′ ∩ N hence t′ ∈ N ′ . Thus, N = NGϑ (T )N ′ . The lemma is proved.
Lemma 6.9. We have ′ Y ⊂ Y and Y/′ Y may be identified with N ′ /T .
                                                                  ¯′
   Let F = i∈I¯′ Z/d′i Z. Let F ′ be the subgroup of (C∗ )I consisting of all (ai )
            Q
           d′                                  ∼
such that ai i = 1 for all i ∈ I¯′ . Define F −→ F ′ by (li ) 7→ (exp(κli /d′i )).
   From the definitions we see that ′ Y has a Z-basis { 1′′ ′ hβ ; i ∈ I¯′ } and Y has a
                                                            di    i

Z-basis {hi ; i ∈ I¯′ }. Recall that hi = d1i hβi . It follows that ′ Y ⊂ Y and we have
        ∼
   F −→ Y/′ Y, (li) 7→ ′ Y-coset of
                                       P
                                         i∈I¯′ li hi .
                    ′             ′   −1 −1
By definition, N = {t ∈ T ; tϑt ϑ               ∈ T }. The homomorphism χ : N ′ −     →
           −1 −1                                                    ′    ∼
T, t 7→ tϑt ϑ with kernel T induces an isomorphism N /T −→ Im(χ). Define
      ¯′ ∼
(C∗ )I −→ T by (ai ) 7→ i∈I¯′ ′ hβi (ai ). Via this isomorphism, Im(χ) corresponds
                            Q
to F ′ . Combining the isomorphisms above yields the lemma.
6.10. Let p be the composition t1 −
                                  →t−  → T ϑ where the first map is x 7→ x − b′0
and the second map is x 7→ expT (κx)ϑ.
Lemma 6.11. The map x′ 7→ p(x′ ) defines a bijection between C ′ and a set of
representatives for the orbits of the N -action on T ϑ (by conjugation).
Classification of unipotent representations

                                              ∼
   Now x 7→ expT (κx)ϑ induces t/′ Y −→ T ϑ. Using 6.8, 6.9, we see that via
this isomorphism the action of N on T ϑ corresponds to the action of the obvious
semidirect product of W and Y/′ Y on t/′ Y (with Y/′ Y normal) where the action
of W is the obvious one and the action of Y/′ Y is by translation. It follows that
we have an induced bijection
   (a) {W − orbits on t/Y} ↔ {N − orbits on T ϑ}.
It is well known that one may regard Y as a normal subgroup of W a in such a
way that an element y ∈ Y acts on t1 (as part of the W a -action) in the same way
as y acts on t1 by x′ 7→ x′ + y. Hence we have an obvious bijection
   (b) {W a − orbits on t1 } ↔ {W a /Y − orbits on t1 /Y}.
Now Y also acts on t by translation and x′ 7→ x′ −b′0 induces a bijection t1 /Y ↔ t/Y
which is compatible with the action of W a /Y on t1 /Y, t/Y. (This is because for
w ∈ W a we have w(b′0 ) − b′0 ∈ Y.) Thus we have an obvious bijection
   (c) {W a /Y − orbits on t1 /Y} ↔ {W a /Y − orbits on t/Y}.
By the last sentence in 6.4 we have
   (d) {W a /Y − orbits on t/Y} = {W − orbits on t/Y}.
Combining (a)-(d), we obtain a bijection
   {W a − orbits on t1 } ↔ {N − orbits on T ϑ}.
This is induced by x′ 7→ p(x′ ). We now use 6.6. The lemma follows.
Lemma 6.12. Let Z be a semisimple G-conjugacy class in G1 . Then Z ∩ (T ϑ)
is exactly one N -orbit in T ϑ.
   This is classical when d = 1. This is also known when d > 1. It can be deduced
for example from [S] (this reference deals with compact groups but our case can
be treated in a similar way).
   Combining 6.11, 6.12, we have the following result.
Proposition 6.13. The map x′ 7→ p(x′ ) defines a bijection between C ′ and a set
of representatives for the G-conjugacy classes of semisimple elements in G1 .
Lemma 6.14. Let γ ∈ R and n ∈ Z. Let H = {y ′ ∈ t1 ; γ(y ′ − b′0 ) = n}. Let
S ⊂ I, S 6= ∅ and let x′ ∈ CS . If x′ ∈ H then n1k b′k ∈ H for any k ∈ S.
   Let P
   VR′ = i∈I Rb′i , tR = t ∩ VR′ , t1R = t1 ∩ VR′ ,
   HR = H ∩ t1R , H ′ = {y ′ ∈ tR ; γ(y ′ ) = 0}.
The following R-analogue of the lemma is well known.
   (a) Let x′1 ∈ CS ∩ t1R . If x′1 ∈ HR then n1k b′k ∈ HR for any k ∈ S.
(This follows from the fact that CS ∩ t1R is a facet of a configuration of reflection
hyperplanes in t1R (one of which is HR ) and that n1k b′k (k ∈ S) are the vertices of
that facet.)                    √
   We now write x′ = x′1 + −1x′2 where x′1 ∈ HR , x′2 ∈ H ′ . We can find S ′ ⊂ S
such that
   x′1 = i∈S ′ c1,i b′i , x′2 = i∈S c2,i b′i ,
        P                      P
where
24                                             G. LUSZTIG

   (b) c1,i ∈ R>0 for i ∈ S ′ , c2,i ∈ R for i ∈ S, c2,i ∈ R>0 for i ∈ S − S ′ .
Using (a) for x′1 we see that
   (c) n1k b′k ∈ HR for any k ∈ S ′ .
If S ′ = S, we are done. Assume now that S − S ′ 6= ∅. From (c) we see that, for
       ′              ′         ′
k ∈ SP                k − nk b0 ) = nnk . P
         , we have γ(bP                        Hence
                   ′                    ′
   γ( i∈S ′ c2,i bi − i∈S ′ cP     n  b
                                2,i i 0   ) =      i∈S ′ c2,i nnP
                                                                i.
   Since x2 ∈ H , we have i∈S c2,i ni = 0 and γ( i∈S c2,i b′i ) = 0. It follows that
             ′     ′

                   X            X
                γ(   c2,i b′i −      c2,i ni b′0 )
                i∈S ′             i∈S ′
                         X                      X                             X
(d)            = γ(−              c2,i b′i +             c2,i ni b′0 ) = −             c2,i nni .
                        i∈S−S ′                i∈S−S ′                       i∈S−S ′

Set c = i∈S−S ′ c2,i ni . Since S − S ′ 6= ∅ we see using (b) that c ∈ R>0 . From
        P
(d) we
     Pdeduce
   γ( i∈S−S ′ c2,i c−1 b′i − b′0 ) = n
so that i∈S−S ′ c2,i c−1 b′i ∈ HR ∩ CS−S ′ . Using again (a) we deduce that n1k b′k ∈
       P

HR for any k ∈ S − S ′ . Combining this and (c) we see that the lemma is proved.
6.15. Let N be the set of all pairs (β, j) where β ∈ ′ R, j ∈ [0, d − 1] and
   j = 0 if d′β = 1, d′′β = 1,
   j = 1 if d′β = 1, d′′β = 2.
We regard N as a subset of the group t∗ × Z/dZ by identifying [0, d − 1] and Z/dZ
in the obvious way.
   For i ∈ I define pi by pi = 0 for i ∈ I − {0}, p0 = 1.
Lemma 6.16. Let S ⊂ I, S 6= ∅ and let x′ ∈ CS . The following two conditions
for (β, j) ∈ N are equivalent:
                  ) + dj ∈ Z;
   (i) β(x′ − b′0 P
   (ii) (β, j) = i∈I−S ci (βi , pi ) with ci ∈ Z.
    Assume that (β, j) satisfies (ii). To show that it satisfies (i), we may assume
that (β, j) = (βi , pi ) for some i ∈ I − S. Then we have βi (x′ − b′0 ) = d−1         ′   ′
                                                                               i bi (x − b0 )
                                     −1      −1
and this is 0 if i 6= 0 and is −d0 = −d if i = 0. If i 6= 0 we have pi = 0 hence
βi (x′ − b′0 ) + pdi = 0. If i = 0 we have pi = 1 hence βi (x′ − b′0 ) + pdi = − d1 + 1d = 0,
so that (i) holds.
                                                                            ′   ′      j
    Conversely, assume that (β, j) satisfies (i). PThus, we have β(x − b0 ) + d = n
for some n ∈ Z. We can write uniquely β = k∈I−0 fk βk where fk ∈ Z.
    Let H be the affine hyperplane {y ′ ∈ t1 ; β(y ′ − b′0 ) + dj = n} in t1 . Note that
H is of the form {y ′ ∈ t1 ; γ(y ′ − b′0 ) = n′ } for some γ ∈ R and n′ ∈ Z. Indeed,
if β ∈ ′ R, d′′β = 1, we can take γ = dβ β,n′ = dβ n − j; if β ∈ ′ R, 2β ∈ ′ R, we can
take γ = 4β, n′ = 4n − 2j; if β ∈ ′ R, 12 β ∈ ′ R, we can take γ = 2β, n′ = 2n − j.
Since x′ ∈ H and x′ ∈ CS we have n1k b′k ∈ H for any k ∈ S. (See 6.14.) Thus,
β( n1k b′k − b′0 ) + dj = n for any k ∈ S.
Classification of unipotent representations

   If k ∈ S, k 6= 0, we have β( n1k b′k − b′0 ) = dkfnk k . Thus, dkfnk k + dj = n. Since
jdk                                                          jdk
 d ∈ Z, it follows that fk = nk gk where gk ∈ Z, gk + d = dk n.
   If 0 ∈ S, we have dj = β(0) + dj = n so that j = 0 and n = 0. In this
case Pwe deduce that for k ∈ S, k 6= P   0 we have gk = 0 hence fk = 0 so that
β = k∈I−S fk βk . Moreover, (β, j) = k∈I−S fk (βk , pk ) since j = 0.
   Assume now that 0 ∈ I − S. Then
           X               X               jdk
    β=             fk βk +   nk (dk n −         )βk
                                             d
          k∈I−S−{0}             k∈S
            X                  X                    jdk            X                     jdk
     =               fk βk +           nk (dk n −       )βk −               nk (dk n −       )βk
                                                     d                                    d
         k∈I−S−{0}             j∈I−0                            k∈I−S−{0}
            X                            jdk
     =               (fk − nk (dk n −        ))βk − (nd − j)β0 ,
                                          d
         k∈I−S−{0}
                        X                            jdk
          (β, j) =               (fk − nk (dk n −        ))(βk , pk ) − (nd − j)(β0 , p0 )
                                                      d
                     k∈I−S−{0}

since j = −(nd − j) mod dZ. The lemma is proved.
6.17. Let β ∈ ′ R ∪ {0}. Then gβ is stable under Ad(ϑ) : g −→ g. For any
j ∈ [0, d − 1] we set gβ,j = {x ∈ gβ ; Ad(ϑ)x = exp(κj/d)x}. Clearly, gβ =
⊕j∈[0,d−1] gβ,j .
Lemma 6.18. Let β ∈ ′ R and let j ∈ [0, d−1]. We have dim gβ,j = 1 if (β, j) ∈ N
and gβ,j = 0 if (β, j) ∈
                       / N.
    We can assume that d > 1. Assume first that dim gβ = d. Since gβ is the
direct sum of d (one dimensional) root spaces of g with respect to T ′ which are
cyclically permuted by Ad(ϑ), it follows that Ad(ϑ) : gβ −            → gβ has order d and its
n-th power has trace 0 for 1 ≤ n < d. It follows that its exp(κj/d)-eigenspace is
one dimensional for 0 ≤ j < d. Thus the lemma is proved in this case.
                                                                                   ′
    Next assume that   P dim gβ = 1. Then β = α|t for a unique α ′ ∈ R ′. We′ may
assume that α ∈ i′ ∈I ′ Nαi′ . We can find a unique partition I = I1 ⊔ I2 such
that whenever i′1 ∈ I1′ , i′2 ∈ I2′ , the vertices i′1 , i′2 of the Coxeter graph of G are not
joined. Let x0 ∈ gγ0 − {0}. Let B be the canonical basis of g (as a left g-module)
such that x0 ∈ B. Then ci′ ei′ ∈ B for well defined ci′ ∈ C∗ . Moreover, it is not
difficult to check that there exist a1 , a2 ∈ C∗ such that ci′ = a1 for all i′ ∈ I1′ ,
ci′ = a2 for all i′ ∈ I2′ and a1 + a2 = 0. Now Ad(ϑ)(B) = uB for some u ∈ C∗ .
Hence ci′ eϑ i′ = ucϑ i′ eϑ i′ for all i′ . We see that ci′ = ucϑ i′ . We consider two cases.
    Case 1. Both I1′ , I2′ are stable under i′ 7→ ϑ i′ . Then a1 = ua1 and u = 1. It
follows that, if x ∈ B ∩ gβ , then Ad(ϑ)x = ux = x. Thus, if gβ,j 6= 0 then j = 0.
    Case 2. I1′ , I2′ are interchanged by i′ 7→ ϑ i′ (hence d = 2). Then ua1 = a2 = −a1
and u = −1. It follows that, if x ∈ B ∩ gβ , then Ad(ϑ)x = ux = −x. Thus, if
gβ,j 6= 0 then j = 1.
    The lemma follows.
26                                     G. LUSZTIG

6.19. Let J ⊂ I, J 6= I. Let

                                   gJ = t ⊕ ⊕β,j gβ,j
                                                          P
where (β, j) ∈ N is subject to the condition (β, j) ∈        i∈J   Z(βi , pi ).

Lemma 6.20. There is a unique closed connected reductive subgroup GJ of G
with Lie algebra gJ . If x′ ∈ CI−J , then GJ = ZG (p(x′ )).

   Recall that p(x′ ) = expT (κ(x′ − b′0 ))ϑ ∈ T ϑ. Now ZG (p(x′ )) is a closed con-
nected reductive subgroup of G whose Lie algebra is h = {x ∈ g; Ad(p(x′ ))x = x}.
Clearly, h is stable under the Ad action of T and that of ϑ on g. Hence h is the
sum of its intersections with the various gβ,j where β ∈ ′ R ∪ {0}. Clearly, h ∩ g0,j
is 0 if j 6= 0 and is t if j = 0. Using 6.18 we deduce that
   h = t ⊕ ⊕β,j gβ,j
where (β, j) ∈ N is subject to β(expT (κ(x′ − b′0 ))) exp(κj/d) = 1 (with β regarded
as a character T −  → C∗ ) or equivalently, to β(x′ − b′0 ) + dj ∈ Z (with β regarded
as a form t − → C). Using now 6.16 we see that h = gJ . The lemma is proved.

6.21. For i1 , i2 ∈ I let
                                                      d
    ai1 ,i2 = γi2 (hi1 ), ′ ai1 ,i2 = βi2 (′ hβi1 ) = dii1 ai1 ,i2 .
                                                         2
Then (ai1 ,i2 ) is an untwisted affine Cartan matrix and (′ ai1 ,i2 ) is a possibly twisted
affine Cartan matrix.
    Let J ⊂ I, J 6= I. Let ′ RJ the set of all β ∈ ′ R such that β = wβi for some
i ∈ J and some w ∈ WJ . Let ′ ŘJ be the set of all ′ hβ where β ∈ ′ RJ .

Lemma 6.22. ′ RJ (resp. ′ ŘJ ) is exactly the set of roots (resp. coroots) of GJ
with respect to T .

   For i ∈ J we have (βi , pi ) ∈ N hence by 6.18, 6.19, βi is a root of GJ . For i ∈ J
there exists g ∈ NGJ (T ) such that Ad(g) : t −   → t is a reflection that takes βi to
−βi . By 6.2(b), there exists g ∈ NGϑ (T ) and t′ ∈ T ′ such that g = g ′ t′ . Hence
                                  ′

Ad(g) : T − → T coincides with Ad(g ′ ) : T −   → T . Now there is a unique element
in W that acts on T as a reflection taking βi to −βi , namely si . It follows that
Ad(g) = si : t − → t. Hence if Hi ∈ t is the coroot of GJ corresponding to βi , we
have x − βi (x)Hi = x − βi (x)′ hβi for all x ∈ t, hence
   (a) Hi = ′ hβi .
By 6.19, any root of GJ is of the form β where β ∈ ′ R satisfies β ∈ i∈J Zβi .
                                                                              P
Thus, (βi )i∈J is a set of simple roots for GJ . By the first part of the argument, WJ
coincides with the Weyl group of GJ (both are subgroups of Aut(T )); it follows
that RJ is exactly the set of roots of GJ . The claim that ′ ŘJ is exactly the set of
coroots of GJ follows from (a). The lemma is proved.

6.23. From 6.22 we see that the Cartan matrix of GJ is (′ ai1 ,i2 )i1 ,i2 ∈J .
Classification of unipotent representations

6.24. Let ĜJ = ∪j∈[0,d−1] GJ ϑj . Since ϑ normalizes GJ , ĜJ is a (closed) subgroup
of Ĝ, with identity component GJ . Let ZJ (resp. ẐJ ) be the centre of GJ (resp.
of ĜJ ). Let zJ = ZJ (a subspace of t hence a subspace of V ′ ).
   Let VJ be the subspace of V spanned by {bi ; i ∈ J}. Let K = I − J. Let VK′
be the subspace of V ′ spanned by {b′i ; i ∈ K}, that is, the annihilator of VJ in V ′ .
We have zJ = t ∩ VK′ (a hyperplane in t). Let z1J = t1 ∩ VK′ (an affine hyperplane
in VK′ ).
   Let XJ = p(z1J ). Note that CK ⊂ z1J hence p(CK ) ⊂ XJ .
Lemma 6.25. (a) We have ZJ ⊂ ẐJ and ZJ0 = ẐJ0 .
  (b) XJ is a connected component of ẐJ .
    We prove (a). If g ∈ ZJ then g ∈ T hence ϑg = gϑ hence g ∈ ẐJ . Thus,
ZJ ⊂ ẐJ . It follows that ZJ0 ⊂ ẐJ0 . Now ẐJ0 ⊂ GJ hence ẐJ0 ⊂ ZJ . Thus,
ẐJ0 = GJ .
    We prove (b). Let x′ ∈ z1J . We set x0 = x′ − b′0 ∈ zJ . Let i ∈ J. Since x0 ∈ VK′ ,
we have bi (x0 ) = 0. Now p(x′ ) acts on gβi ,pi by the scalar

    βi (expT (κx0 )) exp(κd−1 pi ) = exp(κβi (x0 )) exp(κd−1 pi )
     = exp(κd−1     0
             i γi (x ) + κd
                            −1
                               pi ) = exp(κd−1     0
                                            i bi (x ) + κd
                                                           −1
                                                              pi )
     = exp(−κd−1     ′
              i bi (b0 ) + κd
                              −1
                                 pi ) = exp(−κd−1
                                               i δ0,i + κd
                                                           −1
                                                              pi )) = exp(0) = 1.

It follows that p(x′ ) centralizes GJ . Since p(x′ ) ∈ T ϑ, it centralizes ϑ hence also
ĜJ . Thus, XJ ⊂ ẐJ . Clearly, XJ is connected. If z ∈ ZJ0 we have z = expT (κ(x′0 ))
for some x′0 ∈ zJ hence for x′ as above, p(x′ + x′0 ) = p(x′ )z. Thus, XJ is stable by
multiplication by ZJ0 . The lemma is proved.
6.26. Let G1 be the simply connected almost simple algebraic group correspond-
ing to the root system (R, Ř, X , cy) (see 6.4). By 6.13 we have a natural bijection
between the set of G1 -conjugacy classes of semisimple elements in G1 and the set
of G-conjugacy classes of semisimple elements in Gϑ.
   Our discussion of semisimple G-conjugacy classes in Gϑ has been influenced by
[K] where a connection between the elements of finite order in Gϑ and (possibly
twisted) affine Lie algebras is given.

                               7. The set R(Gϑ, GJ , C, F )
7.1. We preserve the setup of §6. Let J ⊂ I, J 6= I and let K = I − J. Let
G(J) be the centralizer of ZJ0 in G. Now G(J) is the subgroup of G generated by
T ′ and
      Pby the root subgroups       of G corresponding to various α ∈ R′ such that
                             0
α|t ∈ i∈J Qβi . We have ZG     (J )
                                    ∩ Gϑ = ZJ0 .

Lemma 7.2. Let g ∈ ZJ . Then we have g = g1 g2 ϑ−n (in Ĝ) where g2 ∈ ZG ∩Gϑ ,
n is an integer and g1 is either the n-th power of an element in XJ (if n 6= 0) or
is an element of ZJ0 (if n = 0).
28                                        G. LUSZTIG

   We have g ∈ T and βi (g) = 1 for all i ∈ J. Hence                    g = expT (κx) where
                                                             ′             ′
                                                                P
x ∈ t satisfies βi (x) ∈ Z for all i ∈ J hence P           x =     i∈I ci bi with ci ∈ di Z for
all i ∈PJ, ci ∈ C for all i ∈ K. We set n = k∈K nk ck . We have n ∈ Z since
n=− P     i∈J ni ci . Let
   x = k∈K ck b′k − nb′0 ∈ t, x′′ = i∈J ci b′i + nb′0 ∈ t.
     ′
                                                P

Then x = x′ + x′′ . For any i ∈ I − {0} we have βi (x′′ ) = d−1                          ′      ′
                                                                             P
                                                                      i bi (  i1 ∈J ci1 bi1 + nb0 ).
   If 0 ∈ J then βi (x′′ ) equals d−1       i ci if i ∈ J − {0} and equals 0 if i ∈ K. If
0 ∈ K then βi (x′′ ) equals d−1    i  c i if i ∈ J and equals 0 if i ∈ K − {0}. In any case
case, βi (x ) ∈ Z for i ∈ I − {0}. It follows that expT (κx′′ ) is in the kernel of
           ′′

       → C∗ for any i ∈ I − {0}. Hence g ′′ = expT (κx′′ ) ∈ ZG ∩ Gϑ .
βi : T −
   Assume first that 0 ∈ J. If n = 0 we have x′ ∈ zJ hence g ′ = expT (κx′ ) ∈ ZJ0
and g = g ′ g ′′ . If n 6= 0, we set g ′ = expT (κ n1 x′ )ϑ. Then g ′ ∈ XJ and g = g ′n g ′′ ϑ−n .
   Assume next that 0 ∈ K. In this case we have x′ ∈ zJ hence g ′ = expT (κx′ ) ∈
ZJ0 and g = g ′ g ′′ . The lemma is proved.
Lemma 7.3. If g ∈ XJ then ZG(J ) (g) = ZJ .
                                                  ′     −1          ′         ′    1
            P                                              P
  Let n =      k∈K nk . We have n ∈ Z>0 . If x = n          k∈K bk , then x ∈ t
and z = p(x′ ) ∈ XJ . Since x′ ∈ CI−J , we have ZG (z) = GJ (see 6.20). Let
g ∈ XJ . We have g = zt where t ∈ ZJ0 = ZG  0
                                              (J )
                                                   . Hence ZG(J ) (g) = ZG(J ) (z) =
ZG (z) ∩ G(J) = GJ ∩ G(J) = GJ . The lemma is proved.
7.4. We fix J, K as above, a nilpotent GJ -orbit C in gJ and an irreducible GJ -
equivariant cuspidal local system F (over C) on C. The local system on C˙ = exp(C)
(a unipotent class in GJ ) that corresponds to F under exp : gJ −→ GJ is denoted
again by F . Let
                                                      ˙ −1 ,
                             X(J) = ∪g1 ∈G(J ) g1 XJ Cg 1

(a locally closed subset of Gϑ, stable under conjugacy by G(J) ).
    (a) Let C be an Ad(G(J) )-orbit in Gϑ that is contained in X(J) . There exists
an irreducible G(J) -equivariant local system F ′ on C (unique up to isomorphism)
such that the following holds: for any x ∈ XJ such that xC˙ ⊂ C, the restriction
                                                      ∼
F ′ |xĊ is the local system obtained from F via C˙ −→ xC˙ (multiplication by x).
    This is shown as follows. Let x ∈ XJ be such that xC˙ ⊂ C. There exists an
irreducible G(J) -equivariant local system F (x) on C (unique up to isomorphism)
                                                                ∼
such that F (x)|xĊ is the local system obtained from F via C˙ −→ xC˙ (multiplication
by x). (We use the fact that, if u ∈ C, ˙ then ZG (xu) = ZG (u), see 7.3). We must
                                                 (J )        J

only show that the isomorphism class of F (x) is independent of x. If cardK = 1
then XJ is a point and there is nothing to prove. Thus we may assume that
cardK ≥ 2.
    Let x′ ∈ XJ be a second element such that x′ C˙ ⊂ C. We must show that
F (x), F (x′) are isomorphic. It is enough to show that, if f ∈ G(J) is such that
f xf −1 = x′ (so that Ad(f )ZJ = ZJ , as we see from 7.3), then Ad(f ) carries (C,˙ F)
      ˙                       ˙
to (C, F ). If d ≥ 2, then (C, F ) is uniquely determined by GJ for cardK ≥ 2 (see
Classification of unipotent representations

the tables in §11) and we are done. Assume now that d = 1. Now ZJ acts on F
through a character χ : ZJ −     → C∗ . Since there is at most one pair consisting of
a unipotent class of GJ and an irreducible GJ -equivariant cuspidal local system
on it with prescribed action of ZJ , it is enough to show that χ(z) = χ(f zf −1 )
for any z ∈ ZJ . Since χ is trivial on ZJ0 it is enough to show that f zf −1 = z
mod ZJ0 for any z ∈ ZJ . Using 7.2, we can write z in the form z = z0 z1n z2 where
z0 ∈ ZJ0 , z1 ∈ XJ , z2 ∈ ZG , n ∈ Z. (In this case the power of ϑ in 7.2 is 1.)
It suffices to show that f z0 z1n z2 f −1 = z0 z1n z2 mod ZJ0 or that f z0 z1n f −1 = z0 z1n
mod ZJ0 , or that f z1n f −1 = z1n mod ZJ0 . (We use that f z0 = z0 f .) We have
z1 = xa where a ∈ ZJ0 hence
   f z1n f −1 = f xn an f −1 = f xn f −1 f an f −1 = x′n an = z1n (x−1 x′ )n = z1n mod ZJ0
since x−1 x′ ∈ ZJ0 . Thus, (a) is established.
7.5. We can find a parabolic subgroup P of G which has G(J) as a Levi subgroup
and satisfies ϑP ϑ−1 = P . (We can choose a general enough y ∈ Hom(C∗ , ZJ0 )
such that, setting g(n) = {x ∈ g; Ad(y(a))x = an x ∀a ∈ C∗ } for n ∈ Z, we
have g(0) = G(J) . Then ⊕n∈N g(n) = P for a well defined P which satisfies our
requirements.) For any f ∈ Gϑ we set
                             Uf = {g ∈ G; g −1 f g ∈ X(J) UP }.
We have an obvious map π : Uf −     → X(J) which takes g to the image of g −1 f g
under X(J) UP − → X(J) , ab 7→ a.
   The image of π is a disjoint union of finitely many Ad(G(J) -orbits in X(J) (since
the semisimple part of a point in this image is contained in a fixed Ad(G)-orbit,
namely that of the semisimple part of f ). This image carries a G(J) -equivariant
local system (on each connected component we take the local system in 7.4(a)).
Taking inverse image under Uf −    → π(Uf ) of this local system we obtain a local
system on Uf which is P -equivariant for the free P -action on Uf given by right
translation, hence it descends to a local system on Uf /P denoted by F̃ . Now
ZG (f ) acts on Uf /P by left translation and F̃ is naturally a ZG (f )-equivariant
local system. Then Z̄G (f ) acts naturally on the cohomology
(a)                                   ⊕n Hcn (Uf /P, F̃).
The set of irreducible representations (up to isomorphism) of Z̄G (f ) which appear
in the representation (a) is denoted by Irr1 Z̄G (f ).
   Let R(Gϑ, GJ , C, F ) be the set of all (f, ρ) (modulo the Ad-action of G) where
f ∈ Gϑ and ρ ∈ Irr1 Z̄G (f ).
Lemma 7.6. Assume that S ⊂ K, S 6= ∅. Let P ′ be a parabolic subgroup of G
which has G(J) as a Levi subgroup and satisfies ϑP ′ ϑ−1 = P ′ . Then
  (a) GI−S ∩ G(J) = GJ ;
  (b) GI−S ∩ P ′ is a parabolic subgroup of GI−S with Levi subgroup GJ ;
  (c) GI−S ∩ UP ′ = UGI−S ∩P ′ .
   The proof is routine. It will be omitted.
30                                      G. LUSZTIG

                     8. Geometric affine Hecke algebras
8.1. We preserve the setup of 7.4. In this and the next subsection we assume that
card(K) ≥ 2.
    As in [L4, 5.6], for any J ′ ⊂ I such that J ⊂ J ′ 6= I, conjugation by the
                          ′
longest element w0J of WJ ′ leaves stable {si ; i ∈ J}. Hence for any k ∈ K we
have w0J∪k w0J w0J∪k = w0J and σk = w0J∪k w0J = w0J w0J∪k is an involution. Now
σk preserves the subspace VJ of V hence also the subspace VK′ of VK′ . Hence the
subgroup W ∗ of W a generated by {σk ; k ∈ K} acts on VK′ . As in [L4, 2.11], W ∗
is a Coxeter group (an affine Weyl group).
    Let y0 ∈ C. For k ∈ K, ad(y0 ) : g −       → g induces a nilpotent endomorphism of
gJ∪k /gJ . Let ck be the largest integer ≥ 2 such that the (ck − 2)-th power of this
nilpotent endomorphism is non-zero. (This does not depend on the choice of y0 .)
    The W ∗ -action on VK′ leaves stable the subset z1J of VK′ . It also leaves stable
the subspace zJ of VK′ where it acts through a finite quotient W ⊂ GL(zJ ). Let
L′ be the set of all x ∈ zJ such that the translation z 7→ z + x of z1J coincides
with the automorphism x 7→ w(x) of z1J for some w ∈ W ∗ . Then L′ is a subgroup
of zJ such that L′C = zJ . For k ∈ K there exist non-zero vectors h̃k ∈ zJ and
γ̃k ∈ Hom(zJ , C) such that σk (x) = x − γ̃k (x)h̃k for all x ∈ zG and γ̃k (h̃k ) = 2.
These vectors are uniquely determined if we require that γ̃k (x) = zk x(bk ) for all
x ∈ zJ , h̃k ∈ L and zk ∈ Z>0 is maximum possible (see [L4, 2.11]). We have
zk ∈ {1, 2, 3, 4}. Let L = {x ∈ z∗J ; x(L′ ) ∈ Z}. Then γ̃k ∈ L. Clearly, W acts
naturally on L′ , L. Let R̃ (resp. R̃ˇ) be the set of vectors in z∗J (resp. zJ ) that are
of the form w(γ̃k ) (resp. w(h̃k )) for some w ∈ W and some k ∈ K. Then
    (a) (R̃, R̃ˇ, L, L′ ) is an irreducible root system with Weyl group W.
                                                         ′
See [L4, 2.11]. Moreover, {h̃k ; k ∈ K} generates     P L (see [L4, 2.14]). Now {γ̃k ; k ∈
K} spans LC over C with a single      P relation k∈K ñk γ̃k = 0 where ñk ∈ Z>0 for
all k (at least one ñk is 1) and k∈K ñk is the Coxeter number of (a). For k ∈ K
we have
                                                  nk
                                            zk =      .
                                                  ñk
We define a subset K ♭ of K as follows. If W ∗ is a Coxeter group of type C̃n , n ≥ 1,
and k, k ′ correspond to the two ends of the Coxeter graph then K ♭ = {k, k ′ }. In
any other case, K ♭ = ∅. We set K ♯ = K − K ♭ .
  For k ∈ K we define z̄k by z̄k = zk /2 if k ∈ K ♭ and z̄k = zk if k ∈ K ♯ .
  We have z̄k ∈ { 21 , 1, 2, 3}. We set

                           γ̂k = (z̄k /zk )γ̃k , ĥk = (zk /z̄k )h̃k .

We have γ̂k ∈ L. Let R (resp. Rˇ) be the set of vectors in z∗J (resp. zJ ) that are of
the form w(γ̂k ) (resp. w(ĥk )) for some w ∈ W and some k ∈ K.
   In the case where K ♭ 6= ∅, we have {k ∈ K; ñk = 1} = K ♭ and we choose
k0 ∈ K so that k0 ∈ K ♭ and ck0 z̄k0 dk0 ≤ ck′ z̄k′ dk′ where K ♭ = {k0 , k ′ }. In the
Classification of unipotent representations

case where K ♭ = ∅ we choose k0 ∈ K such that ñk0 = 1. One can verify that

                        dim gI−{k0 } ≥ dim gI−{k} for any k ∈ K.

Now {γ̃k ; k ∈ K − {k0 }} is a basis for (R̃, R̃ˇ, L, L′ ) and γ̃k0 is the negative of the
highest root of (R̃, R̃ˇ, L, L′ ) with respect to this basis. Moreover,
   (d) (R, Rˇ, L, L′ ) is a root system and Π = {γ̂k ; k ∈ K − {k0 }} is a basis for it.
Its Weyl group is W.
   See [L4, 2.15]. Since {h̃k ; k ∈ K} generates L′ we see that Rˇ∪ ((1/2)Rˇ∩ L′ )
generates L′ .
8.2. If k ∈ K ♭ and K ♭ − {k} = {k ′ } we set

(a)      λ(γ̂k ) = (ck z̄k dk + ck′ z̄k′ dk′ )/2,   λ∗ (γ̂k ) = |ck z̄k dk − ck′ z̄k′ dk′ |/2.

If k ∈ K ♯ , we set

(b)                                    λ(γ̂k ) = ck z̄k dk /2.

Restricting, we get functions λ : Π − → N, λ∗ : {γ̂k ∈ Π; ĥk ∈ 2L′ } −  → N. (One
                          ∗                                       ∗
can check that λ and λ have indeed values in N.) Then (λ, λ ) is a parameter
                                                                                λ,λ∗
set for the root system 7.6(d) with its basis Π. Hence the C[v, v −1 ]-algebra HR,L
is well defined as in 1.2. We denote this algebra by H(Gϑ, GJ , C, F ); we call it a
geometric affine Hecke algebra.
8.3. Assume now that card(K) = 1. Then zJ = 0. We set (R, Rˇ, L, L′) =
                                     λ,λ∗
(0, 0, ∅, ∅). (A root system.) Then HR,L  = C[v, v −1 ] is again denoted by
H(Gϑ, GJ , C, F ).
8.4. The definition of K ♭ given in 8.1 differs slightly from the one given in [L4,
2.13]. (There are only three cases where the definitions differ: those in [L4, 7.16,
7.47, 7.56].) In the context of [L4] it does not matter which of the two definitions
we adopt. They both lead to the same H(Gϑ, GJ , C, F ). However, in the more
general context of this paper, the present definition should be adopted (it diverges
from the definition in [L4]).

                                        9. A bijection
9.1. We preserve the setup of §6,7,8. In particular we fix J, K as in 7.1, C, F as
in 7.4, P as in 7.5, k0 as in 8.1. Let v0 ∈ C∗ be such that either v0 = 1 or v0 is
not a root of 1. We choose r0 ∈ C such that exp(r0 ) = v0 ; if v0 = 1 we choose
r0 = 0. Let ♠ be the Q-subspace of C spanned by r0 . We have ♠ ∩ κQ = 0. We
can choose a Q-subspace ⋄ of C such that

(a)                                   κQ ⊂ ⋄, ⋄ ⊕ ♠ = C.
32                                  G. LUSZTIG

We have C∗ = exp(⋄) × exp(♠).
   If G′ is an algebraic group, any g ∈ G′ can be written uniquely in the form
g = g⋄ g♠ = g♠ g⋄ where g⋄ ∈ G′⋄ is semisimple and g♠ ∈ G′♠ .
   In this section we will define a bijection

(b)                  Irrv0 H(Gϑ, GJ , C, F ) ↔ R(Gϑ, GJ , C, F )

in terms of r0 and ⋄ as above.
   If card(K) = 1 then both sides of (b) consist of one element, hence there is a
unique bijection between them. In the remainder of this section we assume that
card(K) ≥ 2.
9.2. Let V ′⋄ = {x′ ∈ V ′ ; x′ = i∈I ci b′i , ci ∈ κ−1 ⋄}.
                                P
   For any S ⊂ I, S 6= ∅ let CS⋄ = CS ∩ V ′⋄ . Let C ′⋄ = ⊔S⊂I,S6=∅ CS⋄ = C ′ ∩ V ′⋄ .
Let D = ⊔S⊂K;S6=∅ CS , D⋄ = ⊔S⊂K;S6=∅ CS⋄
   (a) The map x′ 7→ p(x′ ) defines a bijection between C ′⋄ and a set of represen-
tatives for the orbits of the N action on T⋄ ϑ = Ĝ⋄ ∩ T ϑ (by conjugation).
This is an immediate consequence of 6.11 and its proof.
   We set
                                   T = L′ ⊗ C∗ .

(A torus.) Then L′C = zJ = T hence expT : zJ −        → T is defined. Let p′ be the
composition z1J −       → T where the first map is x 7→ x − n1k b′k0 and the second
                   → zJ −
                                                                  0
map is x 7→ expT (κx).
   (b) The map x′ 7→ p′ (x′ ) defines a bijection between D and a set of repre-
sentatives for the W-orbits in T and also a bijection between D⋄ and a set of
representatives for the W-orbits in T⋄ .
   Just like 6.11 was proved using 6.6, the proof of (b) is based on the following
analogue of 6.6.
   Let x′ ∈ z1J . The W ∗ -orbit W ∗ x′ meets D in exactly one point.
This is proved exactly like 6.6, by replacing W a by W ∗ .
   For d ∈ D⋄ , let Wd be the stabilizer of p′ (d) in W. Let Θ be the set consisting
of all pairs (d, δ) where d ∈ D⋄ and δ is a Wd -orbit in T♠ . Using the decomposition
                                              ∼
T = T⋄ T♠ we see that there is a bijection Θ −→ T /W which associates to (d, δ) ∈ Θ
the W-orbit of p′ (d)z where z ∈ δ. (This W-orbit is denoted by Σd,δ .)
9.3. The partition 1.3(a) becomes in our case
                       ∗                                              ∗
                    λ,λ                                           λ,λ
(a)          Irrv0 HR,L = ⊔S⊂K,S6=∅ ⊔d∈CS⋄ ⊔δ∈T♠ /Wd IrrΣd,δ ,v0 HR,L .

Let (d, δ) ∈ Θ where d ∈ CS⋄ . Then p′ (d)δ is a Wd -orbit contained in Σd,δ .
Moreover,
                   Rp′ (d)δ , Rˇp′ (d)δ , Πp′ (d)δ , λp′ (d)δ , λ∗p′ (d)δ
Classification of unipotent representations

are defined in terms of L, L′ , R, Rˇ, Π, p′ (d)δ, λ, λ∗ in the same way as
Rc , Řc , Πc , λc , λ∗c were defined in [8.1]′ (see 2.2) and 3.1 in terms of
X, Y, R, Ř, Π, c, λ, λ∗. Then, by 3.2 we have a natural bijection
                                     λ,λ   ∗                   λp′ (d)δ ,λ∗′
(b)                     IrrΣd,δ ,v0 HR,L ↔ Irrp′ (d)δ,v0 HRp′ (d)δ ,Lp (d)δ .

Let WK−S be the subgroup of W generated by the image of {σk ; k ∈ K −S} in W.
Let RK−S (resp. RˇK−S ) be the set of vectors of L (resp. L′ ) of the form w(γ̂k )
(resp. w(ĥk )) for some k ∈ K − S, w ∈ WK−S . Let ΠK−S = {γ̂k ; k ∈ K − S}.
Then

      (L, L′ , Rp′ (d)δ , Rˇp′ (d)δ , Πp′ (d)δ , Wd ) = (L, L′ , RK−S , RˇK−S , ΠK−S , WK−S ).

(The main assertion here is that Rp′ (d)δ = RK−S . In other words, for α ∈ R, with
corresponding α̌ ∈ Rˇ, the condition that α ∈ RK−S is equivalent to the condition
that α(d − n1k b′k0 ) is in Z if α̌ ∈
                                    / 2L′ and is in 21 Z if α̌ ∈ 2L′ . This is an assertion
              0
of the same type as 6.16 and has a similar proof. See also [L4, 3.9, 3.10].)
   Thus, the bijection (b) can be rewritten as
                                               ∗                      ∗
                                           λ,λ                  λ,λ
                              IrrΣd,δ ,v0 HR,L ↔ Irrp′ (d)δ,v0 HR K−S ,L
                                                                         ;

the exponents λ, λ∗ in both sides are restrictions of the function given by 8.2(a),(b).
   Taking union of all d, δ and composing with (a) we obtain a bijection
                         ∗                                                      ∗
                     λ,λ                                             λ,λ
(c)           Irrv0 HR,L ↔ ⊔S⊂K,S6=∅ ⊔d∈CS⋄ ⊔δ∈T♠ /Wd Irrp′ (d)δ,v0 HR K−S ,L
                                                                              .

Let (d, δ) ∈ Θ. Then (LQ , L′Q , RK−S , RˇK−S ) is a Q-root system with basis ΠK−S .
                                                                             ′
   For k ∈ K we regard γ̃k as a character T − → C∗ given by l′ ⊗ a 7→ aγ̃k (l ) where
l′ ∈ L′ , a ∈ C∗ . Then for z ∈ zJ we have γk (expT (z)) = exp(γk (z)). We show
that, if k ∈ K − S, k ∈ K ♭ then:

                  γ̂k (p′ (d)) = −1 if k = k0 and γ̂k (p′ (d)) = 1 if k 6= k0 .
Indeed, γ̂k (expT (κ(d − n1k b′k0 ))) = exp(κz̄k bk (d − zk1 b′k0 )) = exp(−κδk,k0 /2).
                            0                               0
   It follows that, if we define µ : ΠK−S −     → Z in terms of λ, λ∗ as in 4.1 (with
t0 = p′ (d)), then
                                     µ(γ̂k ) = dk z̄k ck .
Define a WK−S -orbit δ̄ in T ♠ by expT (δ̄) = δ. By 4.2 we have a bijection
                                                                          ∗
                                        µ                          λ,λ
                             Irrδ̄,r0 H̄R K−S ,LQ
                                                  ↔ Irrp′ (d)δ,v0 HR K−S ,L
                                                                            .

Taking union over all d, δ and composing with (c) we obtain a bijection
                        ∗
                    λ,λ                                             µ
(d)          Irrv0 HR,L ↔ ⊔S⊂K,S6=∅ ⊔d∈CS⋄ ⊔δ̄∈T ♠ /WK−S Irrδ̄,r0 H̄R K−S ,LQ
                                                                              .
34                                      G. LUSZTIG

   For k ∈ K we set ∗ γk = (1/dk z̄k )γ̂k ∈ z∗J (that is, ∗ γk is the restriction of βk to
zJ where βk is regarded as an element of t∗ ). We set ∗ hk = dk z̄k ĥk ∈ zJ .
   Let S ⊂ K, S 6= ∅. Let ∗ RK−S (resp. ∗ RˇK−S ) be the set of vectors of LQ
(resp. L′Q ) of the form w(∗ γk ) (resp. w(∗ hk )) for some k ∈ K − S, w ∈ WK−S .
Let ∗ ΠK−S = {∗ γk ; k ∈ K − S}. Then (LQ , L′Q , RK−S , RˇK−S , ∗ ΠK−S ) is a Q-
root system. Define µ′ : ∗ ΠK−S −     → N by µ′ (∗ γk ) = ck . There is an algebra
isomorphism
                              µ            ∼      µ′
                            H̄R  K−S ,L Q
                                          −→   H̄ ∗R
                                                     K−S ,LQ


which is the identity on the generators. (We use that µ(γ̂k )/γ̂k = µ′ (∗ γk )/∗ γk .)
This induces a bijection
                                                           ′
                                    µ
                         Irrδ̄,r0 H̄R K−S ,LQ
                                              ↔ Irrδ̄,r0 H̄∗µRK−S ,LQ

for any δ̄ ∈ T ♠ /WK−S . Taking union over all d, δ̄ and composing with (d) we
obtain a bijection
                     ∗                                                  ′
                 λ,λ
(e)       Irrv0 HR,L ↔ ⊔S⊂K,S6=∅ ⊔d∈CS⋄ ⊔δ̄∈T ♠ /WK−S Irrδ̄,r0 H̄∗µRK−S ,LQ .

Let S ⊂ K, S 6= ∅. If we apply the definitions of 5.2 to GI−S , GJ (instead of G, L)
                                                                ′
then R, W of 5.2 become ∗ RK−S , WK−S . We see that H̄∗µRK−S ,LQ (as above)
may be interpreted as H̄(GI−S , GJ , C, F ). Moreover, if d ∈ CS⋄ we have GI−S =
ZG (p(d)) (see 6.20). Hence we may rewrite (e) as
                ∗
           λ,λ
(f) Irrv0 HR,L ↔ ⊔S⊂K,S6=∅ ⊔d∈CS⋄ ⊔δ̄∈(zJ )♠ /WK−S Irrδ̄,r0 H̄(ZG (p(d)), GJ , C, F )

(We have used that T = zJ . Moreover (zJ )♠ defined in terms of ZJ0 coincides with
T ♠ defined in terms of T .) By 5.17(d), for any S ⊂ K, S 6= ∅ and d ∈ CS⋄ we have
a bijection

      ⊔δ̄∈(zJ )♠ /WK−S Irrδ̄,r0 H̄(ZG (p(d)), GJ , C, F ) ↔ Ṫ♠ (ZG (p(d)), GJ , C, F ).

(To define Ṫ♠ (ZG (p(d)), GJ , C, F ) we use the parabolic subgroup P ∩ GI−S of
ZG (p(d)) = GI−S with Levi subgroup GJ , see 7.6.) Taking union over all d and
composing with (f) we obtain a bijection
                         ∗
                     λ,λ
(g)           Irrv0 HR,L ↔ ⊔S⊂K,S6=∅ ⊔d∈CS⋄ Ṫ♠ (ZG (p(d)), GJ , C, F ).

Lemma 9.4. Let f ∈ Gϑ. The following three conditions are equivalent:
   (i) there exists g ∈ G such that, for some S ⊂ K, S 6= ∅ we have g −1 f⋄ g ∈ p(CS⋄ )
                  ˙ 0 )♠ (UP ∩ GI−S );
and g −1 f♠ g ∈ C(Z  J
   (ii) there exists g ∈ G such that for some S ⊂ K, S 6= ∅ we have g −1 f g ∈
 ˙
Cp(C  ⋄    0
      S )(ZJ )♠ (UP ∩ GI−S );
Classification of unipotent representations

   (iii) g −1 f g ∈ X(J) UP .
   It is clear that (i) and (ii) are equivalent and that (ii) implies (iii). Now assume
that (iii) holds. We show that (ii) holds. We may assume that f ∈ X(J) UP . By
replacing f by a P -conjugate, we may assume that f ∈ XJ CU       ˙ P . Let fs and fu be
the semisimple and unipotent part of f . Then fs is P -conjugate to an element of
XJ . Hence, replacing f by a P -conjugate, we mayPassume that fs ∈ XJ , fu ∈ CU     ˙ P.
       1                      ′    1             ′              ′             −1
Let (zJ )⋄ be the set of all x ∈ zJ such that x = k∈K ck bk with ck ∈ κ ⋄. Then
XJ = p((z1J )⋄ )(ZJ0 )♠ . Now the W ∗ -action on z1J restricts to a W ∗ -action on (z1J )⋄
which has ∪S⊂K;S6=∅ CS⋄ as a fundamental domain. Hence by replacing f by nf n−1
for some n ∈ Gϑ such that

(a)                                          ˙ nG(J) n−1 = G(J) , nP n−1 = P ′
      nGJ n−1 = GJ , nXJ n−1 = XJ , nĊn−1 = C,

(P ′ is another parabolic subgroup normalized by ϑ which has G(J) as a Levi
subgroup), we see that we may assume that f⋄ ∈ p(CS⋄ ), f♠ ∈ (ZJ0 )♠ CU      ˙ P ′ . Since
                                     0    ˙
f♠ ∈ ZG (f⋄ ) and f⋄ as well as (ZJ )♠ C are contained in the Levi subgroup G(J)
of P ′ , we have automatically f♠ ∈ (ZJ0 )♠ C(Z˙ G (f⋄ ) ∩ UP ′ ). Since ZG (f⋄ ) = GI−S
(see 6.20), we have
                                              ˙ I−S ∩ UP ′ ).
                          f ∈ p(CS⋄ )(ZJ0 )♠ C(G
Now the parabolic subgroups GI−S ∩ P ′ and GI−S ∩ P of GI−S (both with Levi
subgroup GJ , see 7.6) are conjugate under an element z ∈ GI−S which normalizes
GJ . Conjugation by z carries GI−S ∩ UP ′ to GI−S ∩ UP , p(CS⋄ ) to p(CS⋄ ), ZJ0 to
ZJ0 and C˙ to C˙ hence it carries f to zf z −1 ∈ p(CS⋄ )(ZJ0 )♠ C(U
                                                                 ˙ P ∩ GI−S ). Thus, f
satisfies (ii). The lemma is proved.
9.5. Let f ∈ Gϑ. Assume that f⋄ ∈ p(CS⋄ ) where S ⊂ K, S 6= ∅. Then f♠ ∈
ZG (f⋄ ) = GI−S . We want to compare the varieties:

            A = {g ∈ G; g −1 f g ∈ G(J) UP }/P,
                                                   ˙ P ∩ GI−S )}/(P ∩ GI−S ).
            A′ = {g ′ ∈ GI−S ; g ′−1 f♠ g ′ ∈ ZJ0 C(U

Let P ′ be any parabolic subgroup of G such that ϑP ′ ϑ−1 = P ′ , G(J) is a Levi
subgroup of P ′ and P ′ ∩ GI−S = P ∩ GI−S . Let A(P ′ ) = {g ∈ G; g −1 f g ∈
G(J) UP ′ }/P ′ . Define fP ′ : A′ −
                                   → A(P ′ ) by g ′ (P ∩ GI−S ) 7→ g ′ P ′ . This is clearly
                                                                                       ∼
injective. We can find n ∈ GI−S such that 9.4(a) holds. Define Fn : A(P ′ ) −→ A
by gP ′ 7→ gnP . The composition Fn fP ′ : A′ −    → A(P ′ ) is injective. Its image AP ′
                      ′
depends only on P , not on n. By the argument in the proof of 9.4 we see that A
is the disjoint union of finitely many subvarieties AP ′ (for the various P ′ as above)
and each AP ′ is isomorphic to A′ . It follows easily that

(a)                             Irr1 Z̄G (f ) = Irr0 Z̄ZG (f⋄ ) (f♠ ).
36                                     G. LUSZTIG

(Note that ZG (f ) = ZZG (f⋄ ) (f♠ ).) Using (a) and 9.4 we see that we have a
bijection

(b)        ⊔S⊂K,S6=∅ ⊔d∈CS⋄ Ṫ♠ (ZG (p(d)), GJ , C, F ) ↔ R(Gϑ, GJ , C, F )

given by (d, (f, ρ)) 7→ (p(d)f, ρ). Here f ∈ (ZG (p(d)))♠ . Composing (b) with
                                     λ,λ∗
9.3(g), we obtain a bijection Irrv0 HR,L  ↔ R(Gϑ, GJ , C, F ). This is, by definition,
the bijection 9.1(b).

                                10. The main results
10.1. In 10.2-10.7 we preserve the setup of 9.1.
Lemma 10.2. Assume that card(K) ≥ 2. There is a canonical injective map
ι : T /W −
         → (T ϑ)/N whose image is exactly the image of XJ in (T ϑ)/N .
    By definition, ι sends the W-orbit of t ∈ T to the N -orbit of p(x′ ) where
x′ ∈ z1J is such that p′ (x′ ) = t. Assume that x′′ is an element of z1J such that
p′ (x′′ ) = w1 (t) where w1 ∈ W. Then there exists w ∈ W ∗ such that p′ (w(x′′ )) = t.
Since p′ (w(x′′ ) − x′ ) = 1, we have w(x′′ ) − x′ ∈ L′ . Hence x′ = w′ w(x′′ ) for some
w′ ∈ W ∗ . In particular, x′ = w̃(x′′ ) for some w ∈ W a . Hence p(x′ ) = np(x′′ )n−1
for some n ∈ N . Thus, ι is well defined.
    We show that ι is injective. Now C ′ is a set of representatives for the W a -orbits
on t1 . Similarly, D is a set of representatives for the W ∗ -orbits on t1J . Let t1 , t2 ∈ T
be such that the W-orbit of t1 and the W-orbit of t2 have the same image under
ι. Let x1 , x2 ∈ t1J be such that p′ (x1 ) = t1 , p′ (x2 ) = t2 . We may assume that
x1 ∈ D, x2 ∈ D. Since D ⊂ C ′ , we have x1 ∈ C ′ , x2 ∈ C ′ . By assumption we have
p(x1 ) = np(x2 )n−1 for some n ∈ N . Hence x1 = w(x2 ) for some w ∈ W a . Since
x1 , x2 ∈ C ′ , it follows that x1 = x2 . Hence t1 = t2 . This shows that ι is injective.
The fact that the image of ι is exactly the image of XJ in (T ϑ)/N is obvious. The
lemma is proved.
10.3. We show that the bijection 9.1(b) does not depend on the choice of ⋄ as in
9.1(a). When v0 = 1 this is obvious: we have ⋄ = C. Assume now that v0 6= 1. It
is enough to show that one can define a map

                       Irrv0 H(Gϑ, GJ , C, F ) −
                                               → R(Gϑ, GJ , C, F )

purely in terms of ♠ and which coincides with the map defined in §9 in terms of
any given ⋄. We can assume that card(K) ≥ 2.
   Let M ∈ Irrv0 H(Gϑ, GJ , C, F ). We want to attach to M a pair (f, ρ) (up to G-
conjugacy) where f ∈ Gϑ and ρ ∈ Irr1 Z̄G (f ). We will only indicate the definition
of the G-conjugacy class of f . (A similar definition applies to ρ.)
                                  λ,λ∗
   By 1.3, we have M ∈ IrrΣ,v0 HR,L    for a well defined W-orbit Σ on T . Let c be
a fibre of Σ −
             → T /T♠ (restriction of T − → T /T♠ ). Define Rc , W c , Hc in terms of
Classification of unipotent representations

T , R in the same way as Rc , W0c , Hc were defined in [8.1]′ and [8.3]′ (see 2.2) in
terms of T , R. By 3.2, to M corresponds an object M ′ ∈ Irrc,v0 Hc . As in [9.2]′ ,
we can find an element t0 ∈ T whose stabilizer in W equals W c and a W c -orbit c̄
in t♠ such that t0 expT (c̄) = c. By 4.2 (for this t0 ), M ′ corresponds to an object
M ′′ ∈ Irr♠
          r0 H̄ where H̄ is attached to Hc as in 4.1. Let t̃0 be an element of XJ
such that ι(Wt) is the N -orbit of t̃0 (see 10.2). Now H̄ may be interpreted as the
algebra H̄(G′ , GJ , C, F ) where G′ = ZG (t̃0 ). (Note that GJ is the Levi subgroup of
some parabolic subgroup of G′ .) Under 5.17(d), to M ′′ corresponds a pair (f ′ , ρ′ )
where f ′ ∈ G′♠ is well defined up to conjugation in G′ and ρ′ ∈ Irr0 Z̄G′ (f ′ ). We
set f = t̃0 f ′ = f ′ t̃0 . Then the Ad(G)-orbit of f is well defined by M . Note that
we have not used ⋄ in this definition. Thus we have the following result.
Theorem 10.4. Assume that v ∈ C∗ is either 1 or is not a root of 1. Let r0 ∈ C
be as in 9.1. There is a bijection

(a)                     Irrv0 H(Gϑ, GJ , C, F ) ↔ R(Gϑ, GJ , C, F )

depending only on r0 , which for any ⋄ as in 9.1(a) coincides with the bijection
9.1(b).
   It is likely that the bijection (a) is independent of the choice of r0 . (Some
evidence is given in 10.7.)
Theorem 10.5. We preserve the setup of 10.4. Assume that v0 is not a root of
1. Let ζ : C∗ −
              → R be a group homomorphism such that ζ(v0 ) 6= 0. Assume that
under 10.4(a), M ∈ Irrv0 H(Gϑ, GJ , C, F ) corresponds to (f, ρ) ∈ R(Gϑ, GJ , C, F ).
Then
   (a) M is ζ-tempered if and only if f ∈ ĜKerζ ;
   (b) M is ζ-square integrable if and only if any torus in ZG (f ) is {1}.
   Assume first that card(K) = 1. Then the unique M ∈ Irrv0 H(Gϑ, GJ , C, F )
is obviously ζ-square integrable. The unique element of R(Gϑ, GJ , C, F ) may be
represented in the form (f, ρ) where f = su with s being the unique element of
XJ and u ∈ C. ˙ Assume that T1 is a torus in ZG (f ) = ZG (u). In our case, GJ is
                                                            J
a semisimple group and u is a distinguished unipotent element of GJ . Hence any
torus in ZGJ (u) is trivial. Thus, T = 1 hence (b) holds in this case. We show that
f ∈ ĜKerζ . It is enough to show that s ∈ ĜKerζ . Since ZG (s) is semisimple, s is
of finite order. Since Kerζ contains all roots of 1, we have s ∈ ĜKerζ . Thus, (a)
holds in this case.
   In the remainder of the proof we assume that card(K) ≥ 2. Let r0 , ♠ be as in
9.1.
   Case 1. We assume that ζ(C∗ ) ⊂ Q. In this case, ζ restricts to an iso-
                      ∼
morphism exp(♠) −→ Q. In particular we have C∗ = Kerζ ⊕ exp(♠). Let
⋄ = {a ∈ C; ζ(exp(a)) = 1}. Then ⋄ satisfies 9.1(a) and Kerζ = exp(⋄). We
can use the definition of the bijection 9.1(b) in terms of this ⋄.
38                                    G. LUSZTIG

    We prove (a). Using Lemmas 3.4, 4.3, 5.18 and the definitions we are reduced
to verifying that for f ∈ Gϑ the following two conditions are equivalent:
    (i) f♠ ∈ ZG (f⋄ )Kerζ ;
    (ii) f ∈ ĜKerζ .
(When applying 4.3, we can choose t0 in 4.1 so that t0 ∈ T⋄ ; then it is unique.
The assumption t0 ∈ T Kerζ of 4.3 is automatically verified since T Kerζ = T⋄ .)
    Now (i) is equivalent to the condition f♠ ∈ ĜKerζ . This is equivalent to (ii)
since we have automatically f⋄ ∈ ĜKerζ (since Kerζ = exp(⋄)).
    We prove (b). Using Lemmas 3.5, 4.4, 5.16 and the definitions we are reduced
to verifying that for f ∈ G the following two conditions are equivalent:
    (iii) ZG (f⋄ ) is semisimple and f♠ is a distinguished unipotent element of ZG (f⋄ );
    (iv) any torus in ZG (f ) is {1}.
This is immediate.
    General case. As in 1.3, let L+ be the set of all x ∈ L such that hx, ĥk i ≥ 0 for
                                                                      PN
all γ̂k ∈ Π. We can find x1 , . . . , xN in L+ − {0} such that L+ = k=1 Nxk . There
exists a finite subset T0 of T such that, for t ∈ T , the weight space Mt is zero
unless t ∈ T0 . Let A be the (finite) subset of C∗ consisting of all numbers of the
form xk (t) with k ∈ [1, N ], t ∈ T0 . Let B be the (finite) subset of C∗ consisting
of the eigenvalues of f in a fixed faithful V ∈ IĜ . Then (a),(b) can be restated as
(c),(d) below:
    (c) we have ζ(a)/ζ(v0 ) ≥ 0 for all a ∈ A if and only if ζ(b) = 0 for all b ∈ B;
    (d) we have ζ(a)/ζ(v0 ) > 0 for all a ∈ A if and only (iv) holds.
    Assume first that ζ(a)/ζ(v0 ) ≥ 0 for all a ∈ A and ζ(b) 6= 0 for some b ∈ B.
We can find a Q-linear form u : R −       → Q such that u(ζ(v0 )) 6= 0, u(ζ(b)) 6= 0 and
u(ζ(a))/u(ζ(v0 )) ≥ 0 for all a ∈ A. Applying Case 1 to uζ : C∗ −     → Q instead of ζ,
we see that u(ζ(b)) = 0, a contradiction.
    Assume next that ζ(a)/ζ(v0 ) < 0 for some a ∈ A and ζ(b) = 0 for all b ∈ B. We
can find a Q-linear form u : R −     → Q such that u(ζ(v0 )) 6= 0, u(ζ(a))/u(ζ(v0)) < 0.
We have u(ζ(b)) = 0 for all b ∈ B. Applying Case 1 to uζ : C∗ −       → Q instead of ζ,
we see that u(ζ(a))/u(ζ(v0)) ≥ 0, a contradiction. Thus, (c) holds.
    Assume now that ζ(a)/ζ(v0 ) > 0 for all a ∈ A. We can find a Q-linear form
u : R −   → Q such that u(ζ(v0 )) 6= 0 and u(ζ(a))/u(ζ(v0 )) > 0 for all a ∈ A.
Applying Case 1 to uζ : C∗ −     → Q instead of ζ, we see that (iv) holds.
    Conversely, assume that ζ(a)/ζ(v0 ) ≤ 0 for some a ∈ A. We can find a Q-linear
form u : R −  → Q such that u(ζ(v0 )) 6= 0 and u(ζ(a))/u(ζ(v0 )) ≤ 0. Applying Case
1 to uζ : C∗ −   → Q instead of ζ, we see that (iv) does not hold. Thus, (d) holds.
The theorem is proved.
Corollary 10.6. Let v0 , ζ, M be as in 10.5.
   (a) M is ζ-tempered if and only if the following holds: for any t ∈ T such that
Mt 6= 0 and any x ∈ L+ we have ζ(x(t))/ζ(v0 ) ∈ Q≥0 .
   (b) M is ζ-square integrable if and only if the following holds: for any t ∈ T
such that Mt 6= 0 and any x ∈ L+ − {0} we have x(t) = av0n for some n ∈ Z>0
Classification of unipotent representations

and some a ∈ C∗ , a root of 1.
   Assume that M is ζ-tempered and there exists t ∈ T and x ∈ L+ such that Mt 6=
0 and ζ(x(t))/ζ(v0 ) ∈
                     / Q≥0 . Note that ζ(x(t))/ζ(v0 ) ∈ R>0 . Since ζ(x(t)), ζ(v0 )
are non-zero real numbers of the same sign and one is not a rational multiple of
the other, we can find a Q-linear form u : R −  → Q such that u(ζ(v0 )) 6= 0 and
u(ζ(x(t)))/u(ζ(v0 )) ∈ Q<0 . Hence M is not uζ-tempered. Let f correspond to
M as in 10.5. By 10.5(a) we have f ∈ ĜKerζ . It follows that f ∈ ĜKer(uζ) . Using
again 10.5(a) (for uζ instead of ζ) we see that M is uζ-tempered, a contradiction.
This proves (a).
   We prove (b). By the arguments in the proof of 3.4, 4.4, we are reduced to
the analogous statement for the algebras considered in §5, which is proved in [L5,
1.22]. The corollary is proved.
10.7. In the setup of 9.1 (with card(K) ≥ 2) we consider an element f ∈ Gϑ such
                                                                          ′
that (f, ρ) ∈ R(Gϑ, GJ , C, F ) for some ρ. We can write uniquely f = f⋄ f♠ fu (three
                                                      ′
commuting factors) where f⋄ ∈ Ĝ⋄ is semisimple, f♠ ∈ G♠ is semisimple, fu ∈ G
is unipotent. Replacing (f, ρ) by a G-conjugate, we may assume that f⋄ ∈ XJ (see
9.5) so that GJ ⊂ ZG (f⋄ ). Let t ∈ T⋄ be such that ι(Wt) is the N -orbit of f⋄ .
                                                                                  ′
(See 10.2.) Let Wt be the stabilizer of t in W. Let φ ∈ Hom(SL2 (C), ZG (f⋄ f♠      ))
                
be such that φ 10 11 = fu . Let
                                            
                             ˜     ′    v0 0
                            f = f♠ φ 0 v −1 ∈ ZG (f⋄ ).
                                           0
                                                 
Let φ0 ∈ Hom(SL2 (C), GJ ) be such that φ0 10 11 ∈ C.     ˙ Using 5.6, we see that
there exists z ∈ ZG (f⋄ ) such that
                                                          
                                                  v0−1 0
(a)                             z f˜z −1 φ0         0 v0
                                                               ∈ (ZJ0 )♠

and that the orbit of the element (a) under the normalizer of ZJ0 in ZG (f⋄ ) does
not depend on the choice of z. Since (ZJ0 )♠ = T♠ (both may be identified with
(zJ )♠ using expZJ0 , expT ) we may regard this orbit as a Wt -orbit c in T♠ . Let Σ
be the W-orbit in T that contains tc. Then Σ depends only on the G-conjugacy
class of (f, ρ) and (f, ρ) 7→ Σ is a map
(b)                              R(Gϑ, GJ , C, F ) −
                                                   → T /W.
   We now give a second definition of the map (b). Consider (f, ρ) as above. We
can write uniquely f = fs fu (two commuting factors) where fs ∈ Ĝ is semisimple,
fu ∈ G is unipotent. Replacing (f, ρ) by a G-conjugate, we may assume that
fs ∈ XJ (see
            9.5) so that GJ ⊂ ZG (fs ). Let φ ∈ Hom(SL2 (C), ZG (fs )) be such
          11
that φ    01
               = fu . Let
                                                         
                                                v0 0
                                fˆ = fs φ        0 v0−1       ∈ ZG (fs ).
40                                    G. LUSZTIG
                                                              
      0
Let φ ∈ Hom(SL2 (C), GJ ) be such that φ         0       1 1         ˙ Using 5.6, we see that
                                                                   ∈ C.
                                                         0 1
there exists z ∈ ZG (fs ) such that
                                                        
                                   ˆ  −1 0 v0−1   0
                            a =: z f z φ     0    v0
                                                             ∈ XJ .

Let Σ be the W-orbit in T such that ι(Σ) is the N -orbit of a (see 10.2). Then Σ
depends only on the G-conjugacy class of (f, ρ) and (f, ρ) 7→ Σ coincides with the
                                                λ,λ∗                     λ,λ∗
map (b). In the setup of 10.4, each M ∈ Irrv0 HR,L   belongs to IrrΣ,v0 HR,L  for a
unique W-orbit Σ in T (as in 1.3(a)). Then M 7→ Σ is a well defined map
                                            ∗
                                        λ,λ
(c)                              Irrv0 HR,L −
                                            → T /W.

Composing this with the bijection 10.4(a) we obtain a map R(Gϑ, GJ , C, F ) − →
T /W. This coincides with the map (b) (in its first form) as one sees using the
definitions.
   The fact that the map (b) (in its second form) is independent of the choice
of r0 , ⋄ and that the same is obviously true for the map (c), suggests that the
bijection 10.4(a) is also independent of r0 .
10.8. We fix v0 ∈ C∗ which is either 1 or is not a root of 1. Let J be the set of all
triples (J, C, F ) as in 7.4. (Here F is given up to isomorphism.) Putting together
the bijections 10.4(a) for various (J, C, F ) ∈ J, we obtain a bijection

(a)        ⊔(J,C,F)∈J Irrv0 H(Gϑ, GJ , C, F ) ↔ ⊔(J,C,F)∈J R(Gϑ, GJ , C, F ).

Let R(Gϑ) be the set of all (f, ρ) (modulo the Ad-action of G) where f ∈ Gϑ
and ρ ∈ IrrZ̄G (f ) (the set of isomorphism classes of irreducible representations of
Z̄G (f )). We will show below that

(b)                     ⊔(J,C,F)∈J R(Gϑ, GJ , C, F ) = R(Gϑ).

Combined with (a), this gives a bijection

(c)                  ⊔(J,C,F)∈J Irrv0 H(Gϑ, GJ , C, F ) ↔ R(Gϑ).

We prove (b). We fix f ∈ Gϑ. We may assume that f⋄ ∈ p(CS⋄ ) where S ⊂ I, S 6=
∅. Then ZG (f⋄ ) = GI−S . Let ρ ∈ IrrZ̄G (f ). We must show that there is a unique
(J, C, F ) ∈ J such that ρ belongs to Irr1 Z̄G (f ) (defined in terms of G, GJ , C, F ) or
equivalently (see 9.5(a)) to Irr0 Z̄GI−S (f♠ ) (defined in terms of GI−S , GJ , C, F ; we
have necessarily J ⊂ I − S). Recall that Z̄G (f ) = Z̄GI−S (f♠ ). Define ξ ∈ (gI−S )♠
by exp(ξ) = f♠ . We are reduced to verifying the following statement:
   For any ρ ∈ IrrZ̄GI−S (ξ) there exists a unique (J, C, F ) ∈ J such that J ⊂ I − S
and ρ is in Irr0 Z̄GI−S (ξ) (defined in terms of GI−S , GJ , C, F ).
   This follows from [L3, §8].
Classification of unipotent representations

10.9. Let ζ : C∗ −  → R be a homomorphism such that ζ(v0 ) 6= 0. By 10.5, the
bijection 10.8(c) restricts to a
   bijection between the set of ζ-tempered representations in the left hand side of
10.8(c) and {(f, ρ) ∈ R(Gϑ); f ∈ ĜKerζ }
   and to a
   bijection between the set of ζ-square integrable representations in the left hand
side of 10.8(c) and the set of all (f, ρ) ∈ R(Gϑ) such that any torus in ZG (f ) is
{1}.
   Special cases of this result can be found in [KL],[R],[W].
10.10. Let K, q be as in 1.1. Let K̃ be a maximal unramified extension of K. Let
G be a connected, adjoint simple algebraic group defined over K which is split
over K̃. We identify G with G(K̃). Assume that G is of type dual in the sense of
Langlands to G. Define I as in [L4, 1.10]. This is the set of vertices of the affine
                                                         ∼
Dynkin graph of G. Let S̃(I) be the set of bijections I −→ I that preserve the graph
structure. We have a canonical (surjective) homomorphism from S̃(I) to the group
of automorphisms of G modulo the group of inner automorphisms of G (see [L4,
8.1]). Let S̃(I)ϑ be the fibre of this map over the coset of Ad(ϑ) : G −  → G. For
u ∈ S̃(I)ϑ we can find a K-rational structure on G (compatible with the K̃-rational
structure) with Frobenius map Fu (see [L4, 1.1]) such that the permutation of I
induced by Fu (as in [L4, 1.12]) is equal to u. Then G(K) coincides with the
fixed point set GFu . Let U(GFu ) be the set of isomorphism classes of unipotent
representations of GFu (see [L4, 1.21]).
Theorem 10.11. There is a natural bijection ⊔u∈S̃(I)ϑ U(GFu ) ↔ R(Gϑ).
   By [L4, 1.22] we have a natural bijection between ⊔u∈S̃(I)ϑ U(GFu ) and the dis-
joint union of the sets of irreducible representations (up to isomorphism) of a finite
collection of affine Hecke algebras H′ (I, J, u, E) given by a presentation of Iwahori-
Matsumoto type with explicitly known parameters and with the indeterminate v
                      √
being specialized to q. (Here u ∈ S̃(I)ϑ , J is a proper u-stable subset of I, E is a
unipotent cuspidal representation of the Fu -fixed points of the parahoric subgroup
attached to J). The various J, u, E are listed in the tables in §11 as ”arithmetic
diagrams”; the corresponding affine Hecke algebras H′ (I, J, u, E) are listed in the
same tables as ”H.A.”. Rather surprisingly, it turns out out that these affine Hecke
algebras are exactly the same as the geometric affine Hecke algebras attached to
Gϑ (which are also described in the tables of §11). Therefore, the theorem follows
                         √
from 10.8(c) with v0 = q.
10.12. For any homomorphism χ : ZG −     → C∗ , let R(Gϑ)χ be the subset of R(Gϑ)
consisting of all (f, ρ) such that via the obvious map ZG −→ Z̄G (f ), ZG acts on
ρ through the character χ. This gives us a partition R(Gϑ) = ⊔χ R(Gϑ)χ . On
the other hand, the bijection in 10.11 induces a partition of R(Gϑ) into subsets
indexed by the elements of S̃(I)ϑ . This coincides with the previous partition of
R(Gϑ).
42                                        G. LUSZTIG

10.13. Let K, q, K̃, G be as in 10.10 except that G is no longer assumed to be
split over K̃. We identify G with G(K̃). One can still define the set I which
indexes the maximal parahoric subgroups of G (see [T]), a Dynkin graph with set
of vertices I and a bijection u : I −
                                    → I (preserving the graph structure, including the
orientation of the double or triple edges) which specifies the K-rational structure
on G. Then U(G(K)) can be defined in the same way as in [L4, 1.21]. We can
find another connected adjoint simple algebraic group G′ which is split over K̃
whose associated I, u : I − → I (as in 10.10) is the same as the I, u associated to G
and such that the corresponding Dynkin graph (for G′ ) is the same as that for G,
except possibly for the orientation of the double or triple edges. Then U(G′ (K))
is defined. Moreover we have a natural bijection

(a)                               U(G(K)) ↔ U(G′ (K)).

Indeed, each side of (a) is naturally in bijection with the disjoint union of the sets of
irreducible representations of a finite collection of affine Hecke algebras given by a
                                                       √
presentation of Iwahori-Matsumoto type at v = q. But the affine Hecke algebras
associated to the two sides of (a) are the same, since the recipe that describes
them is not sensitive to the orientation of the double or triple edges. (This is
analogous to the known statement that the sets of unipotent representations of
the finite groups SO2n+1 (Fq ) and Sp2n (Fq ) are in bijection.) Since 10.11, 10.12 are
applicable to U(G′ (K)), they also provide, via (a), a parametrization of U(G(K)).
   We describe the various pairs (G, G′ ) using the names in the tables of [T].
   (CBn , Cn ), (BCn , Bn ), (CBCn , Cn ), (GI2 , G2 ), (F4I , F4 ), (2 BCn , 2 Bn ), (2 CBn , 2 Cn ).
10.14. It is likely that our results can be extended to the case where the assump-
tion that G is adjoint simple is weakened to the assumption that G is semisimple.
Indeed, our main technique, that of reducing to the case of graded Hecke algebras
is still available in this more general case (see [L2]).

                                         11. Tables
11.1. In this section we list the various possibilities for Gϑ and J as in 7.4 as-
suming that d ≥ 2. (The cases where d = 1 are listed in [L4].) In each case we
describe the affine Dynkin graph associated to the affine Cartan matrix (ai1 ,i2 )
(resp. (′ ai1 ,i2 )) in 6.21; we call this the (γi )-graph (resp. the (βi )-graph). Both
these graphs have vertices in bijection with I. The vertices of the (βi )-graph that
are inside a box correspond to the subset J of I. The full subgraph with vertices
J is the Dynkin graph of GJ (see 6.23). We also describe the affine Dynkin graph
associated to the affine Cartan matrix (γ̂k (ĥk′ ))k,k′ ∈K . We call this the ♭ − ♯ dia-
gram; its vertices are in bijection with K and we attach to any vertex the symbol
♭ or ♯ according to whether the corresponding element of K is in K ♭ or K ♯ . For
any vertex correponding to k ∈ K we specify some data of the form a × b × c where
a = ck , b = z̄k , c = dk . From the ♭ − ♯ diagram one obtains an affine Hecke algebra
as in 8.2, 8.3. This affine Hecke algebra (in a presentation of Iwahori-Matsumoto
Classification of unipotent representations

type) is denoted by H.A. It turns out to be the same as the affine Hecke algebra
attached to the arithmetic diagram (see 10.11) which is also given in each case.
The notation for affine Hecke algebras follows the conventions of [L4, 6.9, 6.11].
11.2. G is of type An , n even, d = 2.
  a ∈ 4Z, b ∈ 1 + 4Z, n + 1 = 2s + 2 + a(a + 1)/2 + b(b + 1)/2, s ≥ 1.
  (γi )-graph:
           ⋆⇒⋆              ⋆       ⋆        ⋆              ⋆           ...         ⋆              ⋆       ⋆⇐⋆

(βi )-graph:
          ⋆ ⇒ ⋆ ⋆ ... ⋆           ⋆1         ⋆2             ⋆3              ...          ⋆s            ⋆ ... ⋆ ⋆ ⇒ ⋆
                 Cq                                                                                         Bp

                      6 2; here 2p+1 = (a+b+1)2 /4, 2q = (a−b−1)(a−b+1)/4;
if a−b 6= −1, |a+b+1| =
                      ⋆1 ⇒ ⋆2           ⋆3             ...             ⋆s           ⋆ ... ⋆ ⋆ ⇒ ⋆
                                                                                              Bp

                           6 2; here 2p + 1 = (a + b + 1)2 /4;
if a − b = −1, |a + b + 1| =
                 ⋆ ⇒ ⋆ ⋆ ... ⋆          ⋆1             ⋆2          ⋆3              ...         ⋆s−1 ⇐ ⋆s
                      Cq

if a − b 6= −1, |a + b + 1| = 2; here 2q = (a − b − 1)(a − b + 1)/4;
                                ⋆1 ⇒ ⋆2           ⋆3             ...          ⋆s−1 ⇒ ⋆s

if a − b = −1, |a + b + 1| = 2.
    For s ≥ 2, the ♭ − ♯-diagram is
                                                                                                         |a−b|×1×2
         ♭s|a+b+1|×1×2 ⇐ ♯s−1
                          2×1×2                    2×1×2
                                                  ♯s−2                  ...         ♯22×1×2 ⇒ ♭1

if a − b 6= −1, |a + b + 1| =
                            6 2;
                                                                                                           2× 12 ×2
           ♭s|a+b+1|×1×2 ⇐ ♯s−1
                            2×1×2                   2×1×2
                                                   ♯s−2                     ...          ♯22×1×2 ⇒ ♭1

if a − b = −1, |a + b + 1| =
                           6 2;
               2× 12 ×4      2×1×2            2×1×2                                                    |a−b|×1×2
            ♭s            ⇐ ♯s−1             ♯s−2                 ...             ♯22×1×2 ⇒ ♭1

if a − b 6= −1, |a + b + 1| = 2;
                 2× 12 ×4      2×1×2           2×1×2                                                    2× 12 ×2
               ♭s           ⇐ ♯s−1            ♯s−2                     ...         ♯22×1×2 ⇒ ♭1

if a − b = −1, |a + b + 1| = 2.
    For s = 1, the ♭ − ♯-diagram is ∅.
           sc
    H.A: C̃s−1 [|2a+1| 2|2b+1| ] if s ≥ 2 and ∅ if s = 1.
    Arithmetic diagram: Ãn , u2 = 1, u 6= 1, J of type Ap′ −1 × Aq ′ −1 (both compo-
nents are u-stable), p′ = a(a + 1)/2, q ′ = b(b + 1)/2.
44                                              G. LUSZTIG

11.3. G is of type An , n odd, d = 2.
  Either a ∈ 4Z, b ∈ 3 + 4Z or a ∈ 2 + 4Z, b ∈ 1 + 4Z.
  n + 1 = 2s + 2 + a(a + 1)/2 + b(b + 1)/2, s ≥ 1.
  (γi )-graph:
                             ⋆
                             |
                       ⋆     ⋆     ⋆    ...      ⋆ ⇒ ⋆
(βi )-graph:
             ⋆
             ⋆ ⋆ ... ⋆         ⋆1         ⋆2         ⋆3          ...           ⋆s           ⋆ ... ⋆ ⋆ ⇐ ⋆
             ⋆                                                                                   Cq
               Dp


if a − b 6= 1, a + b 6= −1; here 2p = (a + b + 1)2 /4, 2q = (a − b − 1)(a − b + 1)/4;
                   ⋆
                   ⋆ ⋆ ... ⋆         ⋆1         ⋆2          ⋆3           ...         ⋆s−1 ⇐ ⋆s
                   ⋆
                     Dp


if a − b = 1, a + b 6= −1; here 2p = (a + b + 1)2 /4;

                               ⋆1
                                |
                    ⋆2         ⋆3         ⋆4         ...          ⋆s            ⋆ ... ⋆ ⋆ ⇐ ⋆
                                                                                       Cq

if a − b 6= 1, a + b = −1; here 2q = (a − b − 1)(a − b + 1)/4;

                                    ⋆1
                                     |
                         ⋆2         ⋆3         ⋆4          ...          ⋆s−1        ⇐ ⋆s
if a − b = 1, a + b = −1.
    For s ≥ 2, the ♭ − ♯-diagram is
                                                                                                |a−b|×1×2
         ♭s|a+b+1|×1×2 ⇐ ♯s−1
                          2×1×2                  2×1×2
                                                ♯s−2              ...          ♯22×1×2 ⇒ ♭1

if a − b 6= 1, a + b 6= −1;
             |a+b+1|×1×2
             ♭1                ⇐ ♯22×1×2            ♯32×1×2            ...           2×1×2
                                                                                    ♯s−1   ⇒ ♭s2×1×1

if a − b = 1, a + b 6= −1;
         |a−b|×1×2               2×1×2               2×1×2
        ♯s               ⇐      ♯s−1                ♯s−2               ...          ♯32×1×2           ♯22×1×2
                                                                                        |
                                                                                     2×1×2
                                                                                    ♯1
Classification of unipotent representations

if a − b 6= 1, a + b = −1;
                                    2×1×2              2×1×2
          ♯s2×1×1         ⇐        ♯s−1               ♯s−2                  ...       ♯32×1×2          ♯22×1×2
                                                                                          |
                                                                                      ♯12×1×2
if a − b = 1, a + b = −1.
    For s = 1, the ♭ − ♯-diagram is ∅.
            sc
    H.A.: C̃s−1 [|2a+1| 2|2b+1| ] if s ≥ 2 and a + b 6= −1; C̃s−1 [|2a+1| 2|2b+1| ] if s ≥ 2
and a + b = −1; ∅ if s = 1.
    Arithmetic diagram: Ãn , u2 = 1, u 6= 1, J of type Ap′ −1 × Aq ′ −1 (both compo-
nents are u-stable), p′ = a(a + 1)/2, q ′ = b(b + 1)/2.
11.4. G is of type Dn , d = 2.
  a ≥ 1 odd; b ≥ 0 even; n + 1 = s + a2 + b2 , s ≥ 1.
  (γi )-graph:
           ⋆⇒⋆                 ⋆       ⋆         ⋆              ⋆           ...      ⋆         ⋆      ⋆⇐⋆

(βi )-graph:
          ⋆ ⇐ ⋆ ⋆ ... ⋆              ⋆1          ⋆2             ⋆3           ...          ⋆s       ⋆ ... ⋆ ⋆ ⇒ ⋆
                   Bp                                                                                   Bq

                      6 1; here 2p + 1 = (a + b)2 , 2q + 1 = (a − b)2 ;
if a + b 6= 1,|a − b| =
                    ⋆ ⇐ ⋆ ⋆ ... ⋆           ⋆1             ⋆2          ⋆3           ...        ⋆s−1 ⇒ ⋆s
                         Bp

if a + b 6= 1,|a − b| = 1; here 2p + 1 = (a + b)2 ;
                                   ⋆1 ⇐ ⋆2            ⋆3             ...          ⋆s−1 ⇒ ⋆s

if a + b = 1,|a − b| = 1.
    For s ≥ 2, the ♭ − ♯-diagram is
          2(a+b)×1×1
         ♭1                    ⇐ ♯22×1×1          ♯32×1×1                  ...       2×1×1
                                                                                    ♯s−1   ⇒ ♭2|a−b|×1×1
                                                                                              s

if a + b 6= 1,|a − b| =
                      6 1;
               2(a+b)×1×1                                                                             2× 12 ×2
              ♭1                   ⇐ ♯22×1×1           ♯32×1×1               ...       2×1×1
                                                                                      ♯s−1   ⇒ ♭s

if a + b 6= 1,|a − b| = 1;
                    2× 21 ×2      2×1×1            2×1×1                                           2× 12 ×2
                   ♭s          ⇐ ♯s−1             ♯s−2                     ...      ♯22×1×1 ⇒ ♭1

if a + b = 1,|a − b| = 1.
    For s = 1, the ♭ − ♯-diagram is ∅.
            sc
    H.A.: C̃s−1 [2a 12b ] if s ≥ 2 and ∅ if s = 1.
    Arithmetic diagram: D̃n , u : I −   → I has exactly n − 1 fixed points, J of type
Dp′ × Dq ′ (u acts non-trivially on Dp′ ), p′ = a2 , q ′ = b2 .
46                                                   G. LUSZTIG

11.5. G is of type Dn , d = 2.
  a ≥ 0, b ≥ 0, a = n + 1 mod 2, (b2 + b)/2 = n mod 2;
  n + 1 = 2a2 + (b2 + b)/2 − 1 + 2s, s ≥ 1.
  (γi )-graph:

             ⋆⇒⋆                 ⋆      ⋆        ⋆         ⋆         ...          ⋆          ⋆         ⋆⇐⋆

(βi )-graph:

  ⋆ ⇐ ⋆ ⋆ ... ⋆             ⋆1         ⋆        ⋆2         ⋆          ...          ⋆             ⋆s          ⋆ ... ⋆ ⋆ ⇒ ⋆
       Bp                                                                                                          Bq


if 2a + b 6= 1, |4a − 2b − 1| =
                              6 3; here
    2p + 1 = (2a + b)(2a + b + 1)/2, 2q + 1 = (2a − b)(2a − b − 1)/2;

                 ⋆ ⇐ ⋆ ⋆ ... ⋆             ⋆1        ⋆         ⋆2           ⋆          ...            ⋆ ⇒ ⋆s
                       Bp


if 2a + b 6= 1, |4a − 2b − 1| = 3; here 2p + 1 = (2a + b)(2a + b + 1)/2;

                              ⋆1 ⇐ ⋆            ⋆2         ⋆          ...          ⋆ ⇒ ⋆s

if 2a + b = 1, 2a − b = −1.
    For s ≥ 2, the ♭ − ♯-diagram is

      (4a+2b+1)×1×1                                                                               |4a−2b−1|× 12 ×2
     ♭1                       ⇐ ♯24×1×1          ♯34×1×1            ...           4×1×1
                                                                                 ♯s−1   ⇒ ♭s

if 2a + b 6= 1, |4a − 2b − 1| =
                              6 3;

            (4a+2b+1)×1×1                                                                               3× 12 ×2
            ♭1                       ⇐ ♯24×1×1           ♯34×1×1           ...          4×1×1
                                                                                       ♯s−1   ⇒ ♭s

if 2a + b 6= 1, |4a − 2b − 1| = 3;

                   3× 12 ×2                                                                       3× 12 ×2
                  ♭1          ⇐ ♯24×1×1          ♯34×1×1            ...           4×1×1
                                                                                 ♯s−1   ⇒ ♭s

if 2a + b = 1, 2a − b = −1.
    For s = 1, the ♭ − ♯-diagram is ∅.
            sc
    H.A.: C̃s−1 [4a 22b+1 ] if s ≥ 2 and ∅ if s = 1.
    Arithmetic diagram: D̃n , u : I −   → I has < n − 1 fixed points, J of type Dp′ ×
                       ′      2       2
Dp′ × Ar−1 where p = a , r = (b + b)/2.
Classification of unipotent representations

11.6. G is of type E6 , d = 2. (2 possible cuspidal local systems.)
  (γi )-graph:
                              ⋆    ⋆      ⋆⇒⋆       ⋆

(βi )-graph:
                                    ⋆     ⋆          ⋆1 ⇐ ⋆        ⋆

H.A.: ∅.
   Arithmetic diagram: Ẽ6 , u2 = 1, u 6= 1, J of type E6 (with two possible unipo-
tent cuspidal representations, one the dual of the other).
11.7. G is of type E6 , d = 2.
  (γi )-graph:
                              ⋆               ⋆       ⋆⇒⋆          ⋆

(βi )-graph:
                                    ⋆1         ⋆      ⋆⇐⋆          ⋆

H.A.: ∅.
   Arithmetic diagram: Ẽ6 , u2 = 1, u 6= 1, J of type E6 (with a self-dual unipotent
cuspidal representation).
11.8. G is of type E6 , d = 2.
  (γi )-graph:
                              ⋆               ⋆       ⋆⇒⋆          ⋆

(βi )-graph:
                                ⋆         ⋆1          ⋆ ⇐ ⋆2            ⋆

♭ − ♯-diagram:
                                                     ∞
                                         ♭14×1×2         ♭25×2×2
          ∞
H.A.: 1  9.
  Arithmetic diagram: Ẽ6 , u2 = 1, u 6= 1, J of type A5 .
11.9. G is of type E6 , d = 2.
  (γi )-graph:
                              ⋆               ⋆       ⋆⇒⋆          ⋆

(βi )-graph:
                                ⋆1        ⋆2         ⋆3 ⇐ ⋆4           ⋆5

♭ − ♯-diagram:

                   ♯12×1×2      ♯22×1×2            ♯32×1×2 ⇒ ♯42×1×1        ♯52×1×1
48                                         G. LUSZTIG

H.A.:
                                2          2⇐1        1     1

     Arithmetic diagram: Ẽ6 , u2 = 1, u 6= 1, J = ∅.
11.10. G is of type D4 , d = 3.
  (γi )-graph:
                                           ⋆     ⋆ ≡> ⋆

(βi )-graph:
                                       ⋆1         ⋆ <≡ ⋆

H.A.: ∅.
  Arithmetic diagram: D̃4 , u3 = 1, u 6= 1, J of type D4 .
11.11. G is of type D4 , d = 3.
  (γi )-graph:
                                           ⋆     ⋆ ≡> ⋆

(βi )-graph:
                                       ⋆         ⋆1 <≡ ⋆

H.A.: ∅.
   Arithmetic diagram: D̃4 , u3 = 1, u 6= 1, J of type D4 with a unipotent cuspidal
other than that in 11.10.
11.12. G is of type D4 , d = 3.
  (γi )-graph:
                                           ⋆     ⋆ ≡> ⋆

(βi )-graph:
                                       ⋆1        ⋆2 <≡ ⋆3

♭ − ♯-diagram:
                             ♯12×1×3           ♯22×1×3 ≡> ♯2×1×1

H.A.: 3 <≡ 1    1.
  Arithmetic diagram: D̃4 , u3 = 1, u 6= 1, J = ∅.

                         Appendix. Proof of Lemma 5.5
A.1. We may assume that g is simple. If L = g there is nothing to prove. If L is
a Cartan subalgebra, then h0 = 0 and there is nothing to prove. In the rest of the
proof we assume that L 6= g and L is not a Cartan subalgebra.
   Since t ⊕ Ch0 is a Cartan subalgebra of Z̃, it is enough to prove the following
statement:
Classification of unipotent representations

   (a) Let x, x′ ∈ t, z ∈ C be such that x + zh0 , x′ + zh0 are G-conjugate in g.
Then x, x′ are in the same W -orbit.
   If (a) holds for z = 1 then it also holds for any z 6= 0. (We replace x, x′ , z by
z −1 x, z −1 x′ , 1.) Thus it is enough to prove (a) for z ∈ {0, 1}.
   Let S = {x + ah0 ∈ t + Ch0 ; α(x) ≥ 0 ∀α ∈ Π}. As in 6.6 we see that S is a
fundamental domain for the action of W on t ⊕ Ch0 . Hence it is enough to prove
the following statement:
   Let x, x′ ∈ t, z ∈ {0, 1} be such that x + zh0 , x′ + zh0 belong to S and are
G-conjugate in g. Then x = x′ .
We consider the various cases separately.
   For a multiset X consisting of finitely many numbers in C we denoted by max X
the complex number x ∈ X such that x − x′ ≥ 0 for any x′ ∈ X.
A.2. Assume that g = slab (C), L = sla (C)b ⊕ Cb−1 . Here a > 1, b > 1. Let V be
a C-vector space with basis e1 , e2 , . . . , eab . We may assume that g = sl(V ). We
may assume that
   x(eai+l ) = xi eai+l , x′ (eP         ′
                                         i eai+l for i ∈ [0, b − 1], l ∈ [0, a − 1]
                               ai+l ) = xP
where xi , x′i ∈ C satisfy i xi = i x′i = 0 and xi − xi+1 ≥ 0, x′i − x′i+1 ≥ 0 for
i ∈ [0, b − 2] and that
   h0 (eai+l ) = (a − 1 − 2l)eai+l for i ∈ [0, b − 1], l ∈ [0, a − 1].
Since x + zh0 , x′ + xh0 are conjugate under SL(V ), they must have the same
eigenvalues in V . Thus, the multisets
   X = {xi +z(a−1−2l)}i∈[0,b−1],l∈[0,a−1], X ′ = {x′i +z(a−1−2l)}i∈[0,b−1],l∈[0,a−1]
coincide. Clearly, max X = x0 +z(a−1) and max X ′ = x′0 +z(a−1). Since X = X ′
we have x0 + z(a − 1) = x′0 + z(a − 1). Hence x0 = x′0 . Removing
   x0 + z(a − 1), x0 + z(a − 3), . . . , x0 + z(−a + 1)
   (resp. x′0 + z(a − 1), x′0 + z(a − 3), . . . , x′0 + z(−a + 1))
from X (resp. X ′ ) we obtain a multiset X1 (resp. X1′ ). We have X1 = X1′ .
Clearly, max X1 = x1 + z(a − 1) and max X1′ = x′1 + z(a − 1). Since X1 = X1′ we
have x1 + z(a − 1) = x′1 + z(a − 1). Hence x1 = x′1 . Continuing in this way we
find xi = x′i for i ∈ [0, b − 1]. Hence x = x′ .
A.3. Assume that g = sp2n+2p (C), L = sp2n (C) ⊕ Cp . Here n > 1, p > 1 and
n = (m2 + m)/2.
   Let V be a C-vector space with basis e1 , e2 , . . . , en+p , e′n+p , . . . , e′2 , e′1 and with
a symplectic form (, ) : V × V −         → C such that (ei , e′j ) = δij , (ei , ej ) = (e′i , e′j ) = 0
for i, j ∈ [1, n + p]. We may assume that g = sp(V ) and that
   x(ei ) = xi ei , x(e′i ) = −xi e′i , x′ (ei ) = x′i ei , x′ (e′i ) = −x′i e′i for i ∈ [1, p],
   x(ei ) = 0, x(e′i ) = 0, x′ (ei ) = 0, x′ (e′i ) = 0 for i ∈ [p + 1, p + n],
where xi , x′i ∈ C satisfy xi −xi+1 ≥ 0, x′i −x′i+1 ≥ 0 for i ∈ [1, p−1], xp ≥ 0, x′p ≥ 0.
We may also assume that
   h0 (ei ) = 0, h0 (e′i ) = 0 for i ∈ [1, p],
   h0 (ei ) = ci ei , h0 (e′i ) = −ci ei for i ∈ [p + 1, p + n]
where ci ∈ Z. Since x + zh0 , x′ + xh0 are conjugate under Sp(V ), they must have
50                                           G. LUSZTIG

the same eigenvalues in V . Thus, the multisets
   Y = {xi , −xi (i ∈ [1, p]), ci, −ci (i ∈ [p + 1, p + n])},
   Y ′ = {x′i , −x′i (i ∈ [1, p]), ci, −ci (i ∈ [p + 1, p + n])}
coincide. Removing {ci , −ci (i ∈ [p + 1, p + n])} from Y (resp. Y ′ ) we obtain a
multiset X (resp. X ′ ). We have X = X ′ . Clearly, max X = x1 and max X ′ = x′1 .
Since X = X ′ we have x1 = x′1 . Removing x1 (resp. x′1 ) from X (resp. X ′ ) we
obtain a multiset X1 (resp. X1′ ). We have X1 = X1′ . Clearly, max X1 = x2 and
max X1′ = x′2 . Since X1 = X1′ we have x2 = x′2 . Continuing in this way we find
xi = x′i for i ∈ [1, p]. Hence x = x′ .
A.4. Assume that g = son+2p (C), L = son (C) ⊕ Cp . Here n > 2, p > 1 and
n = m2 . This case is completely similar to that in A.3.
A.5. Assume that g = so2n+4p (C), L = so2n (C) ⊕ slp2 ⊕ Cp . Here n > 0, p > 0
and 2n = (m2 + m)/2.
     Let V be a C-vector space with basis e1 , e2 , . . . , en+2p , e′n+2p , . . . , e′2 , e′1 and
with a symmetric bilinear form (, ) : V × V −               → C such that (ei , e′j ) = δij , (ei , ej ) =
(e′i , e′j ) = 0 for i, j ∈ [1, n + 2p]. We may assume that g = so(V ) and that
     x(e2i−1 ) = xi e2i−1 , x(e2i ) = xi e2i−1 , x(e′2i−1 ) = −xi e2i−1 , x(e′2i ) = −xi e2i−1 ,
     x′ (e2i−1 ) = x′i e2i−1 , x′ (e2i ) = x′i e′2i−1 , x′ (e′2i−1 ) = −x′i e2i−1 , x′ (e′2i ) = −x′i e2i−1
for i ∈ [1, p],
     x(ei ) = 0, x(e′i ) = 0, x′ (ei ) = 0, x′ (e′i ) = 0 for i ∈ [2p + 1, 2p + n],
where xi , x′i ∈ C satisfy
     xi − xi+1 ≥ 0, x′i − x′i+1 ≥ 0 for i ∈ [1, p − 1], xp ≥ 0, x′p ≥ 0.
We may also assume that
     h0 (e2i−1 ) = e2i−1 , h0 (e2i ) = −e2i , h0 (e′2i−1 ) = −e2i−1 , h0 (e′2i ) = e2i
for i ∈ [1, p] and
     h0 (ei ) = ci ei , h0 (e′i ) = −ci ei for i ∈ [2p + 1, 2p + n]
where ci ∈ Z. Since x + zh0 , x′ + xh0 are conjugate under SO(V ), they must have
the same eigenvalues in V . Thus, the multisets
     Y = {xi + z, xi − z, −xi + z, −xi − z(i ∈ [1, p]), ci, −ci (i ∈ [2p + 1, 2p + n])},
     Y ′ = {x′i + z, x′i − z, −x′i + z, −x′i − z(i ∈ [1, p]), ci, −ci (i ∈ [2p + 1, 2p + n])}
coincide. Removing {ci , −ci (i ∈ [2p + 1, 2p + n])} from Y (resp. Y ′ ) we obtain a
multiset X (resp. X ′ ). We have X = X ′ .
     Clearly, max X = x1 + z and max X ′ = x′1 + z. Since X = X ′ we have
x1 + z = x′1 + z hence x1 = x′1 . Removing x1 + z, x1 − z, −x1 + z, −x1 − z (resp.
x′1 + z, x′1 − z, −x′1 + z, −x′1 − z) from X (resp. X ′ ) we obtain a multiset X1 (resp.
X1′ ). We have X1 = X1′ . Clearly, max X1 = x2 + z and max X1′ = x′2 + z. Since
X1 = X1′ we have x2 + z = x′2 + z hence x2 = x′2 . Continuing in this way we find
xi = x′i for i ∈ [1, p]. Hence x = x′ .
A.6. Assume that g = so2n+1+4p (C), L = so2n+1 (C)⊕slp2 ⊕Cp . Here n ≥ 0, p > 0,
2n + 1 = (m2 + m)/2. This case is completely similar to that in A.5.
A.7. Assume that g is of type E6 and L ∼    = sl3 (C)3 ⊕ C2 . We number the vertices
of the Coxeter diagram by 1, 2, . . . , 6 where the edges are 1 − 2 − 3 − 4 − 5 and
Classification of unipotent representations

3 − 6. For i ∈ [1, 6] define ui ∈ t by αj (ui ) = δij for all j ∈ [1, 6]. Then t is spanned
by u3 , u6 . We may assume that h0 = 2α̌1 + 2α̌2 + 2α̌4 + 2α̌5 .
    We have x = au3 + bu6 x′ = a′ u3 + b′ u6 where a, b, a′ , b′ ∈ C are ≥ 0. Let Y be
the multiset consisting of the numbers
    2a+b+2z, 2a+b, 2a+b−2z, a+b+2z, a+b, a+b−2z, a+2z, a, a−2z, 4z, 2z, 2z,
their negatives, and of 0, 0, 0. Let Y ′ be the multiset consisting of the numbers
    2a′ + b′ + 2z, 2a′ + b′ , 2a′ + b′ − 2z, a′ + b′ + 2z, a′ + b′ , a′ + b′ − 2z,
    a′ + 2z, a′ , a′ − 2z, 4z, 2z, 2z,
their negatives, and of 0, 0, 0. The eigenvalues of x + zh0 (resp. x′ + zh0 ) on a
minuscule g-module V are the 27 numbers in the multiset Y (resp. Y ′ ). Since
x + zh0 , x′ + zh0 are in the same G-orbit, they have the same eigenvalues on V .
Thus, Y = Y ′ .
    Removing 4z, 2z, 2z from Y (resp. Y ′ ) we obtain a multiset X (resp. X ′ ) with
24 elements. We have X = X ′ . Clearly, max X = 2a + b + 2z and max X ′ =
2a′ + b′ + 2z. It follows that
    (a) 2a + b + 2z = 2a′ + b′ + 2z.
Removing from X (resp. X ′ ) the numbers 2a + b + 2z, 2a + b, 2a + b − 2z (resp.
2a′ + b′ + 2z, 2a′ + b′ , 2a′ + b′ − 2z) we obtain a multiset X1 (resp. X1′ ). By (a),
we have X1 = X1′ . Clearly, max X1 = a + b + 2z and max X1′ = a′ + b′ + 2z. It
follows that
    (b) a + b + 2z = a′ + b′ + 2z.
From (a),(b) we deduce that a = a′ , b = b′ . Thus x = x′ as required.
A.8. Assume that g is of type E7 and L ∼         = sl2 (C)3 ⊕ C4 . We number the vertices
of the Coxeter diagram by 1, 2, . . . , 7 where the edges are 1 − 2 − 3 − 4 − 5 − 6
and 3 − 7. For i ∈ [1, 7] define ui ∈ t by αj (ui ) = δij for all j ∈ [1, 7]. Then t is
spanned by u1 , u2 , u3 , u5 . We may assume that h0 = α̌4 + cha6 + α̌7 .
    We have x = au1 + bu2 + cu3 + du5 x′ = a′ u1 + b′ u2 + c′ u3 + d′ u5 where
a, b, c, d, a′, b′ , c′ , d′ ∈ C are ≥ 0. Let Y be the multiset consisting of
a + 2b + 3c + 2d + z, a + 2b + 3c + 2d − z, a + 2b + 3c + d + z, a + 2b + 3c + d − z,
a + 2b + 2c + d + z, a + 2b + 2c + d − z, a + b + 2c + d + z, a + b + 2c + d − z,
a + b + c + d + z, a + b + c + d − z, b + 2c + d + z, b + 2c + d − z,
b + c + d + z, b + c + d − z, a + b + c + z, a + b + c − z,
c + d + z, c + d − z, b + c + z, b + c − z, d + z, d − z, c + z, c − z, 3z, z, z, z
and their negatives. Let Y ′ be the multiset obtained from Y by replacing a, b, c, d, z
by a′ , b′ , c′ , d′ , z.
   The eigenvalues of x +zh0 (resp. x′ +zh0 ) on the minuscule g-module V are the
56 numbers in the multiset Y (resp. Y ′ ). Since x + zh0 , x′ + zh0 are in the same
G-orbit, they have the same eigenvalues on V . Thus, Y = Y ′ . Removing 3z, z, z, z
from Y (resp. Y ′ ) we obtain a multiset X (resp. X ′ ) with 52 elements. We have
X = X ′ . Clearly, max X = a+2b+3c+2d+z and max X ′ = a′ +2b′ +3c′ +2d′ +z.
It follows that
52                                         G. LUSZTIG

   (a) a + 2b + 3c + 2d + z = a′ + 2b′ + 3c′ + 2d′ + z.
Removing from X (resp. X ′ ) the numbers a + 2b + 3c + 2d + z, a + 2b + 3c + 2d − z
(resp. a′ + 2b′ + 3c′ + 2d′ + z, a′ + 2b′ + 3c′ + 2d′ − z) we obtain a multiset X1
(resp. X1′ ). By (a), we have X1 = X1′ . Clearly, max X1 = a + 2b + 3c + d + z and
max X1′ = a′ + 2b′ + 3c′ + d′ + z. It follows that
   (b) a + 2b + 3c + d + z = a′ + 2b′ + 3c′ + d′ + z.
Removing from X1 (resp. X1′ ) the numbers a + 2b + 3c + d + z, a + 2b + 3c + d − z
(resp. a′ + 2b′ + 3c′ + d′ + z, a′ + 2b′ + 3c′ + d′ − z) we obtain a multiset X2 (resp.
X2′ ). By (b), we have X2 = X2′ . Clearly, max X2 = a + 2b + 2c + d + z and
max X2′ = a′ + 2b′ + 2c′ + d′ + z. It follows that
   (c) a + 2b + 2c + d + z = a′ + 2b′ + 2c′ + d′ + z.
Removing from X2 (resp. X2′ ) the numbers a + 2b + 2c + d + z, a + 2b + 2c + d − z
(resp. a′ + 2b′ + 2c′ + d′ + z, a′ + 2b′ + 2c′ + d′ − z) we obtain a multiset X3
(resp. X3′ ). By (c), we have X3 = X3′ . Clearly, max X3 = a + b + 2c + d + z and
max X3′ = a′ + b′ + 2c′ + d′ + z. It follows that
   (d) a + b + 2c + d + z = a′ + b′ + 2c′ + d′ + z.
From (a),(b),(c),(d) we deduce that a = a′ , b = b′ , c = c′ , d = d′ . Thus x = x′ as
required.
   Lemma 5.5 is proved.

                                          References
[K]     V. G. Kac, Automorphisms of finite order of semisimple Lie algebras, Funktional.Anal.i
        Prilozh. 3 (1969), 94-96.
[KL]    D. Kazhdan and G. Lusztig, Proof of the Deligne-Langlands conjecture for Hecke algebras,
        Inv.Math. 87 (1987), 153-215.
[L1]    G. Lusztig, Cuspidal local systems and graded Hecke algebras, Publ.Math. I.H.E.S. 67
        (1988), 145-202.
[L2]    G. Lusztig, Affine Hecke algebras and their graded version, Jour.Amer.Math.Soc. 2 (1989),
        599-635.
[L3]    G. Lusztig, Cuspidal local systems and graded Hecke algebras,II, Representations of groups,
        ed. B.Allison and G.Cliff, Canad.Math.Soc.Conf.Proc., vol. 16, Amer.Math.Soc., 1995,
        pp. 217-275.
[L4]    G. Lusztig, Classification of unipotent representations of simple p-adic groups, Int. Math.
        Res. Not. (1995), 517-589.
[L5]    G. Lusztig, Cuspidal local systems and graded Hecke algebras,III (2001), preprint.
[R]     M. Reeder, Formal degrees and L-packets of unipotent discrete series of exceptional p-adic
        groups, J.Reine Angew.Math. 520 (2000), 37-93.
[S]     G. Segal, The representation ring of a compact Lie group, Publ.Math. I.H.E.S. 34 (1968),
        113-128.
[T]     J. Tits, Reductive groups over local fields, Automorphic forms, representations and L-
        functions, Proc.Symp.Pure Math., vol. 33, Amer.Math.Soc., 1979, pp. 29-69.
[W]     J.-L. Waldspurger, Représentations de réduction unipotente pour SO(2n + 1): quelques
        conséquences d’un article de Lusztig (2001), preprint.

      Department of Mathematics, M.I.T., Cambridge, MA 02139
