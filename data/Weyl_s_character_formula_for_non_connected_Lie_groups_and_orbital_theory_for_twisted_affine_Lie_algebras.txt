                                             Weyl’s character formula for non-connected Lie
arXiv:math/9909059v1 [math.RT] 10 Sep 1999




                                             groups and orbital theory for twisted affine Lie
                                                                 algebras
                                                                            Robert Wendt
                                                                          February 20, 2018


                                                                                 Abstract
                                                   We generalize I. Frenkel’s orbital theory for non twisted affine Lie
                                               algebras to the case of twisted affine Lie algebras using a character formula
                                               for certain non-connected compact Lie groups.


                                               1     Introduction
                                               In [4], Frenkel develops a generalization of Kirillov’s orbit theory for finite
                                               dimensional Lie groups [10] in the case of untwisted affine Lie algebras.
                                               In particular, he classifies affine (co-)adjoint orbits of the underlying loop
                                               groups in terms of conjugacy classes of connected compact Lie groups.
                                               Using this classification and the theory of Wiener Integration on compact
                                               Lie groups, Frenkel obtains an interpretation of the character of a high-
                                               est weight representation as an integral over an associated orbit in the
                                               coadjoint representation.
                                                   The aim of this paper is to generalize Frenkel’s orbital theory to the
                                               case of twisted affine Lie algebras. Kleinfeld ([11]) already made a first
                                               step towards the adaptation of Frenkel’s theory to this more general case,
                                               but he was unable to interpret the character formula as an orbital integral.
                                               In order to obtain an interpretation of the formulas as orbital integrals
                                               we shall introduce certain non-connected compact Lie groups, so called
                                               principal extensions, into the geometrical picture. It turns out that the
                                               affine orbits of the adjoint representation of a twisted loop group are
                                               parametrized by the conjugacy classes in the ”outer component” of such
                                               a group. With this result and a character formula for non-connected Lie
                                               groups at hand we are able to translate Frenkel’s program to the twisted
                                               case. I now give a brief description of the contents of this paper.
                                                   §2 contains some facts about non-connected compact Lie groups, some
                                               of them well known. After constructing the principal extension G̃ of a
                                               semisimple compact group G, we derive an analogue of the Weyl charac-
                                               ter formula for the connected components of G̃ not containing the identity.
                                               The proof of this formula involves an analogue of the Weyl integral for-
                                               mula for G-invariant functions on G̃, and the character itself is governed


                                                                                     1
by the dual of a certain “folded” root system. That is, if R is the root
system of G and τ is a diagram automorphism of R then τ acts as an
outer automorphism on G, and the characters on the connected compo-
nents of G̃ are governed by the root system Rτ ∨ , the dual to the ”folded”
root system Rτ of the fixed point group Gτ . It is worthwhile to note that
no group belonging to the root system Rτ ∨ can, in general at least, not
be realized as a subgroup of G in contrast to Gτ . The group G acting
on G̃ by conjugation, we shall view each connected component of G̃ as
a G-manifold. As another direct application of the integral formula, we
compute the radial component of the Laplacian on the connected compo-
nents of G̃ with respect to that G-action.
     In §3, we study affine orbits of the adjoint representation of a twisted
loop group L(G, τ ). By a slight alteration of Frenkel’s original methods
we see that for G compact, every such orbit contains a constant loop and
the orbits in certain affine ”shells” are parametrized by the G-orbits in
the connected component of G̃ containing τ . To be more precise and
using different terminology, Frenkel regards a loop into the Lie algebra g
as a connection on a principal, trivial fibre bundle over the circle S 1 with
structure group G and he associates to this loop the monodromy of this
connection which is an element of G. The action of L(G) on an affine
shell in the affine Lie algebra is then given by gauge transformations and
it is compatible with the G-conjugation on the monodromies in G. That
way he obtains a well defined bijection from the adjoint orbits of L(G) (of
some fixed affine shell) to the set of conjugacy classes in G. In the case
of a twisted loop group L(G, τ ) where τ is a diagram automorphism of G
the corresponding map will neither be surjective nor injective (cf. [11]).
In this case, it is appropriate to replace the monodromy with the “ 1r -th
monodromy” (i.e. ”monodromy” after r1 -th of the full circle) multiplied by
τ . Here r is the order of τ . The gauge action of L(G, τ ) is then compatible
with conjugation in the component Gτ , and we are able to classify the
affine adjoint orbits of L(G, τ ) in terms of conjugacy classes in Gτ .
     In §4, we use the theory of Wiener integration on a non-connected
compact Lie group to rewrite the irreducible highest weight characters of
a twisted affine Lie algebra as an integral over the space of paths inside
the connected component of G̃ containing the element τ . After a brief
summary of some results about affine Lie algebras and their representa-
tions in §4.1, we shall show in §4.2 and in §4.3 how the irreducible highest
weight characters of a twisted affine Lie algebra are linked to the fun-
damental solution of the heat equation on a non-connected compact Lie
group. At this point, the characters on the connected component Gτ en-
ter the picture. The fundamental solution of the heat equation is used in
§4.4 to define the Wiener measure on the space of paths in the connected
component of a compact Lie group. Computing a certain integral with
respect to this measure, we can rewrite the affine characters as an integral
over a path space. In §4.5 we then show, adopting the original procedure
of [4], how this integral can be interpreted as an integral over a coadjoint
orbit of the corresponding twisted loop group thus completing Frenkel’s
program for twisted affine algebras as well.




                                      2
2 Integration and character formulas for
non-connected Lie groups
2.1    Principal extensions and conjugacy classes
Let G be a simply connected semisimple compact Lie group, T a maximal
torus in G, and R the root system of G with respect to T . If W is the
Weyl group of R (and G) and Γ is the group of diagram automorphisms
of the Dynkin diagram of G then we have Aut(R) = W ⋊ Γ. Every τ ∈ Γ
can be lifted to an automorphism of G in the following way. Let Π be
a basis of R. If g is the Lie algebra of G and gC its complexification,
we choose a set {eα , fα , hα }α∈Π of Chevalley generators of gC and set
τ (eα ) = eτ (α) . This extends to a Lie algebra automorphism of gC which
leaves g invariant. Since we chose G to be simply connected, τ can again
be lifted to an automorphism of G leaving T invariant. Thus we have
defined a homomorphism ϕ : Γ → Aut(G), and we can set G̃ = G ⋊ϕ Γ,
and call G̃ the principal extension of G. Obviously we have G̃/G = Γ.
     If G is not simply connected we have G = Ḡ/K, where Ḡ denotes
the universal covering group of G, and K is some subgroup of the center
of Ḡ. Let ΓK be the subgroup of Γ which leaves K fixed. Then the
group G ⋊ϕ ΓK is called the principal extension of G. The principal
extensions of compact Lie groups are, in general, central extensions of the
automorphism groups of the compact groups and play a crucial role in the
structure theory of the non-connected compact groups (cf. [17]).
     G acts on the components of G̃ by conjugation. The orbits of this
action on the component Gτ , the connected component of G̃ containing
τ , are parametrized by a component of the space S/W (S), where S is a
Cartan subgroup of G̃ in the sense of [2] such that τ ∈ S. That is in
our cases S = T τ × hτ i where T τ is the connected component containing
the identity of the τ -invariant part of the maximal torus T . The group
W (S) = N (S)/S is a finite group and is called the Weyl group belonging
to S. In particular, if S0 = T τ is the connected component of S containing
e, then every element of Gτ is conjugate under G to an element of S0 τ ,
and two elements of S0 τ are conjugate under G if and only if they are
conjugate in N (S). Furthermore, S0 is regular in G, i.e. there is a unique
τ -invariant maximal torus of G containing S0 , cf. e.g. [2].


2.2    A ’Weyl integral formula’ for Gτ
Let G be a connected semisimple Lie group of type An , Dn , or E6 and
G̃ its principal extension. Since the other connected Dynkin diagrams
do not admit any diagram automorphisms, the principal extensions of
the corresponding compact Lie groups are trivial. We want to derive an
analogue of the Weyl integral formula for G-invariant functions on the
component Gτ of G̃. Let S ⊂ G̃ be a Cartan subgroup of G containing τ
such that S/S0 is generated by S0 τ , and let (., .) be the negative of the
Killing form on g. Since G is semisimple, this gives an Ad(G) invariant
scalar product on g, and g decomposes into a direct sum g = LT ⊕L(G/T ),
where LT is the Lie algebra of T and L(G/T ) its orthogonal complement.


                                    3
    In the same way, LT decomposes into LT = LS0 ⊕ L(T /S0 ), hence we
    have g = LS0 ⊕ L(T /S0 ) ⊕ L(G/T ).
         There are normalized left invariant volume forms d(gS0 ), ds, and dg
    on G/S0 , S0 and G which are unique up to sign (i.e. orientation). The
    form dg defines a volume form on Gτ by right translation with τ , which
    will be called dg as well. Hence, on G, we have |ΓK | · dg̃ = dg, where dg̃
    is the normalized left invariant volume form on G̃.
         The projection π : G → G/S0 induces a map Dπ : g → TeS0 G/S0
    which maps L(G/S0 ) := L(G/T )⊕L(T /S0 ) isomorphically to the tangent
    space of G/S0 at the point eS0 . Hence we can identify these spaces via Dπ.
    Let n = dim G and k = dim S0 . Then π ∗ d(gS0 ) is a left invariant (n − k)-
    form on G. Using the k-form dse ∈ Altk (LS0 ) we get pr∗2 dse ∈ Altk g
    where pr2 : g = L(G/S0 ) ⊕ LS0 → LS0 is the second projection. The
    form pr∗2 dse defines a left-invariant k-form β on G by left translation, so
    π ∗ d(gS0 ) ∧ β is a volume form on G. Hence we have π ∗ d(gS0 ) ∧ β = cdg.
    We may chose the signs so that c > 0, and it is not hard to see that in
    this case c = 1 (cf. [2]).
         There is a volume form α = pr∗1 d(gS0 ) ∧ pr∗2 ds on G/S0 × S0 . Identify-
    ing g with L(G/S0 ) ⊕ LS0 and evaluating the forms at the unit element,
    one finds α(eS0 ,e) = dg(e) .
         Since every element of Gτ is conjugate under G to an element of S0 τ ,
    the map
                                  q : G/S0 × S0 → Gτ,
                                       (gS0 , s) 7→ gsτ g −1
    is surjective, and by the above we get q ∗ dg = det(q)α.

    Lemma 2.1 The functional determinant of the conjugation map q is
    given by

                   det(q)(gS0 , s) = det(Ad|L(G/S0 ) (sτ )−1 − I|L(G/S0 ) ).
                                                                      1
    Proof:        Similar to the proof of Prop. IV, 1.8 in [2].                 



    Lemma 2.2 Let z be a generator of S. Then
        (i) |q −1 (z)| = |W (S)|.
        (ii) For (g1 S0 , s1 ), (g2 S0 , s2 ) ∈ q −1 (z) we have

                                det(q)(g1 S0 , s1 ) = det(q)(g2 S0 , s2 ).

    (iii) There exists a generator z of S such that q is regular in each
          (gS0 , s) ∈ q −1 (z).

    Proof:        Similar to the proof of Prop. IV, 1.9 in [2].                 

       From this we obtain the mapping degree of q, deg(q) = sign(det(q)) ·
    |W (S)|. Thus using Fubini’s theorem, one gets
1 For   more details on the proofs in this section see [18]


                                                 4
Proposition 2.3 Let f : Gτ → R be a G-invariant function.Then
Z                       Z
                 1
     f (g)dg =        ·   f (sτ ) · | det(Ad|L(G/S0 ) (sτ )−1 − I|L(G/S0 ) )|ds.
  Gτ           |W (S)| S0

    In order to obtain an analogue of the classical Weyl integral formula,
one has to calculate the functional determinant of q in terms of the root
system of G. We adapt the notation used in [2]. That is, if α ∈ LT ∗
is an infinitesimal root of G, then ϑα denotes the corresponding global
root T → S 1 . So for H ∈ LT one has ϑα ◦ exp(H) = e2πiα(H) . Setting
e(x) = e2πix , we get ϑα = e(α).
    Now we consider the action of (Ad(sτ ) − I) on L(G/S0 )C = C ⊗
L(G/S0 ). As before, L(G/S0 )C decomposes into two orthogonal subspaces
L(G/S0 )C = L(T /S0 )C ⊕ L(G/T )C . Let X ∈ L(T /S0 ) be an eigenvector
of Ad(τ ). A short calculation shows

                         (Ad(sτ ) − I)(X) = −X + γX,

where γ = ±1 if τ 2 = e, and γ is a third root of unity if τ 3 = e. We can
choose (gS0 , s) to be a regular point of q, so γ 6= 1 and (Ad(sτ ) − I)(X) =
−2X if t2 = e, and (Ad(sτ ) − I)(X) = (γ − 1)X if τ 3 = e.
   Now L(G/T )C decomposes into the direct sum of root spaces
                                          M
                             L(G/T )C =        Lα ,
                                            α∈R

and for X ∈ Lα , s ∈ S0 , one has

                            Ad(s)(X) = ϑα (s)(X).

    Let ᾱ = α|LS0 for α ∈ R. It is a well known fact that the set
Rτ = {ᾱ|α ∈ R} is a (not necessarily reduced) root system. The re-
lation between the type of R and the type of Rτ is shown in the following
table:

                 R        A2n−1   A2n       Dn (n ≥ 4)   D4   E6
               ord(τ )      2      2            2        3    2
                 Rτ        Cn     BCn         Bn−1       G2   F4
    So if R is of type A2n−1 , Dn , or E6 , then Rτ is a reduced root system.
It is easy to see that in this case, ᾱ is a long root of Rτ if and only if
τ (α) = α. Otherwise ᾱ is a short root of Rτ . If R is of type A2n , then
the root system Rτ is not reduced and three distinct root lengths occur.
In this case, ᾱ is a long root in Rτ if α is invariant under τ . If α and τ (α)
are orthogonal to each other, then ᾱ is a root of medium length in Rτ ,
and otherwise ᾱ is a short root in Rτ . (Remember that the root system
BCn is the union of two root systems of types Bn and Cn such that the
long roots of Bn coincide with the short roots of Cn .)
    Now let G be of type A2n−1 , Dn , or E6 , and consider the case τ 2 = e.
We have seen that τ defines a Lie algebra automorphism via τ (Xα ) =
Xτ (α) for α ∈ Π and Xα ∈ Lα . Extending this to the entire Lie algebra,
one gets τ (Xα ) = Xτ (α) for all α ∈ R. The eigenvectors of Ad(τ ) are
the following: If α is invariant under τ then Xα is an eigenvector with


                                        5
eigenvalue 1. If α is not invariant under τ , there are two eigenvectors
Xα ± Xτ (α) of eigenvalue ±1. Thus for τ (α) = α and X = Xα we have
                   (Ad(sτ )−1 − I)(X) = (ϑᾱ (s−1 ) − 1)X,
and
                  (Ad(sτ )−1 − I)(X) = (±ϑᾱ (s−1 ) − 1)X
for τ (α) 6= α and X = Xα ± Xτ (α) respectively. This yields

   det(Ad|L(G/S0 ) (sτ )−1 − I|L(G/S0 ) ) =
                                       Y
                    (−2)dim(T /S0 ) ·       (ϑᾱ (s−1 ) − 1)
                                               ᾱ∈Rτ
                                              τ (α)=α
                                                    Y
                                              ·              (ϑᾱ (s−1 ) − 1)(−ϑᾱ (s−1 ) − 1)
                                                   ᾱ∈Rτ
                                                  τ (α)6=α


Multiplying each factor by −1, using the remark above on the relative
length of the ᾱ as well as the equality
                         (1 − ϑᾱ )(1 + ϑᾱ ) = (1 − ϑ2ᾱ ),
this becomes
                                  Y                                Y
         = (−2)dim(T /S0 ) ·               (1 − ϑᾱ (s−1 ))                 (1 − ϑ2̄α (s−1 ))
                                 ᾱ∈Rτ                            ᾱ∈Rτ
                                 ᾱ long                          ᾱshort


         = (−2)   dim(T /S0 )
                                · ∆(s   −1    ¯
                                             )∆(s     −1
                                                           ),
with                                         Y
                             ∆(s) =                   (1 − ϑᾱ (s)).
                                           ᾱ∈Rτ
                                               +
                                                 ∨


Here Rτ ∨ denotes the dual root system of Rτ which is given by ᾱ∨ = hᾱ,  2ᾱ
                                                                             ᾱi
          τ
for ᾱ ∈ R and h., .i is a multiple of the Killing form such that hᾱ, ᾱi = 2
for a long root ᾱ ∈ Rτ .
   If G is of type D4 and τ 3 = e, a similar calculation gives
                                                           ¯ −1 ),
         det(Ad|L(G/S ) (sτ )−1 − I|L(G/S ) ) = 3 · ∆(s−1 )∆(s
                         0                                 0

with ∆(s) as above. Observe that in this case Rτ is of type G2 , so
dim T /S0 = 2.
   If G is of type A2n we have to be more careful since Rτ is not reduced
and three different root lengths occur. Also, in this case the Lie algebra
automorphism τ is slightly more complicated. For Xα ∈ Lα we have
                             τ (Xα ) = (−1)1+ht(α) Xτ (α) .
Now τ (α) = α implies that ht(α) is even and a similar calculation yields

   det(Ad|L(G/S0 ) (sτ )−1 − I|L(G/S0 ) ) =
                          Y                                       Y
        (−2)dim(T /S0 ) ·     (1 + ϑᾱ (s−1 )) ·                            (1 − ϑ2ᾱ (s−1 ))
                             ᾱ∈Rτ                                ᾱ∈Rτ
                             ᾱ long                            ᾱ middle
                                                                             Y
                                                                       ·               (1 − ϑ2ᾱ (s−1 ))
                                                                             ᾱ∈Rτ
                                                                            ᾱ short




                                                  6
But the length of the long roots in BCn is twice the length of the short
roots. So we can put these together to obtain
                                                                    ¯ −1 ),
  det(Ad|L(G/S0 ) (sτ )−1 − I|L(G/S0 ) ) = (−2)dim(T /S0 ) · ∆(s−1 )∆(s

with                                    Y
                            ∆(s) =             (1 − ϑᾱ (s)).
                                       ᾱ∈R1
                                           +

Here R1 = {2ᾱ|ᾱ ∈ BCn , ᾱ long} ∪ {2ᾱ|ᾱ ∈ BCn , ᾱ middle}. This is a
root system of type Cn .
    Before stating the integral formula for Gτ , we have to compare the
different Weyl groups involved. Let T be the maximal torus of G such
that S0 ⊂ T and let W (T ) = NG (T )/T be the usual Weyl group of G. If
we set W τ = {w ∈ W (T )|τ wτ −1 = w}, then W τ is the Weyl group of the
root system Rτ (and also of course of its dual Rτ ∨ ).

Proposition 2.4 Let W τ be as above. Then
 (i) There exists a split exact sequence

                           e → (T /S0 )τ → W (S) → W τ → e.

       Here (T /S0 )τ denotes the fixed point set under conjugation with τ .
 (ii) We have
                              (
                       τ
                                       1
                                  2dim(T /S0 )
                                               ·   |W (S)|      if τ 2 = e
                   |W | =         1
                                  3
                                    · |W (S)|                   if τ 3 = e

Proof: Observe that in our cases we have W (S) = (N (S) ∩ G)/G (this
is not true for general non-connected Lie groups), so one can define a map
ϕ : W (S) → W (T ), gS0 7→ gT . This map is well defined and one has
Im(ϕ) ⊂ W τ . The rest is done by a calculation in the Lie algebra of T .
For details see [18] (also cf. 3.8). To see that the sequence splits, observe
that S0 is by construction a maximal torus in the connected component
of Gτ containing e, and W τ is the corresponding Weyl group.               

   Putting everything together, one gets

Theorem 2.5 (’Weyl integral formula’ for Gτ ) Let f : Gτ → R be
a function which is integrable and invariant under conjugation by G. Then
                Z                     Z
                                  1                  ¯
                     f (g)dg =            f (sτ )∆(s)∆(s)ds,
                  Gτ            |W τ | S0

with                                    Y
                            ∆(s) =             (1 − ϑᾱ (s)).
                                       ᾱ∈R1
                                           +

Here R1 denotes the root system Rτ ∨ if Rτ is reduced and R1 = {2ᾱ|ᾱ ∈
BCn , ᾱ long} ∪ {2ᾱ|ᾱ ∈ BCn , ᾱ middle} is of type Cn if R is of type A2n .


                                            7
2.3     Applications of the integral formula
Let G be a compact connected semisimple Lie group of type An , Dn ,
or E6 as above, and let Ḡ ⊂ G̃ be any non trivial subextension of G.
As a first application of the integral formula we compute the irreducible
characters of Ḡ on the component Gτ for τ ∈ Γ. Let T be the τ -invariant
maximal torus of G, and let S be a Cartan subgroup of G such that S/S0
is generated by τ S0 . In the case D4 , this notation is not quite unique
since in general more than one diagram automorphism occurs, but it will
always be clear which respective Cartan subgroup is being used at the
moment.
    Since S0 is regular in G, we can choose a Weyl chamber K ⊂ LT ∗
such that K ∩ LS0∗ is not empty and we let K̄ denote its closure. Then
the set K τ = K ∩ LS0∗ is a Weyl chamber in LS0∗ with respect to the root
system Rτ . Furthermore, let W = W (T ) be the Weyl group of G, let I
denote the lattice I = ker(exp) ∩ LT , and I ∗ ⊂ LT ∗ its dual.
    For linear forms λ ∈ LT ∗ and µ ∈ LS0∗ we define the alternating sums
                                  X
                        A(λ) =          ǫ(w) · e(wλ)
                                w∈W (T )

and                                 X
                        Aτ (µ) =             ǫ(w) · e(wµ)
                                   w∈W τ

respectively. Here we have set ǫ(w) = (−1)length(w) . Note that for w ∈ W τ
the two ǫ(w) in the equations above do not necessarily coincide since they
come from the presentations of w as an element of two different Weyl
groups. In this notation, Aτ is a complex valued function on LS0 which
is alternating with respect to W τ .
    Now let R1 be the root system used in Theorem 2.5. As usual, we set
                                       1 X
                               ρ=            α,
                                       2 α∈R
                                               +


and
                                       1 X
                              ρτ =          ᾱ.
                                       2  1
                                         ᾱ∈R+

Now we can define functions δ : LT → C, resp. δ τ : LS0 → C via
                                 Y
                     δ = e(ρ) ·     (1 − e(−α))
                                   α∈R+


and                                     Y
                      δ τ = e(ρτ ) ·           (1 − e(−ᾱ)).
                                       ᾱ∈R1
                                           +

The function δ τ · δ̄ τ factorizes through exp, and we have δ τ · δ̄ τ = (∆ ·
¯ ◦ exp, where ∆ is as in Theorem 2.5. With this notation the classical
∆)
Weyl character formula for the irreducible character χλ of G belonging to
the highest weight λ ∈ I ∗ ∩ K̄ reads

                             χλ = A(λ + ρ)/δ.


                                         8
    Now if µ ∈ I ∗ ∩ LS0∗ then Aτ (µ + ρτ )/δ τ can be extended uniquely
to a function on LS0 . This function factors through exp (cf. [2]). In this
way Aτ (µ + ρτ )/δ τ can be considered as a function on S0 .
    For an arbitrary character χ of Ḡ we define the function χτ : S0 → C
via χτ (s) = χ(sτ ). So on the connected component Gτ of Ḡ, the character
χ is determined by χτ . Now we can state the analogue of the Weyl
character formula for the subextensions Ḡ ⊂ G̃. First we consider the
case when Ḡ consists of two connected components. So only one diagram
automorphism τ is involved, and τ 2 = e.

Theorem 2.6 There exists an irreducible character χ̃λ of Ḡ for each λ ∈
I ∗ ∩ K̄. If λ 6∈ LS0∗ , then

                             χ̃λ |G = χλ + χτ (λ) ,

and
                                 χλ |Gτ ≡ 0.
Here χλ denotes the irreducible character of G of highest weight λ
    For each λ ∈ LS0∗ , there exist two irreducible characters of Ḡ associated
to λ, and we have
                                  χ̃λ |G = χλ ,
and
                           χ̃τλ = ±Aτ (µ + ρτ )/δ τ .

If Ḡ consists of three connected components, the character formula is
essentially the same, except that there are three irreducible characters
for each λ ∈ LS0∗ . If G is of type D4 and Ḡ = G̃, then one can use
the character formulas above together with some information about the
conjugacy classes in S3 to determine all irreducible characters. Since this
will not be needed in the sequel, we will omit the statement of the result.
    Remarks on the proof: The proof of theorem 2.6 is essentially
the same as the proof of the classical Weyl character formula in [2]. The
integral formula is used along with the orthogonality relations for irre-
ducible characters to show that the irreducible characters of Ḡ must have
the given form. Then one can apply the Peter-Weyl theorem to see that
each of the functions above must be an irreducible character of Ḡ. For
more details on this see [18].                                          

Remark 2.7 Kostant [12] states a character formula for non-connected
complex Lie groups which is not quite as explicit as theorem 2.6. In
particular, he gives the character on the component Gτ as a function on
T τ , where T is a maximal torus in G. So the different root systems do
not appear explicitly (although it is not hard to derive theorem 2.6 from
his formula).
     The formula itself was discovered before by Jantzen [8], who calcu-
lated the trace of the outer automorphism τ on the weight spaces of an
irreducible representation with invariant highest weight of a semisimple
algebraic group, and by Fuchs et al. [5] who studied the characters of
“τ -twisted” representations of a generalized Kac-Moody algebra.


                                       9
      As in the classical case, there is a Weyl denominator formula:

      Corollary 2.8 With the same notation as above we have

                                       δ τ = Aτ (ρτ ).


      Remark 2.9 It is interesting to note that the group belonging to the
      root system R1 can, in general, not be realized as a subgroup of G. For
      example, SO(2n + 1), or its covering group Spin(2n + 1), which are the
      groups with root system Bn can not be realized as subgroup of SU (2n)
      which belongs to the root system A2n−1 .

          As a second application of theorem 2.5 we can derive a formula for
      the radial part of the Laplacian on Gτ with respect to the G-action by
      conjugation. The negative of the Killing form on gC defines a positive
      definite scalar product on g which defines a biinvariant Riemannian metric
      on G by left translation. We can use right multiplication by τ −1 to pull
      back this Riemannian metric to Gτ . So G and Gτ are isomorphic as
      Riemannian manifolds. This metric is invariant under the G-action on
      Gτ . Let ∆Gτ be the Laplacian on Gτ with respect to this metric, and let
      ∆S0 be the Laplacian on S0 . Now we can use the general theory of radial
      parts of invariant differential operators [6] Part III, Theorem 3.7 (also cf.
      Prop. 3.12) to get the following Proposition.

      Proposition 2.10 Let f : Gτ → R be a G-invariant function, and f τ :
      G → R be given by f τ (g) = f (gτ ). Let δ τ and ρτ be as above. Then we
      have
                      δ τ · ∆Gτ (f ) = (∆S0 + kρτ k2 )(δ τ · f τ ),
      as functions restricted to LS0 . Here k.k is the metric on LS0∗ induced by
      the negative of the Killing form.


      3 The affine adjoint representation of a
      twisted loop group
      3.1      Affine Lie algebras
      Let gC be a complex semi simple Lie algebra, with compact involution ω
      and let g be a compact form of gC . That is, ig = {x ∈ gC | ω(x) = x}.
      The loop algebra LgC (resp. Lg) is the algebra of C ∞ -maps from S 1 to
      gC (resp. g). It is a Lie algebra under pointwise Lie bracket. If gC is a
      complex simple Lie algebra of type Xn and if the circle S 1 is parametrized
      by the real line R via the exponential e(t) = e2πit then the untwisted affine
                                  (1)
      Lie algebra2 g̃C of type Xn is given by

                                  g̃C = LgC ⊕ CC ⊕ CD,
  2 We  shall adhere to some slight abuse of terminology, here and in the sequel. The affine
algebras in the sense of [9] are based on algebraic loops, with finite Fourier expansion. Our
algebras may be viewed as completions of these algebraic ones, cf. below. The notation for
types will be that of [9].


                                             10
with Lie bracket

  [x(·) + aC + bD, x1 (·) + a1 C + b1 D]
                                 = [x, x1 ](·) + bx′1 (·) − b1 x′ (·) + (x′ (·), x1 (·))C.
                dx(t)
Here x′ (t) =    dt
                      ,   [x, x1 ](t) = [x(t), x1 (t)], and
                                             Z 1
                            (x(·), x1 (·)) =     (x(t), x1 (t))dt,
                                                   0

where (., .) under the integral sign denotes the Killing form on gC .
   An invariant bilinear form (., .) on g̃ is given by
                                            Z 1
  (x(·) + aC + bD, x1 (·) + a1 b + b1 D) =      (x(t), x1 (t))dt + ab1 + a1 b.
                                                             0

   We obtain a so-called compact form g̃ of g̃C by considering g̃ = Lg ⊕
RC ⊕ RD.
   If τ is the outer automorphism of gC considered in §2.1 and ord(τ ) = r,
then the twisted loop algebras L(gC , τ ) and L(g, τ ) are given by
      L(g(C) , τ ) = {x ∈ Lg(C) |τ (x(t)) = x(t + 1/r), for all t ∈ [0, 1]}.
Now if gC is a simple Lie algebra of type Xn with Xn = An , Dn or E6 ,
                                                 (r)
then the twisted affine Lie algebra g̃C of type Xn is given by
                               g̃C = L(gC , τ ) ⊕ CC ⊕ CD
with the same Lie bracket as above. The invariant bilinear form (., .) on
the corresponding untwisted affine Lie algebra yields an invariant bilinear
form on the twisted affine Lie algebra g̃C by restriction and it is denoted
by the same symbol. The compact form g̃ of a twisted affine Lie algebra
is obtained in the same way as in the untwisted case.
    We now define the C ∞ -topology on the Lie algebras g̃. The topology
on g̃C is obtained by viewing it as a direct sum of two copies of g̃. If Lg
is an untwisted loop algebra, one defines the C ∞ -topology on Lg via the
set of semi-norms
                                      ds x(t)
                pn (x) = sup |                |,       n = 1, 2, . . . ,   x ∈ Lg.
                             s≤n       dts
                            t∈[0,1]


With respect to this topology Lg is complete. It extends immediately to
the enlarged g̃ as well as to the twisted subalgebras.We may view these
topological algebras as C ∞ -completions of the algebraic loop algebras as
e.g. in [9].
    For later applications, we introduce a second topology on the spaces
L(g) and L(g, τ ). The completions of these spaces with respect to the
new topology will not carry a Lie algebra structure any more (cf. [4]).
As before, let (., .) denote the Killing form on gC , and let
                                                           R 1 (., .)g denote
the negative of the Killing form on g. Then (x, y)g = 0 (x(t), y(t))g dt
gives a scalar product on L(g), and by restriction we get a scalar product
on L(g, τ ) as well. Let L(g, τ )(L2 ) denote the completion of L(g, τ ) with
respect to the metric induced by the scalar product. After extending the
scalar product to the completion, L(g, τ )(L2 ) is a Hilbert space.


                                                   11
3.2 Loop groups and their affine adjoint repre-
sentation
From now on, we will write G(C) if we mean either a compact group G or
the corresponding complex group GC , and analogously we write g̃(C) for
the associated Lie algebras.
    If G(C) is a simply connected compact (complex) Lie group then the
corresponding untwisted loop group LG(C) is defined to be the topological
group of C ∞ mappings from S 1 to G(C) with pointwise multiplication and
the usual C ∞ -topology. If τ is one of the outer automorphisms of G(C)
considered in §2.1 and ord(τ ) = r then the twisted loop group L(G(C) , τ )
is the subgroup

      L(G(C) , τ ) = {x ∈ LG(C) |τ (x(t)) = x(t + 1/r) for all t ∈ [0, 1]}.

    Then Lg(C) (resp. L(g(C) , τ )) may be viewed as the Lie algebra of
LG(C) (resp. L(G(C) , τ )) and there are natural adjoint actions of these
groups on their Lie algebras (by pointwise finite-dimensional adjoint ac-
tion). However, for purposes of representation theory it is essential to
consider not this action but the adjoint action of the affine Kac-Moody
groups on the affine Lie algebras. These groups are given, similar to the
Lie algebra case, as central extensions of semidirect products

                            e → S 1 → Ĝ → LG ⋊ S 1 → e,

where the circle in the semidirect product acts on LG by rotation on
the loops (in the complex case the circles S 1 are usually replaced by
C∗ ), and accordingly in the twisted cases. See [16] for a construction
of these groups. Obviously the center of Ĝ acts trivially in the adjoint
representation, thus it is sufficient to consider the action of the quotient
group LG ⋊ S 1 . It will turn out that the adjoint action of the rotation
group S 1 is without relevance for our purposes (i.e. in the case that an
LG-orbit contains a constant loop , see below, this action preserves the
LG-orbit). Therefore, it is sufficient to look at the adjoint action of only
the loop group LG on g̃. We call that action, which significantly differs
from the usual adjoint action of LG on its Lie algebra Lg, the affine adjoint
                          f Exploiting the natural exponential mapping
action and denote it by Ad.
from Lg to LG and working with a fixed faithful matrix representation
of G, Frenkel was able to determine the exact form of the affine adjoint
action in the untwisted case ([4]).

Proposition 3.1 Let g ∈ LG(C) , y ∈ Lg(C) and a, b ∈ C (resp. R), then

               f g(aC + bD + y) = ãC + bD + gyg −1 − bg ′ g −1
               Ad
                                                                         dg(t)
with ã = a + (g −1 g ′ , y) − 2b (g ′ g −1 , g ′ g −1 ) and g ′ (t) =    dt
                                                                               .

The affine adjoint representation of a twisted loop group L(G(C) , τ ) on the
corresponding twisted affine Lie algebra g̃(C) is obtained by restriction of
the adjoint representation of LG(C) on the corresponding untwisted affine
Lie algebra g̃′(C) to L(G(C) , τ ) and g̃(C) . Hence the formula of Proposition
3.1 remains true for the twisted cases, as well.


                                              12
3.3     Classification of affine orbits
In the case of an untwisted affine Lie algebra Frenkel and Segal have
classified affine adjoint orbits of the loop group LG(C) on the affine Lie
algebra g̃(C) in terms of conjugacy classes of the group G(C) ([4], [16]).
By a slight alteration of Frenkel’s original methods, we can extend this
classification to the twisted loop groups L(G(C) , τ ). Technically, the study
of the affine adjoint action (on elements with b 6= 0) is equivalent to
that of transformations of ordinary differential equations on the real line
with periodic coefficients or, in more advanced terminology, to that of the
action of the gauge group on connections in a trivial fibre bundle over the
circle S 1 . In the context of twisted loops we shall, in addition, have to work
with differential equations with ’twisted periodic’ coefficients. To obtain a
unified statement of the results, we shall allow the twisting automorphism
τ to be the identity on G(C) . In this case, the group L(G(C) , τ ) is just the
untwisted group LG(C) .

   Consider first the system of linear differential equations

                                z ′ (t) = z(t)x(t),

where x(t), z(t) ∈ Mn (C) for all t ≥ 0, and x(t) is continuous in t. A
fundamental result from the theory of differential equations secures the
existence of a unique solution z(t) of the above equation with z(0) = In .
This solution z is usually called the fundamental solution of the differential
equation.
     Now let x be twisted periodic, that is, x(t + 1/r) = τ xτ −1 for some
invertible matrix τ with τ r = In and all t ≥ 0. If z is the fundamental
solution of z ′ = zx, then obviously z1 (t) = τ −1 z(t + 1/r)τ is another
solution. Hence there exists a matrix M   f(x) such that z1 (t) = Mf(x)z(t).
                                          f                 −1
Since we have chosen z(0) = In , we get M (x) = z1 (0) = τ z(1/r)τ . Now
let M (x) := z(1/r) be the ” 1r -th monodromy” of the differential equation
z ′ = zx. We then obtain

                         z(t + 1/r) = M (x)τ z(t)τ −1

for all t ≥ 0.
    For a twisted periodic continuously differentiable g with g(t) ∈ Gln (C)
for all t ≥ 0 let us denote

                    zg (t) = g(0)z(t)g −1 (t)
                    xg (t) = g(t)x(t)g −1(t) − g ′ (t)g −1 (t).

Then we have the following proposition.

Proposition 3.2 Let x be a twisted periodic, continuous, matrix valued
function, and let z be the fundamental solution of z ′ = zx. Then
 (i) zg (t) is the fundamental solution of zg′ = zg xg .
 (ii) M (xg ) = g(0)M (x)τ g −1(0)τ −1 .


                                        13
(iii) If x1 is twisted periodic and there exists a g0 such that
                           M (x1 ) = g0 M (x)τ g0−1 τ −1 ,
     then there exists a twisted periodic Matrix g(t) such that g(0) = g0
     and xg (t) = x1 (t) for all t ≥ 0.

Proof: (i) This is a direct calculation using (g −1 )′ = −g −1 g ′ g −1 .
  (ii) Since g is twisted periodic, we have
    M (xg ) = zg (1/r) = g(0)z(1/r)g −1 (1/r) = g(0)M (x)τ g −1(0)τ −1 .
    (iii) Put g(t) = z1−1 (t)g0 z(t), where z and z1 are fundamental solu-
tions of z ′ = zx and z1′ = z1 x1 respectively. Then the same calculation as
in the proof of [4], Prop.(3.2.5) yields xg = x1 . Again, a similar explicit
calculation as in [4] gives g(t + 1/r) = τ g(t)τ −1 for all t ≥ 0.       

    Before we can use the results above to classify the affine adjoint orbits
for arbitrary g we need a general fact from differential geometry, which is
stated as follows in [4].

Proposition 3.3 Let gC ⊂ Mn (C) be a matrix Lie algebra, and GC ⊂
Gln (C) the corresponding Lie group. If z is a solution of the linear dif-
ferential equation z ′ = zx, then z(t) ∈ GC for all t ≥ 0 if and only if
x(t) ∈ gC for all t ≥ 0.
                                                        (r)
    Now let g̃C be an affine Lie algebra of type Xn , and let τ be the cor-
responding diagram automorphism of the underlying finite dimensional
Lie algebra gC used in the loop realization of g̃C . In the case of an un-
twisted affine Lie algebra, τ is just the identity on gC . Let g̃ and g denote
the corresponding compact forms. Following [4], we define an affine shell
(”standard paraboloid” in [4]) to be the following submanifold of codi-
mension 2 in g̃C .
       PCa,b = {x(·) + a1 C + b1 D ∈ g̃C |2a1 b1 + (x, x) = a, b1 = b},
where a, b ∈ C and b 6= 0. The zero-hyperplane in g̃C is defined to be the
subspace
                   ĝC = {x(·) + aC + bD ∈ g̃C |b = 0}.
   By P a,b with a, b ∈ R, a 6= 0 and ĝ we shall denote the corresponding
submanifolds of g̃. Let OX be the LG(C) -Orbit of X in g̃(C) , and let Ogτ
be the G(C) -Orbit of gτ in G(C) τ . Here Gτ is the connected component of
the principal extension G̃ of the compact group G as constructed in §2.1,
and G̃C is the corresponding complexification.

Theorem 3.4 (i) Each L(GC , τ ) (resp. L(G, τ ))-Orbit in the complex
    (resp. compact) affine Lie algebra g̃C (resp. g̃) lies either in one of
    the affine shells PCa,b (resp. P a,b ) or in the zero-hyperplane.
 (ii) For a fixed affine shell, the monodromy map
                            Ox(·)+aC+bD 7→ OM ( 1 x)τ
                                                    b

     is well defined and injective.


                                      14
(iii) For a fixed affine shell, the map defined in (ii) gives a bijection be-
      tween the L(GC , τ ) (resp. L(G, τ ))-Orbits in g̃C (resp. g̃) which
      contain a constant loop and the GC (resp. G)-Orbits in GC τ (resp.
      Gτ ) which contain an element that is invariant under conjugation
      with τ .

Proof: (i) Follows from the formula in lemma 3.1. Note that the
affine shells in a twisted affine Lie algebra are just the τ -invariant parts
of the affine shells in the corresponding untwisted algebras.
    (ii) We look at the map Ox(·)+aC+bD 7→ OM ( 1 x)τ where, as above,
                                                       b
M ( 1b x) = z(1/r), and z is the fundamental solution of z ′ = z ·   1
                                                                     b
                                                                         · x. Now,
by (3.1), we have

           f
           Ad(g)(aC + bD + x) = ãC + dD + gxg −1 − bg ′ g −1 .

But using 3.2 (i), we see that OãC+bD+gxg−1 −bg′ g−1 is being mapped to
Ozg (1/r)τ , and 3.2 (ii) yields

                            1              1
              zg (1/r) = M ( xg ) = g(0)M ( x)τ g(0)−1τ −1 ,
                            b              b
hence
                zg (1/r)τ = g(0)z(1/r)τ g(0)−1 ∈ Oz(1/r)τ .
So the map is well defined and injectivity follows with 3.2 (iii).
    (iii) If sτ ∈ G(C) τ is invariant under conjugation with τ then so is
r ·b·log(s) and Oa1 C+bD+r·b·log(s) is a preimage of Osτ whenever it belongs
to P a,b . On the other hand, if the orbit Oa2 C+bD+x(·) contains a constant
loop aC + bD + x0 , then x0 has to be invariant under conjugation with τ .
Now the fundamental solution of the differential equation z ′ = z · 1b x0 is
given by z(t) = exp(t 1b x0 ). Hence z(1/r) is invariant under conjugation
with τ as well.                                                           

Corollary 3.5 If ord(τ ) = 1, or G is compact, then the monodromy map
in Theorem 3.4 is surjective and hence induces a bijection between the
LG-orbits in a fixed affine shell P a,b and the G-orbits in Gτ .

Proof: If τ = id then the statement is trivial. For compact G we use
the fact that every G-orbit in Gτ intersects Sτ in at least one point. Here
S is a Cartan subgroup of G̃ containing τ .                              

Remark 3.6 In the case of complex groups the classification of L(GC , τ )-
orbits in g̃C remains open. In this case it is no longer true that every
GC -orbit in GC τ contains a τ -invariant element (cf. [15] for an example),
so different arguments may have have to be applied. In any case, it is easy
to see that the image under the monodromy map defined in 3.4 (ii) are the
G(C) -Orbits in G(C) τ for which there exists a C ∞ path z : [0, 1] → G(C)
such that z(0) = e, z(1/r)τ ∈ Ogτ and z(t + 1/r) = z(1/r)τ z(t)τ −1 for
all t ≥ 0.



                                     15
Remark 3.7 We have not dealt with the L(G, τ )-orbits in the zero-
hyperplane, which are basically the orbits of the adjoint representation
of L(G, τ ) on its Lie algebra. As we shall see later, the orbits relevant
for representation theory are the L(G, τ )-orbits in some fixed affine shell
with b 6= 0. Also, the classification of L(G, τ )-orbits in ĝ is presumably
not manageable, i.e. it certainly yields an infinite dimensional “moduli
space”.

    In a simply connected, semi-simple, compact Lie group, the conjugacy
classes are in one-to-one correspondence with a fundamental domain of
the affine Weyl group W̃ acting on LT in the notation of §2. Here the
affine Weyl group acts like the finite Weyl group of the root system R,
belonging to the group G, extended by the group of translations generated
by the dual roots R∗ ∈ LT . Here, the set of dual roots is given as R∗ =
{α∗ | α ∈ R}, and (α∗ , .) = α where (., .) is the Killing form. Hence the
the orbits in a given affine shell P a,b are in one-to-one correspondence
with a fundamental domain of W̃ .
    The G-orbits in Gτ are in one-to-one correspondence with the set
S0 τ /W (S), where W (S) = N (S)/S acts by conjugation on S0 τ . We
can pull back this action to S0 by right multiplication with τ −1 . Then
tS0 ∈ W (S) acts on S0 via s 7→ tsτ t−1 τ −1 . By Proposition 2.4, we have
W (S) = (T /S0 )τ ⋊ W τ . In this way, the action of W τ is the usual Weyl
group action of the Weyl group of Gτ on the maximal torus S0 . Hence
the orbits of this action are parametrized by a fundamental domain of the
affine Weyl group W̃ τ , where the translation part of W̃ τ is given by the
dual roots Rτ ∗ ∈ LS0 of the root system Rτ belonging to the group Gτ .
    An element tS0 ∈ (T /S0 )τ acts on S0 via s 7→ tsτ t−1 τ −1 = sst−1 τ ,
where τ tτ −1 = tst with st ∈ S0 . Viewing LS0 as the universal covering
of S0 via exp, we see that (T /S0 )τ acts on LS0 as a group of translations.
A direct calculation shows that a set of generators of this group is given
by the set
                        r
                     1X i ∗
                   {       τ (α ) | α∗ ∈ R∗ , τ (α∗ ) 6= α∗ }.
                     r i=1
So together these two groups yield exactly the action of the affine Weyl
group W̃ 1 belonging to the root system R1 from §2. Hence we have proved


Proposition 3.8 In the twisted compact case, the set of orbits in a given
affine shell P a,b is in one-to-one correspondence with a simplex in LS0
which is a fundamental domain for the action of the affine Weyl group
W̃ 1 belonging to the root system R1 .


4     Orbital integrals
4.1 Affine Lie algebras and the Kac-Weyl charac-
ter formula
Before we start deriving the analogue of Frenkel’s character formula for
the twisted affine Lie algebras, let us briefly review some facts from the


                                    16
structure and representation theory of affine Lie algebras. Let g̃C be an
                                  (r)
affine Lie algebra of type Xn with Weyl group W̃ . Let h̃C be a Cartan
subalgebra and Π = {α0 , . . . , αn } ⊂ h̃∗C be a set of simple roots of g̃C
where the roots are labeled in the usual way (cf.[9]). R̃ denotes the set
of roots of g̃C , and define R◦ to be the root system which is obtained by
deleting the 0-th vertex from the extended Dynkin diagram of R̃. Also,
let W ◦ denote the Weyl group belonging to R◦ . Let α∨           i ∈ h̃C be the
dual simple roots such that hαi , α∨   j i = (A)i,j , where A is the generalized
Cartan matrix belonging to g̃C . P     Let ai be the ”minimal” integers such
that A(a0 , . . . , an ) = 0, set δ = n                              1
                                         i=0 ai αi and define d = 2πi D with D
as in §3.1. Then we have hαi , di = 0 and hδ, di = 1. Now, we can define
an element θ = δ − a0 α0 ∈ h◦∗                                   ◦ ∨    ◦
                                   C and the lattice M = ZW θ ⊂ hC . Here
  ◦                                                    ∨      ∨        ∨
hC ⊂ h̃C denotes the subspace generated by {α1 , . . . αn }, and θ means
the element dual to θ in the sense of [9]. A fundamental result in the
theory of affine Lie algebras states that W̃ = W ◦ ⋉ M . Observe that
in [9] Kac uses a lattice M ′ ⊂ h◦∗                           ◦∗       ◦
                                      C after identifying hC with hC via an
invariant bilinear form.
   Turning to the representation theory of affine Lie algebras we define
as usual

             P̃ ={λ ∈ h̃∗C | hλ, α∨
                                  i i ∈ Z for all i = 0, . . . , n},

           P̃+ ={λ ∈ P̃ | hλ, α∨
                               i i ≥ 0 for all i = 0, . . . , n}, and

          P̃++ ={λ ∈ P̃ | hλ, α∨
                               i i > 0 for all i = 0, . . . , n}.

Then there exists a bijection between the irreducible integrable highest
weight modules of g̃C and the dominant integral weights Λ ∈ P̃+ . If L(Λ)
is an integrable irreducible highest weight module with highest weight
Λ ∈ P̃+ then the formal character of L(Λ) is the formal sum
                                 X
                     ch L(Λ) =       dim L(Λ)λ e(λ).
                                    λ∈h̃ ∗

Here L(Λ)λ is the weight space corresponding to the weight λ, and e(λ)
is a formal exponential. The Kac-Weyl character formula now reads (cf.
[9])                          P
                                w∈W̃ ǫ(w)e(w(Λ + ρ̃))
               ch L(Λ) =        Q                       .
                           e(ρ̃) α∈R (1 − e(−α))mult(α)
Here ρ̃ is defined by hρ̃, α∨
                            i i = 1 for i = 0, . . . , n and hρ̃, di = 0. As usual
we have set ǫ(w) = (−1)lenght(w) .
    So far, the character was considered as a formal sum involving the for-
mal exponentials e(λ). Now we set eλ (h) = ehλ,hi for h ∈ h̃C . In this way
one can consider the character of a highest weight g̃C -module V as an in-
finite series. Let us set Y (V ) = {h ∈ h̃C | chV (h) converges absolutely}.
Then chV defines a holomorphic function on Y (V ) and the following result
holds [9]:

Proposition 4.1 Let V (Λ) be the irreducible highest weight module with
highest weight Λ ∈ P+ . Then

                    Y (V (Λ)) = {h ∈ h̃C | Rehδ, hi > 0},


                                        17
          P
where δ = n  i=0 ai αi and the ai are the labels of the vertices of the affine
Dynkin diagram (cf. [9]).
   In this setting the Kac-Weyl character formula gives an identity of
holomorphic functions on Y (V (Λ)).

   Now we have h̃C = h◦C ⊕ CC ⊕ CD with C and D as in §3.1. With this
notation one gets
        Y (V (Λ)) = {h + aC + bD | h ∈ h◦C , a, b ∈ C, Im b < 0}.

4.2 Poisson transformation of the numerator of
affine characters
In this section we will start do derive an analogue of Frenkel’s character
formula for twisted affine Lie algebras by deriving a formula for the nu-
merator of the character formula in terms of the underlying non-connected
Lie group. To do this, we need to introduce some more notation. So let g̃C
                                                (r)
be an arbitrary affine Lie algebra of type Xn , and let g̃′C be the untwisted
                               (1)
affine Lie algebra of type Xn such that g̃C ⊂ g̃′C and let g̃ and g̃′ be the
corresponding compact forms. If g̃C is untwisted, we have g̃C = g̃′C . Fur-
thermore, let R be the root system of the finite dimensional Lie algebra
gC used to construct L(gC , τ ) in §3.1, and for a diagram automorphism
τ of gC let Rτ be the ”folded” root system introduced in §2.2. If g̃C is a
twisted affine Lie algebra with root system R̃, then Rτ = R◦ . Also, let
(., .) denote the Killing form on g̃′C , and let (., .)r denote its restriction to
g̃C .
      We now turn to the analytic Kac-Weyl character formula from §4.1.
Let Λ be a highest weight of g̃C . There is no essential loss in generality
by assuming hΛ, di = 0. Then, after identifying h̃C ∼     = h̃∗C via (., .)r we can
                             ◦
choose a ∈ C and H ∈ hC such that Λ + ρ̃ = aD + H. The condition
Λ ∈ P̃+ implies a ∈ iR, Im a < 0 and H ∈ ih◦ . The numerator of the
Kac-Weyl character formula evaluated at bD + K with b ∈ C, Im b < 0
and K ∈ h◦C now reads
                         X
                               ǫ(w)e(w(aD+H),bD+K)r .
                         w∈W̃

Let us assume in the following b ∈ iR and K ∈ ih◦ . We then set t = −1/ab,
h = H/a and k = K/b yielding t ∈ R+ and h, k ∈ h. With 2πid = D, the
sum above reads
                      X           1
                           ǫ(w)e− t (w(2πid+h),2πid+k)r .
                       w∈W̃

Let us set c = 2πiC. Then the lattice M operates on on h̃C via
                                                          
                                                  ba0
         γ(h + ac + bd) = h + ac + bd − (h, γ)r +     kγk2r c.
                                                   2
Now a short calculation (cf. [4]) shows for w ∈ W ◦ , γ ∈ M , and w−1 γ ∈
W̃
                                  1                      1        1
 w−1 γ(2πid + h), 2πid + k r = − k2πia0 γ + h − wkk2r + khk2r + kkk2r .
                                   2                      2        2

                                        18
Inserting this into the sum above, we get

   X             1
          ǫ(w)e− t (w(2πid+h),2πid+k)r =
   w∈W̃
                          1       2   1         2           X           X               1           2
                      e− 2t khkr − 2t kkkr                                    ǫ(w)e 2t kγ+h−wkkr .
                                                    γ∈2πia0 M w∈W ◦


We now need to apply the Poisson transformation formula: For a Eu-
clidean vector space V , a lattice Q ∈ V and a Schwartz function f : V → C
one has                  X                   X
                               fˆ(µ) = vol Q    f (γ)
                         µ∈Q∨                                   γ∈Q

with                                  Z
                          fˆ(µ) =              e2πi(γ,µ) f (γ)dγ.
                                          V
                                                        t       2
For a fixed x ∈ h◦ set f (µ) = e(x,µ)r − 2 kµkr . Then we get

                                              l
                                          2π        2       1             2
                        fˆ(γ) =                         e 2t kx+2πiγkr .
                                           t

with l = dimR h◦ . So for x = h − wk with h, k ∈ h◦ and w ∈ W ◦ we obtain
the identity

    X        1                2
            e 2t k2πiγ+h−wkkr =
   γ∈a0 M
                                                       − l           X
                                                  2π            2                               t   2
                        vol(a0 M )−1                                              e(µ,h−wk)r − 2 kµkr .
                                                   t
                                                                    µ∈(a0 M )∨



    If R̃ is of type Aff1, then θ is a long root in R◦ , and if R̃ is a root
                                                 (2)
system of type Aff2 or Aff3, but not of type A2n , then θ is a short root in
  ◦                           (2)       ◦
R . In case R̃ is of type A2n then R is a root system of type BCn , and
θ is a root of medium length in R◦ .
                          (r)                          (2)
    So if R̃ is of type Xn with r = 2, 3 and R̃ 6= A2n , then θ∨ is a long
           ◦∨
root in R , and hence M is the lattice which is generated by the long
                                  (2)
roots in R◦∨ . If R̃ is of type A2n , then θ∨ is a root of medium length in
  ◦∨
R and in this case we have a0 = 2. Thus, in all cases, M is the lattice
which is generated by the root system R1 from §2.2.
    For an arbitrary root system S let P ◦ (S) denote the weight lattice of
S. Then the above implies

    X        1                2
            e 2t k2πiγ+h−wkkr =
   γ∈a0 M
                                                           − l       X
                                  1                2π           2                               t   2
                                                                                  e(µ,h−wk)r − 2 kµkr .
                              vol a0 M              t
                                                                    µ∈P ◦ (R1 )




                                                19
Putting the above formulas together, we get
   X                1
          ǫ(w)e− t (w(2πid+h),2πid+k)r =
   w∈W̃
                               1    2   1           2
                        e− 2t khkr − 2t kkkr             X              X                                t    2
                                          l                                     ǫ(w)e(µ,h−wk)r − 2 kµkr .
                        vol(Z R1 ) 2π   t
                                           2
                                                        w∈W ◦ µ∈P ◦ (R1 )


     Now let W (R1 ) denote the Weyl group of the root system R1 . It is
a well known fact that (after the choice of a basis of R1 ) every weight
λ ∈ P ◦ (R1 ) is conjugate under W (R1 ) to some dominant weight λ′ ∈
P+◦ (R1 ). Since the root systems R1 and R◦ are dual to each other, we
have W ◦ = W (R1 ). So we get
    X           X                                       t        2
                            ǫ(w)e(µ,h−wk)r − 2 kµkr =
   w∈W ◦ µ∈P ◦ (R1 )
                               X        X               X                               ′             t kµk2
                                                                     ǫ(ww′ )ǫ(w′ )ehw       µ,h−wki − 2
                                                                                                     e     r

                               ◦ (R1 ) w∈W ◦ w′ ∈W ◦
                            µ∈P+


Here we have identified h◦ and h◦∗ via (., .)r . In the equation above, the
singular weights cancel out, so it is enough to sum over the strictly
                                                                  P domi-
nant weights, or equivalently to replace λ by λ + ρτ with ρτ = 21 ᾱ∈R1 ᾱ
                                                                        +
as in §2.2. Hence
  X       X                       t    2
                ǫ(w)e(µ,h−wk)r − 2 kµkr =
 w∈W ◦ µ∈P ◦ (R1 )
                 X             X        X                                    ′
                                                                                 (λ+ρτ ),h−wk> − 2
                                                                                                 t kλ+ρτ k2
          =                                     ǫ(ww′ )ǫ(w′ )e<w                                 e        r

                 ◦ (R1 ) w∈W ◦ w′ ∈W ◦
              λ∈P+
                 X                                                           t        τ 2
          =                  δ τ (h)δ τ (−k)χτλ (h)χτλ (−k)e− 2 kλ+ρ                   kr

                 ◦ (R1 )
              λ∈P+


with Aτ (λ), δ τ and χτλ = Aτ (λ+ρτ )/δ τ as in §2.3. As before, let gC be the
finite dimensional complex Lie algebra used to construct L(gC , τ ) with root
system R and compact form g. Let G be the simply connected compact
Lie group belonging to g and let Gτ denote the connected component of
the non-connected Lie group G ⋉ hτ i containing τ . In §2.3 we have seen
that χτλ (h) = χ̃λ (eh τ ) for h ∈ h◦ . Here χ̃λ denotes the character of G⋊ hτ i
belonging to the highest weight λ (cf. Theorem 2.6 and observe that in
this notation we have h◦ = LS0 with LS0 as in §2.2).
    So putting everything together, we have proved the following theorem
(which is the analogue of Theorem (4.3.4) in [4]).

Theorem 4.2 For h, k ∈ h◦ one has
    1     2     1       2    X              1
  e 2t khkr e 2t kkkr              ǫ(w)e− t (w(2πid+h),2πid+k)r =
                            w∈W̃

                             δ (h)δ τ (−k)
                              τ                             X                                        t       τ 2
                                                l
                                                                       χλ (eh τ )χλ (e−k τ )e− 2 kλ+ρ         kr

                            vol(ZR1 )( 2π
                                        t
                                          ) 2 λ∈P ◦ (R1 )
                                                 +




                                                            20
Remark 4.3 This section is basically a reformulation of of the analo-
gous results of [4] in the non-twisted cases and of [11] in the twisted cases.
Kleinfeld did his calculations for the twisted affine Lie algebras in con-
crete realizations of the corresponding root systems. Not realizing the
appearance of the characters of the non-connected Lie group G ⋊ hτ i, he
had to work with the irreducible characters of the different Lie groups
corresponding to the root systems R, Rτ and Rτ ∨ .

4.3     The heat equation
In this section we will see how the expression for the numerator in The-
orem 4.2 is connected to the fundamental solution of the heat equation
on the component Gτ of the non-connected group G ⋊ hτ i. To this end,
let ∆G denote the Laplacian on the compact simply connected group G
with respect to the Riemannian metric on G induced by the negative of
the Killing form on gC . We can pull back this metric to Gτ such that
right multiplication with τ induces an isometry between the Riemannian
manifolds G and Gτ . The Laplacian on Gτ shall be denoted with ∆Gτ .
    Now for a fixed parameter T > 0, the heat equation on Gτ reads
                          ∂f (gτ, t)   sT
                                     =    ∆Gτ f (gτ, t)
                              ∂t        2
with g ∈ G, s ∈ R, s > 0 and where f : Gτ → R is continuous in both
variables, C 2 in the first and C 1 in the second variable. The fundamental
solution of the heat equation is defined by the initial data
                            f (gτ, t)|t=+0 = δτ (gτ ),
where δτ is the Dirac delta distribution centered at τ ∈ Gτ .
    For a highest weight λ ∈ P+◦ (R) of G let d(λ) denote the dimension
of the corresponding irreducible representation of G and χλ its character.
Then the fundamental solution of the heat equation on G is given by
                          X                  stT      2   2
              us (g, t) =       d(λ)xλ (g)e− 2 (kλ+ρk −kρk )
                             ◦ (R)
                          λ∈P+

(see [3]). Now G and Gτ are isometric as Riemannian manifolds, hence
the fundamental solutions of the respective heat equations coincide. That
is, the fundamental solution of the heat equation on Gτ is given by
                          X                  stT     2     2
             vs (gτ, t) =       d(λ)xλ (g)e− 2 (kλ+ρk −kρk ) .
                             ◦ (R)
                          λ∈P+

   There is a well known identity for the characters of a compact group
which can be derived using the orthogonality relations for irreducible char-
acters:            Z
              d(λ)    χλ (g1 gg2−1 g −1 )dg = χλ (g1 )χλ (g2−1 ),
                      G
where dg denotes the normalized Haar measure on G. Using a version of
the orthogonality relations for non-connected groups, it is easy to proof
an analogous formula for the characters on the outer components:
              Z
         d(λ)    χλ (g1 τ gτ −1g2−1 g −1 )dg = χλ (g1 τ )χλ (τ −1 g2−1 ).
                G



                                       21
Hence we obtain
  Z
     vs (gg1 τ g −1 τ −1 g2−1 τ, t)dg =
    G
                                X                                         stT (kλ+ρk2 −kρk2 )
                                      χλ (g1 τ )χλ (τ −1 g2−1 )e−          2                    .
                              ◦ (R)
                           λ∈P+

By Theorem 2.6 we see that χλ (gτ ) = 0 if λ is not τ -invariant. Fur-
thermore, we have kλ + ρk2 = kλ + ρτ k2r if λ is τ -invariant. Thus, using
Theorem 4.2, exchanging the role of s and t, and fixing the parameter
value s = T , we have proved the following proposition.

Proposition 4.4 For h, k ∈ h◦ one has
  X          1
      ǫ(w)e− t (w(2πid+h),2πid+k)r =
   w∈W̃
                       1    2    1     2    t      τ 2
                   e− 2t khkr e− 2t kkkr e− 2 kρ    kr
                                                         δ τ (h)δ τ (−k)
                                                     l
                                                                             ·
                                 vol(ZR1 )( 2π
                                             t
                                               )     2
                                              Z
                                                         v    t   (geh τ g −1 τ −1 e−k τ, T )dg
                                                    G        T2



4.4       Wiener measures and a path integral
The main result of this subsection will be a further reformulation of the
numerator of the character formula as an integral over a certain path
space on the connected component Gτ . This is based on Proposition 4.4,
above, and the theory of Wiener measure on Gτ which we will study first.
(Compare with [4] and consult e.g. [13] for a comprehensive treatment of
the theory of Wiener measures on a vectorspace.)
    The Wiener measure on an euclidian vectorspace V of variance s > 0
is a measure ωVs on the Banach space of paths
              CV = {x : [0, T ] → V | x(0) = 0, x continuous}
(with the supremum norm) and is defined using the fundamental solution
ws (x, t) of the heat equation
                         ∂f (x, t)   sT
                                   =    ∆V f (x, t).
                            ∂t        2
on V as follows: First, one defines cylinder sets in CV to be the following
subsets of CV :
                  {x ∈ CV : (x(t1 ) ∈ A1 , · · · , x(tm ) ∈ Am )},
with 0 < t1 ≤ t2 ≤ . . . ≤ tm ≤ T , m ∈ N, and where A1 , . . . Am are Borel
sets in V . Then the Wiener measure ωVs of variance s > 0 is defined on
the cylinder sets of CV via

  ωVs (x(t1 ) ∈ A1 , · · · , x(tm ) ∈ Am ) =
                Z           Z
                       ···       ws (∆x1 , ∆t1 ) · · · ws (∆xm , ∆tm )dx1 · · · dxm ,
                  A1       Am




                                           22
where dx is a Lebesgue measure on V and we have set xk = x(tk ), ∆xk =
xk − xk−1 , ∆tk = tk − tk−1 and x0 = 0.
                                     s
    The conditional Wiener measure ωV,Z of variance s > 0 is defined on
the closed subspace CV,X ⊂ CV with fixed endpoint x(T ) = X on the
cylinder sets via
   s
  ωV,X (x(t1 ) ∈ A1 , · · · , x(tm−1 ) ∈ Am−1 ) =
         Z        Z
              ···           ws (∆xt1 , ∆t1 ) · · · ws (∆xm , ∆tm )dx1 · · · dxm−1 ,
           A1       Am−1

where additionally xm = X and tm = T .
   Now a classical result in the theory of Wiener measures states that
the measures ωVs and ωV,Xs
                              are σ-additive on the σ-field generated by
the cylinder sets in CV and CV,X respectively. Furthermore, the σ-fields
generated by the cylinder sets are exactly the Borel fields of the respective
Banach spaces (cf. [13]). As another result, we have

                                    ωVs (CV ) = 1

and
                               s
                              ωV,X (CV,X ) = ws (X, T ),
where ws (x, t) is the fundamental solution of the heat equation on V .
   Using the fundamental solution us (g, t) of the heat equation on the
                                                                s
compact Lie group G, one can define the Wiener measure ωG         and the
                              s
conditional Wiener measure ωG,Z    on the complete metric spaces

              CG = {z : [0, T ] → G | z(0) = e, z continuous}

and CG,Z = {z ∈ CG , z(T ) = Z)} in exactly the same fashion as the
Wiener measure on the vectorspace V (cf. [4]). The metric ̺ on CG is
given by ̺(z, z1 ) = supt∈[0,T ] ̺0 (z(t), z1 (t)), where ̺0 (g, g1 ) denotes the
length of a shortest geodesic in G connecting two given points g and g1
(the metric on G still being given by the negative of the Killing form on
g).
    There is an important connection between the Wiener measure on
G and the Wiener measure on the Lie algebra g which was discovered
by Ito [7] and explicitly constructed by McKean [14]: Let y ∈ Cg be a
continuous path. Then for n ∈ N and k = 0, . . . , 2n − 1, we define a path
zn : [0, T ] → G by zn (0) = e and
                                              
                   k                    k               k             k+1
     zn (t) = zn ( n T ) exp y(t) − y( n T )        for n T < t ≤          T.
                  2                     2              2               2n
Note that if y is a differentiable path, then limn→∞ zn is the fundamental
solution of the differential equation of z ′ = zy ′ and hence a well defined
path in G. Let us define a map

                                    i : Cg → CG

via                      (
                             limn→∞ zn        if the limit exists,
                  y 7→
                             e                else.


                                         23
The fundamental result of Ito and McKean states that the series zn , con-
verges with n → ∞ in the topology of CG almost everywhere with respect
to the measure ωgs . Furthermore, the measure on CG induced by the
                                               s
map i coincides with the Wiener measure ωG        on G. Hence i induces an
isomorphism
                     I : L1 (Cg , ωgs ) → L1 (CG , ωG
                                                    s
                                                      )
via If (iy) = f (y).
    This isomorphism is called Ito’s isomorphism in the literature. With its
help it is easy to translate most of the results about the Wiener measure
on a vectorspace to a corresponding result about Wiener measure on a
compact Lie group. For example we have
                                         s
                                        ωG (CG ) = 1
and
                              s
                             ωG,Z (CG,Z ) = us (Z, T ),
where us (g, t) denotes the fundamental solution of the heat equation on
G (cf. [4]).
   We will denote the integrals with respect to the Wiener measure and
the conditional Wiener measure on V as
                             Z
                                 f (x)dωVs (x),
                                    CV

resp.                          Z
                                                 s
                                          f (x)dωV,X (x),
                                   CV,X

and accordingly for the Wiener measures on G.
    One of the most important properties of these integrals is its transla-
tion qasi-invariance (cf. [13]): Let f : CV → R be an integrable function
and let y ∈ CV be a C ∞ -path. Then
       Z                    Z
                                             1   ′ ′    1    ′ ′
            f (x)dωVs (x) =      f (x + y)e− s (x ,y )− 2s (y ,y ) dωVs (x).
         CV                        CV

For a function f : CV,X → R the translation quasi-invariance of the con-
ditional Wiener measure reads
 Z                      Z
                                           1   ′ ′    1    ′ ′
              s
       f (x)dωV,X (x) =        f (x + y)e− s (x ,y )− 2s (y ,y ) dωV,X+Y
                                                                   s
                                                                         (x),
  CV,X                        CV,X+Y

with Y = y(T ). In the above formulas, (x′ , y ′ ) denotes the Stieltjes inte-
       RT
gral T1 0 (y ′ (t), dx(t)), and (., .) denotes the scalar product on V .
   Translated to the Wiener integral on G, the translation quasi-invari-
ance looks as follows (see [4]):

Proposition 4.5 (i) Let f : CG → R be an integrable function, and
    g ∈ CG be a C ∞ -path. Then
       Z
                  s
           f (z)dωG (z) =
          CG
                    Z
                                              −1 ′
                                          1     z ,g ′ g −1 )g − 2s
                                                                 1 (g −1 g ′ ,g −1 g ′ )
                             f (zg)e− s (z                                               g     s
                                                                                             dωG (z).
                        CG




                                              24
 (ii) Let f : CG,Z → R be an integrable function, and g ∈ CG be a C ∞ -
      path. Then
         Z
                      s
               f (z)dωG,Z (z) =
               CG,Z
                              Z
                                                                            −1 ′
                                                                       1      z ,g ′ g −1 )g
                                                       f (zg)e− s (z                           ·
                                  CG,Zg(T )−1
                                                                           −1 ′
                                                                   1         g ,g −1 g ′ )g
                                                           e− 2s (g                             s
                                                                                              dωG,Zg(T )−1 (z).

Here the term (z −1 z ′ , g ′ g −1 )g should be interpreted as the Stieltjes in-
          RT
tegral T1 0 (g ′ g −1 , d(i−1 (z))g , where (., .)g denotes the negative of the
Killing form on g (we add the subscript g here to avoid possible confu-
sions in later calculations). Note that i−1 is a well defined map almost
                                           s
everywhere on CG with respect to ωG          .
    Using the translation quasi-invariance of the Wiener measure on G,
Frenkel computes the following integral with respect to this measure ([4],
Prop. 5.2.12):

Lemma 4.6 Let Y ∈ L(g, τ ) and let g ∈ CG be a C ∞ - path such that
g ′ = gY . Then
             kY k2
                   Z
                 g     1   −1 ′
           e− 2s     e s (z z ,Y )g dωG,Z
                                      s
                                          (z) = us (Zg(T )−1 , T ),
                           CG,Z

where us (z, t) is the fundamental solution of the heat equation on G.

    Now let Ogτ denote the G-orbit in Gτ containing the element gτ (cf.
§3.3). Multiplying each element of Gτ with τ −1 , we can identify Ogτ with
a G-orbit in G, where G acts on itself by twisted conjugation: (h, g) 7→
hgτ h−1 τ −1 . This orbit will be denoted with Ogτ as well. We can now
define CG,Ogτ ⊂ CG to be the space of continuous paths with z : [0, T ] →
                                                       s
G with z(T ) ∈ Ogτ . A conditional Wiener measure ωG,O     gτ
                                                              on CG,Ogτ is
defined via
   Z
                    s
             f (z)dωG,Ogτ
                          (z) =
    CG,Ogτ
                                                                                                      
                             Z           Z
                                                                             s
                                                                       f (z)dωG,g      −1 −1 (z) dg1 ,
                                                                                 1 gτ g1 τ
                                 G           C             −1 −1
                                                 G,g1 gτ g   τ
                                                          1

where f is integrable on CG,g1 gτ g−1 τ −1 for almost all g1 ∈ G. Inserting
                                   1
this definition into Lemma 4.6, one gets:

Corollary 4.7 Let Y ∈ L(g, τ ) and let g ∈ CG be a C ∞ - path such that
g ′ = gY . Then
       kY k2
               Z
           g                 1      −1 ′
  e−    2s                 e s (z     z ,Y )g         s
                                                    dωG,OZτ
                                                            (z) =
                   CG,O
                      Zτ
                                                           Z
                                                                   us (g1 Zτ g1−1 τ −1 g(T )−1 , T )dg1 ,
                                                               G



                                                         25
where us (z, t) is the fundamental solution of the heat equation on G.

   We want to interpret the numerator of the Kac-Weyl character formula
as an integral in a space of paths in Gτ , so we need to define a Wiener
measure on the space

                           CGτ = {z̃ : [0, T ] → Gτ | z̃τ −1 ∈ CG }.

This can be done with the help of the fundamental solution vs (gτ, t) on
Gτ in exactly the same way as on G and on V . But as we have seen before,
we have vs (gτ, t) = us (g, t) for all g ∈ G and t > 0. So the integrals on G
                                                                 s
and Gτ will not differ, and we can define the measure ωGτ             directly by
              Z                         Z
                              s
                     f (z̃)dωGτ  (z̃) =     fˆ(z̃τ −1 )dωG
                                                         s
                                                           (z̃τ −1 ),
                       CGτ                                        CG


where fˆ is a function on CG which is given by fˆ(z) = f (zτ ). The condi-
tional Wiener measures on CGτ,Zτ and CGτ,Ogτ are defined analogously.
    So the formula in Corollary 4.7 now reads

       kY k2  2   Z
           gT                            T 2 (z −1 z ′ ,Y )               t
  e−                                                                T      2
          2t                         e    t                 g
                                                                  dωGτ,OZτ
                                                                           (zτ ) =
                      CGτ,O
                                Zτ
                                                              Z
                                                                      v    t   (g1 Zτ g1−1 τ −1 g(T )−1 τ, T )dg1 ,
                                                                  G       T2


where vs (gτ, t) is the fundamental solution of the heat equation on Gτ .
Note, that we also have set s = Tt2 in the above calculation.
   Now we fix the parameter value T = r1 . Observe that for Y ∈ L(g, τ )
we then have kY kr = −kY kg . So for h, k ∈ h◦ , we can set Y = T1 k = rk
and Z = eh . Then we have g(T )−1 = e−k . Hence the integral formula
above and Proposition 4.4 yield:

Proposition 4.8 Let h, k ∈ h◦ . Then
   X                   1
          ǫ(w)e− t (w(2πid+h),2πid+k)r =
   w∈W̃
                            1               t    τ        Z
   δ τ (h)δ τ (−k)e− 2t khkr − 2 kρ                  kr                            1 (z −1 z ′ ,k)
                                                                                                         tr2
                           l                                                    e tr2             g
                                                                                                       dωGτ,Oeh τ
                                                                                                                  (zτ )
            vol(ZR1 ) 2π t
                             2                                CGτ,O
                                                                          eh τ



4.5       Affine characters and orbital integrals
In this section we will indicate, how the integral in Proposition 4.8 can
be interpreted as an integral over an affine coadjoint orbit of L(G, τ ).
This interpretation and the analytic Kac-Weyl character formula from §4.1
will then yield an analogue of the Kirillov character formula for compact
semisimple Lie groups. For precise details we have to refer to Frenkel’s
work [4].
    For fixed a, b ∈ R and b 6= 0 let P a,b be the affine shell defined in
§3.3. We can identify P a,b with L(g, τ ) via the projection p : C 7→ 0 and


                                                                  26
D 7→ 0. Under this projection, the affine adjoint L(G, τ )-action on L(g, τ )
is given by (g, y) 7→ gyg −1 − bg ′ g −1 (cf. Prop. 3.1).
    We have a series of maps
                        p                   s             i        e
                  P a,b −→ L(g, τ ) −→ Cg∞ −→ CG    ∞ τ
                                                      → Gτ,
                 Rt
with s(x)(t) = 0 x(κ)dκ, and where i maps a path y ∈ Cg∞ to the fun-
damental solution of the differential equation z ′ = 1b zy ′ . The map eτ
is given by eτ (z) = z(1/r)τ . From Ito’s isomorphism we have a map
ĩ : Cg → CG , which is the extension of the map i : Cg∞ → CG   ∞
                                                                  above to
the corresponding completions Cg and CG .
     Now every element y ∈ Cg defines an element dy ∈ L(g, τ )∗ via the
Stieltjes integral
                                     Z 1
                                       r
                         hx, dyi = r     (x(κ), dy(κ)),
                                            0
where (., .) denotes the Killing form on g as in §3.1 and §4.1. Note that
for y ∈ L(g, τ ), we have hx, d(s(y))i = (x, y)r , where (., .)r is the bilinear
form on L(g, τ ) defined in §4.1. Let L(g, τ )∗0 denote the image of Cg under
this map with the topology induced from Cg , and let s̃ : L(g, τ )∗0 → Cg
denote the inverse map. In this notation, s̃ is the extension of the map
s to L(g, τ )∗0 . Putting the above remarks together, we get the following
commutative diagram:
                p                      s                      i         e
         P a,b −→     L(g,
                        Tτ)         −→           ∞
                                                CT
                                                 g        −→        ∞
                                                                   CT
                                                                    G
                                                                         τ
                                                                        −→   Gτ

                                       s̃                     ĩ        ẽ
                     L(g, τ )∗0     −→           Cg       −→       CG    τ
                                                                        −→   Gτ
    Here ẽτ denotes the extension of eτ to CG . We have seen in §3.3 that
under the composition eτ ◦ i ◦ s ◦ p, a L(G, τ )-orbit Ox(·)+a1 C+b1 D ⊂ P a,b
is mapped to the G-orbit Oeτ ◦i◦s(x) ⊂ Gτ .
   On the Hilbert space L(g, τ )(L2 ) introduced in §3.1, we can define a
norm by                                Z t
                     |x(·)| = sup |        x(κ)dκ|.
                                    t∈[0, 1
                                          r
                                            ]         0

The completion of L(g, τ )(L2 ) with respect to this norm will be L(g, τ )∗0 .
So we have a series of completions

                      L(g, τ ) ⊂ L(g, τ )(L2 ) ⊂ L(g, τ )∗0 ,

with respect to the L2 -topology on L(g, τ ) and the norm on L(g, τ )(L2 )
introduced above.
    In this picture, the set s̃−1 ◦ ĩ−1 ◦ ẽ−1                         ∗
                                             τ (Oeτ ◦i◦s(x) ) ⊂ L(g, τ )0 can be
viewed as the closure of the affine adjoint orbit Ox(·)+a1 C+b1 D in L(g, τ )∗0
and is mapped to CG,Oi◦s(x) under the map ĩ ◦ s̃. Accordingly, the integral
                        Z
                                            s
                                   f (z)dωGτ,O  Zτ
                                                   (zτ )
                            CGτ,O
                                  Zτ

can be viewed as an integral over the closure of the corresponding affine
adjoint orbit in L(g, τ )∗0 . For more details, which involve the construction
of a Gaussian measure on L(g, τ )∗0 , cf. [4]


                                                27
    The discussion above allows us to interpret the integral appearing in
the formula for the numerator of the Kac-Weyl character formula in Prop.
4.8 as an integral over the closure in L(g, τ )∗0 of the affine adjoint orbit
containing aD + H = Λ + ρ̃. The denominator of the Kac-Weyl character
formula is a function p not depending on the highest weight Λ of the
corresponding representation and hence can be seen as the analogue of the
universal function appearing in the Kirillov character formula for compact
Lie groups (in the context of compact Lie groups, the universal function is
given by the denominator of the Weyl character formula as well). Hence
our character formula for affine Lie algebras can be written in the following
way:

Theorem 4.9 Let bD + K ∈ h̃ with K ∈ h◦ and b ∈ iR, im(b) < 0.
Furthermore, for Λ ∈ P̃+ let Λ + ρ̃ = aD + H. Then the character of the
highest weight representation corresponding to Λ evaluated at bD + K is
given by

  ch L(Λ)(bD + K) = p−1 (bD + K) ·
                                           ab k H k − 1 kρτ k
                     δτ ( H
                          a
                            )δ τ (− K
                                    b
                                      )e   2    a r  2ab      r

                                                 l
                                                               ·
                             vol(ZR1 ) (−2abπ) 2
                            Z                                       2
                                          − ab (z −1 z ′ , K )   −r
                                         e r2              b g dω ab          (zτ ).
                                                                 Gτ,O  H
                             CGτ,O                                  (e a )τ
                                       H
                                    (e a )τ


Following [4], the path integral above can be interpreted as a Gaussian
integral over the closure of the affine orbit containing aD + H in L(g, τ )∗0 .
In that setup, the above formula may be seen as an exact analogue of
Kirillov’s classical character formula.


References
 [1] Berger, M., Gaudechon, P., Mazet, E.: Le Spectre d’une Variété Rieman-
     nienne. LMN 194, Springer-Verlag, Berlin, Heidelberg, New York, 1971.
 [2] Bröcker, T., tomDieck, T.: Representations of Compact Lie Groups.
     Springer-Verlag, New York, Berlin, Heidelberg, Tokyo, 1985.
 [3] Fegan, H. G.: The heat equation on a compact Lie Group. Trans. Amer.
     Math. Soc., 246, 339-357, (1978).
 [4] Frenkel, I. B.: Orbital theory for affine Lie algebras. Invent. mat. 77, 301-
     352, (1984).
 [5] Fuchs, J., Ray, U., Schweigert, C., Some Automorphisms of Generalized
     Kac-Moody Algebras. J. Algebra, 191, 518-540, (1997)
 [6] Helgason, S.: Groups and Geometric Analysis. Academic Press, Orlando,
     San Diego, New York, London, Toronto, Montreal, Sidney, Tokyo, Sao
     Paulo, 1984.
 [7] Ito, K.: Brownian Motion in a Lie Group. Proc. Japan. Acad., 26, 4-10,
     (1950)
 [8] Jantzen, J. C.: Darstellungen halbeinfacher algebraischer Gruppen und zu-
     geordnete kontravariante Formen. Bonner Mathematische Schriften, Nr. 67,
     1973.


                                           28
 [9] Kac, V. G.: Infinite dimensional Lie Algebras. Third edition, Cambridge
     University Press, Cambridge, New York, Port Chester, Melbourne, Sidney,
     1990.
[10] Kirillov, A. A.: Elements of the Theory of Representations. Springer-Verlag,
     Berlin, Heidelberg, New York, 1976.
[11] Kleinfeld, M.: Orbitaltheorie für getwistet affine Kac-Moody-Algebren.
     Inaugural-Dissertation, Westfälische Wilhelms-Universität Münster, 1996.
[12] Kostant, B.: Lie Algebra Cohomology and the Generalized Borel-Weil The-
     orem. Ann. Math. 74, 320-387, (1961).
[13] Kuo, H. H.: Gaussian Measures in Banach Spaces. LNM 463, Springer-
     Verlag, Berlin, Heidelberg, New York, 1975.
[14] McKean, H. P.: Stochastic Integrals, Academic Press, New York, 1969.
[15] Mohrdieck, S.: PhD thesis, Universität Hamburg. In preparation.
[16] Pressley, A., Segal, G.: Loop Groups. Oxford University Press, Oxford,
     1986.
[17] deSiebenthal, J.: Sur le groups de Lie compactes non connexes. Comm.
     Math. Helv. 31, 41-89, (1956).
[18] Wendt, R.: Eine Verallgemeinerung der Weylschen Charakterformel. Diplo-
     marbeit, Mathematisches Seminar der Universität Hamburg, 1998.




                                       29
