                                               CHARACTER SHEAVES ON DISCONNECTED GROUPS, V
arXiv:math/0403048v1 [math.RT] 2 Mar 2004




                                                                                  G. Lusztig


                                                                                Introduction
                                                Throughout this paper, G denotes a fixed, not necessarily connected, reductive
                                            algebraic group over an algebraically closed field k. This paper is a part of a series
                                            [L9] which attempts to develop a theory of character sheaves on G. The numbering
                                            of the sections and references continues that of the earlier Parts.
                                                Section 23 is a generalization of results in [L3, II,§7]. It is a preparation for the
                                            proof of the orthogonality formulas for certain characteristic functions in Section
                                            24 which generalize those in [L3, II,§9,§10]. Section 25 describes the cohomology
                                            sheaves of a class of complexes which includes the admissible complexes on G. In
                                            particular we show that these cohomology sheaves restricted to any stratum of
                                            G are local systems of a particular kind. In the connected case this reduces to a
                                            strengthening of [L3, III,14.2(a)]. In Section 26 we give a variant of the definition
                                            of parabolic character sheaves in [L10] in terms of admissibile complexes. Note
                                            that even if one is only interested in parabolic character sheaves of connected
                                            groups, one cannot avoid using the theory of character sheaves on disconnected
                                            groups. In Section 27 we discuss the induction functor. The present treatment
                                            differs from one in the connected case, given in [L3, I,§4].
                                                Notation. Let F be a local system on an algebraic variety Y . If k is an algebraic
                                            closure of a finite field Fq , F : Y −→ Y is the Frobenius map for an Fq -rational
                                                                       ∼
                                            structure and ǫ : F F −→ F is an isomorphism, we denote by ǫ̌ : F ∗ F̌ −
                                                                 ∗
                                                                                                                            → F̌ the
                                            unique isomorphism such that for any y ∈ Y , ǫ̌ : ĚF (y) −   → Ěy is the isomorphism
                                            transpose inverse to ǫ : EF (y) −
                                                                            → Ey .
                                                If X is an algebraic variety and A ∈ D(X) is IC(X ′ , F ) extended by 0 on
                                            X − X ′ where X ′ is a closed irreducible subvariety of X and F is a local system on
                                            an open dense smooth subvariety X0′ of X ′ , let Ǎ = IC(X ′ , F̌) extended by 0 on
                                            X − X ′ . We have also Ǎ = D(A)[−2 dim X ′ ]. If k is an algebraic closure of a finite
                                            field Fq , F : X −→ X is the Frobenius map for an Fq -rational structure such that
                                                                                          ∼
                                            F (X ) = X , F (X0′ ) = X0′ and α : F ∗ A −→ A is an isomorphism which restricts
                                                  ′       ′
                                                            ∼
                                            to ǫ : F ∗ F −→ F over X0 , we denote by α̌ : F ∗ Ǎ −   → Ǎ the unique isomorphism
                                                                     ∗    ∼
                                            which restricts to ǫ̌ : F F̌ −→ F̌ over X0 .

                                               Supported in part by the National Science Foundation

                                                                                                                Typeset by AMS-TEX
                                                                                        1
2                                    G. LUSZTIG

   If f : X −→ Y is a smooth morphism between algebraic varieties with connected
fibres of dimension δ, we set f˜A = f ∗ A[δ] for any A ∈ D(Y ). Let D(X)≤0 be as
in [L3, I,1.3]. Let M(X) be the category of perverse sheaves on X.
   If D is a connected component of G, a simple perverse sheaf A on D is said to
be admissible if A, regarded as a simple perverse sheaf on G, zero on G − D, is
admissible in the sense of 6.7.

                                     Contents
    23.   Strongly cuspidal local systems.
    24.   Orthogonality.
    25.   Properties of cohomology sheaves.
    26.   The variety ZJ,D .
    27.   Induction.

                      23. Strongly cuspidal local systems
23.1. Let S be an isolated stratum of G and let E ∈ S(S). Let D be the connected
component of G that contains S.
   If P is a parabolic of G0 such that S ⊂ NG P and R is an UP -coset in NG P ,
let dR be dim S − dim D ZG   0
                               0 minus the dimension of the P/UP orbit of R/UP in

NG P/P .
   We show that the following two conditions are equivalent:
   (i) E is a cuspidal local system;
   (ii) for any P, R as above such that P 6= G0 and any irreducible component C
of S ∩ R of dimension dR /2, the restriction of Ě to some/any smooth open dense
subset of C has no direct summand Q̄l .
Let C0 be a smooth open dense subset of C. We have HcdR (C, E) ∼    = HcdR (C0 , E) and,
                                                               0
by Poincaré duality, the last vector space is isomorphic to H (C0 , Ě), a vector space
whose dimension is the multiplicity of Q̄l in a decomposition of Ě|C0 as a direct
sum of irreducible local systems. It remains to note that, by 6.2, HcdR (S ∩ R, E) ∼  =
⊕C HcdR (C, E) where C runs over the irreducible components of S ∩ R of dimension
dR /2.
   Since condition (ii) for E is equivalent to condition (ii) for Ě, we deduce:
   (a) E is cuspidal if and only if Ě is cuspidal.
23.2. Let S, E, D, P be as in 23.1; assume that P 6= G0 . Let K0 = IC(S̄, E). We
show:
   (a) if R, dR are as in 23.1 and Hci ((S̄ − S) ∩ R, K0 ) 6= 0 then i < dR .
                                                                                ′
Indeed, there exist i′ , i′′ and a stratum S1 ⊂ S̄ − S with i = i′ + i′′ and Hci (S1 ∩
      ′′
R, Hi K0 ) 6= 0. By 6.2 we have dim(S1 ∩ R) ≤ (dim S1 − dim S + dR )/2. Since
                                                                       ′′
i′ ≤ 2 dim(S1 ∩ R) we have i′ ≤ dim S1 − dim S + dR . Since Hi K0 6= 0 at all
points of S1 , we have i′′ < dim S − dim S1 . Hence i = i′ + i′′ < dim S1 − dim S +
dR + dim S − dim S1 and i < dR , as required.
   Next we show that:
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                               3

                                                                    ji
   (b) if R, dR are as in 23.1, the natural map Hci (S ∩ R, E) −→ Hci (S̄ ∩ R, K0 ) is
an isomorphism for i ≥ dR .
Indeed, from (a) we see that ji is surjective for i = dR and an isomorphism for
i > dR . Moreover, for i = dR , the kernel of ji equals the image of the natural
map f : HcdR −1 ((S̄ − S) ∩ R, K0 ) −  → HcdR (S ∩ R, E). It is enough to show that
f = 0. We argue as in the proof of 8.3(b). We may assume that k is an algebraic
closure of a finite field Fq , that G has a fixed Fq -structure with Frobenius map
F : G −  → G, that P, R and any stratum in S̄ are defined over Fq and that we
                                    ∼
are given an isomorphism F ∗ E −→ E which makes E into a local system of pure
weight 0. Then HcdR −1 ((S̄ − S) ∩ R, K0 ), HcdR (S ∩ R, E) have natural (Frobenius)
endomorphisms compatible with f . To show that f = 0 it is enough to show that
   (∗) HcdR (S ∩ R, E) is pure of weight dR ;
   (∗∗) HcdR −1 ((S̄ − S) ∩ R, K0 ) is mixed of weight ≤ dR − 1.
Now (∗) is clear since dim(S ∩ R) ≤ dR /2 (see 6.2). We prove (∗∗). As in the
proof of (a), it is enough to show that for any stratum S1 ⊂ S̄ − S and any i′ , i′′
                                 ′            ′′
such that i′ + i′′ = dR − 1, Hci (S1 ∩ R, Hi K0 ) is mixed of weight ≤ dR − 1. By
                                                       ′′
Gabber’s theorem [BBD, 5.3.2], the local system Hi K0 on S1 is mixed of weight
                                                                    ′           ′′
≤ i′′ . Using Deligne’s theorem [BBD, 5.1.14(i)] we deduce that Hci (S1 ∩R, Hi K0 )
is mixed of weight ≤ i′ + i′′ = dR − 1. This completes the proof of (b).
   We show that the following two conditions for S, E, P are equivalent:
   (i) for any UP -coset R in NG P we have HcdR (S ∩ R, E) = 0, dR as in 23.1;
   (ii) for any i, the set Xi consisting of the UP -cosets R in NG P such that Hci (S̄ ∩
R, K0 )) 6= 0 has dimension < dim S − i.
Consider the set of all UP -cosets R in NG P such that S̄ ∩ R 6= ∅. On this set
we have a D ZG  0
                  0 × P/UP -action (z, p) : R 7→ zpRp
                                                        −1
                                                           ; this action has only finitely
many orbits and some orbit has dimension dim S − dR . Also, this action leaves
stable each of the subsets Xi in (ii).
   Assume that (ii) holds. Let R be an UP -coset in NG P . Assume that
HcdR (S ∩ R, E) 6= 0. By (b) we have R ∈ Xi with i = dR . Hence the orbit of
R is contained in Xi . It follows that dim Xi ≥ dim S − dR contradicting (ii). Thus,
(i) holds.
   Conversely, assume that (i) holds. To establish (ii), we assume that i is such
that Xi 6= ∅; it is enough to show that for any D ZG  0
                                                        0 × P/UP -orbit η in Xi we have

dim η < dim S−i. If R ∈ η we have dim η = dim S−dR . Hence it is enough to show
that dim S − dR < dim S − i or that i < dR . Assume that i ≥ dR . Since Xi 6= ∅
we have Hci (S̄ ∩ R, K0 ) 6= 0 for some R hence by (b) we have Hci (S ∩ R, E) 6= 0. If
i > dR this is impossible, by 6.2. If i = dR this is impossible since (i) holds. Thus
we have i < dR and (ii) holds.
23.3. In the setup of 23.1 we say that E is clean if IC(S̄, E)|S̄−S = 0. We say that
E ∈ S(S) is strongly cuspidal if for any parabolic P of G0 such that P 6= G0 , S ⊂
NG P and any UP -coset R in NG P we have Hci (S̄ ∩ R, K0 ) = 0 for all i.
  From the equivalence of (i),(ii) in 23.2 we see that:
4                                             G. LUSZTIG

   if E is strongly cuspidal then E is cuspidal.
If E is assumed to be clean, then the condition that E is strongly cuspidal is
equivalent to the following condition: for any parabolic P of G0 such that P 6=
G0 , S ⊂ NG P and any UP -coset R in NG P we have Hci (S ∩ R, E) = 0 for all i.
    Let D be a connected component of G and let P be a parabolic of G0 such that
that NG P ∩ D 6= ∅. Let L be the Levi of P . Let G′ = NG P ∩ NG L, a reductive
group with G′0 = L. Let D′ = G′ ∩ D, a connected component of G′ . Define a
homomorphism π : NG P −    → G′ by π(zω) = z where z ∈ NG P ∩ NG L, ω ∈ UP
(see 1.26). The restriction of π to NG P ∩ D −→ D′ is denoted again by π. Let
i : NG P ∩ D −→ D be the inclusion. We define a functor
                                       ′
                                  resD        → D(D′ )
                                     D : D(D) −

        ′
by resD         ∗
      D A = π! i A.
  Let A be a perverse sheaf on D. We say that A is cuspidal if
                                          ′
                                  resD            ′ ≤0
                                     D A[−1] ∈ D(D )



for any P, L, D′ as above with P 6= G0 . We say that A is strongly cuspidal if
                                          ′
                                  resD              ′
                                     D (A) = 0 ∈ D(D )

for any P, L, D′ as above with P 6= G0 . Clearly, if A is strongly cuspidal, then it
is cuspidal.
    Assume now that S is an isolated stratum in D and E ∈ S(S). Let A =
IC(S̄, E)[dim S] regarded as a perverse sheaf on D, zero on D − S̄. Clearly, A is
strongly cuspidal if and only if E is a strongly cuspidal local system. We show:
    (a) A is cuspidal if and only if E is a cuspidal local system.
By the equivalence of (i),(ii) in 23.2, the condition that E is a cuspidal local system
is that, for any P, L, D′ be as above with P 6= G0 and any j ∈ Z we have
                                               ′
                      dim(suppHj (resD
                                     D A[− dim S])) < dim S − j

                                      ′                                           ′
or equivalently dim(suppHj (resD                              j  D
                               D A)) < −j that is, dim(suppH (resD A[−1])) ≤
                             ′
−j. This is the same as resD            ′ ≤0
                           D A[−1] ∈ D(D )   . This proves (a).
23.4. Let E ∈ S(S). Let s ∈ Ss and let G′ = ZG (s). Let c be a G′0 -conjugacy class
in V = {v ∈ G′ ; v unipotent, sv ∈ S}. Let δ be the connected component of G′ that
contains c. Let E ′ be the inverse image of E under the map δ ZG      0
                                                                        ′0 c −
                                                                             → S, g 7→ sg.
Then E ′ ∈ S(S ′ ) where S ′ = δ ZG0
                                     ′0 c. Let K 0 = IC(  S̄, E), K ′
                                                                    0 =    IC( S̄ ′ , E ′ ). We
show:
   (a) E is clean (with respect to G) if and only if E ′ is clean (with respect to G′ ).
Let E ′′ be the inverse image of E under V −    → S, v 7→ sv. Since V is a smooth
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                     5

equidimensional variety (it admits a transitive action of an algebraic group), the
complex IC(V̄, E ′′ ) ∈ D(V̄) is well defined.
    Using 1.22 we see that π : S̄ −           → Ss , g 7→ gs is a morphism of algebraic vari-
                  D 0              0
eties. Now ZG0 × G acts on S̄ and Sc compatibly with π so that the action
on Sc is transitive. Since the fibre π −1 (s) may be identified with V̄, we see that
IC(V̄, E ′′ ) = h∗ K0 where h : V̄ −        → S̄, v 7→ sv. It follows that E is clean if and only
if IC(V̄, E )|V̄−V = 0. We have V = ⊔i∈[1,m] ci where ci are G′0 -conjugacy classes.
             ′′

Hence IC(V̄, E ′′ ) = ⊕i∈[1,m] IC(c̄i , E ′′ |c̄i ). Thus, IC(V̄, E ′′ )|V̄−V = 0 if and only
if IC(c̄i , E ′′ |c̄i )|c̄i −ci = 0 for all i. By the homogeneity of V this is equivalent to
the condition that IC(c̄, E ′′ |c̄ )|c̄−c = 0. (We have c = ci for some i.) This last
condition is clearly equivalent to the condition that K0′ |S̄ ′ −S̄ ′ = 0. This proves
(a).
    We show:
    (b) If E is strongly cuspidal (with respect to G) then E ′ is strongly cuspidal (with
respect to G′ ).
Let Q be a parabolic of G′0 such that Q 6= G′0 , S ′ ⊂ NG′ Q. We must show that
for any z ∈ δ ZG       0                             i          ′
                         ′ 0 , u ∈ c̄ ∩ Q we have Hc (zuUQ , K0 ) = 0 for all i. We may assume

that z = 1. Hence we must show that Hci (uUQ ∩ c̄, K0′ ) = 0 for all i. Since
Hci (uUQ ∩ c̄, K0′ ) is a direct summand of Hci (uUQ ∩ V̄, IC(V̄, E ′′ )) it is enough to
show that Hci (uUQ ∩ V̄, IC(V̄, E ′′ )) = 0 for all i. Since IC(V̄, E ′′ ) = h∗ K0 , it
is enough to show that Hci (suUQ ∩ sV̄, K0 ) = 0 for all i. We have suUQ ∩ sV̄ =
suUQ ∩ S̄ hence it is enough to show that Hci (suUQ ∩ S̄, K0 ) = 0 for all i. By 1.18(a)
we can find a parabolic P of G0 such that P ∩ G′0 = Q and su ∈ NG P . Clearly,
P 6= G0 . Let f : suUP ∩ S̄ −            → sUP ∩ Ss be the restriction of π : S̄ −
                                                                                 → Ss . Now UP
acts by conjugation on suUP ∩ S̄ and on sUP ∩ Ss compatibly with f ; moreover
this action is transitive on sUP ∩ Ss (see 19.3(a)). We have f −1 (s) = suUQ ∩ S̄
hence we must only show that Hci (f −1 (s), K0) = 0 for all i. The Leray spectral
sequence of f is:

              E2p,q = Hcp (sUP ∩ Ss , Hq f! K0 ) =⇒ Hcp+q (suUP ∩ S̄, K0 ).

                                                                           p,q
The last vector space is zero since E is strongly cuspidal. Thus, E∞           = 0 for all p, q.
Now H f! K0 is a UP -equivariant local system on sUP ∩Ss and sUP ∩Ss ∼
        q
                                                                                   = UP /UP ′
                                    p,q
is an affine space. Hence E2 = 0 for p 6= 2 dim UP /UP ′ . This implies that
E2p,q = E∞p,q
               for all p, q; it follows that E2p,q = 0 for all p, q so that Hq f! K0 = 0 for
all q. Taking the stalk at s we see that Hcq (f −1 (s), K0 ) = 0 for all q and (b) is
proved.
   We show:
   (c) Assume that S = D ZG        0                                 0
                                     0 c where c is a unipotent G -conjugacy class. Let

L ∈ S(D ZG 0
              0 ) be a local system of rank 1. If E is strongly cuspidal then E ⊗(L⊠ Q̄l )

is strongly cuspidal.
We have IC(S̄, E ⊗ (L ⊠ Q̄l )) = K0 ⊗ (L ⊠ Q̄l ) since S̄ ∼       = D ZG0
                                                                          0 × c̄. Let P be a
                  0                     0                     D 0
parabolic of G such that P 6= G , S ⊂ NG P . Let z ∈ ZG0 , u ∈ c̄. We know that
6                                          G. LUSZTIG

Hci (zuUP ∩ S̄, K0 ) = 0. We must show that Hci (zuUP ∩ S̄, K0 ⊗ (L ⊠ Q̄l )) = 0.
It is enough to show that (L ⊠ Q̄l )|zuUP ∩S̄ ∼= Q̄l . This follows from the fact that
(L ⊠ Q̄l )|zuUP ∩S̄ = Lz ⊗ Q̄l where Lz is the stalk of L at z.
   This argument shows also that, in the setup of (c):
   (d) If E is clean then E ⊗ (L ⊠ Q̄l ) is clean.
23.5. Let S be an isolated stratum of G. Let D be the connected component
of G that contains S. Assume that there exists a non-zero cuspidal local system
E0 ∈ S(S). Let E ′ , E ′′ ∈ S(S) be local systems such that the local system E ′ ⊗ E ′′
has no direct summand isomorphic to Q̄l . We show that
    (a) Hci (S, E ′ ⊗ E ′′ ) = 0 for all i.
It is enough to show that, if E ∈ S(S) is irreducible and E 6∼        = Q̄l then Hci (S, E) = 0
for all i. Let H = D ZG      0        0
                               0 × G . We can find an integer n ≥ 1 invertible in k such

that E is equivariant for the transitive H-action (z, x) : g 7→ xz n gx−1 on S. Let
y ∈ S and let Hy be the stabilizer of y in H for this action. Let S̃ = H/Hy0 .
Define f : S̃ −  → S by f (z, x) = xz n yx−1 (a principal Hy /Hy0 -covering where Hy
acts on S̃ by right multiplication). Now E is a direct summand of the local system
f! Q̄l . It is enough to show that Hci (S, f! Q̄l ) = Hci (S, Q̄l ) for all i or equivalently
that Hy /Hy0 acts trivially on Hci (S̃, Q̄l ). Let H̄ = D ZG       0          0 D 0
                                                                     0 × (G / ZG0 ). Define

f ′ : H̄ −→ S̃ by (z, xD ZG   0               0        ′
                                0 ) 7→ (z, x)Hy . Now f is a fibration with fibres isomorphic

to Hy0 /({1}×D ZG    0     ∼          0 D 0
                       0 ) = ZG (y) / ZG0 which by 10.2 is isomorphic to an affine space

of dimension, say, a. Hence we have Hci (S̃, Q̄l ) = Hci+2a (H̄, Q̄l ). Also the Hy /Hy0 -
action on S̃ is compatible under f ′ with the Hy /({1}× D ZG         0
                                                                       0 )-action on H̄ by right
                                                                      D 0
multiplication. It is then enough to show that Hy /({1} × ZG0 ) acts trivially on
Hci+2a (H̄, Q̄l ). This follows from the fact that the Hy /({1} × D ZG            0
                                                                                    0 )-action on
                                                                                  D 0
H̄ is the restriction of an action of the connected group H/({1} × ZG0 ) and a
connected group must act trivially in cohomology. This proves (a).
23.6. Let (L′ , S ′ ), (L′′ , S ′′ ) ∈ A. Assume that E ′ ∈ S(S ′ ) and E ′′ ∈ S(S ′′ ) are
strongly cuspidal relative to NG L′ , NG L′′ respectively. Let K0′ = IC(S̄ ′ , E ′ ), K0′′ =
IC(S̄ ′′ , E ′′ ). We regard K0′ (resp. K0′′ ) as a complex on NG L′ (resp. NG L′′ ) zero
outside S̄ ′ (resp. S̄ ′′ ). To L′ , S ′ , E ′ (resp. L′′ , S ′′ , E ′′ ) we attach K′ ∈ D(ȲL′ ,S ′ )
(resp. K′′ ∈ D(ȲL′′ ,S ′′ )) in the same way as K = IC(ȲL,S , π! Ẽ) was attached to
L, S, E in 5.6. We regard K′ , K′′ as complexes on G, zero outside ȲL′ ,S ′ , ȲL′′ ,S ′′
respectively.
Proposition 23.7. Assume that for any n ∈ G0 such that n−1 L′ n = L′′ , hence
n−1 NG L′ n = NG L′′ , we have Hci (NG L′ , K0′ ⊗ Ad(n−1 )∗ K0′′ ) = 0 for all i. (This
condition is automatically verified if L′ , L′′ are not G0 -conjugate.)           Then
Hci (G, K′ ⊗ K′′ ) = 0 for all i.
  The proof is quite similar to (but simpler than) that in 7.8. Let P ′ (resp. P ′′ )
be a parabolic of G0 with Levi L′ (resp. L′′ ) such that S ′ ⊂ NG P ′ (resp. S ′′ ⊂
NG P ′′ ). Let X ′ , X ′′ , K ′ ∈ D(X ′ ), K ′′ ∈ D(X ′′ ), Z be as in 7.4. We may regard Z as
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                         7

a subvariety of X ′ ×X ′′ via the imbedding (g, x′ P ′ , x′′ P ′′ ) 7→ ((g, x′ P ′ ), (g, x′′ P ′′ )).
The inverse image of K ′ ⊠ K ′′ ∈ D(X ′ × X ′′ ) under this imbedding is a complex
K̃ ∈ D(Z). Using a description of K′ , K′′ like in 5.7 we see that K′ ⊗ K′′ = (pr1 )! K̃
where pr1 : Z − → G is the first projection. It follows that Hci (G, K′ ⊗K′′ ) = Hci (Z, K̃)
for all i. Hence it is enough to show that Hci (Z, K̃) = 0 for all i. For any G0 -orbit
E on G0 /P ′ ×G0 /P ′′ let E Z = {(g, x′ P ′ , x′′ P ′′ ) ∈ Z; (x′ P ′ , x′′ P ′′ ) ∈ E}. Using the
partition of Z into the finitely many locally closed subvarieties E Z we see that it is
enough to show that Hci (E Z, K̃) = 0 for all i and any E as above. Using the spectral
sequence of the fibration pr23 : E Z −    → E, (g, x′ P ′ , x′′ P ′′ ) 7→ (x′ P ′ , x′′ P ′′ ) we see
that it is enough to show that for any (x′ , x′′ ) ∈ G0 ×G0 such that (x′ P ′ , x′′ P ′′ ) ∈ E
we have
   Hci (V, K̃) = 0 for all i
where V is the fibre of pr23 at (x′ P ′ , x′′ P ′′ ). We may identify
   V = {g ∈ G; x′−1 gx′ ∈ S̄ ′ UP ′ , x′′−1 gx′′ ∈ S̄ ′′ UP ′′ }.
Define j : V − → S̄ ′ × S̄ ′′ by
         j(g) = (S̄ ′ − component of x′−1 gx′ , S̄ ′′ − component of x′′−1 gx′′ ).
Then K̃|V may be identified with j ∗ (K0′ ⊠ K0′′ ) and we must show that
  Hci (V, j ∗ (K0′ ⊠ K0′′ )) = 0 for all i.
Let Q′ , Q′′ , M ′ , M ′′ , Σ′ , Σ′′ , F ′ , F ′′ be as in 7.8. Let K̂0′ = IC(Σ̄′ , F ′ ), K̂0′′ =
IC(Σ̄′′ , F ′′ ). As in 7.8, V is fibred over
 V1 = {(u′′ , u′ , z) ∈ (M ′ ∩ UQ′′ ) × (M ′′ ∩ UQ′ ) × (M̃ ′ ∩ M̃ ′′ ); zu′′ ∈ Σ̄′ , zu′ ∈ Σ̄′′ }
with all fibres isomorphic to UQ′ ∩ UQ′′ . Since UQ′ ∩ UQ′′ is an affine space we see
that it is enough to show that Hci (V1 , j̄ ∗ (K̂0′ ⊠ K̂0′′ )) = 0 for all i where j̄ : V1 −      →
Σ̄′ × Σ̄′′ is defined by j̄(u′′ , u′ , z) = (zu′′ , zu′ ).
     Assume first that Q′ , Q′′ have no common Levi. Let p̃3 : V1 −            → M̃ ′ ∩ M̃ ′′ be
the third projection. It is enough to show that for any z ∈ M̃ ∩ M̃ ′′ we have ′

Hci (p̃−1          ∗   ′     ′′                           −1                    ′    ′′
          3 (z), j̄ (K̂0 ⊠ K̂0 )) = 0 for all i. Now p̃3 (z) is a product R × R where R
                                                                                                    ′

(resp. R′′ ) is the set of all elements in (M̃ ′ ∩NG Q′′ ) ∩ Σ̄′ (resp. (M̃ ′′ ∩NG Q′ ) ∩ Σ̄′′ )
whose image under M̃ ′ ∩ NG Q′′ −          → M̃ ′ ∩ M̃ ′′ (resp. M̃ ′′ ∩ NG Q′ − → M̃ ′ ∩ M̃ ′′ ) is
                                                           ′              ′′
equal to z. We are reduced to showing that Hci (R′ , K̂0′ ) ⊗ Hci (R′′ , K̂0′′ ) = 0 for all
i′ , i′′ . Since Q′ , Q′′ have no common Levi, we see that either M ′ ∩ Q′′ is a proper
parabolic of M ′ or M ′′ ∩ Q′ is a proper parabolic of M ′′ . In the first case we have
     ′
Hci (R′ , K̂0′ ) = 0 for all i′ since F ′ is a strongly cuspidal local system in S(Σ′ ). In
                                   ′′
the second case we have Hci (R′′ , K̂0′′ ) = 0 for all i′′ since F ′′ is a strongly cuspidal
local system in S(Σ′′ ). Thus the desired vanishing result holds in our case.
     Assume next that Q′ , Q′′ have a common Levi. Then M ′ = M ′′ , M ′ ∩ UQ′′ =
{1}, M ′′ ∩ UQ′ = {1} and we may identify V1 with Σ̄′ ∩ Σ̄′′ . Hence we must only
show that Hci (Σ̄′ ∩ Σ̄′′ , K̂0′ ⊗ K̂0′′ )) = 0 for all i. As in 7.8 we can find v ′ ∈ UP ′ , v ′′ ∈
UP ′′ such that, setting n = v ′−1 x′−1 x′′ v ′′ ∈ G0 , we have n−1 L′ n = L′′ . Then the
desired vanishing result is equivalent to Hci (NG L′ , K0′ ⊗ Ad(n−1 )∗ K0′′ ) = 0 for all
i, which is part of our assumptions. The proposition is proved.
8                                           G. LUSZTIG

                                     24. Orthogonality
24.1. In this section we assume that k is an algebraic closure of a finite field Fq
and that G has a fixed Fq -rational structure with Frobenius map F : G −  → G.
24.2. Let L be a Levi of a parabolic of G0 . Let δ be a connected component of
                        •
NG L such that δ ⊂ NG     L. Assume that F (L) = L, F (δ) = δ and that the F -stable
torus Z = ZL is split over Fq that is, F (z) = z q for all z ∈ Z. We show:
            δ 0

    (a) there exists a parabolic P of G0 with Levi L such that F (P ) = P .
We can find χ ∈ Hom(k∗ , Z) such that ZG0 (χ(k∗ )) = ZG0 (Z). Let g ∈ δ. Define
                                                                −1
χ′ , χ′′ ∈ Hom(k∗ , Z) by χ′ (a) = gχ(a)g −1, χ′′ (a) = F (χ(aq )). To χ, χ′ , χ′′ we
attach parabolics Pχ , Pχ′ , Pχ′′ of G0 as in 1.16. Let P = Pχ . From the definitions
we have Pχ′ = gP g −1 , Pχ′′ = F (P ). Since χ(k∗ ) ⊂ ZG0 (g) we have χ′ = χ. Since
                                        −1
Z is Fq -split, we have χ′′ (a) = χ(aq )q = χ(a) for any a hence χ′′ = χ. Thus,
gP g −1 = P, F (P ) = P . It follows that δ ⊂ NG P . Now ZG0 (χ(k∗ )) is a Levi of P
and ZG0 (Z) = L by 1.10(a). Hence L is a Levi of P . This proves (a).
24.3. Let (L′ , S ′ ), (L′′ , S ′′ ) ∈ A. Assume that E ′ ∈ S(S ′ ) and E ′′ ∈ S(S ′′ ) are
strongly cuspidal relative to NG L′ , NG L′′ respectively. Assume that F (L′ ) =
L′ , F (S ′ ) = S ′ , F (L′′ ) = L′′ , F (S ′′ ) = S ′′ and that we are given isomorphisms
              ∼                       ∼                                                        ∼
ǫ′ : F ∗ E ′ −→ E ′ , ǫ′′ : F ∗ E ′′ −→ E ′′ . Let K′ , K′′ be as in 23.6 and let φ′ : F ∗ K′ −→ K′ ,
                ∼
φ′′ : F ∗ K′′ −→ K′′ be the isomorphisms induced by ǫ′ , ǫ′′ . Let δ ′ (rep. δ ′′ ) be the
connected component of NG L′ (resp. NG L′′ ) that contains S ′ (resp. S ′′ ). Assume
that either L′ , L′′ are not G0 -conjugate or that E ′ and E ′′ are clean (relative to
NG L′ , NG L′′ ). Let Θ = {n ∈ G0F ; n−1 L′ n = L′′ , n−1 S ′ n = S ′′ }. With these
assumptions we state the following result.
Lemma 24.4.
                             X
                  |G0F |−1          χK′ ,φ′ (g)χK′′ ,φ′′ (g)
                             g∈GF
                                           X X
(a)                = |L′F |−1 |L′′F |−1                χE ′ ,ǫ′ (y)χE ′′ ,ǫ′′ (n−1 yn).
                                          n∈Θ y∈S ′F


    The proof is given in 24.7-24.12.
24.5. Let (L′ , S ′ ), (L′′ , S ′′ ) ∈ A. Let δ ′ (resp. δ ′′ ) be the connected component of
                                                                                ′
NG L′ (resp. NG L′′ ) that contains S ′ (resp. S ′′ ). Assume that S ′ = δ ZL0 ′ ×c′ , S ′′ =
  ′′
δ
     ZL0 ′′ × c′′ where c′ is a unipotent L′ -conjugacy class and c′′ is a unipotent L′′ -
conjugacy class. Let F ′ (resp. F ′′ ) be an L′ - (resp. L′′ -) equivariant local system
on c′ (resp. c′′ ) such that Q̄l ⊠ F ′ (resp. Q̄l ⊠ F ′′ ) is a strongly cuspidal local
system relative to NG L′ (resp. NG L′′ ). Assume that F (L′ ) = L′ , F (c′ ) = c′ ,
                                                                                       ∼
F (L′′ ) = L′′ , F (c′′ ) = c′′ and that we are given isomorphisms ǭ′ : F ∗ F ′ −→ F ′ ,
                 ∼
ǭ′′ : F ∗ F ′′ −→ F ′′ . Assume that either L′ , L′′ are not G0 -conjugate or that Q̄l ⊠ F ′
and Q̄l ⊠ F ′′ are clean (relative to NG L′ , NG L′′ ). Let Θ be as in 24.3. With these
assumptions we state the following result.
                  CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                                    9

Lemma 24.6.
                                  X
                    |G0F |−1             QL′ ,G,c′ ,F ′ ,ǭ′ (u)QL′′ ,G,c′′ ,F ′′ ,ǭ′′ (u)
                                u∈GF
                                   un
                                                  X X
(a)                  = |L′F |−1 |L′′F |−1                     χF ′ ,ǭ′ (y)χF ′′ ,ǭ′′ (n−1 yn).
                                                  n∈Θ y∈c′F


   The proof is given (together with that of Lemma 24.4) in 24.7-24.12.
24.7. We prove Lemma 24.4 assuming that L′ , L′′ are not G0 -conjugate. Let
                        ∼
Φ : Hci (G, K′ ⊗ K′′ ) −→ Hci (G, K′ ⊗ K′′ ) be the composition
                       ∼                             ∼
   Hci (G, K′ ⊗ K′′ ) −→ Hci (G, F ∗ K′ ⊗ F ∗ K′′ ) −→ Hci (G, K′ ⊗ K′′ )
(the first map is induced by F : G −     → G, the second map is induced by φ′ ⊗ φ′′ ).
By
P the trace    formula for Frobenius maps, the left hand side of 24.4(a) is equal to
         i        i       ′    ′′                            i     ′      ′′
  i (−1) tr(Φ, Hc (G, K ⊗ K )). This is zero since Hc (G, K ⊗ K ) = 0 for all i, by
23.7. The right hand side of 24.4(a) is also zero, by our assumption. Thus Lemma
24.4 is proved in the present case.
24.8. We prove Lemma 24.4 under the following assumptions:
         ′                   ′′
  S ′ = δ ZL0 ′ c′ , S ′′ = δ ZL0 ′′ c′′ where δ ′ , δ ′ , c′ , c′′ are as in 24.5;
  for some/any c′ ∈ c′ , E ′ |δ′ Z 0 ′ c′ has no direct summand isomorphic to Q̄l ;
                                          L
   for some/any c′′ ∈ c′′ , E ′′ |δ′′ Z 0 ′′ c′′ is isomorphic to Q̄N
                                                                    l for some N .
                                              L
By 24.7 we may assume that L, L′ are G0 -conjugate. Then E ′ , E ′′ are clean. We
show that the left hand side of 24.4(a) is zero. As in 24.7 it is enough to show
that Hci (G, K′ ⊗ K′′ ) = 0 for all i. Using 23.7, it is enough to show that for any
n ∈ G0 such that n−1 L′ n = L′′ we have Hci (NG L′ , K0′ ⊗ Ad(n−1 )∗ K0′′ ) = 0 for
all i. The last equality is clear if n−1 S ′ n 6= S ′′ (in this case n−1 S ′ n ∩ S ′′ = ∅
and we have K0′ ⊗ Ad(n−1 )∗ K0′′ = 0 since E ′ , E ′′ are clean). Assume now that
n−1 S ′ n = S ′′ . Then K0′ ⊗ Ad(n−1 )∗ K0′′ is the local system E ′ ⊗ Ad(n−1 )∗ E ′′ on
S ′ extended by 0 on NG L′ − S ′ . Hence it is enough to show that Hci (S ′ , E ′ ⊗
Ad(n−1 )∗ E ′′ ) = 0 for all i. This follows from 23.5(a) since, by our assumption, the
local system E ′ ⊗ Ad(n−1 )∗ E ′′ has no direct summand isomorphic to Q̄l . Next we
show that the right P hand side of 24.4(a) is−1zero. It is enough to show that for any
n ∈ Θ the sum y∈S ′F χE ′ ,ǫ′ (y)χE ′′ ,ǫ′′ (n yn) is zero. By the trace formula for
Frobenius maps, this sum is an alternating sum of traces of the Frobenius map on
Hci (S ′ , E ′ ⊗ Ad(n−1 )∗ E ′′ ). As we have seen above, this last vector space is zero.
Thus Lemma 24.4 is proved in the present case.
24.9. We prove Lemma 24.4 under the following assumption: there exist parabol-
ics P ′ , P ′′ of G0 with Levi L′ , L′′ respectively such that S ′ ⊂ NG P ′ S ′′ ⊂ NG P ′′ ,
F (P ′ ) = P ′ , F (P ′′ ) = P ′′ .
   By 24.7 we may assume that L, L′ are G0 -conjugate. Then E ′ , E ′′ are clean.
Define XS′ ′ , Ē ′ (resp. XS′′′′ , Ē ′′ ) in terms of (L′ , P ′ , S ′ , E ′ ) (resp. (L′′ , P ′′ , S ′′ , E ′′ ))
in the same way as XS , Ē were defined in terms of (L, P, S, E) in 5.6. Using 5.7
10                                               G. LUSZTIG

and the cleanness of E ′ , E ′′ we see that K′ = f!′ Ē ′ , K′′ = f!′′ Ē ′′ where f ′ : XS′ ′ −
                                                                                               →
       ′′     ′′
G, f : XS ′′ −                                                                      ′   ′′
                    → G are given by the first projection. Note that XS ′ , XS ′′ , f , f ′′ ′
                                                                                           ∼
are naturally defined over Fq and there are obvious isomorphisms F ∗ Ē ′ −→ Ē ′ ,
           ∼
F ∗ Ē ′′ −→ Ē ′′ induced by ǫ′ , ǫ′′ . It follows that
                                              X
                 χK′ ,φ′ (g) =                              χE ′ ,ǫ′ (π ′ (x′−1 gx′ )),
                               x′ P ′F ∈G0F /P ′ F ;x′ −1 gx′ ∈S ′ UP ′
                                                X
         χK′′ ,φ′′ (g) =                                                      χE ′′ ,ǫ′′ (π ′′ (x′′−1 gx′′ )),
                           x′′ P ′′ F ∈G0F /P ′′ F ;x′′ −1 gx′′ ∈S ′′ UP ′′

where π ′ : (S ′ UP ′ )F −→ S ′F , π ′′ : (S ′′ UP ′′ )F −
                                                         → S ′′F are the obvious projections
(see 1.26). Hence the left hand side of 24.4(a) is
                                                          X
(a)                     |G0F |−1 |P ′F |−1 |P ′′F |−1            h(x′ , x′′ )
                                                               x′ ,x′′ ∈G0F

where                            X
               h(x′ , x′′ ) =           χE ′ ,ǫ′ (π ′ (x′−1 gx′ ))χE ′′ ,ǫ′′ (π ′′ (x′′−1 gx′′ ))
                                g∈V F

and V = {g ∈ G; x′−1 gx′ ∈ S ′ UP ′ , x′′−1 gx′′ ∈ S ′′ UP ′′ }.
    Assume first that x′ P ′ x′−1 , x′′ P ′′ x′′−1 have no common Levi. In this case we
show that h(x′ , x′′ ) = 0. By the trace formula for Frobenius maps, h(x′ , x′′ ) is
equal to an alternating sum of traces of Frobenius on Hci (V, K̃) (notation as in the
proof of 23.7). But by the proof of 23.7, in our case we have Hci (V, K̃) = 0 for all
i. (The relevant part of the proof of 23.7 does not make use of the assumptions
in the first sentence of 23.7; it only uses the strong cuspidality of E ′ , E ′′ .) Thus
h(x′ , x′′ ) = 0, as desired.
    Assume now that x′ , x′′ ∈ G0F are such that Q′ = x′ P ′ x′−1 , Q′′ = x′′ P ′′ x′′−1
have a common Levi M ′ = M ′′ (we may assume that M ′ = M ′′ is F -stable). Then
we can find v ′ ∈ UPF′ , v ′′ ∈ UPF′′ such that, setting n = v ′−1 x′−1 x′′ v ′′ ∈ G0F , we
have n−1 L′ n = L′′ . Also, n is uniquely determined by x′ , x′′ . Let Σ′ , Σ′′ be strata
of NG M ′ = NG M ′′ as in 7.8. As in 7.8, we have a natural map V −                → V1 = Σ′ ∩ Σ′′
with fibres isomorphic to UQ′ ∩ UQ′′ ∼       = UP ′ ∩ UnP ′′ n−1 . In particular, V = ∅ unless
Σ ∩ Σ 6= ∅ or equivalently, Σ = Σ′′ or equivalently, n−1 S ′ n = S ′′ . If this last
  ′     ′′                            ′

condition is satisfied, we have
                                                   X
               h(x′ , x′′ ) = |UPF′ ∩ UnP
                                        F
                                          ′′ n−1 |     χE ′ ,ǫ′ (y)χE ′′ ,ǫ′′ (n−1 yn).
                                                         y∈S ′F

It is then enough to show that
                 ♯((x′ , x′′ ) ∈ G0F × G0F ; x′−1 x′′ ∈ UPF′ nUPF′′ )
                  = |G0F ||P ′F ||P ′′F ||L′F |−1 |L′′F |−1 |UPF′ ∩ UnP
                                                                     F
                                                                        ′′ n−1 |.


This is immediate. Thus Lemma 24.4 is proved in the present case.
                   CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                                           11

24.10. We show that Lemma 24.4 holds for G under the assumption that Lemma
24.6 holds when G is replaced by ZG (s) where s is any semisimple element of GF .
We evaluate the left hand side of 24.4(a) using the ”character formula” 16.14. We
have
                  X                                       X        X
         |G0F |−1     χK′ ,φ′ (g)χK′′ ,φ′′ (g) = |G0F |−1
                       g∈GF                                                  s∈GF semis. x′ ,x′′ ∈G0F
                                                                                         x′ −1 sx′ ∈Ss′
                                                                                        x′′ −1 sx′′ ∈Ss′′

           |ZG (s)0F |−2 |L′x′ F ||L′F |−1 |L′′x′′ F ||L′′F |−1 f (s, x′ , x′′ , d′ , d′′ )

where
  L′x′ = x′ L′ x′−1 ∩ ZG (s)0 , L′′x′′ = x′′ L′′ x′′−1 ∩ ZG (s)0 ,
  d′ runs over the set of F -stable L′x′ -conjugacy classes contained in
  {v ∈ ZG (s); v unipotent, x′−1 svx′ ∈ S ′ },
  d′′ runs over the set of F -stable L′′x′′ -conjugacy classes contained in
  {v ∈ ZG (s); v unipotent, x′′−1 svx′′ ∈ S ′′ }, and
                                        X
   f (s, x′ , x′′ , d′ , d′′ ) =               QL′ ′ ,ZG (s),d′ ,F ′ ′ ,ǫ′ ′ (u)QL′′′′ ,ZG (s),d′′ ,F ′′′′ ,ǫ′′′′ (u).
                                                   x                x    x           x                 x    x
                                   u∈ZG (s)F
                                    uunip.


Here Fx′ ′ is the inverse image of E ′ under d′ −      → S ′ , v 7→ x′−1 svx′ , Fx′′′′ is the
                       ′′        ′′       ′′     ′′−1                               ∼
inverse image of E under d −        → S , v 7→ x      svx′′ , and ǫ′x′ : F ∗ Fx′ ′ −→ Fx′ ′ , ǫ′′x′′ :
            ∼
F ∗ Fx′′′′ −→ Fx′′′′ are induced by ǫ′ , ǫ′′ .
   Using our assumption we have
                                                                                              X
              f (s, x′ , x′′ , d′ , d′′ ) = |ZG (s)0F ||L′x′ F |−1 |L′′x′′ F |−1
                                                                                          n∈ZG (s)0F
                                                                                         n−1 L′x′ n=L′′
                                                                                                     x′′
                                                                                          n−1 d′ n=d′′
                    X
(a)            ×           χF ′ ′ ,ǫ′ ′ (v)χF ′′′′ ,ǫ′′′′ (n−1 vn).
                              x     x          x    x
                   v∈d′F


To be able to apply our assumption, we use 23.4(a),(b). We also use the following
fact.
   For s, x′ , x′′ as above and for n ∈ ZG (s)0 , the condition n−1 L′x′ n = L′′x′′ is
equivalent to n−1 x′ Lx′−1 n = x′′ Lx′′ .
Indeed, since S ′ is an isolated stratum of NG L′ and x′−1 sx′ ∈ Ss , we see using 18.2
that x′−1 sx′ is isolated in NG L′ . Hence s is isolated in NG (x′ L′ x′−1 ). It follows
that s is isolated in NG (n−1 x′ L′ x′−1 n). Similarly, s is isolated in NG (x′′ L′′ x′′−1 ).
By the injectivity of the map a in 21.3 (for s instead of g) we see that

   n−1 x′ L′ x′−1 n ∩ Z(s)0 = x′′ L′′ x′′−1 ∩ ZG (s)0 ↔ n−1 x′ L′ x′−1 n = x′′ L′′ x′′−1 ,
12                                                 G. LUSZTIG

that is n−1 L′x′ n = L′′x′′ ↔ n−1 x′ L′ x′−1 n = x′′ L′′ x′′−1 , as required. We have

     χFx′ ′ ,ǫ′x′ (v) = χE ′ ,ǫ′ (x′−1 svx′ ),      χFx′′′′ ,ǫ′′x′′ (n−1 vn) = χE ′′ ,ǫ′′ (x′′−1 sn−1 vnx′′ ).

Note also that the condition n−1 d′ n = d′′ implies n−1 x′ S ′ x′−1 n = x′′ S ′′ x′′−1 . We
see that
                        X
          |G0F |−1             χK′ ,φ′ (g)χK′′ ,φ′′ (g)
                        g∈GF
                                                        X
           = |G0F |−1 |L′F |−1 |L′′F |−1                               |ZG (s)0F |−1
                                                  s∈GF semis.
                                                 x′ ,x′′ ∈G0F ,d′
                                                  x′ −1 sx′ ∈Ss′
                                                 x′′ −1 sx′′ ∈Ss′′
                         X                   X
                                                    χE ′ ,ǫ′ (x′−1 svx′ )χE ′′ ,ǫ′′ (x′′−1 sn−1 vnx′′ ).
                 n∈ZG (s)0F                v∈d′F
            −1 ′ ′ ′ −1
           n xLx        n=x′′ L′′ x′′ −1
            −1 ′ ′ ′ −1    ′′ ′′ ′′ −1
           n     xS x     n=x S x


We now make the change of variable (x′ , x′′ , n) 7→ (x′ , n, n′ ), n′−1 = x′′−1 n−1 x′ .
The condition n−1 x′ L′ x′−1 n = x′′ L′′ x′′−1 becomes n′−1 L′ n′ = L′′ ; the condition
n−1 x′ S ′ x′−1 n = x′′ S ′′ x′′−1 becomes n′−1 S ′ n′ = S ′′ (thus, n′ ∈ Θ). The condition
x′′−1 sx′′ ∈ Ss′′ becomes n′−1 x′−1 nsn−1 x′ n′ ∈ n′−1 Ss′ n′ that is x′−1 sx′ ∈ Ss′ . Our
sum becomes
                                                    X
            |G0F |−1 |L′F |−1 |L′′F |−1                         |ZG (s)0F |−1
                                               s∈GF semis.
                                                 x′ ∈G0F
                                                ′ −1
                                               x     sx′ ∈Ss′
                  X                X
                                                 χE ′ ,ǫ′ (x′−1 svx′ )χE ′′ ,ǫ′′ (n′−1 x′−1 svx′ n′ ).
               n∈ZG (s)0F v∈ZG (s)F ;v unip.
                 n′ ∈Θ      x′ −1 svx′ ∈S ′


We make the change of variable (s, x′ , v) 7→ (s′ , x′ , v ′ ) where s′ = x′−1 sx′ ∈ Ss′ ,
v ′ = x′−1 vx′ ∈ ZG (s′ ) ∩ s′−1 S ′ . Our sum becomes
                                   X                X
          |L′F |−1 |L′′F |−1                                           χE ′ ,ǫ′ (s′ v ′ )χE ′′ ,ǫ′′ (n′−1 s′ v ′ n′ )
                                 s′ ∈Ss′ F v ′ ∈ZG (s′ )F ;v ′ unip.
                                  n′ ∈Θ          v ′ ∈s′−1 S ′
                                      X X
           = |L′F |−1 |L′′F |−1                      χE ′ ,ǫ′ (y)χE ′′ ,ǫ′′ (n′−1 yn′ ),
                                     n′ ∈Θ y∈S ′F


as required.
                  CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                                      13

24.11. We show that Lemma 24.6 holds for G under the assumption that Lemma
24.6 holds when G is replaced by ZG (s) where s is any semisimple element of GF
such that dim ZG (s) < dim G (that is, s ∈         / ZG (G0 )).
                     ′                   ′′
    Let L′ ∈ S(δ ZL0 ′ ), L′′ ∈ S(δ ZL0 ′′ ) be local systems of rank 1 with given
                              ∼                        ∼
isomorphisms ι′ : F ∗ L′ −→ L′ , ι′′ : F ∗ L′′ −→ L′′ . Let E ′ = L′ ⊠ F ′ ∈ S(S ′ ),
                                                           ∼                                    ∼
E ′′ = L′′ ⊠ F ′′ ∈ S(S ′′ ). Let ǫ′ = ι′ ⊠ ǭ′ : F ∗ E ′ −→ E ′ , ǫ′′ = ι′′ ⊠ ǭ′′ : F ∗ E ′′ −→ E ′′ .
Note that E ′ , E ′′ are strongly cuspidal by 23.4(c) and that, if L′ , L′′ are not G0 -
conjugate then E ′ , E ′′ are clean by 23.4(d). For this E ′ , E ′′ we can still try to
carry out the argument in 24.10 but now we can only use 24.6(a) for s such that
s∈ / ZG (G0 ). We obtain:
                       X
            |G0F |−1         χK′ ,φ′ (g)χK′′ ,φ′′ (g)
                          g∈GF
                                            X X
               − |L′F |−1 |L′′F |−1                      χE ′ ,ǫ′ (y)χE ′′ ,ǫ′′ (n−1 yn)
                                            n∈Θ y∈S ′F
                                       X                      X
               = |G0F |−1
                              s∈ZG (G0 )F semis. x′ ,x′′ ∈G0F ,d′ ,d′′
                                                     x′ −1 sx′ ∈Ss′
                                                    x′′−1 sx′′ ∈Ss′′

              |ZG (s)0F |−2 |L′x′ F ||L′F |−1 |L′′x′′ F ||L′′F |−1
                    X
              (                QL′ ′ ,ZG (s),d′ ,F ′ ′ ,ǫ′ ′ (u)QL′′′′ ,ZG (s),d′′ ,F ′′′′ ,ǫ′′′′ (u)
                                        x                x    x          x                 x   x
                u∈ZG (s)F ;unip.
                                                                   X
               − |ZG (s)0F ||L′x′ F |−1 |L′′x′′ F |−1
                                                              n∈ZG (s)0F
                                                             n L′x′ n=L′′
                                                              −1
                                                                        x′′
                                                              n−1 d′ n=d′′
                X
(a)                    χFx′ ′ ,ǫ′x′ (v)χFx′′′′ ,ǫ′′x′′ (n−1 vn))
               v∈d′F

(notation of 24.10.) For each s, x′ , x′′ in the right hand side of (a) we have s =
             ′                          ′′
x′−1 sx′ ∈ δ ZL0 ′ . Similarly, s ∈ δ ZL0 ′′ . In particular we have s ∈ G0 hence s ∈ ZG0
and ZG (s)0 = G0 , L′x′ = x′ L′ x′−1 , L′′x′′ = x′′ L′′ x′′−1 . Also we necessarily have
d′ = x′ c′ x′−1 , d′′ = x′′ c′′ x′′−1 . We see that the right hand side of (a) is
                    X                X
|G0F |−1
          s∈ZG0 ∩δ ′ ZL
                      0 ∩δ ′′ Z 0
                        ′      L′′
                                   x′ ,x′′ ∈G0F
                  X
|G0F |−2 (                      QL′ ,ZG (s),c′ ,F ′ ,ǭ′ (u)QL′′ ,ZG (s),c′′ ,F ′′ ,ǭ′′ (u)
             u∈ZG (s)F ;unip.
                                                X                    X
− |G0F ||L′F |−1 |L′′F |−1                                                   χF ′ ,ǭ′ (v)χF ′′ ,ǭ′′ (x′′−1 n−1 x′ vn))
                                             n∈G0F                 v∈c′F
                                  n−1 x′ L′ x′ −1 n=x′′ L′′ x′′ −1
                                      n−1 x′ c′ x′ −1 n=c′′
14                                                 G. LUSZTIG

or equivalently
                                    X
           |G0F |−1
                                    ′
                                  0 ∩δ Z 0    ′′
                        s∈ZG0 ∩δ ZL ′   L′′
                      X
           (                      QL′ ,ZG (s),c′ ,F ′ ,ǭ′ (u)QL′′ ,ZG (s),c′′ ,F ′′ ,ǭ′′ (u)
               u∈ZG (s)F ;unip.
                                                   X X
(b)         − |G0F ||L′F |−1 |L′′F |−1                           χF ′ ,ǭ′ (v)χF ′′ ,ǭ′′ (n′−1 vn′ )).
                                                   n′ ∈Θ v∈c′F

Let D′ (resp. D′′ ) be the connected component of G that contains δ ′ (resp. δ ′′ ) For
each s in the sum we have D′ ⊂ ZG (s), D′′ ⊂ ZG (s); moreover QL′ ,ZG (s),c′ ,F ′ ,ǭ′ (u) =
0 unless u ∈ D′ and QL′′ ,ZG (s),c′′ ,F ′′ ,ǭ′′ (u) = 0 unless u ∈ D′′ . We see that
                     X
                             QL′ ,ZG (s),c′ ,F ′ ,ǭ′ (u)QL′′ ,ZG (s),c′′ ,F ′′ ,ǭ′′ (u)
                  u∈ZG (s)F ;unip.
                          X
                  =                  QL′ ,G,c′ ,F ′ ,ǭ′ (u)QL′′ ,G,c′′ ,F ′′ ,ǭ′′ (u).
                      u∈GF ;unip.

Hence (a) becomes
                          X
           |G0F |−1            χK′ ,φ′ (g)χK′′ ,φ′′ (g)
                        g∈GF
                                        X X
            − |L′F |−1 |L′′F |−1                        χE ′ ,ǫ′ (y)χE ′′ ,ǫ′′ (n−1 yn)
                                        n∈Θ y∈S ′ F
                                          ′            ′′
            = |G0F |−1 ♯(ZG0 ∩ δ ZL0 ′ ∩ δ ZL0 ′′ )
               X
           (          QL′ ,G,c′ ,F ′ ,ǭ′ (u)QL′′ ,G,c′′ ,F ′′ ,ǭ′′ (u)
               u∈GF ;unip.
                                                   X X
(c)         − |G0F ||L′F |−1 |L′′F |−1                           χF ′ ,ǭ′ (v)χF ′′ ,ǭ′′ (n′−1 vn′ )).
                                                   n′ ∈Θ v∈c′F

Hence to prove the equality 24.6(a) it is enough to show that the left hand side
of (c) is zero. In order to do so, we are free to choose L′ , L′′ , ι′ , ι′′ in a convenient
way.
                          ′
      Assume first that δ ZL0F′ 6= {1}. Then we can find a non-trivial character θ ′ :
δ ′ 0F
   ZL′ −  → Q̄∗l and L′ , ι′ as above such that χL′ ,ι′ = θ ′ . We have L′ ∼     6 Q̄l . Let
                                                                                  =
L = Q̄l and take any ι′′ . With these choices, 24.8 shows that the left hand side
   ′′

of (c) is zero.
                          ′′
      Assume next that δ ZL0F′′ 6= {1}. Since L′ , L′′ play a symmetrical role we see as
in the previous paragraph that the left hand side of (c) is zero.
                              ′                 ′′
      Finally, assume that δ ZL0F′ = {1} and δ ZL0F′′ = {1}. Then the F -stable tori
δ′ 0       ′′
   ZL′ , δ ZL0 ′′ are necessarily split over Fq and q = 2. Using 24.2(a) we can find
                 CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                              15

parabolics P ′ , P ′′ of G0 with Levi L′ , L′′ such that F (P ′ ) = P ′ , F (P ′′ ) = P ′′ .
Then 24.9 shows that the left hand side of (c) is zero. Thus Lemma 24.6 is proved
in the present case.
24.12. Clearly, the arguments in 24.10, 24.11 provide an inductive proof of Lem-
mas 24.4, 24.6.
24.13. In the setup of 24.3, assume that E ′ , E ′′ are irreducible. Let

       Θ(E ′ , E ′′ ) = {n ∈ G0F ; n−1 L′ n = L′′ , n−1 S ′ n = S ′′ , Ad(n−1 )∗ E ′′ ∼
                                                                                      = Ě ′ }.

If n ∈ Θ(E ′ , E ′′ ) the local system Ê = E ′ ⊗ Ad(n−1 )∗ E ′′ is canonically of the form
Q̄l ⊕ Ê1 where Ê1 ∈ S(S) has no direct summand Q̄l . The isomorphisms ǫ′ , ǫ′′
                                    ∼
induce an isomorphism F ∗ Ê −→ Ê which respects the summand Q̄l and induces
                                                        ∼
on it ζ(n) times the obvious isomorphism F ∗ Q̄l −→ Q̄l . Here ζ(n) ∈ Q̄∗l is well
defined.
   We show that, if n ∈ Θ(E ′ , E ′′ ) and n0 ∈ G0F , n−1         ′       ′   −1 ′
                                                           0 L n0 = L , n0 S n0 = S ,
                                                                                          ′
          ∗ ′ ∼ ′
Ad(n−1                                  ′  ′′
      0 ) E = E , then n0 n ∈ Θ(E , E ) satisfies
                         −1
   (a) ζ(n0 n) = η(n0 )ζ(n)
                                                 −1 ∗ ′ ∼
where η(n−10 ) is as in 21.6. Let α : Ad(n0 ) E −        → E ′ be an isomorphism. We
have an isomorphism

               Ad(n−1 ∗  ′
                   0 ) (E ⊗ Ad(n
                                 −1 ∗ ′′
                                   ) E )
                                                            α⊗1
               = Ad(n−1 ∗ ′
                     0 ) E ⊗ Ad(n
                                  −1 −1 ∗ ′′
                                    n0 ) E −−−→ E ′ ⊗ Ad(n−1 n−1 ∗ ′′
                                                              0 ) E

which must carry the summand Ad(n−1                   ∗
                                                   0 ) (Q̄l ) to P the summand Q̄l . Let x ∈ S ′F .
       ′       ′             ′′    ′′
Let ei ∈ En−1 xn , ei ∈ En−1 n−1 xn n be such that i e′i ⊗ e′′i belongs to the fibre
                 0       0            0      0
                                                                                          P
of the summand Q̄l of Ad(n−1          0   ) ∗ ′
                                             E    ⊗ Ad(n−1 n−1      ∗ ′′
                                                                0 ) E at x. Then
                                                                                                 ′
                                                                                           i α(ei ) ⊗ ei
                                                                                                           ′′

belongs to the fibre of the summand Q̄l of E ′ ⊗Ad(n−1 n−1                      ∗ ′′
                                                                          0 ) E at x. By definition,
X                                   X              X                                      X
    ǫ′ (e′i ) ⊗ ǫ′′ (e′′i ) = ζ(n)    e′i ⊗ e′′i ,   ǫ′ (α(e′i )) ⊗ ǫ′′ (e′′i ) = ζ(n0 n)    α(e′i ) ⊗ e′′i ,
 i                                 i              i                                         i

                                      ǫ′ (α(e′i )) = η(n−1    ′ ′
                                                        0 )α(ǫ (ei )).


We deduce
      X
         ǫ′ (α(e′i )) ⊗ ǫ′′ (e′′i )
           i
                                X                                                    X
         = η(n−1
              0 )(α ⊗ 1)(              ǫ′ (e′i )) ⊗ ǫ′′ (e′′i ))η(n−1
                                                                   0 )ζ(n)(α ⊗ 1)(        e′i ⊗ e′′i )
                                  i                                                   i

and (a) follows.
  From (a) we deduce:
  (b) if (L′ , S ′ , E ′ ) is effective (see 21.6) then ζ : Θ(E ′ , E ′′ ) −
                                                                           → Q̄∗l is constant.
16                                              G. LUSZTIG

                                      P
Lemma 24.14. If n ∈ Θ then                     y∈S ′ F   χE ′ ,ǫ′ (y)χE ′′ ,ǫ′′ (n−1 yn) equals

                                                         ′
                                                             −dim L′
                                    ζ(n)q dim S                        |L′F |

if n ∈ Θ(E ′ , E ′′ ) and 0, otherwise.

   In the following proof we write S instead of S ′ and δ for the connected com-
ponent of NG L′ that contains S. By the trace formula for Frobenius maps our
sum is an alternating sum of traces of the Frobenius map on Hci (S, Ê) where
Ê = E ′ ⊗ Ad(n−1 )∗ E ′′ . If n ∈ / Θ(E ′ , E ′′ ) then Ê has no direct summand isomorphic
to Q̄l hence by 23.5(a), Hci (S ′ , Ê) = 0. Thus we may assume that n ∈ Θ(E ′ , E ′′ ).
Then we have canonically Ê = Q̄l ⊕Eˆ1 as in 24.13. As in the proof of 23.5(a) we have
Hci (S, Ê1 ) = 0 for all i hence Hci (S, Ê) = Hci (S, Q̄l ). By   Pthe definition of ζ(n) in
24.13 we see that the sum in the lemma is equal to ζ(n) i (−1)i tr(F ∗ , Hci (S, Q̄l )).
Let f : S̃ −   → S be as in 23.5 (for a fixed y ∈ S F and for NG L′ , δ instead of
G, D). Then S̃, f are defined over Fq and from the proof of 23.5 we see that
tr(F ∗ , Hci (S, Q̄l )) = tr(F ∗ , Hci (S̃, Q̄l )). Hence our sum is equal to
                              X
                       ζ(n)    (−1)i tr(F ∗ , Hci (S̃, Q̄l )) = ζ(n)|S̃ F |
                               i

                        = ζ(n)|δ ZL0F′ ||L′F ||ZL′ (y)0F |−1 .

By 10.2, ZL′ (y)0 /δ ZL0 ′ is a (connected) unipotent group. Hence

                                                     δ    0               0                    ′
              |δ ZL0F′ ||ZL′ (y)0F |−1 = q dim           ZL ′ −dim ZL′ (y)
                                                                                = q dim S−dim L .

The lemma is proved.

Proposition 24.15. In the setup of 24.3 and assuming that E ′ , E ′′ are irreducible
and (L′ , S ′ , E ′ ), (L′′ , S ′′ , E ′′ ) are effective, the sum
                                               X
                              |G0F |−1               χK′ ,φ′ (g)χK′′ ,φ′′ (g)
                                              g∈GF


is 0 if Θ(E ′ , E ′′ ) = ∅ and is equal to

                                          ′
                                              −dim L′
                               ζq dim S                  |Θ(E ′ , E ′′ )|/|L′F |

where ζ = ζ(n) (see 24.13) for any n ∈ Θ(E ′ , E ′′ ) if Θ(E ′ , E ′′ ) 6= ∅.

     This follows from the results in 24.4, 24.13, 24.14.
                  CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                                       17

Proposition 24.16. In the setup of 24.5 let E ′ = Q̄l ⊠F ′ ∈ S(S ′ ), E ′′ = Q̄l ⊠F ′′ ∈
                                         ∼                                          ∼
S(S ′′ ) and let ǫ′ = 1 ⊠ ǭ′ : F ∗ E ′ −→ E ′ , ǫ′′ = 1 ⊠ ǭ′′ : F ∗ E ′′ −→ E ′′ . Assume that
F ′ , F ′′ are irreducible. Then the sum
                               X
                     |G0F |−1        QL′ ,G,c′ ,F ′ ,ǭ′ (u)QL′′ ,G,c′′ ,F ′′ ,ǭ′′ (u)
                                       u∈GF
                                          un


is 0 if Θ(E ′ , E ′′ ) = ∅ and is equal to
                                                ′                              ′
                            ζq dim S−dim L |Θ(E ′ , E ′′ )||L′F |−1 |δ ZL0F′ |−1
where ζ = ζ(n) (defined as in 24.13 in terms of ǫ′ , ǫ′′ ) for any n ∈ Θ(E ′ , E ′′ ) if
Θ(E ′ , E ′′ ) 6= ∅.
   If n ∈ Θ (see 24.3) we have clearly
                      X
                          χF ′ ,ǭ′ (y)χF ′′ ,ǭ′′ (n−1 yn)
                            y∈c′ F
                                   ′                X
                             = |δ ZL0F′ |−1              χE ′ ,ǫ′ (y)χE ′′ ,ǫ′′ (n−1 yn).
                                                y∈S ′F

The last sum can be evaluated using the results in 24.13, 24.14. (In our case,
(L′ , S ′ , E ′ ), (L′′ , S ′ , E ′′ ) are automatically effective, see 21.8.) We introduce this in
Lemma 24.6. The proposition follows.
                                                                              ∼
24.17. Let A ∈ A(G) (see 21.18) and let α : F ∗ A −→ A be an isomorphism. We
have A = IC(Ȳ , A) (extended by 0 on G − Ȳ ) where Ȳ is the closure of a stratum
YL,S , (L, S) ∈ A and A is an irreducible local system on Ȳ which is a direct
summand of π! Ẽ (here E ∈ S(S) is irreducible cuspidal and π, Ẽ are as in 5.6). By
21.19, 21.20 we can assume that F (L) = L, F (S) = S and F ∗ E ∼                      = E. We consider
       ′                   ′      ∗ ′ ∼        ′          ′  ′    ′   ′    ′    ′ ′
also A ∈ A(G) and α : F A −→ A . Let L , S , E , A , Ȳ , π! Ẽ play the same role
for A′ as L, S, E, A, Ȳ , π! Ẽ for A. (In particular, A′ = IC(Ȳ ′ , A′ ) extended by 0 on
                                                                                  ∼              ∼
G − Ȳ ′ , F (L′ ) = L′ , F (S ′ ) = S ′ , F ∗ E ′ ∼
                                                   = E ′ .) We fix ǫ : F ∗ E −→ E, ǫ′ : F ∗ E ′ −→ E ′ .
Let
                G̃, Γ, Kw , φw , nw , gw , Lw , S w , E w , ǫw , r, E, bw , ιi , Vi , Ki , φi
be associated with L, S, E, ǫ as in 21.6 and let
                      ′       ′                     ′      ′       ′      ′
       G̃′ , Γ′ , K′w , φ′w , n′w′ , gw
                                      ′
                                        ′, L
                                             ′w
                                                , S ′w , E ′w , ǫ′w , r ′ , E′ , b′w′ , ι′i′ , Vi′′ , K′i′ , φ′i′
be associated in Pan analogous way to L′ , S ′ , E ′ , ǫ′ . From 21.6(c) we have
   (a) χKw ,φw = i∈[1,r] tr(bw ιi , Vi )χKi ,φi
for any effective w ∈ Γ. We multiply both sides of (a) by |Γ|−1 tr(ι−1        −1
                                                                           j bw , Vj ) and
sum over all effective w ∈ Γ. Using 20.4(c) we obtain
                                        X
                     χKj ,φj = |Γ|−1            tr(ι−1  −1
                                                    j bw , Vj )χKw ,φw
                                                    w∈Γ;eff.
18                                              G. LUSZTIG

for any j ∈ [1, r]. Similarly,
                                             X
                  χK′j′ ,φ′j′ = |Γ′ |−1                   tr(ι′j ′ −1 b′w′ −1 , Vj′′ )χK′ w′ ,φ′ w′
                                          w ′ ∈Γ′ ;eff.


for any j ′ ∈ [1, r ′ ]. It follows that
                         X
             |G0F |−1          χKj ,φj (g)χK′j′ ,φ′j′ (g)
                        g∈GF
                                  X           X
              = |Γ|−1 |Γ′ |−1                             tr(ι−1 −1          ′ −1 ′ −1
                                                              j bw , Vj )tr(ιj ′ bw′ , Vj′′ )
                                w∈Γ;eff. w ′ ∈Γ′ ;eff.
                            X
(b)          × |G0F |−1            χKw ,φw (g)χK′ w′ ,φ′ w′ (g)
                           g∈GF


for any j ∈ [1, r], j ′ ∈ [1, r ′ ].
Proposition 24.18. Assume that Ě, E ′ are strongly cuspidal. Assume also that
either L, L′ are not G0 -conjugate or Ě, E ′ are clean. Then
                                    X
                           |G0F |−1       χA,α (g)χA′ ,α′ (g)
                                              g∈GF


is 0 if A′ ∼
           6 Ǎ and is q dim S−dim L if A′ = Ǎ and α′ = α̌.
            =
    We may assume that A = Kj , α = φj , A′ = K′j ′ , α′ = φ′j ′ for some j ∈ [1, r],
j ′ ∈ [1, r ′ ]. If (L, S, Ě), (L′ , S ′ , E ′ ) are not G0 -conjugate, the result follows from
24.17(b) since by 24.15 we have
                                       X
                          |G0F |−1            χKw ,φw (g)χK′w′ ,φ′w′ (g) = 0
                                       g∈GF


for any effective w, w′ .
     Thus we may assume that (L, S, Ě), (L′ , S ′ , E ′ ) are G0 -conjugate. We may also
assume that L = L′ , S = S ′ , Ě = E ′ , ǫ′ = ǫ̌. We have G̃′ = G̃, Γ′ = Γ, Ẽ ′ = (Ẽ)ˇ,
π!′ Ẽ ′ = (π! Ẽ)ˇ. Taking transpose we may identify E′ = E as vector spaces but
with opposed algebra structures. Then E′w = Ew−1 for any w ∈ Γ and we may
assume that b′w ∈ E′w corresponds to b−1                                          ′
                                               w ∈ Ew −1 . The simple E modules are
Vi′ = Vi∗ (dual space) with E′ -action given by taking transpose. We take ι′i to
be the transpose inverse of ιi . We have r ′ = r, K′i = (Ki )ˇ, φ′i = (φi )ˇ. We take
n′w = nw , gw  ′
                   = gw . Then L′w = Lw , S ′w = S w , E ′w = (E w )ˇ, ǫ′w = (ǫw )ˇ. Moreover
for w ∈ Γ, (Lw , S w , E w ) is effective if and only if (Lw , S w , (E w )ˇ) is effective.
     Let w, w′ ∈ Γ. We compute

     aw,w′ = ♯(n ∈ G0F ; n−1 Lw n = Lw , n−1 S w n = S w , Ad(n−1 )∗ (E w )ˇ∼
                                      ′                 ′                ′
                                                                            = (E w )ˇ).
                   CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                          19

         −1
Setting gw  ngw′ = n we see that
                                               −1           −1
                     aw,w′ = ♯(n ∈ G̃; F (gw ngw ′ ) = gw ngw ′ )
                                                            X
                      = ♯(n ∈ G̃; n−1
                                   w F (n)nw ′ = n) =                        |∆F
                                                                               y |
                                                                                 0


                                                                y∈Γ
                                                          w −1 F (y)w ′ =y


where ∆y is the L-coset in G̃ defined by y and F0 : ∆y −               → ∆y is F0 (n) =
n−1
 w  F  (n)n w ′ . Now L w
                           acts freely     on  ∆ y by l 1 : n →
                                                              7 l 1 ∗ n    −1
                                                                        = gw  l1 gw n; this
action satisfies F0 (l1 ∗ n) = F (l1 ) ∗ F0 (n). It follows that |∆y | = |LwF | and
                                                                        F0

aw,w′ |LwF |−1 = ♯(y ∈ Γ; w−1 F (y)w′ = y). Using this and 24.15 we see that for
any effective w, w′ ∈ Γ:
                  X
    |G0F |−1        χKw ,φw (g)χK′ w′ ,φ′ w′ (g)
                 g∈GF

     = q dim S−dim L aw,w′ |LwF |−1 = ζw,w′ q dim S−dim L ♯(y ∈ Γ; w−1 F (y)w′ = y).

Here ζw,w′ ∈ Q̄∗l is defined as follows (assuming that {y ∈ Γ; w−1 F (y)w′ = y} =
                                                                                6 ∅):
              0F
for any n ∈ G such that

                   n−1 Lw n = Lw , n−1 S w n = S w , Ad(n−1 )∗ (E w )ˇ ∼
                                ′                 ′                ′
                                                                       = (E w )ˇ,
        ′
ǫw , (ǫw )ˇinduce an isomorphism
                             ′                           ′
                                  → E w ⊗ Ad(n−1 )∗ (E w )ˇ
    F ∗ (E w ⊗ Ad(n−1 )∗ (E w )ˇ) −
                                                           ′
which on the summand Q̄l of E w ⊗ Ad(n−1 )∗ (E w )ˇ is ζw,w′ times the obvious
                       ∼
isomorphism F ∗ Q̄l −→ Q̄l .
                               −1
    For n as above we set gw      ngw′ = n ∈ G̃ and let y be the image of n in Γ. Let
g ∈ S, let (eh ) be a basis of Eg and let (ěh ) be the dual basis of Ěg . We have
                                         ∼
an isomorphism by : Ad(n−1 )∗ E −→ E. Taking transpose inverse we obtain an
                                       ∼                                       ∼
isomorphism t b−1 y : Ad(n
                             −1 ∗
                                 ) Ě −→ Ě. This restricts to t b−1
                                                                  y : Ěn−1 gn −
                                                                               → Ěg and
P           t                                                                 −1 ∗
   h eh ⊗ by (ěh ) belongs to the fibre of the summand Q̄l of E ⊗ Ad(n          ) Ě at g.
We have
                                               ′
                 E w ⊗ Ad(gw′ n−1 gw
                                   −1 ∗             −1 ∗
                                     ) (E w )ˇ= Ad(gw ) (E ⊗ Ad(n−1 )∗ Ě)
        P
hence       h eh   ⊗ t by (ěh ) belongs to the fibre of the summand Q̄l of
                                                                ′
                                  E w ⊗ Ad(gw′ n−1 gw
                                                    −1 ∗
                                                      ) (E w )ˇ
        −1
at gw ggw  ∈ S w . Assuming that gw ggw      −1
                                                ∈ S wF we see from the definitions that
          X                ′                      X
             ǫw (eh ) ⊗ ǫ̌w (t by (ěh )) = ζw,w′    eh ⊗ t by (ěh ) ∈ Eg ⊗ Ěn−1 gn
             h                                      h
20                                                G. LUSZTIG

hence
            X                                                X
                 ǫ(bw eh ) ⊗ ǫ̌(t b−1 t
                                   w ′ by (ěh )) = ζw,w ′       eh ⊗ t by (ěh ) ∈ Eg ⊗ Ěn−1 gn .
             h                                               h

Applying ǫ−1 ⊗ ǫ̌−1 to both sides and using ǫ̌−1t by = t (ι−1 (by ))ǫ̌−1 we obtain
        X                                     X
            bw eh ⊗ t b−1 t
                       w ′ by (ěh ) = ζw,w ′   ǫ−1 (eh ) ⊗ t (ι−1 (by ))ǫ̌−1 (ěh ).
                 h                                       h

Setting e′h = ǫ−1 (eh ), ě′h = ǫ̌−1 (ěh ) we see that (e′h ), (ě′h ) are dual bases of EF (g), ĚF (g)
and we have
     X                                         X
         bw eh ⊗ t b−1
                    w ′
                        t
                          b y (ěh ) = ζ w,w ′   e′h ⊗ t (ι−1 (by ))ě′h ∈ EF (g) ⊗ ĚF (n−1 gn) .
        h                                          h

Applying 1 ⊗ t (ι−1 (by ))−1 to both sides gives
    X                                                     X
        bw eh ⊗ t (ι−1 (by ))−1t b−1 t
                                  w ′ by (ěh )) = ζw,w ′   e′h ⊗ ě′h ∈ EF (g) ⊗ ĚF (g).
        h                                                           h

Let e′′h = bw eh , ě′′h = t b−1             ′′      ′′
                              w ěh . Then (eh ), (ěh ) are dual bases of

                                   Enw gn−1
                                         w
                                            = EF (g) , Ěnw gn−1
                                                              w
                                                                 = ĚF (g)
        P        ′
                          P
hence         h eh⊗ ě′h = h e′′h ⊗ ě′′h . We see that
                 X                                                      X
                   bw eh ⊗ t (ι−1 (by ))−1t b−1
                                             w ′
                                                 t
                                                   b y (ěh ) = ζ w,w ′   bw eh ⊗ t b−1
                                                                                     w ěh .
                  h                                                      h

This shows that
                        t
                            (ι−1 (by ))−1t b−1 t
                                                                ′
                                                                  t −1
                                            w ′ by (ěh ) = ζw,w bw ěh ∈ Ěnw gn−1
                                                                                 w


for all h. Thus t (ι−1 (by ))−1t b−1 t           t −1
                                  w ′ by = ζw,w ′ bw as linear maps Ěnw gn−1
                                                                            w
                                                                               −
                                                                               → Ěg
        −1        −1     −1
hence ι (by )bw′ by = ζw,w′ bw as linear maps Enw gn−1 w
                                                          −
                                                          → Eg . It follows that
                                                           −1
                                        ι−1 (by )bw′ b−1
                                                      y = ζw,w ′ bw ∈ E

for any y ∈ Γ such that w−1 F (y)w′ = y. In our case, 24.17(b) becomes
                X
       |G0F |−1     χKj ,φj (g)χK′j′ ,φ′j′ (g)
                      g∈GF
                             X
                                              −1
            = |Γ|−2                    tr(b−1
                                           w ιj , Vj )
                       w,w ′ ∈Γ;eff.

            × tr(ζw,w′ bw′ ιj ′ , Vj ′ )q dim S−dim L ♯(y ∈ Γ; w−1 F (y)w′ = y)
                                          X X
                                                            −1
            = q dim S−dim L |Γ|−2                   tr(b−1
                                                        w ιj , Vj )tr(ι
                                                                       −1 −1
                                                                         (by )bw by ιj ′ , Vj ′ ).
                                         w∈Γ;eff. y∈Γ
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                            21

We have

                   tr(ι−1 (b−1
                            y )bw by ιj ′ , Vj ′ ) = tr(ιj ′ ι
                                                              −1 −1
                                                                (by )bw by , Vj ′ ),
                   tr(b−1
                       y ιj ′ bw by , Vj ′ ) = tr(ιj ′ bw , Vj ′ ),

hence
                X
     |G0F |−1          χKj ,φj (g)χK′j′ ,φ′j′ (g)
                g∈GF
                                  X
                                                  −1
      = q dim S−dim L |Γ|−1                tr(b−1
                                               w ιj , Vj )tr(ιj ′ bw , Vj ′ ) = q
                                                                                  dim S−dim L
                                                                                              δj,j ′
                                w∈Γ;eff.


where the last step follows from 20.4(c),(b). The proposition is proved.
24.19. Assume that we are in the setup of 24.17. Let δ (rep. δ ′ ) be the connected
component of NG L (resp. NG L′ ) that contains S (resp. S ′ ). Assume that S =
                     ′
δ 0
 ZL × c, S ′ = δ ZL0 ′ × c′ where c is a unipotent L-conjugacy class and c′ is a
unipotent L′ -conjugacy class. Assume that E = Q̄l ⊠ F , E ′ = Q̄l ⊠ F ′ where F
(resp. F ′ ) is an irrreducible L- (resp. L′ -)equivariant local system on c (resp.
                         ∼                        ∼
c′ ). Let ǭ : F ∗ F −→ F (resp. ǭ′ : F ∗ F ′ −→ F ′ ) be the restriction of ǫ (resp. ǫ′ ).
For w ∈ Γ let δ w be the connected component of NG (Lw ) that contains S w . Let
j ∈ [1, r], j ′ ∈ [1, r ′ ]. We can state the following variant of Proposition 24.18.
Proposition 24.20. Assume that Ě, E ′ are strongly cuspidal. Assume also that
either L, L′ are not G0 -conjugate or Ě, E ′ are clean.
   (a) If (L,Pc, F̌), (L′ , c′ , F ′ ) are not G0 -conjugate then
   |G0F |−1 u∈GFun χKj ,φj (u)χK′j′ ,φ′j′ (u) = 0.
   (b) Assume that L = L′ , c = c′ , F̌ = F ′ , ˇǭ = ǭ′ , K′j ′ = (Kj ′ )ˇ, φ′j ′ = (φj ′ )ˇ. Then
                          X
             |G0F |−1           χKj ,φj (u)χK′j′ ,φ′j′ (u)
                        u∈GF
                           un
                      X                                          w
              = |Γ|         tr(ι−1 −1                          δ 0F −1 dim S−dim L
                                j bw , Vj )tr(bw ιj ′ , Vj ′ )| ZLw | q            .
                      w∈Γ


   As in 24.17 we have
                      X
             |G0F |−1   χKj ,φj (u)χK′j′ ,φ′j′ (u)
                            u∈GF
                               un
                                    X X
                = |Γ|−1 |Γ′ |−1                   tr(ι−1 −1          ′ −1 ′ −1
                                                      j bw , Vj )tr(ιj ′ bw′ , Vj′′ )
                                    w∈Γ w ′ ∈Γ′
                                X
                × |G0F |−1             χKw ,φw (u)χK′ w′ ,φ′w′ (u).
                               u∈GF
                                  un
22                                           G. LUSZTIG

(All elements of Γ, Γ′ are effective in this case.) In the setup of (a), we have
                               X
                     |G0F |−1        χKw ,φw (u)χK′ w′ ,φ′w′ (u) = 0
                                     u∈GF
                                        un


by 24.16 and (a) follows.
   In the setup of (b) we have Γ = Γ′ . As in the proof of 24.18 we have (using
24.16 instead of 24.15):
                       X
             |G0F |−1      χKw ,φw (u)χK′ w′ ,φ′ w′ (u)
                            u∈GF
                               un
                                             w
                  = ζw,w′ q dim S−dim L |δ ZL0Fw |−1 ♯(y ∈ Γ; w−1 F (y)w′ = y).

Hence
                 X                                            X
     |G0F |−1           χKj ,φj (u)χK′j′ ,φ′j′ (u) = |Γ|−2              tr(ι−1 −1
                                                                            j bw , Vj )tr(ιj ′ bw ′ , Vj ′ )
                u∈GF
                   un
                                                             w,w ′ ∈Γ
                                 w
     × ζw,w′ q dim S−dim L |(δ ZL0 w )F |−1 ♯(y ∈ Γ; w−1 F (y)w′ = y).

As in the proof of 24.18 we may replace tr(ζw,w′ ιj ′ b′w′ , Vj ′ ) by tr(ιj ′ bw , Vj ′ ) and
(b) follows.

                         25. Properties of cohomology sheaves
25.1. Let D be a connected component of G. Let (L, S), (L′ , S ′ ) ∈ A. Assume
that S ⊂ D, S ′ ⊂ D. Let π : ỸL,S −→ YL,S = Y be as in 3.13 and let π ′ : ỸL′ ,S ′ −    →
YL ,S be the map analogous to π. For any E ∈ S(S), the local system π! Ẽ on Y is
   ′ ′

defined as in 5.6; similarly, for any E ′ ∈ S(S ′ ), the local syatem π!′ Ẽ ′ on YL′ ,S ′ is
defined.
Proposition 25.2. Let E ′ ∈ S(S ′ ). Let K ∈ D(D) be IC(ȲL′ ,S ′ , Ẽ ′ ), extended by
zero on D − ȲL′ ,S ′ . Let A ∈ D(D) be a direct summand of K. Then for any i ∈ Z,
there exists E ∈ S(S) such that the constructible sheaf Hi A|Y is a local system
isomorphic to a direct summand of the local system π! Ẽ.
     The proof is given in 25.9.
25.3. Let Z = D ZG  0
                      0 . We show:

   (a) Let E be a G0 -equivariant local system on an isolated stratum C of D.
Assume that there exists an integer n ≥ 1 invertible in k and a Z-orbit F in C
such that E|F is Z-equivariant for the action z : f 7→ z n f on F . Then E ∈ S(C).
We may assume that G is generated by D and that E is indecomposable. We have
a canonical direct sum decomposition of E such that each summand restricted to
any Z-orbit in C is an isotypical local system isomorphic to a direct sum of copies
of a fixed Z-equivariant local system of rank 1. Since E is indecomposable, it is
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                              23

equal to one of these summands. Thus, if F is a Z-orbit in C, we may assume
that E|F = L⊕k where L is a Z-equivariant local system of rank 1 on F . As in
5.3 we can find E1 ∈ S(C) of rank 1 such that E1 |F ∼= L. Let E = E ⊗ E1∗ . Then E
is a G0 -equivariant local system on C such that E|F ∼ = Q̄⊕k           0
                                                           l . Since G permutes
transitively the fibres of C −→ C ′ (as in 5.3) we see that the restriction of E to
any fibre of C − → C is ∼
                      ′
                           = Q̄⊕k
                                l . As in 5.3, we see that there is a well defined
               ′       ′
local system E on C whose inverse image under C −      → C ′ is E. Moreover, E ′ is
automatically G0 -equivariant. It follows that E ∈ S(C). Since E = E ⊗ E1 and
E1 ∈ S(C) we see that E ∈ S(C).
25.4. Let n ≥ 1 be such that E ′ ∈ Sn (S ′ ). From the definitions we see that
   (a) K is Z × G0 -equivariant for the action (z, x) 7→ g 7→ xz n gx−1 on D.
Let H = Hi K, a constructible sheaf on D. Let δ be the connected component of
NG L such that S ⊂ δ. Let T = δ ZL0 .
   We have a canonical map S −      → Ss , g 7→ gs and Ss is a single orbit for the
T × L-action (z, x) : y 7→ xzyx−1 . Let s be the set of T -cosets in Ss . Then
L acts transitively on s. We fix a T -coset τ on Ss . Let R = {g ∈ S; gs ∈ τ },
R∗ = {g ∈ S ∗ ; gs ∈ τ } = R ∩ S ∗ . Then R∗ is open in R. By the proof of
3.11, R∗ is dense in R. Now R is a single orbit for the group T × NL τ acting by
(z, l) : g 7→ lzgl−1 . Hence R is smooth of pure dimension. Let s ∈ τ . Then ZL (s)0
is independent of the choice of s: it is NL (τ )0 = ZL (τ )0 . Hence R is union of
finitely many orbits of T × ZL (τ )0 .
Lemma 25.5. Let s ∈ τ . Then
  (a) R ⊂ ZG (s).
  (b) Any connected component of s−1 R contains some unipotent element.
     We can find y ∈ S with ys = s. We have y ∈ R and ys = sy. Let y ′ ∈ R. We
have y ′ = lzyl−1 where l ∈ L, l−1 sl = z ′ s, z, z ′ ∈ T . We must show that sy ′ = y ′ s
or that slzyl−1 = lzyl−1 s or that l−1 slzy = zyl−1 sl or that z ′ szy = zyz ′ s or that
z ′ zsy = zz ′ ys or that sy = ys. This proves (a). We prove (b). Let g ∈ R. Then
gs = zs for some z ∈ T . Let g ′ = z −1 g. Then gs′ = z −1 gs = s. Hence g ′ = su
where u is unipotent in ZG (s). Now T R = R hence g ′ , g are in the same connected
component of R. Hence the connected component of g in R contains an element
g ′ such that s−1 g ′ is unipotent. This proves (b).
Lemma 25.6. There exists a local system F on R and an integer n ≥ 1 invertible
in k such that F is T × ZL (τ )0 -equivariant for the action (z, x) 7→ g 7→ xz n gx−1
and F |R∗ ∼
          = H|R∗ .
   Let R1 be a connected component of R which is a T × ZL (s)0 -orbit in R. Let
R1∗ = R∗ ∩ R, an open dense subset of R1 . It is enough to show:
   there exists a local system F1 on R1 and an integer n ≥ 1 invertible in k such
that F1 is T × ZL (τ )0 -equivariant for the action (z, x) 7→ g 7→ xz n gx−1 and
F1 |R∗1 ∼
        = H|R∗1 .
Let τ be the set of all s ∈ τ such that s = ys for some y ∈ S ∗ . By the proof
       ∗
24                                   G. LUSZTIG

of 3.11 we have τ ∗ 6= ∅. Let s ∈ τ ∗ . Let δ1 be the connected component of
ZNG L (s) such that R1 ⊂ sδ1 . By 25.5(b), δ1 contains some unipotent element.
By 16.12(b) we can find an open subset U of δ1 containing all unipotents of δ1 ,
such that ǫ∗ (K|sU ) is isomorphic to the restriction to U of K̃ where K̃ is a direct
sum of finitely many objects K̃ k ∈ D(δ1 ) each one of the same type as K (for
ZG (s) instead of G). (Here ǫ : U −     → sU is g 7→ sg.) By an analogue of 25.4(a),
each K̃ k is δ1 ZZ0 G (s)0 × ZG (s)0 -equivariant hence T × ZL (τ )0 -equivariant for an
action as in the Lemma. (We have ZG (s)0 = ZL (s)0 = ZL (τ )0 , since s ∈ τ ∗ and
δ1 0
  ZZG (s)0 = δ1 ZZ0 L (s)0 = TNG L (y) = δ ZL0 = T , since y ∈ R1 , ys = s is isolated
in NG L.) Then Hi K̃ is a T × ZL (τ )0 -equivariant constructible sheaf on δ1 whose
restriction to U is ∼
                    = Hi (ǫ∗ K|sU ). Let F1 be the inverse image of Hi K̃|s−1 R1 under
R1 − → s−1 R1 , g 7→ s−1 g. This is a T × ZL (τ )0 -equivariant constructible sheaf
on R1 . Since R1 is a single orbit, we see that F1 is a T × ZL (τ )0 -equivariant
local system on R1 . We have F1 |V ∼    = H|V where V = R1 ∩ sU, an open subset
of R1 containing {g ∈ R1 ; gs = s}. We summarize: for any s ∈ τ ∗ there exists
an open subset V(s) of R1 and a T × ZL (τ )0 -equivariant local system Fs on R1
such that {g ∈ R1 ; gs = s} ⊂ V(s) and Fs |V(s) ∼   = H|V(s) . If g ∈ R1∗ then g ∈ R1
and gs ∈ τ ∗ hence g ∈ V(gs ). Thus R1∗ ⊂ R′ where R′ = ∪s∈τ ∗ V(s) ⊂ R1 .
The constructible sheaf H|R′ is a local system when restricted to any of the open
sets V(s) that cover R′ . Hence H|R′ is a local system. Let s ∈ τ ∗ be such that
V(s) 6= ∅. The local systems H|R′ , Fs |R′ have isomorphic restrictions to V(s)
hence H|R′ ∼  = Fs |R′ . (Note that R′ is smooth, irreducible, since R1 is smooth,
irreducible. Hence H|R′ = IC(R′ , H|V(s) ) ∼     = IC(R′ , Fs |V(s) ) = Fs |R′ .) Since
R1∗ ⊂ R′ , it follows that H|R∗1 ∼
                                 = Fs |R∗1 . We set F = Fs . Then F has the required
properties. The lemma is proved.
Lemma 25.7. There exists E ∈ S(S) such that E|S ∗ ∼      = H|S ∗ .
   Define ρ : S −→ s by g 7→ (T − coset of gs ). Let ρ′ : S ∗ −→ s be the restriction of
              ′
ρ. Then ρ, ρ are L-equivariant maps with L acting transitively on s and R (resp.
R∗ ) is a fibre of ρ (resp. ρ′ ). Since H|S ∗ is an L-equivariant constructible sheaf
whose restriction to any fibre of ρ′ is a local system (see 25.6), we see that H|S ∗
is an L-equivariant local system. Hence K := IC(S, H|S ∗ ) is a well defined object
of D(S). Let K ′ = IC(R, H|R∗ ). Using the L-homogeneity of s we see that for
any j ∈ Z we have Hj K|R = Hj K ′ and Hj K is an L-equivariant constructible
sheaf. From 25.6 we see that K ′ is a local system on R. In particular, Hj K ′ = 0
for j > 0. Since for j > 0, Hj K is an L-equivariant constructible sheaf on S
whose restriction to R is 0, we see that Hj K = 0. Similarly, since H0 K is an
L-equivariant constructible sheaf on S whose restriction to R is a local system, we
see that H0 K is a local system. Thus, K = H0 K is a local system E on S whose
restriction to S ∗ is H|S ∗ . Since E = IC(S, H|S ∗ ) and H|S ∗ is L-equivariant, we see
that E is L-equivariant. Since E|R = K ′ and K ′ is T -equivariant, we may apply
25.3(a) with G, C replaced by NG L, S and we see that E ∈ S(S). The lemma is
proved.
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                25

Lemma 25.8. Let Ỹ = ỸL,S . Define ξ : Ỹ − → D by ξ(g, xL) = g. Then ξ ∗ H ∼
                                                                             = Ẽ
where Ẽ is defined in terms of E ∈ S(S) of Lemma 25.7.
   Let Ŷ = {(g, x) ∈ D × G0 ; x−1 gx ∈ S ∗ }. Define b : Ŷ −  → S and b′ : Ŷ −   → S∗
by (g, x) 7→ x−1 gx. Define c : Ŷ −→ D by c(g, x) = g. By the definition of E we
       ∗       ′∗      ∼   ′∗
have b E = b (E|S ∗ ) = b (H|S ∗ ). Define r : Ŷ −→ G0 × D by (g, x) 7→ (x, x−1 gx).
Define p1 , p2 : G0 × D − → D by p1 (x, d) = d, p2 (x, d) = xdx−1 . Since H is a G0 -
equivariant constructible sheaf on D, we have p∗1 H ∼  = p∗2 H, hence r ∗ p∗1 H ∼
                                                                                = r ∗ p∗2 H.
Thus, b′∗ (H|S ∗ ) ∼
                   = c∗ H. It follows that c∗ H ∼
                                                = b∗ E. As in 5.6, define a : Ŷ −   → Ỹ
by (g, x) 7→ (g, xL). We have c H = a (ξ H), b E = a Ẽ. Hence a (ξ H) = a∗ Ẽ.
                                  ∗      ∗ ∗       ∗       ∗             ∗ ∗      ∼
Since a∗ Ẽ is a local system, we see that a∗ (ξ ∗ H) is a local system. Since a is a
principal L-bundle it follows that ξ ∗ H is a local system and that ξ ∗ H ∼    = Ẽ. The
lemma is proved.
25.9. We now prove Proposition 25.2. We may assume that A = K. Let j : Y −            →
                                                          ∗ ∗       ∗         ∗ ∗
D be the inclusion. With notation in 25.8 we have π j H = ξ H hence π j H = Ẽ.
Since π is a finite unramified covering and Ẽ is a local system, it follows that j ∗ H
is a local system. Since Q̄l is a direct summand of π! π ∗ Q̄l we see that j ∗ H is
a direct summand of (j ∗ H) ⊗ (π! π ∗ Q̄l ) = π! π ∗ (j ∗ H) = π! Ẽ. Proposition 25.2 is
proved.
Lemma 25.10. Let (L, S), (L′, S ′ ) ∈ A. Assume that YL′ ,S ′ ⊂ ȲL,S .
  (a) For any L-conjugacy class C in S and any L′ -conjugacy class C ′ in S ′ we
have dim L′ − dim C ′ ≥ dim L − dim C.
  (b) For any G0 -conjugacy class c in YL,S and any G0 -conjugacy class c′ in
YL′ ,S ′ we have dim c′ ≤ dim c.
    We prove (a). By 7.2(c) we may assume that L′ = G0 . Then S ′ is as isolated
stratum of G and S ′ ⊂ Ȳ where Y = YS,L . Let a = aL,S , σ : Ȳ −
                                                                 → a be as in 7.2.
Set a = σ(C ′ ) ∈ a. By 7.16(b), Ȳ a has pure dimension dim G0 /L + dim C. Since
C ′ ⊂ Ȳ a we have dim C ′ ≤ dim G0 /L + dim C, as required.
    We prove (b). Let g ∈ c, g ′ ∈ c′ . We can assume that g ∈ S ∗ , g ′ ∈ S ′∗ . Let
C be the L-conjugacy class of g; let C ′ be the L′ -conjugacy class of g ′ . By the
definition of S ∗ we have ZG (g)0 = ZL (g)0 hence dim ZG0 (g) = dim ZL (g) so that
dim c = dim G0 /L + dim C. Similarly, dim c′ = dim G0 /L′ + dim C ′ . Hence (b)
follows from (a).
25.11. For (L, S) ∈ A let TL,S be the union of all G0 -conjugacy classes in ȲL,S
whose dimension equals the dimension of some/any G0 -conjugacy class in YL,S .
(See 3.4.) From 3.15 and 3.4 we see that TL,S is a union of strata of G. Clearly,
   (a) YL,S ⊂ TL,S ⊂ ȲL,S .
Lemma 25.12. For (L, S) ∈ A, TL,S is open dense in ȲL,S .
  The fact that it is dense follows from 25.11(a). It remains to show that ȲL,S −
TL,S is closed in ȲL,S . Since ȲL,S is a union of strata (see 3.15) and TL,S is a
union of strata (by definition) it is enough to verify the following statement:
26                                      G. LUSZTIG

  YL′′ ,S ′′ ⊂ ȲL,S − TL,S , YL′ ,S ′ ⊂ ȲL′′ ,S ′′ =⇒ YL′ ,S ′ ⊂ ȲL,S − TL,S .
Let c (resp. c′ , c′′ ) be a G0 -conjugacy class in YL,S (resp. YL′ ,S ′ , YL′′ ,S ′′ ). Using
Lemma 25.10 we see that dim c′′ < dim c, dim c′ ≤ dim c′′ . Hence dim c′ < dim c
and YL′ ,S ′ ⊂ ȲL,S − TL,S . The lemma is proved.
25.13. Let (L, S) ∈ A and let P be a parabolic of G0 with Levi L such that
S ⊂ NG P . Let T = TL,S . Let ψ : X −    → ȲL,S be as in 3.14. For any stratum S ′
of NG P ∩ NG L such that S ′ ⊂ S̄ let XS ′ be as in 5.6. Let X = ψ −1 (T) and let
ψ′ : X −→ T be the restriction of ψ. We show:
    (a) X ⊂ XS ;
    (b) ψ ′ has finite fibres;
    (c) X is smooth.
Let g ∈ T. We must show that ψ −1 (g) ∩ XS ′ is empty if S ′ 6= S and is finite if
S ′ = S. By 4.4(b), dim(ψ −1 (g) ∩ XS ′ ) ≤ (dim G0 /L − dim c1 + dim C ′ )/2 where
c1 is the G0 -conjugacy class of g and C ′ is any L-conjugacy class in S ′ . Let C
be an L-conjugacy class in S. We have dim C ′ ≤ dim C with strict inequality if
S ′ 6= S. Hence dim(ψ −1 (g) ∩ XS ′ ) ≤ (dim G0 /L − dim c1 + dim C)/2 with strict
inequality if S ′ 6= S. As in the proof of 25.10 we have dim G0 /L + dim C = dim c
where c is a G0 -conjugacy class in YL,S . Also dim c = dim c1 by the choice of g.
Thus dim(ψ −1 (g) ∩ XS ′ ) ≤ 0 with strict inequality if S ′ 6= S. This completes the
proof of (a),(b).
    Using (a) and Lemma 25.12 we see that X is an open subset of XS which is
smooth. Hence (c) holds.
Proposition 25.14. Let (L, S) ∈ A, let E ∈ S(S) and let T = TL,S . Then
IC(ȲL,S , π! Ẽ)|T is a constructible sheaf.
   Let Ē be the local system on XS defined in 5.6. Using 5.7 it is enough to show
that ψ! (IC(X, Ē))|T is a constructible sheaf or equivalently that ψ!′ (IC(X, Ē)|X )
is a constructible sheaf. Since X ⊂ XS (see 25.13(a)) we have IC(X, Ē)|X = Ē|X
and it is enough to show that ψ!′ (Ē|X ) is a constructible sheaf. This is clear from
25.13(b).

                                 26. The variety ZJ,D
26.1. Let B be the variety of Borel subgroups of G0 . Let W be the set of G0 -
orbits on B × B (G0 acts by conjugation on both factors). For B, B ′ ∈ B we write
pos(B, B ′ ) = w if the G0 -orbit of (B, B ′ ) is w. There is a unique group structure
on W such that whenever B, B ′ , B ′′ ∈ B have a common maximal torus, we have
pos(B, B ′ )pos(B ′ , B ′′ ) = pos(B, B ′′ ). Then W is a finite Coxeter group (called
the Weyl group) with length function l : W −      → N which attaches to a G0 -orbit its
dimension minus dim B. Let ≤ be the standard partial order of the Coxeter group
W. Let I = {w ∈ W; l(w) = 1}. For J ⊂ I let WJ be the subset of W generated
by J.
   If P is a parabolic of G0 , the set of all w ∈ W such that w = pos(B, B ′ ) for
some B, B ′ ∈ B, B ⊂ P, B ′ ⊂ P is of the form WJ for a well defined J ⊂ I; we
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                             27

then say that P has type J. For J ⊂ I let PJ be the set of all parabolics of type
J of G0 . For P ∈ PJ , Q ∈ PK there is a well defined element u = pos(P, Q) ∈ W
such that u ≤ pos(B, B ′ ) for any B, B ′ ∈ B, B ⊂ P , B ′ ⊂ Q and u = pos(B1 , B1′ )
for some B1 , B1′ ∈ B, B1 ⊂ P, B1′ ⊂ Q.
26.2. In the remainder of this section we fix a connected component D of G.
  There is a unique isomorphism ǫ : W −  → W such that ǫ(I) = I and such that
  g ∈ D, P ∈ PJ =⇒ gP g ∈ Pǫ(J) .
We fix J ⊂ I. Following [B], let T (J, ǫ) be the set of all sequences (Jn , wn )n≥0
where Jn ⊂ I and wn ∈ W are such that

                                  J = J0 ⊃ J1 ⊃ J2 ⊃ . . . ,

                                                 −1
                     Jn = Jn−1 ∩ ǫ−1 (wn−1 Jn−1 wn−1 ) for n ≥ 1,

                           l(wn y) > l(wn ) for all y ∈ Jn , n ≥ 0,

                         l(y ′ wn ) > l(wn ) for all y ′ ∈ ǫ(Jn ), n ≥ 0,

                            wn ∈ Wǫ(Jn ) wn−1 WJn−1 for n ≥ 1.
Then T (J, ǫ) is a finite set.
   For (P, P ′ ) ∈ PJ × Pǫ(J) let A(P, P ′ ) = {g ∈ D; gP g −1 = P ′ }. Let ZJ,D be
the set of all triples (P, P ′ , γ) where P ∈ PJ , P ′ ∈ Pǫ(J) and γ ∈ UP ′ \A(P, P ′ ) =
A(P, P ′ )/UP . Following [L10, 3.11], to any (P, P ′ , γ) ∈ ZJ,D we associate an
element (Jn , wn )n≥0 ∈ T (J, ǫ) and two sequences of parabolics P n , P ′n , (n ≥ 0)
by the requirements:

             P ′0 = P ′ , P 0 = P, P ′n = (P n−1 ∩ P ′n−1 )UP ′n−1 ∈ Pǫ(Jn ) ,

                   P n = g −1 P ′n g ∈ PJn , g ∈ γ, wn = pos(Pn′ , P n ).


We write (Jn , wn )n≥0 = β ′ (P, P ′ , γ). For t ∈ T (J, ǫ) let

                    t
                        ZJ,D = {(P, P ′ , γ) ∈ ZJ,D ; β ′ (P, P ′ , γ) = t}.

Then (t ZJ,D )t∈T (J,ǫ) is a partition of ZJ,D into locally closed subvarieties. Now G0
acts on ZJ,D by h : (P, P ′ , γ) 7→ (hP h−1 , hP ′ h−1 , hγh−1 ). This action preserves
each of the pieces t ZJ,D .
26.3. Let t = (Jn , wn )n≥0 ∈ T (J, ǫ). For r ≫ 0, Jr , wr are independent of r; we
denote them by J∞ , w. Then

    wJ∞ w−1 = ǫ(J∞ ), l(wy) > l(w), l(y ′w) > l(w) for all y ∈ J∞ , y ′ ∈ ǫ(J∞ ).
28                                     G. LUSZTIG

Let Rt = {(Q̃, Q̃′ , γ ′ ) ∈ ZJ∞ ,D , pos(Q̃′ , Q̃) = w}. We choose Q ∈ PJ∞ , Q′ ∈
Pǫ(J∞ ) such that pos(Q′ , Q) = w. We can find a common Levi L for Q and Q′ .
Let

C = {g ∈ D; gLg −1 = L, gQg −1 = Q′ } = {g ∈ D; gLg −1 = L, pos(gQg −1, Q) = w}.

Let A be a simple perverse sheaf on C which is admissible in the sense of 6.7
(this concept is well defined since C is a connected component of the reductive
group NG L.) Then A is L-equivariant for the conjugation action of L hence it is
also (Q ∩ Q′ )-equivariant where Q ∩ Q′ acts via its quotient (Q ∩ Q′ )/UQ∩Q′ = L.
Hence there is a well defined simple perverse sheaf A′ on G0 ×Q∩Q′ C (here Q ∩ Q′
acts on G0 by right translation) such that j̃A′ = pr  e 2 A in the obvious diagram
               j            pr2
G0 ×Q∩Q′ C ←  − G0 × C −−→ C. We may regard A′ as a simple perverse sheaf on
Rt via the isomorphism
                            ∼
(a)         G0 ×Q∩Q′ C −→ Rt , (g, c) 7→ (gQg −1 , gQ′ g −1 , gUQ′ cUQ g −1 ).

Define ϑt : t ZJ,D − → Rt by (P, P ′ , γ) 7→ (P r , P ′r , γUP r ) where r ≫ 0 and P r , P ′r
are attached to (P, P ′ , γ) as in 26.2. Now G0 acts on Rt by h : (Q̃, Q̃′ , γ ′ ) 7→
(hQ̃h−1 , hQ̃′ h−1 , hγ ′ h−1 ) and ϑt is G0 -equivariant. By [L10, 3.12], ϑt is an iter-
ated affine space bundle. Let Ã = ϑ̃(A′ ), a simple perverse sheaf on t ZJ,D . Let
Â be the simple perverse sheaf on ZJ,D whose support is the closure in ZJ,D of
supp(Ã) and whose restriction to t ZJ,D is Ã. A simple perverse sheaf on t ZJ,D is
said to be admissible if it is of the form Ã for some A as above. This concept does
not depend on the choice of Q, Q′ , L since any two such triples are G0 -conjugate.
Note that A 7→ Ã is a bijection between the set of isomorphism classes of simple
perverse sheaves on C that are admissible and the set of isomorphism classes of
simple perverse sheaves on t ZJ,D that are admissible. A simple perverse sheaf on
ZJ,D is said to be admissible if it is of the form Â for some t ∈ T (J, ǫ) and some A
as above. Note that (t, A) 7→ Â is a bijection between the set of pairs consisting of
an element of T (J, ǫ) and an isomorphism class of a simple perverse sheaf on t ZJ,D
that is admissible and the set of isomorphism classes of simple perverse sheaves
on ZJ,D that are admissible.
   When J = I then T (J, ǫ) consists of a single element t = (Jn , wn )n≥0 where
Jn = I, wn = 1 for all n. Now ZI,D consists of all triples (G0 , G0 , g) with g ∈ D.
We identify ZI,D = D in the obvious way. A simple perverse sheaf on ZI,D is
admissible in the sense just defined if and only if it is admissible on D in the sense
of 6.7.
26.4. In the remainder of this section we assume that k is an algebraic closure
of a finite field Fq and that G has a fixed Fq -rational structure with Frobenius
map F : G −   → G. There are induced maps F : B −    → B, F : W −  → W; the last
map restricts to a bijection F : I −
                                   → I. Let J ⊂ I be such that F (J) = J. Then
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                29

F : G− → G induces a map F : PJ −    → PJ . We assume that F (D) = D. Then
ǫ:I− → I commutes with F hence F (ǫ(J)) = ǫ(J). Hence F : G −         → G induces a
map F : Pǫ(J) −  → Pǫ(J) .
  For (P, P ′ ) ∈ PJ × Pǫ(J) we have g ∈ A(P, P ′ ) =⇒ F (g) ∈ A(F (P ), F (P ′ ))
and g 7→ F (g) induces a map F : A(P, P ′ )/UP −→ A(F (P ), F (P ′ ))/UF (P ). Define
F : ZJ,D − → ZJ,D by F (P, P , γ) = (F (P ), F (P ′ ), F (γ)); this is the Frobenius
                               ′

map for an Fq -rational structure on ZJ,D . The G0 -action on ZJ,D restricts to a
G0F -action on ZJ,DF
                     . Let U be the vector space of functions ZJ,DF
                                                                      −→ Q̄l that are
                0F
constant on G -orbits.
Theorem 26.5. Let AJ be a set of representatives for the isomorphism classes
of admissible simple perverse sheaves K on ZJ,D such that F ∗ K ∼
                                                                = K. For each
                                         ∗    ∼
K ∈ AJ we choose an isomorphism α : F K −→ K. The characteristic functions
χK,α (one for each K ∈ AJ ) form a Q̄l -basis of U.
                                                                                 ∼
    In this proof we write Z, t Z instead of ZJ,D , t ZJ,D . Define F : T (J, ǫ) −→ T (J, ǫ)
by (Jn , wn )n≥0 7→ (F (Jn ), F (wn ))n≥0 . For any t ∈ T (J, ǫ) we have F (t Z) = F (t) Z.
In particular, we have Z F = ⊔t∈T (J,ǫ);F (t)=t t Z F where t Z F = t Z ∩ Z F . It follows
that U = ⊕t∈T (J,ǫ);F (t)=t t U where t U is the vector space of functions t Z F −   → Q̄l
                            0F
that are constant on G -orbits. (We identify any such function with a function
ZF −  → Q̄l which is zero on the complement of t Z F .)
    For any integer t let Z≤t = ∪t∈T (J,ǫ);|t|≤t t Z where |t| = dim t Z. This is a
closed subvariety of Z since ∪t t Z is a partition of Z into finitely many locally
closed subvarieties. Moreover, if |t| = t then t Z ∪ Z≤t−1 is a closed subvariety of
Z.
                                                        F
    Let U≤t be the vector space of functions Z≤t            −→ Q̄l that are constant on
G -orbits. (We identify any such function with a function Z F −
   0F
                                                                              → Q̄l which
is zero on the complement of t Z F .) We have U≤0 ⊂ U≤1 ⊂ . . . and U≤t =
⊕t∈T (J,ǫ);F (t)=t,|t|≤t t U.
    Now let K ∈ AJ . Since the sets t Z ∩ supp(K) form a partition of supp(K)
into finitely many locally closed subsets, there is a unique t ∈ T (J, ǫ) such that
t
  Z ∩ supp(K) is open dense in supp(K). Since F ∗ K ∼          = K we have necessarily
                                t                  t         t
F (t) = t. Let t = |t|. Since Z ∩ supp(K) ⊂ Z and Z ∪ Z≤t−1 is closed, we see
that the closure of t Z ∩ supp(K) is contained in t Z ∪ Z≤t−1 . Thus, supp(K) ⊂
t
  Z ∪ Z≤t−1 . Hence we can write uniquely χK,α = χ′K,α + χ′′K,α where χ′K,α is the
restriction of χK,α to t Z (extended by 0 on Z − t Z) and χ′′K,α ∈ U≤t−1 . Note
that χK,α , χ′K,α are contained in U≤t and they are equal modulo U≤t−1 . Thus,
in order to prove that the functions χK,α form a basis of U it is enough to prove
that the functions χ′K,α form a basis of U. More precisely, we will show that, for
any t ∈ T (J, ǫ)F , the functions χ′K,α with K ∈ AJ such that t Z ∩ supp(K) is open
dense in supp(K), form a basis of t U. An equivalent statement is:
    (a) For any t ∈ T (J, ǫ)F let t AJ be a set of representatives for the isomorphism
classes of admissible simple perverse sheaves K ′ on t Z such that F ∗ K ∼           = K.
30                                             G. LUSZTIG

                                                                          ∼
For each K ′ ∈ t AJ we choose an isomorphism α′ : F ∗ K ′ −→ K ′ . Then the
characteristic functions χK ′ ,α′ (one for each K ′ ∈ t AJ ) form a Q̄l -basis of t U.
Let R = Rt , Q, Q′ , L, C be as in 26.3. Then R is defined over Fq , with Frobenius
map F : Rt −   → Rt , (Q̃, Q̃′ , γ ′ ) 7→ (F (Q̃), F (Q̃′ ), F (γ ′)). We may assume that
F (Q) = Q, F (Q′ ) = Q′ , F (L) = L′ . Then F (C) = C. The map ϑt : t Z −         → R in
26.3 is G0 -equivariant and commutes with F .
   We show that ϑt induces a bijection between the set of G0F -orbits on t Z and
the set of G0F -orbits on R. Now ϑt is a composition
                                1                 2        r
                      t             ϑ                 ϑ        ϑ
                          ZJ,D −→ t1 ZJ1 ,D −→ . . . −→ tr ZJr ,D = R

where ti = (Jn , wn )n≥i , 1 ϑ(P, P ′ , γ) = (P 1 , P ′1 , γUP 1 ) (notation of 26.2) and i ϑ is
defined for i ≥ 2 just like 1 ϑ with ti−1 instead of t. Each i ϑ is G0 -equivariant and
commutes with F . Hence it is enough to show that i ϑ induces a bijection between
the set of G0F -orbits on ti−1 Z and the set of G0F -orbits on ti Z. We may assume
that i = 1. Let Φ be the fibre of 1 ϑ at some Fq -rational point (P̃ , P̃ ′ , γ̃) ∈ t1 ZJ1 ,D .
It is enough to show that ΦF 6= ∅ and that ΦF is contained in a single G0F -orbit.
Since Φ is an affine space (see [L10, 3.12(b)]) defined over Fq , it must contain
some F -fixed point (P, P ′ , γ). By [L10, 3.8], Φ is a homogeneous UP ∩ P ′ space
(the action being the restriction of the G0 -action on t Z) and the isotropy group
of (P, P ′ , γ) is UP ∩ UP ′ (see [L10, 3.9]). Since UP ∩ P ′ , UP ∩ UP ′ are connected, it
follows that (UP ∩ P ′ )F acts transitively on ΦF ; thus, ΦF is contained in a single
G0F -orbit, as required.
   Using this and the definitions, we see that (a) would be a consequence of the
following statement:
   Let A′ be a set of representatives for the isomorphism classes of admissible
simple perverse sheaves A on C such that F ∗ A ∼           = A. For each A ∈ A′ we choose
                                ∼
an isomorphism α : F ∗ A −→ A; we define A′ (a simple perverse sheaf on R) as
                                  ∼
in 26.3 and let α′ : F ∗ A′ −→ A′ be the isomorphism induced by α. Then the
characteristic functions χA′ ,α′ (one for each A ∈ A′ ) form a Q̄l -basis of the vector
space of functions RF −    → Q̄l that are constant on G0F -orbits.
This is an immediate consequence of 21.21 applied to NG L instead of G. The
theorem is proved.

                                          27. Induction
27.1. Let P be a parabolic of G0 with Levi L. Let G′ = NG P ∩ NG L. Then
G′0 = L. Define a homomorphism ξ : NG P −→ G′ by ξ(zω) = z where z ∈ G′ , ω ∈
UP (see 1.26). Let D be a connected component of G such that NG P ∩ D 6= ∅.
Then NG P ∩ D is a connected component of NG P and D′ = G′ ∩ D is a connected
component of G′ . Consider the diagram

                                           a          a′    a′′
                                        D′ ←
                                           − V1 −→ V2 −→ D
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                              31

where
   V1 = {(g, x) ∈ G × G0 ; x−1 gx ∈ NG P ∩ D},
   V2 = {(g, xP ) ∈ G × G0 /P ; x−1 gx ∈ NG P ∩ D},
   a(g, x) = ξ(x−1 gx), a′(g, x) = (g, xP ), a′′ (g, xP ) = g.
Then a, a′ are smooth morphisms with connected fibres. To any A ∈ M(D′ ) which
is L-equivariant for the conjugation action of L on D′ we associate a complex
indD
   D′ A ∈ D(D) as follows. The complex ãA ∈ M(V1 ) is P -equivariant for the
action p : (g, x) 7→ (g, xp−1 ) of P on V1 . Since a′ is a principal P -bundle, there is a
well defined complex A1 ∈ M(V2 ) such that ãA = ã′ A1 . We set indD               ′′
                                                                          D′ (A) = a! A1 .

27.2. Let L′ be a Levi of a parabolic of L. Let S be an isolated stratum of NG′ L′
such that S ⊂ D and S normalizes some parabolic of L with Levi L′ . Then S
is also an isolated stratum of NG L′ such that S normalizes some parabolic of G0
with Levi L′ . We have a commutative diagram in which all squares except the top
two are cartesian:
                               =            =
                       S ′∗ ←−−−− S ′∗ −−−−→ S ′∗
                         x          x          x
                         
                      r0 
                                    
                                 r1 
                                               
                                            r2 

                               c            c′
                        Ŷ ′ ←−−−− Ẑ1 −−−−→ Ẑ2
                                             
                         
                      q0 y
                                     
                                  q1 y
                                               
                                            q2 y

                               b            b′            k
                        Ỹ ′ ←−−−− Z1 −−−−→ Z2 ←−−−− Ỹ
                                            
                         
                      p0 y
                                     
                                  p1 y
                                              
                                           p2 y

                               a            a′            a′′
                       D′ ←−−−− V1 −−−−→ V2 −−−−→ D
Here
  S ′∗ = {g ∈ S; ZG′ (gs )0 ⊂ L′ }, Ỹ ′ = {(g, lL′ ) ∈ G′ × L/L′ ; l−1 gl ∈ S ′∗ },
  S ∗ = {g ∈ S; ZG (gs )0 ⊂ L′ }, Ỹ = {(g, xL′) ∈ G × G0 /L′ ; x−1 gx ∈ S ∗ },
  Z1 = {(g, lL′, x) ∈ G × ×L/L′ × G0 ; l−1 x−1 gxl ∈ S ′∗ UP },
  Z2 = {(g, xL′ UP ) ∈ G × G0 /(L′ UP ); x−1 gx ∈ S ′∗ UP },
  Ŷ ′ = {(g, l) ∈ G′ × L; l−1 gl ∈ S ′∗ },
  Ẑ1 = {(g, l, x) ∈ G × ×L × G0 ; l−1 x−1 gxl ∈ S ′∗ UP },
  Ẑ2 = {(g, xUP ) ∈ G × G0 /UP ; x−1 gx ∈ S ′∗ UP },
  c(g, l, x) = (ξ(x−1 gx), l), c′(g, l, x) = (g, xlUP ),
  b(g, lL′, x) = (ξ(x−1 gx), lL′ ), b′ (g, lL′ , x) = (g, xlL′UP ),
  k(g, xL′) = (g, xL′ UP ), q0 (g, l) = (g, lL′), q1 (g, l, x) = (g, lL′ , x),
  q2 (g, vUP ) = (g, vL′UP ), p0 (g, lL′) = g, p1 (g, lL′ , x) = (g, x),
  p2 (g, vL′ UP ) = (g, vP ), r0(g, l) = l−1 gl,
and r1 (g, l, x) = s1 ∈ S ′∗ , r2 (g, vUP ) = s2 ∈ S ′∗ are defined by
  l−1 x−1 gxl ∈ s1 UP , v −1 gv ∈ s2 UP .
Let Y ′ = ∪l∈L lS ′∗ l−1 (a locally closed smooth irreducible subvariety of D′ , see
32                                             G. LUSZTIG

3.16, 3.17). Let Y1′ = a−1 (Y ′ ); this is a locally closed smooth irreducible subvariety
of V1 which is P -stable since Y ′ is stable under L-conjugacy (we use that a is
smooth with connected fibres). Hence Y1′ = a′−1 (Y2′ ) where Y2′ is a well defined
locally closed smooth irreducible subvariety of V2 . Let Y = ∪x∈G0 xS ∗ x−1 (a
locally closed smooth irreducible subvariety of D). Let Ȳ ′ , Ȳ1′ , Ȳ2′ , Ȳ be the closure
of Y ′ , Y1′ , Y2′ , Y in D′ , V1 , V2 , D. Then a′−1 (Ȳ2 ) = Ȳ1 = a−1 (Ȳ ′ ). Let

  W ′ = {n ∈ NL L′ ; nSn−1 = n}/L′ , W = {n ∈ NG0 L′ ; nSn−1 = n}/L′ .
Then W ′ ⊂ W are finite groups. Now W ′ acts freely on Ỹ ′ , Z1 , Z2 by

     n : (g, lL′ ) 7→ (g, ln−1L′ ), n : (g, lL′, x) 7→ (g, ln−1 L′ , x),

     n : (g, xL′ UP ) 7→ (g, xn−1 L′ UP ).
                                                      b        b′
These actions are compatible with Ỹ ′ ←− Z1 −→ Z2 . By 3.13, p0 : Ỹ ′ −
                                                                        → Y ′ is a
           ′                                     ′                ′
principal W -bundle. It follows that p1 : Z1 −
                                             → Y1 and p2 : Z2 −
                                                              → Y2 are principal
  ′
W -bundles.

    Now W acts freely on Ỹ by n : (g, xL′ ) 7→ (g, xn−1 L′ ). From 3.13 we see that
       → Y, (g, xL′) 7→ g is a principal W-bundle. From the definitions we see that
p : Ỹ −

   (a) the restriction of the W-action on Ỹ to the subgroup W ′ is compatible via
       → Z2 with the W ′ -action on Z2 .
k : Ỹ −
Let E ∈ S(S). Let Ẽ be the local system on Ỹ defined as in 5.6 (with G, L′ , S
instead of G, L, S). Let Ẽ ′ , Ẽ1 , Ẽ2 be the local system on Ỹ ′ , Z1 , Z2 (respectively)
defined by

   q0∗ Ẽ ′ = r0∗ E, q1∗ Ẽ1 = r1∗ E, q2∗ Ẽ2 = r2∗ E.
We have b∗ Ẽ ′ = Ẽ1 = b′∗ Ẽ2 . Hence (p1 )! b∗ Ẽ ′ = (p1 )! b′∗ Ẽ2 = (p1 )! Ẽ1 . Now
(p0 )! Ẽ ′ , (p2 )! Ẽ2 are local systems on Y ′ , Y2′ and a∗ (p0 )! Ẽ ′ = a′∗ (p2 )! Ẽ2 = (p1 )! Ẽ1 as
local systems on Y1′ . We have Ẽ = k ∗ Ẽ2 . Let

     K ′ = IC(Ȳ ′ , (p0 )! Ẽ ′ )[dim Ỹ ′ ], K1 = IC(Ȳ1′ , (p1 )! Ẽ1 )[dim Z1 ],

   K2 = IC(Ȳ2′ , (p2 )! Ẽ2 )[dim Z2 ], K = IC(Ȳ , p! Ẽ)[dim Ỹ ],
regarded as perverse sheaves on D′ , V1 , V2 , D, zero on D′ −Ȳ ′ , V1 −Ȳ1′ , V2 −Ȳ2′ , D−Ȳ
respectively. Since a, a′ are smooth morphisms with connected fibres, we see that
ãK ′ = K1 = ã′ K2 in M(V1 ). Hence

  (b) indD    ′     ′′
         D′ (K ) = a! K2 .
We show that

   (c) a′′! K2 = K canonically.
Let P ′ be a parabolic of L with Levi L′ such that S ⊂ NG′ P ′ . Then P1′ = P ′ UP
is a parabolic of G0 with Levi L′ such that S ⊂ NG P1′ . We have a commutative
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                     33

diagram with cartesian squares

                                         b             b′
                                 Ỹ ′ ←−−−− Z1 −−−−→ Z2
                                                     
                                  
                               j0 y
                                              
                                           j1 y
                                                       
                                                    j2 y

                                         e             e′
                                 X ′ ←−−−− Z −−−−→ X
                                                   
                                   
                                t0 y
                                             
                                          t1 y
                                                     
                                                  t2 y

                                         a             a′
                                 D′ ←−−−− V1 −−−−→ V2

Here
   X ′ = {(g, lP ′) ∈ G′ × L/P ′ ; l−1 gl ∈ S̄UP ′ },
   X = {(g, vP1′ ) ∈ G × G0 /P1′ ; v −1 gv ∈ S̄UP1′ },
   Z = {(g, lP ′, x) ∈ G × ×L/P ′ × G0 ; l−1 x−1 gxl ∈ S̄UP1′ },
   e(g, lP ′, x) = (ξ(x−1 gx), lP ′), e′ (g, lP ′, x) = (g, xlP1′ ),
   t0 (g, lP ′ ) = g, t1 (g, lP ′ , x) = (g, x), t2(g, vP1′ ) = (g, vP ),
   j0 (g, lL′ ) = (g, lP ′ ), j1 (g, lL′, x) = (g, lP ′ , x), j2 (g, xL′UP ) = (g, xP1′ ).
Since j0 is an open imbedding (by 5.5) we see that j1 , j2 are open imbeddings. We
identify Ỹ ′ , Z1 , Z2 with open subsets of X ′ , Z, X via j0 , j1 , j2 . The composition
     k       j2
   → Z2 −→ X is the map (g, xL′ ) 7→ (g, xP1′ ) which is an open imbedding by 5.5.
Ỹ −
Since Z2 is an open subset of X via j2 , we see that Ỹ may be identified with an
open subset of Z2 via k. Since e, e′ are smooth morphisms with connected fibres,
we see that
   ẽIC(X ′ , Ẽ ′ )[dim X ′ ] = IC(Z, Ẽ1)[dim Z] = ẽ′ IC(X, Ẽ2 )[dim X] in M(Z).
From 5.7 we see that K ′ = (t0 )! IC(X ′ , Ẽ ′ )[dim X ′ ]. Hence
   K1 = (t1 )! IC(Z, Ẽ1 )[dim Z], K2 = (t2 )! IC(X, Ẽ2 )[dim X].
Since Ẽ = Ẽ2 |Ỹ , we have IC(X, Ẽ2 ) = IC(X, Ẽ) and K2 = (t2 )! IC(X, Ẽ)[dim X].
The composition a′′ t2 : X −          → D is (g, vP1′ ) 7→ g. Using 5.7 we have a′′! K2 =
(a′′ t2 )! IC(X, Ẽ)[dim X] = K. This proves (c).
   Define E = ⊕w∈W Ew as in 7.10 (for G, L′ , S, E instead of G, L, S, E). Define
E′ = ⊕w∈W ′ E′w in the same way (for G′ , L′ , S, E instead of G, L, S, E). Then E is
naturally an algebra and E′ is a subalgebra of E. Since a, a′ are smooth morphisms
with connected fibres, we see that
   E′ = End((p0 )! Ẽ ′ ) = End(K0 ) = End(K1 ) = End(K2 ).
Now a′′! defines a ring homomorphism End(K2 ) −                  → End(a′′! K2 ). Thus a′′! K2 be-
comes an E′ -module. On the other hand E = End(K). Using (a) and the defini-
tions we see that the restriction of the E-module structure of K to E′ corresponds
under (c) to the E′ -module structure on a′′! K2 .
   Let Γ be a subgroup of W ′ and let E′Γ = ⊕w∈Γ E′w , a subalgebra of E′ hence of
E. Let ρ be a E′Γ -module of finite dimension over Q̄l . Let
   K ′ (ρ) = HomE′Γ (ρ, K ′ ) ∈ M(D′ ), K1 (ρ) = HomE′Γ (ρ, K1 ) ∈ M(V1 ),
34                                        G. LUSZTIG

  K2 (ρ) = HomE′Γ (ρ, K2 ) ∈ M(V2 ), K(ρ) = HomE′Γ (ρ, K) ∈ M(D).
Then ãK ′ (ρ) = K1 (ρ) = ã′ K2 (ρ) and

(d)                    indD    ′        ′′
                          D′ (K (ρ)) = a! K2 (ρ) = K(ρ) ∈ M(D).


27.3. Let P, L, G′ , D, D′ be as in 27.1. Let Q be a parabolic of L with Levi M
such that NG′ Q ∩ D′ 6= ∅. Let G′′ = NG′ Q ∩ NG′ M . Then G′′0 = M , NG′ Q ∩ D′
is a connected component of NG′ Q and D′′ = G′′ ∩ D′ is a connected component
of G′′ . Let R = QUP , a parabolic of G0 with Levi M . We have R ⊂ P and
NG R ∩ D 6= ∅. (Indeed, D′′ ⊂ NG R ∩ D; more precisely, NG R ∩ NG M ∩ D = D′′ .)
Note that NG R ∩ NG M contains G′′ as a subgroup of finite index and both have
D′′ as a connected component.
   Let M ′ be a Levi of a parabolic of M . Let S be an isolated stratum of NG′′ M ′
such that S ⊂ D and S normalizes some parabolic of M with Levi M ′ . Then S
is also an isolated stratum of NG′ M ′ such that S normalizes some parabolic of L
with Levi M ′ . Moreover, S is an isolated stratum of NG M ′ such that S normalizes
some parabolic of G0 with Levi M ′ . Let
   S ′′∗ = {g ∈ S; ZG′′ (gs )0 ⊂ M ′ },
   Ỹ ′′ = {(g, mM ′ ) ∈ G′′ × M/M ′ ; m−1 gn ∈ S ′′∗ },
   S ′∗ = {g ∈ S; ZG′ (gs )0 ⊂ M ′ },
   Ỹ ′ = {(g, lL′ ) ∈ G′ × L/M ′ ; l−1 gl ∈ S ′∗ },
   S ∗ = {g ∈ S; ZG (gs )0 ⊂ M ′ },
   Ỹ = {(g, xM ′ ) ∈ G × G0 /M ′ ; x−1 gx ∈ S ∗ }.
Let
   Y ′′ = ∪m∈M mS ′′∗ m−1 , Y ′ = ∪l∈L lS ′∗ l−1 , Y = ∪x∈G0 xS ∗ x−1 .
Define
   p′′ : Ỹ ′′ −→ Y ′′ , p′ : Ỹ ′ −
                                   → Y ′ , p : Ỹ −
                                                  →Y
by the first projection. Let
   W ′′ = {n ∈ NM M ′ ; nSn−1 = n}/M ′ ,
   W ′ = {n ∈ NL M ′ ; nSn−1 = n}/M ′ ,
   W = {n ∈ NG0 M ′ ; nSn−1 = n}/M ′ .
Then W ′′ ⊂ W ′ ⊂ W are finite groups. As in 3.13, p′′ is a principal W ′′ -bundle, p′
is a principal W ′ -bundle, p is a principal W-bundle. Let E ∈ S(S). Define a local
system Ẽ on Ỹ as 5.6 (with G, M ′ , S instead of G, L, S). Define a local system Ẽ ′
on Ỹ ′ as 5.6 (with G′ , M ′ , S instead of G, L, S). Define a local system Ẽ ′′ on Ỹ ′′
as 5.6 (with G′′ , M ′ , S instead of G, L, S). Then p′′! Ẽ ′′ , p′! Ẽ ′ , p! Ẽ is a local system
on Y ′′ , Y ′ , Y respectively. We regard
   K ′′ = IC(Ȳ ′′ , p′′! Ẽ ′′ )[dim Ỹ ′′ ],
   K ′ = IC(Ȳ ′ , p′! Ẽ ′ )[dim Ỹ ′ ],
   K = IC(Ȳ , p! Ẽ)[dim Ỹ ],
as perverse sheaves on D′′ , D′ , D respectively, zero on D′′ − Ȳ ′′ , D′ − Ȳ ′ , D − Ȳ .
Define E = ⊕w∈W Ew as in 7.10 (for G, M ′ , S, E instead of G, L, S, E). Define in
the same way E′ = ⊕w∈W ′ E′w (for G′ , M ′ , S, E instead of G, L, S, E) and E′′ =
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, V                                35

⊕w∈W ′′ E′′w (for G′′ , M ′ , S, E instead of G, L, S, E). Then E is naturally an algebra,
E′ is a subalgebra of E and E′′ is a subalgebra of E′ . We have naturally
   E′′ = End(K ′′ ), E′ = End(K ′ ), E = End(K).
Thus, K ′′ , K ′ , K are naturally E′′ -modules. Let ρ be a finite dimensional E′′ -
module over Q̄l . Let
   K ′′ (ρ) = HomE′′ (ρ, K ′′ ) ∈ M(D′′ ),
   K ′ (ρ) = HomE′′ (ρ, K ′ ) ∈ M(D′ ),
   K(ρ) = HomE′′ (ρ, K) ∈ M(D).
Applying 27.2(d) with G′ , Q, M, M ′ instead of G, P, L, L′ and Γ = W ′′ we have
         ′
   indD       ′′         ′
       D′′ (K (ρ)) = K (ρ) ∈ M(D ).
                                          ′

Applying 27.2(d) with G, P, L, M instead of G, P, L, L′ and Γ = W ′′ we have
                                        ′

   indD      ′
       D′ (K (ρ)) = K(ρ) ∈ M(D).
Applying 27.2(d) with G, R, M, M ′ instead of G, P, L, L′ and Γ = W ′′ we have
   indD       ′′
       D′′ (K (ρ)) = K(ρ) ∈ M(D ).
                                        ′

Hence we have the following transitivity formula:
                                    ′
(a)                     indD      D     ′′          D     ′′
                           D′ (indD′′ (K (ρ))) = indD′′ (K (ρ)).


                                        References
[B]   R.Bédard, On the Brauer liftings of modular representations, J.Algebra 93 (1985), 332-
      353.
[BBD] A.Beilinson, J.Bernstein and P.Deligne, Faisceaux pervers, Astérisque 100 (1981).
[L3]  G.Lusztig, Character sheaves,I, Adv.Math. 56 (1985), 193-237; II, 57 (1985), 226-265;
      III, 57 (1985), 266-315; IV, 59 (1986), 1-63; V, 61 (1986), 103-155.
[L9]  G.Lusztig, Character sheaves on disconnected groups,I, Represent.Th. (electronic) 7
      (2003), 374-403; II, math.RT/0307268; III, math.RT/0308126; IV, math.RT/0312338.
[L10] G.Lusztig, Parabolic character sheaves,I, math.RT/0302151.

      Department of Mathematics, M.I.T., Cambridge, MA 02139
