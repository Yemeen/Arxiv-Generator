                                                                         PARAMETRIZATIONS OF FLAG VARIETIES
arXiv:math/0307017v2 [math.RT] 15 Apr 2004




                                                                                          R. J. MARSH AND K. RIETSCH


                                                      Abstract. For the flag variety G/B of a reductive algebraic group G we define and describe explicitly
                                                      a certain (set-theoretical) cross-section Ï† : G/B â†’ G. The definition of Ï† depends only on a choice of
                                                      reduced expression for the longest element w0 in the Weyl group W . It assigns to any gB a representative
                                                      g âˆˆ G together with a factorization into simple root subgroups and simple reflections. The cross-section Ï† is
                                                      continuous along the components of Deodharâ€™s decomposition of G/B [6]. We introduce a generalization of
                                                      the Chamber Ansatz of [2] and give formulas for the factors of g = Ï†(gB). These results are then applied to
                                                      parametrize explicitly the components of the totally nonnegative part of the flag variety (G/B)â‰¥0 defined
                                                      by Lusztig [10], giving a new proof of Lusztigâ€™s conjectured cell decomposition of (G/B)â‰¥0 . We also give
                                                      minimal sets of inequalities describing these cells.




                                                                                                 1. Introduction
                                                Consider a simply connected reductive algebraic group G over C (or Chevalley group over K) with
                                             opposite Borel subgroups B + and B âˆ’ . So for example G = SLd (C) with the subgroups of upper- and
                                             lower-triangular matrices. The flag variety G/B + may be embedded in the projective space of a sufficiently
                                             general representation of G, say V = V (Ï), by
                                                                                       G/B + Ö’â†’ P(V ) : gB + â†’ hg Â· Î¾iC ,
                                             where Î¾ is a highest weight vector. Then to any element gB + we may associate the highest and lowest
                                             extremal weights, vÏ and wÏ, such that g Â· Î¾ has nonzero component in the corresponding weight space.
                                             Equivalently, the Weyl group elements v and w determine the intersection of opposed Bruhat cells
                                                                                           B âˆ’ vB + /B + âˆ© B + wB + /B +
                                             in which gB + lies. Now fix a reduced expression w0 = si1 Â· Â· Â· siN for the longest element of the Weyl
                                             group. Following V. Deodhar [6], there is a finer datum that can be associated to gB + . The el-
                                             ement gB + can be successivelyreduced, compatibly with this reduced expression, to give a sequence
                                              B + , g(1) B + , . . . , g(nâˆ’1) B + , gB + in the flag variety, or a sequence of intermediate lines
                                                                                            
                        
         
                                                                          L0 = hÎ¾i , L1 = g(1) Â· Î¾ , . . . , Lnâˆ’1 = g(nâˆ’1) Â· Î¾ , Ln = hg Â· Î¾i
                                             in V (Ï). For example, if we write gB + as bwB + for b âˆˆ B + , then Lnâˆ’1 is the line hbwsi Â· Î¾i, where si is the
                                             right-most simple reflection in the reduced expression for w0 such that wsi < w (see Section 4.4). Given all
                                             the intermediate lines Lk , the further data associated to gB + is now the collection (v(1) , . . . , v(n) ) of Weyl
                                             group elements such that v(k) Ï is the highest extremal weight for which g(k) Â· Î¾ has non-zero weight space
                                             component. The set of gB + in B + wB + /B + with fixed (v(1) , . . . , v(n) ) is called a Deodhar component of
                                             the flag variety.
                                                Consider the special case where the element gB + from above has v = 1. Then gB + = uB + for some
                                             unipotent u âˆˆ B âˆ’ . If also v(i) = 1 for all i, then u may be factorized into negative simple root subgroups
                                             as u = yj1 (t1 ) Â· Â· Â· yjn (tn ) for some nonzero parameters ti âˆˆ C (where sj1 Â· Â· Â· sjn is a reduced expression for
                                             w governing the construction of the intermediate lines Li ). If we write uB + = zwB + for some unipotent

                                                Date: February 11 2004, revised March 19 2004.
                                                Key words and phrases. Algebraic groups, flag varieties, total positivity, Chamber Ansatz, Deodhar decomposition.
                                                2000 Mathematics Subject Classification. 14M15 (20G20).
                                             The first named author was supported by a University of Leicester Research Fund Grant and a Leverhulme Fellowship. The
                                             second named author is supported by a Royal Society Dorothy Hodgkin Research Fellowship.
                                                                                                           1
2                                          R. J. MARSH AND K. RIETSCH


z âˆˆ B + , then A. Berenstein and A. Zelevinskyâ€™s Chamber Ansatz [2] gives formulas for the ti in terms of
minors of z.
   In this paper we generalize the above result by describing factorizations, and hence parametrizations, for
a general Deodhar component and giving formulas for the parameters (Proposition 5.2 and Theorem 7.1).
Our formulas for the nonzero parameters, analogous to the tk above, are obtained by a direct generalization
of the Chamber Ansatz. However a general Deodhar component also has another type of parameter which
runs through K. The formulas for these involve the generalized Chamber Ansatz along with a correction
term.
   The Chamber Ansatz used in the formulas for the parameters depends on the Deodhar component
in which an element zwB + lies. Therefore we also give a simple algorithm to determine this component
(Section 6). The algorithm in a sense â€˜generatesâ€™ the chambers in the Chamber Ansatz for zwB + recursively.
We illustrate how this works with a very explicit type A example in Section 10.
   In Section 11 we set K = R and use these results to examine the totally nonnegative part (G/B + )â‰¥0 of
the flag variety. This is the closure in G/B + of the set {yi1 (t1 ) Â· Â· Â· yiN (tN )B + | ti âˆˆ R>0 }. We explicitly
describe the intersection of (G/B + )â‰¥0 with each of the sets Rv,w = B âˆ’ vB + /B + âˆ© B + wB + /B + . Namely
in Rv,w there is a unique open dense Deodhar component which is isomorphic to (Râˆ— )â„“(w)âˆ’â„“(v) . And the
totally nonnegative part R>0v,w of Rv,w is shown to be the subset of the above Deodhar component where
all of the parameters are positive.
   This in particular reproves a result of the second author conjectured by G. Lusztig, that R>0      v,w is a semi-
algebraic cell. However the new proof presented in this paper gives for the first time explicit parametriza-
tions of these totally nonnegative parts (depending on a choice of reduced expression of w). And it has
the advantage of being independent of the theory of canonical bases, which was required in the previous
                                       >0
proof. Moreover the parameters of Rv,w     can all be computed by the generalized Chamber Ansatz (without
correction term).
   Finally in Section 11 we give an efficient description for R>0
                                                               v,w in terms of minor inequalities, generalizing
a result of Berenstein and Zelevinsky from the v = 1 case. For any choice of reduced expression for w we
obtain a set of â„“(w) âˆ’ â„“(v) inequalities. This set of inequalities and â„“(v) minor equalities, that can also be
                                                                                              +   +    +
given explicitly, describe R>0
                            v,w as a semi-algebraic subset of the (real) Bruhat cell B wB /B .

Remark 1.1. The case of intersections of opposite Bruhat cells Rv,w in the flag variety which we treat in
this paper is not to be confused with intersections of opposite Bruhat double cosets

                                           Gv,w = B + wB + âˆ© B âˆ’ vB âˆ’

in the group. These other intersections were studied by Fomin and Zelevinsky [7], who obtained a different
generalization of the Chamber Ansatz in that setting (using it also to give parametrizations and minimal
sets of inequalities for their corresponding totally positive parts in the group).
   Our study of parametrizations in flag varieties compatible with the Rv,w is substantially different from
the problems in the group considered in [7], for example already where total positivity is concerned. An
immediate and obvious difference between total positivity questions in the two cases lies in the fact that
(G/B + )â‰¥0 is the closure of the image in G/B + of the totally nonnegative part Gâ‰¥0 of the group, and is
                                                                                                         +
actually generally larger than this image. So it is clear that the totally positive cells R>0
                                                                                            v,w in (G/B )â‰¥0
cannot all come from totally positive cells in Gâ‰¥0 . In fact, the cell decomposition of Gâ‰¥0 , which is studied
in detail in [7], was first obtained by Lusztig in [10] where the analogous problem for flag varieties was
formulated only as a conjecture. One has to depart significantly from the study of total positivity in the
group in order to study total positivity in the flag variety.
   The overlap between the two parametrization problems, ours and the one from [7], is precisely the joint
special case covered in [2]. In that case one has G1,w âˆ¼  = R1,w Ã— T , where the maximal torus factor T is
irrelevant for the parametrization problem. Otherwise, unless v = 1 or symmetrically w = w0 , the varieties
Gv,w have no sensible counterpart in the flag variety. Moreover both [2] and [7] parametrize and give
formulas only for an open dense subset of the varieties they study. So Theorem 7.1 already adds to these
results in the joint special case, since it determines parameters for any element in R1,w .
                                    PARAMETRIZATIONS OF FLAG VARIETIES                                           3


   It is an interesting open problem to extend our results from R1,w , and hence G1,w , also to the remaining
varieties Gv,w in the group. That is, similarly to find a way to parametrize every element of the group G.
This should involve finding appropriate stratifications of the Gv,w for arbitrary v, w (the open strata being
the ones already understood by [7]), and then extending the Chamber Ansatz from [7] to all the remaining
strata.

                                    2. Notation and basic definitions
   Let K be a field. Let GK be a split, connected, simply connected, semisimple algebraic K-group (or
Chevalley group over K). See [8] Section II.1 or any of [5], [13], [14]. Fix a K-split maximal torus TK .
We write Kâˆ— for the multiplicative group Gm (K) and K for the additive group Ga (K). As we will always
be concerned with the K-valued points we will write G for G(K) and T for T (K), and so forth. In later
sections we will take K to be R.
   Let X(T ) = Hom(T, Kâˆ— ) and R âŠ‚ X(T ) the set of roots. Choose a system of positive roots R+ . We
denote by B + the Borel subgroup corresponding to R+ , and by U + its unipotent radical. We also have
the opposite Borel B âˆ’ such that B + âˆ© B âˆ’ = T , and its unipotent radical U âˆ’ .
   Denote the set of simple roots by
                                     Î  = {Î±i | i âˆˆ I} âŠ‚ R+ âŠ‚ R âŠ‚ X(T ).
For every Î±i âˆˆ Î  there is an associated homomorphism
                                                  Ï•i : SL2 â†’ G.
Consider the 1-parameter subgroups in G (landing in U + , U âˆ’ and T respectively) defined by
                                                                               
                              1 m                    1 0                       t  0
                 xi (m) = Ï•i         , yi (m) = Ï•i           , Î±âˆ¨   (t) = Ï•i          ,
                              0 1                    m 1          i           0 tâˆ’1
where m âˆˆ K, t âˆˆ Kâˆ— , and i âˆˆ I. The datum (T, B + , B âˆ’ , xi , yi ; i âˆˆ I) for G is called a pinning in [10]. The
standard pinning for SLd consists of the diagonal, upper-triangular and lower-triangular matrices, along
with the simple root subgroups xi (m) = Id + mEi,i+1 and yi (m) = Id + mEi+1,i , where Id is the identity
matrix, and Ei,j has a 1 in position (i, j) and zeroes elsewhere.
   Next consider the cocharacter lattice Y (T ) = Hom(Kâˆ— , T ). It is dually paired with X(T ) in the standard
way by < , >: X(T ) Ã— Y (T ) â†’ Hom(Kâˆ— , Kâˆ— ) âˆ¼      = Z. The Î±âˆ¨   i viewed as elements of Y (T ) are the simple
coroots, and the Cartan matrix A = (aij ) âˆˆ Z      IÃ—I
                                                       is given by aij =< Î±j , Î±âˆ¨ i >.
   That G is simply connected means the Î±âˆ¨        freely generate  Y (T ) âˆ¼
                                                                          = ZI
                                                                               . The dual basisPin X(T ) is the set
                                               i
of fundamental weights {Ï‰i | i âˆˆ I}. Let X(T )+ be the set of dominant weights and Ï = iâˆˆI Ï‰i âˆˆ X(T )+ .
For a dominant weight Î» let V (Î») denote the Weyl module with highest weight Î», see [8] II 2.13. In
characteristic 0 this is just the irreducible representation with highest weight Î».
   The Weyl group W = NG (T )/T acts on X(T ) permuting the roots R. We denote the action of w âˆˆ W
on Î± âˆˆ X(T ) by wÎ±. The simple reflections si âˆˆ W are given explicitly by si := sÌ‡i T , where
                                                                
                                                           0 âˆ’1
                                               sÌ‡i := Ï•i            ,
                                                           1 0
and any w âˆˆ W can be expressed as a product w = si1 Â· Â· Â· sim with a minimal number of factors m = â„“(w).
We set
                                        wÌ‡ = sÌ‡i1 sÌ‡i2 Â· . . . Â· sÌ‡im
to get a representative of w in NG (T ). It is well known that this product is independent of the choice of
reduced expression si1 Â· Â· Â· sim for w. Let < denote the Bruhat order on W . The unique maximal element
of W is denoted w0 .
   We note for future reference the following identity ([8] II 1.3)
(2.1)                                 Î±âˆ¨
                                       i (t
                                            âˆ’1
                                               )sÌ‡i = xi (âˆ’tâˆ’1 )yi (t)xi (âˆ’tâˆ’1 ),
which can be checked in SL2 (K).
4                                                  R. J. MARSH AND K. RIETSCH


   Finally, for every root we introduce the corresponding root subgroup. Let UÎ±+i be the simple root
subgroup in G given explicitly by {xi (t) | t âˆˆ K}. For an arbitrary root Î± there is a w âˆˆ W and simple
root Î±i such that Î± = wÎ±i . Then the one-dimensional subgroup corresponding to Î± may be defined as
wÌ‡UÎ±+i wÌ‡âˆ’1 . If Î± âˆˆ R+ this subgroup lies in U + and we write UÎ±+ = wÌ‡UÎ±+i wÌ‡âˆ’1 . Otherwise the subgroup is
called UÎ±âˆ’ = wÌ‡UÎ±+i wÌ‡âˆ’1 and lies in U âˆ’ .

                                    3. Subexpressions of reduced expressions
   Consider a reduced expression in W , say s3 s2 s1 s3 s2 s3 in type A3 . Informally, a subexpression is what
is obtained by choosing some of the factors. So for example choosing the underlined factors in
(3.1)                                                            s3 s2 s1 s3 s2 s3
gives a subexpression for s2 s3 in the word s3 s2 s1 s3 s2 s3 .
   It will be useful to represent expressions, like s3 s2 s1 s3 s2 s3 or its subexpression s3 s2 1 s3 s2 1, by their
sequences of partial products
                    (   1,   s3 ,    s3 s 2 ,     s3 s 2 s 1 ,     s3 s 2 s 1 s 3 ,   s3 s 2 s 1 s 3 s 2 ,   s3 s 2 s 1 s 3 s 2 s 3   ),
                    (   1,   s3 ,    s3 s 2 ,     s3 s 2 ,         s3 s 2 s 3 ,       s2 s 3 ,               s2 s 3                   ).
We formalize this below.
Definition 3.1. Let us define an expression for w âˆˆ W to be a sequence
                                                                          
                                    w = w(0) , w(1) , w(2) , . . . , w(n)
in W , such that w(0) = 1, w(n) = w and
                                   (
                                      w(jâˆ’1) ,                       or
                            w(j) =
                                      w(jâˆ’1) si ,                    for some simple reflection si
for j = 1, . . . , n. The expression w may equivalently be specified by its sequence of factors,
                                                         âˆ’1                  âˆ’1
                                                (w(1) , w(1) w(2) , . . . , w(nâˆ’1) w(n) ),
which has entries in {si | i âˆˆ I} âˆª {1}.
Definition 3.2. For an expression w = (w(0) , w(1) , . . . , w(n) ) define
                                          +
                                         Jw = {k âˆˆ {1, . . . , n} | w(kâˆ’1) < w(k) },
                                         â—¦
                                        Jw = {k âˆˆ {1, . . . , n} | w(kâˆ’1) = w(k) },
                                          âˆ’
                                         Jw = {k âˆˆ {1, . . . , n} | w(k) < w(kâˆ’1) }.
An expression w = (w(0) , w(1) , . . . , w(n) ) is called non-decreasing if w(jâˆ’1) â‰¤ w(j) for all j = 1, . . . , n, so
  âˆ’
Jw  = âˆ…. It is called reduced if w(jâˆ’1) < w(j) for all j = 1, . . . , n. Clearly, any non-decreasing expression w
                                               b of w by discarding all w(j) with j âˆˆ Jw â—¦
for w gives rise to a reduced expression w                                                 .
    The following definition is taken from [6, Definition 2.3].
Definition 3.3 (Distinguished subexpressions). Let w be a reduced expression for w âˆˆ W with fac-
tors (si1 , . . . , sin ). Let v â‰¤ w. Then by a subexpression for v in w, we mean an expression v =
(v(0) , v(1) , v(2) , . . . , v(n) ) such that
                                                                    	
                                          v(j) âˆˆ v(jâˆ’1) , v(jâˆ’1) sij   for all j = 1, . . . n,
and v(n) = v. In particular there is always the â€œemptyâ€ subexpression (1, . . . , 1) for 1.
  A subexpression v of w as above is called distinguished if we have
(3.2)                                   v(j) â‰¤ v(jâˆ’1) sij               for all j âˆˆ {1, . . . , n}.
In other words, if right multiplication by sij decreases the length of v(jâˆ’1) , then in a distinguished subex-
pression the component v(j) must be given by v(j) = v(jâˆ’1) sij .
   We write v â‰º w if v is a distinguished subexpression of w.
                                            PARAMETRIZATIONS OF FLAG VARIETIES                                              5


Examples. For w = w0 in A3 and the reduced expression w with factors (s3 , s2 , s1 , s3 , s2 , s3 ), the only
distinguished subexpression for s2 s3 is
(3.3)                                                  v = (1, 1, 1, 1, 1, s2, s2 s3 ).
In particular, the subexpression indicated in (3.1) is not distinguished. If v = s2 , then we have four
distinguished subexpressions for v in w,
(3.4)                v = (1, 1, 1, 1, 1, s2, s2 ),                                                  (s3 s2 s1 s3 s2 s3 ),
(3.5)                v = (1, s3 , s3 , s3 , 1, s2 , s2 ),                                           (s3 s2 s1 s3 s2 s3 ),
(3.6)                v = (1, s2 , s2 , s2 s3 , s2 s3 , s2 ),                                        (s3 s2 s1 s3 s2 s3 ),
(3.7)                v = (1, s3 , s3 s2 , s3 s2 , s3 s2 s3 , s2 s3 , s2 ),                          (s3 s2 s1 s3 s2 s3 ).
Definition 3.4 (Positive subexpressions). Let w be a reduced expression with factors (si1 , . . . , sin ). We
call a subexpression v of w positive if
(3.8)                                                        v(jâˆ’1) < v(jâˆ’1) sij
for all j = 1, . . . , n.
  Note that (3.8) is equivalent to v(jâˆ’1) â‰¤ v(j) â‰¤ v(jâˆ’1) sij . So in other words a positive subexpression is
one that is distinguished and non-decreasing. In the examples above only (3.3) and (3.4) are positive.
Lemma 3.5. Given v â‰¤ w in W and a reduced expression w for w, then there is a unique positive
subexpression v+ for v in w.
Proof. We construct v+ = (v(0) , . . . , v(n) ) starting from the right with v(n) = v. The inequality v(jâˆ’1) <
v(jâˆ’1) sij says that v(jâˆ’1) cannot have a reduced expression ending in sij . If v(j) has such a reduced
expression then we must set v(jâˆ’1) = v(j) sij . If v(j) does not, then v(jâˆ’1) = v(j) . To summarize, v(jâˆ’1) is
given by                                         (
                                                   v(j) sij if v(j) sij < v(j) ,
                                     v(jâˆ’1) =
                                                   v(j)      otherwise.
This along with v(n) = v clearly defines (uniquely) the desired positive subexpression of w.                                
   The positive subexpression v+ is in a sense the right-most subexpression for v in w that is non-decreasing.

                                                 4. Deodharâ€™s decomposition
4.1. Bruhat decomposition. Let us identify the flag variety with the variety B of Borel subgroups, via
                                                   gB + â†â†’ g Â· B + := gB + g âˆ’1 .
We have the Bruhat decompositions,
                                                     G                       G
                                             B=             B + wÌ‡ Â· B + =         B âˆ’ wÌ‡ Â· B âˆ’ ,
                                                    wâˆˆW                      wâˆˆW

of B into B + -orbits called Bruhat cells, and B âˆ’ -orbits called opposite Bruhat cells. Let Î±1 , . . . , Î±n be the
positive roots made negative by wâˆ’1 . Recall that the Bruhat cell B + wÌ‡ Â· B + can be identified with the
product of root subgroups
(4.1)                                                                      âˆ¼ Kn
                                   U + âˆ© wÌ‡U âˆ’ wÌ‡âˆ’1 = U +1 U +2 Â· Â· Â· U +n =
                                                                         Î±   Î±        Î±

via u 7â†’ uwÌ‡ Â· B + . Moreover,
                                           U + = (U + âˆ© wÌ‡U âˆ’ wÌ‡âˆ’1 )(U + âˆ© wÌ‡U + wÌ‡âˆ’1 ),
where the second factor is a product of the remaining positive root subgroups. Given a reduced expression
w = (w(0) , w(1) , . . . , w(n) ) with factors (si1 , . . . , sin ), the positive roots sent to negative roots by wâˆ’1 can
be listed as
(4.2)            Î±1w = Î±i1 ,       Î±2w = w(1) Â· Î±i2 ,          Î±3w = w(2) Â· Î±i3 , . . . . . . ,      Î±nw = w(nâˆ’1) Â· Î±in .
6                                           R. J. MARSH AND K. RIETSCH


Therefore another way to write down the parametrization of the Bruhat cell B + wÌ‡ Â· B + is by
                        âˆ¼
(4.3)              Kn âˆ’â†’ B + wÌ‡ Â· B + :      (m1 , . . . , mn ) 7â†’ xi1 (m1 )sÌ‡i1 Â· Â· Â· xin (mn )sÌ‡in Â· B + .
If one moves all the simple reflections to the right (conjugating the intermediate simple root subgroups),
then what remains on the left is a product of root subgroups corresponding to precisely the roots listed in
(4.2).

4.2. Relative position. Consider the product B Ã— B with G acting diagonally. Let B1 = g1 Â· B + and
B2 = g2 Â· B + . Then there is a unique w âˆˆ W such that g1 âˆ’1 g2 Â· B + âˆˆ B + wÌ‡ Â· B + . Equivalently, w is the
unique Weyl group element such that
                                       (B1 , B2 ) âˆˆ G-orbit of (B + , wÌ‡ Â· B + ).
We call w the relative position of (B1 , B2 ) and write
                                                                 w
                                                        B1 âˆ’â†’ B2 .
                   1                                                 w
For example B1 âˆ’â†’ B2 implies B1 = B2 . And B + âˆ’â†’ B says that B lies in the Bruhat cell B + wÌ‡ Â· B + .
           w
While B âˆ’ âˆ’â†’ B means that B lies in the opposite Bruhat cell B âˆ’ wÌ‡0 wÌ‡wÌ‡0 Â· B âˆ’ . We will also use the
notation
                                       (B1 , B2 ) âˆ¼ (B1â€² , B2â€² )
to indicate that (B1 , B2 ) and (B1â€² , B2â€² ) in B Ã— B are conjugate under G.
   The following assertions follow from the definitions and standard properties of the Bruhat decomposition.
               w                                             w
    (1) If B1 âˆ’â†’ B2 and g âˆˆ G, then also g Â· B1 âˆ’â†’ g Â· B2 .
               s     s                                        s
    (2) If B1 âˆ’â†’ B2 âˆ’â†’ B3 for a simple reflection s, then B1 âˆ’â†’ B3 or B1 = B3 .
               v     w                                        vw
    (3) If B1 âˆ’â†’ B2 âˆ’â†’ B3 and â„“(vw) = â„“(v) + â„“(w), then B1 âˆ’â†’ B3 .
               w                w âˆ’1
   (4) If B1 âˆ’â†’ B2 , then B2 âˆ’â†’ B1 .
We will make use of these properties freely.

4.3. Reduction maps. Suppose w = vv â€² with â„“(w) = â„“(v) + â„“(v â€² ). Then the set of positive roots sent
to negative roots by v âˆ’1 is a subset of the positive roots made negative by wâˆ’1 , by (4.2). Under these
circumstances one can define a morphism
                                           Ï€vw : B + wÌ‡ Â· B + â†’ B + vÌ‡ Â· B +
                                                    bwÌ‡ Â· B + 7â†’ bvÌ‡ Â· B + ,
where b âˆˆ B + . The map Ï€vw is well-defined since B + âˆ© wÌ‡B + wÌ‡âˆ’1                              âŠ†   B + âˆ© vÌ‡B + vÌ‡ âˆ’1 . For a given
B âˆˆ B + wÌ‡ Â· B + , the element Ï€vw (B) is characterized by the property
                                                    v                         v âˆ’1 w
(4.4)                                       B + âˆ’â†’ Ï€vw (B) âˆ’â†’ B.
Let us call Ï€vw a reduction map.

4.4. Deodharâ€™s theorem.
Definition 4.1. For v, w âˆˆ W define
                                                                                            w       w v
                       Rv,w := B + wÌ‡ Â· B + âˆ© B âˆ’ vÌ‡ Â· B + = {B âˆˆ B | B + âˆ’â†’ B â†âˆ’
                                                                                0
                                                                                  B âˆ’ }.
   The intersection Rv,w is non-empty precisely if v â‰¤ w. And in that case Kazhdan and Lusztig proved
that over an algebraically closed field it is irreducible of dimension â„“(w) âˆ’ â„“(v), see [9] Â§1. If v = w then
Rw,w = {wÌ‡ Â· B + }.
   Suppose now that w is a reduced expression for w âˆˆ W with factors (si1 , . . . , sin ), and B âˆˆ Rv,w . Using
the reduction maps we can associate to B uniquely a sequence of â€˜intermediateâ€™ Borel subgroups
                                             si         si               si            si
                                B + = B0 âˆ’â†’
                                          1     2
                                            B1 âˆ’â†’     3
                                                  B2 âˆ’â†’        n
                                                        Â· Â· Â· âˆ’â†’ Bn = B,
                                   PARAMETRIZATIONS OF FLAG VARIETIES                                         7

                                               w(k)
where Bk = Ï€w w
               (k)
                   (B). By construction B + âˆ’â†’ Bk . However, the position of Bk with respect to B âˆ’ , or
the opposite Bruhat cell containing Bk , defines a new element v(k) âˆˆ W by
                                              Bk âˆˆ B âˆ’ v(k) Â· B + .
For w as above and a sequence v := (v(0) , . . . , v(n) ) we define the Deodhar component Rv,w in B by
                                                    w
                               Rv,w := {B âˆˆ Rv,w | Ï€w(k)
                                                         (B) âˆˆ B âˆ’ v(k) Â· B + }
(4.5)                                                w
                                      = {B âˆˆ Rv,w | Ï€w(k)
                                                          (B) âˆˆ Rv(k) ,w(k) }.

Theorem 4.2 ([6] Theorem 1.1). Suppose w âˆˆ W and B âˆˆ B + wÌ‡ Â· B + , and fix a reduced expression
w = (w(0) , w(1) , . . . , w(n) ) for w.
    (1) The Deodhar component Rv,w is nonempty if and only if v is a distinguished subexpression of w.
    (2) If v â‰º w, then Rv,w âˆ¼
                                     â—¦        âˆ’
                            = (Kâˆ— )|Jv | Ã— K|Jv | , where Jvâ—¦ and Jvâˆ’ are as in Definition 3.2.
   Another proof of this theorem will be contained in the next section. If the reduced expression w is fixed,
then as a corollary of the theorem one has a decomposition
                                                     G
(4.6)                                        Rv,w =     Rv,w ,
                                                        v

where the union is over all distinguished subexpressions for v in w. Note that the Deodhar component
Rv+ ,w corresponding to the unique positive subexpression for v in w has dimension |Jvâ—¦+ | = â„“(w) âˆ’ â„“(v).
So if K is algebraically closed then it is dense in Rv,w . This also holds for K = R since Rv+ ,w (R) is Zariski
dense in Rv+ ,w (C). Finally, for K = R or K = C, it holds that Rv+ ,w is open dense in Rv,w with respect
to the usual Hausdorff topology.
   Suppose we fix a reduced expression w0 for the longest element w0 . Then for any w âˆˆ W the positive
subexpression for w in w0 determines a reduced expression w     b + for w. Therefore we have a decomposition
of the whole flag variety,
                                                     ï£«              ï£¶
                                                 G      G
(4.7)                                      B=        ï£­      Rv,w b+
                                                                    ï£¸,
                                              wâˆˆW       b+
                                                      vâ‰ºw

which we may call the Deodhar decomposition of B corresponding to w0 .
Remark 4.3. The varieties Rv,w may be defined over a finite field K = Fq . In this setting the number of
points determine the R-polynomials Rv,w (q) = #(Rv,w (Fq )) introduced by Kazhdan and Lusztig [9] to give
a recursive formula for the Kazhdan-Lusztig polynomials. This is the origin of the notation Rv,w as well as
Deodharâ€™s original application of the theorem. The decompositions (4.6) together with the isomorphisms
                                âˆ’
Rv,w (Fq ) âˆ¼
                     â—¦
           = (Fâˆ—q )|Jv | Ã— Fq |Jv | give formulas for the R-polynomials.

                      5. Explicit parametrizations of Deodhar components
  Let w be a reduced expression with factors (si1 , . . . , sin ), and v â‰º w.
Definition 5.1. Define a subset Gv,w in G by
                ï£±                                                                                  ï£¼
                ï£²                    gk = xik (mk )sÌ‡âˆ’1     if k âˆˆ Jvâˆ’ ,                           ï£½
                                                     ik
(5.1)    Gv,w = g = g1 g2 Â· Â· Â· gn  gk = yik (tk )         if k âˆˆ Jvâ—¦ ,   for tk âˆˆ Kâˆ— , mk âˆˆ K.       .
                ï£³                    gk = sÌ‡i                                                      ï£¾
                                              k
                                                             if k âˆˆ Jv+ ,
                                  â—¦       âˆ’
There is an obvious map (Kâˆ— )Jv Ã— KJv â†’ Gv,w defined by the parameters tk and mk in (5.1). For
v = w = (1) we define Gv,w = {1}.
  The following proposition gives an explicit parametrization for the Deodhar component Rv,w .
8                                               R. J. MARSH AND K. RIETSCH

                                          â—¦       âˆ’
Proposition 5.2. The map (Kâˆ— )Jv Ã— KJv â†’ Gv,w from Definition 5.1 is an isomorphism. The set Gv,w
lies in U âˆ’ vÌ‡ âˆ© B + wÌ‡B + , and the assignment g 7â†’ g Â· B + defines an isomorphism
                                                                 âˆ¼
(5.2)                                                  Gv,w âˆ’â†’ Rv,w .
  The special case v = 1 and w = w0 of this proposition already appears in [11] Proposition 2.5. The
proof below is analogous to the one we gave for that special case, and of course also similar to Deodharâ€™s
proof of Theorem 4.2.(2), although his is ultimately a different isomorphism.
Proof. Let w = (w(0) , . . . , w(n) ) be a reduced expression with factors (si1 , . . . , sin ), and v = (v(0) , . . . , v(n) ).
The proof is by induction on n. If n = 0 then v = w = (1) and the isomorphism (5.2) is the trivial
one 1 7â†’ B + . There is nothing more to check. For n > 0 let wâ€² := (w(0) , . . . , w(nâˆ’1) ) and similarly
vâ€² = (v(0) , . . . , v(nâˆ’1) ), the truncations of v and w. Also set wâ€² = w(nâˆ’1) and v â€² = v(nâˆ’1) . We may assume
the proposition is true for vâ€² , wâ€² .
                                               âˆ¼     w âˆ’1
   It is easy to check that Gvâ€² ,wâ€² Ã— K âˆ’â†’ (Ï€w        â€²)  (Rvâ€² ,wâ€² ) via the map (g â€² , m) 7â†’ g â€² xin (m)sÌ‡in Â· B + , using
for example (4.4) and properties of relative position. And we have a commutative diagram
                                                             âˆ¼  w âˆ’1
                                          Gvâ€² ,wâ€² Ã— K      âˆ’â†’ (Ï€w â€²)   (Rvâ€² ,wâ€² )
                                                                        w
(5.3)                                       pr1 â†“                    â†“ Ï€w â€²
                                                            âˆ¼
                                           Gvâ€² ,wâ€²         âˆ’â†’      Rvâ€² ,wâ€² .
               w âˆ’1
Now let B âˆˆ (Ï€w â€²)   (Rvâ€² ,wâ€² ), so B = g â€² xin (m)sÌ‡in Â· B + for some g â€² âˆˆ Gvâ€² ,wâ€² and m âˆˆ K. We consider two
cases.
    (i) Suppose m = 0. Then B = g â€² sÌ‡in Â· B + . Since g â€² âˆˆ U âˆ’ vÌ‡ â€² we have B âˆˆ B âˆ’ vÌ‡ â€² sÌ‡in Â· B + .
   (ii) Suppose m 6= 0. Then the identity (2.1) implies xin (m)sÌ‡in Â· B + = yin (mâˆ’1 ) Â· B + . So we may write
        B in two different ways,
                                       B = g â€² xin (m)sÌ‡i Â· B + = g â€² yin (mâˆ’1 ) Â· B + .
            â€¢ If v â€² sin > v â€² , then vÌ‡ â€² yin (mâˆ’1 )vÌ‡ â€²âˆ’1 âˆˆ U âˆ’ . In this case we have
                                                  g := g â€² yin (mâˆ’1 ) âˆˆ U âˆ’ vÌ‡ â€²
              and B = g Â· B + âˆˆ B âˆ’ vÌ‡ â€² Â· B + .
            â€¢ If v â€² sin < v â€² , then vÌ‡ â€² xin (m)vÌ‡ â€²âˆ’1 âˆˆ U âˆ’ . Therefore we have
                                               g := g â€² xin (m)sÌ‡âˆ’1    âˆ’ â€² âˆ’1
                                                                 in âˆˆ U vÌ‡ sÌ‡in

               and B = g Â· B + âˆˆ B âˆ’ vÌ‡ â€² sÌ‡âˆ’1    +
                                            in Â· B .
  Note that in both cases, (i) and (ii), if v â€² sin < v â€² we have B âˆˆ B âˆ’ vÌ‡ â€² sÌ‡in Â· B + . This explains Theo-
                                                                                                  w â€² âˆ’1
rem 4.2.(1). We now use the above to analyze the possibilities for an element B âˆˆ Rv,w âŠ† (Ï€w         ) (Rvâ€² ,wâ€² )
and complete the proof of the proposition.
                                                                                                      â€²
                                                                                  w âˆ’1
    (1) Suppose n âˆˆ Jvâˆ’ . Then both (i) and (ii) are possible. Therefore Rv,w = (Ï€w ) (Rvâ€² ,wâ€² ), and we
        have
                                                           âˆ¼
                                     Gv,w âˆ¼
                                          = Gvâ€² ,wâ€² Ã— K âˆ’â†’ Rv,w ,
        via g1 . . . gnâˆ’1 xin (mn )sÌ‡âˆ’1
                                     in 7â†’ (g1 . . . gnâˆ’1 , mn ) and (5.3).
    (2) If n âˆˆ Jvâ—¦ then v(n) = v(nâˆ’1) so only case (ii) is possible. Then (5.3) restricts to give
                                            âˆ¼ Gvâ€² ,wâ€² Ã— Kâˆ— âˆ’â†’ Rv,w ,     âˆ¼
                                      Gv,w =
        where the identification Gv,w âˆ¼
                                      = Gvâ€² ,wâ€² Ã— Kâˆ— is via g1 . . . gnâˆ’1 yin (tn ) 7â†’ (g1 . . . gnâˆ’1 , tâˆ’1
                                                                                                         n ).
    (3) Finally, if n âˆˆ Jv then only case (i) is possible and B = g â€² sÌ‡in Â· B + . Therefore (5.3) induces
                         +

                                                                      âˆ¼
                                              Gv,w âˆ¼
                                                   = Gvâ€² ,wâ€² Ã— { 1 } âˆ’â†’ Rv,w .
In each case Gv,w âŠ‚ U âˆ’ vÌ‡(n) , where we note that in (1) above, v(n) = v â€² sin < v â€² implies vÌ‡(n) = vÌ‡ â€² sÌ‡âˆ’1
                                                                                                             in . The
inclusion Gv,w âŠ‚ B + wÌ‡B + is clear.                                                                               
                                        PARAMETRIZATIONS OF FLAG VARIETIES                                           9


Remark 5.3. Let w0 be a fixed reduced expression for w0 . Then Deodharâ€™s decomposition (4.7) of B
together with Proposition 5.2 gives rise to a set theoretic crossection
                                                        Ï† : B âˆ’â†’ G,
                                                                                      âˆ¼
defined on each Deodhar component Rv,w                                 b + âˆ’â†’ Rv,w
                                          b + âŠ‚ B as the inverse of Gv,w         b + . To describe the map
Ï† more explicitly we must, firstly, explain how to determine the Deodhar component of an element of B
and, secondly, give formulas for the individual maps Rv,w â†’ Gv,w .

                                   6. Deodhar components in terms of minors
   Suppose B lies in a particular Bruhat cell, B = z wÌ‡ Â· B + for z âˆˆ U + . In this section we determine the
conditions on z for B to lie in a Deodhar component Rv,w . The conditions will be expressed in terms of
(generalized) minors of z.
   Let V (Î») be the Weyl module of G with highest weight Î». In the following Î» will often be a fundamental
weight Ï‰i . Consider the weight space decomposition V (Î») = âŠ•Âµ V (Î»)Âµ , and denote by prÂµ : V (Î») â†’ V (Î»)Âµ
the corresponding projections. Let us fix a highest weight vector Î¾Î» . Then the element wÌ‡ Â· Î¾Î» âˆˆ V (Î») for
w âˆˆ W spans the extremal weight space V (Î»)wÎ» . In this way, the choice of highest weight vector gives rise
to a canonical choice of basis vectors for all the extremal weight spaces.
Lemma 6.1. If wÎ» = wâ€² Î», then wÌ‡ Â· Î¾Î» = wÌ‡â€² Â· Î¾Î» .
Proof. It is necessary only to check that vÌ‡ Â· Î¾Î» = Î¾Î» whenever vÎ» = Î». Since the stabilizer of Î» is a parabolic
subgroup of W we may assume v is a simple reflection si . Then sÌ‡i = xi (âˆ’1)yi (1)xi (âˆ’1) and the statement
is clear.                                                                                                     

Definition 6.2 (Generalized minors). For Î· âˆˆ V (Î») define hÎ·, wÌ‡ Â· Î¾Î» i to be the coefficient in Î· of the
extremal weight vector wÌ‡ Â· Î¾Î» . That is, with notation as above,
                                              prwÎ» (Î·) = hÎ·, wÌ‡ Â· Î¾Î» i wÌ‡ Â· Î¾Î» .
For two extremal weights wÎ» and wâ€² Î» we then have a regular function âˆ†wÎ»
                                                                      w â€² Î» on G defined by
                                                                â€²
                                             âˆ†wÎ»
                                              w â€² Î» (g) := hg wÌ‡ Â· Î¾Î» , wÌ‡ Â· Î¾Î» i .

Since any weight lies in the Weyl group orbit of a unique dominant weight, this notation is unambiguous.
   It is not hard to see that âˆ†wÎ»w â€² Î» coincides with the regular function âˆ†wÎ»,w â€² Î» defined in [7, Definition 1.4].
   The functions âˆ†wÏ‰     i
                     w â€² Ï‰i , where  Ï‰i ranges through the set of fundamental weights, are called minors or
generalized minors. If G = SLd with the standard pinning then âˆ†wÏ‰        w â€² Ï‰i is precisely the usual i Ã— i minor,
                                                                             i

                                           â€²
where wÏ‰i encodes the row set and w Ï‰i the column set.
Definition 6.3 (Chamber minors). Suppose w is a reduced expression and v â‰º w a distinguished subex-
pression.
                          v   Ï‰i
    (1) The minors âˆ†w(k)   k
                      (k) Ï‰ik
                              for k = 0, 1, . . . , n are called the standard chamber minors for v and w.
                    v(kâˆ’1) Ï‰ik
    (2) The minors âˆ†w(k) Ï‰ik for k âˆˆ Jvâˆ’ âˆª Jv+ are called the special chamber minors for v and w.
             v     Ï‰ik        v    Ï‰i
Note that âˆ†w(kâˆ’1)
             (k) Ï‰ik
                         = âˆ†w(k)   k
                              (k) Ï‰ik
                                      if k âˆˆ Jvâ—¦ .

Proposition 6.4. Let B = z wÌ‡Â·B + for z âˆˆ U + , and w be a reduced expression with factors (si1 , si2 , . . . , sin ).
Then B lies in the the Deodhar component Rv,w where v = (v(0) , v(1) , . . . , v(n) ) is constructed as follows.
Let v(0) = 1. Suppose that k â‰¥ 1 and v(kâˆ’1) has already been defined.
                                         v      Ï‰i
    (a) If v(kâˆ’1) sik > v(kâˆ’1) and âˆ†w(kâˆ’1)
                                        (k) Ï‰ik
                                                k
                                                  (z) 6= 0, then v(k) = v(kâˆ’1) .
                                      v(kâˆ’1) Ï‰ik
    (b) If v(kâˆ’1) sik > v(kâˆ’1) and âˆ†w(k) Ï‰ik (z) = 0, then v(k) = v(kâˆ’1) sik .
    (c) If v(kâˆ’1) sik < v(kâˆ’1) , then v(k) = v(kâˆ’1) sik .
10                                               R. J. MARSH AND K. RIETSCH

                                                                               v    Ï‰i
Remark 6.5. Note that in the situation of the proposition âˆ†w(k)       k
                                                                 (k) Ï‰ik
                                                                         (z) 6= 0 for all k = 1, . . . , n, as follows
from the definition of the v(k) . The chamber minors give rise to well-defined maps (which we denote in the
same way),
                         v   Ï‰i                                            v   Ï‰i
                     âˆ†w(k)   k
                        (k) Ï‰i
                                : Rv,w â†’ Kâˆ— : z wÌ‡ Â· B + â†’
                                                         7 âˆ†w(k)    k
                                                               (k) Ï‰ik
                                                                       (z)                      k = 1, . . . , n,
                     v(kâˆ’1) Ï‰ik                              v(kâˆ’1) Ï‰
                                                       +
                                                                                                k âˆˆ Jvâˆ’ .
                                                                       i
                    âˆ†w(k) Ï‰ik : Rv,w â†’ K : z wÌ‡ Â· B â†’
                              k
                                                          7 âˆ†w(k) Ï‰ik k (z)
Proof. By Theorem 4.2.(1) we have that v is a distinguished subexpression of w. Therefore (c) holds. Now
suppose v(kâˆ’1) sik > v(kâˆ’1) . We have either
      (1) v(k) = v(kâˆ’1) and z wÌ‡(k) Â· B + âˆˆ B âˆ’ vÌ‡(kâˆ’1) Â· B + , or
      (2) v(k) = v(kâˆ’1) sik and z wÌ‡(k) Â· B + âˆˆ B âˆ’ vÌ‡(kâˆ’1) sÌ‡ik Â· B + .
We can distinguish between these two cases by looking just at the representation VÏ‰ik . In the first case, the
                                                                           v       Ï‰ik
highest weight occurring in z wÌ‡(k) Â· Î¾Ï‰ik is v(kâˆ’1) Ï‰ik , and hence âˆ†w(kâˆ’1) (k) Ï‰ik   (z) 6= 0. In the second case, the
highest weight occurring in z wÌ‡(k) Â·Î¾Ï‰ik is v(kâˆ’1) sik Ï‰ik , which is lower than v(kâˆ’1) Ï‰ik since v(kâˆ’1) sik > v(kâˆ’1) .
                     v       Ï‰ik
Therefore we have âˆ†w(kâˆ’1)
                       (k) Ï‰ik
                                 (z) = 0.                                                                             

   As a reformulation of Proposition 6.4 we have the following description of Rv,w inside the Bruhat cell
B + wÌ‡ Â· B + .
Corollary 6.6. Suppose w is a reduced expression of w and v â‰º w a distinguished subexpression, with Jv+
and Jvâ—¦ as in Definition 3.2. Then Rv,w may be described by
                                                 v       Ï‰ik                           
                                                 âˆ†w(kâˆ’1)
                                                     (k) Ï‰i
                                                               (z) = 0 for all k âˆˆ Jv+ ,
                   Rv,w = z wÌ‡ Â· B +  z âˆˆ U + ;  v(k) Ï‰ikk                               .
                                                  âˆ†w(k) Ï‰ik (z) 6= 0   for all k âˆˆ Jvâ—¦

                                         7. The generalized Chamber Ansatz
     By Proposition 5.2 a Deodhar component Rv,w comes with isomorphisms
                                                      â—¦           âˆ’   âˆ¼        âˆ¼
(7.1)                                          (Kâˆ— )Jv Ã— KJv â†’ Gv,w â†’ Rv,w .
The aim of this section is to describe an inverse to (7.1). The following theorem generalizes the Chamber
Ansatz of Berenstein and Zelevinsky [2].
Theorem 7.1. (Generalized Chamber Ansatz)
 Let B = z wÌ‡ Â· B + âˆˆ Rv,w , where z âˆˆ U + , v, w âˆˆ W and v â‰¤ w. Let w = (w(0) , w(1) , . . . , w(n) ) be a
reduced expression for w with factors (si1 , si2 , . . . , sin ). Then B lies in a Deodhar component Rv,w , where
v = (v(0) , v(1) , . . . , v(n) ) is a distinguished subexpression for v in w. By Proposition 5.2, there is g âˆˆ Gv,w
such that B = g Â· B + . By Definition 5.1 we can write g = g1 g2 Â· Â· Â· gn âˆˆ U âˆ’ vÌ‡ âˆ© B âˆ’ wÌ‡B + , where
                                                     ï£±
                                                     ï£² yik (tk )       k âˆˆ Jvâ—¦ ,
                                                gk =    sÌ‡i            k âˆˆ Jv+ ,
                                                     ï£³ k           âˆ’1
                                                        xik (mk )sÌ‡ik k âˆˆ Jvâˆ’ .
For each k, let g(k) = g1 g2 Â· Â· Â· gk denote the partial product. Then the following hold.
      (1) For k âˆˆ Jvâ—¦ , we have:
                                                          Q       v(k) Ï‰j     âˆ’aj,ik
                                                         j6=ik âˆ†w(k) Ï‰j (z)
                                               tk =    v Ï‰ik           v       Ï‰ik
                                                      âˆ†w(k)
                                                         (k) Ï‰ik
                                                                 (z)âˆ†w(kâˆ’1)
                                                                          (kâˆ’1) Ï‰ik
                                                                                    (z)
      (2) For k âˆˆ Jvâˆ’ , we have:
                                           v     Ï‰i           v       Ï‰i
                                         âˆ†w(kâˆ’1)
                                            (k) Ï‰ik
                                                    k
                                                      (z)âˆ†w(kâˆ’1)     k
                                                              (kâˆ’1) Ï‰ik
                                                                        (z)    v       Ï‰ik
                                  mk =    Q           v(k) Ï‰j    âˆ’aj,ik
                                                                            âˆ’ âˆ†si(kâˆ’1)
                                                                                   Ï‰
                                                                                  k ik
                                                                                           (g(kâˆ’1) ).
                                             j6=ik  âˆ† w(k) Ï‰j (z)
                                          PARAMETRIZATIONS OF FLAG VARIETIES                                         11


Remark 7.2. It is easy to check that the minors appearing in Theorem 7.1(1) are the standard chamber
minors of Definition 6.3(1). The formula for the mk also involves the special chamber minors, as well as
                     v      Ï‰ik
a correction term, âˆ†si(kâˆ’1)
                        Ï‰
                       k ik
                                (g(kâˆ’1) ), which can be computed recursively. It is an open problem to find a
closed formula in terms of minors of z for this correction term. See Section 8 for another interpretation of
the formulas in Theorem 7.1.
   In order to prove Theorem 7.1, we will rewrite the chamber minors as minors of g(k) = g1 g2 Â· Â· Â· gk ,
for k = 0, 1, . . . , n (Lemma 7.4). We will then compute these minors (Lemma 7.5) and substitute these
formulas back into the expressions in Theorem 7.1(1) and (2), finally showing that they reduce to the
coefficients tk and mk as claimed.
Lemma 7.3. For k âˆˆ {0, 1, . . . , n} we have g(k) Â· B + = z wÌ‡(k) Â· B + .
Proof. Consider the sequence B + , g(1) Â· B + , g(2) Â· B + , . . . , g(n) Â· B + . Then clearly
                                     si                       si                     si              si
                                B + âˆ’â†’
                                     1
                                       g(1) Â· B + âˆ’â†’
                                                   2
                                                     g(2) Â· B + âˆ’â†’
                                                                 3        n
                                                                   Â· Â· Â· âˆ’â†’ g(n) Â· B + .
It follows from Section 4.3 that g(k) Â· B + = Ï€w
                                               w
                                                (k)
                                                    (B) = z wÌ‡(k) Â· B + for k = 0, 1, . . . , n as required.         
                                                                                                  w
   We note that Lemma 7.3 gives two expressions for the intermediate Borel subgroups Bk = Ï€w       (k)
                                                                                                       (B).
Suppose that Î» is a dominant weight. Let Lk denote the line in the module V (Î») stabilised by Bk . Then,
by the above, we have Lk =< z wÌ‡(k) Â·Î¾Î» >=< g(k) Â·Î¾Î» >, where < Î· > denotes the line spanned by Î· âˆˆ V (Î»).
We use this fact in the following lemma to compute minors of z in terms of minors of g(k) .
Lemma 7.4. Let Î» be a dominant weight. Then
  (1) For k âˆˆ {0, 1, . . . , n}, we have
                                                  v       Î»                  1
                                             âˆ†w(k)
                                                (k) Î»
                                                      (z) =            w Î»
                                                                                          , and
                                                                      âˆ†Î» (k) (g(k) )
    (2) For k âˆˆ {1, . . . , n}, we have
                                                                            v        Î»
                                                   v       Î»              âˆ†Î»(kâˆ’1) (g(k) )
                                                  âˆ†w(kâˆ’1)
                                                     (k) Î»
                                                             (z)      =      w   Î»
                                                                                                 .
                                                                          âˆ†Î» (k) (g(k) )
Proof. Let Lk =< z wÌ‡(k) Â· Î¾Î» >=< g(k) Â· Î¾Î» > be the line in V (Î») defined above. Since z âˆˆ U + , we have
hz wÌ‡(k) Â· Î¾Î» , wÌ‡(k) Â· Î¾Î» i = 1. Therefore
                                                                              !
                                                                1
(7.2)                                 z wÌ‡(k) Â· Î¾Î» = 
                        g(k) Â· Î¾Î» .
                                                      g(k) Â· Î¾Î» , wÌ‡(k) Â· Î¾Î»
Comparing coefficients of vÌ‡(kâˆ’1) Â· Î¾Î» on both sides, (2) immediately follows, and comparing coefficients of
vÌ‡(k) Â· Î¾Î» on both sides, we obtain
                                                                            v    Î»
                                                          v   Î»           âˆ†Î»(k) (g(k) )
                                                   âˆ†w(k)
                                                      (k) Î»
                                                            (z) =           w    Î»
                                                                                            .
                                                                          âˆ†Î» (k) (g(k) )
                                                                                                          v   Î»
However, by Proposition 5.2, g(k) âˆˆ U âˆ’ vÌ‡(k) , so hg(k) Â· Î¾Î» , vÌ‡(k) Â· Î¾Î» i = âˆ†Î»(k) (g(k) ) = 1, and (1) follows.   
   We now compute the minors of g(k) from Lemma 7.4.
Lemma 7.5. Let k âˆˆ {0, 1, . . . , n} and let Î» be a dominant weight. Then we have:
  (1)
                                  Yk                                 k
                                        hsil+1 sil+2 Â·Â·Â·sik Î»,Î±âˆ¨il i Y
                                                                       (âˆ’1)hsil+1 sil+2 Â·Â·Â·sik Î»,Î±il i .
             w(k) Î»                                                                               âˆ¨
           âˆ†Î»       (g(k) ) =          tl
                                     l=1, lâˆˆJvâ—¦                                  l=1, lâˆˆJvâˆ’
    (2) If k âˆˆ   Jvâˆ’ ,   then
                                                      v        Ï‰ik               v         Ï‰ik
                                      mk = âˆ’âˆ†Ï‰(kâˆ’1)
                                              ik                     (g(k) ) âˆ’ âˆ†si(kâˆ’1)
                                                                                    Ï‰
                                                                                   k ik
                                                                                                 (g(kâˆ’1) ).
12                                                                            R. J. MARSH AND K. RIETSCH


Proof. (1) We prove the result for g = g(n) = g1 g2 Â· Â· Â· gn . The result for arbitrary k follows since g(k) is
defined in terms of the distinguished subexpression v(k) = (v(0) , v(1) , v(2) , . . . , v(k) ) for v(k) in w(k) in the
same way that g is defined in terms of the reduced subexpression v for v in w. For l = 1, 2, . . . , n + 1, let
g (l) = gl gl+1 Â· Â· Â· gn . We note that g (l) âˆˆ B + wÌ‡(l) B + for l = 1, 2, . . . , n + 1, where w(l) = sÌ‡il sÌ‡il+1 Â· Â· Â· sÌ‡in . We
prove, by reverse induction on l, that
                                                          n              D                                    E        n             D                             E
                      (l)                                 Y                   sij+1 sij+2 Â·Â·Â·sin Î»,Î±âˆ¨
                                                                                                    i
                                                                                                                       Y                 sij+1 sij+2 Â·Â·Â·sin Î»,Î±âˆ¨
                   âˆ†Î»w Î» (g (l) )                 =                     tj                                j
                                                                                                                               (âˆ’1)                            i
                                                                                                                                                               j       .
                                                       j=l, jâˆˆJvâ—¦                                                 j=l, jâˆˆJvâˆ’


The start of the induction is clear. Suppose that the result holds for l + 1, i.e. for g (l+1) = gl+1 Â· Â· Â· gn , and
consider g (l) = gl gl+1 Â· Â· Â· gn . Since g (l+1) âˆˆ B + wÌ‡(l+1) B + , g (l+1) Â· Î¾Î» is a linear combination of elements of
V (Î») of weight Âµ â‰¥ w(l+1) Î».
   Case (I). Suppose that l âˆˆ Jvâ—¦ , so that gl = yil (tl ). Then, using that w(l+1) Î» and w(l) Î» are extremal
weights, and w(l) Î» = sil w(l+1) Î» â‰¤ w(l+1) Î» we have
                                       (l)                                    (l)
                               âˆ†Î»w           Î»
                                                 (g (l) ) =        âˆ†w Î» (yil (tl )g (l+1) )
                                                                   DÎ»                                   E
                                                            =        yil (tl )g (l+1) Â· Î¾Î» , wÌ‡(l) Â· Î¾Î»
                                                                   D                                    ED                         E
                                                            =        yil (tl )wÌ‡(l+1) Â· Î¾Î» , wÌ‡(l) Â· Î¾Î» g (l+1) Â· Î¾Î» , wÌ‡(l+1) Â· Î¾Î» .

By equation (2.1),
                 (l)
                                                   D                                                                                     ED                                E
           âˆ†Î»w         Î»
                           (g (l) )        =           xil (tâˆ’1  âˆ¨ âˆ’1               âˆ’1
                                                             l )Î±il (tl )sÌ‡il xil (tl )wÌ‡
                                                                                          (l+1)
                                                                                                Â· Î¾Î» , wÌ‡(l) Â· Î¾Î»                             g (l+1) Â· Î¾Î» , wÌ‡(l+1) Î¾Î»
                                              hsi Â·Â·Â·sin Î»,Î±âˆ¨il i w(l+1) Î» (l+1)
                                           = tl l+1              âˆ†Î»       (g     ).

     Case (II). Suppose that l âˆˆ Jv+ , so that gl = sÌ‡il . Then
                                                                  (l)                               (l)
                                                            âˆ†Î»w         Î»
                                                                            (g (l) ) =          âˆ†w Î» (sÌ‡il g (l+1) )
                                                                                                DÎ»                             E
                                                                                           =     sÌ‡il g (l+1) Â· Î¾Î» , wÌ‡(l) Â· Î¾Î» .

It is thus clear that
                                                                                (l)                       (l+1)
                                                                        âˆ†Î»w           Î»
                                                                                          (g (l) ) = âˆ†w
                                                                                                      Î»
                                                                                                                   Î»
                                                                                                                       (g (l+1) ).

   Case (III). Suppose that l âˆˆ Jvâˆ’ , so that gl = xil (ml )sÌ‡âˆ’1
                                                              il . Then, using the fact that that w
                                                                                                    (l+1)
                                                                                                          Î»â‰¥
 (l)         (l+1)
w Î» = sil w        Î» are extremal weights, we have:
                                 (l)                                    (l)
                           âˆ†Î»w         Î»
                                           (g (l) ) =           âˆ†Î»w Î» (xil (ml )sÌ‡âˆ’1 il g
                                                                                           (l+1)
                                                                                                  )
                                                                D                                            E
                                                        =        xil (ml )sÌ‡âˆ’1
                                                                            il  g (l+1)
                                                                                         Â· Î¾ Î» , wÌ‡ (l)
                                                                                                        Â· Î¾Î»
                                                                D                                            ED                         E
                                                                            âˆ’1 (l+1)
                                                        =        xil (ml )sÌ‡il wÌ‡         Â· Î¾Î» , wÌ‡(l) Â· Î¾Î» g (l+1) Â· Î¾Î» , wÌ‡(l+1) Â· Î¾Î»
                                                                D                                 ED                           E
                                                        =        sÌ‡âˆ’1
                                                                   il wÌ‡
                                                                         (l+1)
                                                                               Â· Î¾Î» , wÌ‡(l) Â· Î¾Î» g (l+1) Â· Î¾Î» , wÌ‡(l+1) Â· Î¾Î»

                                                                (âˆ’1)hsil+1 Â·Â·Â·sin Î»,Î±il i âˆ†w
                                                                                     âˆ¨       (l+1)
                                                                                                   Î»
                                                        =                                  Î»         (g(l+1) ).

The last equality follows from the fact that sÌ‡âˆ’1    âˆ¨
                                               il = Î±il (âˆ’1)sÌ‡il .
  The result for l now follows (in each case) from the inductive hypothesis and we are done.
                                                  PARAMETRIZATIONS OF FLAG VARIETIES                                           13


   (2) We have:
             v        Ï‰ik
                                               D                             E
          âˆ†Ï‰(kâˆ’1)
            ik              (g(k) ) =           g(k) Â· Î¾Ï‰ik , vÌ‡(kâˆ’1) Â· Î¾Ï‰ik
                                               D                                               E
                                       =        g(kâˆ’1) xik (mk )sÌ‡âˆ’1ik Â· Î¾Ï‰ik , vÌ‡(kâˆ’1) Â· Î¾Ï‰ik
                                                 D                                    E         D                       E
                                       =       âˆ’ g(kâˆ’1) sÌ‡ik Â· Î¾Ï‰ik , vÌ‡(kâˆ’1) Â· Î¾Ï‰ik âˆ’ mk g(kâˆ’1) Â· Î¾Ï‰ik , vÌ‡(kâˆ’1) Â· Î¾Ï‰ik ,
                                                   v      Ï‰ik
                                       =       âˆ’âˆ†si(kâˆ’1)
                                                     Ï‰
                                                    k ik
                                                                (g(kâˆ’1) ) âˆ’ mk ,
                                           âˆ’
noting that, since g(kâˆ’1) âˆˆ U vÌ‡(kâˆ’1) , we have that hg(kâˆ’1) Â· Î¾Ï‰ik , vÌ‡(kâˆ’1) Â· Î¾Ï‰ik i = 1. The result follows. 
Remarks 7.6. (1) Let tk = âˆ’1 for k âˆˆ Jvâˆ’ and let tk = 1 for k âˆˆ Jv+ (so that now tk is defined for
k = 1, 2, . . . , n). Then the formula in Lemma 7.5(1) can be rewritten as:
                                                                      k
                                                                      Y
                                                   w Î»                   hsi si Â·Â·Â·si Î»,Î±âˆ¨il i
                                                  âˆ†Î» (k) (g(k) )    =   tl l+1 l+2 k           .
                                                                          l=1
  (2) The following lemma gives an expression for mk which is simpler than the Chamber Ansatz version,
Theorem 7.1(2). However, the Chamber Ansatz formula for the mk will be more useful in Section 8.
Lemma 7.7. For k âˆˆ Jvâˆ’ , we have:
                                                             v       Ï‰i
                                                           âˆ†w(kâˆ’1)
                                                              (k) Ï‰ik
                                                                      k
                                                                        (z)          v       Ï‰ik
                                                mk = âˆ’      v Ï‰ik               âˆ’ âˆ†si(kâˆ’1)
                                                                                       Ï‰
                                                                                      k ik
                                                                                                   (g(kâˆ’1) ).
                                                           âˆ†w(k)
                                                              (k) Ï‰ik
                                                                      (z)
Proof. This follows immediately from Lemma 7.4 and Lemma 7.5(2).                                                               
Proof of Theorem 7.1. We can now prove Theorem 7.1 by using Lemmas 7.4 and 7.5 and Remark 7.6(1)
to substitute for the minors appearing in the expressions on the right hand sides of Theorem 7.1(1) and
(2). We first claim that, for k = 1, 2, . . . , n, we have:
                                                   Q        v(k) Ï‰j    âˆ’aj,ik
                                                     j6=ik âˆ†w(k) Ï‰j (z)
(7.3)                                   tk = v(k) Ï‰ik            v(kâˆ’1) Ï‰ik   .
                                                 âˆ†w(k) Ï‰ik (z)âˆ†w(kâˆ’1) Ï‰ik (z)
  (See [2, 4.3] for a similar proof of this statement in the special case where Jv+ = âˆ…). We have, using
Lemma 7.4(1) and Remark 7.6(1):
             Q         v(k) Ï‰j    âˆ’aj,ik
                                                       Q        Qk aj,ik hsil+1 Â·Â·Â·sik Ï‰j ,Î±âˆ¨il i
                j6=ik âˆ†w(k) Ï‰j (z)                       j6=ik     l=1 tl
              v(k) Ï‰ik      v(kâˆ’1) Ï‰ik   =         D                      E         D                       E.
            âˆ†w(k) Ï‰ik (z)âˆ†w(kâˆ’1) Ï‰ik (z)   Qk    âˆ’   sil+1 Â·Â·Â·s        âˆ¨
                                                               ik ik ,Î±i
                                                                 Ï‰          Qkâˆ’1 âˆ’ sil+1 Â·Â·Â·sikâˆ’1 Ï‰ik ,Î±âˆ¨il
                                            l=1 tl                           l=1 tl
                                                                        l


The exponent of tk is given by
                                                                                      *                                    +
                               X            
         
                                 X
                                       aj,ik Ï‰j , Î±âˆ¨           âˆ¨
                                                   ik + Ï‰ik , Î±ik   =                             aj,ik Ï‰j +   Ï‰ik , Î±âˆ¨
                                                                                                                      ik
                               j6=ik                                                      j6=ik
                                                                                      
               
                                                                                 =     Î±ik âˆ’ Ï‰ik , Î±âˆ¨
                                                                                                    ik = 1.
If k < k â€² , the exponent of tkâ€² is clearly zero. If k â€² < k, then the exponent of tkâ€² is given by
            ï£«                                          ï£¶
               X        D                            E    D                          E D                                 E
            ï£­      aj,ik sikâ€² +1 Â· Â· Â· sik Ï‰j , Î±âˆ¨
                                                 ikâ€²
                                                       ï£¸ + si â€² Â· Â· Â· sik Ï‰ik , Î±âˆ¨
                                                             k +1                ikâ€²
                                                                                      + s i â€²
                                                                                           k +1
                                                                                                Â· Â· Â· s ikâˆ’1
                                                                                                             Ï‰ ik
                                                                                                                  , Î±âˆ¨
                                                                                                                     ikâ€²
              j6=ik

                                           *                     ï£«ï£«                   ï£¶                    ï£¶           +
                                                                      X
                                   =           sikâ€² +1 Â· Â· Â· sik ï£­ï£­           aj,ik Ï‰j ï£¸ + 2Ï‰ik âˆ’       Î±ik ï£¸ , Î±âˆ¨
                                                                                                                 ikâ€²
                                                                      j6=ik
                                           D                                          E
                                   =           sikâ€² +1 Â· Â· Â· sik (Î±ik âˆ’ Î±ik ), Î±âˆ¨
                                                                                ikâ€²       = 0,
14                                                 R. J. MARSH AND K. RIETSCH


and the claim (7.3) is proved; Theorem 7.1(1) is a special case.
  We now prove Theorem 7.1(2). Suppose that k âˆˆ Jvâˆ’ . Using Lemma 7.4 and (7.3) (noting that tk = âˆ’1),
we see that
                     v     Ï‰i         v      Ï‰i                               v         Ï‰ik               v     Ï‰i
                   âˆ†w(kâˆ’1)
                      (k) Ï‰i
                             k
                               (z)âˆ†w(kâˆ’1)
                                      (kâˆ’1) Ï‰ik (z)
                                             k
                                                                          âˆ†Ï‰(kâˆ’1)
                                                                            ik       (g(k) )âˆ†w(kâˆ’1)
                                                                                               (kâˆ’1) Ï‰ik (z)
                                                                                                       k

                    Q k v(k) Ï‰j          âˆ’aj,ik
                                                               =     w(k) Ï‰ik        Q         v(k) Ï‰j
                       j6=ik âˆ†w(k) Ï‰j (z)                           âˆ†Ï‰ik      (g(k) ) j6=ik âˆ†w(k) Ï‰j (z)âˆ’aj,ik
                                                                      v           Ï‰ik              v     Ï‰i          v   Ï‰i
                                                                    âˆ†Ï‰(kâˆ’1)
                                                                      ik               (g(k) )âˆ†w(k)   k
                                                                                                 (k) Ï‰ik
                                                                                                         (z)âˆ†w(kâˆ’1)    k
                                                                                                                (kâˆ’1) Ï‰ik
                                                                                                                          (z)
                                                               =                      Q        v(k) Ï‰j     âˆ’aj,ik
                                                                                        j6=ik âˆ†w(k) Ï‰j (z)
                                                                          v           Ï‰ik
                                                               = âˆ’âˆ†Ï‰(kâˆ’1)
                                                                    ik                      (g(k) ).
Theorem 7.1(2) now follows from Lemma 7.5(2), and the proof of Theorem 7.1 is complete.                                             

                                              8. A change of coordinates
   We can gain some more insight into the structure of the formulas from Theorem 7.1 if we consider the
standard and special chamber minors as providing an alternative system of coordinates on Rv,w .
Proposition 8.1. Let v â‰º w. With notation as above the map
                                                               â—¦              âˆ’
                                    Rv,w âˆ’â†’ (Kâˆ— )Jv Ã— (K)Jv
                                              v Ï‰                      v(jâˆ’1) Ï‰i
                                                                                             
                                                 (j) i
                                z wÌ‡ Â· B + 7â†’ (âˆ†w(j) Ï‰ijj (z))jâˆˆJvâ—¦ , (âˆ†w(j) Ï‰ij j (z))jâˆˆJvâˆ’

is an isomorphism.
     For the special case v = (1, . . . , 1) see also Theorem 4.3 and Corollary 4.4 in [2].

Proof. Let w(k) = (w(0) , . . . , w(k) ) be the reduced expression for w(k) obtained from w by truncation,
and v(k) the corresponding truncation of v. The proof of the proposition is by induction on k and using
Theorem 7.1. The start of the induction is trivial, so let us assume the proposition is true for Rv(kâˆ’1) ,w(kâˆ’1) .
We have three cases for k.
      (1) If k âˆˆ Jvâ—¦ , then as in the proof of Proposition 5.2 we have
                                               âˆ¼
                  Rv(kâˆ’1) ,w(kâˆ’1) Ã— Kâˆ—        âˆ’â†’ Rv(k) ,w(k) ,
                  (g(kâˆ’1) Â· B + , tk )        7â†’ g(kâˆ’1) yik (tk ) Â· B + ,                              g(kâˆ’1) âˆˆ Gv(kâˆ’1) ,w(kâˆ’1) .
          Compose this map with
                                     Rv(k) ,w(k)              Rv(kâˆ’1) ,w(kâˆ’1) Ã— Kâˆ— ,
                                                           âˆ’â†’                                  
(8.1)                                              +                               v Ï‰ik
                                     z wÌ‡(k) Â· B           7â†’   z wÌ‡(kâˆ’1) Â· B + , âˆ†w(k)
                                                                                     (k) Ï‰ik
                                                                                             (z)

          to get a map Ïˆk : Rv(kâˆ’1) ,w(kâˆ’1) Ã— Kâˆ— â†’ Rv(kâˆ’1) ,w(kâˆ’1) Ã— Kâˆ— . The Chamber Ansatz says that tk
          can be recovered from z wÌ‡(k) Â· B + by
                                                            v Ï‰ik
(8.2)                               tk = ak z wÌ‡(kâˆ’1) Â· B + âˆ†w(k)
                                                               (k) Ï‰ik
                                                                       (z)âˆ’1 ,
          where
                                          Q                v   Ï‰j   âˆ’aj,ik
                                 +            j6=ik    âˆ†w(k)
                                                          (k) Ï‰j (z)
                ak (z wÌ‡(kâˆ’1) Â· B ) :=                 v       Ï‰i                 ,           z wÌ‡(kâˆ’1) Â· B + âˆˆ Rv(kâˆ’1) ,w(kâˆ’1) .
                                                   âˆ†w(kâˆ’1)
                                                      (kâˆ’1) Ï‰ik (z)
                                                             k



          Note that this gives a well-defined map ak : Rv(kâˆ’1) ,w(kâˆ’1) â†’ Kâˆ— , since ak is made up of standard
          chamber minors for (v(kâˆ’1) , w(kâˆ’1) ). Now the formula (8.2) gives rise to an inverse to Ïˆk . Hence
          also (8.1) is an isomorphism, and the proposition holds for Rv(k) ,w(k) by the induction hypothesis.
                                     PARAMETRIZATIONS OF FLAG VARIETIES                                           15


    (2) Suppose k âˆˆ Jvâˆ’ . Then we have an isomorphism
                                       âˆ¼
              Rv(kâˆ’1) ,w(kâˆ’1) Ã— K âˆ’â†’ Rv(k) ,w(k) ,
              (g(kâˆ’1) Â· B + , mk ) 7â†’ g(kâˆ’1) xik (mk )sÌ‡âˆ’1    +
                                                        ik Â· B ,                g(kâˆ’1) âˆˆ Gv(kâˆ’1) ,w(kâˆ’1) ,
        which we can compose with
                                Rv(k) ,w(k)      âˆ’â†’ Rv(kâˆ’1) ,w(kâˆ’1) Ã— K,               
(8.3)                                                                    v       Ï‰ik
                                z wÌ‡(k) Â· B +     7â†’  z wÌ‡(kâˆ’1) Â· B + , âˆ†w(kâˆ’1)
                                                                           (k) Ï‰ik
                                                                                     (z)

        to get a map Ïˆk : Rv(kâˆ’1) ,w(kâˆ’1) Ã— K â†’ Rv(kâˆ’1) ,w(kâˆ’1) Ã— K. By Theorem 7.1 one can recover the
        mk coordinate from z wÌ‡(k) Â· B + by
                                               v       Ï‰ik                         
(8.4)                  mk = ak z wÌ‡(kâˆ’1) Â· B + âˆ†w(kâˆ’1)
                                                  (k) Ï‰ik   (z) âˆ’ bk z wÌ‡(kâˆ’1) Â· B + ,
        where ak : Rv(kâˆ’1) ,w(kâˆ’1) â†’ Kâˆ— and bk : Rv(kâˆ’1) ,w(kâˆ’1) â†’ K are given by
                                              v(kâˆ’1) Ï‰i
                                            âˆ†w(kâˆ’1) Ï‰ik (z)
          ak (z wÌ‡(kâˆ’1) Â· B + ) =    Q           v(k) Ï‰j
                                                         k
                                                            âˆ’aj,i    ,      z wÌ‡(kâˆ’1) Â· B + âˆˆ Rv(kâˆ’1) ,w(kâˆ’1) ,
                                         j6=ik âˆ†w(k) Ï‰j (z)
                                                                 k
                                         v(kâˆ’1) Ï‰ik
          bk (g(kâˆ’1) Â· B + )    =    âˆ†   sik Ï‰ik    (g  (kâˆ’1) ),            g(kâˆ’1) âˆˆ Gv(kâˆ’1) ,w(kâˆ’1) .
        Now the identity (8.4) gives an inverse to the map Ïˆk . So (8.3) is an isomorphism and the
        proposition holds for Rv(k) ,w(k) .
    (3) If k âˆˆ Jv+ then Rv(k) ,w(k) âˆ¼
                                    = Rv(kâˆ’1) ,w(kâˆ’1) and we are done.
                                                                                                                  

Remark 8.2. Assuming Proposition 8.1, much of the structure of Theorem 7.1 is already determined. The
                                            v(j) Ï‰i                              v(jâˆ’1) Ï‰i
proposition says that we may take the (âˆ†w(j) Ï‰ijj (z))jâˆˆJvâ—¦ in Kâˆ— , and the (âˆ†w(j) Ï‰ij j (z))jâˆˆJvâˆ’ in K together
as coordinates for Rv,w . And then Theorem 7.1 can be interpreted roughly as the transition from these
coordinates to the coordinates (tj )jâˆˆJvâ—¦ and (mj )jâˆˆJvâˆ’ from the factorization. Â¿From the outset these two
sets of coordinates have to be quite closely related, since they are both compatible with reduction. In
                          w
either setting the map Ï€w  (k)
                               : Rv,w â†’ Rv(k) ,w(k) corresponds to the projection onto the first k coordinates.
   Let us consider explicitly an element g Â· B + = z wÌ‡ Â· B + with fixed reduction g(k) Â· B + = z wÌ‡(k) Â· B + . Then
                                                                                    v(j) Ï‰i            v(jâˆ’1) Ï‰i
this is equivalent to fixing coordinates tj and mj , or to fixing the minors âˆ†w(j) Ï‰ijj (z) and âˆ†w(j) Ï‰ij j (z),
                                                                                       v(k+1) Ï‰i
where j â‰¤ k in Jvâ—¦ or Jvâˆ’ . If k + 1 âˆˆ Jvâ—¦ then the change of coordinate from âˆ†w(k+1) Ï‰ik+1
                                                                                        k+1
                                                                                            (z) to tk+1 amounts
to an invertible map Kâˆ— â†’ Kâˆ— , which depends only on the earlier coordinates. So it has to be of the form
z 7â†’ az Â±1 for some a âˆˆ Kâˆ— . The Chamber Ansatz simply says the map is of the form z 7â†’ az âˆ’1 and
describes the coefficient a explicitly in terms of earlier chamber minors of z.
                                                        v(k) Ï‰i
   If k âˆˆ Jvâˆ’ then the change of the coordinate âˆ†w(k+1)k+1      Ï‰ik+1 (z) to mk+1 amounts to an invertible map
K â†’ K, which depends only on the earlier coordinates. Therefore this map must be of the form z 7â†’ az + b
for a âˆˆ Kâˆ— and b âˆˆ K. Here again a is computed by the Chamber Ansatz, and b is the correction term in
Theorem 7.1.

                               9. The generalized Chamber Ansatz for SLd
   Suppose we are given B = z wÌ‡ Â· B + , with z âˆˆ U + , with fixed reduced expression w for w. We can
use Proposition 6.4 to determine which Deodhar component Rv,w contains B, where v is a distinguished
subexpression for v in w. We shall give an explicit example in Section 10 of how to do this. Then B = gÂ·B + ,
where g = g1 g2 Â· Â· Â· gn , and
                                            ï£±
                                            ï£² yik (tk )      k âˆˆ Jvâ—¦ ,
                                      gk =     sÌ‡ i          k âˆˆ Jv+ ,
                                            ï£³ k           âˆ’1
                                               xik (mk )sÌ‡ik k âˆˆ Jvâˆ’ .
16                                                                                                                                                             R. J. MARSH AND K. RIETSCH


The generalized Chamber Ansatz (Theorem 7.1) gives formulas for the tk and mk in terms of minors of z
                 v      Ï‰ik
(and the minor âˆ†si(kâˆ’1)
                    Ï‰
                   k ik
                            (g(kâˆ’1) ) of g(kâˆ’1) ). We write Theorem 7.1(2) in the form
                                                                                                                                                                                                                                v                            Ï‰ik
                                                                                                                                                        mk = rk âˆ’ âˆ†si(kâˆ’1)
                                                                                                                                                                       Ï‰
                                                                                                                                                                      k ik
                                                                                                                                                                                                                                                                              (g(kâˆ’1) ),
where                                                                                                                                                                                   v                            Ï‰i                                         v                            Ï‰i
                                                                                                                                                                              âˆ†w(kâˆ’1)
                                                                                                                                                                                 (k) Ï‰i
                                                                                                                                                                                        k
                                                                                                                                                                                          (z)âˆ†w(kâˆ’1)    k
                                                                                                                                                                                                 (kâˆ’1) Ï‰ik
                                                                                                                                                                                                           (z)
                                                                                                                                               rk =                            Q k v(k) Ï‰j          âˆ’aj,ik
                                                                                                                                                                                                               .
                                                                                                                                                                                  j6=ik âˆ†w(k) Ï‰j (z)
                                             v       Ï‰ik
This is the term ak z wÌ‡(kâˆ’1) Â· B + âˆ†w(kâˆ’1)     (k) Ï‰ik
                                                          (z) in equation (8.4). In this section, we give a graphical
algorithm (generalizing that of [3]) for determining the coefficients tk and rk , in the case where G = SLd .
                                                                                        v     Ï‰ik
The coefficients mk can then be computed by computing the minors âˆ†si(kâˆ’1)                  Ï‰
                                                                                          k ik
                                                                                                  (g(kâˆ’1) ) inductively, noting
that g(kâˆ’1) depends only on the coefficients tj and mj for j â‰¤ k âˆ’ 1 (an example of this will be given in
section 10.2).
   We employ a generalised version of the pseudoline arrangements used in [3], in which two pseudolines
can either intersect, as in [3], or pass over or under each other (see below for examples). These can also be
regarded as diagrams of singular braids [1, 4].
   The main idea is to associate such an arrangement (which we call the ansatz arrangement) to the pair
v, w. For example, if w = (1, s3 , s3 s2 , s3 s2 s1 , s3 s2 s1 s3 , s3 s2 s1 s3 s2 ), and v is the distinguished subexpres-
sion (1, s3 , s3 , s3 , 1, s2 ) for s2 in w, then the arrangement is as in Figure 1.


                                                                                                          4         ............... ....................................................................................................... ............................ ...................................................
                                                                                                                                  ... ...
                                                                                                                                     ... ..
                                                                                                                                                                                                                                          ... ...
                                                                                                                                                                                                                                             ......
                                                                                                                                                                                                                                                                                ... ...
                                                                                                                                                                                                                                                                                  . ...
                                                                                                                                       ...
                                                                                                                                         .
                                                                                                                                   ... ....
                                                                                                                                                                                                                                              ......
                                                                                                                                                                                                                                           ... .....
                                                                                                                                                                                                                                                       â€¢                          ....
                                                                                                                                                                                                                                                                                ... ....
                                                                                                                                  .                                                                                                       .                                    .
                                                                                                                    .............. ............................. ................................................................. ........................... ............................. .............
                                                                                                          3                                                             ... ...
                                                                                                                                                                           ......
                                                                                                                                                                                                                                                                                                                     ... ...
                                                                                                                                                                                                                                                                                                                       ... ..
                                                                                                                                                                         .
                                                                                                                                                                           â€¢   .
                                                                                                                                                                            .....
                                                                                                                                                                          .. ....
                                                                                                                                                                                                                                                                                                                         .
                                                                                                                                                                                                                                                                                                                       ....
                                                                                                                                                                                                                                                                                                                      .. ....
                                                                                                                                                                        .         .                                                                                                                                 .
                                                                                                                    .................................................... ............................. ....................................................................................................... ..............
                                                                                                          2                                                                                                  ... ...
                                                                                                                                                                                                               .....
                                                                                                                                                                                                                 â€¢
                                                                                                                                                                                                                 ..
                                                                                                                                                                                                               .......
                                                                                                                                                                                                            ... ...
                                                                                                                    ......................................................................................... ..............................................................................................................................
                                                                                                          1

  Figure 1. Ansatz arrangement (unlabeled) for s3 s2 s1 s3 s2 . Note that g = sÌ‡3 y2 (t2 )y1 (t3 )x3 (m4 )sÌ‡âˆ’1
                                                                                                            3 sÌ‡2 .


   The pair v, w determines the factors gk of g, which in turn determine the ansatz arrangement in the
following way. It consists of d pseudolines, numbered 1, 2, . . . , d, from bottom to top on the left hand
side of the arrangement. Each factor xik (mk ), yik (tk ), sÌ‡ik or sÌ‡âˆ’1
                                                                     ik of g gives rise to a constituent of the
arrangement, in which pseudolines at level ik from the bottom of the arrangement are either braided or
cross at singular point. Note that xik (mk ) and sÌ‡âˆ’1
                                                   ik are treated as separate factors. The rules for how this
is done are given in Figure 2.
                                                                                                               ....                                                                                     ....                                                                                     ....                                                                                      ....
                                                                                                                  ...                                                                                      ...                                                                                      ...                                                                                       ...                                               âˆ’1
                               Factor of g                                                                          ..
                                                                                                                     ...              x (m )               i  k                    k                         ...
                                                                                                                                                                                                               .
                                                                                                                                                                                                               .                  y (t )          i  k             k                                  ...
                                                                                                                                                                                                                                                                                                        .
                                                                                                                                                                                                                                                                                                        .
                                                                                                                                                                                                                                                                                                                                     sÌ‡              i  k
                                                                                                                                                                                                                                                                                                                                                                                                ...
                                                                                                                                                                                                                                                                                                                                                                                                  ...                      sÌ‡                   ik
                                                                                                                       .
                                                                                                                       .                                                                                       ..                                                                                       ..                                                                                          .
                ...................................................................................................................................................................................................................................................................................................................................................................................................................................................................
                                                                                                                                                                                                                .                                                                                        .
                                                                                                                       ....                                                                                     ....                                                                                     ....                                                                                       ....
                                                                                                                          ...                                                                                      ...                                                                                      ...                                                                                        ...
                                                                                                                            ...                                                                                      ...                                                                                      ...                                                                                        ...
                                                                                                                              ...                                                                                      ...                                                                                      ...                                                                                        ...
                     Constituent of                                                                                             ...
                                                                                                                                  ...
                                                                                                                                                      ............... ..............
                                                                                                                                                                    ... ...
                                                                                                                                                                      .....
                                                                                                                                                                                                                         ...
                                                                                                                                                                                                                           ...
                                                                                                                                                                                                                                          ............... ..............
                                                                                                                                                                                                                                                        ... ...
                                                                                                                                                                                                                                                          .....
                                                                                                                                                                                                                                                                                                                  ...
                                                                                                                                                                                                                                                                                                                    ...
                                                                                                                                                                                                                                                                                                                                   ............... ..............
                                                                                                                                                                                                                                                                                                                                                 ... ...
                                                                                                                                                                                                                                                                                                                                                   ... .
                                                                                                                                                                                                                                                                                                                                                                                                             ...
                                                                                                                                                                                                                                                                                                                                                                                                               ...
                                                                                                                                                                                                                                                                                                                                                                                                                                ............... ..............
                                                                                                                                                                                                                                                                                                                                                                                                                                              ... ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                . ..
                         ansatz                                                                                                     ...
                                                                                                                                      ...
                                                                                                                                                         â€¢            .
                                                                                                                                                                      .
                                                                                                                                                                        ...
                                                                                                                                                                       . ...
                                                                                                                                                                    .. ....
                                                                                                                                                                                                                             .
                                                                                                                                                                                                                             .
                                                                                                                                                                                                                             .
                                                                                                                                                                                                                             .
                                                                                                                                                                                                                             .
                                                                                                                                                                                                                             .
                                                                                                                                                                                                                                                 â€¢        .
                                                                                                                                                                                                                                                          .
                                                                                                                                                                                                                                                            ...
                                                                                                                                                                                                                                                           . ...
                                                                                                                                                                                                                                                        .. ....
                                                                                                                                                                                                                                                                                                                      .
                                                                                                                                                                                                                                                                                                                      .
                                                                                                                                                                                                                                                                                                                      .
                                                                                                                                                                                                                                                                                                                      .
                                                                                                                                                                                                                                                                                                                      .
                                                                                                                                                                                                                                                                                                                      .
                                                                                                                                                                                                                                                                                                                                                   .
                                                                                                                                                                                                                                                                                                                                                   .
                                                                                                                                                                                                                                                                                                                                                     ....
                                                                                                                                                                                                                                                                                                                                                 .. ....
                                                                                                                                                                                                                                                                                                                                                        .
                                                                                                                                                                                                                                                                                                                                                                                                                 ...
                                                                                                                                                                                                                                                                                                                                                                                                                   .
                                                                                                                                                                                                                                                                                                                                                                                                                   .
                                                                                                                                                                                                                                                                                                                                                                                                                   .
                                                                                                                                                                                                                                                                                                                                                                                                                                                 ..
                                                                                                                                                                                                                                                                                                                                                                                                                                                .. ..
                                                                                                                                                                                                                                                                                                                                                                                                                                              ... ....
                                                                                                                                        ...                         .                                                        .                          .                                                             .                          .                                                                 .                          .
                      arrangement                                                                                                         ...
                                                                                                                                            ...
                                                                                                                                                      ..............         .............                                   .
                                                                                                                                                                                                                             ....
                                                                                                                                                                                                                                ...
                                                                                                                                                                                                                                          ..............         .............                                        .
                                                                                                                                                                                                                                                                                                                      ....
                                                                                                                                                                                                                                                                                                                         ...
                                                                                                                                                                                                                                                                                                                                   ..............         .............                                            .
                                                                                                                                                                                                                                                                                                                                                                                                                   ....
                                                                                                                                                                                                                                                                                                                                                                                                                      ...
                                                                                                                                                                                                                                                                                                                                                                                                                                ..............        .............

                                                                                                                                              ...                                                                                 ...                                                                                      ...                                                                                          ...
                                                                                                                                                ...                                                                                 ...                                                                                      ...                                                                                          ...
                                                                                                                                                  ...                                                                                 ...                                                                                      ...                                                                                          ...



                                                                                          Figure 2. Constituents of the ansatz arrangement.

   As usual, we define a chamber of a generalised pseudoline arrangement to be a component of the
complement of the union of the pseudolines in the arrangement (for this definition we interpret the under-
and over-crossings as singular points). In order to label the chambers, we need two auxilliary pseudoline
arrangements associated to the pair v, w, which we call the upper and lower arrangements (since, as will be
seen, they will determine upper and lower subscripts of chamber minors). These arrangements are defined
                                                                                                                                           PARAMETRIZATIONS OF FLAG VARIETIES                                                                                                                                                                                                                                                                                                                                               17


in the same way as the ansatz arrangement, except that different rules for the factors of g are employed.
These are described in Figure 3, and the upper and lower arrangements for the example above are given
in Figures 4 and 5. The chambers for these arrangements are labeled with the labels of the strings passing
below them.
                                                                                                          ...                                                                                                        ...                                                                                                ...                                                                                        ...
                                                                                                            ...                                                                                                        ...                                                                                                ...                                                                                        ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   âˆ’1
                            Factor of g                                                                       ..
                                                                                                               ...                           x (m )                                ik                       k
                                                                                                                                                                                                                         ...
                                                                                                                                                                                                                           .
                                                                                                                                                                                                                           .                     y (t )                                  ik k
                                                                                                                                                                                                                                                                                                                            ...
                                                                                                                                                                                                                                                                                                                              .
                                                                                                                                                                                                                                                                                                                              .                              sÌ‡                                       i  k
                                                                                                                                                                                                                                                                                                                                                                                                                       ...
                                                                                                                                                                                                                                                                                                                                                                                                                         ...                                sÌ‡                                     ik
                                                                                                                 ...                                                                                                       ....                                                                                               ....                                                                                         ..
            ...............................................................................................................................................................................................................................................................................................................................................................................................................................................................
                                                                                                                   ....                                                                                                       ....                                                                                               ....                                                                                       ....
                                                                                                                      ...                                                                                                        ...                                                                                                ...                                                                                        ...
                                                                                                                        ...                                                                                                        ...                                                                                                ...                                                                                        ...
                                                                                                                          ...                                                                                                        ...                                                                                                ...                                                                                        ...
                  Constituent of                                                                                            ...
                                                                                                                              ...
                                                                                                                                                                              ......................................                   ...
                                                                                                                                                                                                                                         ...
                                                                                                                                                                                                                                                                                 ......................................                   ...
                                                                                                                                                                                                                                                                                                                                            ...
                                                                                                                                                                                                                                                                                                                                                                                    ............... ..............
                                                                                                                                                                                                                                                                                                                                                                                                  ... ...
                                                                                                                                                                                                                                                                                                                                                                                                    ... .
                                                                                                                                                                                                                                                                                                                                                                                                                                     ...
                                                                                                                                                                                                                                                                                                                                                                                                                                       ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ............... ..............
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ... ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   . ..
                      upper                                                                                                     ...
                                                                                                                                  ...
                                                                                                                                                                                                                                           ...
                                                                                                                                                                                                                                             ...
                                                                                                                                                                                                                                                                                                                                              ...
                                                                                                                                                                                                                                                                                                                                                ...                                                 .
                                                                                                                                                                                                                                                                                                                                                                                                      ...
                                                                                                                                                                                                                                                                                                                                                                                                         .
                                                                                                                                                                                                                                                                                                                                                                                                                                         ...
                                                                                                                                                                                                                                                                                                                                                                                                                                           .
                                                                                                                                                                                                                                                                                                                                                                                                                                           .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ....
                                                                                                                                    ...                                                                                                        .
                                                                                                                                                                                                                                               .                                                                                                  .
                                                                                                                                                                                                                                                                                                                                                  .                                               ... .....                                ..
                                                                                                                                                                                                                                                                                                                                                                                                                                            .                                                    ... ....
                   arrangement                                                                                                        ...
                                                                                                                                        ...
                                                                                                                                                                              ......................................                           ....
                                                                                                                                                                                                                                                  ...
                                                                                                                                                                                                                                                                                 ......................................                           ....
                                                                                                                                                                                                                                                                                                                                                     ...
                                                                                                                                                                                                                                                                                                                                                                                    .............. .............                            ....
                                                                                                                                                                                                                                                                                                                                                                                                                                               ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   .............. ..............
                                                                                                                                          ...                                                                                                       ...                                                                                                ...                                                                                       ...
                                                                                                                                            ...                                                                                                       ...                                                                                                ...                                                                                       ...
                                                                                                                                              ..                                                                                                        ..                                                                                                 ..                                                                                        .
            ................................................................................................................................................................................................................................................................................................................................................................................................................................................................
                                                                                                                                               .                                                                                                         .                                                                                                  .
                                                                                                                                               ....                                                                                                      ....                                                                                               ....                                                                                     ....
                                                                                                                                                  ...                                                                                                       ...                                                                                                ...                                                                                      ...
                                                                                                                                                    ...                                                                                                       ...                                                                                                ...                                                                                      ...
                                                                                                                                                      ...                                                                                                       .
                                                                                                                                                                                                                                                                .                                                                                                  .
                                                                                                                                                                                                                                                                                                                                                                   .                                                                                        ...
                       Constituent                                                                                                                      ...
                                                                                                                                                          ...
                                                                                                                                                                              ............... ..............
                                                                                                                                                                                            ... ..
                                                                                                                                                                                              .....  .
                                                                                                                                                                                                                                                                ..
                                                                                                                                                                                                                                                                 .
                                                                                                                                                                                                                                                                 .
                                                                                                                                                                                                                                                                 .
                                                                                                                                                                                                                                                                 .
                                                                                                                                                                                                                                                                 .
                                                                                                                                                                                                                                                                                 ............... ..............
                                                                                                                                                                                                                                                                                               ... ..
                                                                                                                                                                                                                                                                                                 ..... .
                                                                                                                                                                                                                                                                                                                                                                   ..
                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                                                                                                                                                                                                                                    ............... ..............
                                                                                                                                                                                                                                                                                                                                                                                                  ... ..
                                                                                                                                                                                                                                                                                                                                                                                                    ... ..
                                                                                                                                                                                                                                                                                                                                                                                                                                                              ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ......................................

                           lower                                                                                                                            ...
                                                                                                                                                              ...â€¢                            .
                                                                                                                                                                                                 ..
                                                                                                                                                                                               ........
                                                                                                                                                                                                                                                                 .
                                                                                                                                                                                                                                                                 .â€¢
                                                                                                                                                                                                                                                                 ..
                                                                                                                                                                                                                                                                  .                              .
                                                                                                                                                                                                                                                                                                   .
                                                                                                                                                                                                                                                                                                  ......
                                                                                                                                                                                                                                                                                                  .
                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                                                                                                                                                                                                                    ..
                                                                                                                                                                                                                                                                                                                                                                     .                              ..
                                                                                                                                                                                                                                                                                                                                                                                                      ....
                                                                                                                                                                                                                                                                                                                                                                                                         .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    .
                                                                                                                                                                ...                         .. ..                                                                 ....                         .. ...                                                                ....                         .. ...                                                            ....
                       arrangement                                                                                                                                ...
                                                                                                                                                                    ...
                                                                                                                                                                              .............. ..............                                                          ...
                                                                                                                                                                                                                                                                       ...
                                                                                                                                                                                                                                                                                 .............. ..............                                                          ...
                                                                                                                                                                                                                                                                                                                                                                          ...
                                                                                                                                                                                                                                                                                                                                                                                    .............. ..............                                                      ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ....
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ......................................
                                                                                                                                                                      ...                                                                                                ...                                                                                                ...                                                                                             ..
                                                                                                                                                                        ...                                                                                                ...                                                                                                ...                                                                                            ...
                                                                                                                                                                          ...                                                                                                ...                                                                                                ...                                                                                            ...




                                                                                        Figure 3. Constituents of the auxilliary arrangements.




                                                                                                                     4           ............... ............................................................................................................................................. ....................................................
                                                                                                                                               ... ..
                                                                                                                                                  .. ..
                                                                                                                                                                                                                                                                                                    ... ...
                                                                                                                                                                                                                                                                                                       . ..
                                                                                                                               123...............                                                                              124                                                                      ...
                                                                                                                                                                                                                                                                                                      .. ..
                                                                                                                                                                                                                                                                                                    .. .....
                                                                                                                                                                                                                                                                                                                                                     123
                                                                                                                                              .          .                                                                                                                                         .
                                                                                                                     3           ............ .          ......................................................................................................................................... .            ........................... ..............
                                                                                                                                                                                                                                                                                                                                          ... ...
                                                                                                                                                                                                                                                                                                                                             ... ..
                                                                                                                                                                                                                                          12                                                                                                   ...
                                                                                                                                                                                                                                                                                                                                            .. ..
                                                                                                                                                                                                                                                                                                                                          .. .....
                                                                                                                                                                                                                                                                                                                                                                             13
                                                                                                                                                                                                                                                                                                                                         .
                                                                                                                     2           ........................................................................................................................................................................................................           ............

                                                                                                                                                                                                                                                           1
                                                                                                                     1           .................................................................................................................................................................................................................................



        Figure 4. Upper arrangement for s3 s2 s1 s3 s2 . Note that g = sÌ‡3 y2 (t2 )y1 (t3 )x3 (m4 )sÌ‡âˆ’1
                                                                                                     3 sÌ‡2 .




                                                                                                                     4           ............... ........................................................................................................ .........................................................................................
                                                                                                                                               ... ...
                                                                                                                                                 .. .
                                                                                                                                                                                                                                                        ... ...
                                                                                                                                                                                                                                                          .....
                                                                                                                               123..............                                                           124                                              ...
                                                                                                                                                                                                                                                          .....
                                                                                                                                                                                                                                                         .. ....
                                                                                                                                                                                                                                                                                â€¢                                               134
                                                                                                                                              .          .                                                                                             ..
                                                                                                                     3           ............. ............................ ................................................................
                                                                                                                                                                                     ... ..
                                                                                                                                                                                       ......
                                                                                                                                                                                              .
                                                                                                                                                                                                                                                                  ................................................................. ..............
                                                                                                                                                                                                                                                                                                                                  ... ..
                                                                                                                                                                                                                                                                                                                                    ... ..
                                                                                                                                                       12                                ....â€¢
                                                                                                                                                                                       .. ....
                                                                                                                                                                                       .
                                                                                                                                                                                     . ...
                                                                                                                                                                                                                                                                            14                                                        ..
                                                                                                                                                                                                                                                                                                                                     . ...
                                                                                                                                                                                                                                                                                                                                   .. .....
                                                                                                                                                                                                                                                                                                                                                                             34
                                                                                                                                                                                   ..                                                                                                                                             .
                                                                                                                                                                                                                                                                                                                                  .
                                                                                                                     2           ..................................................            ........................... ......................................................................................................
                                                                                                                                                                                                                          ... .
                                                                                                                                                                                                                            ... ...
                                                                                                                                                                                                                                                                                                                                             .............

                                                                                                                                                                               1                                            .
                                                                                                                                                                                                                              ......
                                                                                                                                                                                                                             .. ....
                                                                                                                                                                                                                           . ..
                                                                                                                                                                                                                                      â€¢                                                                           4
                                                                                                                                 .......................................................................................... ..............................................................................................................................
                                                                                                                     1

        Figure 5. Lower arrangement for s3 s2 s1 s3 s2 . Note that g = sÌ‡3 y2 (t2 )y1 (t3 )x3 (m4 )sÌ‡âˆ’1
                                                                                                     3 sÌ‡2 .


   We note that, since G = SLd , the generalized minors of Definition 6.2 coincide with the usual minors of
matrices. We denote by âˆ†R    S the minor with row set R and column set S (interpreted as 1 if R = S = âˆ…).
Suppose that X is a chamber of the ansatz arrangement. Let R(X) be the label of the chamber containing
the corresponding part of the upper arrangement, and let S(X) be the label of the chamber containing
the corresponding part of the lower arrangement (these corresponding parts can be obtained by overlaying
the ansatz arrangement with the upper and lower arrangements respectively). We label X with the minor
  R(X)
âˆ†S(X) . The resulting labeled ansatz arrangement for our example is given in Figure 6.
   Next, we note that the singular points in the ansatz arrangement correspond precisely to the factors of g
of the form xik (mk ) and yik (tk ). We label these (beneath the arrangment) with tk and mk , respectively, for
18                                                                                R. J. MARSH AND K. RIETSCH




                                4 .................... .................................................................................................................. ...................................... .........................................................
                                âˆ†123123.... ......
                                                     ...
                                                                                                   âˆ†124       124                                                  .. ..
                                                                                                                                                                        â€¢...... 124 ... âˆ†123
                                                                                                                                                                      .. ... âˆ†134 ... ....
                                                                                                                                                                                                           . .                                 134
                                3 .............. ........................................................................................................ ............................ .................................. ...................
                                                   âˆ†12         12                         .â€¢
                                                                                            ..
                                                                                           .......
                                                                                        ... ...
                                                                                                                                                              âˆ†12             14
                                                                                                                                                                                                                                                      ...
                                                                                                                                                                                                                                                   .. ..âˆ†
                                                                                                                                                                                                                                                        .
                                                                                                                                                                                                                                                  .. ... 34
                                                                                                                                                                                                                                                                    13
                                2 .................................................... .................................. ........................................................................................................... ..............
                                                                         âˆ†11                                                    â€¢.........
                                                                                                                              ... ....
                                                                                                                                                                                                  âˆ†14
                                  .......................................................................................... ..............................................................................................................................
                                1
                                                                                         t2                                   t3                                m4

        Figure 6. Ansatz arrangement for s3 s2 s1 s3 s2 . Note that g = sÌ‡3 y2 (t2 )y1 (t3 )x3 (m4 )sÌ‡âˆ’1
                                                                                                      3 sÌ‡2 .


convenience. The ansatz arrangement can then be used to compute the coefficients tk and mk as follows.
Suppose k âˆˆ Jvâˆ’ âˆª Jvâ—¦ . Let Ak , Bk , Ck and Dk be the minors labelling the chambers surrounding the
singular point in the ansatz arrangement corresponding to k, with Ak and Dk above and below it, and Bk
and Ck on the same horizontal level (see Figure 7). It is easy to check that Theorem 7.1 implies that, for
k âˆˆ Jvâ—¦ ,
                                                Ak (z)Dk (z)
                                           tk =               ,
                                                 Bk (z)Ck (z)
and, for k âˆˆ Jvâˆ’ ,
                                                 Bk (z)Ck (z)
                                           rk =               .
                                                 Ak (z)Dk (z)


                                                                                                                               Ak
                                                                                                                   ............... ..............
                                                                                                                                 ... ...
                                                                                                                                   .....
                                                                                                            B         k ...........â€¢ C
                                                                                                                                     .
                                                                                                                                                      k
                                                                                                                               ... ...
                                                                                                                   ............          ............

                                                                                                                              Dk

           Figure 7. Chambers surrounding the singular point corresponding to k âˆˆ Jvâˆ’ âˆª Jvâ—¦ .


                            10. Determining Deodhar components for SLd
10.1. Graphical algorithm for Deodhar components. In this section we show that Proposition 6.4
also gives rise to a graphical algorithm for SLd to determine the Deodhar component of an element B âˆˆ B.
Suppose that B = z wÌ‡ Â· B + , where w âˆˆ W and z âˆˆ U + , and that a reduced expression w for w is chosen.
Then the graphical algorithm for computing the distinguished subexpression v of w such that B âˆˆ Rv,w
is as follows.
   Firstly we draw the usual pseudoline diagram for the reduced expression w of w as in [3] (call this the
classical pseudoline arrangement for w). Each factor sik of w corresponds to a singular crossing between
the ik th and ik+1 st pseudolines from the bottom (see below for an example). We define v(0) to be 1.
Suppose that v(0) , v(1) , . . . , v(kâˆ’1) have already been computed, and that if k > 1 we have drawn the upper
arrangement for the pair v(kâˆ’1) = (v(1) , v(2) , . . . , v(kâˆ’1) ), w(kâˆ’1) = (w(0) , w(1) , . . . , w(kâˆ’1) ).
   We compute v(k) in the following way. Consider the upper arrangement for the pair v(kâˆ’1) , w(kâˆ’1) . If
k > 1, let Rk be the label of the unbounded chamber at the right hand end of this arrangement between
the ik th and ik+1 st pseudolines (counting from bottom to top). If k = 1, we take R1 to be {1, 2, . . . , ik }.
   Let Sk be the label of the chamber in the classical arrangement for w immediately to the right of the
kth crossing. It is clear that |Rk | = |Sk | = ik . Now the minor âˆ†R         Sk (z) determines the value of v(k) . We
                                                                              k


have, by Proposition 6.4:
    (a) If v(kâˆ’1) sik > v(kâˆ’1) and âˆ†R      Sk (z) 6= 0, then v(k) = v(kâˆ’1) .
                                            k

                                           Rk
     (b) If v(kâˆ’1) sik > v(kâˆ’1) and âˆ†Sk (z) = 0, then v(k) = v(kâˆ’1) sik .
                                       PARAMETRIZATIONS OF FLAG VARIETIES                                                                                                                                                          19


    (c) If v(kâˆ’1) sik < v(kâˆ’1) , then v(k) = v(kâˆ’1) sik .
Thus v(k) is computed, and we draw the upper arrangement for the pair v(k) , w(k) , by building on the
upper arrangement for v(kâˆ’1) , w(kâˆ’1) if k > 1. We are thus ready for the next step.
  In this way, all of the v(k) are determined inductively. We also note that at the end we have drawn the
upper arrangement for the pair v, w. So, after drawing the lower arrangement for v, w, we are ready to
apply the method in Section 9 to compute the factors of g explicitly.
10.2. An Example. In this section we give an explicit example of the graphical algorithm described above.
We consider the element                    ï£«              ï£¶
                                               1 1 2 1
                                           ï£¬ 0 1 4 2 ï£·
                                       z=ï£¬                ï£·
                                           ï£­ 0 0 1 0 ï£¸ âˆˆ SL4 (C),
                                               0 0 0 1
and set w = s3 s2 s1 s3 s2 , so we have the reduced expression w = (1, s3 , s3 s2 , s3 s2 s1 , s3 s2 s1 s3 , s3 s2 s1 s3 s2 )
for w. The classical arrangement for w is given in Figure 8. We start with v(0) = 1.


                                        4    ............... ....................................................................................................... ...................................................
                                                   ..
                                                           ... ...
                                                             . ..
                                                                                                                                                                   ... ...
                                                                                                                                                                     ......
                                            123...â€¢.............                                            124                                                    .
                                                                                                                                                                      â€¢ .
                                                                                                                                                                      ......
                                                                                                                                                                    .. ....
                                                                                                                                                                                              134
                                             .............. ............................. ................................................................. ............................. ..............
                                        3                                                        ... ...
                                                                                                   .....
                                                                                                                                                                                                         ... ...
                                                                                                                                                                                                           .....
                                                               12                               â€¢     ..
                                                                                                   .....
                                                                                                  .. .....
                                                                                                                                                  14                                                      â€¢ 34..
                                                                                                                                                                                                           .....
                                                                                                                                                                                                          .. ....
                                                                                                .                                                                                                       .
                                             .................................................... ............................ ................................................................. ..............
                                        2                                                                                             ... ...
                                                                                                                                        .....
                                                                                    1                                              â€¢       ..
                                                                                                                                        .....
                                                                                                                                       .. ....
                                                                                                                                                                                  4
                                                                                                                                     .
                                             ......................................................................................... .........................................................................................
                                        1
                                                          s3                                 s2                                  s1                                 s3                                 s2

                              Figure 8. Classical arrangement for w = s3 s2 s1 s3 s2 .

      Step 1.: We have v(0) s3 = s3 > v(0) . Here, R1 = {1, 2, 3} and S1 = {1, 2, 4}. Since i1 = 3 and
        âˆ†123
          124 (z) = 0, we are in case (b) and v(1) = v(0) s3 = s3 .
      Step 2.: We have v(1) s2 = s3 s2 > v(1) . The upper arrangement for the pair v(1) , w(1) is shown in
        Figure 9. Here, R2 = {1, 2} and S2 = {1, 4}. Since i2 = 2 and âˆ†12   14 (z) = 2 6= 0, we are in case (a)
        and v(2) = v(1) = s3 .
      Step 3.: We have v(2) s1 = s3 s1 > v(2) . The upper arrangement for the pair v(2) , w(2) is shown in
        Figure 10. Here, R3 = {1} and S3 = {4}. Since i3 = 1 and âˆ†14 (z) = 1, we are in case (a) and
        v(3) = v(2) = s3 .
      Step 4.: We have v(3) s3 = s3 s3 = 1 < v(2) . The upper arrangement for the pair v(3) , w(3) is shown
        in Figure 11. We are in case (c) and v(4) = v(3) s3 = 1.
      Step 5.: We have v(4) s2 = s2 > v(4) . The upper arrangement for the pair v(4) , w(4) is shown in
        Figure 12. Here, R5 = {1, 2} and S5 = {3, 4}. Since i5 = 2 and âˆ†12   34 (z) = 0, we are in case (b) and
        v(5) = v(4) s2 = s2 . The upper arrangement for the pair v(5) , w(5) is shown in Figure 4.



                                                                                                         4 .................... ..................
                                                                                                          123..............124
                                                                                                         3 .............. ..............
                                                                                                                         12
                                                                                                         2 ......................................
                                                                                                                             1
                                                                                                         1 ......................................

                           Figure 9. Upper arrangement for s3 . Note that g(1) = sÌ‡3 .
20                                                           R. J. MARSH AND K. RIETSCH




                                                                                              4 .................... .........................................................
                                                                                               123............. 124
                                                                                              3 .............. ....................................................
                                                                                                                                   12
                                                                                              2 ...........................................................................
                                                                                                                                      1
                                                                                              1 ...........................................................................

                   Figure 10. Upper arrangement for s3 s2 . Note that g(2) = sÌ‡3 y2 (t2 ).




                                                                             4 .................... .............................................................................................
                                                                              123.............                                               124
                                                                             3 .............. .........................................................................................
                                                                                                                                    12
                                                                             2 .................................................................................................................
                                                                                                                                       1
                                                                             1 .................................................................................................................

               Figure 11. Upper arrangement for s3 s2 s1 . Note that g(3) = sÌ‡3 y2 (t2 )y1 (t3 ).




                                    4 .................... ...................................................................................................................................................... ...................
                                     123.............                                                      124                                                                                                  ...
                                                                                                                                                                                                               .. .. 123
                                                                                                                                                                                                            .. ...
                                    3 .............. ............................................................................................................................................ ..............
                                                                                                                                12
                                    2 ...........................................................................................................................................................................................
                                                                                                                                   1
                                    1 ...........................................................................................................................................................................................

        Figure 12. Upper arrangement for s3 s2 s1 s3 . Note that g(4) = sÌ‡3 y2 (t2 )y1 (t3 )x3 (m4 )sÌ‡âˆ’1
                                                                                                      3 .




   We conclude that B lies in the Deodhar component Rv,w , where v = (1, s3 , s3 , s3 , 1, s2 ) and w =
(1, s3 , s3 s2 , s3 s2 s1 , s3 s2 s1 s3 , s3 s2 s1 s3 s2 ).
   We remark that we can use the above computation to determine criteria for z wÌ‡ Â· B + to lie in Rv,w ,
where z is an arbitrary matrix in U + , in terms of minors of z (see Corollary 6.6). Suppose that
                                                                               ï£«                                                                                             ï£¶
                                                             1                                                   a12                         a13                         a14
                                                           ï£¬ 0                                                    1                          a23                         a24 ï£·
                                                           ï£¬
                                                         z=ï£­                                                                                                                 ï£·.
                                                             0                                                    0                           1                          a34 ï£¸
                                                             0                                                    0                           0                           1

We obtain that

Rv,w = {z wÌ‡ Â· B + : âˆ†123                 12                  1                  12
                      124 (z) = a34 = 0, âˆ†14 (z) = a24 6= 0, âˆ†4 (z) = a14 6= 0, âˆ†34 (z) = a13 a24 âˆ’ a14 a23 = 0}.


We note that no condition is obtained on the entry a12 of z. No such condition could arise, since z wÌ‡ Â· B +
doesnâ€™t depend on a12 , as wâˆ’1 Î±1 is positive.
   Finally, we note that in our example, B lies in the Deodhar component Rv,w considered in Section 9,
so we can apply the graphical algorithm given there in order to compute the coefficients tk and mk in the
                                         PARAMETRIZATIONS OF FLAG VARIETIES                                                   21


factorisation of g = sÌ‡3 y2 (t2 )y1 (t3 )x3 (m4 )sÌ‡âˆ’1                           +
                                                   3 sÌ‡2 âˆˆ Gv,w (where B = g Â· B ). We obtain:
                                                             âˆ†124      1
                                                              124 (z)âˆ†1 (z)
                                                t2    =                     = 1/2,
                                                             âˆ†12      12
                                                              12 (z)âˆ†14 (z)
                                                                      âˆ…
                                                             âˆ†12
                                                              14 (z)âˆ†âˆ… (z)
                                                t3    =                     = 2,
                                                             âˆ†11 (z)âˆ†14 (z)
and
                                                            âˆ†124      124
                                                             124 (z)âˆ†134 (z)
                                                     r4 =                    = 2.
                                                            âˆ†1234      12
                                                             1234 (z)âˆ†14 (z)
                                            v         Ï‰i
   Finally, we show that the minor âˆ†si(kâˆ’1)Ï‰
                                         k ik
                                               k
                                                 (g(kâˆ’1) ), that would appear as correction term vanishes on this
                                                       v     Ï‰ik              v Ï‰i4
Deodhar component, so that mk = rk . We have âˆ†si(kâˆ’1)     Ï‰
                                                         k ik
                                                                 (g(kâˆ’1) ) = âˆ†si(3)
                                                                                 4 Ï‰i4
                                                                                       (g(3) ) = âˆ†ss33 Ï‰
                                                                                                       Ï‰3 (sÌ‡3 y2 (t2 )y1 (t3 )).
                                                                                                         3


We note that g(3) sÌ‡3 Ï‰3 is a linear combination of elements of weight Ï‰3 and s3 (s3 Ï‰3 âˆ’Î±2 ) = Ï‰3 âˆ’Î±2 âˆ’Î±3 , and
therefore has zero component in the s3 Ï‰3 -weight space, from which it follows that âˆ†ss33 Ï‰     Ï‰3 (sÌ‡3 y2 (t2 )y1 (t3 )) = 0,
                                                                                                 3

so m4 = r4 âˆ’ 0 = r4 . Thus, in this case, m4 = 2. We finally see that
                      ï£«                ï£¶
                         1 1 2 1
                      ï£¬ 0 1 4 2 ï£·                                                       âˆ’1
                      ï£¬                ï£·                  +                                      +
                      ï£­ 0 0 1 0 ï£¸ sÌ‡3 sÌ‡2 sÌ‡1 sÌ‡3 sÌ‡2 Â· B = sÌ‡3 y2 (1/2)y1 (2)x3 (2)sÌ‡3 sÌ‡2 Â· B .
                         0 0 0 1
                                                               v     Ï‰i
Remark 10.1. It is possible that the minor âˆ†si(kâˆ’1)             Ï‰
                                                              k ik
                                                                     k
                                                                       (g(kâˆ’1) ) is non-zero. This happens, for example,
for G = SL4 . Let v = 1 and w = w0 , and take v = (1, 1, 1, 1, s1, s1 , 1), a subexpression for v in the reduced
expression for w with factors (s1 , s2 , s3 , s1 , s2 , s1 ). Then g(5) = y1 (t1 )y2 (t2 )y3 (t3 )sÌ‡1 y2 (t5 ), and it is easy to
check that
                                                     v Ï‰i6
                                                  âˆ†si(5)6 Ï‰i6
                                                               (g(5) ) = âˆ’t1 .

                                                      11. Total positivity
   Â¿From now on let K = R. We view the group G and the flag variety B as real manifolds, with the
corresponding Hausdorff topology.
                                                           âˆ’
Definition 11.1 ([10]). The totally nonnegative part Uâ‰¥0      of U âˆ’ is defined to be the semigroup in U âˆ’
generated by the yi (t) for t âˆˆ Râ‰¥0 . The totally nonnegative part of B is defined by
                                                                        âˆ’
                                                 Bâ‰¥0 := {u Â· B + | u âˆˆ Uâ‰¥0 }
where the closure is taken inside B in its real topology.
   Let us collect below some useful facts, see [10] and also [2] for (1).
    (1) For any braid relation such as si sj si = sj si sj in W there is a subtraction-free rational trans-
        formation relating the parameters of the corresponding parametrizations. For example in type
        A2 ,                                                                
                                                      bc                    ab
                           yi (a)yj (b)yi (c) = yj         yi (a + c) yj         .
                                                     a+c                   a+c
    (2) For w âˆˆ W and a reduced expression w = si1 . . . sin define
                                  âˆ’
                                 U>0 (w) := {yi1 (t1 ) Â· . . . Â· yin (tn ) | t1 , . . . , tn âˆˆ R>0 }.
         By (1) this set is independent of the reduced expression chosen. Moreover any product of yi (t)â€™s
                                                                                       âˆ’
         for positive parameters t can be transformed until it is seen to lie in some U>0 (w). Therefore
                                                    G
                                              âˆ’          âˆ’
                                            Uâ‰¥0  =     U>0  (w).
                                                                   wâˆˆW
                                                           âˆ’
         This is of course precisely the decomposition of Uâ‰¥0 induced by Bruhat decomposition, that is,
          âˆ’           âˆ’
         U>0 (w) = Uâ‰¥0 âˆ© B + wÌ‡B + .
22                                         R. J. MARSH AND K. RIETSCH

                                                              âˆ’     âˆ’
      (3) The totally positive part of U âˆ’ may be defined as U>0 = Uâ‰¥0 (w0 ). For the flag variety the totally
          positive part is taken to be
                                                                  âˆ’
                                           B>0 := {u Â· B + | u âˆˆ U>0 }.
          Clearly B>0 is open dense in Bâ‰¥0 .
                   âˆ’                             âˆ’     âˆ’
      (4) Let u âˆˆ Uâ‰¥0 . The semigroup property uUâ‰¥0 âŠ‚ Uâ‰¥0 implies, by continuity, that
                                                   u Â· Bâ‰¥0 âŠ‚ Bâ‰¥0 .
Definition 11.2. For v, w âˆˆ W with v â‰¤ w, let
                                               R>0
                                                v,w := Rv,w âˆ© Bâ‰¥0 .

    In the special case where v = 1 we have R1,w âˆ¼   = U âˆ’ âˆ© B + wÌ‡B + and R>0           âˆ’
                                                                                 1,w = U>0 (w) Â· B
                                                                                                   +
                                                                                                     (see property
                                                                                >0
(2) above). From this observation Lusztig [10] conjectured that also Rv,w is a semi-algebraic cell. The
first proof of this is in [12]. However this proof does not provide an explicit parametrization and uses
deep properties of canonical bases. We will now give a different proof which gives parametrizations and is
completely elementary.
    Let us choose a reduced expression w for w with factors (si1 , . . . , sin ). To v â‰¤ w we may associate the
positive subexpression v+ for v in w as in Lemma 3.5. Note that v+ is non-decreasing, so Jvâˆ’+ = âˆ…. We
define                                                                                       
                                                 gk = yik (tk ) for tk âˆˆ R>0 , if k âˆˆ Jvâ—¦
                     >0                         
                   Gv+ ,w := g = g1 g2 Â· Â· Â· gn                                             +
                                                  gk = sÌ‡ik ,                      if k âˆˆ Jv++
Then G>0     âˆ¼ â„“(w)âˆ’â„“(v) is a semi-algebraic cell in G. The aim of this section is to prove the following
       v+ ,w = R>0
theorem.
                                                  âˆ¼
Theorem 11.3. The isomorphism Gv+ ,w â†’ Rv+ ,w restricts to an isomorphism of real semi-algebraic
varieties
                                             âˆ¼
                                     G>0         >0
                                      v+ ,w âˆ’â†’ Rv,w .

                                         âˆ’
  Note that if v = 1 then Gv>0 + ,w
                                    = U>0   (w) and, as a subset of G, does not depend on the reduced
expression w. This is no longer true if v 6= 1 as can be seen already in type A2 . We begin the proof of
Theorem 11.3 with a simple observation about minors.
Lemma 11.4. Suppose B = z wÌ‡ Â· B + lies in Bâ‰¥0 with z âˆˆ U + and w âˆˆ W . For any dominant weight Î»
and v âˆˆ W ,
                                            âˆ†vÎ»
                                             wÎ» (z) â‰¥ 0.
                                                                        âˆ’
Proof. Since B âˆˆ Bâ‰¥0 we can find a sequence un Â· B + with un âˆˆ U>0         that converges to B = z wÌ‡ Â· B + . Note
                                              âˆ’
that for any u = yi1 (t1 ) . . . yiN (tN ) âˆˆ U>0 and x âˆˆ W , the element u Â· Î¾Î» in V (Î») has a positive projection
to the xÎ» weight space, using that si1 . . . siN = w0 has a subexpression for x. Now we have
                                     un Â· Î¾Î»
                                                      â†’ z wÌ‡ Â· Î¾Î»           (n â†’ âˆ),
                                 hun Â· Î¾Î» , wÌ‡ Â· Î¾Î» i
where the denominator hun Â· Î¾Î» , wÌ‡ Â· Î¾Î» i is just the required normalization factor. It follows that
                                       hun Â· Î¾Î» , vÌ‡ Â· Î¾Î» i
                            0 â‰¤ lim                         = hz wÌ‡ Â· Î¾Î» , vÌ‡ Â· Î¾Î» i = âˆ†vÎ»
                                                                                        wÎ» (z).
                                 nâ†’âˆ   hun Â· Î¾Î» , wÌ‡ Â· Î¾Î» i
                                                                                                                

     We need to recall one lemma.
Lemma 11.5 ([12] Lemma 2.3). Suppose w = w1 w2 with â„“(w) = â„“(w1 ) + â„“(w2 ). Consider the reduction
     w
map Ï€w1
        : B + wÌ‡ Â· B + â†’ B + wÌ‡1 Â· B + . If B âˆˆ B + wÌ‡ Â· B + lies in Bâ‰¥0 then so does Ï€w
                                                                                       w
                                                                                        1
                                                                                          (B).
                                          PARAMETRIZATIONS OF FLAG VARIETIES                                                 23


   This lemma is easy to see if B âˆˆ R>0          1,w : In that case using Lusztigâ€™s parametrization we may write
B = yi1 (t1 ) . . . yin (tn ) Â· B + for some positive ti , being careful to choose a reduced expression si1 Â· Â· Â· sin of w
such that w1 = si1 Â· Â· Â· sim , where m = â„“(w1 ). The element Ï€w        w
                                                                         1
                                                                           (B) = yi1 (t1 ) . . . yim (tm ) Â· B + is then clearly
totally nonnegative again. The property extends from the dense open part R1,w to the whole Bruhat cell
essentially by continuity (see [12] for a more careful argument).
   Now we are ready to show one part of the theorem.
Lemma 11.6. If Rv,w âˆ© Bâ‰¥0 6= âˆ…, then v is a positive subexpression of w.
Proof. Let B âˆˆ Rv,w âˆ© Bâ‰¥0 and write B = z wÌ‡ Â· B + for z âˆˆ U + . Suppose v â‰º w is not a positive
subexpression. Then Jvâˆ’ 6= âˆ…. Let k âˆˆ Jvâˆ’ . The equation (7.3) together with Remark 7.6.(1) gives
                                             Q         v(k) Ï‰j    âˆ’aj,ik
                                              j6=ik âˆ†w(k) Ï‰j (z)
                                    âˆ’1 = v(k) Ï‰ik           v(kâˆ’1) Ï‰ik   .
                                            âˆ†w(k) Ï‰ik (z)âˆ†w(kâˆ’1) Ï‰ik (z)
Therefore at least one of the minors in this formula must be negative. By Lemma 11.4 this implies that
one of the two elements z wÌ‡(k) Â· B + and z wÌ‡(kâˆ’1) Â· B + does not lie in Bâ‰¥0 . Since these are both reductions
of B we have a contradiction to Lemma 11.5.                                                                  
Remark 11.7. Suppose z wÌ‡ Â· B + âˆˆ R>0
                                    v,w and w is a reduced expression for w with positive subexpression
v+ for v. Then by a combination of the above lemmas we have,
                                           v   Ï‰i
                                         âˆ†w(k)
                                            (k) Ï‰ik (z) > 0,
                                                 k
                                                                      k = 0, 1, . . . , â„“(w).
Recall that these minors, as standard chamber minors, are automatically nonzero, hence the strict positivity.
Since v+ is non-decreasing there are no special chamber minors. So the observation is that if z wÌ‡ Â· B + lies
in Bâ‰¥0 , then all of the associated chamber minors are positive.
   The following lemma is a technical tool we will need to finish the proof of the theorem.
Lemma 11.8. Let v â‰¤ w in W and suppose Î±i0 is a simple root such that uâˆ’1 Î±i0 > 0 for all v â‰¤ u â‰¤ w.
Then for all g Â· B + âˆˆ Rv,w and any m âˆˆ R,
(11.1)                                               xi0 (m)g Â· B + = g Â· B + .
In other words, if uâˆ’1 Î±i0 > 0 for all v â‰¤ u â‰¤ w, then Rv,w is contained in the Springer fiber of xi0 (m).
   Note that it is easy to see that the condition on Î±i0 is also necessary. Suppose m 6= 0. If xi0 (m) fixes
the elements of Rv,w then it also fixes the elements of the closure. So in particular, xi0 (m)uÌ‡ Â· B + = uÌ‡ Â· B +
for v â‰¤ u â‰¤ w. This implies uâˆ’1 Î±i0 > 0.
Proof. Let v+ be the positive subexpression for v of a reduced expression w for w. Since the corresponding
Deodhar component Rv+ ,w is dense in Rv,w , it suffices to show that xi0 (m)gÂ·B + = gÂ·B + for gÂ·B + âˆˆ Rv+ ,w .
In other words we may assume g âˆˆ Gv+ ,w .
   By the defining property (3.8) for positive subexpressions we have that v(jâˆ’1) Î±ij > 0 for all j. Also
Jvâˆ’+ = âˆ…. So we may write g âˆˆ Gv+ ,w as
                                          ï£«                          ï£¶
                                              Y
                                      g=ï£­           yv(jâˆ’1) Î±ij (tj )ï£¸ vÌ‡,
                                                        jâˆˆJvâ—¦
                                                               +

                                            âˆ’1         âˆ’
                                                                             Q
where yv(jâˆ’1) Î±ij (t) :=   vÌ‡(jâˆ’1) yij (t)vÌ‡(jâˆ’1)   âˆˆ U . Let us set y =        jâˆˆJvâ—¦      yv(jâˆ’1) Î±ij (tj ). Then we have
                                                                                       +

                                                 g Â· B + = y vÌ‡ Â· B + = z wÌ‡ Â· B + ,
where z âˆˆ U + . Let us also write the reductions Ï€w
                                                  w
                                                   (k)
                                                       (g Â· B + ) as
                                           g(k) Â· B + = y(k) vÌ‡(k) Â· B + = z wÌ‡(k) Â· B + ,
                Q
where y(k) =        jâˆˆJvâ—¦+ ,jâ‰¤k   yv(jâˆ’1) Î±ij (tj ) and otherwise the notation is as usual.
   We will now show that the conditions on Î±i0 imply the following assertions.
24                                             R. J. MARSH AND K. RIETSCH


      (i) If x âˆˆ W satisfies v(j) â‰¤ x â‰¤ w(j) for some j = 1, . . . , n, then xâˆ’1 Î±i0 > 0.
     (ii) v(jâˆ’1) Î±ij 6= Î±i0 for all j = 1, . . . , n.
   For x âˆˆ W let R+ (x) := {Î± âˆˆ R+ | xâˆ’1 Î± < 0}. Suppose we have an x âˆˆ W with v(j) â‰¤ x â‰¤ w(j) . We
want to show that there exists xâ€² with v â‰¤ xâ€² â‰¤ w such that R+ (x) âŠ† R+ (xâ€² ). This will imply (i). Set
x(j) := x. It suffices if we can construct x(j+1) with v(j+1) â‰¤ x(j+1) â‰¤ w(j+1) and R+ (x(j) ) âŠ† R+ (x(j+1) ).
For this there are two cases. If already v(j+1) â‰¤ x(j) , then we may set x(j+1) := x(j) . Otherwise we
must be in the situation v(j+1) = v(j) sij+1 and we need to take (at least) x(j+1) := x(j) sij+1 to obtain
v(j+1) â‰¤ x(j+1) â‰¤ w(j+1) . Because v(j+1) â‰¤ x(j+1) and v(j+1) 6â‰¤ x(j) , we find that x(j) < x(j+1) and also
R+ (x(j) ) âŠ‚ R+ (x(j+1) ). So x(j+1) has been constructed successfully.
   Now consider x = v(jâˆ’1) sij . Clearly v(j) â‰¤ x â‰¤ w(j) is satisfied, and so by (i) we have sâˆ’1  âˆ’1
                                                                                              ij v(jâˆ’1) Î±i0 > 0.
Therefore
                               â„“(si0 v(jâˆ’1) sij ) = â„“(v(jâˆ’1) sij ) + 1 = â„“(v(jâˆ’1) ) + 2
using also that v+ is non-decreasing. It follows that si0 v(jâˆ’1) sij > si0 v(jâˆ’1) and si0 v(jâˆ’1) Î±ij > 0. This
implies (ii).
   Finally we can put everything together to show that xi0 (m)g Â· B + lies in Rv+ ,w and equals g Â· B + . By
Corollary 6.6 and Theorem 7.1 we know exactly which minors to check. Namely we only have to prove
     (1)
                                          v      Ï‰i
                                      âˆ†w(kâˆ’1)
                                         (k) Ï‰ik
                                                 k
                                                   (xi0 (m)z) = 0,             k âˆˆ Jv++ ,
     (2)
                                 v   Ï‰i                       v     Ï‰i
                               âˆ†w(k)   k                 (k)
                                  (k) Ï‰ik (xi0 (m)z) = âˆ†w(k) Ï‰ik (z),
                                                              k
                                                                                     k = 1, . . . , n.
Suppose l âˆˆ Zâ‰¥0 and Âµ = v(kâˆ’1) Ï‰ik âˆ’ lÎ±i0 . Let Î¶ = prÂµ (y(k) vÌ‡(k) Â· Î¾Ï‰ik ) in V (Ï‰ik ). If Î¶ 6= 0 then the weight
Âµ must be of the form
                                                              X
                           v(kâˆ’1) Ï‰ik âˆ’ lÎ±i0 = v(k) Ï‰ik âˆ’              cj v(jâˆ’1) Î±ij
                                                                         jâ‰¤k,jâˆˆJvâ—¦

with cj â‰¥ 0, since the factors of y(k) are yv(jâˆ’1) Î±ij (tj ) for j âˆˆ Jvâ—¦+ with j â‰¤ k. Simplifying this equation we
get
                                                              X
                                   lÎ±i0 = v(kâˆ’1) Î±ik +               cj v(jâˆ’1) Î±ij .
                                                                  jâ‰¤k,jâˆˆJvâ—¦
                                                                           +


But the right hand side is a non-zero sum of positive roots Î± not equal to Î±i0 by (ii) above. Therefore we
have a contradiction and so Î¶ = 0. Since z wÌ‡(k) Â· Î¾Ï‰ik and y(k) vÌ‡(k) Â· Î¾Ï‰ik are collinear in V (Ï‰ik ) this implies
that also
                                      prv(kâˆ’1) Ï‰ik âˆ’lÎ±i0 (z wÌ‡(k) Â· Î¾Ï‰ik ) = 0.
                        D                                       E
for all l â‰¥ 0. Therefore xi0 (m)z wÌ‡(k) Â· Î¾Ï‰ik , vÌ‡(kâˆ’1) Â· Î¾Ï‰ik = 0 and (1) holds.
   We can now prove (2) in a completely analogous way. Let l âˆˆ Z>0 and consider Î¶ = prv(k) Ï‰ik âˆ’lÎ±i0 (y(k) vÌ‡(k) Â·
Î¾Ï‰ik ). Then Î¶ 6= 0 only if
                                                 X
                                       lÎ±i0 =          cj v(jâˆ’1) Î±ij
                                                        jâ‰¤k,jâˆˆJvâ—¦+

for cj â‰¥ 0. And again this is impossible by (ii). So Î¶ = 0 and with it
                                              prv(k) Ï‰ik âˆ’lÎ±i0 (z wÌ‡(k) Â· Î¾Ï‰ik ) = 0
for all l > 0. This implies (2).                                                                                  
                                    +
Lemma 11.9. If g âˆˆ G>0                  >0
                    v+ ,w then g Â· B âˆˆ Rv,w .
                                      PARAMETRIZATIONS OF FLAG VARIETIES                                           25


Proof. By Proposition 5.2 we have g Â· B + âˆˆ Rv+ ,w . We need to show that g Â· B + âˆˆ Bâ‰¥0 . We have
g = g1 . . . gn with               (
                                      yij (tj ) for tj âˆˆ R>0 , if j âˆˆ Jvâ—¦+
                              gj =
                                      sÌ‡ij ,                   if j âˆˆ Jv++
Clearly gn Â· B + âˆˆ Bâ‰¥0 . We will prove that gk . . . gn Â· B + lies in Bâ‰¥0 for all k by descending induction.
Suppose we know gk+1 . . . gn Â· B + âˆˆ Bâ‰¥0 . There are two possibilities for gk . The first case, k âˆˆ Jvâ—¦+ , is
                                      âˆ’
clear. In that case gk = yik (tk ) âˆˆ Uâ‰¥0 and so gk gk+1 . . . gn Â· B + again lies in Bâ‰¥0 .
   Let us now consider the other case. So gk = sÌ‡ik and k âˆˆ Jv++ . From (2.1) we get the formula
                                             xi (t)sÌ‡i = Î±âˆ¨
                                                          i (t)yi (t)xi (âˆ’t
                                                                            âˆ’1
                                                                               ).
We apply this element for i = ik to gk+1 . . . gn Â· B + to get
                       xik (t)sÌ‡ik gk+1 . . . gn Â· B + = Î±âˆ¨
                                                          ik (t)yik (t)xik (âˆ’t
                                                                               âˆ’1
                                                                                  )gk+1 . . . gn Â· B + .
           âˆ’1               âˆ’1
Let v â€² = v(k) v and wâ€² = w(k) w. Since v is the positive subexpression of w, so the right-most reduced
subexpression and k âˆˆ Jv , it follows that sik u > u for all v â€² â‰¤ u â‰¤ wâ€² . Applying Lemma 11.8 we get
                        +

                                   xik (âˆ’tâˆ’1 )gk+1 . . . gn Â· B + = gk+1 . . . gn Â· B + .
Therefore in total
(11.2)                       xik (t)sÌ‡ik gk+1 . . . gn Â· B + = Î±âˆ¨                             +
                                                                ik (t)yik (t)gk+1 . . . gn Â· B .
Now one can see that the right hand side of (11.2) lies in Bâ‰¥0 for all t > 0. However as t â†’ 0 the left hand
side converges to sÌ‡ik gk+1 . . . gn Â· B + . Therefore sÌ‡ik gk+1 . . . gn Â· B + âˆˆ Bâ‰¥0 and the lemma follows. 
Proof of Theorem 11.3. By Lemma 11.9 the map
(11.3)                                                G>0       >0
                                                       v+ ,w â†’ Rv,w
                                                                                 +
is well defined. Lemma 11.6 implies that R>0                                          >0
                                               v,w âŠ‚ Rv+ ,w . Now if B = z wÌ‡ Â· B âˆˆ Rv,w , then Lemma 11.5
and Lemma 11.4 together with Corollary 6.6 imply that the chamber minors of z (for the subexpression v+ )
are all positive. Note also that Jvâˆ’+ = âˆ…. It follows that the map Rv+ ,w â†’ Gv+ ,w described in Theorem 7.1
(see Proposition 5.2) restricts to
                                                 R>0        >0
                                                   v,w â†’ Gv+ ,w ,
giving the inverse to (11.3).                                                                            

                                          12. Total positivity criteria
   We can use the Chamber Ansatz together with Theorem 11.3 to characterize R>0          v,w by inequalities. In
the case where v = 1 the criteria below reduce to the total positivity criteria for U + âˆ©B âˆ’ wÌ‡B âˆ’ of Berenstein
and Zelevinsky, [2] Theorem 6.9.
Proposition 12.1. Consider w âˆˆ W with a fixed reduced expression w = (w(0) , . . . , w(n) ). Let v â‰¤ w in
W and v+ = (v(0) , . . . , v(n) ) be the positive subexpression for v in w. Then
                                  (                                                        )
                                                          v(kâˆ’1) Ï‰ik                  +
                          >0               +          + âˆ†w(k) Ï‰ik (z) = 0, k âˆˆ Jv+
                      Rv,w = z wÌ‡ Â· B  z âˆˆ U ; v(k) Ï‰ik
                                                        âˆ†w(k) Ï‰ik (z) > 0,      k âˆˆ Jvâ—¦+
                                  n                                                          o
                                                                  v Ï‰ik                   â—¦
                               = z wÌ‡ Â· B + âˆˆ Rv,w  z âˆˆ U + ; âˆ†w(k)   Ï‰
                                                                    (k) ik (z) > 0, k âˆˆ  Jv+    .

Proof. Let us call the two sets in question S1 and S2 , respectively. We want to show R>0
                                                                                       v,w = S1 = S2 . The
                              >0
inclusions in one direction, Rv,w âŠ† S1 âŠ† S2 , are clear from Remark 11.7 and Corollary 6.6.
   Moreover by Corollary 6.6,
                                        v       Ï‰ik
                                      âˆ†w(kâˆ’1)
                                          (k) Ï‰ik   (z) = 0, for k âˆˆ Jv++ ,
is true for all z wÌ‡Â·B + in Rv+ ,w . And since Rv+ ,w is dense in Rv,w , this equality holds for all z wÌ‡Â·B + âˆˆ Rv,w .
Therefore we also have the inclusions S2 âŠ† S1 âŠ† Rv+ ,w .
26                                             R. J. MARSH AND K. RIETSCH

                                                                                                                v   Ï‰i
                                                              >0
   It remains to show the final inclusion, of S1 , say, into Rv,w . Consider z wÌ‡Â·B + âˆˆ Rv+ ,w with âˆ†w(k)   k
                                                                                                       (k) Ï‰ik
                                                                                                               (z) >
               â—¦
0 for all k âˆˆ Jv+ . By Theorem 11.3 and Theorem 7.1.(1) we need only show that the remaining chamber
            v   Ï‰i                                                                              v(k   ) Ï‰i
minors, âˆ†w(k)    k
            (k) Ï‰ik
                    (z) for k âˆˆ Jv++ , are also positive. Suppose indirectly that âˆ†w(k00 ) Ï‰ikk0 (z) < 0 for some
                                                                                                0
k0 âˆˆ Jv++ . We may choose k0 to be minimal with this property. From Remark 7.6.(1) and equation (7.3)
one obtains
                                                     Q          v(k0 ) Ï‰j     âˆ’aj,ik
                                                       j6=ik0 âˆ†w(k0 ) Ï‰j (z)
                                                                                    0
                                      v(k0 ) Ï‰ik
(12.1)                             âˆ†w(k0 ) Ï‰ik (z) =
                                                0
                                                             v(k âˆ’1) iÏ‰               .
                                                 0
                                                           âˆ†w(k00 âˆ’1) Ï‰ikk0 (z)
                                                                            0

Since the right hand side is made up of chamber minors for smaller k, it must be positive. So we have a
contradiction.                                                                                       
Remark 12.2. Note that by this proposition, R>0        v,w is given inside Rv,w by dim(Rv,w ) = â„“(w) âˆ’ â„“(v)
inequalities. This is the ideal situation. Indeed, it is easy to see that our set of inequalities,
                                               v   Ï‰i
(12.2)                                       âˆ†w(k)   k
                                                (k) Ï‰ik
                                                        (z) > 0      (k âˆˆ Jvâ—¦+ ),
is minimal. Using Proposition 8.1 we can describe the situation by the following commutative diagram
                                                            âˆ¼
                                          âˆ† : Rv+ ,w       âˆ’â†’ (Râˆ— )â„“(w)âˆ’â„“(v)
                                                â†‘               â†‘
                                                            âˆ¼
                                              R>0
                                                v,w        âˆ’â†’ (R>0 )â„“(w)âˆ’â„“(v) ,
where the horizontal maps are given by the chamber minors,
                                                v Ï‰ik        
                                  âˆ† z wÌ‡ Â· B + = âˆ†w(k)
                                                    (k) Ï‰ik
                                                            (z)                         ,
                                                                             kâˆˆJvâ—¦
                                                                                    +

and the vertical maps are inclusions. Â¿From this picture it is clear that (12.2), or Proposition 12.1, has no
redundant inequalities.
Acknowledgements.
The first author would like to thank Kingâ€™s College, London for their kind hospitality in spring 2003, where
most of the work for this paper was carried out.

                                                        References
 [1] John C. Baez, Link invariants of finite type and perturbation theory, Lett. Math. Phys. 26 (1992), no. 1, 43â€“51. MR
     93k:57006
 [2] A. Berenstein and A. Zelevinsky, Total positivity in Schubert varieties, Comment. Math. Helv. 72 (1997), 128â€“166.
 [3] Arkady Berenstein, Sergey Fomin, and Andrei Zelevinsky, Parametrizations of canonical bases and totally positive ma-
     trices, Adv. Math. 122 (1996), no. 1, 49â€“149.
 [4] Joan S. Birman, New points of view in knot theory, Bull. Amer. Math. Soc. (N.S.) 28 (1993), no. 2, 253â€“287. MR
     94b:57007
 [5] Armand Borel, Linear algebraic groups, second ed., Graduate Texts in Mathematics, vol. 126, Springer-Verlag, New
     York, 1991. MR 92d:20001
 [6] Vinay V. Deodhar, On some geometric aspects of Bruhat orderings. I. A finer decomposition of Bruhat cells, Invent.
     Math. 79 (1985), no. 3, 499â€“511. MR 86f:20045
 [7] S. Fomin and A. Zelevinsky, Double bruhat cells and total positivity, J. Amer. Math. Soc 12 (1999), no. 2, 335â€“380.
 [8] Jens Carsten Jantzen, Representations of algebraic groups, Pure and Applied Mathematics, vol. 131, Academic Press
     Inc., Boston, MA, 1987. MR 89c:20001
 [9] David Kazhdan and George Lusztig, Representations of Coxeter groups and Hecke algebras, Invent. Math. 53 (1979),
     no. 2, 165â€“184. MR 81j:20066
[10] G. Lusztig, Total positivity in reductive groups, Lie theory and geometry: in honor of Bertram Kostant (G. I. Lehrer,
     ed.), Progress in Mathematics, vol. 123, Birkhaeuser, Boston, 1994, pp. 531â€“568.
[11] R. J. Marsh and K. Rietsch, The intersection of opposed big cells in the real flag variety of type G2 , Proc. London Math.
     Soc. (3) 85 (2002), no. 1, 22â€“42. MR 1 901 367
[12] K. Rietsch, An algebraic cell decomposition of the nonnegative part of a flag variety, J. Algebra 213 (1999), 144â€“154.
[13] T. A. Springer, Linear algebraic groups, second edition, Progress in Mathematics, vol. 9, BirkhaÌˆuser, Boston, 1998.
[14] Robert Steinberg, Lectures on Chevalley groups, Yale University, New Haven, Conn., 1968, Notes prepared by John
     Faulkner and Robert Wilson. MR 57 #6215
                                 PARAMETRIZATIONS OF FLAG VARIETIES                                    27


  Department of Mathematics and Computer Science, University of Leicester, University Road, Leicester LE1
7RH
  E-mail address: R.Marsh@mcs.le.ac.uk

  Department of Mathematics, Kingâ€™s College London, Strand, London WC2R 2LS
  E-mail address: rietsch@mth.kcl.ac.uk
