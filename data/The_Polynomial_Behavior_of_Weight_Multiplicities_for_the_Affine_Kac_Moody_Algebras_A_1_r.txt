                                                  THE POLYNOMIAL BEHAVIOR OF
                                                 WEIGHT MULTIPLICITIES FOR THE
arXiv:math/9809026v1 [math.RT] 6 Sep 1998




                                                 AFFINE KAC-MOODY ALGEBRAS A(1)
                                                                             r



                                                      Georgia Benkart∗ , Seok-Jin Kang† , Hyeonmi Lee† ,
                                                             Kailash C. Misra‡ , Dong-Uy Shin†



                                                                        ∗
                                                                       Department of Mathematics
                                                                         University of Wisconsin
                                                                   Madison, Wisconsin 53706-1388, USA
                                                                         benkart@math.wisc.edu

                                                                        †Department of Mathematics
                                                                         Seoul National University
                                                                            Seoul 151-742, Korea
                                                                          sjkang@math.snu.ac.kr
                                                                           hmlee@math.snu.ac.kr
                                                                          dushin@math.snu.ac.kr

                                                                      ‡Department of Mathematics
                                                                     North Carolina State University
                                                                Raleigh, North Carolina 27695-8205, USA
                                                                          misra@math.ncsu.edu


                                                  Abstract. We prove that the multiplicity of an arbitrary dominant weight
                                                  for an integrable highest weight representation of the affine Kac-Moody algebra
                                                    (1)
                                                  Ar is a polynomial in the rank r. In the process we show that the degree of
                                                  this polynomial is less than or equal to the depth of the weight with respect
                                                  to the highest weight. These results allow weight multiplicity information for
                                                  small ranks to be transferred to arbitrary ranks.

                                            ∗ Supported in part by NSF Grants #DMS-9300523 and #DMS-9622447
                                            † Supported by the Non-directed Research Fund, Korea Research Foundation, 1996
                                            ‡ Supported in part by NSA/MSP Grant #MDA904-96-1-0013


                                            1991 Mathematics Subject Classifications: 17B67, 17B65

                                                                                                                 Typeset by AMS-TEX
                                                                                        1
                                 Introduction

      The irreducible highest weight representations of affine Kac-Moody al-
gebras have played an increasingly important role in diverse areas of mathe-
matics and physics. When its level is positive, such a representation is infinite-
dimensional. It is parameterized by a dominant integral highest weight and has
finite-dimensional weight spaces. The formal character of such a representation
records the multiplicity of each weight, and the well-known Weyl-Kac charac-
ter formula ([K2, p. 173]) provides a precise expression for the character. The
character formula involves a sum over the Weyl group in both its numerator
and denominator which makes it impractical for explicitly computing multiplic-
ities. However, when the character formula is applied to the one-dimensional
trivial representation, it gives the denominator identity, and from the denom-
inator identity Peterson [P] has derived Freudenthal-type recursive formulas
for calculating root and weight multiplicities. These formulas enabled Kass,
Moody, Patera, and Slansky [KMPS] to develop tables of weight multiplicities
for certain weights of low level irreducible highest weight representations for
affine Kac-Moody algebras having rank less than 8.

      In 1987 while analyzing the weight multiplicities of the irreducible highest
weight representations of the untwisted classical affine Kac-Moody algebras,
Benkart and Kass (see [BK]) conjectured certain polynomial behavior for the
weight multiplicities of these representations and introduced the notion of a
“rank-zero string function”. The conjectures were confirmed in [BKM2] for
any irreducible highest weight representation of the affine Kac-Moody algebras
A(1)
 r for weights having depth ≤ 2. In fact, in [BKM2] the multiplicities of such
weights were given by explicit polynomials whose coefficients involve Kostka
numbers. However, it seems to be very difficult to extend the methods of
[BKM2], which were based on the root multiplicity formula for Kac-Moody
algebras obtained in [Ka2] and the representation theory of sl(r + 1, C), to
prove the conjecture for arbitrary depths.

      In this paper, we adopt a completely different approach to prove that the
multiplicity of an arbitrary dominant weight for an irreducible highest weight
representation of the affine Kac-Moody algebra     A(1)
                                                    r     is a polynomial in the
                                        2
rank r . Although the precise degree of these polynomials is not determined in
this work, an upper bound is obtained for the degree, and this upper bound
coincides with the degree conjectured by Benkart and Kass (see [BKM2], Con-
jecture A).

        Briefly, our argument proceeds as follows: Let L(λ) denote the irre-
                                                               Pr
ducible highest weight Ar -module with highest weight λ = i=0 ai Λi −
                            (1)


mδ , where Λ0 , Λ1 , · · · , Λr are the fundamental weights and δ is the null
root. We consider the minimal graded Lie algebra L with local part L(λ) ⊕
A(1)
  r ⊕ L (λ), where L (λ) is the finite dual space of L(λ) (see Section
          ∗                  ∗

2). Then L is isomorphic to the indefinite Kac-Moody algebra b        g associated to
the Cartan matrix A  b = (a )
                             i,j i,j =−1,0,1,··· ,r , whose first column consists of
the entries 2, −a0 , −a1 , · · · , −ar . When the first row and the first column
   b are deleted, the result is the Cartan matrix of the affine Kac-Moody al-
of A
gebra   A(1)
         r .   Now any weight      µ of L(λ) can be viewed as a root in bg, and
its multiplicity as a root of b
                              g is the same as its multiplicity as a weight of
L(λ).     We use Peterson’s recursive root multiplicity formula in conjunction
with a tricky inductive argument to establish the polynomial behavior of the
dominant weights of   L(λ).
        The proof of the polynomial conjecture permits much of the information
in [KMPS] to be extended to arbitrary ranks, and it provides a means of
relating string functions for various algebras. A better understanding of the
polynomial nature of the multiplicities for more general sequences of Kac-
Moody algebras (beyond the Ar case treated here) would allow results about
                                    (1)


multiplicities for affine algebras to be transferred to hyperbolic and indefinite
Kac-Moody algebras, where only very limited information is currently known.


                                  Acknowledgments

        Part of this work was completed while Seok-Jin Kang visited Yale Uni-
versity in February 1995 and University of Wisconsin-Madison in the summer
of 1995. He would like to express his sincere gratitude to the Mathematics
Departments of Yale University and the University of Wisconsin-Madison for
their hospitality. We are very grateful to George Seligman and Hye-Kyung Oh
                                          3
for their interest in this work and many valuable discussions.


              §1. The affine weight lattice and the conjecture

                   I = {0, 1, · · · , r}, and let A = (ai,j )i,j ∈I
        Suppose that                                                          be the affine
Cartan matrix of type Ar :
                        (1)


                                                                   
                        2 −1   0                0     ···     0 −1
                      −1  2 −1                 0     ···     0  0 
                                                                   
                      0 −1    2               −1     ···     0  0 
                                                                   
(1.1)                
                   A=  0  0  −1                2     ···     0  0 .
                      ... ..  ..               ..    ..      .. .. 
                           .   .                .       .     .  . 
                                                                    
                      0   0   0                  0   ···     2 −1 
                       −1  0   0                  0   ···    −1    2

Let h be a vector space over C with a basis {h0 , h1 , · · ·            , hr , d}.   Define
linear functionals   αi ∈ h∗ (i ∈ I ) by

(1.2)               αi (hj ) = aj,i     for   j ∈ I, αi (d) = δi,0 .

Then the triple (h, Π = {αi | i ∈ I }, Π∨ = {hi | i ∈ I }) provides a realization
of the matrix A in the sense of [K2, Chap. 1]. The Kac-Moody algebra g
associated with the affine matrix A is the affine Kac-Moody algebra of type
A(1)
 r .    We denote by ei , fi , hi (i ∈ I ) and d the generators of the algebra
g. The subalgebra g0 of g generated by ei , fi , hi (i = 1, · · · , r ) is a finite-
dimensional simple Lie algebra of type Ar which is isomorphic to the Lie
algebra sl(r + 1, C) of (r + 1) × (r + 1) complex matrices of trace zero.

        Let   c = h0 + h1 + · · · + hr .       Then [c, x] = 0 for all        x ∈ g, and c
is the canonical central element of g. Note that              {h1 , · · · , hr , c, d} forms
another basis of h. Since the matrix A is symmetric, there is a nondegenerate
symmetric bilinear form on h which satisfies

                       (hi |hj ) = ai,j for      i, j = 1, · · · , r,
(1.3)                  (hi |c) = (hi |d) = 0 for i = 1, · · · , r,
                       ( c| c) = ( d | d ) = 0 , ( c| d ) = 1 .
                                              4
Define linear functionals Λi ∈ h∗ (i ∈ I ) and     δ ∈ h∗ by
                          Λi (hj ) = δi,j , Λi (d) = 0,
(1.4)
                          δ (hj ) = 0, δ (d) = 1 for j ∈ I.
Then     δ   can be expressed as    δ   =     α0 + α1 + · · · + αr . It is easy to see
that    {Λ0 , Λ1 , · · · , Λr , δ } and {Λ0 , α0 , α1 , · · · , αr } are both bases of the
complex vector space h∗ , and

(1.5)           αi = −Λi−1 + 2Λi − Λi+1 + δi,0 δ (i mod r + 1).
                              P is defined to be P = ZΛ0 ⊕ ZΛ1 ⊕ · · · ⊕
        The affine weight lattice
ZΛr ⊕ Zδ, and the elements of P + = {λ ∈ P | λ(hi ) ∈ Z≥0 for all i ∈ I }
are the dominant integral weights for the algebra g. For λ, µ ∈ P , we say
that µ is related to λ, which we denote by µ ∼ λ, if λ − µ ∈ Q, where
      L
Q = ri=0 Zαi is the root lattice. For example, if µ ∈ P is a weight of the
irreducible highest weight module L(λ) over g with highest weight λ ∈ P ,
                      Lr
then λ − µ ∈ Q+ = i=0 Z≥0 αi , and hence µ is related to λ.

          l be a positive integer.
        Let                             A dominant integral weight      λ ∈ P + is said
to have level l > 0 if λ(c) = l .       The weight    λ can be uniquely expressed in
the form

(1.6)                 λ = a0 Λ0 + a1 Λ1 + · · · + ar Λr − mδ,
where m ∈ Z and ai ∈ Z≥0 for i = 0, 1, · · ·        , r. Since c = h0 + h1 +· · ·+ hr ,
we have

(1.7)                      λ(c) = a0 + a1 + · · · + ar = l.
        Let   µ∈P      be an integral weight and suppose       µ is related to λ.     We
write

(1.8)                  µ = b0 Λ0 + b1 Λ1 + · · · + br Λr − nδ,
where n ∈ Z and bi ∈ Z for i = 0, 1, · · ·    , r, and we set di = bi − ai (i ∈ I ).
                                                      Pr
Since µ is related to λ, we can write µ = λ − i=0 ki αi for some ki ∈ Z
(i = 0, 1, · · · , r ). Therefore, since αi (c) = 0 for all i, we must have

                           µ(c) = b0 + b1 + · · · + br = l,
                                             5
which implies

(1.9)                          d 0 + d 1 + · · · + d r = 0.

         Using the linear system

                                   r
                                   X
                 µ(hj ) = aj −           ki aj,i = bj    for   j = 0, 1, · · · , r,
(1.10)                             i=0
                 µ(d) = −m − k0 = −n,
we can solve for the   ki ’s to obtain
          k0 = n − m,
(1.11)    ki = n − m + di+1 + 2di+2 + · · · + (r − i)dr − (r − i + 1) rN
                                                                       +1
                      for i = 1, · · · , r,

where    N   = d1 + 2d2 + · · · + rdr . In particular,


                            kr = n − m − rN
                                          +1
                                             ∈ Z.

Thus

(1.12)            N   = d1 + 2d2 + · · · + rdr ≡ 0 mod            r + 1.
                                Pr
         Conversely, suppose µ=    i=0 bi Λi − nδ ∈ P is an integral weight
with bi ∈ Z (i ∈      I ) and n ∈Z which satisfies (1.9) and (1.12) for di =
                                               P
bi − ai (i ∈ I ). Then we can write µ = λ − ri=0 ki αi , where the ki are
given by (1.11). Hence µ is related to λ. Therefore, we obtain:

                                Pr
Proposition 1.13.        Let   λ  i=0 ai Λi − mδ (ai ∈ Z≥0 , m ∈ Z) be
                                   =
                                                    Pr
a dominant integral weight of level l , and let µ =  i=0 bi Λi − nδ ∈ P
(bi ∈ Z, n ∈ Z) be an integral weight. Then         µ is related to λ if and only if
                      d 0 + d 1 + · · · + d r = 0,
(1.14)
                      d1 + 2d2 + · · · + rdr ≡ 0        mod    r + 1,
                                            6
where    di = bi − ai (i ∈ I ).

                                l and a dominant integral weight λ of level l
         Now fix a positive integer
given by (1.6). Since λ(c) = a0 + a1 + · · · + ar = l , there must be a gap in
the expression (1.6) for λ if r ≥ l . That is, there exist nonnegative integers
s and t with s + t ≤ r such that

(1.15)         as−1 6= 0, ar−t+1 6= 0, as = as+1 = · · · = ar−t = 0.

         The viewpoint we adopt here is that the weight        λ   is completely de-
termined by the following data: (i) an     s-tuple of nonnegative integers a =
(a0 , a1 , · · · , as−1 ) with as−1 6= 0, (ii) a t-tuple of nonnegative integers
a′ = (ar−t+1 , ar−t+2 , · · · , ar ) with ar−t+1 6= 0, and (iii) an integer m.
Note that this determining data is independent of r . Thus, dominant inte-
gral weights will be regarded as the same for all r ≥ l provided they have
the same determining data. It is important to observe that a different choice
of gap in expression (1.6) yields a different weight. For example, consider
λ   = 2Λ2 + Λ4 −      δ     r = 5. If we take s = 5 and t = 0, then the
                          when
determining data for λ is a = (0, 0, 2, 0, 1), a′ = ∅, m = 1, and λ can
be written as λ = 2Λ2 + Λ4 − δ for all r ≥ 5. On the other hand, we can
choose a different gap by taking s = 3, t = 2. In this case, the determining
data for λ is a = (0, 0, 2), a′ = (1, 0), m = 1, and λ can be expressed as
λ = 2Λ2 + Λr−1 − δ for all r ≥ 5.
         Suppose the dominant integral weight     λ is given by the determining
data a = (a0 , a1 , · · · , as−1 ), a = (ar−t+1 , ar−t+2 , · · · , ar ), and m.
                                      ′
            Pr
Let µ = i=0 bi Λi − nδ (bi ∈ Z≥0 , n ∈ Z) be a dominant integral weight
of level l . Then µ(c) = b0 + b1 + · · · + br = l , and if r ≥ l , there must be a
gap in the expression (1.8) for µ. Moreover, if r ≥ l + s + t, then the gap of
λ is sufficiently large that there exists a gap of µ which overlaps the gap of λ.
                                                                                ′
As a result, we can associate determining data b = (b0 , b1 , · · · , bs −1 ), b =
                                                                          ′


(br−t +1 , br−t +2 , · · · , br ), and n ∈ Z to µ, where bs −1 6= 0, br−t +1 6= 0,
         ′        ′                                        ′                  ′


and s′ , t′ are nonnegative integers satisfying s′ + t′ ≤ r , s + t′ ≤ r , and
s′ + t ≤ r. Hence, if we let p = max(s, s′ ) and q = max(t, t′), the weights
                                          7
λ and µ share a common gap:
                           ap = ap+1 = · · · = ar−q = 0,
(1.16)
                           bp = bp+1 = · · · = br−q = 0.
(Note that   p ≤ r − t and s ≤ r − q .)
         From now on we assume that    r ≥ l + s + t. If µ is related to λ for
infinitely many values of r ≥ l + s + t, then the congruence equation (1.14)
holds for all those values of r . Hence,



               N   = d1 + 2d2 + · · · + rdr
                                                      
                   =   d1 + 2d2 + · · · + (p − 1)dp−1
(1.17)                                                                  
                       − qdr−q +1 + (q − 1)dr−q +2 + · · · + 2dr−1 + dr
                                                                 
                        + (r + 1) dr−q +1 + dr−q +2 + · · · + dr

is divisible by   r + 1 for all such values of r, which implies


(1.18)     d1 + 2d2 + · · · + (p − 1)dp−1 = qdr−q +1 + · · · + 2dr−1 + dr .

         We now define

               dλ(µ) = n − m − (d1 + 2d2 + · · · + (p − 1)dp−1 )
(1.19)
                     = n − m − (qdr−q +1 + · · · + 2dr−1 + dr ),

and refer to   dλ (µ) as the depth of µ with respect to λ. It follows from (1.11)
and (1.19) that
                
                 di+1 + 2di+2 + · · · + (p − i − 1)dp−1 + dλ (µ)
                
                
                
                
                
                
                
                         for i = 0, 1, · · · , p − 2,
                
(1.20)     ki =  dλ (µ) for i = p − 1, p, · · · , r − q, r − q + 1,
                
                
                
                 (i − (r − q + 1))dr−q +1 + · · · + 2di−2 + di−1 + dλ (µ)
                
                
                
                
                
                          for i = r − q + 2, · · · , r − 1, r.
                                          8
       For i = 0, 1, · · · , r , let mi = ki − dλ (µ), and define µ0 = λ −
Pr
   i=0 mi αi . Then µ = µ0 − dλ (µ)δ and dλ (µ0 ) = 0. Note that µ(hi ) =
µ0 (hi ) = bi for all i = 0, 1, · · · , r. By (1.20), we obtain
                     
                     
                     
                     
                         di+1 + 2di+2 + · · · + (p − i − 1)dp−1
                     
                     
                     
                     
                     
                                  for i = 0, 1, · · · , p − 2,
                     
(1.21)       mi =  0 for i = p − 1, p, · · · , r − q, r − q + 1,
                     
                     
                     
                        (i − (r − q + 1))dr−q +1 + · · · + 2di−2 + di−1
                     
                     
                     
                     
                     
                                   for i = r − q + 2, · · · , r − 1, r.

In particular, the values of   mi ’s do not depend on r.
   To summarize the above discussion, we have

Proposition 1.22. Let λ ∈ P + be a dominant integral weight of level l       >0
with determining data a = (a0 , a1 , · · · , as−1 ), a = (ar−t+1 , ar−t+2 , · · · , ar ),
                                                       ′

and m ∈ Z. Assume that r ≥ l + s + t and that µ is a dominant inte-
                                                                              ′
gral weight of level l with determining data b = (b0 , b1 , · · · , bs −1 ), b =
                                                                           ′


(br−t +1 , br−t +2 , · · · , br ), and n ∈ Z such that s′ + t′ ≤ r , s + t′ ≤ r ,
      ′          ′


and s′ + t ≤ r . If µ is related to λ for infinitely many values of r ≥
l + s + t, then µ can be uniquely written as µ = µ0 − dλ (µ)δ , where
                           P
dλ (µ) and µ0 = λ − ri=0 mi αi are determined by (1.19) and (1.21) for
di = bi − ai (i ∈ I ), and dλ (µ0 ) = 0.
   The following lemma plays an important role in proving our main theorem
(Theorem 3.4).

Lemma 1.23. Let       λ ∈ P + be a dominant integral weight of level l > 0 with
determining data a = (a0 , a1 , · · · , as−1 ), a′ = (ar−t+1 , ar−t+2 , · · · , ar ),
and m ∈ Z. Assume that r ≥ l + s + t. Let µ ∈ P + be a dominant in-
                                                                                  ′
tegral weight of level l with determining data b = (b0 , b1 , · · · , bs −1 ), b =
                                                                           ′


(br−t +1 , br−t +2 , · · · , br ), and n ∈ Z such that s′ + t′ ≤ r, s + t′ ≤ r ,
      ′          ′


and s′ + t ≤ r . Let τ ∈ P + be a dominant integral weight of level l with de-
termining data c = (c0 , c1 , · · · , cs −1 ), c′ = (cr−t +1 , cr−t +2 , · · · , cr ),
                                        ′′                 ′′         ′′


n′ ∈ Z satisfying s′′ + t′′ ≤ r, s + t′′ ≤ r, and s′′ + t ≤ r. If µ ≤ τ ≤ λ,
then dλ (τ ) ≤ dλ (µ).
                                             9
Proof. By Proposition 1.22,         µ and τ    can be expressed as follows:
                                       r
                                       X
                           µ=λ−              mi αi − dλ (µ)δ,
                                       i=0
                                       r
                                       X
                           τ     =λ−         m′i αi − dλ (τ )δ.
                                       i=0
The condition      τ   ≥ µ implies


                           r
                           X
(1.24)           τ −µ=           (mi − m′i )αi + (dλ (µ) − dλ (τ ))δ ∈ Q+ .
                           i=0
Since    aj = 0 for all j = s, s + 1, · · · , r − t, we have
(1.25)           d′j = cj − aj = cj ≥ 0        for all   j = s, s + 1, · · · , r − t.
     Let p = max(s, s′ ), q = max(t, t′), x = max(s, s′′ ), and y = max(t, t′′ ).
Recall that x ≤ r − t and s ≤ r − y , and assume that i ∈ {s − 1, s, · · · , r −
t, r − t + 1}. It suffices to consider the following three cases:
(i) s −1 ≤ i ≤ x −2, (ii) x −1 ≤ i ≤ r − y +1, (iii) r − y +2 ≤ i ≤ r − t +1.

If   s − 1 ≤ i ≤ x − 2, then since x ≤ r − t, it follows from (1.21) and (1.25)
that
             m′i = d′i+1 + 2d′i+2 + · · · + (x − i − 1)d′x−1 ≥ 0.
If x − 1 ≤ i ≤ r − y + 1, then by (1.21) m′i = 0. Finally, if r − y + 2 ≤ i ≤
r − t + 1, then because s ≤ r − y , (1.21) and (1.25) yield
              m′i = (i − (r − y + 1))d′r−y+1 + · · · + 2d′i−2 + d′i−1 ≥ 0.
Therefore,m′i ≥ 0 for all i = s − 1, s, · · · , r − t, r − t + 1. In particular,
since p ≥ s, q ≥ t, we conclude that m′i ≥ 0 for all i = p − 1, p, · · · , r −
q, r − q + 1.
         Observe that in (1.24) the coefficient of          αi   in   τ   −   µ   for   i   =   p−
1, p, · · ·   , r − q, r − q + 1 is
(1.26)                      −m′i + dλ (µ) − dλ (τ ) ≥ 0.
                                              10
Since m′i ≥ 0 for i      =   p − 1, p, · · · , r − q, r − q + 1,    it must be that
dλ (τ ) ≤ dλ (µ).          

        The following is a more detailed formulation of a conjecture presented
in [BK].


Conjecture. Let      λ ∈ P + be a dominant integral weight of level l > 0 with
determining data a = (a0 , a1 , · · · , as−1 ), a′ = (ar−t+1 , ar−t+2 , · · · , ar ),
and m ∈ Z. Assume that r ≥ l + s + t + 2, and let L(λ) be the irreducible
highest weight module over the affine Kac-Moody algebra g of type Ar with
                                                                             (1)


highest weight λ. Let µ ∈ P + be a dominant integral weight of level l with
                                                  ′
determining data b = (b0 , b1 , · · · , bs −1 ), b = (br−t +1 , br−t +2 , · · · , br ),
                                           ′                 ′         ′


and n ∈ Z such that s′ + t′ ≤ r , s + t′ ≤ r , and s′ + t ≤ r . Suppose that µ
is related to λ for infinitely many values of r ≥ l + s + t + 2. If µ is a weight
of the g-module L(λ) for some r0 ≥ l + s + t + 2, then it is a weight of L(λ)
for all r ≥ r0 , and the multiplicity of µ in L(λ) is given by a polynomial
in r of degree dλ (µ). If dλ (µ) < 0, then the multiplicity of µ in L(λ) is
zero.


        In Section 3, we will prove a weaker version of the above conjecture. We
will show that the multiplicity of     µ in L(λ) is given by a polynomial in r
of degree ≤ dλ (µ). Our approach is to apply Peterson’s formula to a certain
indefinite Kac-Moody algebra L which will be constructed in the next section.


                 §2. The indefinite Kac-Moody algebra L

        Recall that the Cartan subalgebra h of the affine Kac-Moody algebra g of
type Ar has the basis {h1 , · · ·    , hr , c, d}, where c = h0 + h1 + · · · + hr is
         (1)


the canonical central element, and there is a nondegenerate symmetric bilinear
form ( | ) on g whose values on h are given by (1.3). Since the form ( | )
is nondegenerate on h, for every       µ   ∈ h∗ there is a unique element       tµ   in
h such that    µ(h)   = (h|tµ ) for all    h    ∈ h. Thus the form ( | ) induces a
nondegenerate symmetric bilinear form on h∗ , also denoted by ( | ), defined by
(µ|ν ) = (tµ |tν ) for all   µ, ν   ∈ h∗ . In particular, tδ = c. We take a basis
                                           11
for h and extend it to a basis {xi | i ∈ Ω} of g by adding basis elements for
each of the root spaces gα . Since (gα |gβ ) = 0 unless β = −α, the dual basis
{yi | i ∈ Ω} of g with respect to the form ( | ) also consists of vectors in h and
root vectors.
                       Pr
        Assume   λ=      i=0 ai Λi − mδ is a dominant integral weight of level
l>      0 for g as in Section 1. Let L(λ) be the irreducible highest weight g-
module with highest weight    λ.   The finite dual space       L∗(λ) is the irreducible
lowest weight g-module with lowest weight −λ, where the g-module action is
given by

(2.1)                     hg · v ∗ , w i = −hv ∗ , g · w i

forg ∈ g, v ∗ ∈ L∗ (λ), w ∈ L(λ) (see [K2, p.                149]). Define a linear map
ψ : L∗(λ) ⊗ L(λ) → g by
                                        2        X
(2.2)              ψ (v ∗ ⊗ w ) = −                  hv ∗ , xi · w iyi ,
                                      (λ|λ)
                                                 i∈Ω

where {xi | i ∈ Ω} and {yi | i ∈ Ω} are dual bases of g as above. Then ψ is
a well-defined g-module homomorphism, (compare with [FF], [Ka1], [BKM1]),
and hence the space L(λ) ⊕ g ⊕ L∗ (λ) has the structure of a local Lie algebra
with the bracket defined by

                       [v ∗ , w ] = ψ (v ∗ ⊗ w ),
(2.3)
                       [g, w ] = g · w, [g, v ∗ ] = g · v ∗

for   g ∈ g, v ∗ ∈ L∗ (λ), w ∈ L(λ) (see [K1]).
        Let F+ (resp. F− ) be the free Lie algebra generated by            L∗ (λ) (resp.
L(λ)), and for k ≥ 1, let Fk (resp.     F−k ) be the subspace of F+ (resp. F− )
spanned by the vectors of the form [u1 [u2 [· · · [uk−1 , uk ] · · · ]]] with     uj   ∈
L∗ (λ) (resp. L(λ)).      In particular, F1 =          L∗ (λ) and   F−1 =   L(λ).   Let
F0 = g and define
                                                       M
                         F = F− ⊕ F0 ⊕ F+ =                  Fk .
                                                       k∈Z
Then F is the maximal graded Lie algebra with local part L(λ) ⊕ g ⊕ L∗ (λ).
                                            12
        For   k ≥ 2, define the subspaces J±k of F±k by
(2.4) J±k = {v ∈ F±k | [u1 [u2 [· · · [uk−1 , v ] · · · ]]] = 0 for all      ui ∈ F∓1 },
                 L
and let J± =      k≥2 J±k . Then J± is a graded ideal of F± , and J = J− ⊕J+ is
the maximal graded ideal of F which intersects the local part L(λ)⊕g⊕L∗ (λ)
                                                                      L
trivially ([K1], [FF], [Ka1], [BKM1]). The Lie algebra L = F /J = k∈Z Lk
is the minimal graded Lie algebra with local part L(λ) ⊕ g ⊕ L∗ (λ), where
Lk = Fk /Jk for k ∈ Z. In particular, L−1 = F−1 =                    L(λ), L0    = g, and
L1 = F1 = L∗ (λ).

        Alternately, let  α−1 = −λ and consider the Cartan matrix Ab = (ai,j )
(i, j = −1, 0, 1, · · · , r ) given by

                          2(α |α )
(2.5)              ai,j = (α i|α j)     for    i, j = −1, 0, 1, · · · , r.
                             i i

The first column of the matrix Ab consists of the entries 2, −a0 , −a1 , · · · ,
−ar , and deleting the first row and the first column of A b gives the affine
Cartan matrix of type      A(1)
                            r .   If we let

                                                   2tλ
                                   h−1 = −                 ,
                                                   (λ|λ)

where tλ ∈ h is such that λ(h) = (h|tλ ) for all h ∈ h, then the triple
(h, Π = {α−1 , α0 , α1 , · · · , αr }, Π∨ = {h−1 , h0 , h1 , · · · , hr }) provides
a realization of the matrix A. b Let b  g be the indefinite Kac-Moody algebra
                                  b It is a direct consequence of the Gabber-
associated with the Cartan matrix A.
Kac theorem (see [GK]) that the following holds:

Proposition 2.6. ([FF], [Ka1], [BKM1]) Let                 v0 (resp. v0∗ ) be the highest
(resp. lowest) weight vector of     L(λ) (resp.          L∗ (λ)) such that hv0∗, v0i = 1.
If b
   g is the indefinite Kac-Moody algebra with the Cartan matrix A  b given by
                                                    g∼
(2.5), then there is an isomorphism of Lie algebras b = L defined by

               ei 7→ ei , fi 7→ fi , hi 7→ hi     i = 0, 1, · · · , r,
                                                           for
(2.7)                                            2t
               e−1 7→ v0∗ , f−1 7→ v0 , h−1 7→ − λ .
                                                (λ|λ)
                                              13
       It follows from Proposition 2.6 that the subspace L±k is the sum of all
                                                           Pr
the root spaces b g±α , where α is of the form ±(kα−1 + i=0 ki αi ) with
                                                      P
k, ki ∈ Z≥0 . In particular, the roots of the form ±( ri=0 ki αi ) are roots of
                                                                  Pr
the affine Kac-Moody algebra g, and the roots of the form −α−1 − i=0 ki αi
are weights of the irreducible highest weight g-module L(λ). Thus to compute
                                Pr
the weight multiplicity of λ − i=0 ki αi in L(λ), it suffices to compute the
                               Pr
root multiplicity of −α−1 − i=0 ki αi in the indefinite Kac-Moody algebra
L∼=b g.


                 §3. The weight multiplicity polynomials


      In this section, we will prove our main result. Fix a positive integer
l and a dominant integral weight λ of level l with determining data a =
(a0 , a1 , · · · , as−1 ), a′ = (ar−t+1 , ar−t+2 , · · · , ar ), and m ∈ Z. Assume
that r ≥ l + s + t + 2, and let L(λ) be the irreducible highest weight
module over the affine Kac-Moody algebra g = Ar with highest weight λ.
                                                           (1)


Suppose µ is a dominant integral weight of level l with determining data
                                ′
b = (b0 , b1, · · · , bs −1 ), b = (br−t +1 , br−t +2 , · · · , br ), and n ∈ Z, where
                      ′                 ′         ′


s′ , t′ are nonnegative integers satisfying s′ + t′ ≤ r, s + t′ ≤ r, and s′ + t ≤
r. Since the determining data associated to λ and µ is fixed, the integers
s, t, s′, t′ are all fixed. In particular, the integers p = max(s, s′ ) and q =
max(t, t′ ) are fixed also. Suppose further that µ is related to λ for infinitely
many values of r ≥ l + s + t + 2. Our aim is to prove that if µ is a weight of
L(λ) for some r0 ≥ l + s + t + 2, then it is a weight of L(λ) for all r ≥ r0 ,
and the multiplicity of µ in L(λ) is a polynomial in r of degree ≤ dλ (µ),
the depth of µ with respect to λ.

       Let L ∼
             =b g be the minimal graded Lie algebra with local part L(λ) ⊕
                                          c     Lr
g ⊕ L∗ (λ) constructed in Section 2. Let Q = i=−1 Zαi denote the root
lattice of b
           g with respect to the Cartan subalgebra h. The roots of b  g belong
    c      c            c       Lr                 c
to Q+ ∪ Q− , where Q+ =           i=−1 Z≥0 αi = −Q− . Furthermore, µ =
     Pr                      Pr            c
λ − i=0 ki αi = −α−1 − i=0 ki αi ∈ Q         − , where the coefficients ki are

as in (1.20). The weight multiplicity of µ in L(λ) is the same as the root
                                            14
multiplicity mult(µ) of    µ in L, which can be computed using the following
Freudenthal-type recursive formula due to Peterson.
                                                                                  c
Proposition 3.1. ([P], cf. [K2, Exercise 11.12])                      For       β∈Q − , define

                                                                 !
                            cβ =
                                     X 1                       β .
                                     n≥1
                                               n mult          n
Then
                                               X
(3.2)            (β |β + 2ρ)cβ =                          (β ′ |β ′′ )cβ ′ cβ ′′ ,
                                                    c
                                         β ′ ,β ′′ ∈Q −
                                         β =β +β ′′
                                                 ′




where   ρ ∈ h∗ is such that ρ(hi ) = 1 for i = −1, 0, · · · , r.
                                                               Pr
        We write µ = µ0 −dλ (µ)δ , where dλ (µ) and µ0 = −α−1 − i=0 mi αi
are given by (1.19) and (1.21). Since the coefficient of                       α−1   in   µ is −1, any
decomposition is of the form    µ=β        ′
                                               + β , where
                                                    ′′


                               r
                               X                                          r
                                                                          X
               β ′ = −α−1 −          si αi ,        and        β ′′ = −         ti α i
                               i=0                                        i=0

with  si , ti ∈ Z≥0 or it has the form with the roles of β ′ and β ′′ switched.
Note that cµ = mult(µ) and cβ = mult(β ′ ), where mult(·) is the multiplicity
                                     ′

in L, which, for µ and β ′ , is the same as the multiplicity in L(λ). Thus, in
order to have a nontrivial contribution to cβ and cβ , β ′ must be a weight
                                                           ′              ′′

of L(λ) and β ′′ = −kα for some k ≥ 1, where α is a positive root of g.

Lemma 3.3. Suppose dλ (µ) > 0. Then (µ|µ + 2ρ) is a polynomial in r
of degree 1.
                          Pr
Proof. Since   µ = −α−1 −   i=0 mi αi − dλ (µ)δ , we have
                       Xr                             Xr
(µ|µ + 2ρ) = (−α−1 −       mi αi − dλ (µ)δ | − α−1 − mi αi − dλ (µ)δ + 2ρ)
                       i=0                            i=0
                        Xr            Xr        X r
  = −2dλ (µ)(r + 1) − 2     mi a i − 2 mi +           mi mj ai,j − 2ldλ(µ)
                        i=0           i=0      i,j =0
      + (α−1 |α−1 ) − 2(ρ|α−1 ).
                                               15
                      Pr            Pr         Pr
By (1.21), the terms    i=0 mi ai ,   i=0 mi ,   i,j =0 mi mj ai,j are all
constants. Therefore (µ|µ + 2ρ) is a polynomial in r of degree 1.     

        We now state and prove our main result.

Theorem 3.4. Let g be the affine Kac-Moody algebra of type               A(1)
                                                                          r , and let
λ ∈ P+        be a dominant integral weight of levell > 0 for g with determin-
ing data a = (a0 , a1 , · · · , as−1 ), a = (ar−t+1 , ar−t+2 , · · · , ar ), and
                                             ′

m ∈ Z. Assume that r ≥ l + s + t + 2, and let µ ∈ P + be a dominant
                                                                                  ′
integral weight of level l with determining data b = (b0 , b1 , · · · , bs −1 ), b =
                                                                             ′


(br−t +1 , br−t +2 , · · · , br ), and n ∈ Z such that s′ + t′ ≤ r, s + t′ ≤ r ,
        ′             ′


and s′ + t ≤ r . Suppose that µ is related to λ for infinitely many values of
r ≥ l + s + t + 2. If µ is a weight of L(λ) for some r0 ≥ l + s + t + 2,
then it is a weight of L(λ) for all r ≥ r0 , and the multiplicity of µ in L(λ)
is given by a polynomial in r of degree ≤ dλ (µ).

Proof. We will prove our assertion by induction on       dλ (µ) and on the partial
                                                                  P
ordering on the affine weight lattice. Write          µ = −α−1 − ri=0 mi αi −
dλ (µ)δ , where dλ (µ) and the mi ’s are given by (1.19) and (1.21).
        If dλ (µ) < 0, then for i = p −1, p, · · ·, r − q, r − q +1, the coefficient
of αi in µ is positive.       Hence µ cannot be a weight of L(λ), and therefore
its multiplicity in L(λ) is zero.

        Let   p = max(s, s′ ), q = max(t, t′).      Suppose that    dλ (µ) = 0.   Then

                                 p
                                 X−2                 r
                                                     X
                          µ=λ−          mi α i −              mi α i .
                                  i=0              i=r−q +2

     The multiplicity of µ in L(λ) is the number of linearly independent vectors
of the form  fi fi · · · fik · v0 , where v0 is the highest weight vector of L(λ)
                  1       2

and fj appears mj times in the expression for each j ∈ {0, 1, · · · , p − 2, r −
q + 2, r − q + 3, · · · , r}. Clearly, this number is independent of r (it may be
0). In particular, if this number is nonzero for some r0 ≥ l + s + t + 2, then
it is nonzero and constant for all r ≥ r0 . Therefore, if µ is a weight of L(λ)
for some r0 ≥ l + s + t + 2, then it is a weight of L(λ) for all r ≥ r0 , and the
                                            16
multiplicity ofµ is a constant. The same argument shows that any τ ∈ P
such that dλ (τ ) = 0 has a constant multiplicity (which may be 0) in L(λ).

        Suppose  dλ (µ) ≥ 1. Consider a dominant integral weight τ of level l
with determining data c = (c0 , c1 , · · · , cs −1 ), c′ = (cr−t +1 , cr−t +2 , · · · , cr ),
                                                     ′′                 ′′         ′′


and n′ ∈ Z such that s′′ + t′′ ≤ r, s + t′′ ≤ r , and s′′ + t ≤ r which is related
to λ for infinitely many values of r ≥ l + s + t +2, and write τ = τ0 − dλ (τ )δ ,
where dλ (τ0 ) = 0. Assume that if dλ (τ ) < dλ (µ) or if dλ (τ ) = dλ (µ)
and τ0 > µ0 , our assertion holds for τ . That is, we assume that if τ is a
weight of L(λ) for some r0 ≥ l + s + t + 2, then it is a weight of L(λ) for
all r ≥ r0 , and the multiplicity of τ in L(λ) is a polynomial in r of degree
≤ dλ (τ ).

        Consider a decomposition           µ = β ′ + β ′′ , where β ′   ∈ −α−1 − Q− =
λ − Q− and β ′′ is a multiple of a negative root of g.              Thus we may assume
that β ′′ is one of the following:

(3.5)    (i) − kδ, (ii) − kγ, (iii) − k (k ′ δ + γ ), (iv) − k (k ′ δ − γ ),

where   k, k ′ ≥ 1 and γ is a positive root of g0 = Ar .
        Note that   β ′′ = −kδ          is an imaginary root of g for all    k ≥ 1, and its
multiplicity in g (and hence in L) is          r (see [K1, Cor.   7.4]). It follows that

                         X mult(−kδ/m)                    X mult(−(k/m)δ )
            c−kδ =                        m          =
                                                                     m
                         m≥1                              m| k
(3.6)
                    =
                         X       r = ξ (k ) r,
                                 m     k
                         m| k

where   ξ (k ) denotes the sum of all factors of k . On the other hand, the roots
γ , k ′δ ± γ are real, and their multiplicities in g (and hence in L) are all 1.
Moreover, if k ≥ 2, the multiplicities of kγ and k (k ′ δ ± γ ) in g are all 0.
Therefore we have
                             1
(3.7)          cβ        =       if   β ′′ = −kγ or β ′′ = −k (k ′δ ± γ ).
                             k
                    ′′




        We now treat the four cases separately.
                                                17
Case 1. Suppose first that        β ′′ = −kδ for k ≥ 1.    In this case,

                                  r
                                  X                              c
               β   ′
                       = −α−1 −         mi αi − (dλ (µ) − k )δ ∈ Q −.
                                  i=0

Since mi = 0 for i = p−1, p, · · · , r −q, r −q +1, we must have dλ (µ)−k ≥
                                c
0 in order for β ′ to belong to Q− , which implies that k runs from 1 to dλ (µ).
Now
                                        r
                                        X
          (β ′ |β ′′ ) = (−α−1 −            mi αi − (dλ (µ) − k )δ | − kδ )
                                     i=0
                        = k (α−1 |δ ) = −kl,

where l denotes the level. As we have seen before, if β ′ is not a weight of L(λ),
then cβ ′ = 0 and there is no contribution to the right-hand side of (3.2). So
we may assume that β ′ is a weight of L(λ) for some r0 ≥ l + s + t + 2.
Observe that   β ′ is dominant since β ′ (hj ) = µ(hj ) ≥ 0 for all j ∈ I . Since
β ′ is related to λ for infinitely many values of r ≥ l + s + t + 2, and since
dλ (µ) − k < dλ (µ), it follows from the induction hypothesis that β ′ is a
weight of L(λ) for all r ≥ r0 , and mult(β ′ ) is a polynomial in r of degree
≤ dλ (µ) − k ≤ dλ (µ) − 1. We have seen in (3.6) that cβ = rξ (k )/k ,
                                                                     ′′

which is a polynomial in r of degree 1. Therefore, the total contribution of
the various decompositions of this kind to the right-hand side of (3.2) is a
polynomial in   r of degree ≤ dλ (µ).
Case 2.           β ′′ = −kγ for k ≥ 1, where γ is a positive root of
            Suppose
g0 = Ar . Thus γ = αu + αu+1 + · · · + αv with 1 ≤ u ≤ v ≤ r . In this
case, we have

                                  r
                                  X                            c
               β ′ = −α−1 −             mi αi + kγ − dλ (µ)δ ∈ Q −.
                                  i=0

                i = u, u + 1, · · · , v , the coefficient of αi in β ′ must be
Note that for all
≤ 0. That is, −mi + k − dλ (µ) ≤ 0 for i = u, u + 1, · · · , v . Let M =
max{mi | 0 ≤ i ≤ r }. Then k ≤ M + dλ (µ), and hence k ranges from 1
                                              18
to M + dλ (µ). Note that M is independent of the value of r . We also have

                                       r
                                       X
            (β |β ) = (−α−1 −
                ′   ′′
                                             mi αi + kγ − dλ(µ)δ | − kγ )
                                       i=0
                                                  r
                                                  X
                         = k (α−1 |γ ) + k              mi ( α i | γ ) − k 2 ( γ | γ ) .
                                                  i=0

Hence (β ′ |β ′′ ) is a constant for each            k,    because (λ|αi ) = −ai = 0 and
mi = 0 for i = p, p + 1, · · · , r − q ,
        Now by (1.5), γ = αu + αu+1 + · · · + αv = −Λu−1 + Λu + Λv − Λv +1 .
Observe that


  ru−1 (−Λu−1 + Λu + Λv − Λv +1 ) = −Λu−2 + Λu−1 + Λv − Λv +1 ,                                and


      rv +1 (−Λu−1 + Λu + Λv − Λv +1 ) = −Λu−1 + Λu + Λv +1 − Λv +2 ,

where ri denotes the simple reflection corresponding to the root αi . Therefore
for each    r ≥ l + s + t + 2, we apply the simple reflections ru−1 , ru−2 , · · · ,
r1 , r0 , rr , · · · and then rv +1 , rv +2 , · · · , rr , r0 , r1 , · · · in succession to get a
dominant integral weight. (It may take several rounds of applying the simple
reflections in this order to produce a dominant integral weight.) Let wr denote
the corresponding Weyl group element of                  A(1)
                                                          r .    We can verify that        wr β ′ has
the form
                                           r
                                           X
                            wr β   ′
                                       =         b′i (r)Λi − n′ (r)δ,
                                           i=0

where  b′i (r) = 0 for i = p + 1, · · · , r − q − 1. Moreover, it is tedious but
straightforward to show that the sequences of integers c(r ) = (b′0 (r ), b′1 (r ), · · · , b′p (r );
b′r−q (r), b′r−q +1(r), · · · , b′r (r); n′(r)) are the same for all r ≥ l + s + t +2.
That is, the determining data of wr β ′ is given by c = (b′0 , b′1 , · · · , b′x ),
c′ = (b′r−y , b′r−y+1 , · · · , b′r ), and n′ ∈ Z, where x ≤ p, y ≤ q and
b′i = b′i (r), n′ = n′ (r) (for all r ≥ l + s + t + 2). Rather than writing
wr β ′ in what follows, we denote the dominant weight determined by this
data as τ .
                                                   19
   Since      τ             λ, τ also has level l, and if we let d′i = b′i − ai for
                  is related to
i = 0, 1, · · · , r, then ai = b′i = d′i = 0 for i = p + 1, p + 2, · · · , r − q − 1.
Hence we may write

                                                  r
                                                  X
                                  τ    = −α−1 −         m′i αi − dλ(τ )δ,
                                                  i=0
                Pr
where −α−1 −       i=0 mi αi has depth 0 with respect to λ. In addition, since
                         ′

τ is the highest element among the Weyl group conjugates of β ′ , the inequality
µ < β′ ≤ τ              must hold, and hence

                                  r
                                  X                                           c
(3.8)             τ −µ=                 (mi − m′i )αi + (dλ (µ) − dλ (τ ))δ ∈ Q+ ,
                                  i=0

and
                                r
                                X                                                c
(3.9)         τ −β      ′
                            =         (mi − m′i )αi − kγ + (dλ (µ) − dλ (τ ))δ ∈ Q+ .
                                i=0

By the same argument as in Lemma 1.23, we can show that         m′i ≥ 0 for all
i = p − 1, p, · · · , r − q, r − q + 1, and hence dλ (τ ) ≤ dλ (µ).
        dλ (τ ) = dλ (µ), then m′i ≤ 0 by (1.26), and hence m′i = 0 for
         If
i = p − 1, p, · · · , r − q, r − q + 1. Since mi = 0 for i = p − 1, p, · · · , r −
q, r − q + 1, (3.9) can be written as
                            p
                            X−2                              r
                                                             X                          c
(3.10)    τ −β      ′
                        =         ( mi − mi ) α i +
                                              ′
                                                                   (mi − m′i )αi − kγ ∈ Q+ .
                            i=0                         i=r−q +2

                                               c
Thus, in order for τ − β ′ to be an element of Q+ , γ must be a linear combina-
tion of the simple roots α1 , α2 , · · · , αp−2 , or of αr−q +2 , · · · , αr−1 , αr .
                                        (p − 2)(p − 1) (q − 1)q
The number of such γ is at most                         +             , which is in-
                                              2              2
dependent of r . Since τ > µ and dλ (τ ) = dλ (µ), we have τ0 > µ0 .
Hence by the induction hypothesis, if wr β ′ is a weight of L(λ) for some
                                                             0

r0 ≥ l + s + t + 2, then τ = wr β ′ is a weight of L(λ) for all r ≥ r0 ,
and mult(β ′ ) = mult(τ ) is a polynomial in r of degree ≤ dλ (µ). Note that
                                                        20
cβ   ′′       = 1/k for all         k = 1, · · · , M + dλ (µ).        Therefore, the contribution of
these partitions to the right-hand side of (3.2) is a polynomial in                               r of degree
≤ dλ (µ).

              Suppose that dλ (τ ) < dλ (µ). By the induction hypothesis, if wr0 β ′
is a weight of  L(λ) for some r0 ≥ l + s + t + 2, then τ = wr β ′ is a
weight of L(λ) for all r ≥ r0 , and mult(β ′ ) = mult(τ ) is a polynomial
of degree ≤ dλ (τ ) ≤ dλ (µ) − 1. Since there are
                                                       r(r + 1) positive roots
                                                          2
in g0 = Ar , a polynomial in r of degree 2, and since cβ = 1/k for all                   ′′

k = 1, · · · , M + dλ (µ), the contribution of these decompositions to the
right-hand side of (3.2) is a polynomial in r of degree ≤ dλ (µ) + 1.

              Therefore, the total contribution of the partitions in Case 2 to the right-
hand side of (3.2) is a polynomial in                  r of degree ≤ dλ (µ) + 1.
Case 3.               Suppose that       β ′′   = −k (k ′ δ + γ ), where        k, k ′    ≥ 1 and     γ   is a
positive root of g0 = Ar . In this case,
                                        r
                                        X
                     β ′ = −α−1 −             mi αi + k (k ′δ + γ ) − dλ (µ)δ
                                        i=0
                                        Xr
                                                                             c
                       = −α−1 −               mi αi + kγ − (dλ(µ) − kk ′)δ ∈ Q −.
                                        i=0

Observe that the coefficient of         α0 in β ′ is −m0 − dλ (µ) + kk ′, which
must be ≤ 0.              Thus kk ′ ≤ m0 + dλ (µ), and hence k, k ′ range from 1 to
m0 + dλ(µ).               We have
                                      r
                                      X
 (β |β ) = (−α−1 −
          ′     ′′
                                            mi αi + kγ − (dλ(µ) − kk ′)δ | − k (k ′δ + γ ))
                                      i=0
                                                         r
                                                         X
                      = −kk    ′
                                   l + k (α−1 |γ ) + k         mi ( α i | γ ) − k 2 ( γ | γ ) ,
                                                         i=0
which can be seen to be a constant as in Case 2.

              Moreover, by the same argument as in Case 2, for each r ≥ l + s + t + 2,
we can verify that                 β ′ is Weyl group conjugate to a dominant integral weight
                                                      Pr
τ    =        wr β ′    that       has the form τ =      i=0 bi Λi − n δ, where bi = 0 for
                                                              ′       ′           ′

                                                         21
i = p + 1, · · · , r − q − 1.          So if we let     d′i = b′i − ai (i = 0, 1, · · · , r), we
may write
                                             r
                                             X
                       τ      = −α−1 −             m′i αi − dλ(τ )δ,
                                             i=0
                   Pr
where −α−1 −        i=0 mi αi has depth 0 with respect to
                         ′
                                                                           λ.     In addition, we
have

                             r
                             X                                           c
(3.11)           τ −µ=             (mi − m′i )αi + (dλ (µ) − dλ (τ ))δ ∈ Q+ ,
                             i=0

and

                                 r
                                 X
                  τ −β   ′
                             =         (mi − m′i )αi − kγ
(3.12)                           i=0
                                                                    c
                                    + (dλ (µ) − dλ (τ ) − kk ′ )δ ∈ Q+ .

By the same argument as in Lemma 1.23, we can show that     m′i ≥ 0 for all
i = p − 1, p, · · · , r − q, r − q + 1, and hence dλ(µ) − dλ(τ ) − kk ′ ≥ 0.
Therefore,
                      dλ(τ ) ≤ dλ(µ) − kk ′ ≤ dλ (µ) − 1.
By the induction hypothesis, if     wr β ′ is a weight of L(Λ) for some r0 ≥
                                               0

l + s + t + 2, then τ = wr β ′ is a weight of L(λ) for all r ≥ r0 , and
mult(β ′ ) = mult(τ ) is a polynomial in r of degree ≤ dλ (τ ) ≤ dλ (µ) − 1.
Since there are
                  r(r + 1) positive roots in g and since c = 1/k for all
                                                0            β               ′′
                      2
k = 1, · · · , m0 + dλ(µ), the total contribution of the partitions in this case
to the right side of (3.2) is a polynomial in r of degree ≤ dλ (µ) + 1.

Case 4. Suppose       β ′′ = −k (k ′δ − γ ), where k, k ′ ≥ 1 and γ is a positive
root of g0 = Ar . In this case,

                              r
                              X                                      c
         β   ′
                 = −α−1 −            mi αi − kγ − (dλ (µ) − kk ′)δ ∈ Q −.
                              i=0

As in Case 3, by looking at the coefficient of               α0 in the above expression, we
                                                   22
can show that           k and k ′ range from 1 to m0 + dλ (µ).                   We have
                                     r
                                     X
 (β ′ |β ′′ ) = (−α−1 −                    mi αi − kγ − (dλ(µ) − kk ′)δ | − k (k ′δ − γ ))
                                     i=0
                                                     r
                                                     X
              = −kk        ′
                               l − k (α−1 |γ ) −           mi ( α i | γ ) − k 2 ( γ | γ ) ,
                                                     i=0
which can be seen to be a constant as in Case 2.

         By the identical argument as in Case 2 we can verify for each                              r   ≥
l + s + t + 2 that β ′ is Weyl group conjugate to a dominant integral weight
                                        P
τ = wr β ′ that has the form τ = ri=0 b′i Λi − n′ δ, where b′i = 0 for i =
p +1, · · · , r − q −1. So if we suppose as before d′i = b′i − ai (i = 0, 1, · · · , r),
then
                                                   r
                                                   X
                                τ    = −α−1 −          m′i αi − dλ(τ )δ,
                             i=0
            Pr
where −α−1 − i=0 m′i αi has depth 0 with respect to                                λ.   Moreover,
                                  r
                                  X                                            c
(3.13)             τ −µ=                 (mi − m′i )αi + (dλ (µ) − dλ (τ ))δ ∈ Q+ ,
                                  i=0
and
                                         r
                                         X
                        τ −β     ′
                                     =         (mi − m′i )αi + kγ
(3.14)                                   i=0
                                                                         c
                                         + (dλ (µ) − dλ (τ ) − kk ′ )δ ∈ Q+ .

Let us write       γ = αu + αu+1 + · · · + αv with 1 ≤ u ≤ v ≤ r.                             Then (3.14)
becomes
(3.15)
                  r
                  X
 τ −β     ′
              =         (mi − m′i )αi − k (α0 + α1 + · · · + αu−1 )
                  i=0
                                                                                c
                  − k (αv +1 + · · · + αr ) + (dλ (µ) − dλ (τ ) + k − kk ′ )δ ∈ Q+ .

The argument in Lemma 1.23 proves that m′i ≥ 0 for all i = p −1, p, · · ·                           , r−
q, r − q + 1 and that dλ (µ) − dλ (τ ) + k − kk ′ ≥ 0, which yields
                               dλ (τ ) ≤ dλ (µ) + k − kk ′ ≤ dλ (µ).
                                                       23
         If dλ (τ ) = dλ (µ), then we must have k ′ = 1 and (3.15) can be written
as
(3.16)
                      r
                      X
     τ −β    ′
                 =          (mi − m′i )αi
                      i=0
                                                                               c
                     − k (α0 + α1 + · · · + αu−1 ) − k (αv +1 + · · · + αr ) ∈ Q+ .


Recall that      mi       = 0 and   m′i  i = p − 1, p, · · · , r − q, r − q + 1.
                                          ≥ 0 for
                                          c
Thus in order for τ − β ′ to belong to Q+ , it must be that m′i = 0 for all
i = p − 1, p, · · · , r − q, r − q + 1, and u ≤ p − 2, v ≥ r − q + 1. Hence
the number of such γ is at most (p − 2)(q − 1), a constant. As τ > µ and
dλ (τ ) = dλ (µ) hold, we have τ0 > µ0 . Hence, it follows from the induction
hypothesis that if wr β ′ is a weight of L(λ) for some r0 ≥ l + s + t + 2,
                                0

τ = wr β ′ is a weight of L(λ) for all r ≥ r0 , and mult(β ′) = mult(τ ) is a
polynomial in r of degree ≤ dλ (τ ) = dλ (µ). Note that cβ = 1/k for all  ′′

i = 1, · · · , m0 + dλ (µ). Therefore, the contribution of these decompositions
to the right-hand side of (3.2) is a polynomial in r of degree ≤ dλ (µ).

                    dλ (τ ) < dλ(µ). Then by the induction hypothesis, if
         Suppose that
wr β ′ is a weight of L(λ) for some r0 ≥ l + s + t + 2, then τ is a weight of
     0

L(λ) for all r ≥ r0 , and mult(β ′) = mult(τ ) is a polynomial in r of degree
≤ dλ (τ ) ≤ dλ (µ) − 1. Since there are
                                          r(r + 1) positive roots in g = A
                                                                      0      r
                                              2
and since cβ = 1/k for all k = 1, · · · , m0 + dλ (µ), the contribution of
                     ′′

these decompositions to the right side of (3.2) is a polynomial in r of degree
≤ dλ (µ) + 1.

         Therefore, what the partitions in Case 4 contribute to the right-hand
side of (3.2) is a polynomial in          r of degree ≤ dλ (µ) + 1.
         Consequently, the sum of all the contributions from Case 1 to Case 4,
which is the right side of (3.2), is a polynomial in r of degree ≤ dλ (µ) +1. By
Lemma 3.3 and (3.2), we have mult(µ) = f /g , where             f     is a polynomial in r
of degree ≤ dλ (µ) + 1 and   g is a polynomial in r of degree 1. Since mult(µ)
takes positive integral values for infinitely many values of r ≥ l + s + t + 2,
                                                24
it must be a polynomial in    r (see [PS], p.   130), and

                  deg(mult(µ)) ≤ (dλ (µ) + 1) − 1 = dλ (µ).

This completes the proof of the theorem.             


Example 3.17. The following tables illustrate the polynomial behavior of
the multiplicity of the weight µ − kδ in the irreducible highest weight module
L(λ) over the affine Kac-Moody algebra A(1)
                                        r .           The numerical data in these
tables was taken from [KMPS]. From now on, let             a = (a0 , a1 , · · · , as−1 ),
a′ = (ar−t+1 , ar−t+2 , · · · , ar ), and m ∈ Z be the determining data for
                                            ′
λ, and let b = (b0 , b1 , · · · , bs −1 ), b = (br−t +1 , br−t +2 , · · · , br ), and
                                   ′                   ′            ′


n ∈ Z be the determining data for µ.




                                         25
1.   λ = µ = Λ0 + Λr ;
                                         ′
     a = (1), a′ = (1), m = 0, b = (1), b = (1), n = 0;
     dλ (µ − kδ ) = (k − m) − (d1 + 2d2 + · · · + (p − 1)dp−1 ) = k.
k\r    1     2          3         4          5           6           7          8           polynomial
0      1     1          1         1          1           1           1          1           1
1      2     4          6         8          10          12          14         16          2r
2      4     13         27        46         70          99          133        172         1
                                                                                            2
                                                                                                 r
                                                                                              (5 2   + 3r )
3      8     36         98        208        380         628         966        1408        1
                                                                                            3 (7 r
                                                                                                 3
                                                                                                   + 9r 2
                                                                                                +8r )
                                                                                            12 (21r + 44r
                                                                                             1     4       3
4      14    89         310       804        1740        3329        5824       9520
                                                                                                +87r 2 + 16r )
5      24    204        888       2768       7012        15396       30436      55520        1
                                                                                            30
                                                                                               (33 5 r
                                                                                                     + 100r 4
                                                                                                 +315r 3
                                                                                                 +200r 2
                                                                                                  +72r )




2.   λ = 3Λ1 , µ = Λ0 + Λ1 + Λ2 ;
                                                ′
     a = (0, 3), a′ = ∅, m = 0, b = (1, 1, 1), b = ∅, n = 0;
     dλ (µ − kδ ) = (k − m) − (d1 + 2d2 + · · · + (p − 1)dp−1 ) = k.
k\r    2         3          4          5            6           7           polynomial
0      1         1          1          1            1           1           1
1      4         6          8          10           12          14          2r
2      15        31         53         81           115         155         3r 2 + r + 1
3      44        126        278        523          884         1384         1
                                                                             6
                                                                                    r       r
                                                                               (23 3 + 3 2 + 40    r − 12)
4      121       456        1267       2901         5808        10541         1
                                                                             24 (103
                                                                                     4
                                                                                        r
                                                                                       − 54 3 +  r 533r2
                                                                                    −294r + 144)
5      300       1477       5120       14166        33444       70188         1
                                                                             120 (513
                                                                                      5
                                                                                        r− 800r 4
                                                                                    +5815r 3 − 6580r 2
                                                                                    +7412r − 22)



                                                         26
3.   λ = 2Λ0 , µ = Λ1 + Λr ;
                                       ′
     a = (2), a′ = ∅, m = 0, b = (1), b = (1), n = 0;
     dλ (µ − kδ ) = (k − m) − (d1 + 2d2 + · · · + (p − 1)dp−1 ) = k − 1.
k\r    2     3          4         5          6          7           8          polynomial
0      0     0          0         0          0          0           0          0
1      1     1          1         1          1          1           1          1
2      4     6          8         10         12         14          16         2r
3      12    25         43        66         94         127         165        1
                                                                               2 (5 r2
                                                                                        +     + r      2)
4      32    87         186       343        572        887         1302       1
                                                                               3 (7 r3
                                                                                            r
                                                                                       + 3 2 + 17     r − 6)
5      77    266        693       1513       2923       5162        8511        1
                                                                               12
                                                                                        r
                                                                                  (21 4 + 16 3 +    r 129r2
                                                                                    −46r + 36)




4.   λ = Λ0 + Λ1 , µ = Λ2 + Λr ;
                                                ′
     a = (1, 1), a′ = ∅, m = 0, b = (0, 0, 1), b = (1), n = 0;
     dλ (µ − kδ ) = (k − m) − (d1 + 2d2 + · · · + (p − 1)dp−1 ) = k − 1.
k\r    3         4          5          6          7            8           polynomial
0      0         0          0          0          0            0           0
1      2         2          2          2          2            2           2
2      12        17         22         27         32           37          5r − 3
3      50        92         148        218        302          400         7r 2 − 7r + 8
4      172       396        770        1336       2136         3212        7r 3 − 9r 2 + 28r − 20
5      522       1466       3382       6816       12446        21082       1
                                                                           2
                                                                             (11 4  r − 16r 3 + 97r 2
                                                                                   −124r + 84)




                                                        27
      5.   λ = 2Λ0 + Λ1 , µ = 2Λ1 + Λr ;
                                                   ′
           a = (2, 1), a′ = ∅, m = 0, b = (0, 2), b = (1), n = 0;
           dλ (µ − kδ ) = (k − m) − (d1 + 2d2 + · · · + (p − 1)dp−1 ) = k − 1.

      k\r    2     3     4      5      6           7       polynomial
      0      0     0     0      0      0           0       0
      1      1     1     1      1      1           1       1
      2      6     9     12     15     18          21      3r
      3      22    49    87     136    196         267     1
                                                           2 (11r2
                                                                     − r + 2)
      4      70    214   492    951    1638        2600    1
                                                           6 (47r3
                                                                     − 21r 2 + 76r − 24)
      5      193   795   2328   5515   11304       20868   1
                                                           8
                                                                r
                                                             (75 4 − 86r 3 + 373r 2
                                                                −290r + 120)




                                       References

[BKM1] G. Benkart, S.-J. Kang, K. C. Misra, Graded Lie algebras of Kac-Moody
       type, Adv. in Math. 97 (1993), 154-190.
[BKM2] G. Benkart, S.-J. Kang, K. C. Misra, Weight multiplicity polynomials for
       affine Kac-Moody algebras of type Ar , Compositio Math. 104 (1996),
                                            (1)

       153-187.
   [BK] G. Benkart, S. N. Kass, Weight multiplicities for affine Kac-Moody algebras,
        in Modern Trends in Lie Theory, Queen’s Papers in Pure and Applied Math.
        94, V. Futorny and D. Pollack eds. (1994), 1-12.
   [FF] A. J. Feingold, I. B. Frenkel, A hyperbolic Lie algebra and the theory of
        Siegel modular forms of genus 2, Math. Ann. 263 (1983), 87-144.
  [GK] O. Gabber, V. G. Kac, On defining relations of certain infinite-dimensional
       Lie algebras, Bull. Amer. Math. Soc. 5 (1981), 185-189.
   [K1] V. G. Kac, Simple irreducible graded Lie algebras of finite growth, Math.
        USSR-Izv. 2 (1968), 1271-1311.
   [K2] V. G. Kac, Infinite Dimensional Lie Algebras, 3rd ed., Cambridge Univ.
        Press, Cambridge, 1990.
  [Ka1] S.-J. Kang, Gradations and Structure of Kac-Moody Lie Algebras, Yale Uni-
        versity Ph.D. dissertation 1990.
                                              28
  [Ka2] S.-J. Kang, Root multiplicities of Kac-Moody algebras, Duke Math. J. 74
        (1994), 635-666.
[KMPS] S. N. Kass, R. V. Moody, J. Patera, R. Slansky, Affine Lie Algebras, Weight
       Multiplicities, and Branching Rules, Vols. I and II, Los Alamos Series in
       Basic and Applied Sciences, Univ. of Calif. Press, 1990.
     [P] D. H. Peterson, Freudenthal-type formulas for root and weight multiplicities,
         preprint (unpublished).
   [PS] G. Pólya and G. Szegö, Problems and Theorems in Analysis II, Springer-
        Verlag, 1976.




                                             29
