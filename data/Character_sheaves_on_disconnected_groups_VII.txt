                                              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII
arXiv:math/0412168v1 [math.RT] 8 Dec 2004




                                                                                 G. Lusztig


                                                                               Introduction
                                                Throughout this paper, G denotes a fixed, not necessarily connected, reductive
                                            algebraic group over an algebraically closed field k. This paper is a part of a series
                                            [L9] which attempts to develop a theory of character sheaves on G.
                                                The usual convolution of class functions on a connected reductive group over
                                            a finite field makes sense also for complexes in D(G0 ) and then it preserves (see
                                            [Gi]) in the derived sense the class of character sheaves on G0 . In §32 we define,
                                            more generally, a natural convolution operation for parabolic character sheaves (see
                                            32.21(a)). A key role in our study of convolution is played by Theorem 32.6 which
                                                                                                                            s,L
                                            describes explicitly the convolution of two basic complexes of the form K̄J,D        in
                                            terms of multiplication in some Hecke algebra. Using this we define a map which to
                                            each parabolic character sheaf associates an orbit of a subgroup of the Weyl group
                                            on the set of isomorphism classes of ”tame” local systems of rank 1 on the torus
                                            T, see 32.25(b); in fact we define a refinement of this map in 32.25(a). The main
                                            result of §33 is Proposition 33.3 (a generalization of [L3, III, 14.2(b)]). It asserts
                                            that (under a cleanness assumption), the cohomology sheaves of a character sheaf
                                            restricted to an open subset of the support of a different character sheaf are disjoint
                                            from the local system given by the second character sheaf on that open subset.
                                            (This plays a key role in the argument in 35.22.) In §34 we study the algebra
                                            Hn of 31.2 (or rather an extension HnD of it) in the spirit of our earlier study
                                            [L12] of a usual Iwahori-Hecke algebra by means of the asymptotic Hecke algebra.
                                            This allows us to construct representations of HnD starting from representations
                                            of HnD,1 , the specialization of HnD at v = 1. In 34.19 we define some invariants
                                            bvA,u of a character sheaf A which depend also on an irreducible representation
                                            Eu of HnD,1 . These generalize the invariants cA,E of [L3, III,12.10]. From the
                                            definition, bvA,u is a rational function in the indeterminate v and one of our goals
                                            is to show that bvA,u is in fact a constant. This goal is achieved in §35 under a
                                            cleanness assumption and a quasi-rationality assumption on Eu . (See Theorem
                                            35.23 which is a generalization of [L3, III, 14.9].) In §35 we prove an orthogonality

                                              1991 Mathematics Subject Classification. Primary 20G99.
                                              Supported in part by the National Science Foundation.

                                                                                                              Typeset by AMS-TEX
                                                                                       1
2                                                    G. LUSZTIG

                                                                                   s,L
formula (35.15) for the characteristic functions of complexes of the form K̄J,D
(over a finite field) in the spirit of [L3, III, 13.5]. A variant of this formula (see
32.23) can be obtained in an entirely different way as an application of the results
on convolution in §32. As an application we associate a sign ±1 to any character
sheaf on a connected component of G (see 35.17), under a cleanness assumption.
This generalizes [L3, III, 13.10].
   Erratum to Part V. In 25.6 replace R1∗ = R∗ ∩ R by R1∗ = R∗ ∩ R1 .
   Erratum to Part VI. In 28.19 replace L′ = (D−1 )∗ L by L′ = (D−1 )∗ Ľ. In 31.4
replace ιD by D.

                                                      Contents
    32.   Convolution.
    33.   Disjointness.
    34.   The structure of HnD .
    35.   Functions on G0F /U .

                                               32. Convolution
32.1. In this section we define and study the convolution of parabolic character
sheaves.
32.2. Let ∆ be a connected component of G. Let J ⊂ I. Let s = (s1 , s2 , . . . , sr ),
s′ = (s′1 , s′2 , . . . , s′r′ ) be two sequences in I. Let a, a′ ∈ W. Let

      w = (s1 , s2 , . . . , sr , a, s′1, s′2 , . . . , s′r′ , a′ ),   [w] = s1 s2 . . . sr as′1 s′2 . . . s′r′ a′ .

                                  •
Let L ∈ s(T) be such that [w]∆ ∈ WL . Let

                           T = {i ∈ [1, r]; s1 . . . si−1 si si−1 . . . s1 ∈ WL },

                T ′ = {j ∈ [1, r ′ ]; a′−1 s′r . . . s′j+1 s′j s′j+1 . . . s′r′ a′ ∈ ǫ∆ (WL )},

                                         ′    ′            ′
      Zw
       ∅,J,∆ = {(B0 , B1 , . . . , Br , B0 , B1 , . . . , Br′ , B, xUJ,B0 ); Bi ∈ B(i ∈ [0, r]),
      Bj′ ∈ B(j ∈ [0, r ′ ]), B ∈ B, x ∈ ∆, pos(Bi−1 , Bi ) ∈ {si , 1}(i ∈ T ),
                                                   ′
      pos(Bi−1 , Bi ) = si (i ∈ [1, r] − T ), pos(Bj−1 , Bj′ ) ∈ {s′j , 1}(j ∈ T ′ ),
           ′
      pos(Bj−1 , Bj′ ) = s′j (j ∈ [1, r ′ ] − T ′ ), pos(Br , B0′ ) = a, pos(Br′ ′ , B) = a′ ,
      xB0 x−1 = B}.

        w
Then Z∅,J,∆   (see 28.8) is naturally an open subset of Z w
                                                          ∅,J,∆ . By 28.8, L gives rise
                            w
to a local system L̃ on Z∅,J,∆  .
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                               3

   (a) L̃ extends uniquely to a local system L̄ on Z w                                ∅,J,∆ .
                                           ′       ′ ′           ′
Indeed, let a = t1 t2 . . . tm , a = t1 t2 . . . tm′ be reduced expressions for a, a′ in W
and let
   t = (s1 , s2 , . . . , sr , t1 , t2 , . . . , tm , s′1 , s′2 , . . . , s′r′ , t′1 , t′2 , . . . , t′m′ ).
We identify in an obvious way Z w                    ∅,J,∆ with an open subset of Z̄∅,J,∆ (see 28.9)
                                                                                                             t
                               tJ
contained in ∪J ⊂Jt Z∅,J,∆              (notation of 28.9) and we use the fact that L̃, regarded
                         w        t                                              J                     t
as a local system on Z∅,J,∆    = Z∅,J,∆  extends to a local system on ∪J ⊂Jt Z∅,J,∆ ,
                                                                  w
see 28.10. This extension is unique up to isomorphism since Z∅,J,∆      is open dense
in the smooth irreducible variety Z w∅,J,∆ (which is itself open dense in the smooth
                      t
irreducible variety Z̄∅,J,∆ ).
                                                             ′
32.3. For any a = (a0 , a1 , . . . , ar+r′ ) ∈ Wr+r +1 let

    Z w,a                               ′    ′            ′                    w
      ∅,J,∆ = {(B0 , B1 , . . . , Br , B0 , B1 , . . . , Br′ , B, xUJ,B0 ) ∈ Z ∅,J,∆ ;
             pos(Bk , Br′ ′ ) = ak (k ∈ [0, r]), pos(Br , Br+r
                                                           ′                             ′
                                                               ′ −k ) = ak (k ∈ [r, r + r ])}.



Define πw,a : Z w,a
                ∅,J,∆ −
                      → ZJ,∆ by

      (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , B ′ r ′ , B, xUJ,B0 ) 7→ (QJ,B0 , Qǫ∆ (J),B , xUJ,B0 )

(notation of 28.7). Now Z w,a     ∅,J,∆ is empty unless
   (i) ar+r′ = a,
   (ii) ak ∈ {ak−1 , sk ak−1 } for k ∈ [1, r],
   (iii) ak ∈ {ak−1 , ak−1 s′r+r′ +1−k } for k ∈ [r + 1, r + r ′ ].
Indeed, let (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , B, xUJ,B0 ) ∈ Z w,a
                                                                                ∅,J,∆ . Clearly, (i) holds.
Let k ∈ [1, r]. From pos(Bk , Bk−1 ) ∈ {1, sk }, pos(Bk−1 , Br′ ′ ) = ak−1 , we deduce
pos(Bk , Br′ ′ ) ∈ {ak−1 , sk ak−1 } and (ii) holds. Let k ∈ [r + 1, r + r ′ ]. From
                ′                                    ′               ′                ′
   pos(Br , Br+r   ′ +1−k ) = ak−1 , pos(Br+r ′ +1−k , Br+r ′ −k ) ∈ {1, sr+r ′ +1−k },
                          ′                                     ′
we deduce pos(Br , Br+r′ −k ) ∈ {ak−1 , ak−1 sr+r′ +1−k } and (iii) holds.
                                                                                          w,a
   Let L̄a be the restriction of the local system L̄ from Z w                 ∅,J,∆ to Z ∅,J,∆ . We have
                           w,a                               ′
a partition Z w
              ∅,J,∆ = ⊔a Z ∅,J,∆ with a ∈ W
                                            r+r +1
                                                   subject to (i),(ii),(iii). We set

      Na = |{k ∈ [1, r], ak > sk ak }| + |{k ∈ [r + 1, r + r ′ ], ak > ak s′r+r′ +1−k }|,


                    Ta = {i ∈ T ; ai−1 = ai < si ai },
                    Ta′ = {j ∈ T ′ ; ar+r′ −j = ar+r′ −j+1 < ar+r′ −j+1 s′j }.

Lemma 32.4. Assume that a satisfies 32.3(i),(ii),(iii).
  (a) Z w,a
        ∅,J,∆ is non-empty if and only if i ∈ [1, r], ai−1 = ai < si ai =⇒ i ∈ T ,
and j ∈ [1, r ′ ], a−j+r+r′ = a−j+1+r+r′ < a−j+1+r+r′ s′j =⇒ j ∈ T ′ .
4                                                G. LUSZTIG

   (b) If (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , B, xUJ,B0 ) ∈ Z w,a
                                                                              ∅,J,∆ then Bi−1 = Bi for
                     ′            ′                          ′
any i ∈ Ta and Bj−1 = Bj for any j ∈ Ta .
   (c) Let 0 Z w,a                                    w,a
               ∅,J,∆ be the subset of Z ∅,J,∆ defined by the following conditions: for
i ∈ [1, r] we have Bi−1 = Bi if and only if i ∈ Ta ; for j ∈ [1, r ′ ] we have Bj−1             ′
                                                                                                     = Bj′
if and only if j ∈ Ta′ . If Z w,a   ∅,J,∆ 6= ∅ then it is smooth, irreducible and Z ∅,J,∆ is
                                                                                              0 w,a

open dense in Z w,a∅,J,∆ .
   (d) If ak = ak−1 for some k ∈ [1, r] with k ∈                   / T or for some k ∈ [r + 1, r + r ′ ]
with r + r ′ + 1 − k ∈   / T ′ , then πw,a! L̄a = 0.
   (e) If ak 6= ak−1 for any k ∈ [1, r] with k ∈                / T and for any k ∈ [r + 1, r + r ′ ] with
r + r′ + 1 − k ∈/ T ′ , then a0 a′ ∆ ∈ WL           •
                                                      ; moreover, Z w,a ∅,J,∆ is an iterated affine space
               0   (a ,b)                                         0                           (a ,a′ ),L
bundle over Z∅,J,∆ with fibres of dimension Na and πw,a! L̄a = KJ,∆                                        [[−Na ]].
  We prove (d),(e) by induction on r +r ′ . If r +r ′ = 0 then w = (a0 , a′ ), a = {a0 }
and
        Z w,a      w               ′                         ′
          ∅,J,∆ = Z∅,J,∆ = {(B0 , B0 , B, xUJ,B0 ); B0 ∈ B, B0 ∈ B, B ∈ B, x ∈ ∆,
                             pos(B0 , B0′ ) = a0 , pos(B0′ , B) = a′ , xB0 x−1 = B}.
                           w,L
Hence πw,a! L̄a = KJ,∆          . Now assume that r + r ′ ≥ 1. Assume first that r ′ ≥ 1.
Let
  w′ = (s1 , s2 , . . . , sr , ar+r′ −1 , s′r′ −1 , s′r′ −2 , . . . , s′1 , a′ ),
  [w′ ] = s1 s2 . . . sr ar+r′ −1 s′r′ −1 s′r′ −2 . . . s′1 a′ ,
  a′ = (a0 , a1 , . . . , ar , ar+1 , . . . , ar+r′ −1 ),
     Y = {(B0 , B1 , . . . , Br , B1′ , B2′ , . . . , Br′ ′ , B, xUJ,B0 ); Bi ∈ B(i ∈ [0, r]),
     Bj′ ∈ B(j ∈ [1, r ′ ]), B ∈ B, x ∈ ∆, pos(Bi−1 , Bi ) ∈ {si , 1}(i ∈ T ),
                                                  ′
     pos(Bi−1 , Bi ) = si (i ∈ [1, r] − T ), pos(Bj−1 , Bj′ ) ∈ {s′j , 1}(j ∈ T ′ ∩ [2, r ′ ]),
          ′
     pos(Bj−1 , Bj′ ) = s′j (j ∈ [2, r ′ ] − T ′ ), pos(Bk , Br′ ′ ) = ak (k ∈ [0, r]),
               ′                             ′            ′           ′        −1
     pos(Br , Br+r ′ −k ) = ak (k ∈ [r, r + r − 1]), pos(Br ′ , B) = a , xB0 x    = B ′ }.

               → ZJ,∆ , f : Z w,a
Define π Y : Y −              ∅,J,∆ −
                                    → Y by

    π Y : (B0 , B1 , . . . , Br , B1′ , B2′ , . . . , Br′ ′ , B, xUJ,B0 ) 7→ (QJ,B0 , Qǫ∆ (J),B , xUJ,B0 ),

                        f : (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , B, xUJ,B0 )
                         7→ (B0 , B1 , . . . , Br , B1′ , B2′ , . . . , Br′ ′ , xUJ,B0 ).

The fibre of f at (B0 , B1 , . . . , Br , B1′ , B2′ , . . . , Br′ ′ , xUJ,B0 ) ∈ Y may be identified
with
          {B0′ ∈ B;pos(B0′ , B1′ ) ∈ {s′1 , 1} if 1 ∈ T ′ , pos(B0′ , B1′ ) = s′1 if 1 ∈
                                                                                       / T ′,
                      pos(Br , B0′ ) = ar+r′ }.
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                          5

If ar+r′ s′1 = ar+r′ −1 then [w′ ]∆ = [w]∆ ∈ WL    •
                                                     and the sets analogous to T , T ′ (for
                                                        ′ ′
                                                         ,a
w′ instead of w) are T , T ′ ∩ [2, r ′ ]. Moreover, Z w
                                                      ∅,J,∆ = Y and f is an isomorphism
if ar+r′ < ar+r′ s′1 and an affine line bundle if ar+r′ > ar+r′ s′1 . In both cases,
L̄a = f ∗ (L̄a′ ). Hence

           f! L̄a = L̄a′ , πw,a! L̄a = πw′ ,a′ ! f! L̄a = πw′ ,a′ ! L̄a′ if ar+r′ < ar+r′ s′1 ,

   f! L̄a = L̄a′ [[−1]], πw,a!L̄a = πw′ ,a′ ! f! L̄a = πw′ ,a′ ! L̄a′ [[−1]] if ar+r′ > ar+r′ s′1 ;
the desired result follows from the induction hypothesis.
   If ar+r′ −1 = ar+r′ < ar+r′ s′1 and 1 ∈    / T ′ then Z w,a
                                                           ∅,J,∆ = ∅. If ar+r −1 = ar+r >
                                                                             ′          ′

        ′            ′                ∗
ar+r′ s1 and 1 ∈ / T then f is a k -bundle and f! L̄a = 0 (this can be deduced from
28.11) hence πw,a! L̄a = π!Y f! L̄a = 0.
   Assume now that ar+r′ −1 = ar+r′ and 1 ∈ T ′ . Then [w′ ]∆ ∈ WL          •
                                                                               and the sets
                                                                                   ′ ′
                                                                                    ,a
analogous to T , T (for w instead of w) are T , T ∩ [2, r ]. Moreover, Z w
                     ′       ′                           ′       ′
                                                                                 ∅,J,∆ = Y ;
also, f is an isomorphism if ar+r′ < ar+r′ s′1 and an affine line bundle if ar+r′ >
ar+r′ s′1 . In both cases, L̄a = f ∗ (L̄a′ ). Hence

           f! L̄a = L̄a′ , πw,a! L̄a = πw′ ,a′ ! f! L̄a = πw′ ,a′ ! L̄a′ if ar+r′ < ar+r′ s′1 ,

   f! L̄a = L̄a′ [[−1]], πw,a!L̄a = πw′ ,a′ ! f! L̄a = πw′ ,a′ ! L̄a′ [[−1]] if ar+r′ > ar+r′ s′1 ;
the desired result follows from the induction hypothesis.
   Assume next that r ′ = 0. Then r ≥ 1. Let
   w′′ = (s1 , s2 , . . . , sr−1 , ar−1 , a′ ), [w′′ ] = s1 s2 . . . sr−1 ar−1 a′ ,
   a′′ = (a0 , a1 , . . . , ar−1 ),

       Y1 = {(B0 , B1 , . . . , Br−1 , B0′ , B, xUJ,B0 ); Bi ∈ B(i ∈ [0, r − 1]), B0′ ∈ B,
       B ∈ B, x ∈ ∆, pos(Bi−1 , Bi ) ∈ {si , 1}(i ∈ T ∩ [1, r − 1]),
       pos(Bi−1 , Bi ) = si (i ∈ [1, r − 1] − T ), pos(Bk , B0′ ) = ak (k ∈ [0, r − 1]),
       pos(B0′ , B) = a′ , xB0 x−1 = B}.

                 → ZJ,∆ , f1 : Z w,a
Define π Y1 : Y1 −               ∅,J,∆ −
                                       → Y1 by

      π Y1 : (B0 , B1 , . . . , Br−1 , B0′ , B, xUJ,B0 ) 7→ (QJ,B0 , Qǫ∆ (J),B , xUJ,B0 ),
      f1 : (B0 , B1 , . . . , Br , B0′ , B, xUJ,B0 ) 7→ (B0 , B1 , . . . , Br−1 , B0′ , B, xUJ,B0 ).

The fibre of f1 at (B0 , B1 , . . . , Br−1 , B0′ , B, xUJ,B0 ) ∈ Y1 may be identified with

       {Br ∈ B;pos(Br−1 , Br ) ∈ {sr , 1} if r ∈ T , pos(Br−1 , Br ) = sr if r ∈
                                                                               /T,
                   pos(Br , B0′ ) = ar }.
6                                            G. LUSZTIG

If sr ar = ar−1 then [w′′ ]∆ = [w]∆ ∈ WL     •
                                                and the set analogous to T (for w′′
                                               w′′ ,a′′
instead of w) is T ∩ [1, r − 1]. Moreover, Z ∅,J,∆      = Y1 and f1 is an isomorphism
if ar < sr ar and an affine line bundle if ar > sr ar . In both cases, L̄a = f1∗ (L̄a′′ ).
Hence
           f1! L̄a = L̄a′′ , πw,a! L̄a = πw′′ ,a′′ ! f1! L̄a = πw′′ ,a′′ ! L̄a′′ if ar < sr ar ,
    f1! L̄a = L̄a′′ [[−1]], πw,a!L̄a = πw′′ ,a′′ ! f1! L̄a = πw′′ ,a′′ ! L̄a′′ [[−1]] if ar > sr ar ;
the desired result follows from the induction hypothesis.
   If ar−1 = ar < sr ar and r ∈     / T then Z w,a
                                               ∅,J,∆ = ∅. If ar−1 = ar > sr ar and
                        ∗
r ∈/ T then f1 is a k -bundle and f1! L̄a = 0 (this can be deduced from 28.11)
hence πw,a! L̄a = π!Y1 f1! L̄a = 0.
   Assume now that ar−1 = ar and r ∈ T . Then [w′′ ]∆ ∈ WL           •
                                                                        and the set
                                                                          ′′ ′′
                                                                        w   ,a
analogous to T (for w′′ instead of w) is T ∩ [1, r − 1]. Moreover, Z ∅,J,∆      = Y1 ;
also, f1 is an isomorphism if ar < sr ar and an affine line bundle if ar > sr ar . In
both cases, L̄a = f1∗ (L̄a′′ ). Hence
           f1! L̄a = L̄a′′ , πw,a! L̄a = πw′′ ,a′′ ! f1! L̄a = πw′′ ,a′′ ! L̄a′′ if ar < sr ar ,
    f1! L̄a = L̄a′′ [[−1]], πw,a!L̄a = πw′′ ,a′′ ! f1! L̄a = πw′′ ,a′′ ! L̄a′′ [[−1]] if ar > sr ar ;
the desired result follows from the induction hypothesis. This completes the proof
of (d),(e). The previous inductive proof also yields (a),(b),(c). The lemma is
proved.
32.5. Let J ⊂ I. Let D, D′ , ∆ be three connected components of G with ∆ =
D′ D. We write ǫ, ǫ′ instead of ǫD , ǫD′ : W −
                                             → W. We have a diagram
                                                 1    b2        b
                                ZJ,D × Zǫ(J),D′ ←− Z0 −→ ZJ,∆
where
           Z0 = {(Q, Q′ , Q′′ , gUQ , g ′ UQ′ ); Q ∈ PJ , Q′ ∈ Pǫ(J) , Q′′ ∈ Pǫ′ ǫ(J) ,
              g ∈ D, g ′ ∈ D′ , gQg −1 = Q′ , g ′ Q′ g ′−1 = Q′′ },
b1 (Q, Q′ , Q′′ , gUQ , g ′ UQ′ ) = ((Q, Q′ , gUQ ), (Q′ , Q′′ , g ′ UQ′ )),
    b2 (Q, Q′ , Q′′ , gUQ , g ′ UQ′ ) = (Q, Q′′ , g ′ gUQ ).
Define a functor (convolution) D(ZJ,D ) × D(Zǫ(J),D′ ) −              → D(ZJ,∆ ) by
                              K, K ′ 7→ K ∗ K ′ = b2! b∗1 (K ⊠ K ′ ).
Let s = (s1 , s2 , . . . , sr ), s′ = (s′1 , s′2 , . . . , s′r′ ) be two sequences in I and let L, L′ ∈
s(T) be such that s1 s2 . . . sr D ∈ WL                   •
                                                            , s′1 s′2 . . . s′r′ D ′ ∈ WL
                                                                                        •
                                                                                          ′.
                                                                                                    s,L
                                                                                             Then K̄J,D ∈
                ′   ′                                                                              ′   ′
            s ,L                                                     s,L     s ,L
D(ZJ,D ), K̄ǫ(J),D ′ ∈ D(Zǫ(J),D ′ ) are defined (see 28.12) hence K̄J,D ∗ K̄ǫ(J),D ′ ∈

D(ZJ,∆ ) is defined.
   Let n ∈ N∗k be such that L ∈ sn , L′ ∈ sn . Let λ ∈ sn (resp. λ′ ∈ sn ) be the
isomorphism class of L (resp. L′ ).
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                                    7

                                                 ′   ′
                       s,L     s ,L                 ′
Theorem 32.6. (a) If K̄J,D ∗ K̄ǫ(J),D ′ 6= 0 then yλ = Dλ for some y ∈ Wǫ(J) .
                                                                                                       ′   ′
                                                           s,L     s ,L
   (b) Let A be a simple perverse sheaf on ZJ,∆ . If A ⊣ K̄J,D ∗ K̄ǫ(J),D ′ , then

      L
A ∈ ẐJ,∆ .
  (c) Assume that k, Fq , G, F are as in 31.7(b), that A ∈ ẐJ,∆ and that ζ A :
Hn [∆] −
       → A is as in 31.7. Then
                                   ′   ′                                           0   0
                    s,L     s ,L
              χA                            2
               v (K̄J,D ∗ K̄ǫ(J),D′ ) = (v − 1)
                                                  dim T dim G−l(wI wJ )
                                                        v
                                      0 ′
                                                              s′
                        X
              × ζ A(            v 2l(wJ y ) CDλ
                                              s
                                                [D]Ty′ [D−1 ]CD         ′
                                                                 ′ λ′ [D ][D]Ty ′−1 ).

                         y ′ ∈WJ
                         ′
                       y D−1 λ′ =λ

                                                                        s,L
(Notation of 31.5, 31.6. We regard L, L′ as pure of weight 0 and then K̄J,D ,
   ′   ′
  s ,L
K̄ǫ(J),D ′ and their convolution naturally as mixed complexes.)


   The proof is given in 32.7-32.19.
32.7. With notation of 28.7, let

   V = {(B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ ); Bi ∈ B(i ∈ [0, r]),
   Bj′ ∈ B(j ∈ [0, r ′ ]), g ∈ D, g ′ ∈ D′ , gB0 g −1 = Br , g ′ B0′ g ′−1 = Br′ ′ ,
                                                ′
   pos(Bi−1 , Bi ) ∈ {1, si }(i ∈ [1, r]), pos(Bj−1 , Bj′ ) ∈ {1, s′j }(j ∈ [1, r ′ ]),
   pos(Br , B0′ ) ∈ Wǫ(J) }.
                                       s
Let L̄ be the constructible sheaf on Z̄∅,J,D in 28.10 and let L̄′ be the analogous
                                   ′
                         s                                        ′
constructible sheaf on Z̄∅,ǫ(J),D ′ . The inverse image of L̄ ⊠ L̄ under the imbedding
                              ′
         s         s
f :V −
     → Z̄∅,J,D × Z̄∅,ǫ(J),D ′,



                (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ )
                 7→ ((B0 , B1 , . . . , Br , gUJ,B0 ), (B0′ , B1′ , . . . , Br′ ′ , g ′ Uǫ(J),B0′ ))

is a constructible sheaf on V denoted again by L̄ ⊠ L̄′ . Define ρ : V −
                                                                       → ZJ,∆ by

(B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ ) 7→ (QJ,B0 , Qǫ′ ǫ(J),Br′ ′ , xUJ,B0 )

where x = g ′ g ∈ ∆; this is meaningful since g ′ Uǫ(J),B0′ g = g ′ Uǫ(J),Br g = g ′ gUJ,B0 .
We have a commutative diagram in which the left square is cartesian

                               s         s ′               f                 ρ
                             Z̄∅,J,D × Z̄∅,ǫ(J),D ′ ←−−−− V −−−−→ ZJ,∆
                                                                 
                                                           
                                                         h0 y
                                                                   
                                     hy                           1y

                                                           b
                                                           1                 b
                              ZJ,D × Zǫ(J),D′            ←−−−− Z0 −−−2−→ ZJ,∆
8                                                   G. LUSZTIG

where

              h : ((B0 , B1 , . . . , Br , gUJ,B0 ), (B0′ , B1′ , . . . , Br′ ′ , g ′ Uǫ(J),B0′ ))
               7→ ((QJ,B0 , Qǫ(J),Br , gUJ,B0 ), (Qǫ(J),B0′ , Qǫ′ ǫ(J),B′ ′ , g ′ Uǫ(J),B0′ )),
                                                                                     r




                    h0 : (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ )
                     7→ ((QJ,B0 , Qǫ(J),Br , Qǫ′ ǫ(J),B′ ′ , gUJ,B0 )), g ′ Uǫ(J),Br )).
                                                               r


Using this commutative diagram and the definitions we have
                                                     ′   ′
                                        s,L     s ,L                  ′
                                      K̄J,D ∗ K̄ǫ(J),D ′ = ρ! (L̄ ⊠ L̄ ).



Let
                              T = {i ∈ [1, r]; s1s2 . . . si . . . s2 s1 ∈ WL },
                      T ′ = {j ∈ [1, r ′ ]; s′r′ . . . s′j+1 s′j s′j+1 . . . s′r′ ∈ ǫ′ (WL′ )}.
(Thus, T = Js , T ′ = Js′ with the notation of 28.9.) Let

      V ′ = {(B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ ); Bi ∈ B(i ∈ [0, r]),
      Bj′ ∈ B(j ∈ [0, r ′ ]), g ∈ D, g ′ ∈ D′ , gB0g −1 = Br , g ′ B0′ g ′−1 = Br′ ′ ,
      pos(Bi−1 , Bi ) ∈ {1, si }(i ∈ T ), pos(Bi−1 , Bi ) = si (i ∈ [1, r] − T ),
           ′
      pos(Bj−1 , Bj′ ) ∈ {1, s′j }(j ∈ T ′ ), pos(Bj−1
                                                   ′
                                                       , Bj′ ) = s′j (j ∈ [1, r ′ ] − T ′ ),
      pos(Br , B0′ ) ∈ Wǫ(J) },

an open subset of V . Let ρ′ : V ′ −→ ZJ,∆ be the restriction of ρ : V − → ZJ,∆ . From
                          ′                                    ′
28.10 we see that (L̄ ⊠ L̄ )|V ′ is a local system and (L̄ ⊠ L̄ )|V −V ′ = 0. Hence

                                        ρ! (V, L̄ ⊠ L̄′ ) = ρ′! (L̄ ⊠ L̄′ ).

For any
                                                                           ′
(a)                           a = (a0 , a1 , . . . , ar+r′ ) ∈ Wr+r × Wǫ(J) ,

let

         Va′ = {(B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ ) ∈ V ′ ;
            pos(Bk , Br′ ′ ) = ak (k ∈ [0, r]), pos(Br , Br+r
                                                          ′                             ′
                                                              ′ −k ) = ak (k ∈ [r, r + r ])}.



Let ρ′a : Va′ −
              → ZJ,∆ be the restriction of ρ′ : V ′ −  → ZJ,∆ . Then V ′ = ∪a Va′ is a
partition of V ′ with Va′ locally closed in V ′ for all a.
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                            9

Lemma 32.8. Let a as in 32.7(a) be such that (D−1 )∗ L ∼
                                                       6 (a−1
                                                       =         ∗ ′
                                                           r+r′ ) L . Then
ρ′a (L̄ ⊠ L̄′ ) = 0.
                    → ZJ,∆ , π : Va′ −
   Define R, ρ̃ : R −                → R by
 R = {(B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , xUJ,B0 ); Bi ∈ B(i ∈ [0, r]),
   Bj′ ∈ B(j ∈ [0, r ′ ]), x ∈ ∆, pos(Br , B0′ ) = ar+r′ , pos(Br′ ′ , xB0 x−1 ) = ǫ′ (a−1
                                                                                        r+r′ )},

      ρ̃ : (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , xUJ,B0 ) 7→ (QJ,B0 , xQJ,B0 , xUJ,B0 ),

                  π : (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ )
(a)               7→ (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , g ′ gUJ,B0 );
this is meaningful since g ′ Uǫ(J),B0′ g = g ′ Uǫ(J),Br g = g ′ gUJ,B0 and
      pos(Br′ ′ , g ′ gB0 g −1 g ′−1 ) = ǫ′ (pos(g ′−1 Br′ ′ g ′ , gB0 g −1 )) = ǫ′ (pos(B0′ , Br ))
       = ǫ′ (a−1
              r+r′ ).

Since ρ′a = ρ̃π, it suffices to show that π! (L̄ ⊠ L̄′ ) = 0. Hence it suffices to
show that, for any ξ = (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , xUJ,B0 ) ∈ R, we have
Hce (π −1 (ξ), L̄ ⊠ L̄′ ) = 0 for all e. We may assume that π −1 (ξ) 6= ∅. We may
identify
             π −1 (ξ) = {gUJ,B0 ; g ∈ D, gB0 g −1 = Br , xg −1 B0′ gx−1 = Br′ ′ }
                                                                                −1
in an obvious way. We may assume that Br = B ∗ , B0′ = ȧr+r′ B ∗ ȧr+r            ′ (notation of
                         ∗ −1       ′         ′ ∗ ′ −1
28.5). Write Bi = hi B hi , Bj = hj B hj                  with hi , hj ∈ G , hr = 1, h′0 = ȧr+r′ .
                                                                       ′   0

Let
   w = pos(B0 , B1 )pos(B1 , B2 ) . . . pos(Br−1 , Br ) ∈ W,
   w′ = pos(B0′ , B1′ )pos(B1′ , B2′ ) . . . pos(Br′ ′ −1 , Br′ ′ ) ∈ W.
Let T, U ∗ be as in 28.5. Let d ∈ ND B ∗ ∩ ND T, d′ ∈ ND′ B ∗ ∩ ND′ T . Then T
(a maximal torus of Br ∩ B0′ ) acts freely on πa−1 (ξ) by left multiplication and it
suffices to show that for any T -orbit θ in πa−1 (ξ), we have Hce (θ, L̄ ⊠ L̄′ ) = 0 for
all e. Let g0 UJ,B0 ∈ θ. It suffices to show that the inverse image of L̄ ⊠ L̄′ under
t 7→ tg0 UJ,B0 (a local system in s(T )) is ∼        6 Q̄l . Using 28.10 and the definitions
                                                      =
in 28.5, 28.8, we see that this inverse image is just b∗ (L) ⊗ c∗ (L′ ) where L, L′ are
regarded as local systems on T and b : T −          → T, c : T −     → T are given by
                           b(t) = d−1 ẇ−1 n1 n2 . . . nr n0 (n−1
                                                               0 tn0 ),

                           c(t) = d′−1 ẇ′ n′1 n′2 . . . n′r′ n′0 ȧ−1
                                                                    r+r′ t
                                                                           −1
                                                                              ȧr+r′
where ni ∈ NG0 T (i ∈ [1, r]), n′j ∈ NG0 T (j ∈ [1, r ′ ]) are given by h−1               ∗
                                                                              i−1 hi ∈ U ni U ,
                                                                                                 ∗

h′j−1 −1 h′j ∈ U ∗ n′j U ∗ , and n0 ∈ ND B ∗ ∩ ND T , n′0 ∈ ND′ B ∗ ∩ ND′ T are given
by g0 h0 ∈ U ∗ n0 , h′r′ −1 g0−1 xȧr+r′ ∈ U ∗ n′0 . Since d−1 ẇ−1 n1 n2 . . . nr n0 ∈ T ,
d′−1 ẇ′−1 n′1 n′2 . . . n′r′ n′0 ∈ T , n0 ∈ dT , we see using 28.1(a) that b∗ L = Ad(d−1 )∗ L,
                                                                                           ∗ ′ ∼
c∗ L′ = Ad(ȧ−1          ∗ ′
                r+r′ ) Ľ . It then suffices to show that Ad(d          ) L ⊗ Ad(ȧ−1
                                                                     −1 ∗
                                                                                     r+r′ ) Ľ =
                                                                                               6
Q̄l . This follows from our assumption. The lemma is proved.
10                                                G. LUSZTIG

32.9. Until the end of 32.12 we assume that a (as in 32.7(a)) is such that
(a)                          (D−1 )∗ L ∼
                                       = (a−1 ′ )∗ L′ .        r+r

We set a = ar+r′ , a = ǫ ′      ′
                                    (a−1
                                      r+r′ ).   We show that
                                    s1 s2 . . . sr as′1 s′2 . . . s′r′ a′ ∆ ∈ WL
                                                                               •
                                                                                 .
Since s1 s2 . . . sr D ∈ WL•
                             , it suffices to show that D−1 as′1 s′2 . . . s′r′ D′ a−1 D ∈ WL
                                                                                            •
                                                                                              .
       ′ ′         ′   ′     •         •                              ∗      −1  ∗ ∼ ′
Since s1 s2 . . . sr′ D ∈ WL′ = WĽ′ , it suffices to show that a (D ) L = Ľ . This
holds by our assumption. Let
                             w = (s1 , s2 , . . . , sr , a, s′1 , s′2 . . . , s′r′ , a′ ).
Then Z w,a                                                ′
        ∅,J,∆ (see 32.3) is well defined in terms of T , T as in 32.7 (or equivalently
as in 32.2). As in 32.3, L gives rise to a local system L̄a on Z w,a
                                                                  ∅,J,∆ .

32.10. We preserve the setup of 32.9. Let Va′′ be the set of all
    (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , (UBr ∩ UB0′ )g, xUJ,B0 )
where (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , xB0 x−1 , xUJ,B0 ) ∈ Z w,a
                                                                                 ∅,J,∆ and g ∈ D satis-
      −1                    −1 ′               −1 ′
fies g Br g = B0 , g B0 g = x Br′ x. (The last equation is meaningful. It suffices
to show that if u ∈ UJ,B0 then ug −1 B0′ gu−1 = g −1 B0′ g that is, gug −1 ∈ NG B0′ .
We have gug −1 ∈ UǫD (J),gB0 g −1 = UǫD (J),Br = UǫD (J),B0′ ⊂ UB0′ ⊂ NG B0′ .) Define
         → Z w,a
η : Va′′ −      ∅,J,∆ , κ : Va −
                                  ′
                                    → Va′′ by
               η : (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , (UBr ∩ UB0′ )g, xUJ,B0 )
                7→ (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , xB0 x−1 , xUJ,B0 ),

             κ : (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ )
              7→ (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , (UBr ∩ UB0′ )g, g ′gUJ,B0 );
                                                                        → Z w,a
κ is well defined, by the argument following 32.8(a). Let fa = ηκ : Va′ −   ∅,J,∆ .
Clearly,
                                                               0
   (a) κ is an affine space bundle with fibres of dimension l(wǫ(J) a).
                   ′′
Now T acts on Va by
             t :(B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , (UBr ∩ UB0′ )g, xUJ,B0 ) 7→
                (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , (UBr ∩ UB0′ )yt g, xUJ,B0 )
where yt ∈ (Br ∩ B0′ )/(UBr ∩ UB0′ ) is defined by the condition that its image in
                                                 ∼
Br /UBr is the image of t under T −→ Br /UBr . Then
   (b) η is a principal T-bundle.
Let ξ = (B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , B, xUJ,B0 ) ∈ Z w,a
                                                                            ∅,J,∆ . Then η
                                                                                           −1
                                                                                              (ξ) may
be identified with
              {(UBr ∩ UB0′ )g; g ∈ D; g −1 Br g = B0 , g −1 B0′ g = x−1 Br′ ′ x}.
We show only that η −1 (ξ) ∼    = T. It suffices to show that η −1 (ξ) 6= ∅. For this
it suffices to show that pos(B0′ , Br ) = ǫ(pos(x−1 Br′ x, B0 )) or that pos(B0′ , Br ) =
ǫǫ−1         ′
  ∆ (pos(Br , B)) or that a
                             −1
                                 = ǫ′−1 (a′ ) which is clear.
                  CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                              11

32.11. We preserve the setup of 32.9. Let w be the product of the sequence
s1 , s2 , . . . , sr in which the factors si with i ∈ Ta are replaced by 1. Let w′ be
the product of the sequence s′1 , s′2 , . . . , s′r′ in which the factors s′j with j ∈ Ta′
are replaced by 1, (Ta , Ta′ as in 32.3). Let B ∗ , U ∗ , T be as in 28.5. Let d ∈
ND B ∗ ∩ ND T, d′ ∈ ND′ B ∗ ∩ ND′ T . We have a commutative diagram

                                                     f1                 f2
                                        0
                                          Va′    ←−−−− Ṽ ′ −−−−→ T × T
                                                                   
                                       f3 y           f4 y        f5 y
                                                                   

                                                     f6                 f7
                                   0
                                       Z w,a
                                         ∅,J,∆ ←−−−− Z̃ −−−−→                           T

Here
    0
        Va′ = {(B0 , B1 , . . . , Br , B0′ , B1′ , . . . , Br′ ′ , gUJ,B0 , g ′ Uǫ(J),B0′ ) ∈ Va′ ;
                                                                   ′
    Bi−1 = Bi (i ∈ Ta ), pos(Bi−1 , Bi ) = si (i ∈ [1, r] − Ta ), Bj−1 = Bj′ (j ∈ Ta′ ),
         ′
    pos(Bj−1 , Bj′ ) = s′j (i ∈ [1, r ′ ] − Ta′ )},


                                                                                        ′
 Ṽ ′ = {(h0 , h1 , . . . , hr , h′0 , h′1 , . . . , h′r′ , g, g ′) ∈ (G0 )r+r +2 × D × D′ ;
 h−1        ∗            −1        ∗     ∗                     ′
  i−1 hi ∈ B (i ∈ Ta ), hi−1 hi ∈ B ṡi B (i ∈ [1, r] − Ta ), hj−1
                                                                   −1 ′
                                                                     hj ∈ B ∗ (j ∈ Ta′ ),
 h′j−1 −1 h′j ∈ B ∗ ṡ′j B ∗ (j ∈ [1, r ′ ] − Ta′ ), h−1          ′ −1 ′ ′
                                                      r gh0 = d, hr′  g h0 = d′ ,
 h−1 ′     ∗     ∗                   −1 ′          ∗     ∗              ′
  k hr′ ∈ B ȧk B (k ∈ [0, r − 1]), hr hr+r′ −k ∈ B ȧk B (k ∈ [r, r + r − 1]),
 h−1 ′
  r h0 = ȧ},



                                                                               ′
 Z̃ = {(h0 , h1 , . . . , hr , h′0 , h′1 , . . . , h′r′ , x) ∈ (G0 )r+r +2 × D′ D;
 h−1        ∗            −1        ∗     ∗                     ′
  i−1 hi ∈ B (i ∈ Ta ), hi−1 hi ∈ B ṡi B (i ∈ [1, r] − Ta ), hj−1
                                                                   −1 ′
                                                                     hj ∈ B ∗ (j ∈ Ta′ ),
 h′j−1 −1 h′j ∈ B ∗ ṡ′j B ∗ (j ∈ [1, r ′ ] − Ta′ ), h−1 ′     ∗     ∗
                                                      k hr′ ∈ B ȧk B (k ∈ [0, r − 1]),
 h−1 ′          ∗     ∗              ′        −1 ′
  r hr+r′ −k ∈ B ȧk B (k ∈ [r, r + r − 1]), hr h0 = ȧ,

 h′r′ −1 xh0 ∈ B ∗ d′ ȧ−1 d′−1 B ∗ },


            f1 (h0 , h1 , . . . , hr , h′0 , h′1 , . . . , h′r′ , g, g ′) = (h0 B ∗ h−1              ∗ −1
                                                                                     0 , . . . , hr B hr ,
            h′0 B ∗ h′0 −1 , . . . , h′r′ B ∗ h′r′ −1 , gUJ,h0 B∗ h−1 , g ′ UǫD (J),h′0 B∗ h′0 −1 ),
                                                                       0




                        f2 (h0 , h1 , . . . , hr , h′0 , h′1 , . . . , h′r′ , g, g ′)
                         = (d−1 ẇ−1 n1 n2 . . . nr d, d′−1 ẇ′−1 n′1 n′2 . . . n′r′ d′ )
12                                                       G. LUSZTIG

with ni , n′j ∈ NG0 T given by h−1           ∗     ∗             ′
                                  i−1 hi ∈ U ni U (i ∈ [1, r]), hj−1
                                                                     −1 ′
                                                                       hj ∈ U ∗ n′j U ∗ (j ∈
[1, r ′ ]),
                                      → Z w,a
    f3 is the restriction of fa : Va′ −   ∅,J,∆ , see 32.10,


      f4 (h0 , h1 , . . . , hr , h′0 , h′1 , . . . , h′r′ , g, g ′) = (h0 , h1 , . . . , hr , h′0 , h′1 , . . . , h′r′ , g ′ g),

f5 (t, t̃) = d−1 ȧd′−1 ẇ′−1 ȧ−1 dtd−1 ȧẇ′ d′ t̃ȧ−1 d = Ad(d−1 ȧ)(Ad(d′−1 ẇ′−1 ȧ−1 d)(t)t̃),


          f6 (h0 , h1 , . . . , hr , h′0 , h′1 , . . . , h′r′ , x)
           = (h0 B ∗ h−1              ∗ −1   ′ ∗ ′ −1
                      0 , . . . , hr B hr , h0 B h0   , . . . , h′r′ B ∗ h′r′ −1 , xUJ,h0 B∗ h−1 ),
                                                                                                                     0




                  f7 (h0 , h1 , . . . , hr , h′0 , h′1 , . . . , h′r′ , x)
                   = (d′ d)−1 d′ ȧd′−1 ẇ′−1 ȧ−1 ẇ−1 n1 n2 . . . nr ȧn′1 n′2 . . . n′r′ md′ d,

where ni , n′j are as in the definition of f2 , m ∈ NG0 T is given by h′r′ −1 xh0 d−1 d′−1 ∈
U ∗ mU ∗ .
Lemma 32.12. We preserve the setup of 32.11. Let 0 L̄a = L̄a |0 Z w,a
                                                                  ∅,J,∆
                                                                        .
     (a) We have f3∗ (0 L̄a ) = (L̄ ⊠ L̄′ )|0 Va′ .
     (b) We have fa∗ L̄a = (L̄ ⊠ L̄′ )|Va′ .
    From the definitions we have f6∗ (0 L̄a ) = f7∗ L,
    f1∗ ((L̄ ⊠ L̄′ )|0 Va′ ) = f2∗ (L ⊠ Ad(ȧ)∗ Ad(d−1 )∗ Ľ).
Since f1∗ is a smooth morphism with connected fibres, it suffices to show that
f1∗ f3∗ (0 L̄a ) = f1∗ ((L̄ ⊠ L̄′ )|0 Va′ ), or that f4∗ f6∗ (0 L̄a ) = f2∗ (L ⊠ L′ ), or that f4∗ f7∗ L =
f2∗ (L ⊠ L′ ), or that f2∗ f5∗ L = f2∗ (L ⊠ L′ ). It suffices to show that f5∗ L = L ⊠ L′ .
    Define f5′ : T × T −        → T by f5′ (t, t̃) = tt̃. Setting E = Ad(d−1 ȧ) : T −              → T,
  ′             ′−1 ′−1 −1
E = Ad(d ẇ ȧ d) : T −                  → T , we have f5 = Ef5′ (E ′ × 1) hence

         f5∗ L = (E ′ × 1)∗ f5′ ∗ E ∗ L = (E ′ × 1)∗ (E ∗ L ⊠ E ∗ L) = (EE ′ )∗ L ⊠ E ∗ L.

From our assumption we have L′ ∼         = E ∗ L. Moreover, L′ ∼   = Ad(d′−1 ẇ′−1 )∗ L′ =
(E E) L . Hence E L ∼
   ′    ∗ ′             ∗
                           = (E E) E L = (EE E) L = E (EE ′ )∗ L. Since E ∗ is
                                  ′   ∗  ∗          ′   ∗         ∗

faithful, it follows that (EE ′ )∗ L ∼= L. Thus, f5∗ L ∼= L ⊠ L′ . This proves (a).
   We prove (b). We may assume that Va′ 6= ∅. From (a) we see that fa∗ L̄a ,
(L̄ ⊠ L̄′ )|Va′ are two local systems on Va′ with the same restriction to the subset
0 ′
 Va . It then suffices to show that Va′ is smooth, irreducible and 0 Va′ is open dense
in Va′ . By 32.10(a),(b), fa is a fibration with connected smooth fibres and 0 Va′
is the inverse image under fa of 0 Z w,a                                           w,a
                                         ∅,J,∆ . Hence it suffices to show that Z ∅,J,∆ is
smooth, irreducible and 0 Z w,a                         w,a
                               ∅,J,∆ is open dense in Z ∅,J,∆ . This follows from 32.4(c).
The lemma is proved.
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                               13

                                                                     ′
32.13. Let S be the set of all a = (a0 , a1 , . . . , ar+r′ ) ∈ Wr+r × Wǫ(J) such that
  (a) ak ∈ {ak−1 , sk ak−1 } for k ∈ [1, r],
  (b) ak ∈ {ak−1 , ak−1 s′r+r′ +1−k } for k ∈ [r + 1, r + r ′ ],
  (c) (D−1 )∗ L ∼   = (a−1    ∗ ′
                        r+r′ ) L ,
  (d) i ∈ [1, r], ai−1 = ai =⇒ i ∈ T ,
  (e) j ∈ [1, r ′ ], a−j+r+r′ = a−j+1+r+r′ =⇒ j ∈ T ′ .
                                  ′
Lemma 32.14. If a ∈ (Wr+r × Wǫ(J) ) − S then ρ′a! (L̄ ⊠ L̄′ ) = 0.
    If a does not satisfy 32.13(a) or 32.13(b), then Va′ = ∅ and the result is trivial.
If a does not satisfy 32.13(c), the desired result follows from Lemma 32.8. Assume
now that a satisfies 32.13(a)-(c) but it does not satisfy 32.13(d) or (e). Using
ρ′a = πw,a fa and 32.12(b), we see that it suffices to show that πw,a! fa! (fa∗ L̄a ) = 0,
or that πw,a! (L̄a ⊗ fa! Q̄l ) = 0. It suffices to show that πw,a! (L̄a ⊗ He (fa! Q̄l )) = 0
                                                                               0
for any e. By 32.10 we have fa = ηκ and κ! Q̄l = Q̄l [[−c]] where c = l(wǫ(J)       ar+r′ ).
Hence fa! Q̄l = η! Q̄l [[−c]]. Let r = dim T. Since η is a principal T-bundle (see
32.10), the local system    He (η! Q̄l ) admits a filtration whose associated graded is a
                   r
                     
direct sum of 2r−e copies of Q̄l (r − e). Since πw,a! L̄a = 0 (see 32.4(d)), we see
that πw,a! (L̄a ⊗ He (fa! Q̄l )) = 0 for any e. The lemma is proved.
32.15. We now make a short digression. Let X be an algebraic variety over k.
Let C ∈ D(X) and let {Cn ; n ∈ Z} be a sequence of objects in D(X) such that
Cn = 0 for all but finitely many n. We shall write

                                      C ≎ {Cn ; n ∈ Z}

if the following condition is satisfied: there exists a sequence {Cn′ ; n ∈ Z} of objects
in D(X) such that Cn′ = 0 for n ≪ 0, Cn′ = C for n ≫ 0 and distinguished triangles
    ′
(Cn−1   , Cn′ , Cn ) for n ∈ Z.
                                                            f2     f1
   If X, C, Cn are as above, C ≎ {Cn ; n ∈ Z} and X2 −→ X −→ X1 are morphisms
of algebraic varieties, we see from definitions that:
   f1! C ≎ {f1! Cn ; n ∈ Z},
   f2∗ C ≎ {f2∗ Cn ; n ∈ Z}.
Assume now that C ∈ D(X) and that {C u ; u ∈ U} are objects of D(X) indexed
by a finite set U. We shall write

                                      C ≎ {Cu ; u ∈ U}

if the following condition is satisfied: there exists a bijection U ↔ [0, m] such
that, setting Cn = C u if u ↔ n ∈ [0, m] and Cn = 0 for n ∈       / [0, m], we have
C ≎ {Cn ; n ∈ Z}.
   For example, if C ∈ D(X), we have C ≎ {p H n C[−n]; n ∈ Z}; in this case we
can take Cn′ = p τ≤n (C) (truncation, as in [BBD]).
   Similarly, if C ∈ D(X), we have C ≎ {Hn (C)[−n]; n ∈ Z}.
14                                               G. LUSZTIG

   As another example, assume that we are given a partition X = ⊔u∈U X u with
U finite, where X u are locally closed subvarieties of X such that for some bijection
U ↔ [0, m], the union Xn′ = Xn ∪ Xn−1 ∪ · · · ∪ X0 is open in X for any n ∈ [0, m]
(we set Xn = X u for u ↔ n ∈ [0, m]). For any u ∈ U let ju : X u −          → X be
                                  ∗
the inclusion and let Cu = ju! ju C. We have C ≎ {Cu ; u ∈ U}. Indeed, setting
Cn = Cu if u ↔ n ∈ [0, m] and Cn = 0 for n ∈     / [0, m], we have C ≎ {Cn ; n ∈ Z}.
(We can take Cn = 0 for n < 0, Cn = C for n > m, Cn′ = jn!
                ′                    ′                         ′ ′∗
                                                                 jn C for n ∈ [0, m],
         ′    ′
where jn = Xn − → X is the inclusion.)
32.16. Assume that a ∈ S. As in the proof of 32.14 we have ρ′a! (L̄ ⊠ L̄′ ) =
πw,a! (L̄a ⊗fa! Q̄l ) and fa! Q̄l = η! Q̄l [[−c]]. Moreover, η! Q̄l ≎ {He (η! Q̄l )[−e]; e ∈ Z}
                                                              r
and for any e we have He (η! Q̄l ) ≎ {Cee′ ; 1 ≤ e′ ≤ 2r−e          } where Cee′ = Q̄l (r − e).
It follows that

(a)                ρ′a! (L̄ ⊠ L̄′ ) ≎ {πw,a! (L̄a ⊗ He (η! Q̄l ))[−e][[−c]]; e ∈ Z},


                                                                                               
                                                                                            r
(b)                              e
                πw,a! (L̄a ⊗ H (η! Q̄l )[−e][[−c]] ≎           {C ′ee′ ; 1   ≤e ≤  ′
                                                                                                 }
                                                                                         2r − e

where

                                                           (a0 ,ǫ′ (a−1
                                                                     r+r ′
                                                                           )),L
      C ′ee′ = πw,a! (L̄a )(r − e)[−e][[−c]] = KJ,∆                               (r − e)[−e][[−c]][[−Na ]]

(see 32.4(e)). By 32.4(e) we have

(c)                                       a0 ǫ′ (a−1         •
                                                  r+r′ )∆ ∈ WL .


From (a),(b) we see that, if A is a simple perverse sheaf on ZJ,∆ such that A ⊣
                                (a0 ,ǫ′ (a−1
                                          r+r ′
                                                )),L
ρ′a! (L̄ ⊠ L̄′ ) then A ⊣ KJ,∆                         .

32.17. From the partition V ′ = ⊔a Va′ we get as in 32.15

(a)                      ρ! (L̄ ⊠ L̄′ ) = ρ′! (L̄ ⊠ L̄′ ) ≎ {ρ′a (L̄ ⊠ L̄′ ); a ∈ S}

(by 32.14 we can omit the a ∈  / S). Thus, if A is a simple perverse sheaf on ZJ,D such
that A ⊣ ρ! (L̄ ⊠ L̄ ), then for some a ∈ S we have A ⊣ ρ′a! (L̄ ⊠ L̄′ ) hence, by 32.16,
                    ′

          (a0 ,ǫ′ (a−1 ′ )),L
                                        L
A ⊣ KJ,∆ r+r            , so that A ∈ ẐJ,∆ . We also see that S 6= ∅; in particular,
                                                                           s′ ,L′
(D−1 )∗ L ∼                                                         s,L
             = y ∗ L′ for some a ∈ Wǫ(J) (see 32.13(c)). Since K̄J,D ∗ K̄ǫ(J),D′ =
ρ! (L̄ ⊠ L̄′ ) (see 32.7) we see that 32.6(b) holds. We also see that 32.6(a) holds
since, under the assumption of 32.6(a), we can find an A as above.
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                                15

32.18. In this and the next subsection we place ourselves in the setup of 32.6(c).
Then V, V ′ , Va′ are defined over Fq and we can regard ρ′! (L̄ ⊠ L̄′ ) and ρ′a! (L̄ ⊠ L̄′ )
(for any a) as mixed complexes on ZJ,∆ . Using 32.17(a), 32.16(a),(b) (or rather
their variant in the mixed category) and 31.7(c),(e) we see that, with the notation
of 31.6, we have
                             X
                     ′                  ′         ′
      χA
       v (ρ! (L̄ ⊠ L̄ )) =         χA
                                    v (ρa (L̄ ⊠ L̄ ))
                             a∈S
                                                                                  (a0 ,ǫ′ (a−1
                                                                         
          XX                      0
                       e 2Na +2l(wǫ(J ) ar+r ′ )−2r+2e
                                                                       r                    r+r ′
                                                                                                  )),L
      =          (−1) v                                                     χA
                                                                             v (K J,∆                  )
                                                                    2r − e
          a∈S e∈Z
                     X                 0                       (a0 ,ǫ′ (a−1    )),L
      = (v 2 − 1)r         v 2Na −2l(wǫ(J ) ar+r′ ) χA
                                                     v (KJ,∆
                                                                         r+r ′
                                                                                      )
                     a∈S
(a)
                     X                 0                              0    0
      = (v 2 − 1)r         v 2Na −2l(wǫ(J ) ar+r′ ) v dim G−l(wI wJ ) ζ A (Ta0 Tǫ′ (a−1 ′ 1∆λ [∆]).
                                                                                           r+r
                     a∈S


32.19. Let h 7→ h♭ be the antiautomorphism of the algebra Hn defined by Tu 7→
Tu−1 for u ∈ W, 1λ 7→ 1λ for λ ∈ sn . We have (Cλs̃ )♭ = Cssr ...s2 s1 λ where s̃ =
(sr , sr−1 , . . . , s1 ). The following identity in the algebra Hn (see 31.2) is a special
case of one in 31.11:
                                           ′    X          ′    ′
(a)                                Ty Cλs 1 =        v 2δ (y ) Ty′ ′ 1λ1 ;
                                                                       r
                                                y′


here y ∈ W, λ1 ∈ sn , the sum is taken over all sequences y′ = (y0′ , y1′ , . . . , yr′ ′ ) in
W such that
   y = y0′ ,
   yi′ ∈ {yi−1
             ′        ′
                  , yi−1 s′i } for i ∈ [1, r ′ ],
   i ∈ [1, r ′ ], yi−1
                    ′
                        = yi′ =⇒ s′i ∈ Ws′i+1 ...s′ ′ λ1 ;
                                                          r
moreover, δ ′ (y′ ) = |{i ∈ [1, r ′ ]; yi−1′
                                                  s′i < yi−1
                                                         ′
                                                             }|. Similarly, we have
                                                       X
(b)                            Cssr ...s2 s1 λ2 Ty =           v 2δ(y) 1λ2 Ty0 ;
                                                       y


here λ2 ∈ sn , the sum is taken over all sequences y = (y0 , y1 , . . . , yr ) in W such
that
   y = yr ,
   yi ∈ {yi−1 , si yi−1 } for i ∈ [1, r],
   i ∈ [1, r], yi−1 = yi =⇒ si ∈ Wsi−1 ...s1 λ2 ;
moreover, δ(y) = |{i ∈ [1, r]; siyi < yi }|. This can be deduced from (a) using the
involution h 7→ h♭ .
16                                                      G. LUSZTIG

     Combining (a),(b) we obtain (for λ1 , λ2 ∈ sn ) the identity
                                                    ′     X                      ′
                     Cssr ...s2 s1 λ2 Ty Cλs 1 =                   v 2δ(y)+2d(y ) 1λ2 Ty0 1λ1 ;
                                                          y,y′


the sum is taken over the pairs y = (y0 , y1 , . . . , yr ), y′ = (y0′ , y1′ , . . . , yr′ ′ ) of se-
quences in W such that
   y = y0′ , yr′ ′ = yr ,
   yi ∈ {yi−1 , si yi−1 } for i ∈ [1, r],
   yi′ ∈ {yi−1
            ′         ′
                  , yi−1  s′i } for i ∈ [1, r ′ ],
   i ∈ [1, r], yi−1 = yi =⇒ si ∈ Wsi−1 ...s1 λ2 ,
   i ∈ [1, r ′ ], yi−1
                    ′
                          = yi′ =⇒ s′i ∈ Ws′i+1 ...s′r′ λ1 .
We have sr . . . s2 s1 λ = Dλ. Take λ1 = D ′ λ′ , λ2 = λ. Take y ∈ Wǫ(J) such
that yλ′ = Dλ. We replace (y, y′ ) by a = (a0 , a1 , . . . , ar+r′ ) where ak = yk for
                        ′                          ′                ′  ′
k ∈ [0, r], ak = yr+r        ′ −k for k ∈ [r, r + r ]. Then δ(y) + δ (y ) = Na . We obtain


                                                ′              X
                             s
                            CDλ     s
                                Ty CD ′ λ′ =                        v 2Na 1λ Ta0 1D′ λ′ ;
                                                               a

                                                                             ′
the sum is over all a = (a0 , a1 , . . . , ar+r′ ) ∈ Wr+r × Wǫ(J) such that
   y = ar+r′ ,
   ai ∈ {ai−1 , si ai−1 } for i ∈ [1, r],
   ar+r′ −i ∈ {ar+r′ −i+1 , ar+r′ −i+1 s′i } for i ∈ [1, r ′ ],
   i ∈ [1, r], ai−1 = ai =⇒ si ∈ Wsi−1 ...s1 λ ,
   i ∈ [1, r ′ ], ar+r′ −i+1 = ar+r′ −i =⇒ s′i ∈ Ws′i+1 ...s′r′ D′ λ′ .
Equivalently,
                                        ′                      X
(c)                     s
                       CDλ     s
                           Ty CD ′ λ′ =                                 v 2Na 1λ Ta0 1D′ λ′ .
                                                        a∈S;ar+r′ =y


For each a in the sum we have a0 ǫ′ (y −1 )∆λ = λ (see 32.16(a)); combining this with
yλ′ = Dλ we see that a0 D′ λ′ = λ, hence 1λ Ta0 1D′ λ′ = Ta0 1D′ λ′ . We introduce
this in (c), then multiply both sides of (c) on the right by
                                                           0   0
                       (v 2 − 1)r v dim G−l(wI wJ ) v −2l(y) Tǫ′ (y−1 ) 1∆λ [∆]

and sum over y. We obtain
                                0   0                    X                                     ′
        (v 2 − 1)r v dim G−l(wI wJ )                                   v −2l(y) CDλ
                                                                                 s      s
                                                                                    Ty CD ′ λ′ Tǫ′ (y −1 ) [∆]

                                            y∈Wǫ(J ) ;yλ′ =Dλ
                                    0       0       X
         = (v 2 − 1)r v dim G−l(wI wJ )                   v 2Na −2l(ar+r′ Ta0 Tǫ′ (a−1         ) 1∆λ [∆].
                                                                                       r+r ′
                                                    a∈S
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                              17

We apply ζvA (see 31.7) to both sides and use 32.18(a). We obtain
                     ′
      χA
       v (ρ! (L̄ ⊠ L̄ )) =
                              0   0          X              0                   ′
      (v 2 − 1)r v dim G−l(wI wJ ) ζ A (              v 2l(wǫ(J ) y) CDλ
                                                                      s      s
                                                                         Ty CD ′ λ′ Tǫ′ (y −1 ) [∆]).

                                           y∈Wǫ(J )
                                           yλ′ =Dλ


We substitute y = ǫ(y ′ ), y ′ ∈ WJ that is, Ty = [D]Ty′ [D]−1 .                  Since
                ′   ′
      s,L     s   ,L                     ′
χA                         A
 v (K̄J,D ∗ K̄ǫ(J),D′ ) = χv (ρ! (L̄ ⊠ L̄ )), 32.6(c) follows. This completes the proof
of Theorem 32.6.
32.20. Let D cs (ZJ,D ) (resp. D L (ZJ,D ) with L ∈ s(T)) be the subcategory of
D(ZJ,D ) whose objects are those K ∈ D(ZJ,D ) such that for any j, any simple
                                               L
subquotient of p H j K is in ẐJ,D (resp. in ẐJ,D ). We have the following result.
Corollary 32.21. (a) If K ∈ D cs (ZJ,D ), K ′ ∈ D cs (Zǫ(J),D′ ), then K ∗ K ′ ∈
D cs (ZJ,∆ ).
   (b) If L ∈ s(T), K ∈ D L (ZJ,D ), K ′ ∈ D cs (Zǫ(J),D′ ), then K ∗ K ′ ∈ D L (ZJ,∆ ).
    We prove (a). We may assume that K ∈ ẐJ,D , K ′ ∈ Ẑǫ(J),D′ . We can find
                                                                               s,L
s, s′ , L, L′ as in 32.5 and u, u′ ∈ Z such that K[u] is a direct summand of K̄J,D
                                              ′   ′
                                       s ,L
and K ′ [u′ ] is a direct summand of K̄ǫ(J),D             ′    ′
                                              ′ . Then K∗K [u+u ] is a direct summand
              ′   ′
     s,L      s ,L                              L                    ′      ′
of K̄J,D ∗ K̄ǫ(J),D ′ which, by 32.6(b), is in D (ZJ,∆ ). Hence K ∗ K [u + u ] is in

D L (ZJ,∆ ). This proves (a). The same argument proves (b).
32.22. If E is a mixed Q̄l -vector space (that is, a Q̄l -vector space which, when
regarded as P
            a complex over a point, is a mixed complex) we set
   χv (E) = j dim(Ej )v j ∈ A
where Ej is the pure subquotient of weight j of E. We preserve the setup in 32.5.
Assume that D′ = D−1 hence ∆ = G0 . Let S be as in 32.13.
                                                           s    s′
   Define an A-linear map Φ : Hn −  → Hn by ξ 7→ aD (CDλ     ξCD   ′ λ′ ) with aD as in
                                      ′
31.4. For any y ∈ Wǫ(J) such that yλ = Dλ we have
                                              X
                       Φ(Ty 1λ′ ) =                      v 2Na 1Dλ Tǫ(a0 ) 1λ′ .
                                       a∈S;ar+r′ =y


(See 32.19(c).) Define an A-linear map ΘJ : Hn −  → Hn by ΘJ (Tw 1λ1 ) = Tw 1λ1 if
w ∈ WJ , λ1 ∈ sn , ΘJ (Tw 1λ1 ) = 0 if w ∈ W − WJ , λ1 ∈ sn . Replacing J by ǫ(J)
we obtain an A-linear map Θǫ(J) : Hn −   → Hn . Define Φ′ : Hn −  → Hn by Φ′ (ξ ′ ) =
Θ ǫ(J)
       Φ(ξ ). Since Hn is a free A-module and Φ is A-linear, tr(Φ′ , Hn ) ∈ A is well
          ′                                     ′

defined. From the definitions we have
                                       X              X
(a)                 tr(Φ′ , Hn ) =            v 2Na =      v 2Na ,
                                      a∈S;ar+r′ =ǫ(a0 )                a∈S0
18                                               G. LUSZTIG

where S0 = {a ∈ S; a0 = ǫ′ (ar+r′ )}.
                                                                                 ′
    Define an A-linear map Φ′′ : Hn −                      → Hn by ξ 7→ ΘJ (Cλs̃ ′ −1 aD (ξ)Cλs̃ −1 ) where
s̃ = (sr , . . . , s2 , s1 ), s̃′ = (s′r′ , . . . , s′2 , s′1 ). Let ∂ : ZJ,D −
                                                                              → Zǫ(J),D′ be as in 28.19.
                         ′     ′
       s,L         s ,L
Then K̄J,D ⊗ ∂ ∗ K̄ǫ(J),D ′ ∈ D(ZJ,D ) is well defined. Let


                                                              X
                                   µ(G0 ) = (v 2 − 1)r              v 2l(w) ∈ A.
                                                          w∈W


The following result is an application of (the proof of) Theorem 32.6.
Corollary 32.23. Assume that k, Fq , G, F are as in 31.7(b). Then
                                                          ′    ′                    0
                                                  s ,L
        X                             s,L
              (−1)z χv (Hcz (ZJ,D , K̄J,D ⊗ ∂ ∗ K̄ǫ(J),D −1 ) = v
                                                                  2l(wJ )
                                                                          µ(G0 )tr(Φ′ , Hn )
          z
                  0
(a)     = v 2l(wJ ) µ(G0 )tr(Φ′′ , Hn ).


   Let Z = {(Q, Q′ , xUQ ) ∈ ZJ,∆ ; Q = Q′ , x ∈ UQ }, let ι : Z −
                                                                 → ZJ,∆ be the
inclusion and let p : Z −
                        → point be the obvious map. From the definitions, for any
A ∈ D(ẐJ,D ), A′ ∈ D(Zǫ(J),D′ ) we have

(b)                   Hcz (point, p! ι∗ (A ∗ A′ )) = Hcz (ZJ,D , A ⊗ ∂ ∗ (A′ ))

for any z ∈ Z. In particular,
                                                ′   ′
                              s,L         s ,L
                Hcz (ZJ,D , K̄J,D ⊗ ∂ ∗ K̄ǫ(J),D        z             ∗           ′
                                                 ′ ) = Hc (point, p! ι ρ! (L̄ ⊠ L̄ )).



Applying p! ι∗ to 32.17(a) gives

(c)                          p! ι∗ ρ! (L̄ ⊠ L̄′ ) ≎ {p! ι∗ ρ′a! (L̄ ⊠ L̄′ ); a ∈ S}.

Let a ∈ S. Applying p! ι∗ to 32.16(a), 32.16(b) gives

(d)                                  p! ι∗ ρ′a! (L̄ ⊠ L̄′ ) ≎ {Ke ; e ∈ Z},

                                                                          
                                                                        r
(e)                                 Ke ≎   {K ′ee′ ; 1     ′
                                                         ≤e ≤               }
                                                                     2r − e

                                                                   (a0 ,ǫ′ (a−1
                                                                             r+r ′
                                                                                   )),L
where Ke , K ′ee′ ∈ D(point) and K ′ee′ = p! ι∗ KJ,∆                                      (r − e)[−e][[−c − Na ]]
(notation of 32.16). Let

        Xa = {(B0 , B0′ ) ∈ B × B; pos(B0 , B0′ ) = a0 , pos(B0′ , B0 ) = ǫ′ (a−1
                                                                               r+r′ )}
                    CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                          19

and let ω : Xa −
               → point be the obvious map. From the definitions we see that
       (a0 ,ǫ′ (a−1 ′ )),L
p! ι∗ KJ,∆ r+r         = ω! Q̄l . If a0 6= ǫ′ (ar+r′ ) then Xa = ∅ hence ω! Q̄l = 0; if
a0 = ǫ′ (ar+r′ ) that is, a ∈ S0 , then

(f)                       H z (point, ω! Q̄l ) = ⊕w∈W;2l(w)=z Q̄l (−z − l(a0 )).

Using (c),(d),(e),(f) (or rather their variant in the mixed category) we see that
        X
                (−1)z χv (H z (point, p! ι∗ ρ! (L̄ ⊠ L̄′ )))
          z
                                                                             X
                    X                       0
                                 e 2Na +2l(wǫ(J ) ar+r ′ )−2r+2e
                                                                          r
         =                 (−1) v                                                v 2l(w)+2l(a0 )
                                                                       2r − e
               a∈S0 ,e∈Z                                                               w∈W
                    0                   X               X                      0
         =v     2l(wJ )
                          (v 2 − 1)r          v 2l(w)          v 2Na = v   2l(wJ )
                                                                                     µ(G0 )tr(Φ′ , Hn ).
                                        w∈W             a∈S0


It remains to show that tr(Φ′ , Hn ) = tr(Φ′′ , Hn ). Define A-linear maps Ψ′ , Ψ′′ , Ω :
Hn − → Hn by
                                    ′                      ′
              Ψ′ (ξ) = CDλ
                        s    s
                           ξCD         ′′      s̃
                                               λ
                                                       s̃
                               ′ λ′ , Ψ (ξ) = C ′ −1 ξC −1 , Ω(Tw 1λ1 ) = 1 −1 Tw −1 .
                                                       λ                   λ                       1


One checks that
  ΩΨ′ = Ψ′′ Ω, aD ΘJ = Θǫ(J) aD , aD ΘJ Ω = ΩaD ΘJ , Φ′ = Θǫ(J) aD Ψ′ ,
  Φ′′ = ΘJ Ψ′′ aD .
Hence Φ′ = aD ΘJ Ω−1 Ψ′′ Ω = Ω−1 aD ΘJ Ψ′′ Ω and

                    tr(Φ′ , Hn ) = tr(Ω−1 aD ΘJ Ψ′′ Ω, Hn ) = tr(aD ΘJ Ψ′′ , Hn )
                     = tr(ΘJ Ψ′′ aD , Hn ) = tr(Φ′′ , Hn ),

as required. The corollary is proved.
   For λ ∈ s(T) we set Wλ = WL where L ∈ s(T) is in the isomorphism class λ;
this agrees with the definition in 31.2 when λ ∈ sn .
Corollary 32.24. Let A ∈ ẐJ,D , L, L′′ ∈ s(T). Let λ (resp. λ′′ ) be the isomor-
phism class of L (resp. L′′ ). Let s = (s1 , s2 , . . . , sr ), s′′ = (s′′1 , s′′2 , . . . , s′′r′ ) be
                                                                                           s,L
sequences in I such that s1 s2 . . . sr Dλ = λ, s′′1 s′′2 . . . s′′r′ Dλ′ = λ′′ , A ⊣ K̄J,D        and
         ′′    ′′
      s ,λ
A ⊣ K̄J,D  . Then there exist b ∈ Wλ′′ , a0 ∈ WJ such that

(a)                     a0 (λ′′ ) = λ,      s1 s2 . . . sr D = a0 s′′1 s′′2 . . . s′′r′ Dba−1
                                                                                           0 .

                                                                                           ′   ′
    Let A′ = ∂! (D(A)) with ∂ as in 28.19. Then A′ ⊣ K̄ǫsD,L              (J),D′ where s =
                                                                                           ′

(s′1 , s′2 , . . . , s′r′ ) is given by s′k = s′′r′ +1−k and D′ = D−1 , L′ = (D′ )∗ (L′′ ), see
20                                              G. LUSZTIG

28.17, 28.19; hence A ∗ A′ ∈ D(ZJ,∆ ) is well defined with ∆ = D′ D = G0 . By
32.23(b) we have
      Hc0 (point, p! ι∗ (A ∗ A′ )) = Hc0 (ZJ,D , A ⊗ ∂ ∗ (A′ )) = Hc0 (ZJ,D , A ⊗ D(A)).
The last vector space is one dimensional, see [L3, II,7.4]. It follows that
      Hc0 (point, p! ι∗ (A ∗ A′ )) 6= 0.
                                                                                        ′  ′
Now some shift of A ∗ A′ is a direct summand of K̄J,D                       s,L
                                                                                 ∗ K̄ǫsD,L(J),D′ = ρ! (L̄ ⊠ L̄ )
                                                                                                                ′

(see 32.6). Hence Hcz (point, p! ι∗ (ρ! (L̄ ⊠ L̄′ )) 6= 0 for some z ∈ Z. Using this and
32.23(c) we see that there exists a ∈ S such that Hcz (point, p! ι∗ ρ′a! (L̄ ⊠ L̄′ )) 6= 0
for some z ∈ Z. Using this and 32.23(d) we see that there exists e ∈ Z such that
Hcz (point, Ke ) 6= 0 for some z, e ∈ Z. Using this and 32.23(e) we see that there
exists e′ ∈ Z such that Hcz (point, Ke′ ′ e ) 6= 0 for some z, e′ ∈ Z. As in 32.23 we
see that we must have a ∈ S0 . Thus, there exists a sequence a0 , a1 , . . . , ar+r′ in
            ′
Wr+r such that
      ak ∈ {ak−1 , sk ak−1 } for k ∈ [1, r],
      ak ∈ {ak−1 , ak−1 (s′′k−r ) for k ∈ [r + 1, r + r ′ ],
      a0 ∈ WJ , a0 (λ′′ ) = λ, ar+r′ = ǫ(a0 ),
      i ∈ [1, r], ai−1 = ai =⇒ s1 s2 . . . si . . . s2 s1 ∈ Wλ
      j ∈ [1, r ′ ], aj+r−1 = aj+r =⇒ s′′1 . . . s′′j−1 s′′j s′′j−1 . . . s′′1 ∈ Wλ′′ .
For i ∈ [1, r] we set ti = s1 s2 . . . si . . . s2 s1 if ai−1 = ai and ti = 1 if ai−1 ∈                     / ai .
Then ti ∈ Wλ and
      s1 s2 . . . si = ti s1 s2 . . . si−1 ai−1 a−1      i .
It follows that s1 s2 . . . sr = tr tr−1 . . . t1 a0 a−1          r . Similarly for j ∈ [1, r ] we set
                                                                                                          ′

tj = s1 s2 . . . sj . . . s2 s1 if aj+r−1 = aj+r and tj = 1 if aj+r−1 6= aj+r . Then t′′j ∈
 ′′          ′′ ′′        ′′      ′′ ′′                              ′′

Wλ′′ and s′′1 s′′2 . . . s′′j = t′′j s′′1 s′′2 . . . s′′j−1 a−1                                    ′′ ′′
                                                              j+r−1 aj+r . It follows that s1 s2 . . . sr′ =
                                                                                                            ′′

t′′r′ . . . t′′2 t′′1 a−1
                       r ar+r′ . Setting
      τ = tr tr−1 . . . t1 , τ ′′ = t′′r′ . . . t′′2 t′′1 ,
we have τ ∈ Wλ , τ ′′ ∈ Wλ′′ , s1 s2 . . . sr = τ a0 a−1                         ′′ ′′       ′′       ′′ −1
                                                                          r , s1 s2 . . . sr′ = τ ar ǫ(a0 ).
Let b′ = (a−1          0 τ a0 )τ
                                 ′′−1
                                       . Then b′ ∈ Wλ′′ and s1 s2 . . . sr D = a0 b′ s′′1 s′′2 . . . s′′r′ Da−10 .
                          ′′ ′′      ′′   −1 ′ ′′ ′′         ′′            ′′ ′′       ′′       ′′     ′′
We set b = (s1 s2 . . . sr′ D) b s1 s2 . . . sr′ D. Since s1 s2 . . . sr′ Dλ = λ we have
b ∈ Wλ′′ . Moreover, s1 s2 . . . sr D = a0 s′′1 s′′2 . . . s′′r′ Dba−1      0 . The lemma is proved.

32.25. Given (w, λ), (w′ , λ′ ) in W• × s(T) we say that (w, λ) ≍J (w′ , λ′ ) if there
exist a ∈ WJ , b ∈ Wλ′ such that w = aw′ ba−1 , λ = a(λ′ ). We then have
w′ = a−1 w(ab−1 a−1 )a where a−1 ∈ WJ , a−1 (λ) = λ′ , ab−1 a−1 ∈ Waλ′ = Wλ
hence (w′ , λ′ ) ≍J (w, λ). If, in addition, we have (w′ , λ′ ) ≍J (w′′ , λ′′ ) that is,
w′ = ãw′′ b̃ã−1 , λ′ = ã(λ′′ ) with ã ∈ WJ , λ′ = ã(λ′′ ), b̃ ∈ Wλ′′ , then w =
aãw′′ (b̃ã−1 bã)ã−1 a−1 where aã ∈ WJ , λ = aã(λ′′ ), b̃ã−1 bã ∈ Wλ′′ Wã−1 (λ′ ) =
Wλ′′ , hence (w, λ) ≍J (w′′ , λ′′ ). We see that ≍J is an equivalence relation on
W• × s(T).
   We can now reformulate 32.24 as follows.
   (a) To A ∈ ẐJ,D we can associate an equivalence class EA under ≍J so that
the following holds. If L ∈ s(T), λ is the isomorphism class of L and s =
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                  21

                                                                                     s,L
(s1 , s2 , . . . , sr ) is a sequence in I such that s1 s2 . . . sr Dλ = λ and A ⊣ K̄J,D then
(s1 s2 . . . sr D, λ) ∈ EA .
   In particular:
   (b) To A ∈ ẐJ,D we can associate a WJ -orbit OA on s(T) so that the following
holds. If L ∈ s(T), λ is the isomorphism class of L and s = (s1 , s2 , . . . , sr ) is a
                                                                   s,L
sequence in I such that s1 s2 . . . sr Dλ = λ and A ⊣ K̄J,D            then λ ∈ OA .
32.26. Assume now that J = I. We write ≍ instead of ≍I . Thus, (w, λ) ≍ (w′ , λ′ )
if there exist a ∈ W, b ∈ Wλ′ such that w = aw′ ba−1 , λ = a(λ′ ). Let n ∈ N∗k .
     Let A be a character sheaf on D. Let EA be the equivalence class in W• × s(T)
under ≍ defined by A (see 32.25(a)). Let ζ A : Hn [D] −           → A be as in 31.7. We show:
     (a) If s = (s1 , s2 , . . . , sr ) is a sequence in I, λ ∈ sn and ζ A (CDλs
                                                                                  [D]) 6= 0 then
(s1 s2 . . . sr D, λ) ∈ EA .
Indeed, choose L ∈ s(T) in the isomorphism class λ. Our assumption implies
                                            s,L
that s1 s2 . . . sr Dλ = λ hence K̄D            is defined. Moreover our assumption implies
P            j − dim G        p j       s,L                             s,L
    j (−v) v              (A : H (K̄D )) 6= 0. In particular, A ⊣ K̄D       . Hence (a) follows
from 32.25(a).
     We show:
     (b) Let (x, λ) ∈ W × sn be such that ζ A (T̃x 1Dλ [D]) 6= 0. Then (xD, λ) ∈ EA .
                                                                                 s
We argue by induction on l(x). If x = 1 we have T̃x 1Dλ = CDλ                        where s is
the empty sequence and the result follows from (a). Assume now that l(x) ≥
1. From our assumption we have xDλ = λ. We can find a sequence s =
(s1 , s2 , . . . , sr ) in I with x = s1 s2 . . . sr , r = l(x). From the definitions we have
   s
        = y∈WDλ ,xy≤x cy T̃xy 1Dλ with cy ∈ A, c1 = v r . Hence
           P
CDλ
     ζ A (CDλs
                  [D]) = y∈WDλ ,xy≤x cy ζ A (T̃xy 1Dλ [D]).
                           P

If ζ A (T̃xy 1Dλ [D]) 6= 0 for some y ∈ WDλ , xy < x then, by the induction hypothe-
sis, we have (xyD, λ) ∈ EA ; we have (xyD, λ) ≍ (xD, λ) so that (xD, λ) ∈ EA , as
required.
    We may therefore assume that ζ A (T̃xy 1Dλ [D]) = 0 for all y ∈ WDλ such that
xy < x. Then we have ζ A (CDλ     s
                                    [D]) = v r ζ A (T̃x 1Dλ [D]). Hence ζ A (CDλ
                                                                              s
                                                                                 [D]) 6= 0.
Using (a) we see that (xD, λ) ∈ EA , as required. This proves (b).

                                    33. Disjointness
33.1. We fix an irreducible component D of G. For (L, S) ∈ A with S ⊂ D and
E ∈ S(S) we define K as in 5.6; we regard K as a complex on D, zero outside ȲL,S
and we write (L, S, E) ◮G K.
Lemma 33.2. Let (L, S) ∈ A, (L′ , S ′ ) ∈ A with S ⊂ D, S ′ ⊂ D. Let E ∈
S(S), E ′ ∈ S(S ′ ). Let (L, S, E) ◮G K, (L′ , S ′ , E ′ ) ◮G K′ . Assume that E (resp.
E ′ ) is strongly cuspidal and clean (see 23.3) relative to NG L (resp. NG L′ ), that
L = G0 hence YL,S = S and that YL′ ,S ′ 6= S. Then for any i, the local systems Ě,
Hi K′ |S have no common irreducible direct summand.
22                                      G. LUSZTIG

   If L′ = G0 then, since E ′ is clean, we have Hi K′ |S = 0. Assume now that
L′ 6= G0 . By 23.7 we have Hcj (G, K ⊗ K′ ) = 0 for all j. Since K = IC(S̄, E) and E
is clean, we have Hcj (S, K ⊗ K′ ) = 0 for all j hence Hci (S, E ⊗ K′ ) = 0 for all j. We
must show that the local system Hi (E ⊗ (K′ |S )) on S has no direct summand Q̄l .
Assume that Hi0 (E ⊗ (K′ |S )) has a direct summand Q̄l and that i0 is maximum
possible with this property. If a = dim S ′ , we have Hc2a (S, Hi0 (E ⊗ (K′ |S ))) 6= 0.
Hence E22a,i0 6= 0 in the standard spectral sequence

              E2p,q = Hcp (S, Hq (E ⊗ (K′ |S ))) =⇒ Hcp+q (S, E ⊗ (K′ |S )).

By the proof of 23.5 we have Hcp (S, E1 ) = 0 for any E1 ∈ S(S) which has no direct
summand Q̄l ; in particular, taking E1 = Hi (E ⊗ (K′ |S )) with i > i0 we see that
E2p,q = 0 if q > i0 . Clearly, E2p,q = 0 if p > 2a, hence E22a,i0 = E32a,i0 = · · · =
E∞2a,i0
        . Since E22a,i0 6= 0, it follows that Hc2a+i0 (S, E ⊗ (K′ |S )) 6= 0, a contradiction.
The lemma is proved.
Proposition 33.3. Let (L, S) ∈ A, (L′ , S ′ ) ∈ A with S ⊂ D, S ′ ⊂ D. Let
E ∈ S(S), E ′ ∈ S(S ′ ). Let (L, S, E) ◮G K, (L′ , S ′ , E ′ ) ◮G K′ . Assume that E and
Ě (resp. E ′ ) are strongly cuspidal and clean relative to NG L (resp. NG L′ ). Let A
(resp. A′ ) be an admissible complex on D (see 6.7) which is a direct summand of
K (resp. of K′ ). Assume that A ∼    6 A′ . Let Y = YL,S . Let F be the local system
                                      =
A|Y . Then for any i, F is not a direct summand of Hi (A′ )|Y (which is a local
system by 25.2).
    Since ȲL′ ,S ′ is a union of strata of D, we have either Y ∩ ȲL′ ,S ′ = 0 or Y = YL′ ,S ′
or Y ⊂ ȲL′ ,S ′ − YL′ ,S ′ . In the first case we have Hi (A′ )|Y = 0 and the result is
obvious. In the second case we have Hi (A′ )|Y = 0 unless i = 0 and since A ∼          6 A′ ,
                                                                                       =
the local system H0 (A)|Y is irreducible, non-isomorphic to F . Thus, we may
assume that Y ⊂ ȲL′ ,S ′ − YL′ ,S ′ . It is enough to show that for any i, F is not
a direct summand of Hi (K′ )|Y (a local system, by 25.2). Let δ be the connected
component of NG L such that S ⊂ δ. Let su = us ∈ S ∗ with s semisimple, u
unipotent. Let δ̃ be the connected component of ZG (s) such that u ∈ δ̃. Since
su is isolated in NG L, we have δ ZL0 = δ̃ ZZL (s)0 ; we denote this torus by T . Let
R1 be the subvariety of S consisting of all elements of the form yzsuy −1 with
y ∈ ZL (s)0 , z ∈ T . Since R1 is an orbit of a connected group, it is smooth,
irreducible. Let R1∗ = R1 ∩ S ∗ , an open dense subset of R1 (see 25.4, 25.6). Let
π1 : π −1 (R1∗ ) −→ R1∗ be the restriction of π : ỸL,S − → Y (as in 3.13). Let Ẽ be the
local system on ỸL,S defined in 5.6; its restriction to π −1 (R1∗ ) is denoted again by
Ẽ. From the definitions, we have K|R∗1 = π1! Ẽ. By the proof of 3.13(a) we have
    π −1 (R1∗ ) = ⊔xL∈N(L,S)/L {(g, xL); g ∈ R1∗ }
where N (L, S) = {x ∈ NG0 L, xSx−1 = S}. Define ǫ : s−1 R1 −         → R1 by g 7→ sg. We
see that ǫ∗ K|R∗1 = ⊕xL∈N(L,S)/L E x |s−1 R∗1 where E x is the local system on s−1 R1
obtained by taking inverse image of E under s−1 R1 −       → S, g 7→ xsgx−1 . Now s−1 R1
is an isolated stratum of ZG (s) contained in the connected component δ̃ (it is the
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                23

stratum containing u). From 23.4 we see that E x and Ě x are strongly cuspidal and
clean with respect to ZG (s). By 16.12 we can find complexes K′j (j ∈ [1, m]) on δ̃
of the same type as K′ and an open subset U of δ̃ containing all unipotents in δ̃
such that
    (a) ǫ′∗ (K′ |sU ) ∼
                      = ⊕j K′j |U ,
           ′
where ǫ : U −     → sU is g 7→ sg. Note that R1∗ ∩ sU contains su hence is non-empty.
Since sU is open in sδ̃, and R1 is an irreducible subset of sδ̃, we see that R1 ∩ sU
is an open dense subset of R1 . Since R1∗ is another open dense subset of R1 we see
that
    (b) R1∗ ∩ sU = (R1 ∩ sU) ∩ R1∗ is open dense in R1 .
It suffices to show that the local systems Hi (K′ )|R∗1 ∩sU , K|R∗1 ∩sU have no common
irreducible direct summand. Using (a) we see that it suffices to show that for any
j ∈ [1, m], x ∈ N (L, S),
    (c) the local systems Hi (K′j )|s−1 R∗1 ∩U , Esx−1 R∗ ∩U have no common irreducible
                                                        1
direct summand.
Since s−1 R1 is an isolated stratum of ZG (s), Hi (K′j )|s−1 R1 is a local system. Using
(b) we see that (c) would follow from the following statement:
    (d) the local systems Hi (K′j )|s−1 R1 , E x have no common irreducible direct
summand.
By 16.12(b) we may assume that there exists x′ ∈ G0 such that x′−1 sx′ ∈ Ss′ and
the following holds. Let L′′ = x′ L′ x′−1 , S ′′ = x′ S ′ x′−1 , L′0 = L′′ ∩ ZG (s)0 ,
    S0′ is a stratum of NG L′0 contained in δ̃, containing unipotent elements and such
that S0′ ⊂ s−1 S ′′ ,
    E0′ is the local system on S0′ , inverse image of E ′ under S0′ − → S ′ , g 7→ x′−1 sgx′ ,
   ′     ′   ′            ′
(L0 , S0 , E0 ) ◮ZG (s) Kj .
From 23.4 we see that E0′ is strongly cuspidal and clean with respect to NZG (s) (L′0 ).
We see that (d) follows from 33.2 (applied to ZG (s), K′j , Ě x instead of G, K′ , E)
provided we can show that
    (e) YL′0 ,S0′ (defined in terms of ZG (s)) is not equal to s−1 R1 .
Assume that YL′0 ,S0′ = s−1 R1 . Since s−1 R1 is an isolated stratum of ZG (s), it
follows that L′0 = ZG (s)0 and S0′ = s−1 R1 hence ZG (s)0 ⊂ L′′ and u ∈ S0′ . Since
sS0′ ⊂ S ′′ , we have su ∈ S ′′ . We can find a parabolic P ′ of G0 with Levi L′ such
that S ′ ⊂ NG P ′ ∩ NG L′ hence S ′′ ⊂ NG (x′ P ′ x′−1 ) ∩ NG (x′ L′ x′−1 ). We see that
su ∈ NG (x′ P ′ x′−1 ) ∩ NG (x′ L′ x′−1 ). Using 2.1(c) with g = su, Q = x′ P ′ x′−1 , we
see that L(su) ⊂ x′ L′ x′−1 = L′′ where L(su) is defined as in 2.1. We can find a
parabolic P of G0 with Levi L such that S ⊂ NG P ∩NG L hence su ∈ NG P ∩NG L.
Moreover, su is isolated in NG P ∩ NG L. From 3.8(a) we see that L ⊂ L(su).
Combining with L(su) ⊂ L′′ , we see that L ⊂ L′′ . Since Y ⊂ ȲL′ ,S ′ − YL′ ,S ′ , we
have Ȳ ⊂ ȲL′ ,S ′ . Taking images under the map σ : D −           → D//G0 (see 7.1) we
obtain dim σ(Ȳ ) ≤ dim σ(ȲL′ ,S ′ ). Using 7.3(b) we can rewrite the last inequality
                                    ′
in the form dim(δ ZL0 ) ≤ dim(δ ZL0 ′ ) where δ ′ is the connected component of NG L′
that contains S ′ . Equivalently,
24                                       G. LUSZTIG

                            ′′
    (f) dim(δ ZL0 ) ≤ dim(δ ZL0 ′′ )
where δ ′′ is the connected component of NG L′′ that contains S ′′ . From L ⊂
L′′ we deduce ZL′′ ⊂ ZL . Intersecting both sides with ZG (su) and noting that
                                  ′′
su ∈ δ, su ∈ δ ′′ we see that δ ZL′′ ⊂ δ ZL . Taking identity components we have
δ ′′ 0                                      ′′
    ZL′′ ⊂ δ ZL0 . Using (f) we deduce δ ZL0 ′′ = δ ZL0 . Taking the centralizer of
both sides in G0 and using 1.10(a) we obtain L = L′′ . Now S and S ′′ are strata
of NG L = NG L′′ which contain a common point, su. Hence S = S ′′ . Since
(L, S) = (L′′ , S ′′ ) we have YL,S = YL′′ ,S ′′ hence Y = YL′ ,S ′ . This contradicts
Y ⊂ ȲL′ ,S ′ − YL′ ,S ′ and proves (e). The proposition is proved.
33.4. Let I be a finite collection of mutually non-isomorphic character sheaves
on D and let A ∈ I. Let Y = YL,S be the stratum of D such that supp(A) = Ȳ .
Let Ỹ = {(g, xL) ∈ D × G0 /L; x−1 gx ∈ S ∗ } (see 3.13). Define π1 : Ỹ −      → Y by
                                    ′
π1 (g, xL) = g. By 25.2, for any A ∈ I and any i ∈ Z there exists a local system
E ∈ S(S) such that Hi (A′ )|Y is a local system isomorphic to a direct summand of
π1! Ẽ with Ẽ as in 5.6. Replacing E by the direct sum of the local systems E (for
various j, i as above) we see that we may assume that E is the same for all A′ , i.
We can find n′ ∈ N∗k such that E ∈ Sn′ (S). Let δ be the connected component of
                                                                         ′
NG L that contains S. Let g1 ∈ S. Let H = {(z1 , l1 ) ∈ δ ZL0 × L; l1 z1n g1 l1−1 = g1 }.
Let
                                                        ′
   V = {(g, x, z, l) ∈ D × G0 × δ ZL0 × L; x−1 gx = lz n g1 l−1 ∈ S ∗ }.
Now V is irreducible; it is isomorphic to the product of G0 with an open dense
subset of δ ZL0 × L. We have a commutative diagram with cartesian squares

                                              a′            b′
                                       Ỹ ′ ←−−−− Z ′ −−−−→ S ′
                                                            
                                     π2 y        π3 y      π4 y
                                                            

                                 π             a            b
                          Y ←−−1−− Ỹ ←−−−− Z −−−−→ S

where
   S ′ is the space of H 0 -orbits on δ ZL0 × L for the free H 0 -action by right trans-
lation,
   Z = {(g, x) ∈ D × G0 ; x−1 gx ∈ S ∗ },
   Ỹ ′ is the space of (L × H 0 )-orbits on V for the free L × H 0 -action (l0 , (z1 , l1 )) :
(g, x, z, l) 7→ (g, xl0−1, zz1−1 , l0 ll1−1 ),
   Z ′ is the space of H 0 -orbits on V for the free H 0 -action (z1 , l1 )) : (g, x, z, l) 7→
(g, x, zz1−1 , ll1−1 ),
   a(g, x) = (g, xL), b(g, x) = x−1 gx, a′ is the obvious map, b′ (g, x, z, l) 7→ (z, l),
                                                                            ′
π2 (g, x, z, l) = (g, xL), π3(g, x, z, l) = (g, x), π4 (z1 , l1 ) = l1−1 z1n g1 l1 .
Now Ỹ ′ is irreducible since V is irreducible; Ỹ is irreducible since it equals π2 (Ỹ ′ ).
Since E ∈ Sn′ (S), the local system π4∗ E on S ′ is (δ ZL0 × L)-equivariant (for the
action by left translation). Since this action is transitive with connected isotropy
groups, we see that π4∗ E ∼   = Q̄el for some integer e ≥ 1. Hence π3∗ b∗ E = b′∗ π4∗ E ∼
                                                                                        = Q̄el .
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                    25

By definition, a∗ Ẽ = b∗ E. Hence a′∗ π2∗ Ẽ = π3∗ a∗ Ẽ = π3∗ b∗ E ∼     = Q̄el . Since a′ is a
principal L-bundle, it follows that π2∗ Ẽ ∼    = Q̄el . Now π0 := π1 π2 : Ỹ ′ −      → Y is a
                                                                                       0
composition of two (finite) principal coverings (π1 is a principal H/H -covering
since π4 is a principal H/H 0 -covering; π1 is a principal covering by 3.13(a)) hence
it is a not necessarily principal, finite unramified covering. Let N = |π0−1 (y)|
for some/any y ∈ Y . Let Y ′′ be the set of all pairs (y, f ) where y ∈ Y and
                       → π0−1 (y) is a bijection. Then Y ′′ is an algebraic variety and
f : {1, 2, . . . , N } −
π0′ : Y ′′ −→ Y, (y, f ) 7→ y is a principal covering whose group is the symmetric
                                                τ       π0
group SN . Moreover, π0′ factors as Y ′′ −      → Ỹ ′ −→    Y where τ (y, f ) = f (1). Let Ŷ
                                      ′′
be a connected component of Y . Then τ0 : Ŷ −            → Ỹ ′ (restriction of τ ) is a finite
unramified covering. Let π : Ŷ −     → Y be the restriction of π0′ . Then π is a (finite)
principal bundle whose group is the group Γ consisting of all elements of SN which
                                                   τ1        π1
map Ŷ into itself. Moreover, π factors as Ŷ −→        Ỹ −→    Y where τ1 = π1 τ0 is a finite
unramified covering. Since π2∗ Ẽ ∼   = lQ̄e
                                             , we have   τ ∗ ∼
                                                           1 Ẽ = Q̄el . Hence any irreducible
direct summand of the local system Ẽ is a direct summand of τ1! Q̄l . Now let E1
be an irreducible local system on Y which is a direct summand of π1! Ẽ. We can
find an irreducible direct summand E2 of Ẽ such that E1 is a direct summand of
π1! E2 . Then E2 is a direct summand of τ1! Q̄l , hence π1! E2 is a direct summand of
π1! τ1! Q̄l = π! Q̄l . Since E1 is a direct summand of π1! E2 it follows that
    (a) E1 is a direct summand of π! Q̄l .
Let C be the category whose objects are local systems on Y which are direct sums
of irreducible direct summands of π! Q̄l . Let CΓ be the category of Q̄l [Γ]-modules
of finite dimension over Q̄l . We have an equivalence of categories CΓ −                 → C: it
                                                                         ∗          Γ
attaches to an object M of CΓ the local system [M ] = (M ⊗ π! Q̄l ) in C; here
π! Q̄l is regarded naturally as a local system with Γ-action, M ∗ is the dual of M
and the superscript denotes Γ-invariants. Using (a) and the definition of E, we see
that, for any A′ ∈ I, i ∈ Z, we have Hi (A′ )|Y ∈ C. Hence Hi (A′ )|Y ∼             = [MA′ ,i ] for
some MA′ ,i ∈ CΓ , well defined up to isomorphism. Let e = dim Y . Then MA,−e is
an irreducible object of CΓ .
    In the remainder of this section we assume that:
    (b) D is clean in the sense that, for any parabolic subgroup P of G0 such that
ND P 6= ∅, any cuspidal character sheaf of ND P/UP is 0 on the complement of
some isolated stratum of ND P/UP .
We show:
    (c) if A′ ∈ I, i ∈ Z and A′ 6= A then MA′ ,i contains no direct summand iso-
morphic to MA,−e .
This follows from 33.3 which is applicable in view of (b), the admissibility of char-
acter sheaves (30.6), the strong cuspidality of cuspidal character sheaves (31.15)
and the fact that D(A) is a character sheaf (28.18).
    In the remainder of this section we assume that k is an algebraic closure of a
finite field Fq and that G has a fixed Fq -rational structure whose Frobenius map
F induces the identity map on G/G0 . Replacing Fq by a finite extension, we may
26                                        G. LUSZTIG

assume that F (Y ) = Y , that Ŷ and π : Ŷ −       → Y are defined over Fq , that the
Frobenius map F : Ŷ −   → Ŷ satisfies F (γ ŷ) = γF (ŷ) for all γ ∈ Γ, ŷ ∈ Ŷ , that
  ∗ ′ ∼     ′         ′
F A = A for all A ∈ I and that for any γ ∈ Γ and any integer m ≥ 1 there
exists ŷγ,m ∈ Ŷ such that F m (ŷγ,m ) = γ ŷγ,m . (We then set yγ,m = π(ŷγ,m ).)
   Let M ∈ CΓ . The stalk of [M ] at y ∈ Y is the vector space

       [M ]y = {f : π −1 (y) −
                             → M ∗ ; f (ŷ) = γ(f (γ −1ŷ)) for all γ ∈ Γ, ŷ ∈ Ŷ }.

Let m ≥ 1. For any R ∈ AutCΓ (M ∗ ) there is a unique isomorphism of local systems
                ∼
R̃ : F m∗ [M ] −→ [M ] such that for any y ∈ Y , R̃ induces on stalks the linear map
R̃y : [M ]F m(y) −  → [M ]y which to a function f : π −1 (F m (y)) −  → M ∗ associates
the function f ′ : π −1 (y) −   → M ∗ given by f ′ (ŷ) = R(f (F −m (ŷ))). Clearly, any
                            ∼
isomorphism F m∗ [M ] −→ [M ] is of the form R̃ for a unique R as above.
    For γ ∈ Γ we have an isomorphism
                    ∼
    (d) [M ]yγ,m −→ M ∗ , f 7→ f (ŷγ,m ).
If R is as above then R̃yγ,m maps [M ]yγ,m into itself (since F m (yγ,m ) = yγ,m ) and
it corresponds under (d) to the automorphism γ −1 R = Rγ −1 : M ∗ −        → M ∗ . Hence
    (e) tr(R̃yγ,m , [M ]yγ,m ) = tr(γ −1 R, M ∗ ) = tr(t Rγ, M ).
33.5. Let V be an algebraic variety defined over Fq with Frobenius map F : V −
                                                                             →
                                 ∗    ∼
V . Let K ∈ D(V ) and let φ : F K −→ K be an isomorphism. For any integer
                                   ∼
m ≥ 1 we denote by φ(m) : F m∗ K −→ K the composition

                      (F m−1 )∗ φ                 (F m−2 )∗      F ∗φ         φ
          (F m )∗ K −−−−−−→ (F m−1 )∗ K −−−−−→ . . . −−→ F ∗ K −
                                                               → K.
                                                                             ∼
33.6. For each A′ ∈ I we choose an isomorphism κA′ : F ∗ A′ −→ A′ . Let κ′A :
           ∼
F ∗ D(A) −→ D(A) be the isomorphism such that for any y ∈ Y the isomorphism
                ∼                                   ∼
H−e D(A)F (y) −→ H−e D(A)y (that is, H−e (A)ˇF (y) −→ H−e (A)ˇy ) induced by κ′A is
                                                                       ∼
q dim D−e times the transpose inverse of the isomorphism H−e (A)F (y) −→ H−e (A)y
induced by κA .
Proposition 33.7. Let A′ ∈ I. For any integer m ≥ 1 we have
                                X
(a)      q −(dim D−e)m |Γ|−1          χA′ ,κ(m) (yγ,m )χD(A),κ′A (m) (yγ,m ) = δA,A′ .
                                           A′
                                γ∈Γ



  Under an isomorphism Hi (A′ )|Y             ∼
                                              =    [MA′ ,i ], the isomorphism
             ∼                         (m)   ∗m ′ ∼
F H (A ) −→ H (A ) induced by κA′ : F A −→ A′ corresponds to an iso-
 ∗m i      ′       i     ′
                             ∼
morphism F ∗m [MA′ ,i ] −→ [MA′ ,i ] which must be of the form R̃ for some R =
Rm,A′ ,i ∈ AutCΓ (MA∗ ′ ,i ) hence

                          (m)
                     tr(κA′ , Hi (A′ )yγ,m ) = tr(t Rm,A′ ,i γ, MA′ ,i ).
                 CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                  27

Next we have
                                                                   (m)
           tr(κ′A (m) , H−e (D(A))yγ,m ) = q (dim D−e)m tr((κA )−1 , H−e (A)yγ,m )
                                −1
           = q (dim D−e)m tr(t Rm,A,−e γ −1 , MA,−e ).

Hence the left hand side of (a) equals
            X                    X
                                                                      −1
(b)              (−1)i+e |Γ|−1         tr(t Rm,A′ ,i γ, MA′ ,i )tr(t Rm,A,−e γ −1 , MA,−e )
             i                   γ∈Γ


that is,
     X                                                     X
           (−1)i+e |Γ|−1 tr((t Rm,A′ ,i ⊗ t Rm,A,−e )          (γ ⊗ γ −1 ), MA′ ,i ⊗ MA,−e ).
       i                                                   γ∈Γ

                    ′
AssumePfirst that A   6= A. To show that (b) is zero it is enough to show that for
                  −1
any i, γ∈Γ (γ ⊗ γ ) acts as 0 on MA′ ,i ⊗ MA,−e . This follows from the fact that
                                                  ∗
the Γ-invariant part of the Γ-module MA′ ,i ⊗ MA,−e    is zero (see 33.4(c)).
                        ′
   Assume next that A = A. Then we have MA′ ,i = 0 unless i = −e. We must
show that
                 X
                                                 −1
           |Γ|−1    tr(t Rm,A,−e γ, MA,−e )tr(t Rm,A,−e γ −1 , MA,−e ) = 1.
                     γ∈Γ


Since MA,−e is an irreducible Γ-module, t Rm,A,−e acts as on it as a scalar, hence
the desired equality follows from the Schur orthogonality relations for irreducible
characters of Γ.

                                 34. The structure of HnD
34.1. We give (a variant of) some definitions in [L13, 1]. Let R be a commutative
ring with 1. Let A be an associative R-algebra with 1 with a given finite basis
B as an R-module.
              P           We assume that 1 is compatible with B in the following
sense: 1 =         1
                 λ λ    where  1λ ∈ B are distinct, 1λ 1λ′ = δλ,λ′ 1λ and any b ∈ B
satisfies 1λ b1λ′ = b for some (uniquely determined) λ, λ′ . For b, b′ ∈ B we have
                b′′ ′′            b′′
bb′ = b′′ ∈B rb,b                                            ′       ′
       P
                   ′b    where rb,b   ′ ∈ R. We say that b  b if b ∈ ∩K∈F;b∈K K where
                                                            P
F is the collection of all subsets K of B such that b1 ∈K Rb1 is a two-sided ideal
of A; we say that b ∼ b′ if b′  b and b  b′ . This is an equivalence relation on B
and the equivalence classes are the two-sided cells. (Replacing two-sided ideals by
left ideals in the definition of  and of two-sided cells we obtain the notion of left
cells. The left cells form a partition of B finer than that given by two-sided cells.)
We say that b′ ≺ b if b′  b and b′ 6∼ b. For any b ∈ B let A≺b = ⊕b′ ∈B;b′ ≺b Rb.
   Assume now that R = A = Z[v, v −1 ]. Let b ∈ B. We can find an integer m ≥ 0
                  b′′
such that v −m rb,b   ′ ∈ Z[v
                              −1
                                 ] for any b′ , b′′ in the two-sided cell of b. The smallest
28                                               G. LUSZTIG

such m is denoted by a(b). We say that B satisfies P1 if a(b) = a(b′ ) whenever
b, b′ are in the same two-sided cell. Assume that B satisfies P1 . For b ∈ B we set
b̂ = v −a(b) b ∈ A. Let A− = b∈B Z[v −1 ]b̂ ⊂ A. Then A− is an associative Z[v −1 ]-
                                      P
                                                                          b′′ ′′
algebra for the multiplication b̂ ∗ b̂′ = b′′ ∈B;b′′ ∼b v −a(b) rb,b              if b ∼ b′ , b̂ ∗ b̂′ = 0
                                                      P
                                                                             ′ b̂

if b 6∼ b′ . Let A∞ = A− /v −1 A− and let tb = b̂ + v −1 A− ∈ A∞ . Then A∞ is a ring
                                                                                                    b′′
                                                                                         P
with Z-basis {tb ; b ∈ B} and with multiplication defined by tb tb′ = b′′ ∈B γb,b                       ′ tb′′

           b′′                           −a(b) b′′        b′′     −1       −1             ′ ′′
where γb,b′ ∈ Z is given by v                 rb,b′ = γb,b′ mod v Z[v ] if b, b , b are in the
                                    ′′
                                  b                                                                ∞
same two-sided cell and γb,b           ′ = 0, otherwise. We say that B satisfies P2 if A                 has
a unit element compatible with the basis {tb ; b ∈ B}. We say that B satisfies P3
if for any b1 , b2 , b3 , b4 ∈ B such that b2 ∼ b4 we have

                              rbβ1 ,b2 (v)rβ,b                  rbβ14,β (v)rββ2 ,b3 (v ′ )
                      X                                       X
                                            b4      ′
                                               3
                                                 (v   ) =
                  β∈B;β∼b2                                  β∈B;β∼b2


where v ′ is an indeterminate independent of v. In this case, assuming also that
b2 ∼ b3 ∼ b4 , we pick the coefficient of v ′a(b2 ) = v ′a(b4 ) in both sides and we obtain

                                        rbβ1 ,b2 γβ,b                     rbβ14,β γββ2 ,b3 .
                              X                                X
                                                  b4
(a)                                                  3
                                                       =
                           β∈B;β∼b2                         β∈B;β∼b2


Assume that B satisfies P1 , P2 , P3 . The unit element of A∞ is of the form
                                                                                                            P
                                                                                                                 b∈D tb
where D ⊂ B. We say that D is the set of distinguished elements of B.
  Let A∞           ∞
       A = A ⊗ A . We define an A-linear map Φ : A −        → A∞ A by
                                                        X
                                                                      b2
                                   Φ(b) =                            rb,b 1
                                                                            tb2
                                               b1 ∈D,b2 ∈B;b1 ∼b2


for b ∈ B. Then Φ is an A-algebra homomorphism taking 1 to 1. If we identify
A, A∞                                               ∞
     A as A-modules via b ↔ tb , the obvious left AA -modulePstructure on AA
                                                                                ∞
                                                                       ′′
becomes the left A∞                                        ′
                   A -module structure on A given by tb ∗ b =
                                                                      b     ′′
                                                              b′′ ∈B γb,b′ b . For
x ∈ A, b ∈ B we have
   (b) xb = Φ(x) ∗ b mod A≺b .
Indeed, we may assume that x ∈ B. Using (a), we have
                               X                                             X                         ′′
                                                b2                                              b2
         Φ(x) ∗ b =                            rx,b1
                                                     tb2 ∗ b =                                 rx,b γ b b′′
                                                                                                   1 b2 ,b
                       b1 ∈D,b2 ∈B;b1 ∼b2                         b1 ∈D,b2 ,b′′ ∈B;b1 ∼b2
                                                   ′′                                            ′′   b′
                        X                                                  X
                                           b2
         =                                rx,b γ b b′′ =
                                              1 b2 ,b
                                                                                                b
                                                                                               rx,b′ γ
                                                                                                       1
                                                                                                   1 b1 ,b
                                                                                                           b′′
             b1 ∈D,b2 ,b′′ ∈B;b1 ∼b∼b′′                        b1 ∈D,b′1 ,b′′ ∈B;b1 ∼b∼b′′
                      X                   ′′                  X             ′′
         =                             b
                                      rx,b γbb1 ,b b′′ =                   b
                                                                          rx,b b′′ = xb mod A≺b ,
             b1 ∈D,b′′ ∈B;b1 ∼b∼b′′                        b′′ ∈B;b∼b′′


as required.
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                           29

    Let K be a field and let A −   → K be a homomorphism of rings with 1. Let
                    ∞            ∞
AK = K ⊗A A, AK = K ⊗Z A , AK,≺b = K ⊗A A≺b (b ∈ B). Then Φ induces a
K-algebra homomorphism ΦK : AK −       → A∞K . We show:
    (c) If AK is a semisimple algebra then ΦK is an (algebra) isomorphism.
Since AK , A∞  K have the same (finite) dimension, it suffices to show that ΦK is
injective. The A∞                                           ∞
                   A -module structure on A extends to an AK -module structure on
AK denoted again by ∗. From (b) we deduce that xb = ΦK (x) ∗ b mod AK,≺b
for any x ∈ AK , b ∈ B. In particular, if x ∈ KerΦK , b ∈ B then xb ∈ AK,≺b .
Applying this repeatedly, we see that for any m ≥ 1, any x1 , x2 , . . . , xm in KerΦK
and any b ∈ B, x1 x2 . . . xm b is a K-linear combination of elements b′ ∈ B such
that b′ = bm ≺ bm−1 ≺ · · · ≺ b0 = b (with bi ∈ B). If m is large enough, no such
b′ exists. Thus for large enough m we have x1 x2 . . . xm b = 0 for all b ∈ B hence
x1 x2 . . . xm = 0. We see that KerΦK is a nilpotent two-sided ideal of AK . Hence
it is 0. Thus ΦK is injective and (c) is proved.
34.2. Let D be a connected component of G0 . Let WD be the subgroup of
W• ⊂ Aut(T) generated by W and by D. Now W is a normal subgroup of WD
and WD /W is a finite cyclic group.
   We fix n ∈ N∗k . Let λ ∈ sn . We write Rλ instead of RL (see 28.3) where λ is
the isomorphism class of L ∈ sn . Then Rλ is a root system and Rλ+ = Rλ ∩ R+ is
a set of positive roots for Rλ . Let Πλ be the unique set of simple roots for Rλ such
that Πλ ⊂ Rλ+ . Recall that Wλ , the subgroup of W generated by {sα ; α ∈ Rλ }
is the Weyl group of the root system Rλ . Let Iλ = {sα ; α ∈ Πλ } ⊂ Wλ . Then
(Wλ , Iλ ) is a Coxeter group. Let WλD = {w ∈ WD ; wλ = λ}. Let ΩD              λ = {w ∈
WλD ; w(Rλ+ ) = Rλ+ }. (Here WD acts on R by w : α 7→ wα, (wα)(t) = α(w−1 t)
for t ∈ T.) Then Wλ is a normal subgroup of WλD , ΩD              λ is a subgroup of Wλ
                                                                                       D

and WλD is the semidirect product of Wλ and ΩD              λ . Define l : W
                                                                              D
                                                                                 −
                                                                                 → N by
                        +              −
l(w) = |{α ∈ R ; w(α) ∈ R }|. This extends the length function W −                 → N.
                    D                                 +            −           D
Define lλ : W −         → N by lλ (w) = |{α ∈ Rλ ; w(α) ∈ R }|. Then Ωλ = {w ∈
   D
Wλ ; lλ (w) = 0}, Iλ = {w ∈ Wλ ; lλ (w) = 1}. The standard partial order ≤λ of
the Coxeter group Wλ is extended to a partial order ≤λ on WλD as follows: if
w1 , w1′ ∈ ΩD             ′                                 ′ ′           ′
               λ , w2 , w2 ∈ Wλ , we say that w1 w2 ≤λ w1 w2 if w1 = w1 and w2 ≤λ w2 .
                                                                                       ′

   Let HλD be the A-algebra defined by the generators T̃wλ (w ∈ WλD ) and relations
                                     ′             ′                  ′
   (a) T̃wλ T̃wλ′ = T̃wwλ                D
                            ′ if w, w ∈ Wλ , lλ (ww ) = lλ (w) + lλ (w ),

   (b) (T̃σλ )2 = T̃1λ + (v − v −1 )T̃σλ for σ ∈ Iλ .
Then {T̃wλ ; w ∈ WλD } is an A-basis of HλD . Let Hλ be the A-submodule of HλD
with A-basis {T̃wλ ; w ∈ Wλ }. This is an A-subalgebra of HλD . Let ¯ : HλD −         →
HλD be the unique ring homomorphism such that v m T̃wλ = v −m (T̃wλ−1 )−1 for all
w ∈ WλD , m ∈ Z. From the definitions, for any w ∈ WλD we have T̃wλ − T̃wλ ∈
                      λ
P
  y∈WD ;y≤λ w,y6=w AT̃y . By an argument similar to one in [L12, 5.2] we see that
       λ

for any w ∈ WλD there is a unique element cλw ∈ HλD such that cλw = cλw and
cλw − T̃wλ ∈ y∈WD ;y6=w v −1 Z[v −1 ]T̃yλ . Also, {cλw ; w ∈ WλD } is an A-basis of HλD
            P
                   λ
30                                    G. LUSZTIG

and {cλw ; w ∈ Wλ } is an A-basis of Hλ (as in [KL]).
Lemma 34.3. The A-algebra HλD with its basis (cλw )w∈WλD satisfies P1 , P2 , P3 in
34.1.
   The analogous statement where HλD , WλD are replaced by Hλ , Wλ holds by
[L12, §15]. The proof of the lemma is entirely similar; alternatively, it can be
reduced to the case of Hλ using the identities
   (a) cλw1 w2 = T̃wλ1 cλw2 , cλw2 w1 = cλw2 T̃wλ1 for w1 ∈ ΩD
                                                             λ , w2 ∈ Wλ ,
                                                  ′
   (b) T̃wλ1 T̃wλ′ = T̃wλ1 w′ for w1 ∈ ΩD              D
                                           λ , w1 ∈ Ωλ .
              1        1


   The function a : {cλw ; w ∈ WλD } −     → N (see 34.1) is determined by the analo-
                         λ
gous function a : {cw ; w ∈ Wλ } −      → N (defined in terms of Hλ ) by a(cλw1 w2 ) =
a(cλw2 w1 ) = a(cλw2 ) for w1 ∈ ΩD                                          λ
                                   λ , w2 ∈ Wλ . The two-sided cells of {cw ; w ∈ Wλ }
                                                                                       D

are the sets of the form T̃wλ1 cT̃wλ′ where w1 , w1′ run through ΩDλ and c is a two-sided
                                    1
           λ
cell of {cw ; w ∈ Wλ }. We show:
   (c) If cλw (w ∈ WλD ) is a distinguished basis element of HλD (see 34.1) then
w ∈ Wλ and w2 = 1.
By [L12] any left cell of Wλ contains a unique distinguished basis element. By the
same argument, any left cell of WλD contains a unique distinguished basis element.
Let Γ be the left cell of WλD that contains cλw . (See 3.1.) Write w = w1 w2 with
w1 ∈ ΩD                                           λ       λ λ    λ       λ
          λ , w2 ∈ Wλ . From (a) we have cw = T̃w1 cw2 , cw2 = T̃w −1 cw λ . Hence
                                                                         1
cλw2 ∈ Γ. We see that, if Γ′ is the left cell of Wλ that contains cλw2 , then Γ′ ⊂ Γ.
Let cλw3 be the unique distinguished basis element of Wλ that is contained in Γ′ .
Then cλw3 is also a distinguished basis element of WλD contained in Γ hence, by
uniqueness, we have cλw3 = cλw . We see that w = w3 ∈ Wλ . The fact that w2 = 1
also follows from [L12].

34.4. Let HnD be the A-algebra with 1 defined by the generators T̃w (w ∈ WD ),
1λ (λ ∈ sn ) and the relations
   1λ 1λ = 1λ for λ ∈ sn , 1λ 1λ′ = 0 for λ 6= λ′ in sn ,
   T̃w T̃w′ = T̃ww′ for w, w′ ∈ WD with l(ww′ ) = l(w) + l(w′ ),
   T̃w 1λ = 1wλ T̃w for w ∈ WD , λ ∈ sn ,
   T̃s2 = T̃1 + (v − v −1 ) λ;s∈Wλ T̃s 1λ for s ∈ I,
                           P
          P
   T̃1 = λ 1λ .
We identify Hn (see 31.2) with the subalgebra of HnD generated by T̃w (w ∈
W), 1λ (λ ∈ sn ) by Tw 7→ v l(w) T̃w (w ∈ W), 1λ 7→ 1λ (λ ∈ sn ). There is a
unique ring homomorphism ¯: HnD −     → HnD such that T̃w = T̃w−1 −1 for all w ∈ W ,
                                                                                     D

v m 1λ = v −m 1λ for all λ and all m ∈ Z. It has square 1. Its restriction to Hn is the
involution¯: Hn −  → Hn described in 31.3. From the definitions, for any w ∈ WD ,
                                   P
λ ∈ sn we have T̃w 1λ − T̃w 1λ ∈ y∈WD ;y≤w,y6=w AT̃y 1λ . By an argument similar
to one in [L12, 5.2] we see that for any w ∈ WD , λ ∈ sn , there is a unique element
                 CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                                 31

cw,λ ∈ HnD such that cw,λ = cw,λ and cw,λ − T̃w 1λ ∈ y∈WD ;y6=w v −1 Z[v −1 ]T̃y 1λ .
                                                      P

We have cw,λ ∈ 1wλ HnD 1λ . Also, {cw,λ ; w ∈ WD , λ ∈ sn } is an A-basis of HnD .
Proposition 34.5. The A-algebra HnD with its basis (cw,λ )(w,λ)∈WD ×sn satisfies
P1 , P2 , P3 in 34.1.
   The proof is given in 34.10.
34.6. In the setup of 34.2, the A-algebra 1λ HnD 1λ (a subalgebra of HnD ) has a
unit element 1λ , an A-basis {T̃w 1λ ; w ∈ WλD } and an A-basis {cw,λ ; w ∈ WλD }.
Lemma 34.7. The A-algebra 1λ HnD 1λ with its basis {cw,λ ; w ∈ WλD } satisfies
P1 , P2 , P3 in 34.1.
    Define ϑλ : HλD −       → 1λ HnD 1λ by T̃wλ 7→ T̃w 1λ (an isomorphism of A-modules).
Using 34.3, we see that it suffices to show that ϑλ is an isomorphism of A-algebras
carrying cλw to cw,λ for any w ∈ WλD . We use the notation in 34.2. We show:
    (a) Let w ∈ WD , α ∈ Πλ , σ = sα ∈ Iλ . Then T̃w T̃σ 1λ = T̃wσ 1λ +δ(v−v −1 )T̃w 1λ
(in HnD ) with δ ∈ {0, 1}. If in addition w ∈ WλD then δ = 0 if lλ (wσ) > lλ (w)
and δ = 1, otherwise.
The proof has some common features with one in [MS, 3.3.5]. We have σ =
s1 s2 . . . sr with si ∈ I, r = l(σ). By [L3, I, 5.3], there exists j ∈ [1, r] such that
sr . . . sj+1 sj sj+1 . . . sr ∈ Wλ and sr . . . si+1 si si+1 . . . sr ∈
                                                                       / Wλ for i ∈ [1, r] − {j};
by [L3, I, 5.6], we have σ = sr . . . sj+1 sj sj+1 . . . sr . Hence s1 s2 . . . sj−1 sj+1 . . . sr =
1. From the relations of HnD we have:

T̃ws1 s2 ...sj−1 T̃sj 1sj+1 ...sr λ = T̃ws1 s2 ...sj 1sj+1 ...sr λ + δ ′ (v − v −1 )T̃ws1 s2 ...sj−1 1sj+1 ...sr λ

where δ ′ = 0 if l(ws1 s2 . . . sj ) > l(ws1 s2 . . . sj−1 ) and δ ′ = 1 otherwise,

                         T̃ws1 s2 ...si−1 T̃si 1si+1 ...sr λ = T̃ws1 s2 ...si 1si+1 ...sr λ

for i ∈ [1, r] − {j},

            T̃ws1 s2 ...sj−1 sj+1 ...si−1 T̃si 1si+1 ...sr λ = T̃ws1 s2 ...sj−1 sj+1 ...si 1si+1 ...sr λ

for i ∈ [j + 1, r]. From these identities we see that

          T̃w T̃σ 1λ = T̃w T̃s1 T̃s2 . . . T̃sr 1λ = T̃ws1 s2 ...sj−1 T̃sj T̃sj+1 . . . T̃sr 1λ
           = T̃ws1 s2 ...sj T̃sj+1 . . . T̃sr 1λ + δ ′ (v − v −1 )T̃ws1 s2 ...sj−1 T̃sj+1 . . . T̃sr 1λ
           = T̃ws1 s2 ...sj sj+1 ...sr 1λ + δ ′ (v − v −1 )T̃ws1 s2 ...sj−1 sj+1 ...sr 1λ
           = T̃wσ 1λ + δ ′ (v − v −1 )T̃w 1λ .

Assume now that w ∈ WλD . We show that δ = δ ′ . The condition that δ = 0
is equivalent to the condition that w(α) ∈ R+                       ′
                                            λ . The condition that δ = 0 is
32                                          G. LUSZTIG

equivalent to the condition that ws1 s2 . . . sj−1 (αj ) ∈ R+ where αj ∈ R+ is defined
by sj = sαj . Since α = s1 s2 . . . sj−1 (αj ), this completes the proof of (a).
   We show:
   (b) Let w ∈ WλD , w′ ∈ ΩD                                            D
                                   λ . Then T̃w T̃w ′ 1λ = T̃ww ′ 1λ ∈ Hn .
We write w′ = s1 s2 . . . sr with si ∈ I, r = l(w′ ). Using [L3, I, 5.3] we see that
                               / Wλ for all i ∈ [1, r]. From the relations of HnD we have
sr . . . si+1 si si+1 . . . sr ∈

                    T̃ws1 s2 ...si−1 T̃si 1si+1 ...sr λ = T̃ws1 s2 ...si 1si+1 ...sr λ

for i ∈ [1, r]. Using these identities we see that T̃w T̃w′ 1λ = T̃w T̃s1 T̃s2 . . . T̃sr 1λ =
T̃ws1 s2 ...sr 1λ and (b) follows.
   We show that ϑλ is an algebra homomorphism. We must check that (T̃σ 1λ )2 =
1λ + (v − v −1 )T̃σ 1λ for s ∈ Iλ . This is a special case of (a) (take w = σ). We must
also check that (T̃w 1λ )(T̃w′ 1λ ) = T̃ww′ 1λ if w, w′ ∈ WλD , lλ (ww′ ) = lλ (w) + lλ (w′ ).
If w, w′ ∈ Wλ , this is proved by induction on lλ (w′ ), the induction step being
provided by (a). The general case can be reduced to this special case using (b).
We see that ϑλ is an A-algebra isomorphism. We show that
   ϑλ (h) = ϑλ (h) for h ∈ HλD .
                                                                    −1
Assume first that h = T̃wλ where w ∈ ΩD                        λ
                                             λ . Then h = (T̃w −1 )    = T̃wλ . Hence

                ϑλ (h) = T̃w 1λ = T̃w−1         −1           l
                                      −1 1λ = T̃w 1λ = ϑλ (T̃w ) = ϑλ (h),



as required. Assume next that h = T̃σλ where σ ∈ Iλ . Then

ϑλ (h) = ϑλ ((T̃σλ )−1 ) = ϑλ (T̃σλ + (v −1 − v)T̃1λ ) = T̃σ 1λ + (v −1 − v)T̃1 1λ = T̃σ−1 1λ
 = T̃σ 1λ = ϑλ (h),

as required.
   We see that for w ∈ WλD we have ϑλ (cλw ) = ϑλ (cλw ). Hence ϑλ (cλw ) satisfies the
defining properties of cw,λ so that ϑλ (cλw ) = cw,λ . The lemma is proved.
  Using now 34.3(c) we see that
  (c) If cw,λ (w ∈ WλD ) is a distinguished basis element of 1λ HnD 1λ (see 34.1) then
w ∈ Wλ and w2 = 1.
34.8. Let s′n be a set of representatives for the WD -orbits in sn . For λ ∈ sn define
λ0 ∈ s′n by λ0 ∈ WD λ (the WD -orbit of λ). Let
    Γ = {(λ1 , λ2 ) ∈ sn × sn ; WD λ1 = WD λ2 }. P
Let EnD be the set of all formal sums x =          (λ1 ,λ2 )∈Γ xλ1 ,λ2 where xλ1 ,λ2 ∈
      D                D
1λ01 Hn 1λ02 . Then En is naturally an A-module and an associative A-algebra where
the product xy of x, y ∈ EnD is given by (xy)λ1 ,λ2 = λ̃∈WD λ1 xλ1 ,λ̃ yλ̃,λ2 . This
                                                         P
algebra has a unit element, namely the element 1 such that 1λ1 ,λ2 = δλ1 ,λ2 1λ1
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                   33

for (λ1 , λ2 ) ∈ Γ. Define a ring involution ¯ : EnD −                  → EnD by x 7→ x where
xλ1 ,λ2 = xλ1 ,λ2 . (Note that¯: HnD −               → HnD maps 1λ01 HnD 1λ02 onto itself.)
   Let C = {(λ1 , λ2 , w) ∈ sn × sn × WD ; wλ01 = λ01 = λ02 }. For (λ1 , λ2 , w) ∈ C
define xλ1 ,λ2 ,w ∈ EnD by
   xλλ1′ ,λ2 ,w
           ′     = δ(λ′1 ,λ′2 ),(λ1 ,λ2 ) T̃w 1λ01 .
       1 ,λ2
Then {x      λ1 ,λ2 ,w
                       ; (λ1 , λ2 , w) ∈ C} is an A-basis of Hn′′ . From the definitions, for
(λ1 , λ2 , w) ∈ C we have
   xλ1 ,λ2 ,w − xλ1 ,λ2 ,w ∈ y∈WD ;y≤w,y6=w,yλ0 =λ0 Axλ1 ,λ2 ,y
                                    P
                                                            1  1
By an argument similar to one in [L12, 5.2] we see that for any
(λ1 , λ2 , w) ∈ C there is a unique element cλ1 ,λ2 ,w ∈ EnD such that cλ1 ,λ2 ,w =
cλ1 ,λ2 ,w and
                                                  X
              cλ1 ,λ2 ,w − xλ1 ,λ2 ,w ∈                           v −1 Z[v −1 ]xλ1 ,λ2 ,y .
                                          y∈WD ,yλ01 =λ01 ,y6=w


Also, {cλ1 ,λ2 ,w ; (λ1 , λ2 , w) ∈ C} is an A-basis of EnD .
Lemma 34.9. The A-algebra EnD with its basis {cλ1 ,λ2 ,w ; (λ1 , λ2 , w) ∈ C} satis-
fies P1 , P2 , P3 in 34.1.
   For λ ∈ s′n let Nλ = |WD λ| and let MNλ (1λ HnD 1λ ) be the algebra of Nλ × Nλ
matrices with entries in 1λ HnD 1λ . From the definitions we have a decomposition
   EnD = ⊕λ∈s′n MNλ (1λ HnD 1λ )
compatible with the algebra structures and with the natural bases. Using this, the
lemma is reduced to the similar statement for 1λ HnD 1λ where it is known by 34.7.
   The function a : {cλ1 ,λ2 ,w ; (λ1 , λ2 , w) ∈ C} (see 34.1) is given by a(cλ1 ,λ2 ,w ) =
a(cw,λ01 ) where a(cw,λ01 ) is defined as in 34.1 in terms of 1λ01 HnD 1λ01 . The two-sided
cells of {cλ1 ,λ2 ,w ; (λ1 , λ2 , w) ∈ C} are the sets of the form {cλ1 ,λ2 ,w } where λ1 , λ2
run through WD λ (with λ ∈ s′n fixed) and w running through a subset X of WλD
such that {cw,λ ; w ∈ X} is a two-sided cell of {cw,λ ; w ∈ WλD } (see 34.7).
   Using 34.7(c) we obtain:
   (a) If cλ1 ,λ2 ,w , (λ1 , λ2 , w) ∈ C) is a distinguished basis element of EnD then
λ1 = λ2 , w ∈ Wλ01 , w2 = 1.

34.10. We prove Proposition 34.5. It is enough to construct an algebra isomor-
               ∼
phism HnD −→ EnD which carries the basis (cw,λ ) onto the basis (cλ1 ,λ2 ,w ).
   For each λ ∈ sn we choose a sequence sλ = (s1 , s2 , . . . , sr ) where, for i ∈ [1, r], si
is either in I or is a power of D and λ0 = s1 s2 . . . sr λ 6= s2 . . . sr λ 6= · · · =
                                                                                      6 sr λ 6= λ
                              −1      −1 −1 0          −1         −1 0        −1 0
or, equivalently, λ = sr . . . s2 s1 λ 6= sr−1 . . . s1 λ 6= · · · =       6 s1 λ 6= λ0 . Let
[sλ ] = s1 s2 . . . sr . We set
   τλ = T̃s1 T̃s2 . . . T̃sr ∈ HnD , τλ′ = T̃s−1
                                              r
                                                 . . . T̃s−1 T̃s−1 ∈ HnD .
                                                          2     1
We show:
34                                                G. LUSZTIG

  (a) 1λ0 τλ τλ′ = 1λ0 , 1λ τλ′ τλ = 1λ .
We have

 1λ0 τλ τλ′ = 1λ0 T̃s1 T̃s2 . . . T̃sr T̃s−1
                                          r
                                             . . . T̃s−1 T̃s−1 = T̃s1 T̃s2 . . . T̃sr 1λ T̃s−1
                                                                                            r
                                                                                               . . . T̃s−1 T̃s−1 .
                                                     2        1                                          2   1



Since sr λ 6= λ, we can replace T̃sr 1λ T̃s−1         r
                                                          by 1sr λ and we obtain
   T̃s1 T̃s2 . . . T̃sr−1 1sr λ T̃s−1 . . . T̃s−1 T̃s−1 .
                                  r−1         2     1

Since sr−1 sr λ 6= sr λ, we can replace T̃sr−1 1sr λ T̃s−1 by 1sr−1 sr λ and we obtain
                                                                       r−1

   T̃s1 T̃s2 . . . T̃sr−2 1sr−1 sr λ T̃s−1 . . . T̃s−1 T̃s−1 .
                                        r−2         2     1
Continuing in this way we find 1s1 ...sr−1 sr λ = 1λ0 . This proves the first identity in
(a). The second identity is proved in a similar way.
   We have
   (b) τλ 1λ = τλ 1λ , 1λ τλ′ = 1λ τλ′ .
The first identity in (b) is equivalent to T̃s−1               −1          −1                    ′ −1
                                                          −1 T̃ −1 . . . T̃ −1 1λ = τλ 1λ or to τλ
                                                               s           s
                                                                                                      1λ =
                                                          1       2          r
τλ 1λ , which follows from (a). Similarly, the second identity in (b) follows from (a).
   We define an A-linear map Ψ : HnD −     → EnD by
                              ′          D
   Ψ(h)λ1 ,λ2 = τλ1 1λ1 h1λ2 τλ2 ∈ 1λ01 Hn 1λ02 .
We show that Ψ is a ring homomorphism. Let h, h′ ∈ HnD , x = Ψ(h), y = Ψ(h′ ),
z = Ψ(hh′ ), z ′ = Ψ(h)Ψ(h′ ). We have
                                          X
          (Ψ(h)Ψ(h′ ))λ1 ,λ2 =                     Ψ(h)λ1 ,λ̃ Ψ(h′ )λ̃,λ2
                                        λ̃∈WD λ1
                  X                                                     X
           =              τλ1 1λ1 h1λ̃ τλ̃′ τλ̃ 1λ̃ h′ 1λ2 τλ′ 2 =               τλ1 1λ1 h1λ̃ h′ 1λ2 τλ′ 2
               λ̃∈WD λ1                                               λ̃∈WD λ1


where the last equality comes from (a). Since 1λ1 h1λ̃ = 0 if λ̃ ∈ sn − WD λ1 , we
see that
                                 X
  (Ψ(h)Ψ(h′ ))λ1 ,λ2 = τλ1 1λ1 h   1λ̃ h′ 1λ2 τλ′ 2 = τλ1 1λ1 hh′ 1λ2 τλ′ 2 = Ψ(hh′ )λ1 ,λ2 .
                                          λ̃∈sn


Thus Ψ(h)Ψ(h′ ) = Ψ(hh′ ), as required.
   We show that
   (c) Ψ(h) = Ψ(h) for h ∈ HnD .
We have
   (Ψ(h))λ1 ,λ2 = τλ1 1λ1 h1λ2 τλ′ 2 , (Ψ(h))λ1 ,λ2 = τλ1 1λ1 h̄1λ2 τλ′ 2 .
It suffices to show that τλ1 1λ1 = τλ1 1λ1 , 1λ2 τλ′ 2 = 1λ2 τλ′ 2 . This follows from (b).
   We show that
                                       −1
   (d) Ψ(T̃w 1λ ) = xwλ,λ,[swλ ]w[sλ ] for w ∈ WD , λ ∈ sn .
Indeed, (Ψ(T̃w 1λ ))λ1 ,λ2 = τλ1 1λ1 T̃w 1λ 1λ2 τλ′ 2 . This is 0 unless λ2 = λ, λ1 = wλ. If
λ2 = λ, λ1 = wλ we see as in the proof of (a) that
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                              35

  τλ1 1λ1 T̃w 1λ 1λ2 τλ′ 2 = τwλ T̃w 1λ τλ′ = T̃[swλ ]w[sλ ]−1 1λ0 .
This proves (d).
  (d) shows that Ψ is induced by a map
  Ψ0 : WD × sn −     → C, (w, λ) 7→ (wλ, λ, [swλ ]w[sλ ]−1 ).
This is a bijection with inverse (λ1 , λ2 , w) 7→ ([sλ1 ]−1 w[sλ2 ], λ2 )). It follows that
Ψ is an isomorphism.
  Let w ∈ WD , λ ∈ sn . Since Ψ−1 is compatible with¯, we have
                                                    −1
  Ψ−1 (cwλ,λ,[swλ ]w[sλ ]−1 ) = Ψ−1 (cwλ,λ,[swλ ]w[sλ ] ).
From (d) we see that
                         −1
  Ψ−1 (cwλ,λ,[swλ ]w[sλ ] ) − T̃w 1λ ∈ y∈WD ,yλ=wλ;y6=w v −1 Z[v −1 ]T̃y 1λ .
                                       P
                                                                                −1
Since these properties characterize cw,λ , we see that Ψ−1 (cwλ,λ,[swλ ]w[sλ ] ) = cw,λ
                                      −1
that is, Ψ(cw,λ ) = cwλ,λ,[swλ ]w[sλ ] . Thus, Ψ restricts to a bijection between
the basis (cw,λ ) of HnD and the basis (cλ1 ,λ2 ,w ) of EnD , induced by the bijection
                 ∼
Ψ0 : WD × sn −→ C. Proposition 34.5 is proved.

   We show:
   (e) If cw,λ (w ∈ WD , λ ∈ sn ) is a distinguished basis element of HnD then
w ∈ Wλ , w2 = 1.
                                                      −1
Note that, with the notation above, cwλ,λ,[swλ ]w[sλ ] is a distinguished basis ele-
ment of EnD hence, by 34.9(a), we have wλ = λ and [swλ ]w[sλ ]−1 ∈ Wλ0 has square
1. Thus, [sλ ]w[sλ ]−1 ∈ Wλ0 has square 1. It follows that w ∈ W[sλ ]−1 λ0 = Wλ
has square 1. This proves (e).

                           0
34.11. The algebra HnG defined as in 34.4 with D replaced by G0 is the same
as Hn ; we identify it in an obvious way with a subalgebra of HnD (see 34.4). The
                       0
A-basis of Hn = HnG analogous to the A-basis {cw,λ ; w ∈ WD , λ ∈ sn } of HnD
is the subset of the last basis given by {cw,λ ; w ∈ W, λ ∈ sn }. The analogue of
Proposition 34.5 holds: the A-algebra Hn with its basis (cw,λ )(w,λ)∈W×sn satisfies
P1 , P2 , P3 in 34.1.

34.12. Let K be a field of characteristic 0 and let A − → K be a homomorphism
                                                ∗
of rings with 1 which carries v ∈ A to v0 ∈ K . We show:
                                2l (w)                           D
                                                                     = K ⊗A HλD
                     P
    (a) If λ ∈ sn and w∈Wλ v0 λ        6= 0, then the K-algebra Hλ,K
is semisimple.
Let M be an Hλ,K  D
                    -module of finite dimension over K and let M ′ be an Hλ,K
                                                                            D
                                                                               -
                                                                 D
submodule of M . It is enough to show that there exists an Hλ,K -submodule of
M complementary to M ′ . It is well known that under our assumption, the K-
algebra Hλ,K = K ⊗A Hλ is semisimple. Hence there exists an Hλ,K -submodule
of M complementary to M ′ that is, there exists an Hλ,K -linear map f : M −   →
   ′                                         ′
M such that f (x) = x for all x ∈ M . Define f : M −   ˜             ′   ˜
                                                                → M by f (x) =
36                                          G. LUSZTIG

     −1
|ΩD
          P
  λ|       z∈ΩD
              λ
                  T̃z−1 f (T̃z x). For w ∈ Wλ , x ∈ M we have

               ˜
                             X                              X
          |ΩD
            λ |f (T̃w x) =          T̃z−1 f (T̃z T̃w x) =          T̃z−1 f (T̃zwz−1 T̃z x)
                             z∈ΩD
                                λ                           z∈ΩD
                                                               λ

                                                                                       ˜
              X                                  X
          =          T̃z−1 T̃zwz−1 f (T̃z x) =          T̃w T̃z−1 f (T̃z x) = |ΩD
                                                                                λ |T̃w f (x).
              z∈ΩD
                 λ                               z∈ΩD
                                                    λ



(The third equality holds since f is Hλ,K -linear.) We see that f˜ is Hλ,K -linear.
Since f˜(T̃y x) = T̃y f˜(x) for x ∈ M , y ∈ ΩD                ˜      D
                                              λ , we see that f is Hλ,K -linear. If
x ∈ M ′ we have T̃z x ∈ M ′ for z ∈ ΩD         ˜         D −1
                                                              P
                                       λ hence f (x) = |Ωλ |    z∈ΩD
                                                                   λ
                                                                     T̃z−1 T̃z x = x.
It follows that the ker(f˜) is an H D -submodule of M complementary to M ′ . This
                                        λ,K
proves (a).
   Let U be the subfield of Q̄l generated by the roots of 1.
For any κ ∈ U∗ , λ ∈ sn , let
   HnD,κ = U ⊗A HnD , Hnκ = U ⊗A Hn , Hλ D,κ = U ⊗A HλD ,
where U is regarded as an A-algebra via the ring homomorphism A −       → U, v 7→ κ.
Let
   HnD,v = U(v) ⊗A HnD , Hnv = U(v) ⊗A Hn
where U(v) (field of rational functions in v with coefficients in U) is regarded as
an A-algebra via the ring homomorphism A −        → U(v), v 7→ v. Now Φ : HnD −    →
          D,∞             D,∞         D ∞
A ⊗Z Hn        ( where Hn       = (Hn ) is defined as in 34.1 in terms of the basis
(cw,λ ) in 34.4) induces algebra homomorphisms Φκ : HnD,κ −       → U ⊗Z HnD,∞ for
κ ∈ U∗ and Φv : HnD,v − → U(v) ⊗Z HnD,∞ .
   Similarly, Φ : Hn − → A ⊗Z Hn∞ (defined as in 34.1 in terms of the basis (cw,λ )
in 34.11) induces algebra homomorphisms Hnκ −     → U ⊗Z Hn∞ for κ ∈ U∗ and Hnv −  →
U(v) ⊗Z Hn , denoted again by Φ , Φ . From the definitions we see that Hn∞
             ∞                         κ   v

may be identified with the subgroup of (HnD )∞ spanned by the basis elements of
(HnD )∞ indexed by {(w, λ); w ∈ W, λ ∈ sn } and Φ : Hn −       → A ⊗Z Hn∞ becomes
                         D               D,∞
the restriction ofPΦ : Hn − → A ⊗Z Hn . We show:
   (b) If κ ∈ U∗ , w∈W κ2l(w) 6= 0 then HnD,κ is a semisimple U-algebra and Φκ :
HnD,κ − → U ⊗Z HnD,∞ is an algebra isomorphism. Moreover, Hnκ is a semisimple
U-algebra and Φκ : Hnκ − → U ⊗Z Hn∞ is an algebra isomorphism.
   (c) Hn is a split semisimple U(v)-algebra and Φv : HnD,v −
          D,v
                                                                   → U(v) ⊗Z HnD,∞
is an algebra isomorphism. Moreover, Hnv is a split semisimple U(v)-algebra and
Φv : Hnv −→ U(v) ⊗Z Hn∞ is an algebra isomorphism.
We prove (b). The  Pfollowing    statement
                                        P is easily  verified:
                             2l(w)               2lλ (w)
   If λ ∈ sn then w∈W v            = Q w∈Wλ v            for some Q ∈ Z[v 2 ].
We see that, if κ is as in (b) and λ ∈ sn then w∈Wλ κ2lλ (w) 6= 0; hence, by (a),
                                                  P

HλD,κ is a semisimple algebra. By the arguments in 34.7-34.10, HnD,κ is a direct sum
of matrix rings over rings of the form HλD,κ . Hence HnD,κ is a semisimple algebra.
Using 34.1(c) we see that Φκ : HnD,κ −    → U ⊗Z HnD,∞ is an algebra isomorphism.
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                    37

It remains to show that HnD,κ is split over U. Since Φκ is an isomorphism it is
enough to show that U ⊗Z HnD,∞ is split over U. Since Φ1 is an isomorphism it
is enough to show that HnD,1 is split over U. As above, HnD,1 is a direct sum of
matrix rings over rings of the form HλD,1 . Since HλD,1 is the group algebra of a
finite group with coefficients in U, it is split over U by Brauer’s theorem. This
proves the first sentence in (b). The second sentence in (b) is obtained from the
first by replacing D by G0 .
    Now the proof of (c) is just like that of (b) except for the splitness assertion.
By (b), U ⊗Z HnD,∞ is a split semisimple U-algebra hence U(v) ⊗Z HnD,∞ is a split
semisimple U(v)-algebra. Since Φv is an isomorphism, it follows that HnD,v is split
over U(v). Similarly, Hnv is split over U(v). This proves (c).
34.13. Define an A-linear map τ : Hn −             → A by τ (T̃w 1λ ) = δw,1 for all w ∈ W, λ ∈
sn . Define a bilinear form (, ) : Hn × Hn −         → A by (x, x′ ) = τ (xx′ ). We show that
    (a) (T̃w 1λ , T̃w′ 1λ′ ) = δw−1 ,w′ δλ,w′ λ′
for w, w′ ∈ W, λ, λ′ ∈ sn . (This shows that (, ) is symmetric; indeed, we have
δw−1 ,w′ δλ,w′ λ′ = δw′−1 ,w δλ′ ,wλ .) To prove (a) it suffices to show that, for w, w′ ∈
W, λ ∈ sn , we have τ (T̃w T̃w′ 1λ ) = δww′ ,1 . We argue by induction on l(w). If
l(w) = 0 then T̃w T̃w′ = T̃ww′ and the result is clear. Assume now that l(w) ≥ 1.
We can find s ∈ I such that l(w) = l(ws) + 1. Then τ (T̃w T̃w′ 1λ ) = τ (T̃ws T̃s T̃w′ 1λ ).
If l(sw′ ) = l(w′ ) + 1 then, by the induction hypothesis,
    τ (T̃ws T̃s T̃w′ 1λ ) = τ (T̃ws T̃sw′ 1λ ) = δwssw′ ,1 = δww′ ,1 ,
as required. Assume now that l(sw′ ) = l(w′ ) − 1. We have
              τ (T̃ws T̃s T̃w′ 1λ ) = τ (T̃ws T̃s T̃s T̃sw′ 1λ )
                                                          X
               = τ (T̃ws T̃sw′ 1λ ) + (v − v −1 )                τ (T̃ws T̃s 1λ′ T̃sw′ 1λ ).
                                                     λ′ ;s∈Wλ′

If s ∈
     / Wsw′ λ this equals (by the induction hypothesis) δwssw′ ,1 = δww′ ,1 , as
required; if s ∈ Wsw′ λ this equals (by the induction hypothesis)
   δwssw′ ,1 + (v − v −1 )τ (T̃ws T̃w′ 1λ ) = δww′ ,1 + (v − v −1 )δwsw′ ,1 .
It remains to note that wsw′ 6= 1 whenever l(w) = l(ws) + 1, l(sw′ ) = l(w′ ) − 1.
This proves (a).
34.14. Let C be a finite dimensional semisimple split (associative) algebra with 1
over a field K. Let {Eu ; u ∈ U} be a set or representatives for the isomorphism
classes of simple C-modules. Let a : C −     → C be an algebra automorphism. For
u ∈ U, c : e 7→ a(c)e defines a C-module structure on the K-vector space Eu
which is isomorphic to Eū for a unique ū ∈ U. Then u 7→ ū is a permutation of
U. Let U a = {u ∈ U; u = ū}. For u ∈ U a we can find a K-linear isomorphism
au : E u −→ Eu such that au (ce) = a(c)au e for all c ∈ C, e ∈ Eu . Note that au is
uniquely determined up to multiplication by an element in K ∗ . We show:
             ′
P (a) If c, c ∈ C, then−1                                  → C, c1 7→ ca(c1 )c′ equals
                           the trace of the K-linear map C −
                             ′
   u∈U a tr(cau , Eu )tr(au c , Eu ).
Under the algebra isomorphism
38                                           G. LUSZTIG

           ∼
    (b) C −→ ⊕u∈U EndK (Eu ), c 7→ [e 7→ ce, e ∈ Eu ],
the linear map C −      → C in (a) corresponds to an endomorphism of ⊕u∈U EndK (Eu )
which permutes the summands according to u 7→ ū and whose restriction to a
summand with u = ū is EndK (Eu ) 7→ EndK (Eu ), f 7→ cau f a−1                        ′
                                                                                 u c . From this (a)
follows easily. (Compare 20.3(b).)
    We show:
                                                     ′          ′                      ′
    (c) If y : C −  → K is K-linear and y(cc     P ) = y(c a(c)) for all c, c ∈ C then there
                         a
exist bu ∈ K(u ∈ U ) such that y(c) = u∈U a bu tr(cau , Eu ) for all c ∈ C.
Let Cu be the inverse image of the summand EndK (Eu ) under (b). Then C = ⊕u Cu
and a(Cu ) = Cū for u ∈ U. Let yu : Cu −             → K be the restriction of y to Cu . Let
c ∈ Cu where u 6= ū. Let c′ ∈ Cu be the projection of 1 ∈ C onto Cu . We
have a(c) ∈ Cū hence c′ a(c) = 0. Also, cc′ = c ∈ Cu . Thus, yu (c) = yu (cc′ ) =
y(cc′ ) = y(c′ a(c)) = 0. We see that yu = 0. We are reduced to the case where
U = U a consists of a single element u and C = EndK (Eu ). We can find h ∈ C,
invertible, such that a(c) = hch−1 for all c ∈ C. We can assume that au e = he for
all e ∈ Eu . We have y(cc′ ) = y(c′ hch−1 ) for all c, c′ ∈ C. Define ỹ : C −               → K by
ỹ(c) = y(ch ). We have y(cc h ) = y(c h hch ) = y(c ch ) hence ỹ(cc′ ) =
                 −1                  ′ −1              ′ −1       −1           ′ −1

ỹ(c′ c) for all y, y ′ ∈ C. Thus there exists b ∈ K such that ỹ(c) = btr(c, Eu ). Then
y(c) = btr(ch : Eu −     → Eu ) = btr(cau : Eu −     → Eu ). This proves (c).
    Assume now that we are given a K-linear map z : C −                     → K such that (c, c′ ) =
      ′          ′
z(cc ) = z(c c) is a nondegenerate (symmetric) K-bilinear form C × C −                     → K. Let
                                                           ′                         ′
(ci )i∈I be a K-basis of C. Define a K-basis (ci )i∈I of C by (ci , cj ) = δij .
    For u ∈ U and c ∈ C invertible, i∈I tr(ci c, Eu )c−1 c′i is in the centre of C; if
                                              P
u′ ∈ U, u′ 6= u, this sum acts on Eu′ as 0 and on Eu as fu times the identity, where
fu ∈ K ∗ is independent of (ci ), (c′i ), c. (We apply [L12, 19.2] to the dual bases
(ci c), (c−1 c′i ): we have (ci c, c−1 c′j ) = (ci , cc−1 c′j ) = (ci , c′j ) = δij .) We see that for
u, u′ ∈ U we have
                      X
(d)                          tr(ci c, Eu )tr(c−1 c′i , Eu′ ) = δu,u′ fu dim Eu .
                       i∈I


Now assume that u, u′ ∈ U a . We can pick c ∈ C invertible such that c acts on Eu
as au and on Eu′ as au′ . From (d) we deduce
                     X
(e)                         tr(ci au , Eu )tr(a−1  ′
                                               u′ ci , Eu′ ) = δu,u′ fu dim Eu .
                      i∈I


34.15. We write a : Hn −  → Hn instead of aD : Hn −  → Hn (see 31.4); this is the
algebra automorphism given by h 7→ T̃D hT̃D−1 (product in HnD ) for h ∈ Hn . The
same formula defines an algebra automorphism of Hnκ or Hnv denoted again by a.
From the definitions we see that a : Hn − → Hn takes cw,λ to cǫD (w),Dλ for w ∈
W, λ ∈ sn . Hence it induces a ring automorphism Hn∞ − → Hn∞ denoted again by a.
It also induces algebra automorphisms Hnκ −→ Hnκ , κ ∈ U∗ and Hnv −
                                                                  → Hnv denoted
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                           39

again by a. Now Φκ : Hnκ −    → U ⊗Z Hn∞ for κ ∈ U∗ and Φv : Hnv −       → U(v) ⊗Z Hn∞
(see 34.11) are compatible with a.
    Let {Eu ; u ∈ U} be a set of representatives for the isomorphism classes of simple
modules for Hn1 (a split semisimple U-algebra, by 31.12(b).) Define U −     → U, u 7→ ū
                                      1           a
as in 34.14, replacing (C, a) by (Hn , a). Let U = {u ∈ U; u = ū}.
    Let u ∈ U. Clearly, if Eu extends to an HnD,1 -module then u ∈ U a . Conversely,
we show that, if u ∈ U a , then Eu extends to an HnD,1 -module. Since Hn1 , HnD,1 are
split over U it is enough to prove the analogous statement in which Eu , Hn1 , HnD,1
are replaced by U′ ⊗U Eu , U′ ⊗U Hn1 , U′ ⊗U HnD,1 and U′ is an algebraic closure of U.
Since u ∈ U a we can find a U′ -linear isomorphism X : U′ ⊗U Eu −      → U′ ⊗U Eu such
that X(ce) = a(c)X(e) for all c ∈ U′ ⊗U Hn1 , e ∈ U′ ⊗U Eu . Let k be the order of
D:T−    → T. By Schur’s lemma, X k is a scalar times identity. Now U′ contains a
k-th root of this scalar. Dividing X by this root we see that we may assume that
X k = 1. We can now define a U′ ⊗U HnD,1 -module structure on the vector space
U′ ⊗U Eu which extends the U′ ⊗U Hn1 -module structure and in which T̃D acts as
X.
    For any u ∈ U a we choose an HnD,1 -module structure on Eu extending the
   1
Hn -module structure.
                                                                                     ∼
    Let u ∈ U. We regard Eu as a (simple) U ⊗Z Hn∞ -module Eu∞ via Φ1 : Hn1 −→
U ⊗Z Hn∞ . (If u ∈ U a we also regard Eu as a U ⊗Z HnD,∞ -module Eu∞ via Φ1 :
        ∼
HnD,1 −→ U ⊗Z HnD,∞ . This extends the U ⊗Z Hn∞ -module structure.)
    Now U[v, v −1 ] ⊗U Eu∞ is naturally a U[v, v −1 ] ⊗Z Hn∞ -module and also an Hn -
                                           Φ
module via the homomorphism Hn −          → A ⊗Z Hn∞ ⊂ U[v, v −1 ] ⊗Z Hn∞ . This
Hn -module is denoted by Eu (v). (If u ∈ U a then U[v, v −1 ] ⊗U Eu∞ is naturally a
                                                                                     Φ
U[v, v −1 ]⊗Z HnD,∞ -module and also an HnD -module via the homomorphism HnD −       →
A ⊗Z HnD,∞ ⊂ U[v, v −1 ] ⊗Z HnD,∞ . This extends the Hn -module structure on
Eu (v).)
    Let Euv = U(v) ⊗U Eu (v). From 34.12(c) we see that {Euv ; u ∈ U} is a set of
representatives for the isomorphism classes of simple Hnv -modules. (If u ∈ U a then
the HnD,v -module structure on Euv coming from the HnD -module structure on Eu (v)
extends the Hnv -module structure.)
    For κ as in 34.12(b) let Euκ be the vector space Eu∞ regarded as an Huκ -module
                ∼
via Φκ : Hnκ −→ U ⊗Z Hn∞ . From 34.12(b) we see that {Euκ ; u ∈ U} is a set of
representatives for the isomorphism classes of simple Hnκ -modules. Now Euκ can
also be obtained from the Hn -module Eu (v) under the specialization U[v, v −1 ] −   →
                                   1            1                       a
U, v 7→ κ. Moreover, we have Eu = Eu as Hn -modules. (If u ∈ U we also regard
                                              ∼
Eu∞ as an HuD,κ -module via Φκ : HnD,κ −→ U ⊗Z HnD,∞ . This extends the Huκ -
module structure. This can be also obtained from the HnD -module Eu (v) under
the specialization U[v, v −1 ] −
                               → U, v 7→ κ. Moreover, Eu1 = Eu as HuD,1 -modules.)
    From the definitions we see that the map U −      → U, u 7→ ū defined as in 34.14,
replacing (C, a) by (Hnκ , a) (κ as in 34.12(b)) or by (Hnv , a) is the same as the map
u 7→ ū defined in terms of (Hn1 , a). We show:
40                                        G. LUSZTIG

   (a) Let w ∈ W, λ ∈ sn , u ∈ U. Then tr(T̃w 1λ , Euv ) ∈ U[v, v −1 ] and, for κ as
in 34.12(b), tr(T̃w 1λ , Euκ ) ∈ U is obtained from this element of U[v, v −1 ] by the
specialization U[v, v −1 ] − → U, v 7→ κ. If, in addition, u ∈ U a and j ∈ Z then
            j                                                                     j
tr(T̃w 1λ T̃D , Euv ) ∈ U[v, v −1 ] and, for κ as in 34.12(b), tr(T̃w 1λ T̃D        , Euκ ) ∈ U is
obtained from this element of U[v, v −1 ] by the specialization U[v, v −1 ] −         → U, v 7→ κ.
                                                                                         j
This follows immediately from the fact that Φ(T̃w 1λ ) (resp. Φ(T̃w 1λ T̃D                 )) is an
A-linear combination of the standard basis elements of Hn∞ (resp.HnD,∞ .)
   Combining 34.13(a), 34.14(d) we see that, for u, u′ ∈ U and for κ as in 34.12(b)
we have
                     X
                           tr(T̃w 1λ , Euv )tr(1λ T̃w−1 , Euv′ ) = δu,u′ fuv dim Eu ,
               w∈W,λ∈sn
                   X
(b)                        tr(T̃w 1λ , Euκ )tr(1λ T̃w−1 , Euκ′ ) = δu,u′ fuκ dim Eu ,
               w∈W,λ∈sn


where fuv ∈ U(v) − {0}, fuκ ∈ U − {0}. Using (a) we see that fuv ∈ U[v, v −1 ] and
fuκ is obtained from fuv by the specialization U[v, v −1 ] −
                                                           → U, v 7→ κ. Combining
                                        ′   a
34.13(a), 34.14(e) we see that, for u, u ∈ U , we have
              X
                                                 −1
(c)                    tr(T̃w 1λ T̃D , Euv )tr(T̃D  1λ T̃w−1 , Euv′ ) = δu,u′ fuv dim Eu .
           w∈W,λ∈sn


34.16. Let x 7→ x♠ be the automorphism of the field U which sends any root of
1 to its inverse. We extend this to an automorphism of the field U(v) (denoted by
ξ 7→ ξ ♠ ) which carries v to itself. For x′ ∈ U we say that x′ > 0 if the image of
x′ under any imbedding of U into the complex numbers is a real number > 0. For
example, for x ∈ U − {0} we have xx♠ > 0. For ξ ′ ∈ U(v) we say that ξ ′ > 0 if ξ ′
can be expanded in a power series ξ ′ = a0 v n +a1 v n+1 +. . . where a0 , a1 , α2 , · · · ∈ U
and a0 > 0.
Lemma 34.17. Let u ∈ U a , w ∈ WD , λ ∈ sn . We have

(a)                          tr(1λ T̃w−1 , Euv ) = tr(T̃w 1λ , Euv )♠ .


   The antiautomorphism h −    → h♭ of Hn (see 32.19) extends to an antiautomor-
phism h −  → h♭ of HnD given by T̃w′ 7→ T̃w′ −1 for w′ ∈ WD , 1λ′ 7→ 1λ′ for λ′ ∈ sn .
Define a ring involution h 7→ h⋄ of HnD,v by w,λ aw,λ T̃w 1λ 7→ w,λ a♠                         ♭
                                                P                       P
                                                                                 w,λ (T̃w 1λ )
                                                                      v     v
where aw,λ ∈ U(v). Assume that there exists a pairing h, i : Eu × Eu −         → U(v) such
that h, i is linear in the second variable, semi-linear (with respect to ξ 7→ ξ ♠ ) in
the first variable, is non-degenerate, satisfies he, e′ i = he′ , ei♠ for e, e′ ∈ Euv and

(b)                    hhe, e′ i = he, h⋄ e′ i for e, e′ ∈ Euv , h ∈ HnD,v .
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                               41

If (ej ), (e′j ) are bases of Euv such that hei , e′j i = δij then
    tr(h, Euv ) = j hej , he′j i = j hh⋄ ej , e′j i = tr(h⋄ , Euv )♠ .
                    P                P

Taking here h = 1λ T̃w−1 we see that (a) would follow. It remains to prove the
existence of h, i as above.
    We can find a pairing h, i′ : Euv × Euv −          → U(v) which is linear in the sec-
ond variable, semi-linear (with respect to ξ 7→ ξ ♠ ) in the first variable, satisfies
he, e′ i′ = he′ , ei′♠ for e, e′ ∈ Euv and he, ei > 0 for e ∈ Euv − {0}. (For example,
                                                                                P ♠ ′
we choose a basis (ej ) of Euv and we set h j aj ej , j a′j ej i′ =
                                                      P          P
                                                                                 j aj aj where
      ′                                                  v       v
aj , aj ∈ U(v).) We define a new pairing h, i : Eu × Eu −           → U(v) by
                                        X
                          he, e′ i =              hT̃w′ 1λ′ e, T̃w′ 1λ′ e′ i′ .
                                       w ′ ∈WD ,λ′ ∈sn

Note that h, i′ is linear in the second variable, semi-linear (with respect to ξ 7→ ξ ♠ )
in the first variable, satisfies he, e′ i = he′ , ei′♠ for e, e′ ∈ Euv and he, ei > 0 for
e ∈ Euv − {0}. In particular, h, i is non-degenerate. We show that (b) holds. It is
enough to show this when h runs through a set of generators of the algebra HnD,v
that is, for h = 1λ or h = T̃D or h = T̃s (s ∈ I). Assume first that h = 1λ , λ ∈ sn .
WeP must show that
                                                ′ ′                                           ′ ′
                                                     P
     w ′ ∈WD ,λ′ ∈sn hT̃w 1λ 1λ e, T̃w 1λ e i =       w ′ ∈WD ,λ′ ∈sn hT̃w 1λ e, T̃w 1λ 1λ e i .
                          ′   ′          ′   ′                              ′   ′      ′    ′


Both sides are equal to w′ ∈WD hT̃w′ 1λ e, T̃w′ 1λ e′ i′ . Assume next that h = T̃D .
                                P
We must show that
            X                                        X
                   hT̃w′ 1λ′ T̃D e, T̃w′ 1λ′ e′ i′ =       hT̃w′ 1λ′ e, T̃w′ 1λ′ T̃D−1 e′ i′
            w ′ ∈WD                                   w ′ ∈WD
             λ′ ∈sn                                    λ′ ∈sn

                           hT̃w′ D 1D−1 λ′ e, T̃w′ 1λ′ e′ i′ =                          e, T̃yD−1 1Dλ′′ e′ i′ ,
            P                                                    P
that is,                                                             y∈WD hT̃y 1λ
                 ′     D                                                           ′′
                w ∈W
                 λ′ ∈sn                                              λ′′ ∈sn
which
  P is clear. Finally, assume that h′ ′= T̃P          s , s ∈ I. We must show that
                                                                                                     ′ ′
     w ′ ∈WD ,λ′ ∈sn h T̃ ′ 1
                         w λ s′ T̃ e, T̃  ′
                                        w λ 1 ′ e i =     w ′ ∈WD ,λ′ ∈sn hT̃w 1λ e, T̃w 1λ T̃s e i .
                                                                               ′   ′       ′  ′

Both sides are equal to
      X                                                         X
            hT̃w′ s 1sλ′ e, T̃w′ 1λ′ e′ i′ + (v − v −1 )                   hT̃w′ 1λ′ e, T̃w′ 1λ′ e′ i′ .
     w ′ ∈WD                                                    w ′ ∈WD
      λ′ ∈sn                                               l(w ′ s)=l(w ′ )−1
                                                            λ′ ∈sn ,s∈Wλ′

This proves (b). The lemma is proved.
34.18. Using 34.17(a) we can rewrite 34.15(c) for u, u′ ∈ U a as follows:
          X
(a)              tr(T̃w 1Dλ T̃D , Euv )tr(T̃w 1Dλ T̃D , Euv′ )♠ = δu,u′ fuv dim Eu .
           w∈W,λ∈sn

Specializing this under U[v, v −1 ] −→ U, v 7→ κ, we obtain
           X                                                 ♠
(b)                tr(T̃w 1Dλ T̃D , Euκ )tr(T̃w 1Dλ T̃D , Euκ′ )♠ = δu,u′ fuκ dim Eu .
          w∈W,λ∈sn
42                                             G. LUSZTIG

34.19. Let A be a character sheaf on D. Define an A-linear map ζ̂ : Hn −      →
             A                    A
A by h 7→ ζ (h[D]) where ζ : Hn [D] −        → A is as in 31.7. From 31.8 we see
          ′          ′               ′
that ζ̂(hh ) = ζ̂(h a(h)) for h, h ∈ Hn . Applying 34.14(c) to the linear map
U(v) ⊗A Hn − → U(v) obtained from ζ̂ by extension of scalars, we see that there
exist elements bvA,u ∈ U(v)(u ∈ U a ) such that
                                       X
(a)                ζ A (T̃w 1Dλ [D]) =     bvA,u′ tr(T̃w 1Dλ T̃D , Euv′ ),
                                               u′ ∈U a

for w ∈ W, λ ∈ sn . We multiply both sides of (a) by tr(T̃w 1Dλ T̃D , Euv )♠ (with
u ∈ U a ) and sum over all w, λ. Using 34.18(a), we obtain
                                1         X
(b)              bvA,u =                             ζ A (T̃w 1Dλ [D])tr(T̃w 1Dλ T̃D , Euv )♠ .
                           fuv dim Eu
                                        w∈W,λ∈sn

                                                                  s,L               s,Ľ
Using 28.17(a),(b) and the notation there, we see that D(p H j (K̄D   )) = p H j (K̄D    )
hence
  X
       bvD(A),u tr(CDλ
                    s
                       T̃D , Euv ) = ζ D(A) (CDλ
                                              s
                                                 [D])
 u∈U a
         X                                     s,L
                                                            X                                     s,L
     =        (−v)j v − dim G (D(A) : p H j (K̄D   )) =           (−v)j v − dim G (A : D(p H j (K̄D   ))
          j                                                   j
                                           s,Ľ
         X
     =        (−v)j v − dim G (A :   p j
                                      H (K̄D    ))   = ζ A (CDλ
                                                             s
                                                               −1 [D])

          j
(c)
         X
     =           bvA,u tr(CDλ
                           s           v
                             −1 T̃D , Eu ).

         u∈U a

Lemma 34.20. Let u ∈ U a . Assume that Eu is quasi-rational in the following
sense: there exists a function η : WD × sn −    → {roots of 1 in U}, (w, λ) 7→ ηw,λ
such that η is constant on any equivalence class for ≍ in WD × sn (see 32.26) and
tr(T̃w 1λ , Eu ) ∈ ηw,λ Z for all (w, λ) ∈ WD × sn . Then tr(T̃w 1λ , Euv ) ∈ ηw,λ A for
all (w, λ) ∈ WD × sn .
   From the definitions and 34.7-34.10 we see that, for w ∈ WD , λ ∈ sn , the basis
elements cw,λ of HnD (see 34.5) satisfy
                       P
   (a) cw,λ ∈ T̃wy 1λ + y∈Wλ ;wy<w AT̃wy 1λ .
For w ∈ WD , λ ∈ sn , x ∈ Wλ we have T̃w 1λ T̃x ∈ x′ ∈Wλ AT̃wx′ 1λ (in HnD ). This
                                                  P

follows by writing x as product x = σ1 σ2 . . . σm , σm ∈ Iλ , m = lλ (x) and using
repeatedly 34.7(a). Using this and (a) we see that
                 P
   (b) cw,λ T̃x ∈ x′ ∈Wλ AT̃wx′ 1λ .
Now let cw′ ,λ be a distinguished basis element of HnD (see 34.1). By 34.10(e) we
have w′ ∈ Wλ hence cw′ ,λ ∈ x∈Wλ 1λ T̃x . Hence from (b) we deduce
                              P
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                  43

                         P
   (c) cw,λ cw′ ,λ ∈ x′ ∈Wλ AT̃wx′ 1λ .
From (a) we deduce by inversion:
                    P
   (d) T̃w 1λ ∈ y∈Wλ ;wy≤w Acwy,λ .
Using this for P   wx′ instead of x and using also (c) we deduce
   cw,λ cw′ ,λ ∈ x′′ ∈Wλ Acwx′′ ,λ .
Hence, if Φ : HnDP       → A ⊗Z HnD,∞ is as in 34.12, then
                         −
   (e) Φ(cw,λ ) ∈ x′′ ∈Wλ Atwx′′ ,λ
where ty,λ be the basis element of HnD,∞ corresponing to cy,λ ∈ HnD (see 34.1).
   Let cw,λ;1 be the image of cw,λ in HnD,1 . Let Φ′ : Q ⊗A HnD −               → Q ⊗Z HnD,∞
be the homomorphism obtained from Φ under the specialization A −                   → Q, v 7→ 1.
                                                    1
This is an isomorphism of algebras since Φ (see 34.12) is an isomorphism. From
(e) weP  see that for any (y, P   λ) ∈ WD × sn , Φ′ restricts to a Q-linear map
   (f) x∈Wλ Qcyx,λ;1 −         → x∈Wλ Qtyx,λ .
                                                                                 D          D,∞
The vector spaces in (f) form direct sum decompositions of Q ⊗A HP               n , Q ⊗Z Hn
                                                                   ′−1
hence (f) must be an isomorphism. We deduce that Φ                      carries x∈Wλ Qtyx,λ
onto x∈Wλ Qcyx,λ;1 . We see that ty,λ acts on the U⊗Z Hn -module Eu∞ as a Q-
                                                                     D,∞
      P
linear combination of the operators cyx,λ;1 : Eu −       → Eu where x ∈ Wλ hence also as
a Q-linear combination of the operators T̃yx 1λ : Eu −         → Eu . (From (a) specialized
for v = 1 we see that cy,λ ∈ x∈Wλ ZT̃yx 1λ .) It follows that tr(ty,λ , Eu∞ ) ∈ ηy,λ Q.
                                   P

Using (e) we see that cy,λ acts on Euv as an A-linear combination of the operators
1 ⊗ tyx,λ on U(v) ⊗U Eu∞ where x ∈ Wλ . The same holds for T̃y,λ (instead of cy,λ ),
by (d). It follows that tr(T̃y 1λ , Euv ) ∈ ηy,λ Q[v, v −1 ].
   Since the algebra U ⊗Z HnD,∞ is of finite dimension (say m), with 1, and its
structure constants with respect to the basis (ty,λ ) are integers, we see that any
                                                                           m−1
basis element ty,λ satisfies an equation of the form tm         y,λ + c1 ty,λ + · · · + cm = 0
where c1 , c2 , . . . , cm are integers. It follows that tr(ty,λ , Eu∞ ) is an algebraic integer
(necessarily in U). Since the definition of Φ involves only coefficients in A it follows
that the coefficients of tr(cy,w , Euv ) ∈ U[v, v −1 ] are algebraic integers in U. The
same holds then for the coefficients of tr(T̃y 1λ , Euv ). An element of ηy,λ Q[v, v −1 ]
whose coefficients are algebraic integers in U is necessarily in ηy,λ A. We see that
tr(T̃y 1λ , Euv ) ∈ ηy,λ A, as required.
Lemma 34.21. Let u, Eu , η be as in 34.20. Let A be a character sheaf on D.
Let EA ⊂ WD × sn be the equivalence class under ≍ attached to A in 32.25(a)
(with J = I). Let η0 , a root of 1, be the (constant) value of η on EA . We have
bvA,u ∈ η0−1 Q(v).
   From 34.18(a) we have
                                     X
             fuv = (dim Eu )−1               tr(T̃wD 1λ , Euv )tr(T̃wD 1λ , Euv )♠ .
                                  w∈W,λ∈sn


By 34.20, for any w ∈ W, λ ∈ sn we have tr(T̃wD 1λ , Euv ) = ηwD,λ Qw,λ where
44                                     G. LUSZTIG

                                                                       −1
Qw,λ ∈ A; hence tr(T̃wD 1λ , Euv )tr(T̃wD 1λ , Euv )♠ = ηwD,λ Qw,λ ηwD,λ  Qw,λ . Thus,
                                          X
(a)              fuv = (dim Eu )−1                  Q2w,λ ∈ Q[v, v −1 ].
                                        w∈W,λ∈sn

Using 32.26(b) we rewrite 34.19 as follows
                      1         X
           bvA,u = v                    ζ A (T̃x 1Dλ [D])tr(T̃xD 1λ , Euv )♠ .
                  fu dim Eu
                                 x∈W,λ∈sn
                                 (xD,λ)∈EA

For each x, λ in the sum, we have ζ A (T̃x 1Dλ [D]) ∈ A (by definition) and
   tr(T̃xD 1λ , Euv )♠ ∈ η0−1 A
(by 34.20). Using this and (a), we see that bvA,u ∈ η0−1 Q(v).

                              35. Functions on G0F /U
35.1. In this section we assume that k is an algebraic closure of a finite field Fq
of characteristic p and that G has a fixed Fq -rational structure whose Frobenius
map induces the identity map on W and on G/G0 and the map t 7→ tq on T. For
any algebraic variety V over k with a given Fq -structure we denote by F : V − →V
the corresponding Frobenius map. We fix an integer n ≥ 1 that divides q − 1.
35.2. In this section we fix an épinglage of G0 compatible with the Fq -structure.
Thus, we fix B ∗ , T, U ∗ as in 28.5 such that F (B ∗ ) = B ∗ , F (T ) = T and we fix
for each s ∈ I an isomorphism a 7→ ξs (a) of k onto a subgroup of U ∗ such that
tξs (a)t−1 = ξs (αs (t)a) for all t ∈ T, a ∈ k and F (ξs (a)) = ξs (aq ) for all a ∈ k; here
αs ∈ R+ and the corresponding coroot α̌s satisfy t = s(t)α̌s (αs (t)) for all t ∈ T .
(Clearly, such an épinglage exists and any two such épinglages are conjugate under
the action of (G0 /ZG0 )F .) We identify T = T as in 28.5. For s ∈ I let ′ Us∗ be
the root subgroup of G0 corresponding to the root α−1                            ′ ∗
                                                             s . Define y ∈ Us − {1},
ṡ ∈ NG0 T by ṡ = ξs (1)yξs (1); then ṡ is a representative of s in (NG0 T )F . For
s ∈ I ∪ {1} we define α̌s : k∗ −  → T as above if s ∈ I and to be 1, if s = 1.
    Following Tits, we can define uniquely for each w ∈ W a representative ẇ in
NG0 T by the requirements:
    (i) if s ∈ I then ṡ is as above;
    (ii) if w, w′ ∈ W and l(ww′ ) = l(w) + l(w′ ) then (ww′ )˙ = ẇẇ′ ;
    (iii) 1̇ = 1.
We have F (ẇ) = ẇ for any w ∈ W. Let Ť F = Hom(T F , Q̄∗l ). If L ∈ sq−1
(see 31.2) then L⊗(q−1) ∼    = L hence F ∗ L ∼ = L and there is a unique isomorphism
        ∗    ∼
τ0 : F L −→ L that induces the identity on the stalk at 1. Hence we can form the
characteristic function χL,τ0 : T F −  → Q̄∗l (a group homomorphism). Let λ ∈ sq−1
be the isomorphism class of L. We set θFλ = χL,τ0 ∈ Ť F . Now λ 7→ θFλ is a
                   ∼
bijection sq−1 −→ Ť F .
                                                                   α̌|F∗
                                                                      q          θ
  If θ ∈ Ť F , α ∈ R we write θ α̌ for the composition F∗q −−−→ T F −
                                                                     → Q̄∗l . For
α ∈ R, b ∈ W• we write bα̌ for the coroot a 7→ b(α̌(a)).
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                             45

35.3. In this section we write U instead of U ∗F . Let U be as in 34.12. Let T
be the vector space of all functions G0F −→ U that are constant on U, U double
cosets. Now T has a basis {kν ; ν ∈ (NG0 T )F } where kν is 1 on U νU and is 0 on
G0F − U νU . We regard T as an associative U-algebra in which the product of
h1 , h2 is given by
                                         X
                   (h1 h2 )(g) = |U |−1            h1 (g1 )h2 (g2 ).
                                                g1 ,g2 ∈G0F ;g1 g2 =g

This algebra has 1 = k1 . As in [Y], we have
                                                              X
                                 kṡ kṡ = qkα̌s (−1) +            kṡ kα̌s (a) ,
                                                            a∈F∗
                                                               q

                                              kν kν ′ = kνν ′ ,
where s ∈ I and ν, ν represent w, w′ in W such that l(ww′ ) = l(w) + l(w′ ). For
                         ′

any λ ∈ sq−1 we set
                                       X
                         1λ = |T F |−1   θFλ (t)kt ∈ T.
                                                    t∈T F
                                                √
Then 1λ 1λ′ = δλ,λ′ 1λ for λ, λ′ ∈ sq−1 . Let −1 be a fixed element of U∗ whose
                     √
square is −1; we set 1 = 1. For s ∈ I we set
                                  X q
                        Ts = kṡ          θFλ (α̌s (−1))1λ ∈ T.
                                         λ∈sq−1

More generally, for w ∈ W we set
                       X         Y                          q
                Tw =                                         θFλ (α̌(−1))kẇ 1λ ∈ T.
                             λ∈sq−1 α∈R+ ,w −1 α∈R−

From the definitions we see that Tw Tw′ = Tww′ for w, w′ ∈ W with l(ww′ ) =
l(w) + l(w′ ) and Tw 1λ = 1wλ Tw . We have
          X
  Ts Ts =      θFλ (α̌s (−1))kṡ kṡ 1λ
            λ
        X                                     X                       X
  =q        θFλ (α̌s (−1))kα̌s (−1) 1λ +           θFλ (α̌s (−1))            kṡ kα̌s (a) 1λ
        λ                                      λ                     a∈F∗
                                                                        q
            X                     X
  =q+           θFλ (α̌s (−1))          θFλ (α̌s (a))kṡ 1λ
            λ                    a∈F∗
                                    q
                      X                                                       X q
  = q + (q − 1)                 θFλ (α̌s (−1))kṡ 1λ = q + (q − 1)               θFλ (α̌s (−1))kṡ 1λ .
                        λ                                                      λ
                     λ                                                      λ
                    θF α̌s =1                                              θF α̌s =1

Thus,                                                         X
                             Ts Ts = q + (q − 1)                             Ts 1λ .
                                                                λ α̌ =1
                                                       λ∈sq−1 ;θF   s
46                                                      G. LUSZTIG

                            √                                   √      √
35.4. We fix a square root p of p in U. For any e ∈ Z we set pe = ( p)e . In
                                    √
           √                          q
particular, q ∈ U is defined. Then Hq−1 is defined as in 34.12. From 35.3 we see
                                                                                                      √
                                                                                                          q
that the elements Tw , 1λ of T define a U-algebra homomorphism Hq−1 −      → T. (We
                                              λ
use the fact that if λ ∈ sq−1 and s ∈ I then θF α̌s = 1 if and only if s ∈ Wλ .) This
is an isomorphism: from the definitions we see that {Tw 1λ ; w ∈ W, λ ∈ sq−1 } is a
U-basis of T; we then use 31.2(a).
35.5. Let P be the vector space of all functions f : G0F −  → U such that f (xu) =
f (x) for all x ∈ G0F , u ∈ U . For g ∈ GF , g ′ ∈ (NG B ∗ ∩ NG T )F such that
gG0 = g ′ G0 we define a linear map ρg,g ′ : P − → P by (ρg,g ′ f )(x) = f (g −1 xg ′ ).
                                           0
Then g0 : f 7→ ρg0 ,1 f makes P into a G F -module.
   Any element c ∈ T defines a linear map P −   → P:
                                                X
                     f 7→ cf, (cf )(x) = |U |−1    c(x′ )f (xx′ ).
                                                                    x′ ∈G0F
                                                                       ∼
Clearly, c 7→ [f →
                 7 cf ] is an isomorphism T −→ EndG0F (P) and a left T-module
structure on P. For ν ∈ (NG0 T )F , λ ∈ sq−1 , f ∈ P we have
                                              X
                          (kν f )(x) = |U |−1      f (xx′ ),
                                                                  x′ ∈UνU
                                                                   X
                                       (1λ f )(x) = |T F |−1              θFλ (t)f (xt).
                                                                  t∈T F
In the remainder of this section we fix a connected component D of G and an
element d ∈ (ND B ∗ ∩ ND T )F . Let s ∈ I ∪ {1}, λ ∈ sq−1 , f ∈ P. For x ∈ G0F we
have:
                        q
                          Dλ                                  Dλ
                                                    X
(a)     (Ts 1Dλ f )(x) = θF (α̌s (−1))|B ∗F |−1              θF (t)f (xx′ t).
                                                                          x′ ∈U ṡU,t∈T F

Now let s = (s1 , s2 , . . . , sr ) be a sequence in I ∪ {1}, λ ∈ sq−1 ,
             Ts 1Dλ = Ts1 Ts2 . . . Tsr 1Dλ = Ts1 1s2 ...sr Dλ Ts2 1s3 ...sr Dλ . . . Tsr 1Dλ .
Applying (a) r times gives (for f ∈ P, x ∈ G0F , g ∈ DF ):
        (Ts 1Dλ ρg,d f )(x) = aDλ,F,s |B ∗F |−r
                        s ...s Dλ   s ...s Dλ       Dλ
              X
         ×            θF2 r (t1 )θF3 r (t2 ) . . . θF (tr )f (g −1 xg1 t1 g2 t2 . . . gr tr d)
            g1 ,g2 ,...,gr
             t1 ,t2 ,...tr
             gi ∈U ṡi U
               ti ∈T F

        = aDλ,F,s |B ∗F |−r
(a′ )
                              Dλ
                X
        ×                    θF ((sr . . . s2 t1 )(sr . . . s3 t2 ) . . . (tr ))f (g −1 xg1 t1 g2 t2 . . . gr tr d)
            g1 ,g2 ,...,gr
             t1 ,t2 ,...tr
             gi ∈U ṡi U
               ti ∈T F
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                                            47

where

      aDλ,F,s
        q                            q                                  q
            Dλ                         Dλ                                 Dλ
       = θF (sr . . . s2 (α̌s1 (−1))) θF (sr . . . s3 (α̌s2 (−1))) . . . θF (α̌sr (−1)).

Let J ⊂ I and let Q ∈ PJ be such that F (Q) = Q. Define a linear map prQ :
P− → P by (prQ f )(x) = f (x) if x ∈ G0F , xQJ,B∗ x−1 = Q and (prQ f )(x) = f (x) if
x ∈ G0F , xQJ,B∗ x−1 6= Q. We compute the trace of the linear map

(b)                                        Ts 1Dλ ρg,d prQ : P −
                                                               →P

using the U-basis of P consisting of the characteristic functions of the various right
U -cosets in G0F . Using (a′ ) and the definitions we see that this trace equals
          aDλ,F,s                     X
(c)                                                         θFλ (d−1 (sr . . . s2 t1 )(sr . . . s3 t2 ) . . . (tr )d).
         |B ∗F |r |U |             g1 ,g2 ,...,gr ,
                                    t1 ,t2 ,...tr ;
                           gi ∈U ṡi U,ti ∈T F ,x∈DF ;
                         g −1 xg1 t1 g2 t2 ...gr tr d∈xU;
                               xQJ,B ∗ x−1 =Q

                                     ∼
35.6. Let L, λ, τ0 : F ∗ L −→ L be as in 35.2. Let s = (s1 , s2 , . . . , sr ) be a sequence
in I ∪ {1} such that s1 s2 . . . sr Dλ = λ. In 28.7 we have defined a local system
         s
L̃ on Z∅,J,D  in terms of d and a representative for s1 s2 . . . sr in NG0 T . We now
take as a representative for s1 s2 . . . sr the element ṡ1 ṡ2 . . . ṡr with ṡi as in 35.2.
We reformulate the definition of L̃ as follows (see also the proof of 28.10). Define
γ : Z ′s −   s
         → Z∅,J,D  by the formula 28.10(a). Define ψ : Z ′s −    → T by

                    (h0 , h1 , . . . , hr , g) 7→ d−1 (ṡ1 ṡ2 . . . ṡr )−1 n1 n2 . . . nr n0

with ni ∈ NG0 T given by h−1                 ∗      ∗               ∗
                             i−1 hi ∈ U ni U and n0 ∈ NG B ∩ NG T given by
h−1          ∗                                               s
  r gh0 ∈ U n0 . Then L̃ is the local system on Z∅,J,D such that γ L̃ = ψ L.
                                                                             ∗      ∗
                                                                        ∼
Note that γ, ψ are naturally defined over Fq . Let τ̃ : F ∗ ψ ∗ L −→ ψ ∗ L be the
                                                                                  ∼
isomorphism induced by τ0 . There is a well defined isomorphism τ : F ∗ L̃ −→ L̃
such that τ induces via γ the isomorphism τ̃ .
             s                                                  s,L
   Let πs : Z∅,J,D −→ ZJ,D be as in 28.12(a) and let K = KJ,D       = πs! L̃ ∈ D(ZJ,D ).
                                                             ∼
Now πs is naturally defined over Fq . Hence τ : F ∗ L̃ −→ L̃ induces an isomorphism
           ∼
ω : F ∗ K −→ K and χK,ω : ZJ,D F
                                    −→ Q̄l is defined. Let ξ = (Q, Q′ , gUQ ) ∈ ZJ,DF

(we can take g ∈ DF ). Using the definitions and the Grothendieck trace formula
we have
                      X                                        X
           χK,ω (ξ) =    (−1)i tr(τ ∗ , Hci (πs−1 (ξ), L̃)) =       tr(τ, L̃η )
                                i                                                 η∈πs−1 (ξ)F
48                                                    G. LUSZTIG

where L̃η is the stalk of L̃ at η. Now γ induces a map Z ′sF −  s
                                                             → Z∅,J,D F
                                                                        all of
                              ∗F r+1 F
whose fibres have cardinal |B | |UJ,B∗ |. It follows that
                                                    X                                     X
        |B ∗F |r+1 |UJ,B
                     F
                         ∗ |χK,ω (ξ) =                        tr(τ̃ , (ψ ∗ L)η̃ ) =                  tr(τ0 , Lψ(η̃) ).
                                                       ′ sF                                   ′ sF
                                                  η̃∈Z                                  η̃∈Z
                                                 πs γ(η̃)=ξ                            πs γ(η̃)=ξ

Let

               Ξ = {(h0 , h1 , . . . , hr ) ∈ (G0F )r+1 ; h−1        ∗     ∗
                                                           i−1 hi ∈ B ṡi B (i ∈ [1, r]),
                                                             −1
                                  h−1          ∗
                                   r gh0 ∈ NG B , h0 QJ,B ∗ h0 = Q}.

Then {η̃ ∈ Z ′sF ; πs γ(η̃) = ξ} may be identified with Ξ × (gUQ
                                                               F
                                                                 ). Hence
                                                           X
                 χK,ω (ξ) = |B ∗F |−r−1                                  χL,τ0 (δ(h0 , h1 , . . . , hr ))
                                                   (h0 ,h1 ,...,hr )∈Ξ


           → T given by (h0 , h1 , . . . , hr ) 7→ d−1 (ṡ1 ṡ2 . . . ṡr )−1 n1 n2 . . . nr n0 (ni , n0
with δ : Ξ −
as above). For any (h0 , h1 , . . . , hr ) ∈ Ξ we define gi ∈ U ṡi U , ti ∈ T F (i ∈ [1, r]) by
h−1
 i−1 hi = gi ti . We also set h0 = x. Then Ξ becomes

      {(x, g1 ,g2 , . . . , gr , t1 , t2 , . . . , tr ); x ∈ G0F , gi ∈ U ṡi U, ti ∈ T F ;
                gx = xg1 t1 g2 t2 . . . gr tr tdu for some t ∈ T F , u ∈ U ; xQJ,B∗ x−1 = Q}

and δ : Ξ −
          → T becomes

         (x, g1 , g2 , . . . , gr , t1 , t2 , . . . , tr ) 7→ d−1 (ṡ1 ṡ2 . . . ṡr )−1 ds1 t1 ṡ2 t2 . . . ṡr tr td
           = d−1 (sr . . . s2 t1 )(sr . . . s3 t2 ) . . . (sr tr−1 )(tr t)d.

We make the change of variable tr t 7→ tr , t 7→ t. Then t no longer appears
explicitly; it only introduces a factor |T F |. We see that

      χK,ω (ξ)
             |T F |                    X
       =                                                   θFλ (d−1 (sr . . . s2 t1 )(sr . . . s3 t2 ) . . . (tr )d).
           |B ∗F |r+1             g1 ,g2 ,...,gr ,
                                   t1 ,t2 ,...tr ,
                          gi ∈U ṡi U,ti ∈T F ,x∈DF ,
                         g −1 xg1 t1 g2 t2 ...gr tr d∈xU
                               xQJ,B ∗ x−1 =Q


This is the same (up to the factor aDλ,F,s ) as the expression 35.5(c). Using the
equality between 35.5(c) and the trace of 35.5(b), we see that

(a)                   χK,ω (Q, gQg −1, gUQ ) = a−1
                                                Dλ,F,s tr(Ts 1Dλ ρg,d prQ , P).
             CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                         49

35.7. In the setup of 35.6, let Js ⊂ J 0 ⊂ [1, r] be as in 28.9. For any J ⊂ Js let sJ
                                                          sj
be as in 28.9. We have s∅ = s. Define γJ : Z ′sJ −   → Z∅,J,D by the formula 28.10(a).
               ′sJ
Define ψJ : Z      −
                   → T as in 28.10 (with ṡ as in 35.2). Let L̃J be the local system
     sJ                                                    ∼
on Z∅,J,D such that γJ∗ L̃J = ψJ ∗
                                   L. Let τ̃ J : F ∗ ψJ
                                                      ∗
                                                        L −→ ψJ∗
                                                                 L be the isomorphism
                                                                                     ∼
induced by τ0 . There is a well defined isomorphism τ J : F ∗ L̃J −→ L̃J such that
τ J induces via γJ the isomorphism τ̃ J . Note that for J = ∅, L̃J , τ̃ J , τ J reduce
to L̃, τ̃ , τ of 35.6.
             s
   Let Z̄∅,J,D     be as in 28.9. This is a smooth irreducible variety, naturally de-
                         s∅                       s                       s
fined over Fq and Z∅,J,D       is open dense in Z̄∅,J,D . Hence L̄ = IC(Z̄∅,J,D , L̃∅ ) is
                                                  ∼                                      s
defined and the isomorphism τ ∅ : F ∗ L̃∅ −→ L̃∅ of local systems on Z∅,J,D
                                                                       ∅
                                                                            extends
                                                  ∼
canonically to an isomorphism τ ♯ : F ∗ L̄ −→ L̄ (of constructible sheaves, see 28.10).
                                                sJ         s
Restricting this isomorphism to the subset Z∅,J,D     of Z̄∅,J,D (with J ⊂ Js ) we ob-
                                         ∼
tain an isomorphism τ ♯J : F ∗ E J −→ E J where E J = L̄|Z sJ                     . From 28.10 we see
                                                                         ∅,J,D

that E J is a local system isomorphic to L̃J .
Lemma 35.8. The isomorphisms τ ♯J , τ J correspond to each other under
                                           ∼         sJ
some/any isomorphism of local systems E J −→ L̃J on Z∅,J,D .
    The proof is a refinement of that of Lemma 28.10. Note that Z ′s∅ is an
open dense subvariety of the smooth irreducible variety Z̃ s (as in 28.10). Hence
                                                                    ∼
IC(Z̃ s , ψ∅∗ L) is defined and the isomorphism τ̃ ∅ : F ∗ ψ∅∗ L −→ ψ∅∗ L of local systems
on Z ′s∅ extends canonically to an isomorphism
                                 ∼
    τ̃ ♯ : F ∗ IC(Z̃ s , ψ∅∗ L) −→ IC(Z̃ s , ψ∅∗ L)
which may be identified with the isomorphism induced by τ ♯ through the fibration
Z̃ s −       s
      → Z̄∅,J,D    (see 28.10(a)) whose fibres are smooth and connected. Let Ẽ J =
                                                    ∼
IC(Z̃ s , ψ∅∗ L)|Z ′ sJ and let τ̃ ♯J : F ∗ Ẽ J −→ Ẽ J be the isomorphism induced by τ̃ ♯
by restriction. It suffices to prove the following statement:
    The isomorphisms τ̃ ♯J , τ̃ J correspond to each other under some/any isomor-
                                    ∼
phism of local systems Ẽ J −→ ψJ       ∗
                                            L.
                 −1 ∗                                          ∼
Let L = (D ) L ∈ s(T) = s(T ). Let τ0′ : F ∗ L′ −→ L′ be the unique isomor-
          ′

phism which induces the identity map on the stalk of L′ at 1. Let ′ Z̄ s , ′ Z sJ be
as in 28.10. Define ′ ψJ : ′ Z sJ −       → T as in 28.10 (with ṡ as in 35.2). Then ′ ψJ
                                                                                     ∼
is compatible with the natural Fq -structures on ′ Z sJ , T ; hence τ0′ : F ∗ L′ −→ L′
                                                              ∗ ′ ∼ ′ ∗ ′
induces an isomorphism of local systems ′ τ J : F ∗′ ψJ        L −→ ψJ L . Let
                      ′ ♯                              ∼
                       τ : F ∗ IC(′ Z̄ s , ′ ψ∅∗ L′ ) −→ IC(′ Z̄ s , ′ ψ∅∗ L′ )
                                                           ∼
be the isomorphism induced by ′ τ ∅ : F ∗′ ψ∅∗ L′ −→ ′ ψ∅∗ L′ . Let
                                ′ J
                                 E    = IC(′ Z̄ s , ′ ψ∅∗ L′ )|′ Z sJ
                            ∼
and let ′ τ ♯J : F ∗′ E J −→ ′ E J be the isomorphism induced by ′ τ ♯ by restriction.
As in the proof of 28.10, it suffices to prove the following statement:
50                                          G. LUSZTIG

   (a) The isomorphisms ′ τ ♯J , ′ τ J correspond to each other under some/any iso-
                                     ∼
morphism of local systems ′ E J −→ ′ ψJ  ∗ ′
                                          L.
Assume that (a) is known in the case where |J | = 1. We now consider a general
J ⊂ Js . We prove (a) by induction on |J |. If J = ∅, (a) is obvious. Assume
that J =6 ∅. Let j ∈ J be the largest number in J . Let J ′ = J − {j}. Let ′ Z̄ sJ ′
be the variety analogous to ′ Z̄ s when s is replaced by sJ ′ (this is the same as the
closure of ′ Z sJ ′ in ′ Z̄ s ). Let

                     ′′ ♯                              ∼
                      τ : F ∗ IC(′ Z̄ sJ ′ , ′ ψJ
                                                ∗   ′
                                                       → IC(′ Z̄ sJ ′ , ′ ψJ
                                                  ′L ) −
                                                                           ∗   ′
                                                                             ′L )


                                              ′                   ∼
be the isomorphism induced by ′ τ J : F ∗′ ψJ      ∗
                                                      ′L −
                                                           ′
                                                             → ′ ψJ∗    ′
                                                                     ′ L and let
                                                                                 ′′ ♯J
                                                                                   τ    be its
                   ′ sJ                                                            ′ ♯J ′ ′ J ′
restriction to Z . By the induction hypothesis, the isomorphisms τ , τ
                                                                                          ′ ∼
correspond to each other under some/any isomorphism of local systems ′ E J −→
′ ∗
 ψJ ′ L′ . It follows that the isomorphisms ′′ τ ♯J , ′ τ ♯J correspond to each other under
some/any isomorphism of local systems
                                                              ∼
                               IC(′ Z̄ sJ ′ , ′ ψJ
                                                 ∗    ′
                                                                → ′E J .
                                                   ′ L )|′ Z sJ −



By our assumption (applied to sJ ′ instead of s), the isomophisms ′′ τ ♯J , ′ τ J cor-
respond to each other under some/any isomorphism of local systems
                                                             ∼
                              IC(′ Z̄ sJ ′ , ′ ψJ
                                                ∗    ′
                                                               → ′ ψJ
                                                  ′ L )|′ Z sJ −
                                                                    ∗ ′
                                                                      L.

It follows that the isomorphisms ′ τ ♯J , ′ τ J correspond to each other under
                                                               ∼
some/any isomorphism of local systems ′ E J −→ ′ ψJ                ∗ ′
                                                                    L . Thus, (a) holds for J .
    We now consider the remaining case, where J consists of a single element j.
Note that j ∈ Js where Js is defined in terms of D, L or equivalently, in terms of
G0 , L′ . The statement (a) involves only G0 . Hence to prove it, we may assume
that G = G0 . We write Z ′ , Z ′′ instead of ′ Z s∅ , ′ Z s{j} and we set Z = Z ′ ∪ Z ′′ , a
subvariety of ′ Z̄ s . We write f ′ , f ′′ instead of ′ ψ∅ , ′ ψ{j} . Let b = ṡj+1 ṡj+2 . . . ṡr .
    We have L′ = κ∗ L1 where κ ∈ Hom(T, k∗ ) and L1 ∈ s(k∗ ). Since L′⊗(q−1) ∼                        =
                                           ⊗(q−1) ∼
Q̄l , we may assume that L1                         = Q̄l . Hence there is a unique isomorphism
           ∗        ∼
τ1 : F L1 −→ L1 which induces the identity on the stalk of L1 at 1. Then
                 ∼
τ0′ : F ∗ L′ −→ L′ is induced by τ1 , via κ∗ .
    We continue the proof assuming that G has simply connected derived subgroup.
Let β̌ be as in the proof of 28.10. As in that proof, we may assume that hβ̌, κi = 0.
Hence there exists a homomorphism of algebraic groups χ : B ∗ ṡj B ∗ ∪ B ∗ −                         →
  ∗                                   −1
k such that χ(t) = κ(b tb) for all t ∈ T . Let f : Z −               ˜          ∗
                                                                           → k be as in 28.10.
                 ∗    ∗                   ˜
If yj ∈ B ṡj B , we have f (y1 , . . . , yr ) = κ(f (y1 , . . . , yr )); if yj ∈ B ∗ we have
                                                                ′

f˜(y1 , . . . , yr ) = κ(f ′′ (y1 , . . . , yr )). (See 28.10.) We show that

                         χ(F (g)) = χ(g)q for all g ∈ B ∗ ṡj B ∗ ∪ B ∗ .
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                      51

We may assume that g ∈ T . Then
      χ(F (g)) = κ(b−1 F (g)b) = κ(F (b−1 gb)) = κ((b−1 gb)q ) = κ(b−1 gb)q = χ(g)q ,
as required. It follows that for any (y1 , . . . , yr ) ∈ Z we have
(b)                        f˜(F (y1 ), . . . , F (yr )) = (f˜(y1 , . . . , yr ))q .
Let F = f˜∗ (L1 ). We have canonically FZ ′ = f ′∗ L′ , F |Z ′′ = f ′′∗ L′ . From (b) we
                                         ∼                                                         ∼
see that the isomorphism τ1 : F ∗ L1 −→ L1 induces via f˜∗ an isomorphism F ∗ F −→
F and this gives rise upon restriction to Z ′ , Z ′′ to the isomorphisms ′ τ ∅ , ′ τ {j} .
Since F is a local system on Z such that F |Z ′ = f ′∗ L′ , we have canonically
F = IC(Z, f ′∗ L′ ). Hence (a) holds in our case.
    We now drop the assumption that G has simply connected derived subgroup.
Let π : Ĝ − → G be a surjective homomorphism of connected reductive groups
whose kernel is a central torus in Ĝ and such that Ĝ has simply connected derived
subgroup. We may assume that Ĝ and π are defined over Fq . Then π restricts to
a surjective homomorphism ĜF −       → GF . Since the set of épinglages of G, Ĝ are in
natural bijection, the épinglage of G fixed in 35.2 gives rise to an épinglage of Ĝ
(the associated Borel subgroup and maximal torus are B̂ ∗ = π −1 (B ∗ ), T̂ = π −1 (T )
and the analogue of ξs : k −     → U ∗ is the obvious one). For s ∈ I let s̃ ∈ (NĜ T̂ )F
be associate to this épinglage of Ĝ in the same way as ṡ was associated to the
épinglage of G. We set 1̃ = 1 ∈ G̃. Define Ẑ, Ẑ ′ , Ẑ ′′ , fˆ′ : Ẑ ′ −
                                                                          → T̂ , fˆ′′ : Ẑ ′′ −
                                                                                              → T̂ in
               ∗                                   ′   ′′      ′     ′           ′′      ′′
terms of Ĝ, B̂ , T̂ , s̃i in the same way as Z, Z , Z , f : Z −        → T, f : Z −         → T are
defined in terms of G, B , T, ṡi . Let L̂ ∈ s(T̂ ) be the inverse image of L′ under
                               ∗            ′

       → T . There is a unique isomorphism F ∗ L̂′ ∼
π : T̂ −                                                = L̂′ which induces the identity
                            ′
map on the stalk of L̂ at 1. This induces isomorphisms
                     τ̂ : F ∗ fˆ′∗ L̂′ −
                    ′ ∅
                                       → fˆ′∗ L̂′ , ′ τ̂ {j} : F ∗ fˆ′′∗ L̂′ −
                                                                             → fˆ′′∗ L̂′ .
                                                                       ∼
Now ′ τ̂ ∅ induces an isomorphism F ∗ IC(Ẑ, fˆ′∗ L̂′ ) −→ IC(Ẑ, fˆ′∗ L̂′ ) and this re-
stricts to an isomorphism of local systems
                                                            ∼
                     ′ ♯{j}
                      τ̂      : F ∗ IC(Ẑ, fˆ′∗ L̂′ )|Ẑ ′′ −→ IC(Ẑ, fˆ′∗ L̂′ )|Ẑ ′′ .
By an earlier part of the proof, the isomorphisms ′ τ̂ ♯{j} , ′ τ̂ {j} correspond to each
                                                                                     ∼
other under some/any isomorphism of local systems IC(Ẑ, fˆ′∗ L̂′ )|Ẑ ′′ −→ fˆ′′∗ L̂′ .
Now the map Ẑ −      → Z induced by π is a fibration with smooth connected fibres
             ˆ
and IC(Ẑ, f L̂ ) is canonically the inverse image under this map of IC(Z, f ′∗ L′ ).
              ′∗ ′

Hence IC(Ẑ, fˆ′∗ L̂′ )|Ẑ ′′ is the inverse image under Ẑ ′′ −
                                                               → Z ′′ of IC(Z, f ′∗ L′ )|Z ′′ .
Similarly, fˆ′′∗ L̂′ is the inverse image under Ẑ ′′ −
                                                      → Z ′′ of f ′′∗ L′ . Also, ′ τ̂ ♯{j} , ′ τ̂ {j}
                        ′ ♯{j} ′ {j}
are obtained from τ            , τ    by inverse image under Ẑ ′′ −→ Z ′′ . Therefore the
required statement about ′ τ ♯{j} , ′ τ {j} is a consequence of the analogous, already
known statement about ′ τ̂ ♯{j} , ′ τ̂ {j} (we use the faithfulness of the inverse image
functor under the fibration Ẑ ′′ −   → Z ′′ with smooth connected fibres). The lemma
is proved.
52                                        G. LUSZTIG

                                                 s
35.9. We preserve the setup of 35.7. Let π̄s : Z̄∅,J,D −
                                                       → ZJ,D be as in 28.12 and
              s,L
let K̄ = K̄J,D    = π̄s! L̄ ∈ D(ZJ,D ) (see 28.12, 35.7). Now π̄s is naturally defined
                                                 ∼
over Fq . Hence the isomorphism τ ♯ : F ∗ L̄ −→ L̄ in 35.7 induces an isomorphism
ω̄ : F ∗ K̄ −                   F
            → K̄ and χK̄,ω̄ : ZJ,D −
                                   → Q̄l is defined.
Proposition 35.10. Let (Q, Q′ , gUQ ) ∈ ZJ,D
                                         F
                                             (we take g ∈ DF ). Let CDλ
                                                                     s
                                                                        ∈ Hq−1
be as in 31.5. We have

                    χK̄,ω̄ (Q, Q′ , gUQ ) = a−1         s
                                             Dλ,F,s tr(CDλ ρg,d prQ , P).


                                             sJ
                            s
   Consider the partition Z̄∅,J,D = ⊔J ⊂J 0 Z∅,J,D (see 28.9). For each J ⊂ J 0
           sJ
let πJ : Z∅,J,D −
                → ZJ,D be the restriction of p̄s , let KJ = πJ ! (L̄|Z sJ ) and
                                                                                     ∅,J,D

let ωJ : F ∗ KJ −→ KJ be the isomorphism induced by τ ♯ . P       Using the additivity
property of characteristic functions, we see that χK̄,ω̄ =          J ⊂J 0 χKJ ,ωJ . By
28.10, we have KJ = 0 unless J ⊂ Js . By Lemma 35.8, if J ⊂ Js , χKJ ,ωJ is
just like χK,ω in 35.6, with s replaced by sJ . Hence 35.6(a) can be applied and it
yields
               χKJ ,ωJ (Q, Q′ , gUQ ) = a−1
                                         Dλ,F,sJ tr(TsJ 1Dλ ρg,d prQ , P).

We will verify below that

(a)                       aDλ,F,s = aDλ,F,sJ for any J ⊂ Js .

We see that
                                                   X
             χK̄,ω̄ (Q, gQg −1, gUQ ) = a−1
                                         Dλ,F,s           tr(TsJ 1Dλ ρg,d prQ , P)
                                                  J ⊂Js

                                                 s
                                                        P
is as desired. (We have used the identity CDλ        = J ⊂Js TsJ 1Dλ which follows
easily from the definitions.)
   We now verify (a). We may assume that J has a single element j ∈ Js (the
general case can then be obtained by iteration). We have sJ = (s′1 , s′2 , . . . , s′r )
where s′i = si for i 6= j and s′j = 1. It suffices to show that, for any k ∈ [1, r] we
have
             q                                q
                 Dλ                              Dλ
(b)             θF (sr . . . sk+1 α̌sk (−1)) = θF (s′r . . . s′k+1 α̌s′k (−1)).

If sk = 1, then s′k = 1 and both sides are 1. If sk ∈ I and k > j then sk′ = s′k′ for
k′ ≥
   qk and (b) is obvious. If k = j then (b) states that
       Dλ
      θF (sr . . . sj+1 α̌sj (−1)) = 1;
this follows from
                         Dλ
(c)                     θF (sr . . . sj+1 α̌sj (a)) = 1 for all a ∈ F∗q
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                               53

which comes from j ∈ Js . Assume now that sk ∈ I and k < j. Then for some
m ∈ Z we have

                          sj sj−1 . . . sk+1 α̌sk = (sj−1 . . . sk+1 α̌sk )α̌m
                                                                             sj .

Applying sr sr−1 . . . sj+1 to both sides gives

    sr sr−1 . . . sk+1 α̌sk = (sr sr−1 . . . sj+1 sj−1 . . . sk+1 α̌sk )(sr sr−1 . . . sj+1 α̌sj )m .

               Dλ
Applying θF         to both sides and using (c) gives
          Dλ                                      Dλ
        θF (sr sr−1 . . . sk+1 α̌sk (a)) = θF (sr sr−1 . . . sj+1 sj−1 . . . sk+1 α̌sk (a))

for all a ∈ F∗q . We set a = −1 and we see that (b) holds for this k. This proves
(a). The proposition is proved.
                                                                                ∼
35.11. Let L, L′ ∈ sn . Then L, L′ ∈ sq−1 . Let τ0 : F ∗ L −→ L be as in 35.2; let
                   ∼
τ0′ : F ∗ L′ −→ L′ be the analogous isomorphism. Let λ ∈ sn (resp. λ′ ∈ sn ) be
the isomorphism class of L (resp. L′ ). We have λ ∈ sq−1 , λ′ ∈ sq−1 . Let s =
(s1 , s2 , . . . , sr ), s′ = (s′1 , s′2 , . . . , s′r′ ) be sequences in I such that s1 s2 . . . sr Dλ = λ,
                                                    s,L                 ∼                                s′ ,L′
s′1 s′2 . . . s′r′ Dλ′ = λ′ . Let K̄ = K̄J,D             , ω̄ : F ∗ K̄ −→ K̄ be as in 35.9. Let K̄ ′ = K̄J,D
                              ∼
and let ω̄ ′ : F ∗ K̄ ′ −→ K̄ ′ be the analogue of ω̄ (defined in terms of τ0′ ). Then
               F                               F
χK̄,ω̄ : ZJ,D       −
                    → Q̄l , χK̄ ′ ,ω̄′ : ZJ,D        −→ Q̄l are defined. Let
                               X
                E=                          χK̄,ω̄ (Q, Q′ , gUQ )χK̄ ′ ,ω̄′ (Q, Q′ , gUQ ).
                                      F
                        (Q,Q′ ,gUQ )∈ZJ,D


Using 35.10 for K̄ and for K̄ ′ , we see that

                                                                      s′
                                   X X
              −1 −1
        F
 E = |UJ,B ∗|   aDλ,F,s a−1
                         Dλ′ ,F,s′
                                                  s
                                              tr(CDλ ρg,d prQ , P)tr(CDλ ′ ρg,d prQ , P).

                                          Q∈PJF g∈DF


Setting g = dg0 where g0 ∈ G0F we have ρg,d = ρd,d ρg0 ,1 . Hence
                                               X
                 −1 −1
          F
    E = |UJ,B ∗|   aDλ,F,s a−1
                            Dλ′ ,F,s′
                                                               s
                                                       tr(prQ CDλ ρd,d ρg0 ,1 , P)
                                              Q∈PJF
                                             g0 ∈G0F
                    ′
                                                     −1 −1
               s
     × tr(prQ CDλ′ ρd,d ρg0 ,1 , P) = |G
                                        0F    F
                                           ||UJ,B ∗|   aDλ,F,s a−1
                                                                Dλ′ ,F,s′ tr(XY, P ⊗ P)

where
                  X                                            ′
                                       s             s
         X=             (prQ ⊗ prQ )((CDλ ρd,d ) ⊗ (CDλ′ ρd,d )) : P ⊗ P −
                                                                         → P ⊗ P,
                Q∈PJF
54                                                   G. LUSZTIG
                                            X
                 Y = |G0F |−1                       (ρg0 ,1 ⊗ ρg0 ,1 ) : P ⊗ P −
                                                                               → P ⊗ P.
                                        g0   ∈G0F

                                                                                            0F
We have XY = Y X and Y is a projection of P ⊗ P onto the subspace (P ⊗ P)G
of G0F -invariants for the G0F -action in which g0 acts as ρg0 ,1 ⊗ ρg0 ,1 . Hence X
                0F
maps (P ⊗ P)G into itself and
                                                                                       0F
                                    −1 −1
                 E = |G0F ||UJ,B
                             F
                                 ∗|   aDλ,F,s a−1
                                               Dλ′ ,F,s′ tr(X, (P ⊗ P)
                                                                       G
                                                                         ).

The non-singular symmetric bilinear form
                                                                  X
                                       → U, (f, f ′ ) =
                          (, ) : P × P −                                f (x)f ′ (x)
                                                                x∈G0F

                                                      ∼
gives rise to an isomorphism P ⊗ P −→ End(P), f ′ ⊗ f ′′ 7→ [f 7→ (f, f ′ )f ′′ ]. Under
this isomorphism, X corresponds to a linear map X ′ : End(P) −   → End(P),
                                    X                  ′
                                                   s           t      s
                          φ 7→               (prQ CDλ′ ρd,d )φ( (prQ CDλ ρd,d ))

                                   Q∈PJF


where t denotes taking transpose with respect to (, ). We have (ρg0 ,1 f, ρg0 ,1 f ′ ) =
                                                        ∼
(f, f ′ ) for all f, f ′ ∈ P, g0 ∈ G0F . Hence P ⊗ P −→ End(P) restricts to an
                            0F ∼
isomorphism (P ⊗ P)G −→ EndG0F (P) under which
                    0F              0F
   X : (P ⊗ P)G −        → (P ⊗ P)G
corresponds to the restriction of X ′ to EndG0F (P). It follows that

                                    −1 −1
                 E = |G0F ||UJ,B
                             F
                                 ∗|   aDλ,F,s a−1            ′
                                               Dλ′ ,F,s′ tr(X , EndG0F (P)).


From the definitions we have

                                        t
                                            ρd,d = ρd−1 ,d−1 : P −
                                                                 → P,

                                    t
                                        (prQ ) = prQ for all Q ∈ PJ ,
                            t
                                (kν ) = kν −1 : P −
                                                  → P for all ν ∈ NG0 T.

In particular,
                      t
                          kṡ = kṡ−1 = kṡ kα̌s (−1) : P −
                                                          → P for all s ∈ I.

We also see that

                           t
                               (1λ1 ) = 1λ−1 : P −
                                                 → P for all λ1 ∈ sq−1 .
                                               1
                  CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                            55

For s ∈ I, λ1 ∈ sq−1 we have
                     q                                          q
   t
       (Ts 1λ1 ) =       θFλ1 (α̌s (−1))1λ−1 kṡ kα̌s (−1)     = θFλ1 (α̌s (−1))θFλ1 (α̌s (−1))1λ−1 kṡ
                                          1                                                            1

               =     θFλ1 (α̌s (−1))Ts 1sλ−1          :P−
                                                        → P,
                                          1



hence t (Cλs1 ) = θFλ1 (α̌s (−1))Csλ
                                  s
                                    −1 : P −
                                           → P. It follows that
                                                1


                                t     s
                                    (CDλ ) = δ0 Css̃1 s2 ...sr (Dλ)−1 = δ0 Cλs̃ −1

where s̃ = (sr , . . . , s2 , s1 ) and
             Dλ                       Dλ                             Dλ
  δ0 = (θF (α̌sr (−1)))(θF (sr α̌sr−1 (−1))) . . . (θF (sr . . . s2 α̌s1 (−1))) = a2Dλ,F,s .
                                                          ′
We see that X ′ (φ) = δ0                                 s                    s̃
                                     P
                                        Q∈PJF       prQ CDλ′ ρd,d φρd−1 ,d−1 C −1 prQ for φ ∈ End(P).
                                                                              λ

35.12. For w ∈ W we set

                                      td,w = ((ǫD (w))˙)−1 dẇd−1 ∈ T F .

We show that, for λ1 ∈ sq−1 , we have

(a)            ρd,d Tw 1λ1 ρd−1 ,d−1 = θFλ1 (d−1 td,w d)−1 TǫD (w) 1Dλ1 : P −
                                                                            → P.
                                                                                      √
                                                                                       q
(We regard Tw 1λ1 as an element of EndG0F P = T = Hq−1 , see 35.4, 35.5.) We
first show that for ν ∈ (NG0 T )F we have

                                     ρd,d kν ρd−1 ,d−1 = kdνd−1 : P −
                                                                    → P.

Indeed, for f ∈ P, x ∈ G0F , we have

         (ρd,d kν ρd−1 ,d−1 f )(x) = (kν ρd−1 ,d−1 f )(d−1 xd)
                     X                                          X
          = |U |−1           (ρd−1 ,d−1 f )(d−1 xdx′ ) = |U |−1   f (dd−1 xdx′ d−1 )
                      x′ ∈UνU                                             x′ ∈UνU
                            X
          = |U |−1                       f (xx′′ ) = (kdνd−1 f )(x),
                      x′′ ∈Udνd−1 U

as required. Using the equality
                                           Y             q
                     Tw 1λ1 =                             θFλ1 (α̌(−1))kẇ 1λ1
                                    α∈R+ ,w −1 α∈R−
                                            Y             q                   X
                     = |T | F −1
                                                              θFλ1 (α̌(−1))           θFλ1 (t)kẇt ,
                                     α∈R+ ,w −1 α∈R−                          t∈T F
56                                              G. LUSZTIG

we have
          ρd,d Tw 1λ1 ρd−1 ,d−1
                             Y                 q                   X
           = |T F |−1                              θFλ1 (α̌(−1))           θFλ1 (t)ρd,d kẇt ρd−1 ,d−1
                         α∈R+ ,w −1 α∈R−                           t∈T F
                                 Y             q                   X
          = |T F |−1                               θFλ1 (α̌(−1))           θFλ1 (t)kdẇtd−1
                         α∈R+ ,w −1 α∈R−                           t∈T F
                                 Y             q                   X
          = |T F |−1                               θFλ1 (α̌(−1))           θFλ1 (t)kdẇd−1 kdtd−1
                         α∈R+ ,w −1 α∈R−                           t∈T F
                                   q
                                     Dλ
                       Y
          =                         θF 1 (Dα̌(−1))k(ǫD (w))˙ktd,w 1Dλ1
              α∈R+ ,w −1 α∈R−
                                                         q
               Dλ                                          Dλ
                                           Y
          =   θF 1 (t−1
                     d,w )                                θF 1 (α̌′ (−1))k(ǫD (w))˙1Dλ1
                              α′ ∈R+ ,ǫD (w)−1 α′ ∈R−

          = θFλ1 (d−1 td,w d)−1 TǫD (w) 1Dλ1
and (a) is proved.
                  J
35.13. We
        √
           write Θ
                 √n
                         → Hn instead of ΘJ : Hn −
                    : Hn −                        → Hn , see 32.22. Let
 J       q        q                            J
Θn,q : Hn − → Hn be the linear map defined by Θn by extension of scalars.
                                                                                √              √
                                                                                    q               q
Replacing n by q − 1 we obtain a linear map ΘJq−1,q : Hq−1 −
                                                           → Hq−1 . We identify
                        √
                          q
EndG0F P = T =         Hq−1 ,  see 35.4, 35.5. We show:
                                            X
(a)                           ΘJq−1,q (φ) =     prQ φprQ : P −
                                                             →P
                                                Q∈PJF

for any φ ∈ EndG0F P. First we show that for ν ∈ (NG0 T )F we have
        X                                  X
(b)         prQ kν prQ = kν if ν ∈ QJ,B∗ ;    prQ kν prQ = 0 if ν ∈
                                                                  / QJ,B∗ .
        Q∈PJF                                            Q∈PJF

Let f ∈ P, x ∈ G0F . We have
     X                                        X
   (     prQ kν prQ f )(x) =                            (kν prQ f )(x)
      Q∈PJF                              Q∈P ;     J

                                      xQJ,B ∗ x−1 =Q
                       X                                                         X
      = |U |−1                    (prQ f )(xx′ ) = |U |−1                                               f (xx′ )
                    Q∈P J ;                                               Q∈P J ;
                 xQJ,B ∗ x−1 =Q;                                      xQJ,B ∗ x−1 =Q;
                    x′ ∈UνU                                    x′ ∈UνU;xx′ QJ,B ∗ x′ −1 x−1 =Q
                          X                                           X
      = |U |−1                             f (xx′ ) = |U |−1                            f (xx′ ),
                       x′ ∈UνU;                                x′ ∈UνU∩QJ,B ∗
                 x′ QJ,B ∗ x′ −1 =QJ,B ∗
              CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                               57

and (b) follows.
  It suffices to prove (a) for φ = Tw 1λ where w ∈ W, λ ∈ sq−1 . We have

  X                                    Y        q                  X                  X
                             F −1
         prQ Tw 1λ prQ = |T |                       θFλ (α̌(−1))           θFλ (t)           prQ kẇt prQ .
                                            +
 Q∈PJF                                α∈R                          t∈T F             Q∈PJF
                                    w −1 α∈R−


By (b) this is zero, unless ẇ ∈ QJ,B∗ that is, w ∈ WJ ; assuming that w ∈ WJ this
equals                              q
                          Y                        X
            |T F |−1                  θFλ (α̌(−1))   θFλ (t)kẇt = Tw 1λ ;
                      α∈R+ ,w −1 α∈R−                     t∈T F

(a) is proved.
35.14. Let m be an integer ≥ 1. Let Fq m be the subfield of k consisting of
q m elements. Then F m : G −     → G is the Frobenius map for an Fq m -rational
structure on G. The épinglage in 35.2 relative to Fq can be also regarded as
                                                                (m)           ∼
an épinglage relative to Fq m . In the setup of 35.11, define τ0   : F m∗ L −→ L,
                   ∼
τ0′ (m) : F m∗ L′ −→ L′ in terms of τ0 , τ0′ as in 33.5. We have χL,τ (m) = θFλ m ,
                                                                                             0
                 ′
χL′ ,τ0′ (m) = θFλ m where
                             m−1        ′             ′              m−1
    θFλ m (t) = θFλ (t1+q+···+q    ), θFλ m (t) = θFλ (t1+q+···+q )
                  F m
                               (m)      m∗      ∼
for all t ∈ T . Now ω̄             : F K̄ −→ K̄ (see 33.5) has the same relation to
  (m)                    ∼                                                  ∼
τ0       as ω̄ : F K̄ −→ K̄ (see 35.9) to τ0 . Let ω̄ ′(m) : F m∗ K̄ ′ −→ K̄ ′ be the
                    ∗
                                                                               Fm
analogous isomorphism defined in terms of τ0′ (m) . Then χK̄,ω̄(m) : ZJ,D          −
                                                                                   → Q̄l ,
                 Fm
χK̄ ′ ,ω̄′(m) : ZJ,D −→ Q̄l are well defined.
    We choose (as we may) m0 ∈ N∗k such that (−1)m0 = 1 (in k∗ ) and tm           d,w = 1
                                                                                    0


(in T ) for all w ∈ W.
    We show that if m ∈ m0 Z, m ≥ 1, then aDλ,F m ,s = 1. It suffices to show
           Dλ                                                                    Dλ
that θF m α̌(−1) = 1 for any α ∈ R. Since Dλ ∈ sq−1 we have θF m (t) =
                 m−1                                                        m−1
θFλ (t1+q+···+q       ). Hence it suffices to show that α̌((−1)1+q+···+q        ) = 1 for
                              1+q+···+q m−1
any α ∈ R or that (−1)                         = 1 (in k ). Since (−1) = −1 (in k∗ ), it
                                                          ∗           q
                                m
suffices to show that (−1) = 1. This follows from our assumption on m and m0 .
    Similarly, we see that if m ∈ m0 Z, m ≥ 1 then aDλ′ ,F m ,s′ = 1.
    We show that, if λ̃ ∈ sn , w ∈ W and m ∈ m0 Z, m ≥ 1, then θFλ̃ m (d−1 td,w d) = 1.
                                                                           m−1
Since λ̃ ∈ sq−1 , we have θFλ̃ m (d−1 td,w d) = θFλ̃ (d−1 td,w d)1+q+···+q     . Hence it
                                    m−1
                        1+q+···+q
suffices to show that td,w         = 1. Since tqd,w = td,w , it suffices to show that
tm
 d,w = 1. This follows from our assumption on m0 , m.
   We replace Fq in 35.1 by Fq m0 which we rename as Fq . The results above can
be reformulated as follows.
   (a) If m ∈ Z, m ≥ 1, then aDλ,F m ,s = 1, aDλ′ ,F m ,s′ = 1.
   (b) If λ̃ ∈ sn , w ∈ W and m ∈ Z, m ≥ 1 then θFλ̃ m (d−1 td,w d) = 1.
58                                                G. LUSZTIG

Proposition 35.15. Let a = aD : Hn −  → Hn be as in 34.15. Define Φ′′ : Hn −→
                    ′
             J    s      s̃                                 0
Hn by h 7→ Θn (CDλ′ a(h)Cλ−1 ) (an A-linear map) and let µ(G ) be as in 32.22.
If m ∈ Z, m ≥ 1, then
                             X
             Em =                            χK̄,ω̄(m) (Q, Q′ , gUQ )χK̄ ′ ,ω̄′ (m) (Q, Q′ , gUQ )
                                    F    m
                      (Q,Q′ ,gUQ )∈ZJ,D

                                                            0
is obtained by substituting v 2 = q m in v 2l(wJ ) µ(G0 )tr(Φ′′ , Hn ), which is a polyno-
mial in N[v 2 ].
     By the arguments in 35.11-35.13 applied with F m instead of F we see that
                                 m       m
                                                                                       √ m
                                                                                        q
                 Em = |G0F ||UJ,B
                              F
                                  ∗|
                                     −1
                                        aDλ,F m ,s a−1               ′
                                                    Dλ′ ,F m ,s′ tr(Xm , Hq m −1 )

                                                                                               √
              ′                                     ′
                                                    ′                                              qm
where        Xm (h)      =       ΘJqm −1,q m (CDλ
                                               s          s̃
                                                 ′ ξm (h)C −1 )
                                                          λ                for   h     ∈     Hq m −1    and
         √              √
 ′         qm             qm
ξm :   Hq m −1   −
                 →    Hq m −1   is the linear map given by

                                Tw 1λ̃ 7→ θFλ̃ m (d−1 td,w d)−1 TǫD (w) 1Dλ̃

                                         ′
for w ∈ W, λ̃ ∈ sq m −1 . Clearly, Xm      (Tw 1λ̃ ) = 0 unless λ̃ ∈ sn and, if this condition
                      ′
is satisfied, then Xm   (Tw 1λ̃ ) is a linear combination of elements of the form Tw′ 1λ̃′
with λ̃′ ∈ sn . It follows that
                                                 √ m                   √
                                      ′           q                        m
                                  tr(Xm , Hq m−1 ) = tr(Φ′′m , Hn q )
                                                                      √ m            √ m
                                     ′                                 q              q
where Φ′′m (h) = ΘJn,q m (CDλ
                           s    ′′    s̃         ′′
                             ′ ξm (h)C −1 ) and ξm : Hn
                                      λ                 −
                                                        → Hn     is the restriction
    ′
of ξm . We now use 35.14(a),(b). The proposition follows, except for the assertion
”which is a polynomial in N[v 2 ]”. That assertion follows from 32.22(a) and the
second equality in 32.23(a).
35.16. We now assume that J = I. Let In be a set of representatives for the
isomorphism classes of character sheaves contained in D̂L for some L ∈ sn . Then
In is finite and we can find an integer m1 ≥ 1 such that F m1 ∗ A ∼
                                                                  = A for any A ∈ In .
We replace Fq in 35.14 by Fq m1 which we rename as Fq . We now have F ∗ A ∼      =A
for any A ∈ In . For A ∈ In , the Verdier dual D(A) is isomorphic to an object
                                                                                ∼
in In . (See 28.18(a).) For each A ∈ In we choose isomorphisms κA : F ∗ A −→ A,
                ∼
κ′A : F ∗ D(A) −→ D(A) so that the following holds: if O is an open dense F -stable
subset of supp(A) = supp(D(A)) on which H−e (A), H−e (D(A)) are local systems
(e = dim O) then for any y ∈ O and any m ≥ 1 such that F m (y) = y,
       √               (m)
   (i) q m(e−dim D) κA : H−e (A)y −   → H−e (A)y is of finite order;
        √ m(e−dim D) ′ (m)
   (ii) q             κA     : H−e (D(A))y −→ H−e (D(A))y is of finite order;
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                                  59

                                                               ∼                                              ∼
    (iii) the isomorphism H−e D(A)F (y) −→ H−e D(A)y (that is, H−e (A)ˇF (y) −→
H−e (A)ˇy ) induced by κ′A is q dim D−e times the transpose inverse of the isomorphism
                 ∼
H−e (A)F (y) −→ H−e (A)y induced by κA .
    Note that κ′A is uniquely determined by κA and that (ii) follows from (i) and
(iii).
    Let L, L′ , s, s′ , K̄, K̄ ′ , ω̄, ω̄ ′ be as in 35.11. Since K̄, K̄ ′ are semisimple, we have
canonically (for i, i′ ∈ Z):
                                   p
(a)                                    H i (K̄) = ⊕A∈In (A ⊗ VA,i,s,L ),

                                   ′
(b)                         p
                                H i (K̄ ′ ) = ⊕A′ ∈In (D(A′ ) ⊗ VA′ ′ ,i′ ,s′ ,L′ )

where VA,i,s,L , VA′ ′ ,i′ ,s′ ,L′ are finite dimensional Q̄l -vector spaces endowed with
endomorphisms
                                      ′      ′
   ψA : VA,i,s,L −
                 → VA,i,s,L , ψA                            → VA′ ′ ,i′ ,s′ ,L′
                                        ′ : VA′ ,i′ ,s′ ,L′ −

such that under (a) (resp. (b)) the map ⊕A (κA ⊗ ψA ) (resp. ⊕A′ (κ′A′ ⊗ ψA              ′
                                                                                           ′ ))
                                             ∗ p i            ∼ p i             ∗ p i′
                                                                                       ′    ∼
corresponds to the isomorphism F ( H (K̄)) −→ H (K̄) (resp. F ( H (K̄ )) −→
    ′
 H (K̄ ′ )) induced by ω̄ (resp. ω̄ ′ ).
p i

   In the remainder of this section we assume that D is clean (see 33.4(b)).
Proposition 35.18. (a) With each A ∈ In one can associate sgnA ∈ {1, −1}
                                                                  s,L
with the following property: if A is a direct summand of p H i (K̄D   ) where s, L are
                         i+dim G
as in 35.11, then (−1)           = sgnA .
   (b) With each A ∈ In one can attach an element ξA ∈ Q̄∗l such that the following
hold: ξA is an algebraic number all of whose complex conjugates have absolute value
                                                                  √
1; for any s, L as in 35.11 and any i ∈ Z, ψA is equal to ξA q i−dim G times a
unipotent automorphism of VA,i,s,L ; for any s′ , L′ as in 35.11 and any i ∈ Z, ψA   ′
                √
             −1
is equal to ξA    q i−dim G times a unipotent automorphism of VA,i,s
                                                                  ′
                                                                       ′ ,L′ .


   From the definitions we we see that, in the setup of 35.16, we have
                                        X
             tr(ω̄, Hgj (p H i (K̄))) =   tr(κA , Hgj A)tr(ψA , VA,i,s,L ),
                                                       A∈In

                    ′        ′                   X                     ′
         tr(ω̄ ′ , Hgj (p H i (K̄ ′ ))) =                 tr(κ′A′ , Hgj D(A′ ))tr(ψA
                                                                                   ′      ′
                                                                                     ′ , VA′ ,i′ ,s′ ,L′ ),

                                               A′ ∈In

for all g ∈ DF and all i, j, i′ , j ′ . Taking alternating sums over i, j or i′ , j ′ and using
                                        X
                    χK̄,ω̄ (g) =          (−1)i+j tr(ω̄, Hgj (p H i (K̄))),
                                               i,j

                                           X               ′   ′           ′       ′
                        χK̄ ′ ,ω̄′ (g) =             (−1)i +j tr(ω̄ ′ , Hgj (p H i (K̄ ′ ))),
                                           i′ ,j ′
60                                                      G. LUSZTIG

we obtain
                                       X                 X
                    χK̄,ω̄ (g) =            χA,κA (g)     (−1)i tr(ψA , VA,i,s,L ),
                                   A∈In                     i
                                        X                          X     ′
                                                                              ′      ′
(c)                 χK̄ ′ ,ω̄′ (g) =            χD(A′ ),κ′ ′ (g)    (−1)i tr(ψA ′ , VA′ ,i′ ,s′ ,L′ ).
                                                            A
                                       A′ ∈In                       i′

                                                                                                         ′
Since K̄ (resp. K̄ ′ ) is pure of weight 0, we see that p H i (K̄) (resp. p H i (K̄ ′ )) is
pure of weight i (resp. i′ ). By our choice of κA (resp. κ′A ) we see that (A, κA ) and
(D(A), κ′A ) are pure of weight dim G for A ∈ In . Using 35.16(a),(b), we deduce
that
                                                          ′              ′
    (d) (VA,i,s,L , ψA ) is pure of weight i−dim G and (VA,i′ ,s′ ,L′ , ψA ) is pure of weight

i′ − dim G.
Using (c) we have
             X                                 X          X
   |G0F |−1         χK̄,ω̄ (g)χK̄ ′ ,ω̄′ (g) =   |G0F |−1         χA,κA (g)χD(A′ ),κ′ ′ (g)
                                                                                                             A
                   g∈DF                                 A,A′ ∈In               g∈DF
(e)
          X               ′
                                              ′      ′
      ×          (−1)i+i tr(ψA , VA,i,s,L)tr(ψA ′ , VA′ ,i′ ,s′ ,L′ ).

          i,i′

Using 24.18 (which is applicable by our cleanness assumption and by Corollary
31.15) we see that for any A, A′ ∈ In we have
                            X
                   |G0F |−1      χA,κA (g)χD(A′ ),κ′ ′ (g) = δA,A′ .
                                                                           A
                                           g∈DF

Hence (e) becomes
          X                              X        ′
 |G0F |−1     χK̄,ω̄ (g)χK̄ ′ ,ω̄′ (g) =                                ′
                                           (−1)i+i tr(ψA , VA,i,s,L)tr(ψA    ′
                                                                          , VA,i′ ,s′ ,L′ ).

                  g∈DF                                  A∈In
                                                         i,i′

This remains true if F is replaced by F m , where m ≥ 1. Thus we have
               m      X
          |G0F |−1          χK̄,ω̄(m) (g)χK̄ ′ ,ω̄′(m) (g)
                                 g∈DF m
                        X              X            X
                                                                                 ′ m    ′
(f)                 =         (−1)j                             m
                                                            tr(ψA , VA,i,s,L)tr(ψA   , VA,i′ ,s′ ,L′ )

                         j             A∈In i,i′ ;i+i′ =j


with ω̄ (m) , ω̄ ′(m) as in 35.14. Using 35.15, we may rewrite the previous equality as
follows:                         X        X
                                    (−1)j     am         m
                                                j,f = Π(q )
                                                j            f
                  CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                      61

                                                 ′                               ′
where aj,f are the eigenvalues of ψA ⊗ ψA          on ⊕i,i′ ;i+i′ =j VA,i,s,L ⊗ VA,i′ ,s′ ,L′ and Π

is a polynomial with coefficients in N. By (d), each aj,f is an algebraic number all
of whose complex conjugates have absolute value squared equal to q j−2 dim G . It
follows that, for fixed j, the set {aj,f } is empty if j is odd and that each aj,f is equal
                                                                                         ′
to q j/2−dim G if j is even. This implies that, for any A ∈ In , VA,i,s,L ⊗ VA,i            ′ ,s′ ,L′ is
           ′                    ′
0 if i + i is odd and, if i + i is even, any eigenvalue of ψA on VA,i,s,L multiplied
                           ′       ′                    (i+i′ )/2−dim G
by any eigenvalue of ψA      on VA,i  ′ ,s′ ,L′ gives q                 . Since for A ∈ In we
         ′                          ′     ′
have VA,i′ ,s′ ,L′ 6= 0 for some s , L as in 35.11, we see that the parity of i such
that VA,i,s,L 6= 0 for some s, L as in 35.11 is an invariant of A and that, for any
                                                       √
eigenvalue ξ of ψA on VA,i,s,L , the product ξ q dim G−i is also an invariant of A.
The proposition follows.
35.19. As in 34.15, let {Eu ; u ∈ U} be a set of representatives for the isomorphism
classes of simple modules for Hn1 . Let m ≥ 1. Using 35.18, we can rewrite 35.18(f)
as follows:
          m      X
     |G0F |−1         χK̄,ω̄(m) (g)χK̄ ′ ,ω̄′(m) (g)
                              m
                      g∈DF
(a)
           X X                    ′                                                     ′
                                                    ′              m(i−dim G)/2 m(i −dim G)/2
      =                   (−1)i+i dim VA,i,s,L dim VA,i′ ,s′ ,L′ q             q              .
          A∈In i,i′

By 35.15 (with J = I), the left hand side of (a) is tr(Φ′′ , Hn )|v=√q m . We have
       X X                                  X        ′
           ( (−v)i v − dim G dim VA,i,s,L )( (−v)i v − dim G dim VA,i  ′
                                                                          ′ ,s′ ,L′ )

          A∈In       i                                              i′
                                      X          ′
                                                                  −1 s̃
          = tr(Φ′′ , Hn ) =                   s
                                          tr(CDλ         v
                                                ′ T̃D , Eu )tr(T̃
                                                                           v
                                                                 D Cλ−1 , Eu )
                                  u∈U a
              X               ′
                             s          v       s̃   ♭       v ♠
          =              tr(CDλ′ T̃D , Eu )tr((Cλ−1 ) T̃D , Eu )

              u∈U a
              X               ′
                             s          v      s           v ♠
(b)       =              tr(CDλ′ T̃D , Eu )tr(CDλ−1 T̃D , Eu ) .

              u∈U a

(The first equality in (b) comes from the fact that (a) holds for any integer m ≥ 1.
Here tr(Φ′′ , Hn ), as in 35.15 with J = I, can be replaced by a sum of products
of traces, see 34.14(a). This gives the second equality in (b) where the notation
                                                                             −1 s̃
of 34.15 is used. The third equality in (b) comes from 34.17 since T̃D         Cλ−1 is
                                                                       D
an A-linear combination of elements of the form T̃w 1λ−1 , w ∈ W . The fourth
equality in (b) follows from the definitions using sr . . . s2 s1 λ−1 = Dλ−1 .) Using
the definitions and 34.19(a),(c), we obtain for A ∈ In :
          X                                   X
              (−v)i v − dim G dim VA,i,s,L = ( (−v)i v − dim G dim VA,i,s,L )♠
              i                                                 i
                                              X
(b)           = (ζ   A     s
                         (CDλ [D]))♠      =           (bvA,u )♠ tr(CDλ
                                                                    s
                                                                       T̃D , Euv )♠ ,
                                              u∈U a
62                                                    G. LUSZTIG
              X                ′                                                ′
                      (−v)i v − dim G dim VA,i
                                           ′
                                              ′ ,s′ ,L′ = ζ
                                                            D(A)   s
                                                                 (CDλ′ [D])

                i′
                      X                         ′                     X                   ′
(c)            =               bvD(A),u′ tr(CDλ
                                             s          v
                                               ′ T̃D , Eu′ ) =                bvA,u′ tr(CDλ
                                                                                         s             v
                                                                                           ′ −1 T̃D , Eu′ ).

                     u′ ∈U a                                        u′ ∈U a


Introducing (b),(c) in (a) we obtain
               X           X                   ′                      X
                       (           bvA,u′ tr(CDλ
                                              s             v
                                                ′ −1 T̃D , Eu′ ))(           (bvA,u )♠ tr(CDλ
                                                                                           s
                                                                                              T̃D , Euv )♠ )
             A∈In u′ ∈U a                                            u∈U a
                     X               ′
                                 s          v      s           v ♠
              =              tr(CDλ′ T̃D , Eu )tr(CDλ−1 T̃D , Eu ) ,

                     u∈U a


that is,
             X             X                                         ′
(d)                    (           bvA,u′ (bvA,u )♠ − δu,u′ )tr(CDλ
                                                                 s             v       s         v ♠
                                                                   ′ −1 T̃D , Eu′ )tr(CDλ T̃D , Eu ) = 0.
         u,u′ ∈U a A∈In


Recall that here s is assumed to satisfy s1 s2 . . . sr Dλ = λ. The A-submodule
of HnD spanned by the elements CDλ  s
                                       T̃D with s as above (and λ fixed) is just
                                             s
1λ Hn T̃uD 1λ hence in (d) we may replace CDλ  T̃D by any element in 1λ Hn T̃uD 1λ
                                                            s′
and the equality remains true. Similarly, we may replace CDλ   ′ −1 T̃D by any element

in 1λ′ −1 Hn T̃D 1λ′ −1 and the equality remains true. Thus we have
(e) X X
           (      bvA,u′ (bvA,u )♠ − δu,u′ )tr(T̃x′ 1Dλ′ −1 T̃D , Euv′ )tr(T̃x 1Dλ T̃D , Euv )♠ ) = 0
  u,u′ ∈U a A∈In


for any x, x′ ∈ W such that
   (f) xDλ = λ, x′ Dλ′−1 = λ′−1 .
Now (e) remains true even if (f) does not hold. (If for example, xDλ = λ1 6= λ
then for any u ∈ U a we have

            tr(T̃x 1Dλ T̃D , Euv ) = tr(1λ1 T̃x 1Dλ T̃D , Euv ) = tr(T̃x T̃D 1λ 1λ1 , Euv ) = 0,

hence the left hand side of (e) is zero.) We now multiply both sides of (e) by
    tr(T̃x′ 1Dλ′ −1 T̃D , Euv′ )♠ tr(T̃x 1Dλ T̃D , Euv1 )
                             1
where u1 , u′1 ∈ U a and sum the resulting equalities over all x, x′ ∈ W and λ, λ′ ∈
sn . We obtain
        X            X                                     X
                (            bvA,u′ (bvA,u )♠ − δu,u′ )(         tr(T̃x 1Dλ T̃D , Euv1 )tr(T̃x 1Dλ T̃D , Euv )♠ ))
      u,u′ ∈U a A∈In                                       x,λ
           X
      ×(            tr(T̃x′ 1Dλ′ −1 T̃D , Euv′ )tr(T̃x′ 1Dλ′ −1 T̃D , Euv′1 )♠ ) = 0.
           x′ ,λ′
                CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                          63

Using 34.18(a) we deduce
      X X
           (     bvA,u′ (bvA,u )♠ − δu,u′ )δu′ ,u′1 fuv′1 dim Eu′1 δu,u1 fuv1 dim Eu1 = 0,
      u,u′ ∈U a A∈In

that is,            X
                (          bvA,u′1 (bvA,u1 )♠ − δu1 ,u′1 )fuv′1 dim Eu′1 fuv1 dim Eu1 = 0.
                    A∈In

Since fuv′ dim Eu′1 fuv1 dim Eu1 6= 0, we deduce
           1

                                       X
(g)                                          bvA,u′1 (bvA,u1 )♠ = δu1 ,u′1
                                      A∈In

for any u1 , u′1 ∈ U a .
35.20. Let A0 ∈ In . Then supp(A0 ) is the closure of a stratum Y = YL,S of
D. Let e = dim Y . Replacing Fq by a finite extension, we may assume that the
following holds:
                                                                               m
   (a) there exists a finite group Γ and a sequence of maps Γ −         → Y F , γ 7→ yγ,m
(m = 1, 2, 3, . . . ) such that for any m ≥ 1 and any A ∈ In we have
                               X
         q −(dim D−e)m |Γ|−1        χA,κ(m) (yγ,m )χD(A0 ),κ′A (m) (yγ,m ) = δA0 ,A′ .
                                                A                        0
                                      γ∈Γ

(We apply 33.7 with I = In .)
35.21. We identify Hn with a subalgebra of Hq−1 by T̃w 1λ 7→ T̃w 1λ for w ∈ W,
λ ∈ sn . (We have sn ⊂ sq−1 since n divides q − 1.) Similarly, for any κ ∈ U we
identify Hnκ with a subalgebra of Hq−1  κ
                                           .
   Let {Ẽu ; u ∈ Ũ} be a set of representatives for the isomorphism classes of simple
                 1
modules for Hq−1    . We may assume that U ⊂ Ũ, that for u ∈ U we have Ẽu = Eu
         1
as an Hn -module with 1λ acting as 0 for λ ∈ sq−1 − sn and for u ∈ Ũ − U, Hn1
                                                         √                   √
                                                             q                q
acts on Ẽu as zero. For u ∈ Ũ, the Hq−1 -module Ẽu                             is defined as in 34.15.
                                     √        √                  √
                                       q        q                    q
If u ∈ U we have again       =     Ẽu       Eu
                                    as an Hn -module
                                                 √
                                                      with 1λ acting as 0 for
                                                  q
λ ∈ sq−1 − sn . For u ∈ Ũ we set Vu = HomH q (Ẽu , P) where P is regarded
                                            √
                                                                 q−1
           √
            q
as an Hq−1 = T-module as in 35.4, 35.5. Since T = EndG0F (P) (see 35.5), the
G0F -module structure on P makes Vu into an irreducible G0F -module and we have
an isomorphism
                                 √                                                √
                                  q           ∼                                    q
                ϑ : ⊕u∈Ũ (Ẽu ⊗ Vu ) −→ P, e ⊗ x 7→ x(e), e ∈ Ẽu , x ∈ Vu .
                                                    √
                                                     q
Hence P = ⊕u∈Ũ Pu where Pu = ϑ(Ẽu ⊗ Vu ). For u ∈ U a and x ∈ Vu we define
           √
            q                          −1
Ru,x : Ẽu −
           → P by Ru,x (e) = ρd,d (x(T̃D  e)). We show that
64                                         G. LUSZTIG
                                                √          √
                                                    q       q
     (a) Ru,x (he) = hRu,x (e) for h ∈ Hq−1 , e ∈ Ẽu .
           √
            q
If h ∈ Hq−1 1λ with λ ∈ sq−1 − sn , w ∈ W then both sides of (a) are zero (we
                                                                √
                                                                    q
use 35.12(a)). Hence we may assume that h ∈ Hn . Recall that ρd,d (a−1 (h)) =
hρd,d : P −
          → P (see 35.12(a) and 35.14(b)). Hence
                      −1                              −1                          −1
Ru,x (he) = ρd,d (x(T̃D  (he))) = ρd,d (x((a−1 (h))(T̃D  e)) = ρd,d (a−1 (h))(x(T̃D  e))
                         −1
            = hρd,d (x(T̃D  e)) = hRu (x)(e),

as required. We see that Ru,x ∈ Vu . Thus, we have a map Ru : Vu −         → Vu ,
x 7→ Ru,x . From the definitions we have √
                                              q
   ϑ(T̃D e ⊗ Ru,x ) = ρd,d ϑ(e ⊗ x) for e ∈ Eu , x ∈ Vu .
In particular, ρd,d : P −
                        → P maps Pu into itself. On the other hand it maps Pu for
u ∈ U − U into Pu′ for some u′ ∈ U, u′ 6= u. It also maps ⊕u∈Ũ−U Pu into itself.
           a
                  √                                                               √
                   q                                                               q
Hence if h ∈ Hn and g0 ∈ G0F then hρd,d ρg0 ,1 acts as zero on ⊕u∈Ũ −U ϑ(Eu ⊗Vu )
and we have
                                                   √
                                                    q
                                      X
               tr(hρd,d ρg0 ,1 , P) =   tr(hT̃D , Eu )tr(Ru g0 , Vu ).
                                           u∈U a

                                                                 s
Now, from Lemma 35.10 (with J = I) we have χK̄,ω̄ (g) = tr(CDλ      ρg,d , P) for any
g ∈ DF . (Recall that aDλ,F,s = 1, see 35.14(a).) Hence
                                               √
                                                q
                              X
(b)              χK̄,ω̄ (g) =         s
                                 tr(CDλ T̃D , Eu )tr(Ru d−1 g, Vu).
                                   u∈U a

We have
                            X                  X √ √ − dim G
             χK̄,ω̄ (g) =          χA,κA (g)    (− q)i q     ξA dim VA,i,s,L
                            A∈In                i
                                                √                       √
                                                    q                    q
                  X                    X
                                                        s
(c)           =          χA,κA (g)ξA           bA,u tr(CDλ T̃D , Eu ).
                  A∈In                 u∈U a

(The first equality follows from 35.18(b),(c). The second equality is obtained from
thePidentity
            i − dim G
                      dim VA,i,s,L = u∈U a bvA,u tr(CDλ
                                                     s
                                                        T̃D , Euv ),
                                    P
     i (−v) v                             √
see 34.19, under the specialization v 7→ q. Note that the rational function bvA,u
                               √
does not have a pole at v = q; indeed, in 34.19(b), we have ζ A (T̃w 1Dλ [D]) ∈ A,
                                                                             √
                                                                              q
tr(T̃w 1Dλ T̃D , Euv )♠ ∈ U[v, v −1 ] by 34.15(a), while fuv |v=√q = fu 6= 0 by 34.15(b).
                                                                           √
                                               √                            q
Hence bvA,u can be specialized for v = q and yields a value bA,u ∈ U.) From
(b),(c) we deduce
                               √                                           √
                                 q                                           q
         X                                             X
               tr(CDλ s
                        T̃D , Eu )(tr(Ru d−1 g, Vu ) −        χA,κA (g)ξA bA,u ) = 0.
          u∈U a                                            A∈In
                 CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                              65

                                                                             s
As in the paragraph preceding 35.19(e) we see that here we may replace CDλ     T̃D
by any element in 1λ Hn T̃D 1λ . Thus we have
                             √                                     √
                              q                                     q
       X                                            X
(d)        tr(T̃x 1Dλ T̃D , Eu )(tr(Ru d−1 g, Vu) −   χA,κA (g)ξA bA,u ) = 0
       u∈U a                                                 A∈In

for any x ∈ √ W such that xDλ = λ; moreover, if xDλ 6= λ then
                   q
tr(T̃x 1Dλ T̃D , Eu ) = 0 so that (d) holds again. We see that (d) holds for√any x ∈
                                                                                        q
W and any λ ∈ sn . We now multiply both sides of (d) by tr(T̃x 1Dλ T̃D , Eu1 )♠ = 0
where u1 ∈ U a and sum the resulting equalities over all x ∈ W and λ ∈ sn . We
obtain
                                          √                    √
                                           q                     q
                X X
                    (   tr(T̃x 1Dλ T̃D , Eu )tr(T̃x 1Dλ T̃D , Eu1 )♠ )
                      u∈U a x,λ
                                                                    √
                                                                     q
                                               X
                      × (tr(Ru d−1 g, Vu) −           χA,κA (g)ξA bA,u ) = 0.
                                               A∈In
                        √     √
Using 34.18(b) with κ = q = q ♠ we deduce that
                   √                                            √
                    q                                            q
        X                                        X
            δu,u1 fu dim Eu (tr(Ru d−1 g, Vu ) −   χA,κA (g)ξA bA,u ) = 0
           u∈U a                                           A∈In

that is,
                 √                                                          √
                  q                                                             q
                                                       X
                fu1 dim Eu1 (tr(Ru1 d−1 g, Vu1 ) −           χA,κA (g)ξA bA,u1 ) = 0.
                                                      A∈In
           √
            q
Since fu1 dim Eu1 6= 0, we deduce
                                                                    √
                                                                        q
                                               X
(e)                    tr(Ru1 d−1 g, Vu1 ) =          χA,κA (g)ξA bA,u1 = 0.
                                               A∈In

We show:
   (f) Ru d−1 g : Vu −
                     → Vu has finite order.
                                                   −t
For any t ≥ 1 we have Rut (x) = ρtd,d (x(T̃D          e)), hence Ruc = 1 for some c ≥ 1. For
g0 ∈ G0F we have
                                   −1                           −1
   Ru g0 (x)(e) = ρd,d ρg0 ,1 x(T̃D    e) = ρdg0 d−1 ,1 ρd,d xT̃D  e
hence Ru g0 = (dg0 d−1 )Ru . From this we deduce
   (Ru g0 )t = (dg0 d−1 )(d2 g0 d−2 ) . . . (dt g0 d−t )Rut
for t ≥ 1. We have da = 1 for some a ≥ 1. Let
   g1 = (dg0 d−1 )(d2 g0 d−2 ) . . . (da g0 d−a ).
We have g1b = 1 for some b ≥ 1. We have (Ru g0 )ab = g1b Ruab = Ruab . Thus
(Ru g0 )abc = Ruabc = 1. Taking g0 = d−1 g we see that (f) holds.
   From (f) we see that tr(Ru d−1 g, Vu ) is a cyclotomic integer. Introducing this
in (e) we see that             √
                                 q
   (g) A∈In χA,κA (g)ξA bA,u is a cyclotomic integer for any u ∈ U a , g ∈ DF .
        P
66                                             G. LUSZTIG

Lemma 35.22. In the setup of 35.20, let u ∈ U a . Assume that Eu is quasi-
rational (see 34.20). Then bvA0 ,u ∈ ηQ[v, v −1 ] where η is a root of 1.
     Note that 35.21(g) remains true if Fq is replaced by Fq m where m ≥ 1. Thus:
                                                                √ m
                                                                 q
                                     X
                                                           m
(a)                                            χA,κ(m) (g)ξA bA,u
                                                     A
                                     A∈In

                                                                  m
is a cyclotomic integer for any m ≥ 1, g ∈ DF . We use notation of 35.20.
                                             √
Assume that g ∈ Y Fm . We multiply (a) by q m(e−dim D) χD(A0 ),κ′A (m) (g) which
                                                                   0
is a cyclotomic integer by 35.16(ii). We obtain again a cyclotomic integer. Now
take g = yγ,m (see 35.20) and sum over all γ ∈ Γ (see 35.20). We see that

          √                                                                                  √ m
                  m(e−dim D)                                                                  q
                               X X
                                                                                           m
(b)           q                             χA,κ(m) (yγ,m )χD(A0 ),κ′A       (m)   (yγ,m )ξA bA,u
                                                 A                       0
                               γ∈Γ A∈In


is a cyclotomic integer for any m ≥ 1. Using 35.20(a) we see that (b) equals
                                    √                            √ m
                                            m(dim D−e)       m    q
(c)                                     q                |Γ|ξA  b
                                                               0 A0 ,u



which is therefore a cyclotomic integer for any m ≥ 1. By 35.22 we have bvA0 ,u =
ηQ(v) where η ∈ U is a root of 1 and Q(v) ∈ Q(v). Let K be a subfield of Q̄l such
that K is a finite Galois extension of Q of degree a which contains η and ξA0 . Let
N :K−   → Q be the norm map. Since all complex conjugates of ξA0 have absolute
value 1 we see that N (ξA0 ) = ±1. We have also N (η) = ±1. Hence applying N to
                                          ′              ′
(c) (with m = 2m′ ) we see that |Γ|a q am (dim D−e) Q(q m )a is a cyclotomic integer.
This being also a rational number, is an ordinary integer. Let
   R(v) = |Γ|a v a(dim D−e) Q(v)a ∈ Q(v).
                     ′
We see that R(q m ) ∈ Z for any integer m′ ≥ 1. This forces R(v) ∈ Q[v].
Thus, (v dim D−e Q(v))a ∈ Q[v]. It follows that v dim D−e Q(v) ∈ Q[v] hence Q(v) ∈
Q[v, v −1 ]. The lemma is proved.
Theorem 35.23. Assume that D is clean (see 33.4(b)). Let A ∈ In . Let u ∈ U a
be such that Eu is quasi-rational (see 34.20). Then bvA,u ∈ ηQ for some η, a root
of 1.
   Using 35.19(g) with u1 = u′1 = u we see that A∈In bvA,u (bvA,u )♠ = 1. Using
                                                   P

35.22 we write bvA,u = ηA QA for A ∈ In where ηA is a root of 1 and QA ∈ Q[v, v −1 ].
                   −1
Then (bvA,u )♠ = ηA   QA so that A∈In Q2A = 1. Since QA ∈ Q[v, v −1 ], this forces
                                 P
each QA to be a constant. The theorem is proved.

                                              References
[BBD] A.Beilinson, J.Bernstein and P.Deligne, Faisceaux pervers, Astérisque 100 (1982).
               CHARACTER SHEAVES ON DISCONNECTED GROUPS, VII                                  67

[Gi]    V.Ginzburg, Admissible modules on a symmetric space, in: ”Orbites unipotentes et
        représentations,III”, Astérisque 173-174 (1989), 199-255.
[KL]    D.Kazhdan and G.Lusztig, Representations of Coxeter groups and Hecke algebras, Inv.
        Math. 53 (1979), 165-184.
[L3]    G.Lusztig, Character sheaves,I, Adv.Math. 56 (1985), 193-237; II 57 (1985), 226-265; III
        57 (1985), 266-315; IV 59 (1986), 1-63; V 61 (1986), 103-155.
[L9]    G.Lusztig, Character sheaves on disconnected groups,I, Represent.Th. (electronic) 7
        (2003), 374-403; II 8 (2004), 72-124; III 8 (2004), 125-144; IV 8 (2004), 145-178; Errata
        8 (2004), 179-179; V 8 (2004), 346-376; VI 8 (2004), 377-413.
[L13]   G.Lusztig, Quantum groups at v =infinity, Functional analysis on the eve of the 21st
        century: in honor of I.M.Gelfand, vol.I, Progr.in Math. 131, Birkhäuser, 1995, pp. 199-
        221.
[L12]   G.Lusztig, Hecke algebras with unequal parameters, CRM Monographs Ser. 18 (2003),
        Amer.Math.Soc..
[MS]    J.G.M.Mars and T.A.Springer, Character sheaves, Astérisque 173-174 (1989), 111-198.
[Y]     T.Yokonuma, Sur la structure des anneaux de Hecke d’un groupe de Chevalley fini, C.R.
        Acad. Sci. Paris Ser.A-B 264 (1967), A344-A347.

   Department of Mathematics, M.I.T., Cambridge, MA 02139
