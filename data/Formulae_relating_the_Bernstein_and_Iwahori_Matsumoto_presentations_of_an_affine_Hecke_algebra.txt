                                                      Formulae relating the Bernstein and Iwahori-Matsumoto
                                                             presentations of an affine Hecke algebra
                                                                               Thomas J. Haines, Alexandra Pettet
arXiv:math/0201176v1 [math.RT] 18 Jan 2002




                                                                                                    Abstract
                                                      We consider the “antidominant” variants Θ−    λ of the elements Θλ occurring in the Bernstein presenta-
                                                  tion of an affine Hecke algebra H. We find explicit formulae for Θ−    λ in terms of the Iwahori-Matsumoto
                                                  generators Tw (w ranging over the extended affine Weyl group of the root system R), in the case (i) R
                                                  is arbitrary and λ is a minuscule coweight, or (ii) R is attached to GLn and λ = mek , where ek is a
                                                  standard basis vector and m ≥ 1.
                                                      In the above cases, certain minimal expressions for Θ−   λ play a crucial role. Such minimal expressions
                                                  exist in fact for any coweight λ for GLn . We give a sheaf-theoretic interpretation of the existence of a
                                                  minimal expression for Θ−  λ : the corresponding perverse sheaf on the affine Schubert variety X(tλ ) is the
                                                  push-forward of an explicit perverse sheaf on the Demazure resolution m : X̃(tλ ) → X(tλ ). This approach
                                                  yields, for a minuscule coweight λ of any R, or for an arbitrary coweight λ of GLn , a conceptual albeit
                                                                                                λ (w) of the basis element Tw , in terms of the cohomology of
                                                  less explicit expression for the coefficient Θ−
                                                  a fiber of the Demazure resolution.
                                                      AMS Subject classification: 20C08, 14M15.


                                             1    Introduction
                                             Let H be the affine Hecke algebra associated to a root system. There are two well-known presentations
                                             of this algebra by generators and relations, the first discovered by Iwahori-Matsumoto [7] and the second
                                             by Bernstein [12], [14]; cf. 2.2.1 below. The Iwahori-Matsumoto presentation reflects the structure of the
                                             Iwahori-Hecke algebra Cc∞ (I\G/I) of the split p-adic group G attached to the root system: the generators
                                             Tw correspond to the characteristic functions of Iwahori double cosets IwI, where w ranges over the extended
                                             affine Weyl group. The Bernstein presentation reflects the description of the Hecke algebra as an equivariant
                                             K-theory of the associated Steinberg variety, which plays a role in the classification of the representations of
                                             H, see [9], [2]. The Bernstein presentation has the advantage that one can construct a basis for the center
                                             of H by summing the generators Θλ over Weyl-orbits of coweights λ; the resulting functions are known as
                                             Bernstein functions.
                                                 It is of interest to give an explicit relation between the generators in these two presentations. More
                                             precisely, one would like to write each Θλ as an explicit linear combination of the Iwahori-Matsumoto basis
                                             elements Tw . A direct consequence would be the explicit description of the Bernstein functions (and thus
                                             the center of H) in terms of the Iwahori-Matsumoto basis. This problem was considered earlier by the first
                                             author [4],[5] because of certain applications to the study of Shimura varieties, and was completely answered
                                             there for the case where λ is a minuscule coweight. More recently, O. Schiffmann [16] has given explicit
                                             formulae for all elements in a certain basis for the center Z(H) of an affine Hecke algebra H of type A; from
                                             this one can derive a formula for the Bernstein function zµ , where µ is any dominant coweight of a group of
                                             type A.
                                                 In this paper we consider the “antidominant” variants Θ−     λ of the elements Θλ . The support of these
                                             functions is somewhat more regular than the original functions Θλ , cf. Lemma 2.1. In section 3 we consider
                                             the case where λ is a minuscule coweight, and we prove the following explicit formula for Θ−    λ.

                                             Theorem 1.1 Let λ ∈ X∗ be minuscule. Then
                                                                                                  X
                                                                                       Θ−
                                                                                        λ =                  R̃x,tλ (Q)T̃x .
                                                                                              {x : λ(x)=λ}



                                                                                                       1
Here λ(x) is the translation part of x “on the left” defined by the decomposition x = tλ(x) w (w ∈ W0 ),
T̃x is a renormalization of the usual Iwahori-Matsumoto generator Tx , Q = q −1/2 − q 1/2 , and R̃x,y (Q) is a
variant of the usual R-polynomial of Kazhdan-Lusztig [8].
     The formula above is analogous to the expression for Θλ found by the first author in Proposition 4.4 of
[5]:                                             X
                                        Θλ =            R̃x,tλ (Q)T̃x .
                                               {x : t(x)=λ}

Here t(x) is the translation part of x “on the right” defined by the decomposition x = wtt(x) (w ∈ W0 ).
However our proof is simpler and more direct than that of loc.cit., and the same arguments appearing here
also give a short proof of the formula for Θλ . In fact one can derive the formula for Θ−
                                                                                        λ from that for Θ−λ ,
and vice-versa. Indeed, if ι : H → H denotes the anti-involution determined by q 1/2 7→ q 1/2 and Tx 7→ Tx−1 ,
then ι(Θ−λ ) = Θ−                                                    −
                  λ and ι interchanges the formulae for Θ−λ and Θλ . We remark that Theorem 1.1 remains
valid for Hecke algebras with arbitrary parameters.
    In the fourth section we study coweights of GLn of the form λ = mek , where ek is the k-th standard basis
vector and m ∈ Z+ . The case m = 1, studied in [4] and [5], has relevance to a certain family of Shimura
varieties with bad reduction, known as the Drinfeld case. The general case is referred to as multiples of the
Drinfeld case. We prove the following formula for Θ−  mek .

Theorem 1.2 Let 1 ≤ k ≤ n and m ≥ 1. Then
                                                   X
                                     Θ−
                                      mek =                     R̃x,tmek (Q)T̃x .
                                              {x : λ(x)mek }

Here  denotes the usual partial order on the lattice X∗ .
    Theorems 1.1 and 1.2 yield explicit expressions for the Bernstein functions zµ (µ minuscule) and zme1 ,
respectively; see Corollary 3.6 and 4.2. The expressions in these special cases seem much simpler than the
corresponding ones given by Schiffmann [16].
    Theorems 1.1 and 1.2 rely on the existence of certain minimal expressions for Θ−λ : these are expressions
of the form
                                                    ǫ1         ǫr
                                            Θ−λ = T̃t1 · · · T̃tr T̃τ ,

where tλ = t1 · · · tr τ (ti ∈ Sa , τ ∈ Ω) is a reduced expression and ǫi ∈ {1, −1} for every 1 ≤ i ≤ r. In
the final two sections, we discuss how one can approach a general formula for Θ−     λ when λ is an arbitrary
coweight of GLn , through minimal expressions (which always exist in this setting, cf. section 5). The result
is much less explicit than Theorems 1.1 and 1.2, and involves the geometry of the Demazure resolution
 e λ ) → X(tλ ) of the affine Schubert variety X(tλ ). We define a perverse sheaf Ξ− on the affine flag variety
X(t                                                                                 λ
whose corresponding function in the Hecke algebra is ελ Θ−                           −
                                                             λ . It turns out that Ξλ is supported on X(tλ ).
                                                          −
We see that the existence of a minimal expression for Θλ is analogous to the existence of a certain explicitly
determined perverse sheaf on X(t   e λ ) whose push-forward to X(tλ ) is Ξ− . More precisely, we conclude the
                                                                          λ
paper with the following result (cf. Theorem 6.7, Corollary 6.8 for a completely precise statement).

Theorem 1.3 Let λ be a minuscule coweight of a root system, or any coweight for GLn . Choose a minimal
expression for Θ−                 e
                 λ and let m : X(tλ ) → X(tλ ) denote the corresponding Demazure resolution for X(tλ ).
                                                  e λ ) (determined by the choice of minimal expression for
Then there exists an explicit perverse sheaf D on X(t
Θ−λ ) such that
                                               Rm∗ (D) = Ξ−λ.

Consequently, if we denote the coefficient of Tx in the expression for Θ−     −
                                                                        λ by Θλ (x), then we have

                                    Θ−                    •
                                     λ (x) = ελ Tr(Frq , H (m
                                                              −1
                                                                 (x), D)),

for any x ≤ tλ in the Bruhat order. Here the right hand side denotes the alternating trace of Frobenius on
the étale cohomology of the fiber over x ∈ X(tλ ) with coefficients in the sheaf D.

  Given a coweight λ for an arbitrary root system, let λd denote the dominant coweight in its Weyl-orbit.
We remark that there is a similar formula for Θ−
                                               λ , provided that λd is a sum of minuscule dominant coweights.


                                                        2
2       Preliminaries
2.1     Affine Weyl group
Let (X ∗ , X∗ , R, Ř, Π) be a root system, where Π is the set of simple roots. The Weyl group W0 is generated
by the set of simple reflections {sα : α ∈ Π}.
    We define a partial order  on X∗ (resp. X ∗ ) by setting λ  µ whenever µ − λ is a linear combination
with nonnegative integer coefficients of elements of {α̌ : α ∈ Π} (resp. {α : α ∈ Π}). We let Πm denote the
set of roots β ∈ R such that β is a minimal element of R ⊂ X ∗ with respect to .
    In section 4 we will use the following description of the relation  for coweights of GLn : (λ1 , . . . , λn ) 
(µ1 , . . . µn ) if and only if λ1 + · · · + λi ≤ µ1 + · · · + µi for 1 ≤ i ≤ n − 1, and λ1 + · · · + λn = µ1 + · · · + µn .
    Let W   f be the semidirect product X∗ ⋊ W0 = {tx w : w ∈ W0 , x ∈ X∗ }, with multiplication given by
tx wtx′ w′ = tx+w(x′ ) ww′ . For any x ∈ W        f , there exists a unique expression tλ(x) w, where w ∈ W0 and
λ(x) ∈ X∗ .
    Let
                                       Sa = {sα : α ∈ Π} ∪ {t−α̌ sα : α ∈ Πm } ⊂ W   f.
                  f → Z by
Define length l : W
                                            X                                    X
                          l(tx w) =                       |hα, xi − 1| +                       |hα, xi|.
                                      α∈R+ :w −1 (α)∈R−                    α∈R+ :w −1 (α)∈R+

                                                                           f is a Coxeter group with Sa
Let Q̌ be the subgroup of X∗ generated by Ř. The subgroup Wa = Q̌ ⋊ W0 of W
                                                                                       f : l(w) = 0}.
the set of simple reflections. The subgroup is normal and admits a complement Ω = {w ∈ W
    For w ∈ Wf denote εw = (−1)l(w) and qw = q l(w) (for q any parameter).
    The Coxeter group (Wa , Sa ) comes equipped with the Bruhat order ≤. We extend it to W f as follows:
                ′ ′      ′          ′              ′          ′
we say wτ ≤ w τ (w, w ∈ Wa , τ, τ ∈ Ω) if w ≤ w and τ = τ .
    Let µ ∈ X∗ be dominant. Following Kottwitz-Rapoport [10], we say x ∈ W f is µ-admissible if x ≤ tw(µ)
for some w ∈ W0 . We denote the set of µ-admissible elements by Adm(µ).

2.2     Hecke algebra
2.2.1    Presentations
                   f is the group generated by Tw (w ∈ W
The braid group of W                                   f ) with relations

                                Tw Tw′ = Tww′         whenever l(ww′ ) = l(w) + l(w′ ).

The Hecke algebra H is defined to be the quotient of the group algebra (over Z[q 1/2 , q −1/2 ]) of the braid
         f , by the two-sided ideal generated by the elements
group of W

                                                    (Ts + 1)(Ts − q),

for s ∈ Sa . The image of Tw in H is again denoted by Tw . It is known that the elements Tw (w ∈ W   f ) form
      1/2 −1/2
a Z[q , q      ]-basis for H. The presentation of H using the generators Tw and the above relations is called
the Iwahori-Matsumoto presentation.
    For any Tw , define a renormalization T̃w = q −l(w)/2 Tw . Define an indeterminate Q = q −1/2 − q 1/2 . The
elements T̃w form a basis for H, and the usual relations can be written as
                                         
                                           T̃sw ,          if l(sw) = l(w) + 1,
                               T̃s T̃w =
                                           −QT̃w + T̃sw , if l(sw) = l(w) − 1,

        f and s ∈ Sa . There is also a right-handed version of this relation. Note that T̃ −1 = T̃s + Q.
for w ∈ W                                                                                 s
    We will denote T̃tλ (λ ∈ X∗ ) simply by T̃λ .
    For λ ∈ X∗ , define
                                                  Θλ = T̃λ1 T̃λ−1
                                                                2




                                                               3
where λ = λ1 − λ2 , and λ1 , λ2 are dominant. The elements Θλ generate a commutative subalgebra of H.
It is known that the elements Θλ Tw (λ ∈ X∗ , w ∈ W0 ) form a Z[q 1/2 , q −1/2 ]-basis for H. These generators
satisfy well-known relations (see Prop. 3.6, [14]); in case the root system is simply connected, these are given
by the formula
                                                                 Θλ − Θs(λ)
                                    Θλ Ts − Ts Θs(λ) = (q − 1)              ,
                                                                  1 − Θ−α̌
where s = sα and α ∈ Π. The presentation of H with generators Θλ Tw and the above relations is called the
Bernstein presentation.
   We also define
                                            Θ−           −1
                                              λ = T̃λ1 T̃λ′
                                                     ′
                                                                      2

where λ =   λ′1
             −    λ′2 ,
                   and        λ′1 , λ′2
                             are antidominant.
   The involution a → a of Z[q 1/2 , q −1/2 ] determined by q 7→ q −1 extends to an involution h → h, given by
                                                X              X
                                                    aw T w =        āw Tw−1
                                                                           −1 .



    It is immediate that Θλ = Θ− λ . Clearly the Bernstein presentation gives rise to an analogous presentation
using the generators Θ− λ Tw in place of Θλ Tw .


2.2.2     Bernstein functions
For each W0 -orbit M in X∗ , define the Bernstein function zM attached to M by
                                                     X
                                              zM =       Θλ .
                                                             λ∈M

When the W0 -orbit M contains the dominant element µ, this function is denoted by zµ .
  From Corollary 8.8 of Lusztig [12], we have zµ = z µ . Consequently,
                                                   X
                                            zµ =          Θ−
                                                           λ.
                                                          λ∈W0 (µ)


2.2.3     A support property
The preceding formula implies that when one studies Bernstein functions there is no harm in working with
the functions Θ−λ instead of the functions Θλ . We do so in this paper because their supports enjoy a nice
regularity property, given by the following lemma.

Lemma 2.1 For λ ∈ X∗ , we have

                                             supp(Θ−
                                                   λ ) ⊂ {x : λ(x)  λ}.

Proof. Write                                              X
                                                  Θ−
                                                   λ =           ay (Q)T̃y ,
                                                          y≤tλ

where ay (Q) ∈ Z+ [Q] (see Lemma 5.1 and Corollary 5.7 of [4]).
   Choose a dominant coweight µ′ such that µ′ + λ(x) is also dominant for any x in the support of Θ−
                                                                                                   λ.
Thus we have                                                X
                               −1          −        − −                 −1
                             T̃−(µ′ +λ) = Θµ′ +λ = Θµ′ Θλ =     ay (Q)T̃−µ′ T̃y .

                                                                          y

Let y ∈   supp(Θ−
                λ ).
                                                                          −1
                          We claim that tµ′ y belongs to the support of T̃−µ′ T̃y . Indeed, under the specialization

map H → Z[W  f ] determined by q 1/2 7→ 1, the element T̃ −1′ T̃y maps to tµ′ y. Since no cancellation occurs on
                                                         −µ
                                                                  −1
the right hand side above, we see from this that tµ′ y ∈ supp(T̃−(µ  ′ +λ) ), and thus


                                               tµ′ +λ(y) wy = tµ′ y ≤ tµ′ +λ ,

                                                             4
where y = tλ(y) wy . Since µ′ + λ(y) and µ′ + λ are both dominant, it is well-known that this implies
µ′ + λ(y)  µ′ + λ. The lemma follows.

    In the case where λ is minuscule, this statement can be considerably sharpened; see Corollary 3.5.
    We remark that Lemma 2.1 plays a key role in the proof of Theorem 4.1.

2.2.4    R-polynomials
            f , let y = s1 · · · sr τ (si ∈ Sa , τ ∈ Ω) be a reduced expression for y. Then for any x, we can
For any y ∈ W
write                                                 X
                                             T̃y−1
                                                 −1 =     Rex,y (Q)T̃x .
                                                         f
                                                       x∈W

where Rex,y (Q) ∈ Z[q 1/2 , q −1/2 ]. These coefficients R
                                                         ex,y (Q) can be thought of as polynomial expressions in
Q (as the notation suggests) because of the identity

                                        T̃y−1
                                           −1 = (T̃s1 + Q) · · · (T̃sr + Q)T̃τ .




3       The minuscule case
We say λ ∈ X∗ is minuscule if hα, λi ∈ {0, ±1}, for every root α ∈ R. Such coweights are the concern of this
section.
    The purpose of this section is to present an analogue of Proposition 4.4 from [5] using Θ−   λ instead of
Θλ . For simplicity, the theorem is given here for affine Hecke algebras with trivial parameter systems. The
generalization to arbitrary parameter systems is straightforward (see [5] for notation and details). Similar
arguments to those appearing here apply to Θλ , giving a short proof of Proposition 4.4 from [5].

Theorem 3.1 Let µ− be minuscule and antidominant, and λ ∈ W0 (µ− ). Then
                                           X
                                  Θ−              ex,t (Q)T̃x .
                                    λ =          R    λ
                                                   x : λ(x)=λ


   We begin with some lemmas. For a proof of the first lemma, refer to Proposition 3.4 of [5], where a
similar result is given (see also the proof of Corollary 6.6).

Lemma 3.2 Let µ− be an antidominant and minuscule coweight, and let τ ∈ Ω be the unique element such
that tµ− ∈ Wa τ . Let λ ∈ W0 (µ− ). Suppose that λ − µ− is a sum of p simple coroots (0 ≤ p ≤ l(tµ− ) = r).
Then there exists a sequence of simple roots α1 , . . . , αp such that the following hold (setting si = sαi ):
(1) hαi , si−1 · · · s1 (µ− )i = −1, ∀1 ≤ i ≤ p;
(2) there is a reduced expression for tµ− of the form tµ− = s1 · · · sp t1 · · · tr−p τ ;
(3) there is a reduced expression for tλ of the form tλ = t1 · · · tr−p (τs1 ) · · · (τsp )τ ;
(4) Θ−                        −1          −1
      λ = T̃t1 · · · T̃tr−p T̃τs1 · · · T̃τsp T̃τ ,
where tj ∈ Sa , ∀j ∈ {1, . . . , r − p}.


                  f , and suppose that xsα > x for all α ∈ Π. Then l(xw) = l(x) + l(w) for all w ∈ W0 .
Lemma 3.3 Let x ∈ W

Since µ− is antidominant, this lemma applies to the expression tµ− = s1 · · · sp t1 · · · tr−p τ . It then applies to
the expression t1 · · · tr−p τ as well. It follows that we can think of the formula in Lemma 3.2(4) as

                                        Θ−           −1         −1           −1
                                         λ = T̃w λ T̃s1 · · · T̃sp = T̃w λ T̃w −1

where tλ = wλ w, with w ∈ W0 and wλ the minimal length representative for the coset tλ W0 . This observation
is helpful towards proving the main result of this section.


                                                           5
Lemma 3.4 For λ, s1 , . . . , sp , and t1 , . . . , tr−p as in Lemma 3.2, the mapping

                            {y : y ≤ s1 · · · sp } −→ {x : λ(x) = λ and x ≤ tλ }

defined by
                                           y 7→ t1 · · · tr−p τ y = wλ y
is bijective.

 Proof of Theorem 3.1.     Let w = s1 · · · sp , and wλ = t1 · · · tr−p τ , so that tµ− = wwλ and tλ = wλ w. We
have                                                       X
                                      T̃s−1  · · · T̃s−1 =       ey,w (Q)T̃y
                                                                 R
                                          1           p
                                                       y : y≤w

The expression for Θ−  λ of Lemma 3.2, together with the fact that T̃w λ T̃y = T̃w λ y for all y ∈ W0 (since
l(wλ y) = l(wλ ) + l(y)), implies             X
                                       Θ−           ey,w (Q)T̃wλ y .
                                         λ =        R
                                                 y : y≤w

                                                                 ey,w (Q) = R
Using the recursion formula of Lemma 2.5 (1) from [5], we obtain R           ewλ y,t (Q). In view of the
                                                                                    λ
bijection given in Lemma 3.4, we have
                               X                        X
                                    ewλ y,t (Q)T̃wλ y =
                                    R                          ex,t (Q)T̃x ,
                                                               R
                                           λ                       λ
                               y : y≤w                      x : λ(x)=λ

which completes the proof.

    For the minuscule case, Theorem 3.1 yields the following improvement on Lemma 2.1.

Corollary 3.5 Let λ ∈ X∗ be minuscule. Then

                                   supp(Θ−
                                         λ ) = {x : λ(x) = λ and x ≤ tλ }.

Here we have used Lemma 2.5 (5) of [5], which asserts that R̃x,y (Q) 6= 0 if and only if x ≤ y.
   The Bernstein function zµ has a very simple form when µ is minuscule (cf. Theorem 4.3 of [5]):

Corollary 3.6 If µ is dominant and minuscule, then
                                            X
                                    zµ =           R̃x,tλ(x) (Q)T̃x .
                                               x∈Adm(µ)



4     Multiples of the Drinfeld case
Fix positive integers n and m, and an integer 1 ≤ k ≤ n. In this section, we establish in Theorem 4.1
a formula for the Θ− λ functions of GLn when λ = mek (where ek denotes the coweight of GLn with kth
coordinate equal to 1, and all other coordinates equal to 0).
    In this section, we adopt the following notation: for 1 ≤ i ≤ n − 1, let αi = α̌i = ei − ei+1 , and let
si = sαi . We single out the element τ ∈ Ω given by τ = t(1,0,...,0) s1 · · · sn−1 .

Theorem 4.1 For the coweight mek of GLn , we have
                                            X
                               Θ−mek =
                                                              ex,tme (Q)T̃x .
                                                              R     k
                                               x : λ(x)mek




                                                        6
   Consequently, we have a result for mek analogous to that of Corollary 3.5 for λ minuscule, that is,

                                 supp(Θ−
                                       mek ) = {x : λ(x)  mek and x ≤ tmek }.

We also get the following explicit formula for the Bernstein function zme1 , analogous to Corollary 3.6:

Corollary 4.2                                                                            
                                                  X                 X
                                     zme1 =                                   R̃x,tλ (Q) T̃x ,
                                               x∈Adm(µ)        λ(x)λ , x≤tλ

where the inner sum ranges over λ ∈ W0 (me1 ) such that λ(x)  λ and x ≤ tλ .


Q We require three lemmas before the proof of the theorem. In the following arguments we use the notation
   to denoteQproducts even though we are working in a non-commutative ring. We will use the following
convention: ni=1 ai will denote the product a1 a2 · · · an (in that order).

Lemma 4.3 For the coweight mek of GLn , we have

                                         Θ−                              −1           −1 m
                                          mek = (T̃sk−1 · · · T̃s1 T̃τ T̃sn−1 · · · T̃sk ) .

Proof. From Lemma 3.2, we have

                                            Θ−                            −1           −1
                                             ek = T̃sk−1 · · · T̃s1 T̃τ T̃sn−1 · · · T̃sk .

                                                      −
Then the formula for Θ−                                         − −
                      mek follows from the fact that Θν1 +ν2 = Θν1 Θν2 for all ν1 , ν2 ∈ X∗ .



Lemma 4.4 Let w, y ∈ W̃ . Then                                     X
                                                       T̃w T̃y =          ax T̃x
                                                                   x=we
                                                                     ey

where w
      e and ye range over certain subexpressions of w and y, respectively.

Proof. This is an easy induction on the length of y.


Lemma 4.5 Let x be a subexpression of

                                             tmek = (sk−1 · · · s1 τ sn−1 · · · sk )m

such that for some 1 ≤ i ≤ k − 1, at least one si is deleted. Then λ(x)  mek .

Proof. We can write
                                                     x = u1 τ v1 · · · um τ vm
for suitable subexpressions u1 , . . . , um and v1 , . . . , vm of sk−1 · · · s1 and sn−1 · · · sk , respectively. Suppose
that p is the least index such that up 6= sk−1 · · · s1 . Then
                                p−1
                                 Y                                                     Y
                                                                                         m        
                          x=            tek sk · · · sn−1 vi (tej up s1 · · · sn−1 vp )    ui τ vi ,
                                 i=1                                                      i=p+1

for some j with 1 ≤ j < k. Since sk · · · sn−1 v(ej ) = ej for any subexpression v of sn−1 · · · sk ,
                             p−1
                              Y                                 p−1
                                                                  Y                        −1
                                     tek sk · · · sn−1 vi (tej )      tek sk · · · sn−1 vi     = tej .
                               i=1                                 i=1



                                                                   7
It follows that the translation part λ(x) is the sum of ej and a non-negative integral linear combination of
vectors ei (i = 1, . . . , n). Indeed, the translation part of
                              p−1
                               Y                                                Y
                                                                                  m         
                                     tek sk · · · sn−1 vi (up s1 · · · sn−1 vp )    ui τ vi
                               i=1                                                          i=p+1

is necessarily a vector (b1 , . . . , bn ) where bi ∈ Z+ for every i.
    We thus see that one of the first k − 1 coordinates of λ(x) is positive (namely the j-th coordinate is),
and this implies that λ(x)  mek .

 Proof of Theorem 4.1. Let E = ({0, 1}n−1)m − ({1}k−1 × {0, 1}n−k )m . Using T̃s−1 = T̃s + Q and expanding
the left hand side, we can write
                                        X                          m
                                                                   Y
                     −1                                                       ǫi           ǫi     ǫi            ǫi
                   T̃−mek
                          = Θ−
                             mek +            Qm(n−1)−σ(ǫ)                  k−1
                                                                         T̃sk−1                    n−1
                                                                                · · · T̃s11 T̃τ T̃sn−1 · · · T̃skk .   (1)
                                        ǫ∈E                        i=1

Here ǫij ∈ {0, 1} and we denote ǫ = (ǫ1 , . . . , ǫm ), and ǫi = (ǫi1 , . . . , ǫin−1 ), i = 1, . . . , m, and σ(ǫ) =
Pm P     n−1 i
   i=1   j=1 ǫj .
    From Lemma 2.1, we know that supp(Θ−        mek ) ⊂ {x : λ(x)  mek }. Thus we need only prove that if T̃x
is in the support of the second term on the right hand side, then λ(x)  mek . Indeed, then the first and
second terms on the right hand side of (1) have disjoint supports, and so the coefficients of like terms will
              −1
be equal in T̃−me   k
                       and Θ−  mek .
    Let ǫ = (ǫ , . . . , ǫm ) ∈ E, and consider
              1


                                           m
                                           Y        ǫi
                                                    k−1          ǫi        ǫi
                                                                           n−1             ǫi
                                                 T̃sk−1 · · · T̃s11 T̃τ T̃sn−1 · · · T̃skk .
                                           i=1

By Lemma 4.4, if x is in the support of this product, then x is a subexpression of
                                              m
                                              Y      ǫi
                                                      k−1         ǫi     ǫi
                                                                        n−1           ǫi
                                                    sk−1  · · · s11 τ sn−1  · · · skk .
                                              i=1

Since E excludes the elements of ({1}k−1 × {0, 1}n−k )m , we know that for some 1 ≤ i ≤ m and 1 ≤ j ≤ k − 1,
that ǫij = 0. But this is equivalent to the deletion of some sj (1 ≤ j ≤ k − 1) from the expression
tmek = (sk−1 · · · s1 τ sn−1 · · · sk )m . By Lemma 4.5, we have λ(x)  mek , and the proof is complete.



5     Minimal expressions
We say Θ−
        λ has a minimal expression if it can be written in the form

                                                            ǫ1         ǫr
                                                     Θ−
                                                      λ = T̃t1 · · · T̃tr T̃τ ,

where tλ = t1 · · · tr τ (ti ∈ Sa , τ ∈ Ω) is a reduced expression and ǫi ∈ {1, −1} for every 1 ≤ i ≤ r. Such
expressions played a key role in Theorems 3.1 and 4.1.
   Lemma 3.2 asserts that Θ−     λ has a minimal expression whenever λ is minuscule. If λ is any coweight for
GLn , then we may write
                                                  λ = λ1 + · · · + λk
where each λj is minuscule and
                                              l(tλ ) = l(tλ1 ) + · · · + l(tλk ).




                                                                   8
It follows that for any coweight λ of GLn , there is a minimal expression for Θ−
                                                                               λ . Letting w
                                                                                             λi
                                                                                                denote the
                                                                         λi
minimal representative for the coset tλi W0 and writing tλi = w wi (wi ∈ W0 ), we may recover a minimal
expression for
                                       Θ−             −1                  −1
                                         λ = T̃w λ1 T̃w −1 · · · T̃w λk T̃w −1
                                                            1              k

by choosing reduced expressions for every wλi and wi .
    Clearly a similar result would follow for any root system with the property that Θ−  ω has a minimal expres-
sion for every Weyl conjugate ω of every fundamental coweight. It seems to be an interesting combinatorial
problem to determine the root systems (besides that for GLn ) which satisfy this property.
    In principle, a minimal expression for Θ−  λ allows one to write it as an explicit linear combination of the
Iwahori-Matsumoto generators Tw , simply by using the formula T̃s−1 = T̃s + Q and expanding the product.
The result is a linear combination of certain products

                                                     Ts1 · · · Tsg Tσ

(si ∈ Sa , σ ∈ Ω), where s1 · · · sg σ ranges over certain subexpressions of tλ (which subexpressions occur is
governed by the signs ǫj in the minimal expression). These may in turn be simplified by using the well-known
formula                                                   X
                                          Ts1 · · · Tsg =   N (s, w, q)Tw ,
                                                           w

(cf. [11], Lemma 3.7). Here s = (s1 , . . . , sg ) and N (s, w, q) is the number of Fq -rational points on the variety
Z(s, w) consisting of all sequences (I1 , . . . , Ig ) where the Ii are Iwahori subgroups of Gsc (F̄q ((t))) (here Gsc is
the simply connected group associated to the given root system) such that the relative positions of adjacent
subgroups satisfy
                                                      inv(Ii−1 , Ii ) = si
for all 1 ≤ i ≤ g, and Ig = wI0 w−1 , where I0 is a fixed “standard” Iwahori subgroup.
    We forgo the cumbersome task of describing more completely the resulting expressions for Θ−
                                                                                              λ in terms of
the generators Tw . The combinatorics are best described in the geometric framework of Demazure resolutions.
We explain this in the following section.
Remark. Let λ be a coweight for GLn , and write λ = m1 e1 + · · · + mn en . One finds a similar expression for
Θ−
 λ starting from
                                        Θ−       −          −
                                          λ = Θm1 e1 · · · Θmn en ,

and making use of Theorem 4.1.


6     Sheaf-theoretic meaning of minimal expressions
The goal of this section is to describe a sheaf-theoretic interpretation of a minimal expression for Θ−λ : the
corresponding perverse sheaf on the affine flag variety is the push-forward of an explicit perverse sheaf on a
Demazure resolution of the Schubert variety X(tλ ). We proceed to illustrate this statement in more detail.

6.1    Affine flag variety
Let k = Fq denote the finite field with q elements, and let k̄ denote an algebraic closure of k. Let G be the
split connected reductive group over k whose root system is (X ∗ , X∗ , R, Ř, Π). Choose a split torus T and
a k-rational Borel subgroup B containing T , which give rise to R and Π.
    Denote by F l the affine flag variety for G. This is an ind-scheme over k whose k-points are given by

                                                 F l(k) = G(k((t)))/Ik ,

where I = Ik ⊂ G(k[[t]]) is the Iwahori subgroup whose reduction modulo t is B.
                                                               √
    Fix a prime ℓ 6= char(k), and make a fixed choice for q ∈ Q̄ℓ (for Tate twists).
    Let Db (F l) denote the category Dcb (F l, Q̄ℓ ). By definition Dcb (F l, Q̄ℓ ) is the inductive 2-limit of categories
 b
Dc (X, Q̄ℓ ) where X ⊂ F l ranges over all projective k-schemes which are closed subfunctors of the ind-scheme

                                                            9
F l. The category Dcb (X, Qℓ ) is the “derived” category of Deligne [3]: Qℓ ⊗ the projective 2-limit of the
               b
categories Dctf  (X, Z/ℓn Z). For any finite extension E of Qℓ contained in Q̄ℓ , the definition of Dcb (X, E) is
similar, and by definition Dcb (X, Q̄ℓ ) is the inductive 2-limit of the categories Dcb (X, E).
     For f : X → Y a morphism of finite-type k-schemes, we have the four “derived” functors f∗ , f! :
Dcb (X, Q̄ℓ ) → Dcb (Y, Q̄ℓ ) and f ∗ , f ! : Dcb (Y, Q̄ℓ ) → Dcb (X, Q̄ℓ ). This notation should cause no confusion, since
we never use the non-derived versions of the pull-back and push-forward functors in this paper.
     We define the category PI (F l): it is the full subcategory of Db (F l) whose objects are I-equivariant
perverse sheaves for the middle perversity (by definition the latter have finite dimensional support).
     The I-orbits on F l correspond to W         f . Given w ∈ W    f , we denote by Y (w) = IwI/I the corresponding
Bruhat cell, and we denote its closure by X(w) = Y (w). Further, let Q̄ℓ,w denote the constant sheaf on
Y (w), and define Aw = Q̄ℓ,w [l(w)](l(w)/2). This is a self-dual perverse sheaf on Y (w).
     Let jw : Y (w) ֒→ X(w) denote the open immersion. We define Jw∗ = jw∗ Aw and Jw! = jw! Aw . These
are perverse sheaves in PI (F l) satisfying D(Jw∗ ) = Jw! . (Here D denotes Verdier duality.)
     Given G ∈ PI (F l) we may define the corresponding function [G] on F l(k), which we may identify with
an element in H:
                                                       [G](x) = Tr(Frq , Gx ),
where Frq denotes the Frobenius morphism on F lk̄ (raising coordinates to power q). We have
                                                               −1/2
                                                  [Jw! ] = εw qw    Tw
                                                              1/2 −1
                                                 [Jw∗ ] = εw qw  Tw−1 .

6.2     Convolution of sheaves
Following Lusztig [15], one can define a convolution product ⋆ : PI (F l) × PI (F l) → Db (F l). We formulate
this in a way similar to [6]. Given Gi ∈ PI (F l), i = 1, 2, we can choose X(wi ) such that the support of Gi
is contained in X(wi ), for i = 1, 2. We may identify F l with the space of all “affine flags” L for G(k((t)));
there is a base point L0 whose stabilizer in G(k((t))) is the “standard” Iwahori subgroup I. Then X(w) is
identified with the space of all affine flags L such that the relative position between the base point L0 and
L satisfies
                                                 inv(L0 , L) ≤ w
                       f . The “twisted” product X(w1 )×X(w
in the Bruhat order on W                               ˜                                  ′
                                                           2 ) is the space of pairs (L, L ) ∈ F l × F l
such that

                                                    inv(L0 , L) ≤ w1
                                                    inv(L, L′ ) ≤ w2 .
                                                                                                          ˜
We can find a finite-dimensional projective subvariety X ⊂ F l with the property that (L, L′ ) ∈ X(w1 )×X(w     2) ⇒
L′ ∈ X. The “multiplication” map m : X(w1 )×X(w  ˜    2 ) → X  given  by (L, L′
                                                                                ) →
                                                                                  7 L′
                                                                                       is proper.
    Now Gi (i = 1, 2) determine a well-defined perverse sheaf G1 ⊠G  ˜ 2 on X(w1 )×X(w
                                                                                    ˜      2 ) (see e.g. [6]). We
define
                                                              ˜ 2 ).
                                             G1 ⋆ G2 = m∗ (G1 ⊠G
The convolution G1 ⋆ G2 ∈ Db (F l) is independent of the choice of X(wi ) and X.
    The object G1 ⋆ G2 is I-equivariant in a suitable sense, so that we can regard its function Tr(Frq , G1 ⋆ G2 )
as an element of the Hecke algebra H.
    It is well-known that this product is compatible with the function-sheaf dictionary:

                                                 [G1 ⋆ G2 ] = [G1 ] ⋆ [G2 ].

Here ⋆ on the right hand side is just the usual product in H.
    Later we shall use the following fact, referred to in the sequel simply as associativity: if Gi (i = 1, 2, 3)
are objects of PI (F l) such that G1 ⋆ G2 ∈ PI (F l) and G2 ⋆ G3 ∈ PI (F l), then there is a canonical isomorphism
G1 ⋆ (G2 ⋆ G3 )→(G
               ˜ 1 ⋆ G2 ) ⋆ G3 (the “associativity constraint”). This is proved by identifying each canonically
with the “triple product” G1 ⋆ G2 ⋆ G3 , whose construction is similar (see section 6.3).

                                                             10
6.3    Demazure resolution vs. twisted product
It is clear that we can define in a similar way the k-fold convolution product ⋆ : PI (F l)k → Db (F l). To do
this we define the k-fold twisted product X(w1 )× ˜ · · · ×X(w
                                                          ˜    k ) to be the space of k-tuples (L1 , . . . , Lk ) such
that
                                              inv(Li−1 , Li ) ≤ wi
                                             P
for 1 ≤ i ≤ k. If w = w1 · · · wk and l(w) = i l(wi ), then the multiplication map

                                                    ˜ · · · ×X(w
                                          m : X(w1 )×       ˜   k ) −→ X(w)

given by (L1 , . . . , Lk ) 7→ Lk induces an isomorphism on open subschemes

                                                      ˜ · · · ×Y
                                           m : Y (w1 )×       ˜ (wk )−→Y
                                                                      ˜ (w).

If moreover each wi is a simple reflection si , then the twisted product is smooth, since it is a succession of
P1 -bundles. We have proved the following lemma.

Lemma 6.1 If w = s1 · · · sr is a reduced expression, then the twisted product

                                                     ˜ · · · ×X(s
                                           m : X(s1 )×       ˜    r ) −→ X(w)

is a Demazure resolution for the Schubert variety X(w).

   We use the k-fold twisted product to define the k-fold convolution product: as before, the objects
                                                                         ˜ · · · ⊠G
Gi ∈ PI (F l) determine a (unique, perverse) twisted exterior product G1 ⊠       ˜ k , and we set

                                                                     ˜ · · · ⊠G
                                            G1 ⋆ · · · ⋆ Gk = m∗ (G1 ⊠       ˜ k ).

   We have the following generalized associativity constraint. Consider a product with k terms

                                (· · · (G1 ⋆ (· · · ⋆ Gi )) · · · ) ⋆ (· · · (Gj ⋆ (· · · ⋆ Gk )) · · · )

where the placement of the parentheses is arbitrary with the proviso that the product is defined (i.e., at
every stage we convolve objects of PI (F l)). Then this can be identified canonically with the k-fold product

                                                           G1 ⋆ · · · ⋆ Gk .

This can be seen easily by induction on k.

6.4    Properties of certain convolutions
The convolution of two I-equivariant perverse sheaves on F l is not perverse in general. However, the following
result of I. Mirkovic (unpublished) shows this conclusion does hold in some important cases. We are grateful
to R. Bezrukavnikov, who communicated this result to the first author, and to I. Mirkovic, for his kind
permission to include the result in this paper.
   In the notation of [1], we let p D≤0 (F l) (resp. p D≥0 (F l)) denote the objects P ∈ Db (F l) whose perverse
cohomology sheaves vanish in degree ≥ 1 (resp. ≤ −1). Thus the perverse sheaves on F l are precisely the
objects in p D≥0 (F l) ∩ p D≤0 (F l).

                                                                  f , we have
Proposition 6.2 (Mirkovic) (a) Let P ∈ PI (F l). Then for any w ∈ W
 (1) Jw! ⋆ P and P ⋆ Jw! belong to p D≥0 (F l),
 (2) Jw∗ ⋆ P and P ⋆ Jw∗ belong to p D≤0 (F l).
                                                                                     f.
(b) In particular, Jw1 ∗ ⋆ Jw2 ! and Jw1 ! ⋆ Jw2 ∗ are perverse, for every w1 , w2 ∈ W


                                                                  11
    Proof. (a),(1). We consider Jw! ⋆ P . Suppose P is supported on X(w′ ) and recall that the convolution
is given by
                                                             ˜ ),
                                           Jw! ⋆ P = m! (Jw! ⊠P
              ˜
where m : X(w)×X(w ′
                     ) → X is as in section 6.2 (note that m! = m∗ , since m is proper). We have
                                                               ˜ )
                                        Jw! ⋆ P = m! (jw! (Aw )⊠P
                                                             ˜
                                                  = [m ◦ (jw ×id)]       ˜
                                                                   ! (Aw ⊠P ).

                    ˜
Note that m ◦ (jw ×id)           ˜
                          : Y (w)×X(w  ′                               ˜ is perverse on its source. Therefore
                                         ) → X is affine, and that Aw ⊠P
           p ≥0
Jw! ⋆P ∈ D (F l) follows from the following general fact (cf. [1], Thm. 4.1.1 and Cor. 4.1.2): If F : X → Y
is an affine morphism, then F∗ : Dcb (X) → Dcb (Y ) (resp. F! ) preserves p D≤0 (resp. p D≥0 ).
    A similar argument gives P ⋆ Jw! ∈ p D≥0 (F l), once it is noted that m ◦ (id×j˜ w ) : X(w′ )×Y
                                                                                                 ˜ (w) → X is
also an affine morphism.
    Part (a),(2) is similar, and part (b) is an immediate consequence of part (a).


   Now we let PI (F l) ∩ Jw∗ PI (F l) (resp. PI (F l) ∩ Jw! PI (F l)) denote the full subcategory of PI (F l) whose
objects are of the form Jw∗ ⋆ P (resp. Jw! ⋆ P) for some P ∈ PI (F l).

                          f , we have
Corollary 6.3 For any w ∈ W

                                         Jw! ⋆ Jw−1 ∗ = Jw−1 ∗ ⋆ Jw! = Je ,
          f is the identity element. Together with the associativity constraint, these identities imply that
where e ∈ W

                           Jw! ⋆ − : PI (F l) ∩ Jw−1 ∗ PI (F l) −→ PI (F l) ∩ Jw! PI (F l)

is an equivalence of categories, with inverse Jw−1 ∗ ⋆ −.

    Proof. We prove that Jw! ⋆ Jw−1 ∗ = Je (the other equality is similar). Let X(y) be an irreducible
component in the support of P := Jw! ⋆ Jw−1 ∗ . Since P is perverse and I-equivariant, the restriction P |Y (y)
is an I-equivariant ℓ-adic local system on the affine space Y (y). We need to show that y = e and P |Y (e) = Q̄ℓ .
For the former it is sufficient to prove that y 6= e implies P |Y (y) = 0.
    Since P |Y (y) is an I-equivariant ℓ-adic local system on the I-orbit Y (y), and the stabilizer in I of any
point in this orbit is geometrically connected, it follows that P |Y (y) is a constant local system (placed in
degree −l(y) when regarded as a complex). Write α1 , α2 , . . . , αr for the eigenvalues of Frq on P |Y (y)[−l(y)],
counted with multiplicity. We have the following identity for every n ≥ 1:
                                                                                                r
                                                                                                X
                  Je (y) = Tr(Frqn , Jw! ) ⋆ Tr(Frqn , Jw−1 ∗ )(y) = Tr(Frqn , P |Y (y)) = ǫy         αni .
                                                                                                i=1

We thus have, for every n ≥ 1:
                                                r
                                                                (
                                                X                   0, if y =
                                                                            6 e
                                           ǫy         αni   =
                                                i=1
                                                                    1, if y = e.

The linear independence of characters (or rather its proof) implies that distinct numbers β ∈ Q̄× ℓ determine
linearly independent characters n 7→ β n on the semi-group of positive integers. Together with the above
formula this is enough information to determine the eigenvalues of Frq on P |(Y (y) (if y 6= e then r = 0, and
if y = e then r = 1 and α1 = 1). Thus P |Y (y) = 0 if y 6= e and P |Y (e) = Q̄ℓ , as desired.


   It is straightforward to check the following properties. From now on we omit the convolution sign ⋆ in
the product of perverse sheaves.

                                                                12
Lemma 6.4          1. If l(xy) = l(x) + l(y), then Jx! Jy! = Jxy! .
   2. Under the same assumption, Jx∗ Jy∗ = Jxy∗ .

    Proof. The first can be checked from the definitions, and the second follows on applying Verdier duality.
We have used that Verdier duality is compatible with convolution: D(G1 ⋆ G2 ) = DG1 ⋆ DG2 , if Gi ∈ PI (F l)
(i = 1, 2).


Remark. We remark that Corollary 6.3 and Lemma 6.4 allow us to perform algebraic manipulations involving
the perverse sheaf Jw! (resp. Jw∗ ): essentially it behaves just like its function εw T̃w (resp. εw T̃w−1
                                                                                                        −1 ) (but

when multiplying sheaves, one has to take care that they are each perverse). For example, we have the
following cancellation property. Let Pi ∈ PI (F l) (i = 1, 2) be such that Jw∗ ⋆ Pi ∈ PI (F l) (i = 1, 2); then
Jw∗ P1 ∼= Jw∗ P2 implies P1 ∼= P2 (multiply both sides by Jw−1 ! and use associativity). We shall use this
several times in the proof of Lemma 6.5 below.


6.5     Sheaf analogue Ξ−
                        λ of Θλ
                              −

We now define the sheaf-analogue of Θ− λ . We write Jλ∗ (resp. Jλ! ) in place of Jtλ ∗ (resp. Jtλ ! ). If λ = λ1 −λ2 ,
where λi is anti-dominant (i = 1, 2), then we define

                                                     Ξ−
                                                      λ = Jλ1 ! J−λ2 ∗ .

By Proposition 6.2, Ξ−
                     λ is an object of PI (F l). Moreover it clearly satisfies

                                                       [Ξ−          −
                                                         λ ] = ελ Θ λ .

By [4], we know that supp(Θ−                                    −
                           λ ) ⊂ {x | x ≤ tλ }, and hence that Ξλ is supported on X(tλ ).

    Our next goal is to prove the sheaf-theoretic analogues of the relations in the Bernstein presentation of
H, in the following lemma. The proof follows Lemma 4.4 of [13] very closely, taking into account Proposition
6.2, Corollary 6.3 and Lemma 6.4. Since a little extra care must be taken in the present context of perverse
sheaves, we give detailed arguments for the convenience of the reader.

Lemma 6.5 (1) If x, y ∈ Wf commute and l(xy) = l(x) + l(y), then Jx! Jy−1 ∗ = Jy−1 ∗ Jx! . In particular, if
   µ, λ ∈ X∗ are both dominant or antidominant, then Jµ! J−λ∗ = J−λ∗ Jµ! .
 (2) Ξ−
      λ is independent of the choice of λi ( i = 1, 2 ).

 (3) Ξ−  −    −
      λ Ξµ = Ξλ+µ for λ, µ ∈ X∗ .

 (4) If s = sα (α ∈ Π) and hα, λi = 0, then

                                                        Js∗ Ξ−    −
                                                             λ = Ξλ Js∗ .

      Moreover, this object belongs to PI (F l).
 (5) If hα, λi = −1, then
                                                        Js∗ Ξ−        −
                                                             λ Js∗ = Ξsλ .

   Proof. (1). By Lemma 6.4, we have Jx! Jy! = Jxy! = Jyx! = Jy! Jx! . The result follows by two applications
of Corollary 6.3: multiply first on the left and then on the right by Jy−1 ∗ .
(2). Let λ = λ1 − λ2 = λ′1 − λ′2 , where λi , λ′i are antidominant (i = 1, 2). Then λ′2 + λ1 = λ′1 + λ2 , and
so Jλ′2 ! Jλ1 ! = Jλ′1 ! Jλ2 ! . Arguing as in (1), this yields Jλ1 ! J−λ2 ∗ = J−λ′2 ∗ Jλ′1 ! . Then (1) yields Jλ1 ! J−λ2 ∗ =
Jλ′1 ! J−λ′2 ∗ .



                                                             13
(3). Write λ = λ1 − λ2 and µ = µ1 − µ2 , where λi , µi are antidominant (i = 1, 2). Then by associativity we
have
                                          Ξ−  −
                                           λ Ξµ = (Jλ1 ! J−λ2 ∗ )(Jµ1 ! J−µ2 ∗ )
                                                    = Jλ1 ! (J−λ2 ∗ Jµ1 ! )J−µ2 ∗
                                                    = Jλ1 ! (Jµ1 ! J−λ2 ∗ )J−µ2 ∗
                                                    = (Jλ1 ! Jµ1 ! )(J−λ2 ∗ J−µ2 ∗ )
                                                    = J(λ1 +µ1 )! J−(λ2 +µ2 )∗
                                                    = Ξ−
                                                       λ+µ .

(4). We may write λ = λ1 − λ2 , where λi is antidominant and hα, λi i = 0, for i = 1, 2. Since s commutes
with tλi and l(stλi ) = l(tλi s) = l(tλi ) + 1, the result follows from (1), Lemma 6.4, and associativity.
    We note that Js∗ (Jλ1 ! J−λ2 ∗ ) = Jst−λ2 ∗ Jtλ1 ! is I-equivariant and perverse, by Proposition 6.2.
(5). We may write λ = λ1 − λ2 , where λi is antidominant (i = 1, 2), hα, λ1 i = −1, and hα, λ2 i = 0.
    As in the proof of (4) above, we note that Js∗ (Jλ1 ! J−λ2 ∗ ) and (Jλ1 ! J−λ2 ∗ )Js∗ are each perverse, so by
associativity we may unambiguously write
                                            Js∗ Ξ−
                                                 λ Js∗ = Js∗ (Jλ1 ! J−λ2 ∗ )Js∗ .

Using (4) and associativity, this is (Js∗ Jλ1 ! Js∗ )J−λ2 ∗ = (Js∗ Ξ−        −
                                                                    λ1 Js∗ )Ξ−λ2 . (Note Js∗ Jλ1 ! Js∗ is unambiguous
and perverse, since stλ1 < tλ1 implies that Jλ1 ! Js∗ = Js! Jstλ1 ! Js∗ , and therefore Js∗ Jλ1 ! Js∗ = Jstλ1 ! Js∗ .)
   Since by (3) Ξ−      −       −                                         −          −
                   sλ1 Ξ−λ2 = Ξsλ , we are reduced to proving Js∗ Ξλ1 Js∗ = Ξsλ1 , i.e., to prove the result for
general λ it is enough to consider λ which are antidominant.
   Therefore assume λ is antidominant, and write l(tλ ) = l. Following Lemma 4.4 (b) of [13] we see
   • l(tλ s) = l + 1 and l(stλ ) = l − 1,
   • λ + sλ is antidominant,
   • l(tλ stλ ) = 2l − 1 and l(tλ stλ s) = 2l − 2; in particular l(tλ stλ ) = l(tλ ) + l(stλ ).
   Taking these relations, the previous parts of the Lemma, Corollary 6.3, and associativity into account,
we find
                                               Jλ! Ξ−     − −
                                                    sλ = Ξλ Ξsλ
                                                          = Ξ−
                                                             λ+sλ
                                                          = Jtλ stλ s!
                                                          = Jtλ stλ ! Js∗
                                                          = Jλ! Jstλ ! Js∗
                                                          = Jλ! (Js∗ Jλ! Js∗ ).
Using Corollary 6.3 again to cancel Jλ! from each side, we obtain the desired equality Js∗ Ξ−        −
                                                                                            λ Js∗ = Ξsλ .



   Note that property (5) is the analogue of Bernstein’s relation
                                                   T̃s−1 Θ−   −1
                                                          λ T̃s  = Θ−
                                                                    sλ ,

which was a main ingredient in the proof of Lemma 3.2. In fact the same argument can be applied to prove
the following corollary.
Corollary 6.6 If λ is minuscule and tλ = wλ w as in section 3, then
                                                      Ξ−
                                                       λ = Jw λ ! Jw∗ .

Writing wλ = t1 · · · tr−p τ and w = s1 · · · sp as in section 3, we have
                                         Ξ−
                                          λ = Jt1 ! · · · Jtr−p ! Jτ ! Js1 ∗ · · · Jsp ∗ .



                                                               14
   Proof. Suppose λ is in the Weyl orbit of an antidominant minuscule coweight µ− . We have

                                                                    Ξ−
                                                                     µ− = Jµ ! .
                                                                            −



Choose the sequence of simple reflections s1 , . . . , sp as in Lemma 3.2. By induction on p, we easily see that

                                                  Ξ−
                                                   sp ···s1 (µ− ) = Jt1 ···tr−p τ ! Js1 ···sp ∗ .

Indeed, using induction and Lemma 6.4 this equality for p − 1 can be written

                                            Ξ−
                                             sp−1 ···s1 (µ− ) = Jsp ! Jt1 ···tr−p τ ! Js1 ···sp−1 ∗ .

Multiplying on each side by Jsp ∗ and using Lemma 6.5 (5), Corollary 6.3, and associativity yields

                                                  Ξ−
                                                   sp ···s1 (µ− ) = Jt1 ···tr−p τ ! Js1 ···sp ∗ ,

as desired.
    The second statement follows from the first, using Lemma 6.4. To justify this, we need to show that

                           (Jt1 ! · · · Jtr−p ! Jτ ! )(Js1 ∗ · · · Jsp ∗ ) = Jt1 ! · · · Jtr−p ! Jτ ! Js1 ∗ · · · Jsp ∗ ,

where the products of the form Jt1 ! · · · Jsp ∗ denote the k-fold convolution mentioned in section 6.3. This
results from the generalized associativity discussed there.
   We remark that it is important here that the underlying expression t1 · · · tr−p τ s1 · · · sp is reduced.

    Taking Corollary 6.6 as well as Lemmas 6.1, 6.4 and 6.5 into account, we get the following sheaf-theoretic
interpretation for minimal expressions for Θ−
                                            λ.

Theorem 6.7 (a) Let λ be a minuscule coweight of any root system. Write tλ = wλ w = t1 · · · tr−p τ s1 · · · sp ,
as in Lemma 3.2. Then
                                           Ξ−λ = m∗ (D),

where D is the perverse sheaf
                                     ˜ · · · ⊠(j
                     D = (jt1 ! At1 )⊠                       ˜ τ ! Aτ )⊠(j
                                             ˜ tr−p ! Atr−p )⊠(j                   ˜ · · · ⊠(j
                                                                       ˜ s1 ∗ As1 )⊠       ˜ sp ∗ Asp )

on the Demazure resolution m : X(t1 )× ˜ · · · ×X(t
                                               ˜         ˜
                                                    r−p )×X(τ  ˜
                                                              )×X(s    ˜ · · · ×X(s
                                                                    1 )×       ˜    p ) → X(tλ ) of the Schubert
variety X(tλ ).
(b) Let λ be a coweight for GLn , and write it as

                                                              λ = λ1 + · · · + λk ,
                                          P
where each λi is minuscule, and l(tλ ) = i l(tλi ). For each i = 1, . . . , k we have a decomposition and reduced
expression
                                       tλi = wλi wi = ti1 · · · tiqi τ i si1 · · · sipi ,
as in Lemma 3.2.
    Then Ξ−
          λ = m∗ (D), where D is the perverse sheaf

                ˜ · · · ⊠J
         Jt11 ! ⊠       ˜ t1 ! ⊠J
                               ˜ τ 1 ! ⊠J
                                       ˜ s1 ∗ ⊠
                                              ˜ · · · ⊠J     ˜ · · · · · · · ⊠J
                                                      ˜ s1 ∗ ⊠               ˜ tk ! ⊠
                                                                                    ˜ · · · ⊠J
                                                                                            ˜ tk ! ⊠J
                                                                                                   ˜ τ k ! ⊠J
                                                                                                           ˜ sk ∗ ⊠
                                                                                                                  ˜ · · · ⊠J
                                                                                                                          ˜ sk   ∗
                          1q              1              p      1               1              q            k 1              p
                                                                                                                             k



on the Demazure resolution m : X̃(tλ ) → X(tλ ) corresponding to the reduced expression

                                   tλ = (t11 · · · t1q1 τ 1 s11 · · · s1p1 ) · · · (tk1 · · · tkqk τ k sk1 · · · skpk ).

    Consequently, Ξ−λ is the push-forward of an explicit perverse sheaf on a Demazure resolution of X(tλ ),
for every coweight λ of GLn .

                                                                           15
    Proof. (a). This follows directly from Corollary 6.6 and the definition of the r-fold convolution product.
(b). By Lemma 6.5 (3) and generalized associativity, we have

                                               Ξ−    −             −
                                                λ = Ξλ1 ⋆ · · · ⋆ Ξλk ,

where the right hand side denotes the k-fold convolution product.
   Part (b) then follows from part (a) and another application of generalized associativity.


    For x ≤ tλ , write Θ−
                        λ (x) for the coefficient of Tx .

Corollary 6.8 Let λ be a minuscule coweight of a root system, or an arbitrary coweight for GLn . Let m, D
be as in Theorem 6.7. Then
                                 Θ−                     •
                                   λ (x) = ελ Tr(Frq , H (m
                                                            −1
                                                               (x), D)),
where the right hand side is the alternating trace of Frobenius on the étale cohomology of the fiber over x
with coefficients in D.


7     Acknowledgements
We thank I. Mirkovic for kindly allowing us to include his unpublished result (Proposition 6.2), which was
crucial to the last section of this paper. We are also grateful to R. Bezrukavnikov for some very helpful
discussions concerning Mirkovic’s theorem.
    Some of this paper was written during the first author’s 2000-2001 visit to the Institute for Advanced
Study in Princeton, which he thanks for support and hospitality. His research is partially supported by an
NSERC research grant and by NSF grant DMS 97-29992.
    The second author was supported by an NSERC Undergraduate Student Research Award during the
summers of 2000 and 2001.
    We wish to thank M. Rapoport for his comments on this paper. We are also grateful to R. Kottwitz
for his careful reading and for pointing out some errors in the first version of this paper. We thank him for
several other mathematical and expositional suggestions, in particular concerning the proof of Corollary 6.3.


References
 [1] A. Beilinson, J. Bernstein, P. Deligne, Faisceaux pervers, Astérisque 100 (1982).

 [2] N. Chriss and V. Ginzburg, Representation theory and complex geometry, Birkäuser (1997).
 [3] P. Deligne, La conjecture de Weil II, Publ. Math. IHÉS, 52 (1980) 313-428.
 [4] T. Haines, The Combinatorics of Bernstein Functions, Trans. Amer. Math. Soc. 353 (2001), 1251-1278.
 [5] T. Haines, Test Functions for Shimura Varieties: The Drinfeld Case, Duke Math. Journal 106 (2001),
     19-40.
 [6] T. Haines, B.C. Ngô, Nearby cycles for local models of some Shimura varieties, to appear, Compositio
     Math.
 [7] N. Iwahori and H. Matsumoto, On some Bruhat decomposition and the structure of the Hecke rings of
     p-adic Chevalley groups, Inst. Hautes Études Sci. Publ. Math. 25 (1965), 5-48.
 [8] D. Kazhdan and G. Lusztig, Representations of Coxeter groups and Hecke algebras, Invent. Math. 53
     (1979), 165-184.
 [9] D. Kazhdan and G. Lusztig, Proof of the Deligne-Langlands conjecture for Hecke algebras, Inv. Math.
     87 (1987), 153-215.


                                                            16
[10] R. Kottwitz and M. Rapoport, Minuscule Alcoves for Gln and GSp2n , Manuscripta Mathematica 102
     (2000), 403-428.
[11] G. Lusztig, Representations of finite Chevalley groups, Regional conference series in mathematics, No.
     39, (expository lectures from the CBMS regional conf. held at Madison, Wisconsin, Aug. 8-12, 1977),
     (1978).
[12] G. Lusztig, Singularities, character formulas, and a q-analog of weight multiplicities, Astérisque 101-
     102 (1983), 208-229.
[13] G. Lusztig, Some examples of square integrable representations of semisimple p-adic groups, Trans.
     Amer. Math. Soc. 277 (1983), no.2, 623-653.
[14] G. Lusztig, Affine Hecke algebras and their graded version, J. Amer. Math. Soc. 2 No.3 (1989), 599-635.
[15] G. Lusztig, Cells in Affine Weyl Groups and Tensor Categories, Adv. Math. 129, 85-98 (1997).
[16] O. Schiffmann, On the center of affine Hecke algebras of type A, preprint, math.QA/0005182.


   University of Toronto
   Department of Mathematics
   100 St. George Street
   Toronto, ON M5S 3G3, Canada
   email: haines@math.toronto.edu

   University of Chicago
   Department of Mathematics
   5734 S. University Ave.
   Chicago, IL 60637
   email: alexandra@math.uchicago.edu




                                                     17
