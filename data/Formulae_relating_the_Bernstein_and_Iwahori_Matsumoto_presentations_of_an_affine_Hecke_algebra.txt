                                                      Formulae relating the Bernstein and Iwahori-Matsumoto
                                                             presentations of an affine Hecke algebra
                                                                               Thomas J. Haines, Alexandra Pettet
arXiv:math/0201176v1 [math.RT] 18 Jan 2002




                                                                                                    Abstract
                                                      We consider the â€œantidominantâ€ variants Î˜âˆ’    Î» of the elements Î˜Î» occurring in the Bernstein presenta-
                                                  tion of an affine Hecke algebra H. We find explicit formulae for Î˜âˆ’    Î» in terms of the Iwahori-Matsumoto
                                                  generators Tw (w ranging over the extended affine Weyl group of the root system R), in the case (i) R
                                                  is arbitrary and Î» is a minuscule coweight, or (ii) R is attached to GLn and Î» = mek , where ek is a
                                                  standard basis vector and m â‰¥ 1.
                                                      In the above cases, certain minimal expressions for Î˜âˆ’   Î» play a crucial role. Such minimal expressions
                                                  exist in fact for any coweight Î» for GLn . We give a sheaf-theoretic interpretation of the existence of a
                                                  minimal expression for Î˜âˆ’  Î» : the corresponding perverse sheaf on the affine Schubert variety X(tÎ» ) is the
                                                  push-forward of an explicit perverse sheaf on the Demazure resolution m : XÌƒ(tÎ» ) â†’ X(tÎ» ). This approach
                                                  yields, for a minuscule coweight Î» of any R, or for an arbitrary coweight Î» of GLn , a conceptual albeit
                                                                                                Î» (w) of the basis element Tw , in terms of the cohomology of
                                                  less explicit expression for the coefficient Î˜âˆ’
                                                  a fiber of the Demazure resolution.
                                                      AMS Subject classification: 20C08, 14M15.


                                             1    Introduction
                                             Let H be the affine Hecke algebra associated to a root system. There are two well-known presentations
                                             of this algebra by generators and relations, the first discovered by Iwahori-Matsumoto [7] and the second
                                             by Bernstein [12], [14]; cf. 2.2.1 below. The Iwahori-Matsumoto presentation reflects the structure of the
                                             Iwahori-Hecke algebra Ccâˆž (I\G/I) of the split p-adic group G attached to the root system: the generators
                                             Tw correspond to the characteristic functions of Iwahori double cosets IwI, where w ranges over the extended
                                             affine Weyl group. The Bernstein presentation reflects the description of the Hecke algebra as an equivariant
                                             K-theory of the associated Steinberg variety, which plays a role in the classification of the representations of
                                             H, see [9], [2]. The Bernstein presentation has the advantage that one can construct a basis for the center
                                             of H by summing the generators Î˜Î» over Weyl-orbits of coweights Î»; the resulting functions are known as
                                             Bernstein functions.
                                                 It is of interest to give an explicit relation between the generators in these two presentations. More
                                             precisely, one would like to write each Î˜Î» as an explicit linear combination of the Iwahori-Matsumoto basis
                                             elements Tw . A direct consequence would be the explicit description of the Bernstein functions (and thus
                                             the center of H) in terms of the Iwahori-Matsumoto basis. This problem was considered earlier by the first
                                             author [4],[5] because of certain applications to the study of Shimura varieties, and was completely answered
                                             there for the case where Î» is a minuscule coweight. More recently, O. Schiffmann [16] has given explicit
                                             formulae for all elements in a certain basis for the center Z(H) of an affine Hecke algebra H of type A; from
                                             this one can derive a formula for the Bernstein function zÂµ , where Âµ is any dominant coweight of a group of
                                             type A.
                                                 In this paper we consider the â€œantidominantâ€ variants Î˜âˆ’     Î» of the elements Î˜Î» . The support of these
                                             functions is somewhat more regular than the original functions Î˜Î» , cf. Lemma 2.1. In section 3 we consider
                                             the case where Î» is a minuscule coweight, and we prove the following explicit formula for Î˜âˆ’    Î».

                                             Theorem 1.1 Let Î» âˆˆ Xâˆ— be minuscule. Then
                                                                                                  X
                                                                                       Î˜âˆ’
                                                                                        Î» =                  RÌƒx,tÎ» (Q)TÌƒx .
                                                                                              {x : Î»(x)=Î»}



                                                                                                       1
Here Î»(x) is the translation part of x â€œon the leftâ€ defined by the decomposition x = tÎ»(x) w (w âˆˆ W0 ),
TÌƒx is a renormalization of the usual Iwahori-Matsumoto generator Tx , Q = q âˆ’1/2 âˆ’ q 1/2 , and RÌƒx,y (Q) is a
variant of the usual R-polynomial of Kazhdan-Lusztig [8].
     The formula above is analogous to the expression for Î˜Î» found by the first author in Proposition 4.4 of
[5]:                                             X
                                        Î˜Î» =            RÌƒx,tÎ» (Q)TÌƒx .
                                               {x : t(x)=Î»}

Here t(x) is the translation part of x â€œon the rightâ€ defined by the decomposition x = wtt(x) (w âˆˆ W0 ).
However our proof is simpler and more direct than that of loc.cit., and the same arguments appearing here
also give a short proof of the formula for Î˜Î» . In fact one can derive the formula for Î˜âˆ’
                                                                                        Î» from that for Î˜âˆ’Î» ,
and vice-versa. Indeed, if Î¹ : H â†’ H denotes the anti-involution determined by q 1/2 7â†’ q 1/2 and Tx 7â†’ Txâˆ’1 ,
then Î¹(Î˜âˆ’Î» ) = Î˜âˆ’                                                    âˆ’
                  Î» and Î¹ interchanges the formulae for Î˜âˆ’Î» and Î˜Î» . We remark that Theorem 1.1 remains
valid for Hecke algebras with arbitrary parameters.
    In the fourth section we study coweights of GLn of the form Î» = mek , where ek is the k-th standard basis
vector and m âˆˆ Z+ . The case m = 1, studied in [4] and [5], has relevance to a certain family of Shimura
varieties with bad reduction, known as the Drinfeld case. The general case is referred to as multiples of the
Drinfeld case. We prove the following formula for Î˜âˆ’  mek .

Theorem 1.2 Let 1 â‰¤ k â‰¤ n and m â‰¥ 1. Then
                                                   X
                                     Î˜âˆ’
                                      mek =                     RÌƒx,tmek (Q)TÌƒx .
                                              {x : Î»(x)mek }

Here  denotes the usual partial order on the lattice Xâˆ— .
    Theorems 1.1 and 1.2 yield explicit expressions for the Bernstein functions zÂµ (Âµ minuscule) and zme1 ,
respectively; see Corollary 3.6 and 4.2. The expressions in these special cases seem much simpler than the
corresponding ones given by Schiffmann [16].
    Theorems 1.1 and 1.2 rely on the existence of certain minimal expressions for Î˜âˆ’Î» : these are expressions
of the form
                                                    Ç«1         Ç«r
                                            Î˜âˆ’Î» = TÌƒt1 Â· Â· Â· TÌƒtr TÌƒÏ„ ,

where tÎ» = t1 Â· Â· Â· tr Ï„ (ti âˆˆ Sa , Ï„ âˆˆ â„¦) is a reduced expression and Ç«i âˆˆ {1, âˆ’1} for every 1 â‰¤ i â‰¤ r. In
the final two sections, we discuss how one can approach a general formula for Î˜âˆ’     Î» when Î» is an arbitrary
coweight of GLn , through minimal expressions (which always exist in this setting, cf. section 5). The result
is much less explicit than Theorems 1.1 and 1.2, and involves the geometry of the Demazure resolution
 e Î» ) â†’ X(tÎ» ) of the affine Schubert variety X(tÎ» ). We define a perverse sheaf Îžâˆ’ on the affine flag variety
X(t                                                                                 Î»
whose corresponding function in the Hecke algebra is ÎµÎ» Î˜âˆ’                           âˆ’
                                                             Î» . It turns out that ÎžÎ» is supported on X(tÎ» ).
                                                          âˆ’
We see that the existence of a minimal expression for Î˜Î» is analogous to the existence of a certain explicitly
determined perverse sheaf on X(t   e Î» ) whose push-forward to X(tÎ» ) is Îžâˆ’ . More precisely, we conclude the
                                                                          Î»
paper with the following result (cf. Theorem 6.7, Corollary 6.8 for a completely precise statement).

Theorem 1.3 Let Î» be a minuscule coweight of a root system, or any coweight for GLn . Choose a minimal
expression for Î˜âˆ’                 e
                 Î» and let m : X(tÎ» ) â†’ X(tÎ» ) denote the corresponding Demazure resolution for X(tÎ» ).
                                                  e Î» ) (determined by the choice of minimal expression for
Then there exists an explicit perverse sheaf D on X(t
Î˜âˆ’Î» ) such that
                                               Rmâˆ— (D) = Îžâˆ’Î».

Consequently, if we denote the coefficient of Tx in the expression for Î˜âˆ’     âˆ’
                                                                        Î» by Î˜Î» (x), then we have

                                    Î˜âˆ’                    â€¢
                                     Î» (x) = ÎµÎ» Tr(Frq , H (m
                                                              âˆ’1
                                                                 (x), D)),

for any x â‰¤ tÎ» in the Bruhat order. Here the right hand side denotes the alternating trace of Frobenius on
the eÌtale cohomology of the fiber over x âˆˆ X(tÎ» ) with coefficients in the sheaf D.

  Given a coweight Î» for an arbitrary root system, let Î»d denote the dominant coweight in its Weyl-orbit.
We remark that there is a similar formula for Î˜âˆ’
                                               Î» , provided that Î»d is a sum of minuscule dominant coweights.


                                                        2
2       Preliminaries
2.1     Affine Weyl group
Let (X âˆ— , Xâˆ— , R, RÌŒ, Î ) be a root system, where Î  is the set of simple roots. The Weyl group W0 is generated
by the set of simple reflections {sÎ± : Î± âˆˆ Î }.
    We define a partial order  on Xâˆ— (resp. X âˆ— ) by setting Î»  Âµ whenever Âµ âˆ’ Î» is a linear combination
with nonnegative integer coefficients of elements of {Î±ÌŒ : Î± âˆˆ Î } (resp. {Î± : Î± âˆˆ Î }). We let Î m denote the
set of roots Î² âˆˆ R such that Î² is a minimal element of R âŠ‚ X âˆ— with respect to .
    In section 4 we will use the following description of the relation  for coweights of GLn : (Î»1 , . . . , Î»n ) 
(Âµ1 , . . . Âµn ) if and only if Î»1 + Â· Â· Â· + Î»i â‰¤ Âµ1 + Â· Â· Â· + Âµi for 1 â‰¤ i â‰¤ n âˆ’ 1, and Î»1 + Â· Â· Â· + Î»n = Âµ1 + Â· Â· Â· + Âµn .
    Let W   f be the semidirect product Xâˆ— â‹Š W0 = {tx w : w âˆˆ W0 , x âˆˆ Xâˆ— }, with multiplication given by
tx wtxâ€² wâ€² = tx+w(xâ€² ) wwâ€² . For any x âˆˆ W        f , there exists a unique expression tÎ»(x) w, where w âˆˆ W0 and
Î»(x) âˆˆ Xâˆ— .
    Let
                                       Sa = {sÎ± : Î± âˆˆ Î } âˆª {tâˆ’Î±ÌŒ sÎ± : Î± âˆˆ Î m } âŠ‚ W   f.
                  f â†’ Z by
Define length l : W
                                            X                                    X
                          l(tx w) =                       |hÎ±, xi âˆ’ 1| +                       |hÎ±, xi|.
                                      Î±âˆˆR+ :w âˆ’1 (Î±)âˆˆRâˆ’                    Î±âˆˆR+ :w âˆ’1 (Î±)âˆˆR+

                                                                           f is a Coxeter group with Sa
Let QÌŒ be the subgroup of Xâˆ— generated by RÌŒ. The subgroup Wa = QÌŒ â‹Š W0 of W
                                                                                       f : l(w) = 0}.
the set of simple reflections. The subgroup is normal and admits a complement â„¦ = {w âˆˆ W
    For w âˆˆ Wf denote Îµw = (âˆ’1)l(w) and qw = q l(w) (for q any parameter).
    The Coxeter group (Wa , Sa ) comes equipped with the Bruhat order â‰¤. We extend it to W f as follows:
                â€² â€²      â€²          â€²              â€²          â€²
we say wÏ„ â‰¤ w Ï„ (w, w âˆˆ Wa , Ï„, Ï„ âˆˆ â„¦) if w â‰¤ w and Ï„ = Ï„ .
    Let Âµ âˆˆ Xâˆ— be dominant. Following Kottwitz-Rapoport [10], we say x âˆˆ W f is Âµ-admissible if x â‰¤ tw(Âµ)
for some w âˆˆ W0 . We denote the set of Âµ-admissible elements by Adm(Âµ).

2.2     Hecke algebra
2.2.1    Presentations
                   f is the group generated by Tw (w âˆˆ W
The braid group of W                                   f ) with relations

                                Tw Twâ€² = Twwâ€²         whenever l(wwâ€² ) = l(w) + l(wâ€² ).

The Hecke algebra H is defined to be the quotient of the group algebra (over Z[q 1/2 , q âˆ’1/2 ]) of the braid
         f , by the two-sided ideal generated by the elements
group of W

                                                    (Ts + 1)(Ts âˆ’ q),

for s âˆˆ Sa . The image of Tw in H is again denoted by Tw . It is known that the elements Tw (w âˆˆ W   f ) form
      1/2 âˆ’1/2
a Z[q , q      ]-basis for H. The presentation of H using the generators Tw and the above relations is called
the Iwahori-Matsumoto presentation.
    For any Tw , define a renormalization TÌƒw = q âˆ’l(w)/2 Tw . Define an indeterminate Q = q âˆ’1/2 âˆ’ q 1/2 . The
elements TÌƒw form a basis for H, and the usual relations can be written as
                                         
                                           TÌƒsw ,          if l(sw) = l(w) + 1,
                               TÌƒs TÌƒw =
                                           âˆ’QTÌƒw + TÌƒsw , if l(sw) = l(w) âˆ’ 1,

        f and s âˆˆ Sa . There is also a right-handed version of this relation. Note that TÌƒ âˆ’1 = TÌƒs + Q.
for w âˆˆ W                                                                                 s
    We will denote TÌƒtÎ» (Î» âˆˆ Xâˆ— ) simply by TÌƒÎ» .
    For Î» âˆˆ Xâˆ— , define
                                                  Î˜Î» = TÌƒÎ»1 TÌƒÎ»âˆ’1
                                                                2




                                                               3
where Î» = Î»1 âˆ’ Î»2 , and Î»1 , Î»2 are dominant. The elements Î˜Î» generate a commutative subalgebra of H.
It is known that the elements Î˜Î» Tw (Î» âˆˆ Xâˆ— , w âˆˆ W0 ) form a Z[q 1/2 , q âˆ’1/2 ]-basis for H. These generators
satisfy well-known relations (see Prop. 3.6, [14]); in case the root system is simply connected, these are given
by the formula
                                                                 Î˜Î» âˆ’ Î˜s(Î»)
                                    Î˜Î» Ts âˆ’ Ts Î˜s(Î») = (q âˆ’ 1)              ,
                                                                  1 âˆ’ Î˜âˆ’Î±ÌŒ
where s = sÎ± and Î± âˆˆ Î . The presentation of H with generators Î˜Î» Tw and the above relations is called the
Bernstein presentation.
   We also define
                                            Î˜âˆ’           âˆ’1
                                              Î» = TÌƒÎ»1 TÌƒÎ»â€²
                                                     â€²
                                                                      2

where Î» =   Î»â€²1
             âˆ’    Î»â€²2 ,
                   and        Î»â€²1 , Î»â€²2
                             are antidominant.
   The involution a â†’ a of Z[q 1/2 , q âˆ’1/2 ] determined by q 7â†’ q âˆ’1 extends to an involution h â†’ h, given by
                                                X              X
                                                    aw T w =        aÌ„w Twâˆ’1
                                                                           âˆ’1 .



    It is immediate that Î˜Î» = Î˜âˆ’ Î» . Clearly the Bernstein presentation gives rise to an analogous presentation
using the generators Î˜âˆ’ Î» Tw in place of Î˜Î» Tw .


2.2.2     Bernstein functions
For each W0 -orbit M in Xâˆ— , define the Bernstein function zM attached to M by
                                                     X
                                              zM =       Î˜Î» .
                                                             Î»âˆˆM

When the W0 -orbit M contains the dominant element Âµ, this function is denoted by zÂµ .
  From Corollary 8.8 of Lusztig [12], we have zÂµ = z Âµ . Consequently,
                                                   X
                                            zÂµ =          Î˜âˆ’
                                                           Î».
                                                          Î»âˆˆW0 (Âµ)


2.2.3     A support property
The preceding formula implies that when one studies Bernstein functions there is no harm in working with
the functions Î˜âˆ’Î» instead of the functions Î˜Î» . We do so in this paper because their supports enjoy a nice
regularity property, given by the following lemma.

Lemma 2.1 For Î» âˆˆ Xâˆ— , we have

                                             supp(Î˜âˆ’
                                                   Î» ) âŠ‚ {x : Î»(x)  Î»}.

Proof. Write                                              X
                                                  Î˜âˆ’
                                                   Î» =           ay (Q)TÌƒy ,
                                                          yâ‰¤tÎ»

where ay (Q) âˆˆ Z+ [Q] (see Lemma 5.1 and Corollary 5.7 of [4]).
   Choose a dominant coweight Âµâ€² such that Âµâ€² + Î»(x) is also dominant for any x in the support of Î˜âˆ’
                                                                                                   Î».
Thus we have                                                X
                               âˆ’1          âˆ’        âˆ’ âˆ’                 âˆ’1
                             TÌƒâˆ’(Âµâ€² +Î») = Î˜Âµâ€² +Î» = Î˜Âµâ€² Î˜Î» =     ay (Q)TÌƒâˆ’Âµâ€² TÌƒy .

                                                                          y

Let y âˆˆ   supp(Î˜âˆ’
                Î» ).
                                                                          âˆ’1
                          We claim that tÂµâ€² y belongs to the support of TÌƒâˆ’Âµâ€² TÌƒy . Indeed, under the specialization

map H â†’ Z[W  f ] determined by q 1/2 7â†’ 1, the element TÌƒ âˆ’1â€² TÌƒy maps to tÂµâ€² y. Since no cancellation occurs on
                                                         âˆ’Âµ
                                                                  âˆ’1
the right hand side above, we see from this that tÂµâ€² y âˆˆ supp(TÌƒâˆ’(Âµ  â€² +Î») ), and thus


                                               tÂµâ€² +Î»(y) wy = tÂµâ€² y â‰¤ tÂµâ€² +Î» ,

                                                             4
where y = tÎ»(y) wy . Since Âµâ€² + Î»(y) and Âµâ€² + Î» are both dominant, it is well-known that this implies
Âµâ€² + Î»(y)  Âµâ€² + Î». The lemma follows.

    In the case where Î» is minuscule, this statement can be considerably sharpened; see Corollary 3.5.
    We remark that Lemma 2.1 plays a key role in the proof of Theorem 4.1.

2.2.4    R-polynomials
            f , let y = s1 Â· Â· Â· sr Ï„ (si âˆˆ Sa , Ï„ âˆˆ â„¦) be a reduced expression for y. Then for any x, we can
For any y âˆˆ W
write                                                 X
                                             TÌƒyâˆ’1
                                                 âˆ’1 =     Rex,y (Q)TÌƒx .
                                                         f
                                                       xâˆˆW

where Rex,y (Q) âˆˆ Z[q 1/2 , q âˆ’1/2 ]. These coefficients R
                                                         ex,y (Q) can be thought of as polynomial expressions in
Q (as the notation suggests) because of the identity

                                        TÌƒyâˆ’1
                                           âˆ’1 = (TÌƒs1 + Q) Â· Â· Â· (TÌƒsr + Q)TÌƒÏ„ .




3       The minuscule case
We say Î» âˆˆ Xâˆ— is minuscule if hÎ±, Î»i âˆˆ {0, Â±1}, for every root Î± âˆˆ R. Such coweights are the concern of this
section.
    The purpose of this section is to present an analogue of Proposition 4.4 from [5] using Î˜âˆ’   Î» instead of
Î˜Î» . For simplicity, the theorem is given here for affine Hecke algebras with trivial parameter systems. The
generalization to arbitrary parameter systems is straightforward (see [5] for notation and details). Similar
arguments to those appearing here apply to Î˜Î» , giving a short proof of Proposition 4.4 from [5].

Theorem 3.1 Let Âµâˆ’ be minuscule and antidominant, and Î» âˆˆ W0 (Âµâˆ’ ). Then
                                           X
                                  Î˜âˆ’              ex,t (Q)TÌƒx .
                                    Î» =          R    Î»
                                                   x : Î»(x)=Î»


   We begin with some lemmas. For a proof of the first lemma, refer to Proposition 3.4 of [5], where a
similar result is given (see also the proof of Corollary 6.6).

Lemma 3.2 Let Âµâˆ’ be an antidominant and minuscule coweight, and let Ï„ âˆˆ â„¦ be the unique element such
that tÂµâˆ’ âˆˆ Wa Ï„ . Let Î» âˆˆ W0 (Âµâˆ’ ). Suppose that Î» âˆ’ Âµâˆ’ is a sum of p simple coroots (0 â‰¤ p â‰¤ l(tÂµâˆ’ ) = r).
Then there exists a sequence of simple roots Î±1 , . . . , Î±p such that the following hold (setting si = sÎ±i ):
(1) hÎ±i , siâˆ’1 Â· Â· Â· s1 (Âµâˆ’ )i = âˆ’1, âˆ€1 â‰¤ i â‰¤ p;
(2) there is a reduced expression for tÂµâˆ’ of the form tÂµâˆ’ = s1 Â· Â· Â· sp t1 Â· Â· Â· trâˆ’p Ï„ ;
(3) there is a reduced expression for tÎ» of the form tÎ» = t1 Â· Â· Â· trâˆ’p (Ï„s1 ) Â· Â· Â· (Ï„sp )Ï„ ;
(4) Î˜âˆ’                        âˆ’1          âˆ’1
      Î» = TÌƒt1 Â· Â· Â· TÌƒtrâˆ’p TÌƒÏ„s1 Â· Â· Â· TÌƒÏ„sp TÌƒÏ„ ,
where tj âˆˆ Sa , âˆ€j âˆˆ {1, . . . , r âˆ’ p}.


                  f , and suppose that xsÎ± > x for all Î± âˆˆ Î . Then l(xw) = l(x) + l(w) for all w âˆˆ W0 .
Lemma 3.3 Let x âˆˆ W

Since Âµâˆ’ is antidominant, this lemma applies to the expression tÂµâˆ’ = s1 Â· Â· Â· sp t1 Â· Â· Â· trâˆ’p Ï„ . It then applies to
the expression t1 Â· Â· Â· trâˆ’p Ï„ as well. It follows that we can think of the formula in Lemma 3.2(4) as

                                        Î˜âˆ’           âˆ’1         âˆ’1           âˆ’1
                                         Î» = TÌƒw Î» TÌƒs1 Â· Â· Â· TÌƒsp = TÌƒw Î» TÌƒw âˆ’1

where tÎ» = wÎ» w, with w âˆˆ W0 and wÎ» the minimal length representative for the coset tÎ» W0 . This observation
is helpful towards proving the main result of this section.


                                                           5
Lemma 3.4 For Î», s1 , . . . , sp , and t1 , . . . , trâˆ’p as in Lemma 3.2, the mapping

                            {y : y â‰¤ s1 Â· Â· Â· sp } âˆ’â†’ {x : Î»(x) = Î» and x â‰¤ tÎ» }

defined by
                                           y 7â†’ t1 Â· Â· Â· trâˆ’p Ï„ y = wÎ» y
is bijective.

 Proof of Theorem 3.1.     Let w = s1 Â· Â· Â· sp , and wÎ» = t1 Â· Â· Â· trâˆ’p Ï„ , so that tÂµâˆ’ = wwÎ» and tÎ» = wÎ» w. We
have                                                       X
                                      TÌƒsâˆ’1  Â· Â· Â· TÌƒsâˆ’1 =       ey,w (Q)TÌƒy
                                                                 R
                                          1           p
                                                       y : yâ‰¤w

The expression for Î˜âˆ’  Î» of Lemma 3.2, together with the fact that TÌƒw Î» TÌƒy = TÌƒw Î» y for all y âˆˆ W0 (since
l(wÎ» y) = l(wÎ» ) + l(y)), implies             X
                                       Î˜âˆ’           ey,w (Q)TÌƒwÎ» y .
                                         Î» =        R
                                                 y : yâ‰¤w

                                                                 ey,w (Q) = R
Using the recursion formula of Lemma 2.5 (1) from [5], we obtain R           ewÎ» y,t (Q). In view of the
                                                                                    Î»
bijection given in Lemma 3.4, we have
                               X                        X
                                    ewÎ» y,t (Q)TÌƒwÎ» y =
                                    R                          ex,t (Q)TÌƒx ,
                                                               R
                                           Î»                       Î»
                               y : yâ‰¤w                      x : Î»(x)=Î»

which completes the proof.

    For the minuscule case, Theorem 3.1 yields the following improvement on Lemma 2.1.

Corollary 3.5 Let Î» âˆˆ Xâˆ— be minuscule. Then

                                   supp(Î˜âˆ’
                                         Î» ) = {x : Î»(x) = Î» and x â‰¤ tÎ» }.

Here we have used Lemma 2.5 (5) of [5], which asserts that RÌƒx,y (Q) 6= 0 if and only if x â‰¤ y.
   The Bernstein function zÂµ has a very simple form when Âµ is minuscule (cf. Theorem 4.3 of [5]):

Corollary 3.6 If Âµ is dominant and minuscule, then
                                            X
                                    zÂµ =           RÌƒx,tÎ»(x) (Q)TÌƒx .
                                               xâˆˆAdm(Âµ)



4     Multiples of the Drinfeld case
Fix positive integers n and m, and an integer 1 â‰¤ k â‰¤ n. In this section, we establish in Theorem 4.1
a formula for the Î˜âˆ’ Î» functions of GLn when Î» = mek (where ek denotes the coweight of GLn with kth
coordinate equal to 1, and all other coordinates equal to 0).
    In this section, we adopt the following notation: for 1 â‰¤ i â‰¤ n âˆ’ 1, let Î±i = Î±ÌŒi = ei âˆ’ ei+1 , and let
si = sÎ±i . We single out the element Ï„ âˆˆ â„¦ given by Ï„ = t(1,0,...,0) s1 Â· Â· Â· snâˆ’1 .

Theorem 4.1 For the coweight mek of GLn , we have
                                            X
                               Î˜âˆ’mek =
                                                              ex,tme (Q)TÌƒx .
                                                              R     k
                                               x : Î»(x)mek




                                                        6
   Consequently, we have a result for mek analogous to that of Corollary 3.5 for Î» minuscule, that is,

                                 supp(Î˜âˆ’
                                       mek ) = {x : Î»(x)  mek and x â‰¤ tmek }.

We also get the following explicit formula for the Bernstein function zme1 , analogous to Corollary 3.6:

Corollary 4.2                                              ï£«                              ï£¶
                                                  X                 X
                                     zme1 =                ï£­                   RÌƒx,tÎ» (Q)ï£¸ TÌƒx ,
                                               xâˆˆAdm(Âµ)        Î»(x)Î» , xâ‰¤tÎ»

where the inner sum ranges over Î» âˆˆ W0 (me1 ) such that Î»(x)  Î» and x â‰¤ tÎ» .


Q We require three lemmas before the proof of the theorem. In the following arguments we use the notation
   to denoteQproducts even though we are working in a non-commutative ring. We will use the following
convention: ni=1 ai will denote the product a1 a2 Â· Â· Â· an (in that order).

Lemma 4.3 For the coweight mek of GLn , we have

                                         Î˜âˆ’                              âˆ’1           âˆ’1 m
                                          mek = (TÌƒskâˆ’1 Â· Â· Â· TÌƒs1 TÌƒÏ„ TÌƒsnâˆ’1 Â· Â· Â· TÌƒsk ) .

Proof. From Lemma 3.2, we have

                                            Î˜âˆ’                            âˆ’1           âˆ’1
                                             ek = TÌƒskâˆ’1 Â· Â· Â· TÌƒs1 TÌƒÏ„ TÌƒsnâˆ’1 Â· Â· Â· TÌƒsk .

                                                      âˆ’
Then the formula for Î˜âˆ’                                         âˆ’ âˆ’
                      mek follows from the fact that Î˜Î½1 +Î½2 = Î˜Î½1 Î˜Î½2 for all Î½1 , Î½2 âˆˆ Xâˆ— .



Lemma 4.4 Let w, y âˆˆ WÌƒ . Then                                     X
                                                       TÌƒw TÌƒy =          ax TÌƒx
                                                                   x=we
                                                                     ey

where w
      e and ye range over certain subexpressions of w and y, respectively.

Proof. This is an easy induction on the length of y.


Lemma 4.5 Let x be a subexpression of

                                             tmek = (skâˆ’1 Â· Â· Â· s1 Ï„ snâˆ’1 Â· Â· Â· sk )m

such that for some 1 â‰¤ i â‰¤ k âˆ’ 1, at least one si is deleted. Then Î»(x)  mek .

Proof. We can write
                                                     x = u1 Ï„ v1 Â· Â· Â· um Ï„ vm
for suitable subexpressions u1 , . . . , um and v1 , . . . , vm of skâˆ’1 Â· Â· Â· s1 and snâˆ’1 Â· Â· Â· sk , respectively. Suppose
that p is the least index such that up 6= skâˆ’1 Â· Â· Â· s1 . Then
                                pâˆ’1
                                 Y                                                     Y
                                                                                         m        
                          x=            tek sk Â· Â· Â· snâˆ’1 vi (tej up s1 Â· Â· Â· snâˆ’1 vp )    ui Ï„ vi ,
                                 i=1                                                      i=p+1

for some j with 1 â‰¤ j < k. Since sk Â· Â· Â· snâˆ’1 v(ej ) = ej for any subexpression v of snâˆ’1 Â· Â· Â· sk ,
                             pâˆ’1
                              Y                                 pâˆ’1
                                                                  Y                        âˆ’1
                                     tek sk Â· Â· Â· snâˆ’1 vi (tej )      tek sk Â· Â· Â· snâˆ’1 vi     = tej .
                               i=1                                 i=1



                                                                   7
It follows that the translation part Î»(x) is the sum of ej and a non-negative integral linear combination of
vectors ei (i = 1, . . . , n). Indeed, the translation part of
                              pâˆ’1
                               Y                                                Y
                                                                                  m         
                                     tek sk Â· Â· Â· snâˆ’1 vi (up s1 Â· Â· Â· snâˆ’1 vp )    ui Ï„ vi
                               i=1                                                          i=p+1

is necessarily a vector (b1 , . . . , bn ) where bi âˆˆ Z+ for every i.
    We thus see that one of the first k âˆ’ 1 coordinates of Î»(x) is positive (namely the j-th coordinate is),
and this implies that Î»(x)  mek .

 Proof of Theorem 4.1. Let E = ({0, 1}nâˆ’1)m âˆ’ ({1}kâˆ’1 Ã— {0, 1}nâˆ’k )m . Using TÌƒsâˆ’1 = TÌƒs + Q and expanding
the left hand side, we can write
                                        X                          m
                                                                   Y
                     âˆ’1                                                       Ç«i           Ç«i     Ç«i            Ç«i
                   TÌƒâˆ’mek
                          = Î˜âˆ’
                             mek +            Qm(nâˆ’1)âˆ’Ïƒ(Ç«)                  kâˆ’1
                                                                         TÌƒskâˆ’1                    nâˆ’1
                                                                                Â· Â· Â· TÌƒs11 TÌƒÏ„ TÌƒsnâˆ’1 Â· Â· Â· TÌƒskk .   (1)
                                        Ç«âˆˆE                        i=1

Here Ç«ij âˆˆ {0, 1} and we denote Ç« = (Ç«1 , . . . , Ç«m ), and Ç«i = (Ç«i1 , . . . , Ç«inâˆ’1 ), i = 1, . . . , m, and Ïƒ(Ç«) =
Pm P     nâˆ’1 i
   i=1   j=1 Ç«j .
    From Lemma 2.1, we know that supp(Î˜âˆ’        mek ) âŠ‚ {x : Î»(x)  mek }. Thus we need only prove that if TÌƒx
is in the support of the second term on the right hand side, then Î»(x)  mek . Indeed, then the first and
second terms on the right hand side of (1) have disjoint supports, and so the coefficients of like terms will
              âˆ’1
be equal in TÌƒâˆ’me   k
                       and Î˜âˆ’  mek .
    Let Ç« = (Ç« , . . . , Ç«m ) âˆˆ E, and consider
              1


                                           m
                                           Y        Ç«i
                                                    kâˆ’1          Ç«i        Ç«i
                                                                           nâˆ’1             Ç«i
                                                 TÌƒskâˆ’1 Â· Â· Â· TÌƒs11 TÌƒÏ„ TÌƒsnâˆ’1 Â· Â· Â· TÌƒskk .
                                           i=1

By Lemma 4.4, if x is in the support of this product, then x is a subexpression of
                                              m
                                              Y      Ç«i
                                                      kâˆ’1         Ç«i     Ç«i
                                                                        nâˆ’1           Ç«i
                                                    skâˆ’1  Â· Â· Â· s11 Ï„ snâˆ’1  Â· Â· Â· skk .
                                              i=1

Since E excludes the elements of ({1}kâˆ’1 Ã— {0, 1}nâˆ’k )m , we know that for some 1 â‰¤ i â‰¤ m and 1 â‰¤ j â‰¤ k âˆ’ 1,
that Ç«ij = 0. But this is equivalent to the deletion of some sj (1 â‰¤ j â‰¤ k âˆ’ 1) from the expression
tmek = (skâˆ’1 Â· Â· Â· s1 Ï„ snâˆ’1 Â· Â· Â· sk )m . By Lemma 4.5, we have Î»(x)  mek , and the proof is complete.



5     Minimal expressions
We say Î˜âˆ’
        Î» has a minimal expression if it can be written in the form

                                                            Ç«1         Ç«r
                                                     Î˜âˆ’
                                                      Î» = TÌƒt1 Â· Â· Â· TÌƒtr TÌƒÏ„ ,

where tÎ» = t1 Â· Â· Â· tr Ï„ (ti âˆˆ Sa , Ï„ âˆˆ â„¦) is a reduced expression and Ç«i âˆˆ {1, âˆ’1} for every 1 â‰¤ i â‰¤ r. Such
expressions played a key role in Theorems 3.1 and 4.1.
   Lemma 3.2 asserts that Î˜âˆ’     Î» has a minimal expression whenever Î» is minuscule. If Î» is any coweight for
GLn , then we may write
                                                  Î» = Î»1 + Â· Â· Â· + Î»k
where each Î»j is minuscule and
                                              l(tÎ» ) = l(tÎ»1 ) + Â· Â· Â· + l(tÎ»k ).




                                                                   8
It follows that for any coweight Î» of GLn , there is a minimal expression for Î˜âˆ’
                                                                               Î» . Letting w
                                                                                             Î»i
                                                                                                denote the
                                                                         Î»i
minimal representative for the coset tÎ»i W0 and writing tÎ»i = w wi (wi âˆˆ W0 ), we may recover a minimal
expression for
                                       Î˜âˆ’             âˆ’1                  âˆ’1
                                         Î» = TÌƒw Î»1 TÌƒw âˆ’1 Â· Â· Â· TÌƒw Î»k TÌƒw âˆ’1
                                                            1              k

by choosing reduced expressions for every wÎ»i and wi .
    Clearly a similar result would follow for any root system with the property that Î˜âˆ’  Ï‰ has a minimal expres-
sion for every Weyl conjugate Ï‰ of every fundamental coweight. It seems to be an interesting combinatorial
problem to determine the root systems (besides that for GLn ) which satisfy this property.
    In principle, a minimal expression for Î˜âˆ’  Î» allows one to write it as an explicit linear combination of the
Iwahori-Matsumoto generators Tw , simply by using the formula TÌƒsâˆ’1 = TÌƒs + Q and expanding the product.
The result is a linear combination of certain products

                                                     Ts1 Â· Â· Â· Tsg TÏƒ

(si âˆˆ Sa , Ïƒ âˆˆ â„¦), where s1 Â· Â· Â· sg Ïƒ ranges over certain subexpressions of tÎ» (which subexpressions occur is
governed by the signs Ç«j in the minimal expression). These may in turn be simplified by using the well-known
formula                                                   X
                                          Ts1 Â· Â· Â· Tsg =   N (s, w, q)Tw ,
                                                           w

(cf. [11], Lemma 3.7). Here s = (s1 , . . . , sg ) and N (s, w, q) is the number of Fq -rational points on the variety
Z(s, w) consisting of all sequences (I1 , . . . , Ig ) where the Ii are Iwahori subgroups of Gsc (FÌ„q ((t))) (here Gsc is
the simply connected group associated to the given root system) such that the relative positions of adjacent
subgroups satisfy
                                                      inv(Iiâˆ’1 , Ii ) = si
for all 1 â‰¤ i â‰¤ g, and Ig = wI0 wâˆ’1 , where I0 is a fixed â€œstandardâ€ Iwahori subgroup.
    We forgo the cumbersome task of describing more completely the resulting expressions for Î˜âˆ’
                                                                                              Î» in terms of
the generators Tw . The combinatorics are best described in the geometric framework of Demazure resolutions.
We explain this in the following section.
Remark. Let Î» be a coweight for GLn , and write Î» = m1 e1 + Â· Â· Â· + mn en . One finds a similar expression for
Î˜âˆ’
 Î» starting from
                                        Î˜âˆ’       âˆ’          âˆ’
                                          Î» = Î˜m1 e1 Â· Â· Â· Î˜mn en ,

and making use of Theorem 4.1.


6     Sheaf-theoretic meaning of minimal expressions
The goal of this section is to describe a sheaf-theoretic interpretation of a minimal expression for Î˜âˆ’Î» : the
corresponding perverse sheaf on the affine flag variety is the push-forward of an explicit perverse sheaf on a
Demazure resolution of the Schubert variety X(tÎ» ). We proceed to illustrate this statement in more detail.

6.1    Affine flag variety
Let k = Fq denote the finite field with q elements, and let kÌ„ denote an algebraic closure of k. Let G be the
split connected reductive group over k whose root system is (X âˆ— , Xâˆ— , R, RÌŒ, Î ). Choose a split torus T and
a k-rational Borel subgroup B containing T , which give rise to R and Î .
    Denote by F l the affine flag variety for G. This is an ind-scheme over k whose k-points are given by

                                                 F l(k) = G(k((t)))/Ik ,

where I = Ik âŠ‚ G(k[[t]]) is the Iwahori subgroup whose reduction modulo t is B.
                                                               âˆš
    Fix a prime â„“ 6= char(k), and make a fixed choice for q âˆˆ QÌ„â„“ (for Tate twists).
    Let Db (F l) denote the category Dcb (F l, QÌ„â„“ ). By definition Dcb (F l, QÌ„â„“ ) is the inductive 2-limit of categories
 b
Dc (X, QÌ„â„“ ) where X âŠ‚ F l ranges over all projective k-schemes which are closed subfunctors of the ind-scheme

                                                            9
F l. The category Dcb (X, Qâ„“ ) is the â€œderivedâ€ category of Deligne [3]: Qâ„“ âŠ— the projective 2-limit of the
               b
categories Dctf  (X, Z/â„“n Z). For any finite extension E of Qâ„“ contained in QÌ„â„“ , the definition of Dcb (X, E) is
similar, and by definition Dcb (X, QÌ„â„“ ) is the inductive 2-limit of the categories Dcb (X, E).
     For f : X â†’ Y a morphism of finite-type k-schemes, we have the four â€œderivedâ€ functors fâˆ— , f! :
Dcb (X, QÌ„â„“ ) â†’ Dcb (Y, QÌ„â„“ ) and f âˆ— , f ! : Dcb (Y, QÌ„â„“ ) â†’ Dcb (X, QÌ„â„“ ). This notation should cause no confusion, since
we never use the non-derived versions of the pull-back and push-forward functors in this paper.
     We define the category PI (F l): it is the full subcategory of Db (F l) whose objects are I-equivariant
perverse sheaves for the middle perversity (by definition the latter have finite dimensional support).
     The I-orbits on F l correspond to W         f . Given w âˆˆ W    f , we denote by Y (w) = IwI/I the corresponding
Bruhat cell, and we denote its closure by X(w) = Y (w). Further, let QÌ„â„“,w denote the constant sheaf on
Y (w), and define Aw = QÌ„â„“,w [l(w)](l(w)/2). This is a self-dual perverse sheaf on Y (w).
     Let jw : Y (w) Ö’â†’ X(w) denote the open immersion. We define Jwâˆ— = jwâˆ— Aw and Jw! = jw! Aw . These
are perverse sheaves in PI (F l) satisfying D(Jwâˆ— ) = Jw! . (Here D denotes Verdier duality.)
     Given G âˆˆ PI (F l) we may define the corresponding function [G] on F l(k), which we may identify with
an element in H:
                                                       [G](x) = Tr(Frq , Gx ),
where Frq denotes the Frobenius morphism on F lkÌ„ (raising coordinates to power q). We have
                                                               âˆ’1/2
                                                  [Jw! ] = Îµw qw    Tw
                                                              1/2 âˆ’1
                                                 [Jwâˆ— ] = Îµw qw  Twâˆ’1 .

6.2     Convolution of sheaves
Following Lusztig [15], one can define a convolution product â‹† : PI (F l) Ã— PI (F l) â†’ Db (F l). We formulate
this in a way similar to [6]. Given Gi âˆˆ PI (F l), i = 1, 2, we can choose X(wi ) such that the support of Gi
is contained in X(wi ), for i = 1, 2. We may identify F l with the space of all â€œaffine flagsâ€ L for G(k((t)));
there is a base point L0 whose stabilizer in G(k((t))) is the â€œstandardâ€ Iwahori subgroup I. Then X(w) is
identified with the space of all affine flags L such that the relative position between the base point L0 and
L satisfies
                                                 inv(L0 , L) â‰¤ w
                       f . The â€œtwistedâ€ product X(w1 )Ã—X(w
in the Bruhat order on W                               Ëœ                                  â€²
                                                           2 ) is the space of pairs (L, L ) âˆˆ F l Ã— F l
such that

                                                    inv(L0 , L) â‰¤ w1
                                                    inv(L, Lâ€² ) â‰¤ w2 .
                                                                                                          Ëœ
We can find a finite-dimensional projective subvariety X âŠ‚ F l with the property that (L, Lâ€² ) âˆˆ X(w1 )Ã—X(w     2) â‡’
Lâ€² âˆˆ X. The â€œmultiplicationâ€ map m : X(w1 )Ã—X(w  Ëœ    2 ) â†’ X  given  by (L, Lâ€²
                                                                                ) â†’
                                                                                  7 Lâ€²
                                                                                       is proper.
    Now Gi (i = 1, 2) determine a well-defined perverse sheaf G1 âŠ G  Ëœ 2 on X(w1 )Ã—X(w
                                                                                    Ëœ      2 ) (see e.g. [6]). We
define
                                                              Ëœ 2 ).
                                             G1 â‹† G2 = mâˆ— (G1 âŠ G
The convolution G1 â‹† G2 âˆˆ Db (F l) is independent of the choice of X(wi ) and X.
    The object G1 â‹† G2 is I-equivariant in a suitable sense, so that we can regard its function Tr(Frq , G1 â‹† G2 )
as an element of the Hecke algebra H.
    It is well-known that this product is compatible with the function-sheaf dictionary:

                                                 [G1 â‹† G2 ] = [G1 ] â‹† [G2 ].

Here â‹† on the right hand side is just the usual product in H.
    Later we shall use the following fact, referred to in the sequel simply as associativity: if Gi (i = 1, 2, 3)
are objects of PI (F l) such that G1 â‹† G2 âˆˆ PI (F l) and G2 â‹† G3 âˆˆ PI (F l), then there is a canonical isomorphism
G1 â‹† (G2 â‹† G3 )â†’(G
               Ëœ 1 â‹† G2 ) â‹† G3 (the â€œassociativity constraintâ€). This is proved by identifying each canonically
with the â€œtriple productâ€ G1 â‹† G2 â‹† G3 , whose construction is similar (see section 6.3).

                                                             10
6.3    Demazure resolution vs. twisted product
It is clear that we can define in a similar way the k-fold convolution product â‹† : PI (F l)k â†’ Db (F l). To do
this we define the k-fold twisted product X(w1 )Ã— Ëœ Â· Â· Â· Ã—X(w
                                                          Ëœ    k ) to be the space of k-tuples (L1 , . . . , Lk ) such
that
                                              inv(Liâˆ’1 , Li ) â‰¤ wi
                                             P
for 1 â‰¤ i â‰¤ k. If w = w1 Â· Â· Â· wk and l(w) = i l(wi ), then the multiplication map

                                                    Ëœ Â· Â· Â· Ã—X(w
                                          m : X(w1 )Ã—       Ëœ   k ) âˆ’â†’ X(w)

given by (L1 , . . . , Lk ) 7â†’ Lk induces an isomorphism on open subschemes

                                                      Ëœ Â· Â· Â· Ã—Y
                                           m : Y (w1 )Ã—       Ëœ (wk )âˆ’â†’Y
                                                                      Ëœ (w).

If moreover each wi is a simple reflection si , then the twisted product is smooth, since it is a succession of
P1 -bundles. We have proved the following lemma.

Lemma 6.1 If w = s1 Â· Â· Â· sr is a reduced expression, then the twisted product

                                                     Ëœ Â· Â· Â· Ã—X(s
                                           m : X(s1 )Ã—       Ëœ    r ) âˆ’â†’ X(w)

is a Demazure resolution for the Schubert variety X(w).

   We use the k-fold twisted product to define the k-fold convolution product: as before, the objects
                                                                         Ëœ Â· Â· Â· âŠ G
Gi âˆˆ PI (F l) determine a (unique, perverse) twisted exterior product G1 âŠ        Ëœ k , and we set

                                                                     Ëœ Â· Â· Â· âŠ G
                                            G1 â‹† Â· Â· Â· â‹† Gk = mâˆ— (G1 âŠ        Ëœ k ).

   We have the following generalized associativity constraint. Consider a product with k terms

                                (Â· Â· Â· (G1 â‹† (Â· Â· Â· â‹† Gi )) Â· Â· Â· ) â‹† (Â· Â· Â· (Gj â‹† (Â· Â· Â· â‹† Gk )) Â· Â· Â· )

where the placement of the parentheses is arbitrary with the proviso that the product is defined (i.e., at
every stage we convolve objects of PI (F l)). Then this can be identified canonically with the k-fold product

                                                           G1 â‹† Â· Â· Â· â‹† Gk .

This can be seen easily by induction on k.

6.4    Properties of certain convolutions
The convolution of two I-equivariant perverse sheaves on F l is not perverse in general. However, the following
result of I. Mirkovic (unpublished) shows this conclusion does hold in some important cases. We are grateful
to R. Bezrukavnikov, who communicated this result to the first author, and to I. Mirkovic, for his kind
permission to include the result in this paper.
   In the notation of [1], we let p Dâ‰¤0 (F l) (resp. p Dâ‰¥0 (F l)) denote the objects P âˆˆ Db (F l) whose perverse
cohomology sheaves vanish in degree â‰¥ 1 (resp. â‰¤ âˆ’1). Thus the perverse sheaves on F l are precisely the
objects in p Dâ‰¥0 (F l) âˆ© p Dâ‰¤0 (F l).

                                                                  f , we have
Proposition 6.2 (Mirkovic) (a) Let P âˆˆ PI (F l). Then for any w âˆˆ W
 (1) Jw! â‹† P and P â‹† Jw! belong to p Dâ‰¥0 (F l),
 (2) Jwâˆ— â‹† P and P â‹† Jwâˆ— belong to p Dâ‰¤0 (F l).
                                                                                     f.
(b) In particular, Jw1 âˆ— â‹† Jw2 ! and Jw1 ! â‹† Jw2 âˆ— are perverse, for every w1 , w2 âˆˆ W


                                                                  11
    Proof. (a),(1). We consider Jw! â‹† P . Suppose P is supported on X(wâ€² ) and recall that the convolution
is given by
                                                             Ëœ ),
                                           Jw! â‹† P = m! (Jw! âŠ P
              Ëœ
where m : X(w)Ã—X(w â€²
                     ) â†’ X is as in section 6.2 (note that m! = mâˆ— , since m is proper). We have
                                                               Ëœ )
                                        Jw! â‹† P = m! (jw! (Aw )âŠ P
                                                             Ëœ
                                                  = [m â—¦ (jw Ã—id)]       Ëœ
                                                                   ! (Aw âŠ P ).

                    Ëœ
Note that m â—¦ (jw Ã—id)           Ëœ
                          : Y (w)Ã—X(w  â€²                               Ëœ is perverse on its source. Therefore
                                         ) â†’ X is affine, and that Aw âŠ P
           p â‰¥0
Jw! â‹†P âˆˆ D (F l) follows from the following general fact (cf. [1], Thm. 4.1.1 and Cor. 4.1.2): If F : X â†’ Y
is an affine morphism, then Fâˆ— : Dcb (X) â†’ Dcb (Y ) (resp. F! ) preserves p Dâ‰¤0 (resp. p Dâ‰¥0 ).
    A similar argument gives P â‹† Jw! âˆˆ p Dâ‰¥0 (F l), once it is noted that m â—¦ (idÃ—jËœ w ) : X(wâ€² )Ã—Y
                                                                                                 Ëœ (w) â†’ X is
also an affine morphism.
    Part (a),(2) is similar, and part (b) is an immediate consequence of part (a).


   Now we let PI (F l) âˆ© Jwâˆ— PI (F l) (resp. PI (F l) âˆ© Jw! PI (F l)) denote the full subcategory of PI (F l) whose
objects are of the form Jwâˆ— â‹† P (resp. Jw! â‹† P) for some P âˆˆ PI (F l).

                          f , we have
Corollary 6.3 For any w âˆˆ W

                                         Jw! â‹† Jwâˆ’1 âˆ— = Jwâˆ’1 âˆ— â‹† Jw! = Je ,
          f is the identity element. Together with the associativity constraint, these identities imply that
where e âˆˆ W

                           Jw! â‹† âˆ’ : PI (F l) âˆ© Jwâˆ’1 âˆ— PI (F l) âˆ’â†’ PI (F l) âˆ© Jw! PI (F l)

is an equivalence of categories, with inverse Jwâˆ’1 âˆ— â‹† âˆ’.

    Proof. We prove that Jw! â‹† Jwâˆ’1 âˆ— = Je (the other equality is similar). Let X(y) be an irreducible
component in the support of P := Jw! â‹† Jwâˆ’1 âˆ— . Since P is perverse and I-equivariant, the restriction P |Y (y)
is an I-equivariant â„“-adic local system on the affine space Y (y). We need to show that y = e and P |Y (e) = QÌ„â„“ .
For the former it is sufficient to prove that y 6= e implies P |Y (y) = 0.
    Since P |Y (y) is an I-equivariant â„“-adic local system on the I-orbit Y (y), and the stabilizer in I of any
point in this orbit is geometrically connected, it follows that P |Y (y) is a constant local system (placed in
degree âˆ’l(y) when regarded as a complex). Write Î±1 , Î±2 , . . . , Î±r for the eigenvalues of Frq on P |Y (y)[âˆ’l(y)],
counted with multiplicity. We have the following identity for every n â‰¥ 1:
                                                                                                r
                                                                                                X
                  Je (y) = Tr(Frqn , Jw! ) â‹† Tr(Frqn , Jwâˆ’1 âˆ— )(y) = Tr(Frqn , P |Y (y)) = Ç«y         Î±ni .
                                                                                                i=1

We thus have, for every n â‰¥ 1:
                                                r
                                                                (
                                                X                   0, if y =
                                                                            6 e
                                           Ç«y         Î±ni   =
                                                i=1
                                                                    1, if y = e.

The linear independence of characters (or rather its proof) implies that distinct numbers Î² âˆˆ QÌ„Ã— â„“ determine
linearly independent characters n 7â†’ Î² n on the semi-group of positive integers. Together with the above
formula this is enough information to determine the eigenvalues of Frq on P |(Y (y) (if y 6= e then r = 0, and
if y = e then r = 1 and Î±1 = 1). Thus P |Y (y) = 0 if y 6= e and P |Y (e) = QÌ„â„“ , as desired.


   It is straightforward to check the following properties. From now on we omit the convolution sign â‹† in
the product of perverse sheaves.

                                                                12
Lemma 6.4          1. If l(xy) = l(x) + l(y), then Jx! Jy! = Jxy! .
   2. Under the same assumption, Jxâˆ— Jyâˆ— = Jxyâˆ— .

    Proof. The first can be checked from the definitions, and the second follows on applying Verdier duality.
We have used that Verdier duality is compatible with convolution: D(G1 â‹† G2 ) = DG1 â‹† DG2 , if Gi âˆˆ PI (F l)
(i = 1, 2).


Remark. We remark that Corollary 6.3 and Lemma 6.4 allow us to perform algebraic manipulations involving
the perverse sheaf Jw! (resp. Jwâˆ— ): essentially it behaves just like its function Îµw TÌƒw (resp. Îµw TÌƒwâˆ’1
                                                                                                        âˆ’1 ) (but

when multiplying sheaves, one has to take care that they are each perverse). For example, we have the
following cancellation property. Let Pi âˆˆ PI (F l) (i = 1, 2) be such that Jwâˆ— â‹† Pi âˆˆ PI (F l) (i = 1, 2); then
Jwâˆ— P1 âˆ¼= Jwâˆ— P2 implies P1 âˆ¼= P2 (multiply both sides by Jwâˆ’1 ! and use associativity). We shall use this
several times in the proof of Lemma 6.5 below.


6.5     Sheaf analogue Îžâˆ’
                        Î» of Î˜Î»
                              âˆ’

We now define the sheaf-analogue of Î˜âˆ’ Î» . We write JÎ»âˆ— (resp. JÎ»! ) in place of JtÎ» âˆ— (resp. JtÎ» ! ). If Î» = Î»1 âˆ’Î»2 ,
where Î»i is anti-dominant (i = 1, 2), then we define

                                                     Îžâˆ’
                                                      Î» = JÎ»1 ! Jâˆ’Î»2 âˆ— .

By Proposition 6.2, Îžâˆ’
                     Î» is an object of PI (F l). Moreover it clearly satisfies

                                                       [Îžâˆ’          âˆ’
                                                         Î» ] = ÎµÎ» Î˜ Î» .

By [4], we know that supp(Î˜âˆ’                                    âˆ’
                           Î» ) âŠ‚ {x | x â‰¤ tÎ» }, and hence that ÎžÎ» is supported on X(tÎ» ).

    Our next goal is to prove the sheaf-theoretic analogues of the relations in the Bernstein presentation of
H, in the following lemma. The proof follows Lemma 4.4 of [13] very closely, taking into account Proposition
6.2, Corollary 6.3 and Lemma 6.4. Since a little extra care must be taken in the present context of perverse
sheaves, we give detailed arguments for the convenience of the reader.

Lemma 6.5 (1) If x, y âˆˆ Wf commute and l(xy) = l(x) + l(y), then Jx! Jyâˆ’1 âˆ— = Jyâˆ’1 âˆ— Jx! . In particular, if
   Âµ, Î» âˆˆ Xâˆ— are both dominant or antidominant, then JÂµ! Jâˆ’Î»âˆ— = Jâˆ’Î»âˆ— JÂµ! .
 (2) Îžâˆ’
      Î» is independent of the choice of Î»i ( i = 1, 2 ).

 (3) Îžâˆ’  âˆ’    âˆ’
      Î» ÎžÂµ = ÎžÎ»+Âµ for Î», Âµ âˆˆ Xâˆ— .

 (4) If s = sÎ± (Î± âˆˆ Î ) and hÎ±, Î»i = 0, then

                                                        Jsâˆ— Îžâˆ’    âˆ’
                                                             Î» = ÎžÎ» Jsâˆ— .

      Moreover, this object belongs to PI (F l).
 (5) If hÎ±, Î»i = âˆ’1, then
                                                        Jsâˆ— Îžâˆ’        âˆ’
                                                             Î» Jsâˆ— = ÎžsÎ» .

   Proof. (1). By Lemma 6.4, we have Jx! Jy! = Jxy! = Jyx! = Jy! Jx! . The result follows by two applications
of Corollary 6.3: multiply first on the left and then on the right by Jyâˆ’1 âˆ— .
(2). Let Î» = Î»1 âˆ’ Î»2 = Î»â€²1 âˆ’ Î»â€²2 , where Î»i , Î»â€²i are antidominant (i = 1, 2). Then Î»â€²2 + Î»1 = Î»â€²1 + Î»2 , and
so JÎ»â€²2 ! JÎ»1 ! = JÎ»â€²1 ! JÎ»2 ! . Arguing as in (1), this yields JÎ»1 ! Jâˆ’Î»2 âˆ— = Jâˆ’Î»â€²2 âˆ— JÎ»â€²1 ! . Then (1) yields JÎ»1 ! Jâˆ’Î»2 âˆ— =
JÎ»â€²1 ! Jâˆ’Î»â€²2 âˆ— .



                                                             13
(3). Write Î» = Î»1 âˆ’ Î»2 and Âµ = Âµ1 âˆ’ Âµ2 , where Î»i , Âµi are antidominant (i = 1, 2). Then by associativity we
have
                                          Îžâˆ’  âˆ’
                                           Î» ÎžÂµ = (JÎ»1 ! Jâˆ’Î»2 âˆ— )(JÂµ1 ! Jâˆ’Âµ2 âˆ— )
                                                    = JÎ»1 ! (Jâˆ’Î»2 âˆ— JÂµ1 ! )Jâˆ’Âµ2 âˆ—
                                                    = JÎ»1 ! (JÂµ1 ! Jâˆ’Î»2 âˆ— )Jâˆ’Âµ2 âˆ—
                                                    = (JÎ»1 ! JÂµ1 ! )(Jâˆ’Î»2 âˆ— Jâˆ’Âµ2 âˆ— )
                                                    = J(Î»1 +Âµ1 )! Jâˆ’(Î»2 +Âµ2 )âˆ—
                                                    = Îžâˆ’
                                                       Î»+Âµ .

(4). We may write Î» = Î»1 âˆ’ Î»2 , where Î»i is antidominant and hÎ±, Î»i i = 0, for i = 1, 2. Since s commutes
with tÎ»i and l(stÎ»i ) = l(tÎ»i s) = l(tÎ»i ) + 1, the result follows from (1), Lemma 6.4, and associativity.
    We note that Jsâˆ— (JÎ»1 ! Jâˆ’Î»2 âˆ— ) = Jstâˆ’Î»2 âˆ— JtÎ»1 ! is I-equivariant and perverse, by Proposition 6.2.
(5). We may write Î» = Î»1 âˆ’ Î»2 , where Î»i is antidominant (i = 1, 2), hÎ±, Î»1 i = âˆ’1, and hÎ±, Î»2 i = 0.
    As in the proof of (4) above, we note that Jsâˆ— (JÎ»1 ! Jâˆ’Î»2 âˆ— ) and (JÎ»1 ! Jâˆ’Î»2 âˆ— )Jsâˆ— are each perverse, so by
associativity we may unambiguously write
                                            Jsâˆ— Îžâˆ’
                                                 Î» Jsâˆ— = Jsâˆ— (JÎ»1 ! Jâˆ’Î»2 âˆ— )Jsâˆ— .

Using (4) and associativity, this is (Jsâˆ— JÎ»1 ! Jsâˆ— )Jâˆ’Î»2 âˆ— = (Jsâˆ— Îžâˆ’        âˆ’
                                                                    Î»1 Jsâˆ— )Îžâˆ’Î»2 . (Note Jsâˆ— JÎ»1 ! Jsâˆ— is unambiguous
and perverse, since stÎ»1 < tÎ»1 implies that JÎ»1 ! Jsâˆ— = Js! JstÎ»1 ! Jsâˆ— , and therefore Jsâˆ— JÎ»1 ! Jsâˆ— = JstÎ»1 ! Jsâˆ— .)
   Since by (3) Îžâˆ’      âˆ’       âˆ’                                         âˆ’          âˆ’
                   sÎ»1 Îžâˆ’Î»2 = ÎžsÎ» , we are reduced to proving Jsâˆ— ÎžÎ»1 Jsâˆ— = ÎžsÎ»1 , i.e., to prove the result for
general Î» it is enough to consider Î» which are antidominant.
   Therefore assume Î» is antidominant, and write l(tÎ» ) = l. Following Lemma 4.4 (b) of [13] we see
   â€¢ l(tÎ» s) = l + 1 and l(stÎ» ) = l âˆ’ 1,
   â€¢ Î» + sÎ» is antidominant,
   â€¢ l(tÎ» stÎ» ) = 2l âˆ’ 1 and l(tÎ» stÎ» s) = 2l âˆ’ 2; in particular l(tÎ» stÎ» ) = l(tÎ» ) + l(stÎ» ).
   Taking these relations, the previous parts of the Lemma, Corollary 6.3, and associativity into account,
we find
                                               JÎ»! Îžâˆ’     âˆ’ âˆ’
                                                    sÎ» = ÎžÎ» ÎžsÎ»
                                                          = Îžâˆ’
                                                             Î»+sÎ»
                                                          = JtÎ» stÎ» s!
                                                          = JtÎ» stÎ» ! Jsâˆ—
                                                          = JÎ»! JstÎ» ! Jsâˆ—
                                                          = JÎ»! (Jsâˆ— JÎ»! Jsâˆ— ).
Using Corollary 6.3 again to cancel JÎ»! from each side, we obtain the desired equality Jsâˆ— Îžâˆ’        âˆ’
                                                                                            Î» Jsâˆ— = ÎžsÎ» .



   Note that property (5) is the analogue of Bernsteinâ€™s relation
                                                   TÌƒsâˆ’1 Î˜âˆ’   âˆ’1
                                                          Î» TÌƒs  = Î˜âˆ’
                                                                    sÎ» ,

which was a main ingredient in the proof of Lemma 3.2. In fact the same argument can be applied to prove
the following corollary.
Corollary 6.6 If Î» is minuscule and tÎ» = wÎ» w as in section 3, then
                                                      Îžâˆ’
                                                       Î» = Jw Î» ! Jwâˆ— .

Writing wÎ» = t1 Â· Â· Â· trâˆ’p Ï„ and w = s1 Â· Â· Â· sp as in section 3, we have
                                         Îžâˆ’
                                          Î» = Jt1 ! Â· Â· Â· Jtrâˆ’p ! JÏ„ ! Js1 âˆ— Â· Â· Â· Jsp âˆ— .



                                                               14
   Proof. Suppose Î» is in the Weyl orbit of an antidominant minuscule coweight Âµâˆ’ . We have

                                                                    Îžâˆ’
                                                                     Âµâˆ’ = JÂµ ! .
                                                                            âˆ’



Choose the sequence of simple reflections s1 , . . . , sp as in Lemma 3.2. By induction on p, we easily see that

                                                  Îžâˆ’
                                                   sp Â·Â·Â·s1 (Âµâˆ’ ) = Jt1 Â·Â·Â·trâˆ’p Ï„ ! Js1 Â·Â·Â·sp âˆ— .

Indeed, using induction and Lemma 6.4 this equality for p âˆ’ 1 can be written

                                            Îžâˆ’
                                             spâˆ’1 Â·Â·Â·s1 (Âµâˆ’ ) = Jsp ! Jt1 Â·Â·Â·trâˆ’p Ï„ ! Js1 Â·Â·Â·spâˆ’1 âˆ— .

Multiplying on each side by Jsp âˆ— and using Lemma 6.5 (5), Corollary 6.3, and associativity yields

                                                  Îžâˆ’
                                                   sp Â·Â·Â·s1 (Âµâˆ’ ) = Jt1 Â·Â·Â·trâˆ’p Ï„ ! Js1 Â·Â·Â·sp âˆ— ,

as desired.
    The second statement follows from the first, using Lemma 6.4. To justify this, we need to show that

                           (Jt1 ! Â· Â· Â· Jtrâˆ’p ! JÏ„ ! )(Js1 âˆ— Â· Â· Â· Jsp âˆ— ) = Jt1 ! Â· Â· Â· Jtrâˆ’p ! JÏ„ ! Js1 âˆ— Â· Â· Â· Jsp âˆ— ,

where the products of the form Jt1 ! Â· Â· Â· Jsp âˆ— denote the k-fold convolution mentioned in section 6.3. This
results from the generalized associativity discussed there.
   We remark that it is important here that the underlying expression t1 Â· Â· Â· trâˆ’p Ï„ s1 Â· Â· Â· sp is reduced.

    Taking Corollary 6.6 as well as Lemmas 6.1, 6.4 and 6.5 into account, we get the following sheaf-theoretic
interpretation for minimal expressions for Î˜âˆ’
                                            Î».

Theorem 6.7 (a) Let Î» be a minuscule coweight of any root system. Write tÎ» = wÎ» w = t1 Â· Â· Â· trâˆ’p Ï„ s1 Â· Â· Â· sp ,
as in Lemma 3.2. Then
                                           Îžâˆ’Î» = mâˆ— (D),

where D is the perverse sheaf
                                     Ëœ Â· Â· Â· âŠ (j
                     D = (jt1 ! At1 )âŠ                        Ëœ Ï„ ! AÏ„ )âŠ (j
                                             Ëœ trâˆ’p ! Atrâˆ’p )âŠ (j                   Ëœ Â· Â· Â· âŠ (j
                                                                       Ëœ s1 âˆ— As1 )âŠ        Ëœ sp âˆ— Asp )

on the Demazure resolution m : X(t1 )Ã— Ëœ Â· Â· Â· Ã—X(t
                                               Ëœ         Ëœ
                                                    râˆ’p )Ã—X(Ï„  Ëœ
                                                              )Ã—X(s    Ëœ Â· Â· Â· Ã—X(s
                                                                    1 )Ã—       Ëœ    p ) â†’ X(tÎ» ) of the Schubert
variety X(tÎ» ).
(b) Let Î» be a coweight for GLn , and write it as

                                                              Î» = Î»1 + Â· Â· Â· + Î»k ,
                                          P
where each Î»i is minuscule, and l(tÎ» ) = i l(tÎ»i ). For each i = 1, . . . , k we have a decomposition and reduced
expression
                                       tÎ»i = wÎ»i wi = ti1 Â· Â· Â· tiqi Ï„ i si1 Â· Â· Â· sipi ,
as in Lemma 3.2.
    Then Îžâˆ’
          Î» = mâˆ— (D), where D is the perverse sheaf

                Ëœ Â· Â· Â· âŠ J
         Jt11 ! âŠ        Ëœ t1 ! âŠ J
                               Ëœ Ï„ 1 ! âŠ J
                                       Ëœ s1 âˆ— âŠ 
                                              Ëœ Â· Â· Â· âŠ J     Ëœ Â· Â· Â· Â· Â· Â· Â· âŠ J
                                                      Ëœ s1 âˆ— âŠ                Ëœ tk ! âŠ 
                                                                                    Ëœ Â· Â· Â· âŠ J
                                                                                            Ëœ tk ! âŠ J
                                                                                                   Ëœ Ï„ k ! âŠ J
                                                                                                           Ëœ sk âˆ— âŠ 
                                                                                                                  Ëœ Â· Â· Â· âŠ J
                                                                                                                          Ëœ sk   âˆ—
                          1q              1              p      1               1              q            k 1              p
                                                                                                                             k



on the Demazure resolution m : XÌƒ(tÎ» ) â†’ X(tÎ» ) corresponding to the reduced expression

                                   tÎ» = (t11 Â· Â· Â· t1q1 Ï„ 1 s11 Â· Â· Â· s1p1 ) Â· Â· Â· (tk1 Â· Â· Â· tkqk Ï„ k sk1 Â· Â· Â· skpk ).

    Consequently, Îžâˆ’Î» is the push-forward of an explicit perverse sheaf on a Demazure resolution of X(tÎ» ),
for every coweight Î» of GLn .

                                                                           15
    Proof. (a). This follows directly from Corollary 6.6 and the definition of the r-fold convolution product.
(b). By Lemma 6.5 (3) and generalized associativity, we have

                                               Îžâˆ’    âˆ’             âˆ’
                                                Î» = ÎžÎ»1 â‹† Â· Â· Â· â‹† ÎžÎ»k ,

where the right hand side denotes the k-fold convolution product.
   Part (b) then follows from part (a) and another application of generalized associativity.


    For x â‰¤ tÎ» , write Î˜âˆ’
                        Î» (x) for the coefficient of Tx .

Corollary 6.8 Let Î» be a minuscule coweight of a root system, or an arbitrary coweight for GLn . Let m, D
be as in Theorem 6.7. Then
                                 Î˜âˆ’                     â€¢
                                   Î» (x) = ÎµÎ» Tr(Frq , H (m
                                                            âˆ’1
                                                               (x), D)),
where the right hand side is the alternating trace of Frobenius on the eÌtale cohomology of the fiber over x
with coefficients in D.


7     Acknowledgements
We thank I. Mirkovic for kindly allowing us to include his unpublished result (Proposition 6.2), which was
crucial to the last section of this paper. We are also grateful to R. Bezrukavnikov for some very helpful
discussions concerning Mirkovicâ€™s theorem.
    Some of this paper was written during the first authorâ€™s 2000-2001 visit to the Institute for Advanced
Study in Princeton, which he thanks for support and hospitality. His research is partially supported by an
NSERC research grant and by NSF grant DMS 97-29992.
    The second author was supported by an NSERC Undergraduate Student Research Award during the
summers of 2000 and 2001.
    We wish to thank M. Rapoport for his comments on this paper. We are also grateful to R. Kottwitz
for his careful reading and for pointing out some errors in the first version of this paper. We thank him for
several other mathematical and expositional suggestions, in particular concerning the proof of Corollary 6.3.


References
 [1] A. Beilinson, J. Bernstein, P. Deligne, Faisceaux pervers, AsteÌrisque 100 (1982).

 [2] N. Chriss and V. Ginzburg, Representation theory and complex geometry, BirkaÌˆuser (1997).
 [3] P. Deligne, La conjecture de Weil II, Publ. Math. IHEÌS, 52 (1980) 313-428.
 [4] T. Haines, The Combinatorics of Bernstein Functions, Trans. Amer. Math. Soc. 353 (2001), 1251-1278.
 [5] T. Haines, Test Functions for Shimura Varieties: The Drinfeld Case, Duke Math. Journal 106 (2001),
     19-40.
 [6] T. Haines, B.C. NgoÌ‚, Nearby cycles for local models of some Shimura varieties, to appear, Compositio
     Math.
 [7] N. Iwahori and H. Matsumoto, On some Bruhat decomposition and the structure of the Hecke rings of
     p-adic Chevalley groups, Inst. Hautes EÌtudes Sci. Publ. Math. 25 (1965), 5-48.
 [8] D. Kazhdan and G. Lusztig, Representations of Coxeter groups and Hecke algebras, Invent. Math. 53
     (1979), 165-184.
 [9] D. Kazhdan and G. Lusztig, Proof of the Deligne-Langlands conjecture for Hecke algebras, Inv. Math.
     87 (1987), 153-215.


                                                            16
[10] R. Kottwitz and M. Rapoport, Minuscule Alcoves for Gln and GSp2n , Manuscripta Mathematica 102
     (2000), 403-428.
[11] G. Lusztig, Representations of finite Chevalley groups, Regional conference series in mathematics, No.
     39, (expository lectures from the CBMS regional conf. held at Madison, Wisconsin, Aug. 8-12, 1977),
     (1978).
[12] G. Lusztig, Singularities, character formulas, and a q-analog of weight multiplicities, AsteÌrisque 101-
     102 (1983), 208-229.
[13] G. Lusztig, Some examples of square integrable representations of semisimple p-adic groups, Trans.
     Amer. Math. Soc. 277 (1983), no.2, 623-653.
[14] G. Lusztig, Affine Hecke algebras and their graded version, J. Amer. Math. Soc. 2 No.3 (1989), 599-635.
[15] G. Lusztig, Cells in Affine Weyl Groups and Tensor Categories, Adv. Math. 129, 85-98 (1997).
[16] O. Schiffmann, On the center of affine Hecke algebras of type A, preprint, math.QA/0005182.


   University of Toronto
   Department of Mathematics
   100 St. George Street
   Toronto, ON M5S 3G3, Canada
   email: haines@math.toronto.edu

   University of Chicago
   Department of Mathematics
   5734 S. University Ave.
   Chicago, IL 60637
   email: alexandra@math.uchicago.edu




                                                     17
