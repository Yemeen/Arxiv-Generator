                                            REPRESENTATION THEORY
                                            An Electronic Journal of the American Mathematical Society
                                            Volume 00, Pages 000–000 (Xxxx XX, XXXX)
                                            S 1088-4165(XX)0000-0




                                              RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA FOR
                                                   CHARACTERS OF REDUCTIVE LIE GROUPS
arXiv:math/0312454v2 [math.RT] 8 Sep 2005




                                                                                      MATVEI LIBINE


                                                      Abstract. Let GR be a real reductive Lie group acting on a manifold M .
                                                      M. Kashiwara and W. Schmid in [KaSchm] constructed representations of GR
                                                      using sheaves and quasi-GR -equivariant D-modules on M . In this article we
                                                      prove an integral character formula for these representations (Theorem 1). Our
                                                      main tools will be the integral localization formula recently proved in [L3] and
                                                      the integral character formula proved by W. Schmid and K. Vilonen in [SchV2]
                                                      (originally established by W. Rossmann in [Ro]) in the important special case
                                                      when the manifold M is the flag variety of C ⊗R gR – the complexified Lie al-
                                                      gebra of GR . In the special case when GR is commutative and the D-module is
                                                      the sheaf of sections of a GR -equivariant line bundle over M this integral char-
                                                      acter formula will reduce to the classical Riemann-Roch-Hirzebruch formula.
                                                      As an illustration we give a concrete example on the enhanced flag variety.




                                                                                         Contents
                                               1. Introduction                                                                               1
                                               2. Preliminary results                                                                        2
                                               3. Setup                                                                                      6
                                               4. Statement of the main result                                                               9
                                               5. Proof of Theorem 1                                                                        13
                                               6. An example on the enhanced flag variety                                                   16
                                               References                                                                                   18



                                                                                    1. Introduction
                                               We consider pairs of Lie groups: a real linear reductive group GR sitting inside
                                            its complexification GC . For example:
                                             GL(n, R) ⊂            GL(n, C)         SL(n, R)        ⊂ SL(n, C)
                                             GL+ (n, R) ⊂          GL(n, C)         SO(n, C)        ⊂ SL(n, C)        Sp(n, R) ⊂ Sp(n, C).
                                               U (n)    ⊂          GL(n, C)          SU (n)         ⊂ SL(n, C)
                                            Suppose that GC acts algebraically on a smooth complex projective variety M . Fix
                                            a GC -invariant open algebraic subset U ⊂ M , and take a GC -equivariant algebraic
                                            line bundle (E, ∇E ) over U with a GC -invariant algebraic flat connection ∇E . Let
                                               2000 Mathematics Subject Classification. Primary 22E45; Secondary 32C38, 19L10, 55N91.
                                               Key words and phrases. equivariant sheaves and D-modules, characteristic cycles of sheaves
                                            and D-modules, integral character formula, fixed point integral localization formula, fixed point
                                            character formula, representations of reductive Lie groups, equivariant forms,

                                                                                                            c
                                                                                                            1997 American Mathematical Society

                                                                                                1
2                                    MATVEI LIBINE


SR ⊂ M be an open GR -invariant subset (which may or may not be GC -invariant)
and consider the cohomology spaces
(1)                          H p (SR , O(E)),     p ∈ Z.
   The classical Riemann-Roch-Hirzebruch formula computes the index of E, i.e.
the alternating sum       X
                            (−1)p dim H p (SR , O(E))
                             p
with SR = U = M . For general SR and U , however, these dimensions can be infinite.
To work around this problem we regard the vector spaces (1) as representations of
GR , and, as a substitute for the index, we ask for the character of the virtual
representation               X
                                (−1)p H p (SR , O(E)).
                                 p
(Recall that for finite-dimensional representations the value of the character at the
identity element e ∈ G equals the dimension of the representation.)
   In this article we establish an integral formula for characters of virtual repre-
sentations of this kind in a more general setting of D-modules. Existence of such
integral character formula was conjectured by W. Schmid. My work toward this
formula has led to the integral localization formula proved in [L3].
   We use the following convention: whenever A is a subset of B, we denote the
inclusion map A ֒→ B by jA֒→B .
                             2. Preliminary results
   Let GC be a connected complex algebraic reductive group which is defined over
R. We will be primarily interested in representations of a subgroup GR of GC
lying between the group of real points GC (R) and the identity component GC (R)0 .
We regard GR as a real reductive Lie group. Let gC and gR be the respective Lie
algebras of GC and GR . Let B denote the flag variety of gC . It is a smooth complex
projective variety consisting of all Borel subalgebras of gC . The group GC acts on
B transitively.
   If the group GR is compact, then all irreducible representations of GR can be
enumerated by their highest weights λ lying in the weight lattice Λ ⊂ ig∗R . The
Borel-Weil-Bott theorem can be regarded as an explicit construction of a holomor-
phic GR -equivariant line bundle Lλ → B such that the resulting representation of
GR in the cohomology groups is:
                              H p (B, O(Lλ )) = 0 if p 6= 0,
                              H 0 (B, O(Lλ )) ≃ πλ ,
where O(Lλ ) is the sheaf of sections of Lλ and πλ denotes the irreducible repre-
sentation of GR of highest weight λ. Then N. Berline and M. Vergne [BV], [BGV]
observed that the character of πλ , as a function on gR , can be expressed as an inte-
gral over B of a certain naturally defined equivariantly closed form. They proved it
by applying their famous integral localization formula and matching contributions
from fixed points with terms of the Weyl character formula. (This is a restatement
of Kirillov’s character formula.)
   M. Kashiwara and W. Schmid [KaSchm] generalize the Borel-Weil-Bott construc-
tion. Instead of line bundles over the flag variety B they consider GR -equivariant
                   RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA                                   3


sheaves1 F and, for each integer p ∈ Z, they define representations of GR in
Extp (F , OBan ), where OBan denotes the sheaf of analytic functions on B. In other
words, M. Kashiwara and W. Schmid prove that these vector spaces possess a natu-
ral Fréchet topology and the resulting representations of GR are admissible of finite
length. Hence these representations have characters in the sense of Harish-Chandra.
Let θ̃ be the character of the virtual representation of GR
                           X                             
                              (−1)p Extp DB F , OBan (λ) ,
                               p

where DB F denotes the Verdier dual of F , OBan and λ is some twisting parameter
lying in h∗C – the dual space of the universal Cartan algebra of gC . Here the character
θ̃ is a distribution on gR . Then W. Schmid and K. Vilonen [SchV2] prove two
character formulas for θ̃.
    The integral character formula expresses θ̃ as an integral of a certain differential
form (independent of F ) over the characteristic cycle Ch(F ) of F . Characteris-
tic cycles were introduced by M. Kashiwara and their definition can be found in
[KaScha]. On the other hand, W. Schmid and K. Vilonen give a geometric way to
understand characteristic cycles in [SchV1]. A comprehensive treatment of char-
acteristic cycles can be found in [Schü]. The cycle Ch(F ) is a conic Lagrangian
Borel-Moore homology cycle lying inside the cotangent space T ∗ B. If the sheaf
F happens to be perverse, the characteristic cycle of F equals the characteristic
cycle of the holonomic D-module corresponding to F via the Riemann-Hilbert cor-
respondence. Originally existence of such formula over an unspecified cycle was
established by W. Rossmann in [Ro]. In the special case when the group GR is
compact, the integral character formula reduces to Kirillov’s character formula.
    On the other hand, Harish-Chandra showed that the distribution θ̃ is given by
integration against a certain function Fθ̃ on gR . This function Fθ̃ is an Ad(GR )-
invariant locally L1 -function, its restriction to the set of regular semisimple elements
grs
  R of gR can be represented by an analytic function. According to Harish-Chandra,
Fθ̃ can be expressed as follows. For a regular semisimple element X ∈ grs           R we
denote by tC (X) ⊂ gC the unique (complex) Cartan algebra containing X and by
Ψ(X) ⊂ tC (X)∗ we denote the root system of gC with respect to tC (X). Since X is
regular semisimple, the number of Borel subalgebras {b1 , . . . , b|W | } containing X is
exactly the order of the Weyl group W . Each Borel subalgebra bk ∈ B containing
X (and hence containing tC (X)) determines a positive root system Ψ+       bk (X) ⊂ Ψ(X)
consisting of all those roots whose root spaces are not contained in bk ; that is bk
contains all negative root spaces relative to Ψ+   bk (X). Then

                                    |W |
                                    X                      ehX,λbk i
(2)                     Fθ̃ (X) =          mbk (X) · Q                 ,
                                    k=1                  α∈Ψ+ (X) α(X)
                                                            bk


where mbk (X)’s are some integer multiplicities. W. Schmid and K. Vilonen give
a formula for mbk (X)’s in terms of local cohomology of F (formula (5.25b) in
[SchV2]). Pick another positive root system Ψ≤ (X) ⊂ Ψ(X) such that
                           Re α(X) ≤ 0          for all α ∈ Ψ≤ (X).

   1Strictly speaking, F is not a sheaf on B but rather an element of the “G equivariant derived
                                                                            R
category on B with twist (−λ − ρ)” denoted by DGR (B)−λ (see [SchV2] and Remark 2).
4                                    MATVEI LIBINE


(If there are roots in Ψ which take purely imaginary values on X, there will be
different possible choices for Ψ≤ (X).) Let B(X) ⊂ GC be the Borel subgroup
whose Lie algebra contains tC (X) and the positive root spaces corresponding to
Ψ≤ (X). The action of B(X) on B has precisely |W | orbits O1 , . . . , O|W | . Each
of these orbits Ok is a locally closed subset of B and contains exactly one of the
Borel subalgebras {b1 , . . . , b|W | } containing X. We order the Borel subalgebras
containing X and the orbits of B(X) so that bk is contained in Ok , k = 1, . . . , |W |.
Then
                           ∗
                                                                                
(3)       mbk (X) = χ HO      k
                                (DB F )bk = χ (j{bk }֒→Ok )∗ ◦ (jOk ֒→B )! DB F )
(recall that DB F denotes the Verdier dual of F ). These multiplicities are exactly
the local contributions of points bk ∈ B to the Lefschetz fixed point formula, as gen-
eralized to sheaf cohomology by M. Goresky and R. MacPherson [GM]. W. Schmid
and K. Vilonen call (2) combined with (3) the fixed point character formula because
the set of all Borel subalgebras {b1 , . . . , b|W | } containing X can be expressed as the
set of zeroes of the vector field generated by the infinitesimal action of X on B. In
the special case when the group GR is compact, and λ + ρ is an integral weight, all
the multiplicities mbk (X) are equal to each other, say,
                         mb1 (X) = · · · = mb|W | (X) = κ ∈ Z,
and (2) reduces to κ times the Weyl character formula. The fixed point formula
was conjectured by M. Kashiwara [Ka], and its proof uses the above-mentioned
generalization of the Lefschetz fixed point formula to sheaf cohomology [GM].
   There is a striking relationship between these two character formulas. In the
compact group case N. Berline and M. Vergne [BV], [BGV] gave a simple proof of
Kirillov’s character formula using their integral localization formula; they matched
contributions from zeroes of vector fields with terms of the Weyl character formula.
However, in the non-compact group case their argument breaks down because their
localization formula works for compact groups only. Originally W. Schmid and
K. Vilonen [SchV2] proved these character formulas independently of each other
using representation theory methods. Thus, besides an important representation-
theoretical result, they formally established existence of an integral localization
formula in a very special case. In the announcement [Sch] W. Schmid posed a ques-
tion: “Can this equivalence of character formulas be seen directly without a detour
to representation theory, just as in the compact case.” In [L1], [L2] I provide such
a geometric link, then in [L3] I establish a general integral localization formula for
non-compact group actions. In turn, this article uses the new localization formula
for non-compact group actions to give a generalization of the integral character
formula to representations associated to sheaves on manifolds other than the flag
manifold of gC .
   We describe the integral character formula for θ̃ in more detail; its ingredients
will be used in our character formula (18). The character θ̃ is a distribution on
Ωtop
  c (gR ) – the space of smooth compactly supported differential forms on gR of top
                                                                        ∞ ∗
degree. If ϕ ∈ Ωtop c (gR ), then we define its Fourier transform ϕ̂ ∈ C (gC ) as in
[L1], [L2], [L3], [Ro] and [SchV2]:
                              Z
(4)                   ϕ̂(ξ) =    ehX,ξi ϕ(X),    X ∈ gR , ξ ∈ g∗C ,
                               gR
                                        √
without the customary factor of i =      −1 in the exponent.
                    RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA                         5


   For a smooth complex algebraic manifold M we denote by σM the canonical
complex symplectic form on the holomorphic cotangent space T ∗ M . In general,
when the group GC acts on a complex manifold M , for X ∈ gC , we denote by XM
the vector field on M given by (notice the minus sign)
                             d               
(5)            (XM · ϕ)(x) =    ϕ exp(−εX)x  ,        ϕ ∈ C ∞ (M ).
                             dε                 ε=0
Then the moment map on the holomorphic cotangent space µM : T ∗ M → g∗C is
defined by
(6)                 µM (ζ) : X 7→ −hζ, XM i,        X ∈ gC , ζ ∈ T ∗ M.
When the manifold M is the flag variety B we get the complex algebraic symplectic
form σB on T ∗ B, the moment map µB : T ∗ B → g∗C and the vector field XB for each
element X ∈ gC .
   We fix a compact real form (i.e. a maximal compact subgroup) UR ⊂ GC with
Lie algebra uR . We will use Rossmann’s map B ∋ x 7→ λx ∈ g∗C defined in [Ro] and
Section 8 of [SchV1] (here we use the notations of [SchV1] and [SchV2]). Recall
that the twisting parameter λ is an element of the dual of the universal Cartan
algebra hC of gC ; hC is not a subalgebra of gC , but is canonically isomorphic to any
Cartan subalgebra tC ⊂ gC equipped with a specified choice of positive root system
Φ+ . For x ∈ B, we denote by bx ⊂ gC the Borel subalgebra corresponding to x.
Then hC is canonically isomorphic to the quotient bx /[bx , bx ], so that bx contains
all the negative root spaces. Thus we have an exact sequence of vector spaces
(7)                          0 → [bx , bx ] → bx → hC → 0.
In general, this sequence does not have a canonical splitting. But once a choice of
a compact real form UR ⊂ GC is made, we can split this sequence as follows. Let
TR (x) be the stabilizer of x in UR , it is a maximal torus in UR , and set
           tR (x) = Lie(TR (x)) ⊂ uR ⊂ gC ,         tC (x) = tR (x) ⊗R C ⊂ gC .
Then tC (x) is a Cartan subalgebra of gC which lies in bx and comes equipped with a
system of positive roots Ψ+
                          bx so that bx contains all the negative root spaces. Hence
we get a composition of maps
                                    hC →t
                                       ˜ C (x) ֒→ bx
which splits (7):
                         bx ≃ tC (x) ⊕ [bx , bx ] ≃ hC ⊕ [bx , bx ].
We also get a splitting of gC :
                 M                                M                      
   gC ≃ tC (x) ⊕       root spaces of tC (x) ≃ hC ⊕    root spaces of tC (x) .

Taking duals we get a splitting of g∗C :
                  M                      ∗       M                      ∗
  g∗C ≃ tC (x)∗ ⊕    root spaces of tC (x) ≃ h∗C ⊕    root spaces of tC (x) .

Hence λ ∈ h∗C gets identified via this splitting with an element λx ∈ g∗C . The map
λx : B → g∗C is smooth, real algebraic and UR -equivariant, but in general not GC -
or GR -equivariant, nor complex algebraic. When λ is regular, the twisted moment
map
                            µλ =def µB + λx : T ∗ B → g∗C
6                                             MATVEI LIBINE


is a real algebraic UR -equivariant diffeomorphism of T ∗ B onto the coadjoint orbit
of GC of any point λx ∈ g∗C .
   We will also use a UR -invariant 2-form τλ on B defined by the formula
                                      τλ (Xx , Yx ) = λx ([X, Y ]),
where Xx , Yx ∈ Tx B are the tangent vectors at x ∈ B induced by X, Y ∈ uR via
differentiation of the UR -action. It is an important property of λx and τλ that
together they make a (non-homogeneous) differential form on B
                                      hX, λx i − τλ ,       X ∈ gC ,
which depends holomorphically on X (in fact linearly) and which is equivariantly
closed with respect to UR (see [BGV], [GS] or [L3] for the definition of equivariantly
closed forms). It follows that the forms
                                ehX,λx i−τλ       and        e−hX,λx i+τλ
are UR -equivariantly closed forms too. For a differential form ω which is possibly
non-homogeneous, we denote by ω[k] its homogeneous component of degree k. Then
the integral character formula (Theorem 3.8 in [SchV2]) says that the value of the
character θ̃ at ϕ ∈ Ωtop
                       c (gR ) is given by
                        Z
                 1
(8) θ(ϕ) =                     (ϕ̂ ◦ µλ ) · (−σB + τλ )d
              (2πi)d d! Ch(F )
                           Z       Z                                   
                     1                      hX,µB (ζ)+λx i+σB −τλ
               =                          e                       ∧ ϕ(X)       ,
                 (−2πi)d Ch(F ) gR                                        [2d]

                                                                                X ∈ gR , ζ ∈ T ∗ B,
where µλ = µB +λx and d = dimC B. This integral converges because the expression
ϕ̂ ◦ µλ involves the Fourier transform of ϕ and decays rapidly along the support of
Ch(F ).
                                                3. Setup
   Recall that GC is a connected complex algebraic reductive group which is defined
over R, GC acts algebraically on a smooth complex projective variety M . And we
are primarily interested in representations of a real reductive group GR ⊂ GC lying
between the group of real points GC (R) and the identity component GC (R)0 .
   We will be using the concepts of D-modules and derived categories; [Bo] and
[KaScha] are good introductions to these subjects. Let OM denote the structure
sheaf on M and let DM denote the sheaf of linear differential operators on M
with algebraic coefficients; DM acts on OM . The definition of a quasi-equivariant
D-module can be found in many different sources; for convenience, we copy the
definition given in [KaSchm].
   Let GC be a connected complex algebraic reductive group acting algebraically on
a smooth complex algebraic variety M , gC = Lie(GC ). We write µ for the action
morphism and π for the projection map GC × M → M :
         µ, π : GC × M → M,            µ(g, x) = gx,       π(g, x) = x        g ∈ GC , x ∈ M.
We also consider three maps
                         qj : GC × GC × M → GC × M,                   j = 1, 2, 3,
    q1 (g1 , g2 , x) = (g1 , g2 x),     q2 (g1 , g2 , x) = (g1 g2 , x),     q3 (g1 , g2 , x) = (g2 , x).
                 RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA                            7


Then we have the following identities:
                       µ ◦ q1 = µ ◦ q2 :     (g1 , g2 , x) 7→ g1 g2 x,
                       π ◦ q2 = π ◦ q3 :     (g1 , g2 , x) 7→ x,
                       µ ◦ q3 = π ◦ q1 :     (g1 , g2 , x) 7→ g2 x.
Definition 1. We denote by OGC ⊠ DM the subalgebra OGC ×M ⊗π−1 OM π −1 DM
of DGC ×M . A quasi-GC -equivariant DM -module is a DM -module M equipped with
an OGC ⊠ DM -linear isomorphism β : µ∗ M −→˜ π ∗ M, such that the composition of
isomorphisms
                            q∗ β                            q∗ β
      q2∗ µ∗ M ≃ q1∗ µ∗ M −−−
                            1
                              −→ q1∗ π ∗ M ≃ q3∗ µ∗ M −−−
                                                        3
                                                          −→ q3∗ π ∗ M ≃ q2∗ π ∗ M
coincides with
                                           q∗ β
                           q2∗ µ∗ M −−−2
                                         −→ q2∗ π ∗ M.
If β is linear even over DGC ×M , this reduces to the usual definition of a GC -
equivariant DM -module.
   Informally speaking, this definition can be interpreted as follows. For each g ∈
GC , denote by µg : M → M the translation by g, i.e. µg : x 7→ gx. Then β
consists of a family of isomorphisms of DM -modules βg : µ∗g M −→  ˜ M, depending
algebraically on g and multiplicative in the variable g.
Example 2. Let (E, ∇E ) be a GC -equivariant algebraic line bundle over a GC -
invariant open algebraic subset U ⊂ M with a GC -invariant algebraic flat connection
∇E . Take M to be the direct image of the sheaf of sections O(E), under the inclusion
map U ֒→ M . Then DM acts on O(E) via the flat connection making O(E) a quasi-
GC -equivariant DM -module.
    Each element X ∈ gC acts on M in two ways. One way is by inducing the vector
field −XM given by (5) which in turn operates on M via the connection. The other
way is by infinitesimal translation of the sections of the GC -equivariant line bundle
E. When these two actions of gC coincide, the DM -module M is GC -equivariant.
   Let M be a coherent, quasi-GC -equivariant DM -module. Recall that, for X ∈ gC ,
XM denotes the vector field on M given by (5). Following [KaSchm] we get two
different actions of gC on M. The first action is via gC ∋ X 7→ −XM ∈ Γ(DM ) –
the global sections of DM – followed by the DM -module structure; we denote this
action by αD . And the second action is through differentiation of the GC -action
when we regard M as a GC -equivariant OM -module; this action is denoted by αt .
We set γ = αt − αD , then γ is a Lie algebra homomorphism
(9)                                γ : gC −→ EndDM (M).
This way M becomes a (DM , U(gC ))-module, where U(gC ) denotes the universal en-
veloping algebra of gC . The quasi-GC -equivariant DM -module M is GC -equivariant
precisely when γ ≡ 0.
   We say that the quasi-GC -equivariant DM -module M is Z(gC )-finite if some
ideal of finite codimension I ⊂ Z(gC ) (the center of U(gC )) annihilates M via the
γ-action.
   We denote by Ch(M) the characteristic cycle of M which lies in T ∗ M . Pick a
Borel subalgebra bC ⊂ gC and define a subset of g∗C
                               b⊥         ∗
                                C = {ξ ∈ gC ; ξ|bC ≡ 0}.
8                                  MATVEI LIBINE


Then the DM -module M is called admissible if
                          Ch(M) ∩ µ−1  ⊥
                                   M (bC )       ⊂   T ∗M
is a Lagrangian variety. When M is Z(gC )-finite, the variety Ch(M) ∩ µ−1  ⊥
                                                                       M (bC ) is
known to be involutive ([KaMF] or [Gi]), hence the above condition is equivalent
to
                                      −1 ⊥
                                              
                       dimC Ch(M) ∩ µM   (bC ) = dimC M.
Because of GC -invariance of Ch(M), if this condition is satisfied for one particular
Borel subalgebra bC ⊂ gC , then it is satisfied for all Borel subalgebras of gC , and
this definition is independent of the choice of the Borel subalgebra bC .
   Let S be a GR -equivariant constructible sheaf on M . We denote by OM an
the sheaf of holomorphic functions on M . Then M. Kashiwara and W. Schmid
[KaSchm] equip the vector spaces
(10)                   RHompDM (M ⊗ S, OM an ),        p ∈ Z,
with a natural Fréchet topology and prove that the resulting virtual representation
of GR
                         X
(11)                        (−1)p RHompDM (M ⊗ S, OM an )
                         p

is admissible of finite length whenever the DM -module M is admissible and Z(gC )-
finite. In particular, the representation (11) has a character θ in the sense of
Harish-Chandra. As before, θ is a distribution on gR .
   In this paragraph we outline M. Kashiwara and W. Schmid’s construction of
topology on the spaces (10). Oversimplifying and ignoring the GC - and GR -actions,
suppose first that the sheaf S is (jU֒→M )! CU , where U ⊂ M is an open semi-
algebraic GR -invariant subset and CU is the constant sheaf on U . Furthermore, sup-
pose that M is a locally free quasi-GC -equivariant DM -module, i.e. M = DM ⊗OM F
for some coherent, locally free, GC -equivariant OM -module F on M . They re-
                                                           (0,·)
place the sheaf OM an with the C ∞ Dolbeault complex ΩM , to which it is quasi-
isomorphic, and write out isomorphisms of complexes of vector spaces without any
topology:
                                                                                (0,·)
(12)   RHomDM (M ⊗ S, OM an ) ≃ RHomDM (DM ⊗OM F ⊗ (jU֒→M )! CU , ΩM )
                                         (0,·)                          (0,·)
        ≃ RHomOM (F ⊗ (jU֒→M )! CU , ΩM ) ≃ R Γ(U ; (F∗ )an ⊗OM an ΩM )
                                                                                 (0,·)
                                                     ≃ Γ(U ; (F∗ )an ⊗OM an ΩM ),
where (F∗ )an denotes the sheaf of analytic sections of the dual of F. The complex on
the right has a natural Fréchet topology – the C ∞ topology for differential forms –
and continuous GR action. General M and S, have resolutions by locally free quasi-
GC -equivariant DM -modules (Lemma 4.7 in [KaSchm]) and by sheaves of the type
(jU֒→M )! CU respectively. This, combined with the acyclicity of the right hand side
of (12), makes it possible to equip the vector spaces (10) with a Fréchet topology.
Then M. Kashiwara and W. Schmid work hard to show that this topology does not
depend on the choices involved. They do it by proving that the topology on the
spaces (10) is that of the maximal globalization of their underlying Harish-Chandra
modules.
                  RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA                              9


    Recall that B denotes the flag variety of gC . We will establish a formula for this
character as an integral over a cycle in T ∗ (B × M ) under an additional assumption
that M has an infinitesimal character, i.e. Z(gC ) acts on M by a character. Even if
this condition is not satisfied, since M is assumed to be Z(gC )-finite, there is a finite
filtration of M by quasi-GC -equivariant DM -submodules such that the successive
quotients have infinitesimal characters, and we can apply this integral character
formula to each of these quotients separately.
    In the special case when GC = C× , the DM -module M is the sheaf of sections of
a GC -equivariant line bundle (E, ∇E ) over M as in Example 2 with U = M , and
S is the constant sheaf CM , the flag variety B consists of just one point and the
integral character formula will reduce to the classical Riemann-Roch-Hirzebruch
formula.
Remark 1. We do not need M to be projective to establish that (11) is admissible
of finite length. In fact it is sufficient to assume that M is a smooth quasi-projective
variety. The compactness of M will be needed for the integral character formula.
   On the other hand, the result of Sumihiro [Su] restated as Proposition 4.6 in
[KaSchm] together with Theorem 5.12 there show that we can always embed M into
a smooth projective variety and there is no loss of generality in assuming that M
is projective. We will illustrate this in Section 6.
   Our derivation of the integral character formula for θ follows the following
scheme:
     • Replace the pair (M, S) which lives on M with a new pair (M,    f S)
                                                                          e which
        lives on the flag variety B such that the virtual representation (11) stays
        unchanged (14);
     • Write out the fixed point character formula for θ in terms of (M,f S)e and
        zeroes on B;
     • We want to prove that the integral (8) represents θ; first we apply the
        integral localization formula [L3] to (8);
     • Combine similar terms in the result of the previous step and match them
        with the terms in the fixed point character formula for θ obtained in the
        earlier step.

                        4. Statement of the main result
   In the previous section we assumed that M was a quasi-GC -equivariant coherent
DM -module on M which was admissible and had an infinitesimal character. We
will follow [KaSchm] and index characters of Z(gC ) by linear functionals λ on the
universal Cartan without the customary shift by ρ (half sum of the positive roots);
in other words, χλ : Z(gC ) → C denotes the character by which Z(gC ) acts on
the Verma module with highest weight λ. Then χλ = χµ if and only if λ + ρ is
conjugate to µ + ρ under the action of the Weyl group W .
Remark 2. In this article we use results from [KaSchm] and [SchV2]. Unfortu-
nately these two sources use different conventions for labeling characters and twists.
We follow the conventions of [KaSchm] explained above. On the other hand [SchV2]
shift these notations by ρ and they define, for instance, the “GR -equivariant de-
rived category on B with twist (λ − ρ)” denoted by DGR (B)λ which becomes the
bounded GR -equivariant derived category in the usual “untwisted” sense precisely
when λ = ρ. Similarly, OB (λ) in [SchV2] denotes the twisted sheaf of holomorphic
10                                    MATVEI LIBINE


functions with twist (λ − ρ) and which becomes the sheaf of ordinary holomorphic
functions precisely when λ = ρ.
                                             coh,λ−ρ
   We assume that M is an object in Modquasi−G       C −eq
                                                           (DM ) – the category of quasi-
GC -equivariant coherent DM -modules on M with infinitesimal character χλ−ρ .
   The Kashiwara-Schmid construction of Fréchet topology on the spaces (10) was
carried out on the level of derived categories. This means that instead of a sheaf
                               b
S we have an element S ∈ DG      R ,R−c
                                        (CM ) – the bounded derived category of GR -
equivariant R-constructible sheaves, and we have a pairing
                coh,λ−ρ                b
             Modquasi−G C −eq
                              (DM ) × DG R ,R−c
                                                (CM )     −→     Db (FGR ),

                      (M, S)     7→    RHomtop
                                           DM (M ⊗ S, OM an ),
where Db (FGR ) denotes the derived category of GR -representations defined in §3
of [KaSchm]. The category Db (FGR ) is built on complexes of topological vector
spaces with continuous GR -actions (C, dC ), the differential maps dnC : C n → C n+1
are required to be continuous and GR -equivariant. A complex (C, dC ) is exact if,
for all n,
                               dnC : C n → ker dn+1
                                                C
is onto and is an open map relative to the subspace topology on ker dn+1
                                                                     C . A complex
(C, dC ) becomes zero in Db (FGR ) precisely when it is exact.
    Because we will apply results of A. Beilinson and J. Bernstein on equivalences
of categories [BB], we will also assume that λ is integrally dominant, i.e.
                    hα̌, λi ∈
                            / Z<0 ,     for every positive coroot α̌.
This can always be achieved by replacing λ with an appropriate W -translate.
   We denote by ModGC −eq (DB, λ−ρ ) the category of modules over the sheaf of
twisted differential operators DB, λ−ρ on the flag variety B. The sheaf DB, λ−ρ is
defined in [BB], but we follow the twisting conventions of [KaSchm] as explained in
Remark 2, so that DB, 0 = DB – the sheaf of differential operators on B without any
twist. We form a product space B × M with diagonal GC -action and consider the
sheaf of twisted differential operators DB×M, λ−ρ =def DB, λ−ρ ⊠ DM , the twisting
is confined to the factor B. We also denote by ModGC −eq (DB×M, λ−ρ ) the category
of GC -equivariant DB×M, λ−ρ -modules on B × M . Let p and q be the projection
maps
                                        p
                                  B ←−−−− B × M
                                               
                                               q
                                               y
                                              M,
and let p̃ and q̃ be the induced projections on the cotangent bundles:
                                        p̃
                               T ∗ B ←−−−− T ∗ (B × M )
                                                 
                                                 q̃
                                                 y
                                              T ∗ M.
   M. Kashiwara and W. Schmid [KaSchm] use results of A. Beilinson and J. Bern-
stein on equivalence of categories [BB] to prove that the pair (M, S) on M can be
replaced with a DB, ρ−λ -module and a complex of sheaves on B. We will make this
                  RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA                            11


statement precise. First of all, they show that there exists a coherent holonomic
module L ∈ ModGC −eq (DB×M, λ−ρ ) such that

                      q∗ L = M       and       Rk q∗ L = 0 if k 6= 0,

namely one can take

                    L = DB, λ−ρ ⊠ M/γB×M (gC )(DB, λ−ρ ⊠ M),

where γB×M (gC )(DB, λ−ρ ⊠ M) denotes the image in DB, λ−ρ ⊠ M of the module
gC ⊗(DB, λ−ρ ⊠M) under the map γB×M given by the equation (9) with the ambient
manifold B × M .
   Then we apply the twisted deRham functor to obtain a complex of sheaves

           L = DRB×M (L) =def RHomDB×M, λ−ρ (OB (λ − ρ) ⊠ OM , L),

which is an element of the bounded GC -equivariant, C-constructible derived cat-
                                                          b
egory with twist (ρ − λ) along the B-factor denoted DG      C , ρ−λ,C−c
                                                                        (CB×M ). Here
OB (λ − ρ) is a twisted sheaf of holomorphic functions on B, with twist (λ − ρ) (so
that OB (0) is just the sheaf of functions on B with no twist at all).
   Let d = dimC B, and let (ΩdB )−1 ≃ OB (2ρ) denote the reciprocal of the canonical
sheaf. Combining the equations (6.7), (7.14) and (7.15) from [KaSchm] we obtain

(13)   RHomtop
           DM (M ⊗ S, OM an )
                                                                  
≃ RHomtop                    d −1
      DB , ρ−λ DB, ρ−λ ⊗OB (ΩB )  ⊗ Rp∗ (L ⊗ q −1 S), OBan (ρ − λ) [d − 2 dimC M ]
                                                              
  ≃ RHomtop
          DB ,−λ−ρ DB,−λ−ρ ⊗ Rp∗ (L ⊗ q
                                        −1
                                           S), OBan (−λ − ρ) [d − 2 dimC M ]
                                                               
                     ≃ RHom Rp∗ (L ⊗ q −1 S), OBan (−λ − ρ) [d − 2 dimC M ]

as elements of the derived category of GR -representations Db (FGR ). Here we view
Rp∗ (L ⊗ q −1 S) as an object in DG
                                  b
                                    R ,−λ−ρ,R−c
                                                (CB ), which makes sense because 2ρ is
an integral weight, and this implies the existence of a canonical isomorphism (6.8)
in [KaSchm]
                     b                            b
                    DG R , ρ−λ,R−c
                                   (CB )   ≃     DG R ,−λ−ρ,R−c
                                                                (CB ).
That is, the pair (M, S) on the variety M is replaced by a pair
                                                       
(14)                         DB,−λ−ρ , Rp∗ (L ⊗ q −1 S)

on the flag variety B, with an additional twist by (−λ − ρ).
   Our starting point is the integral character formula (8) proved by W. Schmid and
K. Vilonen in [SchV2]. We apply it to the right hand side of (13). We fix a compact
real form UR ⊂ GC . Recall that µB : T ∗ B → g∗C is the moment map defined by
(6), σB is the canonical complex algebraic holomorphic symplectic form on T ∗ B,
λx : B → g∗C is the UR -equivariant Rossmann’s map, and τλ is a certain UR -invariant
2-form on B. The character of the virtual representation (11) is a distribution on
Ωtop
  c (gR ) – the space of smooth compactly supported differential forms on gR of top
degree. For an element ϕ ∈ Ωtop c (gR ), its Fourier
                                              √      transform ϕ̂ ∈ C ∞ (g∗C ) is defined
by (4) without the customary factor of i = −1 in the exponent. Then the integral
character formula says that the character θ of the virtual representation (13) of GR ,
12                                    MATVEI LIBINE


as a distribution on Ωtop
                        c (gR ), is
                         Z
                  1
(15) θ(ϕ) =                                 (ϕ̂ ◦ µ−λ ) · (σB + τλ )d
               (2πi)d d! Ch(Rp∗ (L⊗q−1 S))a
                   Z                 Z                                    
               1                               hX,µB (ζ)−λx i+σB +τλ
         =                                   e                       ∧ ϕ(X)       ,
            (2πi)d Ch(Rp∗ (L⊗q−1 S))a gR                                     [2d]

                                                                       X ∈ gR , ζ ∈ T ∗ B.
Here µ−λ = µB − λx , d = dimC B, a : T ∗ B → T ∗ B is the antipodal map ζ 7→
−ζ, and Ch(Rp∗ (L ⊗ q −1 S))a denotes the image under this antipodal map of the
characteristic cycle of Rp∗ (L ⊗ q −1 S) (which is a cycle in T ∗ B).
Remark 3. If Z is a complex manifold and Z R is the underlying real analytic
manifold, then the holomorphic symplectic form σZ is defined on the holomorphic
cotangent bundle T ∗ Z, while the characteristic cycles of constructible sheaves on
Z lie in the real cotangent bundle T ∗ (Z R ). Hence we need to identify T ∗ Z with
T ∗ (Z R ). There are at least two different but equally natural ways of doing this, we
use the convention (11.1.2) of [KaScha], Chapter XI; the same convention is used
in [L1], [L2], [L3] and [SchV2]. Under this convention, if σZ,R is the canonical real
symplectic form on T ∗ Z R and σZ is the canonical complex holomorphic symplectic
form on T ∗ Z, then σZ,R gets identified with 2 Re σZ .
   Another important ingredient is a generalization of the Hopf index theorem
stated as Corollary 9.5.2 in [KaScha]. Let T be a constructible sheaf on M or
                                       b
an element of the derived category DR−c  (CM ), and let χ(M, T ) denote the Euler
characteristic of M with respect to T . Then
                                                      
(16)                       χ(M, T ) = # [M ] ∩ Ch(T ) ,
where [M ] denotes the fundamental cycle of M . Alternatively one can apply the
equation (5.30) from [Schü]. Let ThomT ∗ M denote the Thom form of the cotangent
bundle T ∗ M ։ M . That is ThomT ∗ M is a closed differential form on T ∗ M of degree
2 dimC M which decays rapidly along the fiber (or even compactly supported along
the fiber) and such that
                   Z
                         ThomT ∗ M = (2π)dimC M ,       ∀x ∈ M.
                      Tx∗ M

We regard M as a submanifold of T ∗ M via the zero section inclusion. Then
the restriction of the Thom form to M is the Euler form of M . Since the form
(2π)− dimC M ThomT ∗ M is Poincaré dual to the homology class of [M ] in T ∗ M , the
Hopf index theorem (16) can be rewritten as
                                                       Z
                                             − dimC M
(17)       χ(M, T ) = # [M ] ∩ Ch(T ) = (2π)                 ThomT ∗ M ,
                                                              Ch(T )

which is a generalization of the Gauss-Bonnet theorem.
   Recall that UR is a compact real form of GC . The form ThomT ∗ M may be chosen
to be UR -invariant. If, in addition, the cotangent bundle T ∗ M has a spin structure,
then V. Mathai and D. Quillen showed in [MQ] (see also Section 7.7 in [BGV]) that
ThomT ∗ M can be realized as the top degree part of a UR -equivariantly closed form
on T ∗ M in a canonical way.
                  RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA                               13


   The last essential ingredient is the deformation argument for integrals of equiv-
ariantly closed forms from [L3]. This argument requires that any maximal complex
torus TC ⊂ GC acts on M with isolated fixed points. (Since M is compact, there
will be only finitely many of those.) If this condition is satisfied for one particular
torus, then it is satisfied for all tori because all maximal complex tori are conjugate
by elements of GC . (This condition is satisfied in all application we have in mind.)
   We will combine the integral character formula (15) and the Gauss-Bonnet for-
mula (17) to get a formula for the character of the virtual representation (13) as
an integral over a cycle in T ∗ (B × M ). Set
     Se = L ⊗ q −1 S      and             e a = Ch(DB×M (S))
                                   Λ = Ch(S)             e ⊂ T ∗ (B × M ).

Here a : T ∗ (B × M ) → T ∗ (B × M ) is the antipodal map ζ 7→ −ζ and Ch(S)    ea
denotes the image under this antipodal map of the characteristic cycle of S;e the
operator DB×M is the Verdier duality operator (see (22) below for its properties).
Theorem 1. Suppose that any maximal complex torus TC ⊂ GC acts on M with
isolated fixed points. Then the value of the character θ of the virtual representation
(11) on ϕ ∈ Ωtopc (gR ) is
                            Z
                    in                                         
(18) θ(ϕ) =                      p̃∗ (ϕ̂ ◦ µ−λ ) · (σB + τλ )d ∧ q̃ ∗ ThomT ∗ M
                (2πi)d+n d! Λ
                    Z Z                                                        
              in
       =        d+n
                              p̃∗ ehX,µB (ζ)−λx i+σB +τλ ∧ q̃ ∗ ThomT ∗ M ∧ϕ(X)            ,
           (2πi)      Λ    gR                                                     [2(d+n)]

where µ−λ = µB − λx , d = dimC B and n = dimC M .
Remark 4. Suppose that the group GC = C× , the DM -module M is the sheaf of
sections of a GC -equivariant line bundle (E, ∇E ) over M as in Example 2, and S is
the constant sheaf CM . Then the flag variety B is just one point, the cycle Λ = [M ],
and because of the Riemann-Roch relationship (8.4) in [MQ] (or Theorem 7.44 in
[BGV]) the above integral character formula will reduce to the classical Riemann-
Roch-Hirzebruch formula. There is no curvature of the line bundle (E, ∇E ) present
in the character formula (18) because we assume that the connection ∇E is flat so
that O(E) is a quasi-GC -equivariant DM -module.


                                5. Proof of Theorem 1
   We start our proof by applying the fixed point character formula (2) combined
with (3) due to W. Schmid and K. Vilonen [SchV2] to the right hand side of
(13). Thus the character θ of the virtual representation (13) is given by integration
against a function Fθ on gR :
                                Z
(19)                    θ(ϕ) =      Fθ ϕ,     ϕ ∈ Ωtop
                                                    c (gR ).
                                    gR

This function Fθ is an Ad(GR )-invariant, locally L1 function on gR whose restriction
to the set of regular semisimple elements grs
                                            R can be represented by a real analytic
function. The value of this analytic function at X ∈ grsR is determined by zeroes of
the vector field XB on the flag variety B as follows.
   Recall that tC (X) ⊂ gC is the unique Cartan subalgebra containing X ∈ grs R . Let
Ψ(X) ⊂ t∗C (X) be the root system of gC with respect to tC (X) and pick a positive
14                                        MATVEI LIBINE


root system Ψ≤ (X) ⊂ Ψ such that
                           Re α(X) ≤ 0             for all α ∈ Ψ≤ (X).
Let B(X) ⊂ GC be the Borel subgroup whose Lie algebra contains tC (X) and the
positive root spaces corresponding to Ψ≤ (X). The action of B(X) on B has exactly
the same number of orbits O1 , . . . , O|W | as the order of the Weyl group W of GC .
Each of these orbits Ok contains exactly one zero of the vector field XB , and we
order the zeroes {b1 , . . . , b|W | } of XB so that bk is contained in Ok , k = 1, . . . , |W |.
The set of zeroes {b1 , . . . , b|W | } is precisely the set of Borel subalgebras containing
tC (X). Let Ψ+ bk (X) ⊂ Ψ(X) be the positive root system such that bk contains all
the negative root spaces, k = 1, . . . , |W |. Then the fixed point character formula
[SchV2] says that the function Fθ which appeared in the equation (19) is
                                          |W |
                                          X                   e−hX,λbk i
                                      d
(20)                 Fθ (X) = (−1)               mbk (X) Q                 ,
                                          k=1                α∈Ψ+ (X) α(X)
                                                                 bk


where mbk (X)’s are integer multiplicities given by the formula
                                                                         
(21)   mbk (X) = χ HO  ∗
                           (Rp∗ (S))                                    e .
                                 e b = χ (j{b }֒→O )∗ ◦ (jO ֒→B )! Rp∗ (S)
                         k           k          k     k       k


   Let DB and DB×M denote the Verdier duality operators on B and B × M respec-
tively:
                            b                                  b
                  DB :     DG R ,−λ−ρ,R−c
                                          (CB )         −→
                                                         ˜    DG R ,λ+ρ,R−c
                                                                            (CB );


                          b                         b
(22)        DB×M :       DG R ,−λ−ρ,R−c
                                        (CB×M ) −→
                                                 ˜ DG R ,λ+ρ,R−c
                                                                 (CB×M ).
The effect of the Verdier duality operator DZ on the characteristic cycle of an R-
                                         b
constructible sheaf T (or an element of DR−c (CZ )) on any smooth quasi-projective
variety Z is described by
                                  Ch(DZ (T )) = Ch(T )a ,
where a : T ∗ Z → T ∗ Z is the antipodal map ζ 7→ −ζ and Ch(T )a denotes the image
under this antipodal map of the characteristic cycle of T .
   For a regular semisimple element X ∈ grs  C we denote by TC (X) = exp(tC (X)) ⊂
GC the maximal complex torus corresponding to the unique Cartan subalgebra
containing X. If x ∈ M is a point fixed by TC (X); then TC (X) acts linearly on
the tangent space Tx M . We denote by ∆(X) ⊂ tC (X)∗ the set of weights of tC (X)
which are either roots of gC or occur in the tangent space Tx M of some point x ∈ M
fixed by TC (X).
   Let g′R denote the set of strongly regular semisimple elements X ∈ grs   R which
satisfy the following additional properties. If tR (X) ⊂ gR and tC (X) ⊂ gC are the
unique Cartan subalgebras in gR and gC respectively containing X, then:
    (1) The set of zeroes of the vector field XM is exactly the set of points in M
         fixed by the complex torus TC (X) = exp(tC (X)) ⊂ GC ;
    (2) β(X) 6= 0 for all β ∈ ∆(X) ⊂ tC (X)∗ ;
    (3) For each β ∈ ∆(X), we have either
(23)                     Re(β)|tR (X) ≡ 0          or        Re(β(X)) 6= 0.
                 RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA                                    15


Clearly, g′R is an open subset of gR ; since M is compact and ∆(X) is finite, the
complement of g′R in gR has measure zero.
   From now on we will assume that the element X ∈ gR is not only regular semisim-
ple, but also lies in g′R . Then applying the integral localization formula of [L3] to
the integral character formula (15), with the global formula for the multiplicities,
we can rewrite the formula (21) as
(24)
                                                                                 
  mbk (X) = χ B, DB (Rp∗ (S))  e                                                e
                                      = χ B, (jOk ֒→B )! ◦ (jOk ֒→B )∗ DB (Rp∗ (S))  .
                                  O
                                  k


Applying Proposition 2.5.11 from [KaScha] to the Cartesian square
                                Ok × M       ֒→    B×M
                                   ↓                ↓
                                  Ok         ֒→     B
and using that the projection map p is proper we obtain:
                                                            
                                                         e
(25) mbk (X) = χ B, (jOk ֒→B )! ◦ (jOk ֒→B )∗ Rp! (DB×M (S))
                                                                    
                                                                 e
               = χ B, (jOk ֒→B )! ◦ Rp! ◦ (jOk ×M֒→B×M )∗ (DB×M (S))
                                                                    
                                                                 e
           = χ B, Rp! ◦ (jOk ×M֒→B×M )! ◦ (jOk ×M֒→B×M )∗ (DB×M (S))
                                                                    
           = χ B × M, (jO ×M֒→B×M )! ◦ (jO ×M֒→B×M )∗ (DB×M (S)) e
                            k                      k
                                                                               
                                                                         e O ×M .
                                                       = χ B × M, (DB×M (S)) k



   Next we will compare this result with the result of application of the integral
localization formula of [L3] to the integral (18). Let
                                          a
                               M=                   Õx
                                      {x∈M; XM (x)=0}

be the Bialynicki-Birula decomposition [Bi] of M into attracting sets (relative to
X), as described in [L3]. To obtain this decomposition we pick any X ′ ∈ tR (X) ∩ g′R
in the same connected component of tR (X) ∩ g′R and such that
  Re β(X) > 0 ⇐⇒ Re β(X ′ ) > 0             and        Re β(X) < 0 ⇐⇒ Re β(X ′ ) < 0
for all β ∈ ∆(X), and the complex 1-dimensional subspace {tX ′ ; t ∈ C} ⊂ gC is
the Lie algebra of a closed algebraic subgroup C× (X ′ ) ⊂ GC isomorphic to C× .
We fix an embedding of C× (X ′ ) ≃ C× into C so that the tangent map sends
X ′ ∈ Te (C× (X ′ )) into an element with nonnegative real part. This embedding
allows us to take limits as z ∈ C× (X ′ ) approaches to zero, and for each x ∈ M with
XM (x) = 0 we set
                          Õx = {y ∈ M ; lim z −1 · y = x}.
                                             z→0

The sets Õx are smooth locally closed algebraic subvarieties of M .
  Then

  {x ∈ B × M ; XB×M (x) = 0}
                 =    {x ∈ B; XB (x) = 0} × {x ∈ M ; XM (x) = 0}
                                        =     {b1 , . . . , b|W | } × {x ∈ M ; XM (x) = 0}
16                                       MATVEI LIBINE


is the set of zeroes of the vector field XB×M , and
                                           a
                       B×M =                                      Ok × Õx
                                         k = 1, . . . , |W |
                                      {x ∈ M ; XM (x) = 0}
is the Bialynicki-Birula decomposition of B × M into attracting sets (relative to
X). Applying the integral localization formula to the integral (18) yields
          Z Z                                                               Z
     in              ∗ hX,µB (ζ)−λx i+σB +τλ      ∗
                  p̃  e                      ∧ q̃   Thom ∗
                                                        T M ∧ϕ(X)           =     F̃θ ϕ
 (2πi)d+n Λ gR                                                     [2(d+n)]    gR
                                    ′
for any ϕ ∈ Ωtop
             c (gR ) with supp ϕ ⊂ gR , where the function F̃θ is
                              |W |
                              X              X                        e−hX,λbk i
(26)        F̃θ (X) = (−1)d                                m̃k,x (X) Q             ,
                              k=1 {x∈M; XM (x)=0}                    α∈Ψ+ (X) α(X)
                                                                         bk


and
                                                      
                                 e
     m̃k,x (X) = χ B × M, (DB×M (S))Ok ×Õx
                                                                                    
                                                                                 e .
                       = χ(B × M, (jOk ×Õx ֒→B×M )! ◦ (jOk ×Õx ֒→B×M )∗ (DB×M (S))

We want to show that F̃θ (X) = Fθ (X). We have:
       X                           X                                  
                m̃k,x (X) =                                e
                                           χ B × M, (DB×M (S))Ok ×Õx
     {x∈M; XM (x)=0}                 {x∈M; XM (x)=0}
                                                                       
                                                                 e O ×M = mb (X).
                                               = χ B × M, (DB×M (S)) k      k


Combining this with the equations (20) and (26) we obtain
                                      |W |
                                      X                e−hX,λbk i
                  F̃θ (X) = (−1)d            mx k Q                 = Fθ (X),
                                      k=1             α∈Ψ+ (X) α(X)
                                                            bk


which proves (18) at least when supp(ϕ) ⊂                 g′R .
                                                 Since the function Fθ is known to
be a character of some representation (namely (11)), it is locally L1 and the main
result of [L3] now proves (18) for all ϕ ∈ Ωtop
                                            c (gR ).


                 6. An example on the enhanced flag variety
   The purpose of this section is to show how Theorem 1 can be applied to smooth
quasi-projective varieties which are not necessarily projective. We let our group
GR be GL(N, R) ⊂ GL(N, C) = GC , for some N ∈ N; we denote by BC the group
of all invertible lower-triangular matrices and by NC ⊂ BC the group of lower-
triangular unipotent matrices, we set BR = BC ∩GR and NR = NC ∩GR . We will be
interested in the complex homogeneous space ZC = GC /NC and its real submanifold
ZR = GR /NR ⊂ ZC . The space ZC can be regarded as a fiber bundle over the flag
variety B = GC /BC with fibers isomorphic to HC =def BC /NC ≃ (C× )N . It is
easy to see that these fibers can be identified with each other in a canonical way.
This allows us to think of ZC as a trivial principal HC -bundle which is also a GC -
equivariant fiber bundle, and the actions of HC and GC commute. W. Schmid and
K. Vilonen call ZC the enhanced flag variety of gC [SchV2].
                 RIEMANN-ROCH-HIRZEBRUCH INTEGRAL FORMULA                                      17


   Let S ′ = (jZR ֒→ZC )∗ (CZR ) denote the sheaf on ZC which is the direct image of
the constant sheaf on ZR . Fix a λ ∈ h∗C and denote by ker χλ−ρ ⊂ Z(gC ) the kernel
of the character χλ−ρ : Z(gC ) → C, and take a DZC -module
                              M′ = DZC /γZC (ker χλ−ρ )DZC .
Notice that by construction Z(gC ) acts on M′ by character χλ−ρ . We form a virtual
representation of GR
(27)                           RHomtop  ′   ′
                                   DZ (M ⊗ S , OZC ).
                                                 an
                                          C

The composition factors of this representation are known to be the principal series
representations of GR which have the same character on gR . We will obtain an in-
tegral formula for the character of this representation. Of course, the homogeneous
space ZC is not compact, and in order to apply Theorem 1 we need to compactify
ZC first.
   Recall that ZC is a principal (HC , GC )-equivariant fiber bundle with commuting
HC - and GC -actions. Hence we can embed HC =def BC /NC ≃ (C× )N into the
vector space CN and form a GC -equivariant vector bundle Z̃C ≃ CN × B with an
embedding ZC ֒→ Z̃C of GC -equivariant fiber bundles over B. Next we form a line
bundle L0 = C × B over B with trivial GC -action on the first factor and form a
projectivization M =def P(Z̃C ⊕ L0 ). Then M is a smooth complex projective
variety, GC acts on M algebraically, and M contains ZC as a dense open subset.
Define
   M = DM /γM (ker χλ−ρ )DM              and       S = (jZC ֒→M )! S ′ = (jZR ֒→M )! (CZR ).
   For convenience we restate Theorem 5.12 of [KaSchm]:
Theorem 2. Let f : X → Y be a GC -equivariant morphism between complex
algebraic, quasi-projective GC -manifolds X, Y . If f is projective, there exists an
isomorphism
                                                 Z                
  RHomtopDX (M  ⊗ f −1
                    an T , OX an ) ≃   RHom  top
                                             DY      M ⊗ T , OY an [− dim X/Y ],
                                                          f
                          b                            b
functorially in T ∈      DG R ,R−c
                                   (CY
                                   ) and M ∈          DG C ,coh
                                                                (DX )   (the bounded derived
category of Modcoh
                quasi−GC −eq (DX )). If f is smooth,

RHomtop   ∗
    DX (Lf M ⊗ T , OX an )         ≃     RHomtop
                                             DY (M ⊗ R(fan )! T , OY an )[−2 dim X/Y ],
                     b                       b
functorially in M ∈ DG C ,coh
                              (DY ) and T ∈ DG R ,R−c
                                                      (CX ).
  Applying the second part of this theorem to the open inclusion ZC ֒→ M we can
rewrite our virtual representation (27) as
           RHomtop  ′   ′
               DZ (M ⊗ S , OZC )
                             an                ≃    RHomtop
                                                        DM (M ⊗ S, OM an ).
                     C

                                                   coh,λ−ρ
The DM -module M is Z(gC )-finite and lies in Modquasi−G   C −eq
                                                                 (DM ) essentially by
construction. It follows from the Bruhat decomposition of GC that BC acts on
M with finitely many orbits; this implies that M is admissible. It is easy to see
that each maximal torus TC acts on M with finitely many fixed points. Therefore
Theorem 1 applies here and we obtain an integral formula for the character of the
virtual representation (27). This is probably the most complicated formula for the
principal series character there is.
18                                     MATVEI LIBINE


                                       References
[BB]       A. Beilinson and J. Bernstein, Localisation de g-modules, C. R. Acad. Sci. Paris 292
           (1981), 15-18.
[BGV]      N. Berline, E. Getzler, M. Vergne, Heat Kernels and Dirac Operators, Springer-Verlag,
           1992.
[BV]       N. Berline and M. Vergne, Classes caractéristiques équivariantes. Formules de local-
           isation en cohomologie équivariante, C. R. Acad. Sci. Paris 295 (1982), 539-541.
[Bi]       A. Bialynicki-Birula, Some theorems on actions of algebraic groups, Ann. of Math.,
           98 (1973), 480-497.
[Bo]       A. Borel et al., Algebraic D-modules, Perspectives in Mathematics, Academic Press,
           1987.
[Gi]       V. Ginzburg, g-modules, Springer’s representations and bivariant Chern classes, Ad-
           vances in Math. 61 (1986), 385-438.
[GM]       M. Goresky and R. MacPherson, Local contribution to the Lefschetz fixed point for-
           mula, Inventiones Math. 111 (1993), 1-33.
[GS]       V. Guillemin and S. Sternberg, Supersymmetry and Equivariant de Rham Theory,
           Springer-Verlag, 1999.
[Ka]       M. Kashiwara, Character, character cycle, fixed point theorem, and group represen-
           tations, Advanced Studies in Pure Mathematics, vol. 14, Kinokuniya, Tokyo, 1988,
           369-378.
[KaMF]     M. Kashiwara and T. Monteiro-Fernandes, Involutivité des variétés microcar-
           actéristiques, Bull. Soc. Math. France 114 (1986), 393-402.
[KaScha]   M. Kashiwara and P. Schapira, Sheaves on Manifolds, Springer, 1990.
[KaSchm]   M. Kashiwara and W. Schmid, Quasi-equivariant D-modules, equivariant derived cat-
           egory, and representations of reductive Lie groups, Lie Theory and Geometry, in
           Honor of Bertram Kostant, Progress in Mathematics, vol. 123, Birkhäuser, Boston,
           1994, pp. 457-488.
[L1]       M. Libine, A localization argument for characters of reductive Lie groups, Jour. Func.
           Anal. 203 (2003), 197-236, also math.RT/0206019.
[L2]       M. Libine, A localization argument for characters of reductive Lie groups: an in-
           troduction and examples in P. Delorme, M. Vergne (Eds.), “Noncommutative Har-
           monic Analysis: In Honor of Jacques Carmona”, Progress in Mathematics, vol. 220,
           Birkhäuser, 2004, pp. 375-394; also math.RT/0208024.
[L3]       M. Libine, Integrals of equivariant forms and a Gauss-Bonnet theorem for con-
           structible sheaves, math.DG/0306152, 2003.
[MQ]       V. Mathai and D. Quillen, Superconnections, Thom classes and equivariant differen-
           tial forms, Topology 25 (1986), 85-110.
[Ro]       W. Rossmann, Invariant Eigendistributions on a Semisimple Lie Algebra and Homol-
           ogy Classes on the Conormal Variety I, II, Jour. Func. Anal. 96 (1991), 130-193.
[Sch]      W. Schmid, Character formulas and localization of integrals, Deformation Theory and
           Symplectic Geometry, Mathematical Physics Studies, 20 (1997), Kluwer Academic
           Publishers, 259-270.
[SchV1]    W. Schmid and K. Vilonen, Characteristic cycles of constructible sheaves, Inventiones
           Math. 124 (1996), 451-502.
[SchV2]    W. Schmid and K. Vilonen, Two geometric character formulas for reductive Lie
           groups, Jour. AMS 11 (1998), 799-876.
[Schü]    J. Schürmann, Topology of Singular Spaces and Constructible Sheaves, Monografie
           Matematyczne, vol. 63, Birkhäuser, 2003.
[Su]       H. Sumihiro, Equivariant Completion, J. Math. Kyoto Univ. 14 (1974), 1-28.

  Department of Mathematics and Statistics, University of Massachusetts, Lederle
Graduate Research Tower, 710 North Pleasant Street, Amherst, MA 01003
  E-mail address: matvei@math.umass.edu
