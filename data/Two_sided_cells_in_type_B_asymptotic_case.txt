                                                       TWO-SIDED CELLS IN TYPE B (ASYMPTOTIC CASE)

                                                                                      CÉDRIC BONNAFÉ


                                                     Abstract. We compute two-sided cells of Weyl groups of type B for the “asymptotic”
arXiv:math/0502086v3 [math.RT] 30 Jun 2006




                                                     choice of parameters. We also obtain some partial results concerning Lusztig’s conjectures
                                                     in this particular case.



                                                Let Wn be a Weyl group of type Bn . The present paper is a continuation of the
                                             work done by L. Iancu and the author [3] concerning Kazhdan-Lusztig theory of Wn for
                                             the asymptotic choice of parameters [3, §6]. To each element w ∈ Wn is associated a
                                             pair of standard bi-tableaux (P (w), Q(w)) (see [19] or [3, §3]): this can be viewed as
                                             a Robinson-Schensted type correspondence. Our main result [3, Theorem 7.7] was the
                                             complete determination of the left cells: two elements w and w′ are in the same left cell
                                             if and only if Q(w) = Q(w′ ). For the corresponding result for the symmetric group, see
                                             [12] and [1]. We have also computed the character afforded by a left cell representation
                                             [3, Proposition 7.11] (this character is irreducible).
                                                In this paper, we are concerned with the computation of the two-sided cells. Let us
                                             state the result here. If w ∈ Wn , write Q(w) = (Q+ (w), Q− (w)) and denote by λ+ (w)
                                             and λ− (w) the shape of Q+ (w) and Q− (w) respectively. Note that (λ+ (w), λ− (w)) is a
                                             bipartition of n.

                                             Theorem (see 3.9). For the choice of parameters as in [3, §6], two elements w and w′
                                             are in the same two-sided cell if and only if (λ+ (w), λ− (w)) = (λ+ (w′ ), λ− (w′ )).

                                                Lusztig [17, Chapter 14] has proposed fifteen conjectures on Kazhdan-Lusztig theory
                                             of Hecke algebras with unequal parameters. In the asymptotic case, Geck and Iancu [9]
                                             use some of our results, namely some informations on the preorder 6LR (see Theorem 3.5
                                             and Proposition 4.2), to compute the function a and to prove Lusztig’s conjectures Pi , for
                                             i ∈ {1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 13, 14}. On the other hand, Geck [8] has shown that Lusztig’s
                                             conjectures P9 and P10 hold. More precisely, he proved that the Kazhdan-Lusztig basis
                                             is cellular (in the sense of [11]). He also proved a slightly weaker version of P15 (but his
                                             version is sufficient for constructing the homomorphism from the Hecke algebra to the
                                             asymptotic algebra J).

                                                The present paper is organized as follows. In Section 1, we study some consequences
                                             of Lusztig’s conjectures on the multiplication by Tw0 , where w0 is the longest element of
                                               Date: January 4, 2018.
                                               1991 Mathematics Subject Classification. According to the 2000 classification: Primary 20C08; Sec-
                                             ondary 20C15.
                                                                                                 1
2                                          C. Bonnafé


a finite Weyl group. From Section 2 to the end of the paper, we assume that the Weyl
group is of type Bn and that the choice of parameters is done as in [3, §6]. In Section 2,
we establish some preliminary results concerning the Kazhdan-Lusztig basis. In Section
3, we prove the above theorem by introducing a new basis of the Hecke algebra: this was
inspired by the work of Geck on the induction of Kazhdan-Lusztig cells [7]. Section 4
contains some results related to Lusztig’s conjectures. In Section 5, we determine which
specializations of the parameters preserve the Kazhdan-Lusztig basis.


                                       1. Generalities



1.A. Notation. We slightly modify the notation used in [3, §5]. Let (W, S) be a Coxeter
group with |S| < ∞. We denote by ℓ : W → N = {0, 1, 2, . . . } the length function relative
to S. If W is finite, w0 denotes its longest element. Let 6 denote the Bruhat ordering on
W . If I ⊂ S, we denote by WI the standard parabolic subgroup of W generated by I.
   Let Γ be a totally ordered abelian group which will be denoted additively. The order
on Γ will be denoted by 6 . If γ0 ∈ Γ, we set

                  Γ<γ0 = {γ ∈ Γ | γ < γ0 },         Γ 6 γ0 = {γ ∈ Γ | γ 6 γ0 },

              Γ>γ0 = {γ ∈ Γ | γ > γ0 }        and        Γ > γ0 = {γ ∈ Γ | γ > γ0 }.
Let A be the group algebra of Γ over Z. It will be denoted exponentially: as a Z-module,
                                                                               ′       ′
it is free with basis (v γ )γ∈Γ and the multiplication rule is given by v γ v γ = v γ+γ for all γ,
γ ′ ∈ Γ. If a ∈ A, we denote by aγ the coefficient of a on v γ , so that a = γ∈Γ aγ v γ . If
                                                                                  P

a 6= 0, we define the degree and the valuation of a (which we denote respectively by deg a
and val a) as the elements of Γ equal to

                                   deg a = max{γ | aγ 6= 0}

and                                val a = min{γ | aγ 6= 0}.

By convention, we set deg 0 = −∞ and val 0 = +∞. So deg : A → Γ ∪ {−∞} and
val : A → Γ ∪ {+∞} satisfy deg ab = deg a + deg b and val ab = val a + val b for all a, b ∈ A.
We denote by A → A, a 7→ ā the automorphism of A induced by the automorphism of Γ
sending γ to −γ. Note that deg a = − val ā. If γ0 ∈ Γ, we set

                          A<γ0 = ⊕ Zv γ ,           A 6 γ0 =     ⊕ Zv γ ,
                                   γ<γ0                        γ 6 γ0

                      A>γ0 = ⊕ Zv γ          and         A > γ0 =       ⊕ Zv γ .
                               γ>γ0                                 γ > γ0

  We fix a weight function L : W → Γ, that is a function satisfying L(ww′ ) = L(w)+L(w′ )
whenever ℓ(ww′ ) = ℓ(w)+ℓ(w′ ). We also assume that L(s) > 0 for every s ∈ S. We denote
by H = H(W, S, L) the Hecke algebra of W associated to the weight function L. It is the
                                       Two-sided cells in type B                             3


associative A-algebra with A-basis (Tw )w∈W indexed by W and whose multiplication is
determined by the following two conditions:
         (a)             Tw Tw′ = Tww′                         if ℓ(ww′ ) = ℓ(w) + ℓ(w′ )
         (b)             Ts2 = 1 + (v L(s) − v −L(s) )Ts       if s ∈ S.
It is easily seen from the above relations that (Ts )s∈S generates the A-algebra H and that
Tw is invertible for every w ∈ W . If h = w∈W aw Tw ∈ H, we set h = w∈W aw Tw−1
                                             P                               P
                                                                                        −1 .

Then the map H → H, h 7→ h is a semi-linear involutive automorphism of H. If I ⊂ S, we
denote by H(WI ) the sub-A-algebra of H generated by (Ts )s∈I .
   Let w ∈ W . By [17, Theorem 5.2], there exists a unique element Cw ∈ H such that
                           (a)         Cw = C w         
                           (b)         Cw ∈ Tw + ⊕ A<0 Ty .
                                                        y∈W

                         p∗y,w Ty with p∗y,w ∈ A. Then [17, 5.3]
               P
Write Cw =         y∈W

                                       p∗w,w = 1
                                       p∗y,w = 0           if y 66 w.
In particular, (Cw )w∈W is an A-basis of H: it is called the Kazhdan-Lusztig basis of H.
Write now py,w = v L(w)−L(y) p∗y,w . Then
                                              py,w ∈ A > 0
and the coefficient of py,w on v 0 is equal to 1 (see [17, Proposition 5.4 (a)].
  We define the relations 6L , 6R , 6LR , ∼L , ∼R and ∼LR as in [17, §8].

1.B. The function a. Let x, y ∈ W . Write
                                       X
                               Cx Cy =    hx,y,z Cz ,
                                                   z∈W
where hx,y,z ∈ A for z ∈ W . Of course, we have
(1.1)                                        hx,y,z = hx,y,z .
  The following lemma is well-known [17, Lemma 10.4 (c) and formulas 13.1 (a) et (b)].

Lemma 1.2. Let x, y and z be three elements of W . Then
                                    deg hx,y,z 6 min(L(x), L(y)).


Conjecture P 0 (Lusztig):             There exists N ∈ Γ such that deg hx,y,z 6 N for all x, y
and z in W .

   If W is finite, then W satisfies obviously P0 . If W is an affine Weyl group, then it
also satisfies P0 [16, 7.2]. From now on, we assume that W satisfies P0 , so that the next
definition is valid. If z ∈ W , we set
                                       a(z) = max deg hx,y,z .
                                                x,y∈W
4                                                C. Bonnafé


Since h1,z,z = 1, we have a(z) ∈ Γ > 0 . If necessary, we will write aW (z) for a(z). We
denote by γx,y,z −1 ∈ Z the coefficient of v a(z) in hx,y,z . The next proposition shows how
the function a can be calculated by using different bases.

Proposition 1.3. Let (Xw )w∈W and (Yw )w∈W be two families of elements of H such that,
for every w ∈ W , Xw − Tw and Yw − Tw belong to ⊕y<w A<0 Ty . For all x and y in W ,
write
                                        X
                               Xx Yy =     ξx,y,z Cz .
                                                    z∈W
Then, if x, y, z ∈ W , we have:
      (a) deg ξx,y,z 6 min{L(x), L(y)}.
      (b) ξx,y,z ∈ γx,y,z −1 v a(z) + A<a(z) .
In particular,
                                         a(z) = max deg ξx,y,z .
                                                 x,y∈W

Proof - Clear.        



1.C. Lusztig’s conjectures. Let τ : H → A be the A-linear map such that τ (Tw ) = δ1,w
if w ∈ W . It is the canonical symmetrizing form on H (recall that τ (Tx Ty ) = δxy,1 ). If
z ∈ W , let
                                   ∆(z) = − deg p∗1,z = − deg τ (Cz ).
Let nz be the coefficient of p∗1,z on v −∆(z) . Finally, let

                                     D = {z ∈ W | a(z) = ∆(z)}.

Conjectures (Lusztig): With the above notation, we have:
     P 1.    If z ∈ W , then a(z) 6 ∆(z).
     P 2.    If d ∈ D and if x, y ∈ W satisfy γx,y,d 6= 0, then x = y −1 .
     P 3.    If y ∈ W , then there exists a unique d ∈ D such that γy−1 ,y,d 6= 0.
     P 4.    If z ′ 6LR z, then a(z) 6 a(z ′ ). Therefore, if z ∼LR z ′ , then a(z) = a(z ′ ).
     P 5.    If d ∈ D and y ∈ W satisfy γy−1 ,y,d 6= 0, then γy−1 ,y,d = nd = ±1.
     P 6.    If d ∈ D, then d2 = 1.
     P 7.    If x, y, z ∈ W , then γx,y,z = γy,z,x .
     P 8.    If x, y, z ∈ W satisfy γx,y,z 6= 0, then x ∼L y −1 , y ∼L z −1 and z ∼L x−1 .
     P 9.    If z ′ 6L z and a(z ′ ) = a(z), then z ′ ∼L z.
    P 10 .   If z ′ 6R z and a(z ′ ) = a(z), then z ′ ∼R z.
    P 11 .   If z ′ 6LR z and a(z ′ ) = a(z), then z ′ ∼LR z.
    P 12 .   If I ⊂ S and z ∈ WI , then aWI (z) = aW (z).
    P 13 .   Every left cell C of W contains a unique element d ∈ D. If y ∈ C, then γy−1 ,y,d 6= 0.
    P 14 .   If z ∈ W , then z ∼LR z −1 .
                                         Two-sided cells in type B                          5


 P 15 . If x, x′ , y, w ∈ W are such that a(y) = a(w), then
                        X                           X
                            hw,x′ ,y′ ⊗Z hx,y′ ,y =   hy′ ,x′ ,y ⊗Z hx,w,y′
                         y ′ ∈W                             y ′ ∈W

       in A ⊗Z A.

  Lusztig has shown that these conjectures hold if W is a finite or affine Weyl group and
L = ℓ [17, §15], if W is dihedral and L is any weight function [17, §17] and if (W, L) is
quasi-split [17, §16].


1.D. Lusztig’s conjectures and multiplication by Tw0 . We assume in this subsection
that W is finite. We are interested here in certain properties of the multiplication by Twn0
for n ∈ Z. Some of them are partially known [14, Lemma 1.11 and Remark 1.12]. If y ∈ W
and n ∈ Z, we set
                                             X
                                   Twn0 Cy =     λ(n)
                                                   x,y Cx .
                                                        x∈W
             (n)
Note that   λx,y   = 0 if x 66L y.

Proposition 1.4. Assume that W is finite and satisfies Lusztig’s conjectures P1 , P4 and
P8 . Let n ∈ Z and let x and y be two elements of W such that x 6L y. Then:
                                  (n)                                                 (n)
   (a) If n > 0, then deg λx,y 6 n(a(x) − a(w0 x)). If moreover x <L y, then deg λx,y <
       n(a(x) − a(w0 x)).
                            (n)                                                   (n)
   (b) If n 6 0, then deg λx,y 6 n(a(y) − a(w0 y)). If moreover x <L y, then deg λx,y <
       n(a(y) − a(w0 y)).
                                         (n)
   (c) If n is even and if x ∼L y, then λx,y = δx,y v n(a(x)−a(w0 x)) .

Proof - If n = 0, then (a), (b) and (c) are easily checked. Let us now prove (a) and (b).
By [17, Proposition 11.4],
                                    X
                             Tw0 =      (−1)ℓ(w0 u) p∗1,w0 u Cu .
                                             u∈W

Consequently,
                                            X
                                  λ(1)
                                   x,y =            (−1)ℓ(w0 u) p∗1,w0 u hu,y,x .
                                            u∈W
                                           x 6R u

But, by P1 , we have deg p∗1,w0 u 6 −a(w0 u). If moreover x 6R u, then w0 u 6R w0 x and so
−a(w0 x) > −a(w0 u) by P4 . Therefore

                                        deg λ(1)
                                             x,y 6 a(x) − a(w0 x).
                                  (1)
On the other hand, if deg λx,y = a(x) − a(w0 x), then there exists u ∈ W such that x 6R u
and deg hu,y,x = a(x). So, by P8 , we get that x ∼L y. This shows (a) for n = 1.
6                                            C. Bonnafé


  Now, let ν : H → H denote the A-linear map such that ν(Cw ) = v a(w0 w)−a(w)Cw for all
w ∈ W and let µ : H → H, h 7→ Tw0 h. Then, if w ∈ W , we have
                                    X
                        νµ(Cy ) =        v a(w0 u)−a(u) λ(1)
                                                         u,y Cu .
                                          u 6L y

                                                              (1)
So, by the previous discussion, we have v a(w0 u)−a(u) λu,y ∈ A 6 0 . Moreover, if u <L y, then
                (1)
v a(w0 u)−a(u) λu,y ∈ A<0 . On the other hand, det µ = ±1 and det ν = 1. Therefore, if we
write
                                                 X
                                µ−1 ν −1 (Cy ) =       βu,y Cu ,
                                                     u 6L y

then βu,y ∈ A 6 0 and, if u <L y, then βu,y ∈ A<0 . Finally,

                           Tw−1
                              0
                                Cy = µ−1 (Cy )
                                        = µ−1 ν −1 ν(Cy )
                                        = v a(w0 y)−a(y) µ−1 ν −1 (Cy )
                                            X
                                        =         v a(w0 y)−a(y) βu,y Cu .
                                            u 6L y

                   (−1)
In other words, λx,y = v a(w0 y)−a(y) βx,y . This shows that (b) holds if n = −1. An
elementary induction argument using P4 shows that (a) and (b) hold in full generality.

   Let us now prove (c). Let K be the field of fraction of A. Let C be a left cell of W and
let c ∈ C. We set

                   H 6L C =     ⊕      ACw         and        H<L C = ⊕ ACw .
                              w 6L c                                  w<L c

Then H 6L C and H<L C are left ideals of H. The algebra KH = K ⊗A H being semisimple,
there exists a left ideal IC of KH such that KH 6L C = KH<L C ⊕ IC .
  We need to prove that, for all h ∈ IC ,

                                    Twn0 h = v n(a(c)−a(w0 c)) h.

For this, we may, and we will, assume that n > 0. Let V1C , V2C ,. . . , VnCC be irreducible
sub-KH ⊗A K-modules of IC such that

                                       IC = V1C ⊕ · · · ⊕ VnCC .

Let j ∈ {1, 2, . . . , nC }. Since Twn0 is central and invertible in H, there exists ε ∈ {1, −1}
and iC
     j ∈ Γ such that
                                                         C
                                           Twn0 h = εv ij h

for every h ∈ VjC . By specializing v γ 7→ 1, we get that ε = 1. Moreover, by (a) and (b),
iC                                                                            n
 j 6 n(a(c) − a(w0 c)). On the other hand, since det µ = ±1, we have det µ = 1. But
                                      Two-sided cells in type B                                 7


det µn = v r , where

                                     X      nC
                                            X
                       r   =                     iC
                                                  j dim Vj
                                                          C

                                C∈LC(W ) j=1
                                      X                           nC
                                                                  X
                           6    n            (a(C) − a(w0 C))           dim VjC
                                    C∈LC(W )                      j=1
                                      X
                           =    n            (a(C) − a(w0 C))|C|
                                    C∈LC(W )
                                     X
                           =    n         (a(w) − a(w0 w))
                                    w∈W
                           =    0.

Here, LC(W ) denotes the set of left cells in W and, if C ∈ LC(W ), a(C) denotes the value
of a on C (according to P4 ). The fact that r = 0 forces the equality iC
                                                                       j = n(a(C)−a(w0 C))
for every left cell C and every j ∈ {1, 2, . . . , nC }. 



Remark 1.5 - Assume here that w0 is central in W and keep the notation of the proof of
Proposition 1.4 (c). Let j ∈ {1, 2, . . . , nC }. Then there exists εj (C) ∈ {1, −1} et ej (C) ∈ Γ
such that Tw0 h = εj (C)v ej (C) h for every h ∈ VjC .

Question: Let j, j ′ ∈ {1, 2, . . . , nC }. Does εj (C) = εj ′ (C) ?

  A positive answer to this question would allow to generalize Proposition 1.4 (c) to the
case where w0n is central. 



Corollary 1.6. Assume that W is finite and satisfies Lusztig’s conjectures P1 , P2 , P4 , P8 ,
P9 and P13 . Let w ∈ W and let n ∈ N. Then deg τ (Tw−n
                                                     0
                                                       Cw ) 6 −a(w) + n(a(w0 w) − a(w)).
Moreover, deg τ (Tw0 Cw ) = −a(w) + n(a(w0 w) − a(w)) if and only if w0n w−1 ∈ D.
                   −n



Proof - Assume first that n is even. In particular, w0n = 1. By Proposition 1.4, we have
                                                                X
                   τ (Tw−n
                         0
                           Cw ) = v n(a(w0 w)−a(w)) τ (Cw ) +           λ(−n)
                                                                         x,w τ (Cx ).
                                                                x<L w


But, if x <L w, then deg τ (Cx ) = −∆(x) 6 −a(x) 6 −a(w) by P1 and P4 . So, by Propo-
                                  (−n)
sition 1.4 (b), we have that deg λx,w τ (Cx ) < −a(w) + n(a(w0 w) − a(w)). Moreover, again
by P1 , we have deg τ (Cw ) = −∆(w) 6 −a(w). This shows that deg τ (Tw−n  0
                                                                            Cw ) 6 −a(w) +
n(a(w0 w) − a(w)) and that equality holds if and only if ∆(w) = a(w), that is, if and only
if w ∈ D, as desired.
8                                            C. Bonnafé


  Assume now that n = 2k+1 for some natural number k. Recall that, by [17, Proposition
11.4], Tw0 = u∈W (−1)ℓ(w0 u) p∗1,w0u Cu . Therefore
            P
                          X
             Tw−n
                0
                  Cw =          (−1)ℓ(w0 u) p∗1,w0 u Tw−n−1
                                                        0
                                                            Cu Cw
                               u∈W
                                      X
                         =                          (−1)ℓ(w0 u) p∗1,w0u hu,w,x Tw−n−1
                                                                                  0
                                                                                      Cx .
                                     u,x∈W
                               x 6L w and x 6R u

This implies that
                                     X
             τ (Tw−n
                   0
                     Cw ) =                        (−1)ℓ(w0 u) p∗1,w0 u hu,w,xτ (Tw−n−1
                                                                                    0
                                                                                        Cx ),
                                    u,x∈W
                              x 6L w and x 6R u


so           deg τ (Tw−n
                       0
                         Cw ) 6          max             deg(p∗1,w0 u hu,w,x τ (Tw−n−1
                                                                                   0
                                                                                       Cx )).
                                        u,x∈W
                                  x 6L w and x 6R u

Let u and x be two elements of W such that x 6L w and x 6R u. Since n + 1 is even and
by the previous discussion, we have
                    deg τ (Tw−n−1
                              0
                                  Cx ) 6 −a(x) + (n + 1)(a(w0 x) − a(x)).
By P1 and P4 , deg p∗1,w0 u 6 −a(w0 u) 6 −a(w0 x). Moreover, deg hu,w,x 6 a(x). Conse-
quently,
             deg(p∗1,w0 u hu,w,x τ (Tw−n−1
                                       0
                                           Cx ))     6     −a(x) + n(a(w0 x) − a(x))
                                                     6     −a(w) + n(a(w0 w) − a(w)).
Moreover, equality holds if and only if w0 u ∈ D, deg hu,w,x = a(x) = a(w) and x ∈ D.
 We first deduce that
                        deg τ (Tw−n
                                  0
                                    Cw ) 6 −a(w) + n(a(w0 w) − a(w))
which is the first assertion of the proposition.
   Assume now that deg τ (Tw−n 0
                                 Cw ) = −a(w) + n(a(w0 w) − a(w)). Then there exists u
and x in W such that x 6L w, x 6R u, w0 u ∈ D, deg hu,w,x = a(x) = a(w) and x ∈ D.
Since deg hu,w,x = a(x) and x ∈ D, we deduce from P2 that w = u−1 , which shows that
w0 w−1 ∈ D.
   Conversely, assume that w0 w−1 belongs to D. To show that deg τ (Tw−n    0
                                                                              Cw ) = −a(w) +
n(a(w0 w)−a(w)), it is sufficient to show that there is a unique pair (u, x) of elements of W
such that x 6L w, x 6R u, w0 u ∈ D, deg hu,w,x = a(x) = a(w) and x ∈ D. The existence
follows from P13 (take u = w−1 and x be the unique elément of D belonging to the left cell
containing w). Let us now show unicity. Let (u, x) be such a pair. Since deg hu,w,x = a(x)
and x ∈ D, we deduce from P2 that u = w−1 . Moreover, since a(x) = a(w) and x 6L w,
we have x ∼L w by P9 . But, by P13 , x is the unique element of D belonging to the left
cell containing w. 
                                         Two-sided cells in type B                                         9


                      2. Preliminaries on type B (asymptotic case)

  From now on, we are working under the following hypothesis.
        Hypothesis and notation: We assume now that W = Wn is of type Bn ,
        n > 1. We write S = Sn = {t, s1 , . . . , sn−1 } as in [3, §2.1]: the Dynkin
        diagram of Wn is given by
                             t    s1           s2                  sn−1
                              ✐    ✐            ✐        · · ·       ✐

        We also assume that Γ = Z2 and that Γ is ordered lexicographically:
                         (a, b) 6 (a′ , b′ ) ⇐⇒ a < a′ or (a = a′ and b 6 b′ ).
        We set V = v (1,0) and v = v (0,1) so that A = Z[V, V −1 , v, v −1 ] is the Laurent
        polynomial ring in two algebraically independent indeterminates V and v.
        If w ∈ Wn , we denote by ℓt (w) the number of occurences of t in a reduced
        expression of w. We set ℓs (w) = ℓ(w) − ℓt (w). Then ℓs and ℓt are weight
        functions and we assume that L = Ln : Wn → Γ, w 7→ (ℓt (w), ℓs (w)). So
        H = Hn = H(Wn , Sn , Ln ). We denote by Sn the subgroup of W generated
        by {s1 , . . . , sn−1 }: it is isomorphic to the symmetric group of degree n.

   We now recall some notation from [3, §2.1 and 4.1]. Let r1 = t1 = t and, if 1 6 i 6 n−1,
let ri+1 = si ri and ti+1 = si ti si . If 0 6 l 6 n, let al = r1 r2 . . . rl . We denote by Sl , Wl ,
Sl,n−l , Wl,n−l the standard parabolic subgroups of Wn generated by {s1 , s2 , . . . , sl−1 },
{t, s1 , s2 , . . . , sl−1 }, Sn \ {t, sl } and Sn \ {sl } respectively. The longest element of Sl is
denoted by σl . Let
                             Yl,n−l = {a ∈ Sn | ∀ σ ∈ Sl,n−l , ℓ(aσ) > ℓ(σ)}.
If w ∈ Wn is such that ℓt (w) = l, then [3, §4.6] there exist unique aw , bw ∈ Yl,n−l ,
σw ∈ Sl,n−l such that w = aw al σw b−1
                                    w . Recall that ℓ(w) = ℓ(aw ) + ℓ(al ) + ℓ(σw ) + ℓ(bw ).


2.A. Some submodules of H. If l is a natural number such that 0 6 l 6 n, we set
             Tl =      ⊕       ATw ,     T6 l =      ⊕         ATw ,       T> l =      ⊕         ATw ,
                     w∈Wn                          w∈Wn                              w∈Wn
                    ℓt (w)=l                      ℓt (w) 6 l                        ℓt (w) > l

           Cl =     ⊕        ACw ,     C6 l =      ⊕         ACw       and C > l =       ⊕         ACw .
                   w∈Wn                          w∈Wn                                  w∈Wn
                  ℓt (w)=l                      ℓt (w) 6 l                            ℓt (w) > l

Let ΠT? : Hn → T? and ΠC
                       ? : Hn → C? be the natural projections (for ? ∈ {l, 6 l, > l}).


Proposition 2.1. Let l be a natural number such that 0 6 l 6 n. Then:
   (a) Tl and Cl are sub-H(Sn )-modules-H(Sn ) of Hn . The maps ΠTl and ΠC
                                                                         l are mor-
       phisms of H(Sn )-modules-H(Sn ).
   (b) T 6 l = C 6 l .
10                                            C. Bonnafé


     (c) C > l is a two-sided ideal of Hn .

Proof - (a) follows from [3, Theorem 6.3 (b)]. (b) is clear. (c) follows from [3, Corollary
6.7]. 

   The next proposition is a useful characterization of the elements of the two-sided ideal
Cn .

Proposition 2.2. Let h ∈ Hn . The following are equivalent:
     (1) h ∈ Cn .
     (2) ∀x ∈ Hn , (Tt − V )xh = 0.
     (3) ∀x ∈ H(Sn ), (Tt − V )xh = 0.

Proof - If ℓt (w) = n, then tw < w so (Tt − V )Cw = 0 by [17, Theorem 6.6 (b)]. Since Cn
is a two-sided ideal of Hn (see Proposition 2.1 (c)), we get that (1) implies (2). It is also
obvious that (2) implies (3). It remains to show that (3) implies (1).
   Let I = {h ∈ Hn | ∀x ∈ H(Sn ), (Tt − V )xh = 0}. Then I is clearly a sub-H(Sn )-
module-Hn of Hn . We need to show that I ⊂ Cn . In other words, since Cn ⊂ I, we need to
show that I ∩ C 6 n−1 = 0. Let I ′ = I ∩ C 6 n−1 = I ∩ T 6 n−1 (see Proposition 2.1 (b)).
Let X = {w ∈ Wn | τ (I ′ Tw−1 ) 6= 0}. Showing that I ′ = 0 is equivalent to showing that
X = ∅.
   Assume X 6= ∅. Let w be an element of X of maximal length and let h be an element of
 ′
I such that τ (hTw−1 ) 6= 0. Since h ∈ T 6 n−1 , we have ℓt (w) 6 n − 1. Moreover, Tt h = V h,
so τ (Tt hTw−1 ) = τ (hTw−1 Tt ) 6= 0. By the maximality of ℓ(w), we get that tw < w. So,
there exists s ∈ Sn such that sw > w and s 6= t. Then
                    τ (Ts hT(sw)−1 ) = τ (hT(sw)−1 Ts )
                                      = τ (hTw−1 ) + (v − v −1 )τ (hT(sw)−1 )
                                      6= 0,
the last inequality following from the maximality of ℓ(w) (which implies that τ (hT(sw)−1 ) =
0). But Ts h ∈ I ′ and so sw ∈ X. This contradicts the maximality of ℓ(w). 


2.B. Some results on the Kazhdan-Lusztig basis. In this subsection, we study the
elements of the Kazhdan-Lusztig basis of the form Cal σ where 0 6 l 6 n and σ ∈ Sn .

Proposition 2.3. Let σ ∈ Sn and let 0 6 l 6 n. Then Cal Cσ = Cal σ and Cσ Cal = Cσal .

Proof - Let C = Cal Cσ . Then C = C and
                                                    X
                                    C − Tal σ =             λw Tw
                                                   w<al σ

with λw ∈ A for w < al σ. To show that C = Cal σ , it is sufficient to show that λw ∈ A<0 .
                                       Two-sided cells in type B                                  11


                                  V ℓt (x)−l βx Tx with βx ∈ Z[v, v −1 ] (see [3, Theorem 6.3 (a)]).
                       P
  But, Cal = Tal +         x<al
Hence,
                                       X                      X
                        C = Tal σ +           p∗τ,σ Tal τ +          V ℓt (x)−l βx Tx Cσ .
                                       τ <σ                   x<al

But, if x < al , then ℓt (x) < l. This shows that λw ∈ A<0 for every w < al σ. This shows
the first equality. The second one is obtained by a symmetric argument. 

   Proposition 2.3 shows that it can be useful to compute in different ways the elements
Cal to be able to relate the Kazhdan-Lusztig basis of Hn to the Kazhdan-Lusztig basis
of H(Sn ). Following the work of Dipper-James-Murphy [4], Ariki-Koike [2] and Graham-
Lehrer [11, §5], we set

                       Pl = (Tt1 + V −1 )(Tt2 + V −1 ) . . . (Ttl + V −1 )
                              X                 X
                                    V k−l
                                                                         
                          =                                   Tti1 ...tik .
                                   0 6k 6l           1 6 i1 <···<ik 6 l



Lemma 2.4. Pn is central in Hn .

Proof - First, Pn commutes with Tt (indeed, tti = ti t > ti for 1 6 i 6 n). By [2, Lemma
3.3], Pn commutes with Tsi for 1 6 i 6 n − 1. Since the notation and conventions are
somewhat different, we recall here a brief proof. First, if j 6∈ {i, i + 1}, si tj = tj si > tj
so Tsi commutes with Ttj . Therefore, it is sufficient to show that Tsi commutes with
(Tti + V −1 )(Tti+1 + V −1 ). This follows from a straightforward computation using the fact
that si ti > ti , that ti+1 si < ti+1 and that si ti = ti+1 si . 

Proposition 2.5. If 0 6 l 6 n, then Cal = Pl Tσ−1
                                               l
                                                  = Tσ−1
                                                      l
                                                         Pl .

Proof - The computation may be performed in the subalgebra of Hn generated by
{Tt , Ts1 , . . . , Tsl−1 } so we may, and we will, assume that l = n. First, we have Tt Pn = V Pn .
Since Pn is central in Hn , it follows from the characterization of Cn given by Proposition
2.2 that Pn ∈ Cn .
   Now, let h = Can − Pn Tσ−1       n
                                      . Then, by Proposition 2.1 (a), we have h ∈ Cn . Moreover,
it is easily checked that h ∈ T 6 n−1 = C 6 n−1 . So h = 0. 

Corollary 2.6. If 0 6 l 6 n and σ ∈ Sn , then ΠT0 (Cal σ ) = V −l Tσ−1
                                                                    l
                                                                       Cσ . In particular,
              −l   −1
τ (Cal σ ) = V τ (Tσl Cσ ).

Proof - Since ΠT0 is a morphism of right H(Sn )-modules (see Proposition 2.1 (a)) and
since Cal σ = Pl Tσ−1
                   l
                      Cσ (see Propositions 2.3 and 2.5), we have ΠT0 (Cal σ ) = ΠT0 (Pl )Tσ−1
                                                                                           l
                                                                                              Cσ .
       T           −l
But, Π0 (Pl ) = V . This completes the proof of the corollary. 
12                                             C. Bonnafé


                                        3. Two-sided cells

    The aim of this section is to show that, if x and y are two elements of W such that
                                                      Sl,n−l
ℓt (x) = ℓt (y) = l, then x 6LR y if and only if σx 6LR      σy (see Theorem 3.5). Here,
   Sl,n−l
6LR       is the preorder 6LR defined inside the parabolic subgroup Sl,n−l . For this, we
adapt an argument of Geck [7] who was considering the preorder 6L .
    We start by defining an order relation 4 on W . Let x and y be two elements of W .
Then x ≺ y if the following conditions are fulfilled:
        (1) ℓt (x) = ℓt (y),
        (2) x 6 y,
        (3) ax < ay or bx < by ,
                  S
                 l,n−l
        (4) σx 6LR     σy .

We write x 4 y if x ≺ y or x = y. If y ∈ Wn , we set

                                       Γy = Tay Caℓt (y) Cσy Tb−1
                                                               y
                                                                  .


Lemma 3.1. Let y ∈ W . Then Γy ∈ Ty + ⊕x<y A<0 Tx .

Proof - First, recall that Γy is a linear combination of elements of the form Tay Tz Tb−1           y
with z 6 aℓt (y) σy , so it is a linear combination of elements of the form Tx with x 6 y.
  Let l = ℓt (y) and σ = σy . We have
                                 X                             X
                                     p∗τ,σ Tay Tal Tτ Tb−1          p∗a,al p∗τ,σ Tay Ta Tτ Tb−1
                                                                                               
    Γy = Tay Tal Tσ Tb−1 y
                             +                          y
                                                             +                               y
                                                                                                  .
                               τ <σ                             a<al , τ 6 σ

If τ < σ, then Tay Tal Tτ Tb−1 y
                                   = Tay al τ b−1
                                               y
                                                  by [3, §4.6]. On the other hand, if a < al ,
then ℓt (a) < l so Tay Ta Tτ Tb−1y
                                    is a linear combination, with coefficients in Z[v, v −1 ] of
elements Tw with ℓt (w) = ℓt (a) < l (because ay , τ and b−1    y are elements of Sn ). Since
  l−ℓ t (a) ∗            −1
V          pa,al ∈ Z[v, v ] by [3, Theorem 6.3 (a)], this proves the lemma. 


Lemma 3.2. If y ∈ Wn , then
                                                     X
                                        Γy = Γy +          ρx,y Γx
                                                     x≺y

where the ρx,y ’s belong to Z[v, v −1 ].

Proof - Let l = ℓt (y). Then
                                                    X
                                Ta−1
                                  −1 = Tay +                 Rax,ay Ta Tx .
                                   y
                                                 a∈Yl,n−l
                                                 x∈Sl,n−l
                                                  ax<ay
                                            Two-sided cells in type B                        13


Moreover, if a ∈ Yl,n−l and x ∈ Sl,n−l are such that ax < ay , then a < ay (see [17, Lemma
9.10 (f)]. Thus,
                                X
               Γy = Γy +                 Rax,ay Rbx′ ,by Ta (Tx Cal σy Tx′−1 )Tb−1 .
                                    a,b∈Yl,n−l
                                   x,x′ ∈Sl,n−l
                                 ax<ay or bx′ <by

The result now follows from Lemma 3.1. 
                               X
Corollary 3.3. If x 4 y, then        ρx,z ρz,y = δx,y .
                                           x4z 4y

Proof - This follows immediately from Lemma 3.2 and from the fact that H → H, h 7→ h
is an involution. 

Corollary 3.4. If w ∈ W , then
                                                            X
                                                                   ∗
                                            Cw = Γ w +            πy,w Γy
                                                            y≺w

where    ∗
        πy,w   ∈   v −1 Z[v −1 ] ⊂ A<0   if y ≺ w.
                                                          ∗ )
Proof - By Corollary 3.3, there exists a unique family (πy,w                      −1    −1
                                                              y≺w of elements of v Z[v ]
                        ∗ Γ is stable under the involution h 7→ h of H (see [6, Page 214]:
                P
such that Γw + y≺w πy,w     y                                          n
this contains a general setting for including the arguments in [13, Proposition 2] or in [7,
Proposition 3.3]). But, by Lemma 3.1, we have
                                 X
                                       ∗
                           Γw +      πy,w Γy ∈ Tw + ( ⊕ A<0 Ty ).
                                                                    y<w
                                           y≺w
                               ∗ Γ .
                    P
So Cw = Γw +            y≺w   πy,w y   


  We are now ready to prove the main theorem of this section.

Theorem 3.5. Let x and y be two elements of W such that ℓt (x) = ℓt (y) = l. Then
                           Sl,n−l
x 6LR y if and only if σx 6LR     σy .
                                            S
Proof - Assume first that σx 6LR      l,n−l
                                            σy . Decompose σx = (σx′ , σx′′ ) with σx′ ∈ Sl and
                                                                  Wl
σx′′ ∈ Sn−l . Then σx′ 6S        ′       ′   Sl     ′         ′               ′
                          LR σy so σl σy 6LR σl σx so wl σl σx 6LR wl σl σy . In other words,
                            l


al σx′ 6W      ′
        LR al σy . Therefore, al σx 6LR al σy . But, by [3, Theorem 7.7], we have x ∼LR al σx
          l


and y ∼LR al σy . So x 6LR y.
  To show the converse statement, it is sufficient to show that
                                                       
                     I=               ⊕             ACu ⊕ C > l+1
                                                 u∈Wn
                                                        Sl,n−l
                                       ℓt (u)=l and σu 6LR     σy

is a two-sided ideal. But, by Corollary 3.4, we have
                                                     
                        I=             ⊕           AΓu ⊕ C > l+1 .
                                                 u∈Wn
                                                        S
                                                      l,n−l
                                    ℓt (u)=l and σu 6LR     σy
14                                             C. Bonnafé


   By symmetry, we only need to prove that I is a left ideal. Let h ∈ Hn and let u ∈ Wn
                                Sl,n−l
such that ℓt (u) = l and σu 6LR        σy . We want to prove that hΓu ∈ I. For simplification,
let a = au , b = bu , σ = σu . Let

                      Xl = {x ∈ Wn | ∀ w ∈ Wl,n−l , ℓ(xw) > ℓ(w)}.

Then, by [7, Proposition 3.3] and [3, Lemma 7.3 and Corollary 7.4],

                                   Ta Cal σ ∈           ⊕         ACxal τ .
                                                       x∈Xl
                                                       S
                                                   τ 6L l,n−l σ

Let I ′ be the right-hand side of the previous formula. By [7, Corollary 3.4], I ′ is a left
ideal. Therefore, hTa Cal σ ∈ I ′ . On the other hand,
                                                     
                             I′ ⊂        ⊕     ACxal τ ⊕ C > l+1 .
                                        x∈Yl,n−l
                                          S
                                       τ 6L l,n−l σ

Now, by Corollary 3.4, we have
                                                               
                            I′ ⊂           ⊕           ATx Cal τ ⊕ C > l+1 .
                                       x∈Yl,n−l
                                         S
                                     τ 6L l,n−l σ

Therefore, hΓu ∈ I ′ Tb−1 ⊂ I, as desired.         


Corollary 3.6. Let x and y be two elements of Wn . Then x ∼LR y if and only if
                              Sl,n−l
ℓt (x) = ℓt (y) (= l) and σx ∼LR     σy .


Remark 3.7 - We associate to each element w ∈ Wn a pair (P (w), Q(w)) of standard bi-
tableaux as in [3, §3]. Let l = ℓt (w). Write Q(w) = (Q+ (w), Q− (w)) and denote by λ? (w)
the shape of Q? (w) for ? ∈ {+, −}. The map w 7→ (P (w), Q(w)) is a generalization of the
Robinson-Schensted correspondence (see [19, Theorem 3.3] or [3, Theoreme 3.3]). Then
λ+ (w) is a partition of n − l and λ− (w) is a partition of l, so that λ(w) = (λ+ (w), λ− (w))
is a bipartition of n. If we write σw = σw  − × σ + with σ − ∈ S and σ + ∈ S
                                                 w         w       l     w     n−l , note that
  +                                                              +
λ (w) is the shape of the standard tableau associated to σw by the classical Robinson-
Schensted correspondence while λ− (w)∗ (the partition conjugate to λ− (w)) is the shape of
the standard tableau associated to σw   − . Let E denote the dominance order on partitions:

if α = (α1 > α2 > . . . ) and β = (β1 > β2 > . . . ) are two partitions of the same natural
number, we write α E β if
                                        X i      X i
                                            αj 6     βj
                                             j=1            j=1
for every i > 1. Now, let x and y be two elements of Wn . If ℓt (x) = ℓt (y), then Theorem
3.5 is equivalent to:

(3.8)           x 6LR y if and only if λ+ (x) E λ+ (y) and λ− (y) E λ− (x).
                                      Two-sided cells in type B                                   15


This follows from [18, 3.2] and [5, 2.13.1] (see also [10, Exercise 5.6]). Then, for general x
and y, Corollary 3.6 is equivalent to:
(3.9)                         x ∼LR y if and only if λ(x) = λ(y).


                             4. Around Lusztig’s conjectures

   In this section, we prove some results which are related to Lusztig’s conjectures. If
σ ∈ Sn , we denote by aS(σ) the function a evaluated on σ but computed in Sn . It is
given by the following formula. Let λ = (λ1 > λ2 > . . . ) be the shape of the left cell of σ.
Then
                                          X
                                 aS(σ) =      (i − 1)λi .
                                                 i>1
We denote by aλ the right-hand side of the previous formula. If z ∈ W , we set
                         α(z) = (ℓt (z), 2aS(σz ) − aS(σℓt (z) σz )) ∈ N2 .
In terms of partitions (using the notation introduced in Remark 3.7), we have
                         α(z) = (|λ− (z)|, aλ+ (z) + 2aλ− (z)∗ − aλ− (z) ).
We now study some properties of the function α.
Remark 4.1 - Geck and Iancu [9] have proved, using the result of this section (and
especially Proposition 4.2), that α = a. They have deduced, using the notion of orthogonal
representations, that Lusztig’s conjectures Pi hold for i ∈ {1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 13, 14}.
After that, Geck [8] proved P9 and P10 . 
  The first proposition shows that α is decreasing with respect to 6LR (compare with
Lusztig’s conjecture P4 ).

Proposition 4.2. Let z and z ′ be two elements of W . Then:
   (a) If z 6LR z ′ , then α(z ′ ) 6 α(z).
   (b) If z 6LR z ′ and α(z) = α(z ′ ) then z ∼LR z ′ .

Proof - Since z 6LR z ′ , we have ℓt (z) > ℓz (z ′ ) by [3, Corollary 6.7]. Therefore, if ℓt (z) >
ℓt (z ′ ), then α(z) > α(z ′ ) and z 6∼LR z ′ . This proves (a) and (b) in this case.
                                                                                 Sl,n−l
    So, assume that ℓt (z) = ℓt (z ′ ) = l. Then, by Theorem 3.5, we have σz 6LR        σz ′ . Write
                             ′  ′              ′              ′
σz = (σ, τ ) and σz ′ = (σ , τ ) where σ, σ ∈ Sl and τ , τ ∈ Sn−l . Then
                             α(z) = (l, 2aS(σ) − aS(σl σ) + aS(τ ))

and                        α(z ′ ) = (l, 2aS(σ ′ ) − aS(σl σ ′ ) + aS(τ ′ )).
                         S
But σ 6S     ′
        LR σ and τ 6LR
          l              l,n−l
                               τ ′ . Moreover, σl σ ′ 6S      ′
                                                       LR σl τ . Therefore, since Lusztig’s con-
                                                        l


jecture P4 holds in the symmetric groups, we obtain (a).
16                                           C. Bonnafé


  If moreover α(z) = α(z ′ ), then aSl (σ) = aSl (σ ′ ) so σ ∼LR σ ′ by property P11 for the
symmetric group. Similarly, τ ∼LR τ ′ so σz ∼LR σz ′ . So, by Corollary 3.6, z ∼LR z ′ . 

     The next proposition relates the functions α and ∆.

Proposition 4.3. Let z ∈ W . Then α(z) 6 ∆(z). Moreover, α(z) = ∆(z) if and only if
z 2 = 1.

Proof - Let us start with two results concerning the degree of τ (Γz ) for z ∈ Wn :

Lemma 4.4. Let z ∈ Wn . Then
                             (
                              0                                if az 6= bz ,
                   τ (Γz ) =
                              V −ℓt (z) τ (Tσ−1   C )
                                             ℓ (z) σz
                                                               if az = bz .
                                                    t


Proof of Lemma 4.4 - Write l = ℓt (z). Then, τ (Γz ) = τ (ΠT0 (Γz )). So, by Proposition
2.1 (a) and Corollary 2.6, we have τ (Γz ) = V −l τ (Taz Tσ−1   l
                                                                    Cσz Tb−1
                                                                          z P
                                                                             ). Therefore, V l τ (Γz )
is equal to the coefficient of Tbz in Taz Tσ−1  l
                                                  Cσz . Write Tσ−1l
                                                                    Cσz = x∈Sl,n−l βx Tx . Then
     −1
                P
Taz Tσl Cσz = x∈Sl,n−l βx Taz x . Thus, if az 6= bz , then bz 6∈ az Sl,n−l so τ (Γz ) = 0. If
az = bz , then τ (Γz ) = V −l β1 = V −l τ (Tσ−1
                                             l
                                                Cσz ). 

Corollary 4.5. Let z ∈ Wn . Then :
     (a) deg τ (Γz ) 6 −α(z).
     (b) deg τ (Γz ) = −α(z) if and only if z is an involution.

Proof of Corollary 4.5 - This follows from Lemma 4.4 and Corollary 1.6 (recall that
Lusztig’s conjectures (Pi )1 6 i 6 15 hold in the symmetric group). 
     Let us now come back to the computation of ∆(z). By Corollary 3.4, we have
                                                  X
                                                     ∗
                              τ (Cz ) = τ (Γz ) +   πy,z τ (Γy ).
                                                     y≺z

But, if y ≺ z, then α(z) 6 α(y) (see Proposition 4.2 (a)). Therefore, by Corollary 4.5
                    ∗ τ (Γ ) < −α(z). So deg τ (C ) 6 −α(z) and deg τ (C ) = −α(z) if
(a), we have deg πy,z     y                         z                          z
and only if deg τ (Γz ) = −α(z) that is, if and only if z is an involution (see Corollary 4.5
(b)). 

                                       5. Specialization

   We fix now a totally ordered abelian group Γ◦ and a weight function L◦ : Wn → Γ◦
such that L◦ (s) > 0 for every s ∈ Sn . Let A◦ = Z[Γ◦ ] be denoted exponentially and let
Hn◦ = H(Wn , Sn , L◦ ). Let (Tw◦ )w∈Wn denote the usual A◦ -basis of Hn◦ and let (Cw◦ )w∈Wn
denote the Kazhdan-Lusztig basis of Hn◦ .
   Let b = L◦ (t) and a = L◦ (s1 ) = · · · = L◦ (sn−1 ). Let θΓ : Γ → Γ◦ , (r, s) 7→ ar + bs. It
is a morphism of groups which induces a morphism of Z-algebras θA : A → A◦ such that
                                                Two-sided cells in type B                                                       17


θA (V ) = v b and θA (v) = v a . If Hn◦ is viewed as an A-algebra through θA , then there is a
unique morphism of A-algebras θH : Hn → Hn◦ such that θH (Tw ) = Tw◦ for every w ∈ Wn .
The main result of this section is the following:


Proposition 5.1. If b > (n − 1)a, then θH (Cw ) = Cw◦ for every w ∈ Wn .

Proof - Assume that b > (n − 1)a. Since θH (Cw ) = θH (Cw ), it is sufficient to show that
                                             ∗ ) ∈ A◦ for every y < w, it is sufficient to show
θH (Cw ) ∈ Tw◦ +(⊕y<w A◦<0 Ty◦ ). Since θA (πy,w      <0
that θH (Γw ) ∈ Tw◦ +(⊕y<w A◦<0 Ty◦ ). For simplification, we set l = ℓt (w), a = aw , b = bw and
σ = σw . We set Γ′w = Ta Cal Tσ Tb−1 . Then Γw = τ 6 σ p∗τ,σ Γ′aal τ b−1 , with p∗τ,σ ∈ v −1 Z[v −1 ]
                                                    P

if τ < σ and p∗σ,σ = 1. So it is sufficient to show that θH (Γ′w ) ∈ Tw◦ + (⊕y<w A◦<0 Ty◦ ). By
Proposition 2.5, we have

            Γ′w = Ta Pl Tσ−1
                          l
                             Tσ Tb−1
                        l
                        X                        X                                                
                   =          V k−l                            Ta Tti1 ti2 ...tik Tσ−1
                                                                                    l
                                                                                       Tσb−1
                        k=0           1 6 i1 <i2 <···<ik 6 l
                        l
                        X                        X                                                            
                   =          V k−l                            Taα(i1 ,...,ik ) Tak Tβ(i1 ,...,ik ) Tσ−1
                                                                                                      l
                                                                                                         Tσb−1  ,
                        k=0           1 6 i1 <i2 <···<ik 6 l



where ti1 . . . tik is equal to α(i1 , . . . , ik )ak β(i1 , . . . , ik ) with α(i1 , . . . , ik ) ∈ Yk,n−k ∩ Sl and
β(i1 , . . . , ik ) ∈ Sl . Note that α(i1 , . . . , ik )ak = ri1 . . . rik (recall that ri is defined as in
[3, §4.1]) so that ℓ(β(i1 , . . . , ik )) = (i1 − 1) + · · · + (ik − 1). Now, let γ(i1 , . . . , ik ) =
σl β(i1 , . . . , ik )−1 . Then

                              l−1
                              X                      X                                                           
                                                                                             −1
             Γ′w = Tw +           V k−l                                Taα(i1 ,...,ik ) Tak Tγ(i            T
                                                                                                 1 ,...,ik ) σb
                                                                                                               −1  .
                              k=0             1 6 i1 <i2 <···<ik 6 l

If 0 6 k 6 l − 1 6 n − 1, we define

                Yk,l−k,n−l = {σ ∈ Sn | ∀ i ∈ {1, 2, . . . , n − 1} \ {k, l}, σsi > σ}.

Then Yk,l−k,n−l = Yl,n−l (Yk,n−k ∩ Sl ). Therefore, aα(i1 , . . . , ik ) ∈ Yk,l−k,n−l . But, we have
Yk,l−k,n−l = Yk,n−k (Yl,n−l ∩ Sk,n−k ). So we can write aα(i1 , . . . , ik ) = αi1 ,...,ik α′ (i1 , . . . , ik )
with αi1 ,...,ik ∈ Yk,n−k and α′ (i1 , . . . , ik ) ∈ Yl,n−l ∩ Sk,n−k . Then ℓ(α′ (i1 , . . . , ik )) 6 (l −
k)(n − l) (indeed, Yl,n−l ∩ Sk,n−k may be identified with the set of minimal length coset
representatives of Sn−k /Sl−k,n−l ). Note also that ak and α′ (i1 , . . . , ik ) commute. So

                        l−1
                        X                        X                                                                        
                                                                                                      −1
         Γ′w = Tw +         V k−l                                  Tαi1 ,...,ik ak Tα′ (i1 ,...,ik ) Tγ(i            T
                                                                                                          1 ,...,ik ) σb
                                                                                                                        −1  .
                        k=0               1 6 i1 <i2 <···<ik 6 l
18                                                    C. Bonnafé


If we write Tu Tv−1 Tσb−1 = τ ∈Sn ηu,v,τ Tτ with ηu,v,τ ∈ Z[v, v −1 ], then, by [17, Lemma
                              P

10.4 (c)], we have deg ηu,v,τ 6 ℓ(u) + ℓ(v). Moreover,
                      l−1           
                      X                         X           X                                                              
        Γ′w = Tw +          V k−l                                   ηα′ (i1 ,...,ik ),γ(i1 ,...,ik ),τ Tαi1 ,...,ik ak τ        .
                      k=0           1 6 i1 <i2 <···<ik 6 l τ ∈Sn

So it is sufficient to show that, for every k ∈ {0, 1, . . . , l − 1} and every sequence 1 6 i1 <
· · · < ik 6 l, we have
                                                                                
(∗)                  (k − l)b + ℓ(α′ (i1 , . . . , ik )) + ℓ(γ(i1 , . . . , ik )) a < 0.
But, ℓ(α′ (i1 , . . . , ik )) 6 (l − k)(n − l) and
                      ℓ(γ(i1 , . . . , ik ))    =
                                          ℓ(σl ) − ℓ(β(i1 , . . . , ik ))
                                          l(l − 1)
                                     =              − (i1 − 1) − · · · − (ik − 1)
                                              2
                                          l(l − 1) k(k − 1)
                                     6              −
                                              2             2
                                          1
                                     =      (l − k)(l + k − 1).
                                          2
So, in order to prove (∗), it is sufficient to prove that
(∗∗)                        2(k − l)b + (l − k)(2(n − l) + (l + k − 1))a < 0.
But,
2(k − l)b + a(l − k)(2(n − l) + (l + k − 1))a = 2(k − l)(b − (n − 1)a) + (l − k)(k + 1 − l)a.
Since k − l < 0, b − (n − 1)a > 0 and k + 1 − l 6 0, we get (∗∗).                             


     If x and y are two elements of Wn , we write
                                              X
                                    Cx◦ Cy◦ =     h◦x,y,z Cz◦ ,
                                               z∈Wn
where    h◦x,y,z
             ∈     A◦ .We denote by 6L , 6R , 6◦LR
                                         ◦   ◦                  the preorders 6L , 6R and 6LR defined
    ◦
in Hn . Similarly,    we define ∼◦L , ∼◦R and ∼◦LR .

Corollary 5.2. Assume that b > (n − 1)a. Let x, y and z be elements of Wn and let
? ∈ {L, R, LR}. Then:
      (a) h◦x,y,z = θA (hx,y,z ).
      (b) If x 6◦? y, then x 6? y.
      (c) x ∼◦? y if and only if x ∼? y.

Proof - (a) follows from Proposition 5.1. (b) follows from (a). (c) follows from (b) and
from the counting argument in the proof of [3, Theorem 7.7]. 

     Let τ ◦ : Hn◦ → A◦ denote the canonical symmetrizing form. If z ∈ Wn , we set
                                               a◦ (z) = max deg h◦x,y,z ,
                                                       x,y∈Wn
                                     Two-sided cells in type B                                19


                                     ∆◦ (z) = − deg τ ◦ (Cz◦ )

and                                     α◦ (z) = θΓ (α(z)).

By Corollary 5.2 (b) and by the same argument as in the proof of Proposition 4.2, we
have, for every z, z ′ ∈ Wn such that ℓt (z) = ℓt (z ′ ) and z 6◦LR z ′ ,

(5.3)                                    α◦ (z ′ ) 6 α◦ (z ′ ).

Remark - Using the result of this section, Geck and Iancu [9] proved that a◦ = α◦
whenever b > (n − 1)a. 

Proposition 5.4. Assume that b > (n − 1)a. Let z ∈ Wn . Then:
   (a) ∆◦ (z) = θΓ (∆(z)) > α◦ (z).
   (b) ∆◦ (z) = α◦ (z) if and only if z 2 = 1.

Proof - First, note that τ ◦ ◦ θH = θH ◦ τ . Moreover, by Proposition 5.1, we have
θH (Cz ) = Cz◦ . Since V ℓt (z) τ (Cz ) ∈ Z[v, v −1 ], we get that ∆◦ (z) = θΓ (∆(z)). The other
assertions follow easily. 

  We conclude this section by showing that the bound given by Proposition 5.1 is optimal.

Proposition 5.5. If b 6 (n − 1)a, there exists w ∈ Wn such that θH (Cw ) 6= Cw◦ .

Proof - Assume that b 6 (n − 1)a. To prove the proposition, it is sufficient to show that
there exists w ∈ Wn such that θH (Cw ) 6∈ Tw◦ + ⊕y<w A◦<0 Ty◦ . Using Corollary 3.4, we see
that it is sufficient to show that there exists w ∈ Wn such that θH (Γw ) 6∈ Tw◦ +⊕y<w A◦<0 Ty◦ .
This follows from the next lemma:



        Lemma 5.6. Let w = sn−1 . . . s2 s1 tσn . Then θH (Γw ) 6∈ Tw◦ + ⊕y<w A◦<0 Ty◦ .
        Proof - We have, by Proposition 2.3,

                         Γw = Tsn−1 ...s2 s1 t Cσn + V −1 Tsn−1 ...s2 s1 Cσn .

        But, Tsn−1 ...s2 s1 Cσn = v n−1 Cσn (see [17, Theorem 6.6 (b)]). Therefore,
        since θH (Cσ ) = Cσ◦ for every σ ∈ Sn , we have
                             X                                       
               θH (Γw ) =         v (ℓ(τ )−ℓ(σn ))a Ts◦n−1 ...s2 s1 tτ + v −b+(n−1)a Cσ◦n .
                             τ ∈Sn

        (Recall that Cσn = τ ∈Sn v (ℓ(τ )−ℓ(σn ) Tτ by [17, Corollary 12.2].) So the
                               P

        coefficient of θH (Γw ) on Tσ◦n is equal to v −b+(n−1)a , which does not belong
        to A◦<0 . 
20                                              C. Bonnafé


                                              References
  [1] S. Ariki, Robinson-Schensted correspondence and left cells. Combinatorial methods in representation
      theory (Kyoto, 1998), 1–20, Adv. Stud. Pure Math. 28, Kinokuniya, Tokyo, 2000.
  [2] S. Ariki and K. Koike, A Hecke algebra of (Z/rZ) ≀ Sn and construction of its irreducible represen-
      tations, Adv. Math. 106 (1992), 216–243.
  [3] C. Bonnafé & L. Iancu, Left cells in type Bn with unequal parameters, Represent. Theory 7 (2003),
      587–609.
  [4] R. Dipper, G. D. James and G. E. Murphy, Hecke algebras of type Bn at roots of unity, Proc. London
      Math. Soc. 70 (1995), 505-528.
  [5] J. Du, B. Parshall, and L. Scott, Cells and q-Schur algebras, Transformation Groups 3 (1998), 33-49.
  [6] F. Du Cloux, An abstract model for Bruhat intervals, Europ. J. Combinatorics 21 (2000), 197-222.
  [7] M. Geck, On the induction of Kazhdan-Lusztig cells, Bull. London Math. Soc. 35 (2003), 608-614.
  [8] M. Geck, Relative Kazhdan-Lusztig cells and the left cell representations in type Bn , preprint (2005),
      math.RT/0504216.
  [9] M. Geck and L. Iancu, Lusztig’s a-function in type Bn (asymptotic case), Nagoya Math. J. 182
      (2006), 199-240.
 [10] M. Geck and G. Pfeiffer, Characters of finite Coxeter groups and Iwahori–Hecke algebras, London
      Math. Soc. Monographs, New Series 21, Oxford University Press, 2000.
 [11] J. J. Graham and G. I. Lehrer, Cellular algebras, Invent. Math. 123 (1996), 1–34.
 [12] D. A. Kazhdan and G. Lusztig, Representations of Coxeter groups and Hecke algebras, Invent. Math.
      53 (1979), 165–184.
 [13] G. Lusztig, Left cells in Weyl groups, Lie Group Representations I (R. L. R. Herb and J. Rosenberg,
      eds.), Lecture Notes in Math., vol. 1024, Springer-Verlag, 1983, pp. 99–111.
 [14] G. Lusztig, Unipotent characters of the symplectic and odd orthogonal groups over a finite field,
      Invent. Math. 64 (1981), 263-296.
 [15] G. Lusztig, Characters of reductive groups over a finite field, Ann. of Math. Stud., vol. 107, Princeton
      University Press, 1984.
 [16] G. Lusztig, Cells in affine Weyl groups, Algebraic groups and related topics (Kyoto/Nagoya, 1983),
      Adv. Stud. Pure Math., vol. 6, North-Holland, Amsterdam, 1985, pp. 255–287.
 [17] G. Lusztig, Hecke algebras with unequal parameters, CRM Monograph Series 18, American Mathe-
      matical Society, Providence, RI (2003), 136 pp.
 [18] G. Lusztig and N. Xi, Canonical left cells in affine Weyl groups, Advances in Math. 72 (1988),
      284–288.
 [19] S. Okada, Wreath products by the symmetric groups and product posets of Young’s lattices, J. Combin.
      Theory Ser. A 55 (1990) 14-32.

  Labo. de Math. de Besançon (CNRS: UMR 6623), Université de Franche-Comté, 16 Route
de Gray, 25030 Besançon Cedex, France
  E-mail address: bonnafe@math.univ-fcomte.fr
