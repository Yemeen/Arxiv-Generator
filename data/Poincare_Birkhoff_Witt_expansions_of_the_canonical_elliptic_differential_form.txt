                                                  POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL
                                                                ELLIPTIC DIFFERENTIAL FORM
arXiv:math/0502296v2 [math.RT] 16 Feb 2005




                                                                           G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

                                                     Abstract. We study the canonical U (n– )-valued elliptic differential form, whose projections
                                                     to different Kac-Moody algebras are key ingredients of the hypergeometric integral solutions of
                                                     elliptic KZ differential equations and Bethe ansatz constructions. We explicitly determine the
                                                     coefficients of the projections in the simple Lie algebras Ar , Br , Cr , Dr in a conveniently chosen
                                                     Poincaré-Birkhoff-Witt basis. As an application we give a new formula for eigenfunctions of
                                                     Hamiltonians of the Calogero-Moser model.




                                                                                           1. Introduction
                                                Let g be a simple Lie algebra with Cartan decomposition g = n– ⊕ h ⊕ n+ . Let V be the tensor
                                             product VΛ1 ⊗ . . . ⊗ VΛn of highest weight g-modules. The V -valued hypergeometric solutions
                                             of the elliptic Knizhnik-Zamolodchikov differential equations have the form ([FV1], cf. [SV])
                                                                                       Z
                                             (1)                         I(z, λ, τ ) =     Φ(t, z, τ ) · ΩV (t, z, λ, τ ).
                                                                                            γ(z,λ,τ )

                                             Here t = (t1 , . . . , tN ), z = (z1 , . . . , zn ), τ ∈ C with Im τ > 0, λ ∈ h, Φ is an explicit scalar-valued
                                             master function, γ is a suitable cycle in t-space, and ΩV is a V -valued differential k-form in
                                             t-space.
                                                The same Φ and ΩV have applications to the Bethe Ansatz method. It is known [RV, EK1,
                                             EK2, FV1, FV2] that the values of ΩV at the critical points of Φ (with respect to t) give
                                             eigenfunctions of the Hamiltonians of the quantum elliptic Calogero-Moser model [GH] (in the
                                             g = slr+1 case).
                                                For every V = VΛ1 ⊗ . . . ⊗ VΛn , the V -valued differential form ΩV can be constructed out of a
                                             single U(n– )-valued differential form Θg, where U( ) denotes the universal enveloping algebra.
                                             The form Θg is called the canonical elliptic differential form. In applications it is important to
                                             have convenient formulas for Θg, and this is the goal of the present paper.
                                                The form Θg (depending also on a vector k ∈ Nr ) is defined as the projection of the ‘canonical
                                             element’ Ωk according to the scheme
                                                                       Ωk ∈ A(k) ⊗ U[k] → A(k) ⊗ U(n– )[k]
                                                                                 ↓              ↓
                                                                             W ⊗ U[k] → W ⊗ U(n– )[k] ∋ Θgk .
                                             Here A(k) is a homogeneous component of an Orlik-Solomon algebra; U[k] is its dual, and W
                                             is a space of certain differential forms written in terms of theta functions.
                                               Supported by NSF grants DMS-0405723 (2nd author), DMS-0244579 (3rd author)
                                             Keywords: canonical differential form, KZ equation, Bethe ansatz, PBW-expansion
                                             AMS Subject classification 33C67.
                                                                                                        1
2                           G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

   In Section 2 we define and study A(k) ⊗ U[k], and its canonical element Ωk . In Sections
3 and 4 we find Poincaré-Birkhoff-Witt formulas for the projection of Ωk in A(k) ⊗ U(n– )[k].
In Section 5 we define representations of A(k) in spaces W of suitable differential forms. In
                                            sl
Section 6 we use the PBW expansion of Θk r+1 to find a new formula for eigenfunctions of
the Hamiltonian of the Calogero-Moser model. In the Appendix we describe the image of the
faithful representation A(k) → W .

      2. Cohomology of the complement of the discriminantal arrangement.
                       Combinatorial codes and operations.
2.1. An ordered p-forest is a graph with no cycles, with p edges, and a numbering of its edges
by the numbers 1, 2, . . . , p. Let Apn be the complex vector space generated by the ordered p-
forests on the vertex set {z, t1 , . . . , tn } (a set of symbols now), modulo the following two kinds
of relations:
      R1: T1 = −T2 if T1 and T2 have the same underlying graph, and the order of their edges
        differ by a transposition;
      R2:
               ∗      ∗        ∗ a ∗              ∗ b ∗
                ❆     ✁         ❆                        ✁
(2)             a❆ ✁b + b❆                   +          ✁a  =0          (a, b ∈ {1, . . . , p}),
                  ❆∗✁             ❆∗                 ∗✁
       that is, the sum of three p-forests that locally (i.e. their subgraphs spanned by 3 vertices)
       differ as above, but are otherwise identical, is 0.
  Let z be a complex number, and consider Cn with coordinates t1 , . . . , tn . The discriminantal
arrangement C n = C n (z) in the space Cn is the collection of hyperplanes ti = tj (1 ≤ i < j ≤ n)
and ti = z (1 ≤ i ≤ n). Let U n denote the complement of C n , i.e. U n = Cn \ ∪H∈C n H.
Proposition 2.1. The cohomology group H p (U n ; C) is isomorphic to Apn .
Proof. The definition of A(k) is a combinatorial code for the description of H p (U n ; C) by Arnold
in [A].                                                                                            
                                                                                      P
   Now let us fix r ∈ N, and r non-negative integers k = (k1 , k2 , . . . , kr ) with   ki = |k|. The
set of coordinates
                              (1)          (1)   (2)          (2)          (r)          (r)
(3)                         (t1 , . . . , tk1 , t1 , . . . , tk2 , . . . , t1 , . . . , tkr ).

will be denoted by T (k). We will consider C|k| with coordinates T (k), and the space Ap|k| with
                                           Q
vertex set T (k) ∪ {z}. The group Gk =        Σki acts on C|k| (by permuting the coordinates
with the same upper indices) which then induces an action of Gk on Ap|k| . The skew-invariant
                                                                                                 |k|
subspace (i.e. the collection of x’s for which π · x = sgn(π)x, ∀π ∈ Gk ) of A|k| will be denoted
by A(k).
                                                                                                  (1)   (2)
Example 2.2. In the r ≤ 2 examples (in the whole paper) we will use tj for tj and sj for tj .
The vector space A((1, 1)) is two-dimensional with a basis {z 1 t1 2 s1 , z 1 s1 2 t1 }.
The vector space A((2)) is one-dimensional with a basis {t1 1 z 2 t2 }.
   POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL ELLIPTIC DIFFERENTIAL FORM                                                                     3

2.2. The star-product.
Definition 2.3. Let e1 , e2 , . . . , e|k| be the edges (in order) of an ordered |k|-tree T on the vertex
set T (k) ∪ {z}. The sign ε(T ) of T is defined by
                                           |k|                                    ki
                                                                                r ^
                                           ^                                    ^               (i)
                                                 d h(ei ) = ε(T ) ·                       d tj ,
                                           i=1                                  i=1 j=1

where h(e) is the ‘head’ of the edge e, i.e. the end vertex of e farther from the root z.
  For example the signs of the three trees of Example 2.2 are +1, -1, +1, respectively.
Definition 2.4. For an element xPin a vector space acted upon by Gk , let ASymk (x) = ASym(x)
be the anti-symmetrization
           P               of x: π∈Gk sgn(π)π(x). Let Symk (x) = Sym(x) be the symmetriza-
tion of x:    π∈Gk π(x).

   For k, l ∈ Nr let T1 and T2 be ordered |k|- and |l|-trees on the vertex set T (k) ∪ {z} and
T (l) ∪ {z} respectively. We will define their star-product T1 ∗ T2 by the following procedure.
                           (i)              (i)
We replace the vertices tj of T2 with tki +j , add |k| to the numbers on the edges of T2 , and
identify the z-vertices of the two trees—thus we  Q obtain a tree T with |k + l| + 1 vertices. The
product T1 ∗ T2 is defined as ε(T1 ) ε(T2 ) ε(T )/ i (ki !li !) · ASymk+l T , i.e. T1 ∗ T2 =

                                                               T1                                                               T2

                                                     (edges: 1, . . . , |k|)                        (edges: |k| + 1, . . . , |k + l|)



                                                                     (i)                                               (i)
        ε(T1 ) ε(T2 ) ε(T )                                         tj                                                tki +j
           Qr               · ASymk+l
              i=1 ki !li !

                                                                                                •
                                                                                                z


  The star-product induces a product (that we will also call star-product) A(k) ⊗ A(l) →
A(k + l). The vector space ⊕k∈Nr A(k) with the star-product is an associative and commutative
algebra.
Example 2.5.
   (z    1
             t1 ) ∗ (z    1
                                  s1 ) = (t1     1
                                                      z    2
                                                                s1 ) = (z             1
                                                                                               t1       2
                                                                                                              s1 ) − (z        1
                                                                                                                                     s1   2
                                                                                                                                              t1 ).
Computation shows that
                     (z       1
                                   t1 )∗n = n! ASym(z           1
                                                                           t1     2
                                                                                          t2        3
                                                                                                            ...   n
                                                                                                                        tn ).
4                                 G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

                                                                                                                   (i)
2.3. Residue. Let T be a p-tree on the vertex set T (k) ∪ {z}, and choose a coordinate tj . We
                 (i)           (i)                                                            (i)
will define the tj -residue Resj T of the tree T as a p−1-tree on the vertex set T (k)∪{z}\{tj },
constructed as follows.
             (i)
      • If tj and z are connected by an edge with number a, then we contract that edge (i.e.
         delete the edge, and identify its vertices), and label this contracted vertex by z. Then,
                                                                                   (i)
         if the number of an edge is greater than a, we decrease it by 1. Resj is defined as
         (−1)a−1 times this modified tree. See Figure 1.
                                                                                     edges:      a + 1 7→ a
                                                                                                 a + 2 7→ a + 1
                                                                                                 ...



       (i)
    Resj                                                            = (−1)a−1

                              •       a      •                                                     •
                                               (i)
                              z              tj                                                    z
                                                        Figure 1
             (i)                                          (i)
    • If tj      z is not an edge of T , Resj T is defined to be 0.
  This operation is consistent with relations R1 and R2, hence they are defined for A(k).
                (i)
Observe that Reski is a map A(k) → A(k − 1i ). (Here, and in the sequel, 1i denotes a vector,
whose coordinates are 0 except the i’th coordinate, which is 1.)
2.4. The dual space of the cohomology of the complement. Let Ur denote the free
associative complex algebra generated by the r symbols f˜1 , . . . , f˜r . It is multigraded by Nr
(deg f˜i = 1), the degree k subspace will be denoted by U[k]. In [SV] U[k] is shown to be
isomorphic to the Gk skew-invariant part of the dual space of H |k| (U |k| ; C). In this section we
recall this isomorphism in our combinatorial language.
Definition 2.6. Let r ∈ N and k ∈ Nr .
    • Maps J : {1, . . . , |k|} → {1, . . . , r} with #J −1 (i) = ki will be called (k-)multiindices.
    • For a multiindex J, let f˜J be the monomial f˜J(|k|) f˜J(|k|−1) · · · f˜J(1) in U[k].
    • For a multiindex J let c be the unique map {1, . . . , |k|} → N that restricted to J −1 (i) is
       the increasing function onto {1, . . . , ki }.
    • The sign sgn(J) of a multiindex J is (−1)m where m is the minimal number of transpo-
       sitions to be applied to the list J(1), J(2), . . . , J(|k|) to get 1, . . . , 1, 2, . . . , 2, . . . , r, . . . , r.
  Let T0 be the graph with a single vertex z and with no edge. For T ∈ A(k) and J a
k-multiindex, the expression
                                                                                 
                                (J(|k|))      (J(|k−1|))          (J(1))
(4)                 sgn(J) · Resc(|k|)     Resc(|k−1|)   . . . Resc(1) (T ) . . .

is equal to a constant times T0 . Let this constant be denoted by < f˜J , T >.
   POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL ELLIPTIC DIFFERENTIAL FORM                                                                                            5

Theorem 2.7. [SV, Th. 2.4] The map f˜J →
                                       7 < f˜J ,                                               > is an isomorphism between U[k] and
the dual space A(k)∗ of A(k).
                                                                                                                                                                          
Corollary 2.8. For the basis {f˜J } of Ur the dual basis is
                                                                                      
             f˜J∗ = sgn(J) · ASym z 1 tc(1)
                                           (J(1))       (J(2))                (J(|k|))
                                                   2
                                                       tc(2)   3
                                                                   · · · |k|
                                                                             tc(|k|)     .
                     P                        P
2.5. Product on        A(k), coproduct on         U[k]. Recall that Ur is equipped with its stan-
dard Hopf algebra structure. The comultiplication ∆ : Ur → Ur ⊗ Ur is defined by ∆(x) =
1 ⊗ x + x ⊗ 1 for degree 1 elements.
                                            P
Theorem 2.9. Under the duality between k∈Nr A(k) and Ur the coproduct ∆ corresponds to
the star-multiplication.
Proof. We need the following notion: a triple
          (S1 ⊂ {1, . . . , |k + l|}, S2 ⊂ {1, . . . , |k + l|}, J : {1, . . . , |k + l|} → {1, . . . , r})
is called a shuffle of J1 : {1, . . . , |k|} → {1, . . . , r} and J2 : {1, . . . , |l|} → {1, . . . , r} if
      • #S1 = k, #S2 = l, S1 ∪ S2 = {1, . . . , |k + l|},
      • for the increasing bijections s1 : S1 → {1, . . . , k}, s2 : S2 → {1, . . . , l} we have
                                                 (
                                                   J1 ◦ s1 (i) i ∈ S1
                                          J(i) =
                                                   J2 ◦ s2 (i) i ∈ S2 .
                                                                  P ˜∗
   The definition of ∆ implies that ∆∗ (f˜J∗1 ⊗ f˜J∗2 ) =            fJ , where the sum runs over all the
                                                  ˜∗
shuffles of J1 and J2 . On the other hand fJ1 ∗ fJ1 =      ˜∗

                     (J (1))                                (J (|k|))                                            (J (1))                                      (J (|k|))
 ± ASym(z       1
                    tc1 1(1)        2
                                             ···      |k|
                                                            tc1 1(|k|) ) ∗ ASym(z                          1
                                                                                                                tc2 2(1)            2
                                                                                                                                             ···     |k|
                                                                                                                                                             tc2 2(|k|) ).
Using relation (2), this is equal to the sum of terms
                                                              (J(1))                                  (J(|k+l|))
                                   ± ASym(z            1
                                                             tc(1)          2
                                                                                     ···             t
                                                                                                |k+l| c(|k+l|)
                                                                                                                 ),
where J is a shuffle of J1 and J2 . We illustrate this argument with the following example:
(f˜2 f˜1 )∗ ∗ f˜1∗ = (z 1 t1 2 s) ∗ (z 1 t1 ) =
                                         2                                                     2
                              1
                                    t1       s                                 1
                                                                                          t1           s                                             
                                                                                                                                             2
           − ASym         z                           = − ASym               z             ❅
                                                                                           3
                                                                                                   t2          + z                      t1       s       =
                                                                                                                                1
                               ❅
                               3                                                                                     ❅
                                                                                                                     3
                                    t2                                                                                     t2
                                         2
                              1
                                    t1       s                    1
                                                                        t1                                                                           
                                                 3❅
                                                                                                                                             2
           − ASym         z                                 + z             ❅
                                                                            3              2               + z                          t1       s       =
                                                      t2                             t2            s                            1
                                                                                                                   ❅
                                                                                                                   3
                                                                                                                           t2

2 ASym(z 1 t1 2 t2 3 s) − ASym(z 1 t1 2 s 3 t2 ) = 2(f˜2 f˜12 )∗ + (f˜1 f˜2 f˜1 )∗ .
  A careful examination of signs shows that ∆∗ and the star-product agree on the basis f˜J∗ ,
hence the Theorem is proved.                                                             
6                           G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

2.6. The canonical element. We obtained that the spaces A(k) and U[k] are dual      P vec-
tor spaces, and hence there is a canonical element in A(k) ⊗ U[k]. It is defined by  b∗i ⊗
bi for a basis bi in U[k] and its dual basis b∗i in A(k). This definition does not depend
on the choice of the basis. Equivalently, the canonical element is the identity in A(k) ⊗
U[k] =Hom(A(k)∗ , U[k]) =Hom(U[k], U[k]).
Definition 2.10. The canonical element in A(k) ⊗ U[k] will be denoted by Ωk .
    Using Corollary 2.8 we obtain an explicit form for Ωk .
Theorem 2.11. We have
           X                                                                                               
                                                (J(1))        (J(2))                             (J(|k|))
(5)   Ωk =    sgn(J) · ASym z          1
                                               tc(1)     2
                                                             tc(2)         3
                                                                                    ···   |k|
                                                                                                tc(|k|)         ⊗ f˜J ,
                J
where the summation runs over all k-multiindices.
Example 2.12. Ω(1,1) = (z 1 t 2 s) ⊗ f˜2 f˜1 + (z 1                        s    2
                                                                                       t) ⊗ f˜2 f˜1 .
                                                                                              
          Ω(2,1) = (z 1 t1 2 t2 3 s) − (z 1 t2                         2
                                                                               t1      3
                                                                                           s)     ⊗ f˜2 f˜12 −
                                                                                              
(6)                 (z 1 t1 2 s 3 t2 ) − (z 1 t2                       2
                                                                               s      3
                                                                                          t1 )    ⊗ f˜1 f˜2 f˜1 +
                                                                                              
                    (z 1 s 2 t1 3 t2 ) − (z 1 s                        2
                                                                               t2     3
                                                                                          t1 )    ⊗ f˜2 f˜12 .

             3. Canonical elements associated with simple Lie algebras
  Let g be a simple Lie algebra of rank r with Cartan decomposition g = n– ⊕ h ⊕ n+ . The
Nr -multigraded universal enveloping algebra U(n– ) of n– is generated by r elements f1 , . . . , fr
(the standard Chevalley generators), subject to the Serre relations. The degree k part of U(n– )
(deg fi = 1) is denoted by U(n– )[k]. We have the quotient map q : Ur → U(n– ) by mapping f˜i
to fi .
Definition 3.1. The canonical element Ωgk associated with the simple Lie algebra g is defined
as the image of the canonical element Ωk under the map
(7)                         id ⊗ q : A(k) ⊗ U[k] → A(k) ⊗ U(n– )[k].
3.1. PBW expansion of the canonical element. The Lie algebra n– is the direct sum of
1-dimensional weight spaces nβ labeled by the positive roots: n– = ⊕β nβ . Now let us make the
following choices:
      • (C1) a linear ordering β1 < · · · < βm of the positive roots (thus m = dim n– ),
      • (C2) a generator Fβj in nβj .
                                                                                                   (j)
When considering Fβj in U(n– ), let its degree be k (j) ∈ Nr . Equivalently, ki is the coefficient
of the i’th simple root (i.e. the simple root corresponding to fi ) in the decomposition of βj .
According to the Poincaré-Birkhoff-Witt theorem, a C-basis of the algebra U(n– ) is given by
the collection of elements Fβp11 Fβp22 . . . Fβpmm where p = (p1 , . . . , pm ) ∈ Nm .
   Hence, the canonical element associated with g can be written (depending on the choices
(C1,C2)) as
                                              X
(8)                                 Ωgk =          Tp ⊗ Fβp11 Fβp22 . . . Fβpmm ,
                                           p
   POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL ELLIPTIC DIFFERENTIAL FORM                                                      7
                                                               P
where the summation runs over those p ∈ Nm for which j pj k (j) = k ∈ Nr . Here Tp ∈ A(k) is
a linear combination of ordered spanning trees on the vertex set T (k) ∪ {z}.
                                                                                             
                                                                                       0 0 0
Example 3.2. In the Lie algebra sl3 (C) of traceless 3 × 3 matrices let f1 = 1 0 0,
                                                                                       0 0 0
                 
         0 0 0
f2 = 0 0 0. Let α1 and α2 be the simple roots corresponding to f1 and f2 respectively.
         0 1 0
The positive roots are α1 , α2 , and α1 + α2 . Let us choose the ordering
       • β1 = α1 < β2 = α1 + α2 < β3 = α2 ,
and the elements
       • Fα1 = f1 , Fα1 +α2 = [f2 , f1 ], Fα2 = f2 ,
with k (1) = (1, 0), k (2) = (1, 1), k (3) = (0, 1). Then for example Ωsl (1,1) can be written as
                                                                            3


T(1,0,1) ⊗ f1 f2 + T(0,1,0) ⊗ [f2 , f1 ]. Using Theorem 2.11 we obtain
       Ωsl
        (1,1) =(z
          3
                     1
                             t       2
                                             s) ⊗ f2 f1 − (z          1
                                                                              s   2
                                                                                      t) ⊗ f1 f2 =
               (z    1
                             t       2
                                             s) ⊗ ([f2 , f1 ] + f1 f2 ) − (z          1
                                                                                          s   2
                                                                                                  t) ⊗ f1 f2 =
               ((z       1
                                 t       2
                                              s) − (z     1
                                                                  s       2
                                                                              t)) ⊗ f1 f2 + (z    1
                                                                                                      t     2
                                                                                                                    s) ⊗ [f2 , f1 ].
  Observe that T(1,0,1) (the coefficient of f1 f2 ) is equal to (z                            1
                                                                                                  t) ∗ (z       1
                                                                                                                     s). In general we
have the following formula.
Theorem 3.3. (Product formula.) There exist unique elements ηβj ∈ A(k (j) ) (j = 1, . . . , m)
such that
                                   p1                  p2                         pm
                   1        z      }|       { z       }|        {           z     }|        {
(9)         Tp = Q        · ηβ1 ∗ . . . ∗ ηβ1 ∗ ηβ2 ∗ . . . ∗ ηβ2 ∗ . . . ∗ ηβm ∗ . . . ∗ ηβm .
                   l pl !
Proof. Let F p = Fβp11 Fβp22 . . . Fβpmm . The key observation is that in a PBW-basis the co-multipli-
cation is given by
                                                X Y   m
                                          p                 pi !  p ′    ′′
                                   ∆(F ) =                 ′ ′′
                                                                  F ⊗ Fp .
                                                          p !p !
                                                      i=1 i i
                                              ′  ′′      p +p =p
Hence, for its dual we get
                                                   m
                                              ∗
                                                  Y
                                                  p′ ∗ pi !   p′′ ∗  ′   ′′
                            ∆ (F ⊗ F ) =              ′ ′′
                                                            · F (p +p )∗ .
                                                     p !p !
                                                  i=1 i i
                                                     Q
Using Theorem 2.9 this is equivalent to Tp′ ∗Tp′′ = i (pi !/p′i !p′′i !)·Tp′ +p′′ , from which the theorem
follows (put ηβj = Tβj ).                                                                                
Example 3.4. The computation in Example 3.2 shows that (with the choices made there)
ηα1 = (z 1 t), ηα1 +α2 = (z 1 t 2 s), ηα2 = (z 1 s). Then for example the coefficient
of f12 [f2 , f1 ]f2 in Ωsl
                        (3,2) is
                          3


                                                         t1 t2
                                                       1  2         
                                           1
                                 T(2,1,1) = ASym(3,2)    z 3 t3 4 s1 .
                                           2              ❅5❅
                                                             s2
8                              G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

3.2. The residues of ηβ .

Lemma 3.5. The map ψ : U[k − 1i ] → U[k], x 7→ (−1)k1 +...+ki −1 x · f˜i is dual to the map
   (i)
Reski : A(k) → A(k − 1i ).

Proof. Let T ∈ A(k), fJ ∈ U[k − 1i ]. We need to check that < (−1)k1 +...+ki −1 f˜J f˜i , T >
            (i)
=< f˜J , Reski T >. Writing out definition (4) we obtain an identity.                       
Theorem 3.6. We have
                              Reski Ωk = (−1)k1 +...+ki −1 Ωk−1i · (1 ⊗ f˜i ).
                                  (i)

                                                              P
Proof. Let {bu } be a basis of Ur [k − 1i ], hence Ωk−1i = b∗u ⊗ bu . Since the map ψ in Lemma
3.5 is an embedding, the ψ images of bu can be extended to a basis {ψ(bu ), cv } of Ur [k]. Then
       P                       P ∗                          (i)              P    (i)
Ωk =       ψ(bu )∗ ⊗ ψ(bu ) +     cv ⊗ cv . We have (Reski ⊗1)Ωk =             Reski (ψ(bu )∗ ) ⊗ ψ(bu ) +
P      (i)                                                   P
   Reski (c∗v ) ⊗ cv , which, according to the lemma, is        b∗u ⊗ ψ(bu ) = (1 ⊗ ψ)Ωk−1i , what we
wanted to prove.                                                                                         

  Recall that after making the choices (C1), (C2), any element in U(n– ) can be written in the
basis {F p : p ∈ Nm } (recall F p = Fβp11 Fβp22 . . . Fβpmm ). If the element x is expanded in this basis, let
the coefficient of F p be denoted by coeff(x, F p ). Theorem 3.6 has the following direct corollary.
Corollary 3.7. We have
                             (j)        (j)
                                                      (i)
                                                                     X
                      (−1)k1       +...+ki −1
                                                Res    (j)   ηβj =       coeff(F p · fi , Fβj ) · Tp .
                                                      ki
                                                                     p

  Since the residues of ηβ ’s will play a crucial role in our argument below, we will make our
choices so that the coefficients on the right-hand side are easily computable.

                                                4. Computing ηβ ’s
  We reduced the computation of Tp ’s to the computation of ηβ ’s for the positive roots β. In
this section we compute the elements ηβ (with suitable choices (C1), (C2)) for the simple Lie
algebras of type A, B, C, D.
Theorem 4.1. Let g be a simple Lie algebra of rank r, with positive roots β1 , . . . , βm and let
choices (C1), (C2) be made. Suppose η̄βj ∈ A(k (j) ) (j = 1, . . . , m) satisfy
     (i): < F̃ , η̄βj >= 0 if F̃ ∈ U[k (j) ] belongs to the ideal of Serre relations;
               (i)           (i)
     (ii): Reski η̄βj = Reski ηβj for all i = 1, . . . , r.
Then η̄βj = ηβj .

Proof. Let us choose an index j. Let F p ∈ U(n– )[k (j) ], and let F̃ p ∈ U[k (j) ] be a preimage of
F p under the map q : Ur → U(n– ). First we show that
     (iii): < F̃ 1j , η̄βj >= 1;
     (iv): < F̃ p , η̄βj >= 0 if p 6= 1j .
   POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL ELLIPTIC DIFFERENTIAL FORM                                     9
               g
For this let Ωk(j) be obtained from Ωgk(j) by replacing ηβj with η̄βj . Using (ii) and definition (4)
                                    g
of < , > we have (< F̃ p , > ⊗1)Ωk(j) = (< F̃ p , > ⊗1)Ωgk(j) . This latter is equal to
                       (1 ⊗ q)(< F̃ p , > ⊗1)Ωk(j) = (1 ⊗ q)(1 ⊗ F̃ p ) = 1 ⊗ F p ,
which proves (iii) and (iv).
  Conditions (i), (iii), and (iv), together with Theorem 2.7 imply η̄βj = ηβj .                                      


Notations. Root systems will be considered in a space with an ortho-normal basis {e1 , . . . , er }.
For a sequence of integers I = (i1 , i2 , . . . , in ) let [fI ] denote the following multiple commutator
[. . . [[fi1 , fi2 ], fi3 ] . . . , fin ]. Let String(u1, u2 , . . . , un ) denote the following tree
                                    z   1
                                             u1    2
                                                       u2    3
                                                                  ...     n
                                                                              un .
Theorem 4.2. The elements given in the following list are the ηβ ’s of Theorem 3.3 for the
simple Lie algebras of type A, B, C, D and the choices given.
     Ar−1 : For the positive roots ei − ej (1 ≤ i < j ≤ r) and simple roots αi = ei − ei+1
       (i = 1, . . . , r − 1), we make the following choices.
           • ei − ej < ei′ − ej ′ if either i < i′ or i = i′ and j < j ′ ;
           • Fei −ej = [f(j−1,j−2,...,i) ].
                                               (i) (i+1)            (j−1)
       Then we have ηei −ej = String(t1 , t1 , . . . , t1 ).
     Br : For the positive roots ei (1 ≤ i ≤ r), ei − ej , ei + ej (1 ≤ i < j < r), and simple roots
       αi = ei − ei+1 (1 ≤ i < r) and αr = er , we make the following choices.
           • Let β be one of ei , ei −ej or ei + ej , and let β, be one of ei′ , ei′ −ej ′ or ei′ + ej ′ . Then
             we set β < β ′ if i > i′ . If i < j < j ′ we set ei + ej < ei + ej ′ < ei < ei − ej ′ < ei + ej .
           • Fei −ej = [f(j−1,...,i) ], Fei = [f(r,...,i) ], Fei +ej = (−1)( 2 )+(r−j+1) [f(i,...,r,r,...,j)].
                                                                                  j−i+1


                                               (j−1) (j−2)              (i)                  (r) (r−1)         (i)
       Then we have ηei −ej = String(t1 , t1 , . . . , t1 ), ηei = String(t1 , t1 , . . . , t1 ) and
                                           (j)   (r) (r)            (i) 
       ηei +ej = ASym String(t2 , . . . , t2 , t1 , . . . , t1 ) .
     Cr : For the positive roots ei − ej , ei + ej (1 ≤ i < j ≤ r) and 2ei (1 ≤ i ≤ r) and simple
       roots αi = ei − ei+1 (1 ≤ i < r) and αr = 2er , we make the following choices.
           • Let β be one of ei −ej , ei +ej , or 2ei , and let β ′ be one of ei′ −ej ′ , ei′ +ej ′ , or 2ei′ . Then
             we set β < β ′ if i > i′ . For i < j < j ′ we set ei +ej < ei +ej ′ < 2ei < ei −ej ′ < ei −ej .
           • Fei −ej = [f(j−1,j−2,...,i) ], Fei +ej = (−1)r−j [f(i,i+1,...,r,r−1,...,j)], F2ei = (−1)r−i /2 ·
             [f(i,i+1,...,r,r−1,...,i) ].
                                                  (j−1)           (i)                                  (j)         (r−1)
       Then we have ηei +ej = String(t1 , . . . , t1 ), ηei +ej = ASym String(t2 , . . . , t2 ,
         (r)         (i) 
       t1 , . . . , t1 ) , and
                                                              (r−1) 3       . . . r−i+1 t(i)
                                                             t1                          1
                                                       2                                    
                                                  (r)
                       η2ei = ASym z 1 t1                                                      .
                                                      ❅ (r−1)
                                               2r−2i+1  ❅ t                 ...          (i)
                                                                                        t2
                                                              2   2r−2i       r−i+2


     Dr : For the positive roots ej − ei , ej + ei (1 ≤ i < j ≤ r), and simple roots α1 = e1 + e2 ,
      αj = ej − ej−1 (1 < j ≤ r), we make the following choices.
10                               G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

            • Let β be one of ej − ei , ej + ei , and let β ′ be one of ej ′ − ei′ , ej ′ + ei′ . Then we set
               β < β ′ if j < j ′ . For i′ < i < j we also set ej + ei < ej + ei′ < ej − ei′ < ej − ei .
            • Fej −ei = [f(j,...,i+1) ], Fej +e1 = [f(j,...,3,1) ], Fej +ei = [f(j,...,1,3,...,i) ] (i > 1).
                                                      (i+1)     (j)                             (1) (3)      (j)
         Then we have ηej −ei = String(t1 , . . . , t1 ), ηej +e1 = String(t1 , t1 , . . . , t1 ), and for
                                                            (i)       (3) (2) (1) (3)                 (j) 
         i > 1 we have ηej +ei = ASym String(t2 , . . . , t2 , t1 , t1 , t1 , . . . , t1 ) +ASym String
           (i)          (3) (1) (2) (3)             (j)  
         (t2 , . . . , t2 , t1 , t1 , t1 , . . . , t1 ) .

Proof. Simple combinatorics shows that for our choices of Fβ and the order of the β’s, Corol-
lary 3.7 implies
                        
                        ηβj −αi
                                            if βj − αi is a positive root, βj − αi > βj
               (i)                              βj −αi                   βj −αi
           Res (j) ηβj = η βj −αi ∗ η βj −αi if 2 is a positive root, 2 > βj
               ki
                         2
                                        2
                          0                  otherwise.

One can check case by case that the same residue identities hold for the ηβj ’s given in the
Theorem, hence condition (ii) of Theorem 4.1 is satisfied.
  To prove property (i) of Theorem 4.1 recall that the relevant Serre relations are
     (1) [f(i,j) ] if (αi , αj ) = 0,
     (2) [f(i,j,j)] if (αi , αj ) = −1,
     (3) [f(i,j,j,j)] if (αi , αj ) = −2, |αi | < |αj |.
If (αi , αj ) = 0, then the value of (fI fi fj fJ −fI fj fi fJ ) on the A(k)-elements given in the Theorem
are all 0. Indeed, our sign conventions yield that in the Cr case fI fi fj fJ (η2ei ) = fI fj fi fJ (η2ei );
and in all other cases both sides vanish. This proves that on multiples of (1) all A(k)-elements
given in the Theorem as ηβ ’s, vanish. For multiples of (2) and (3) the proof is similar.                


                         5. Differential form representations of A(k)
   A linear map φ : A(k) → W to a vector space W will be called a representation of A(k).
For a representation φ we call (φ ⊗ 1)Ωk the canonical φ-element, and (φ ⊗ 1)Ωgk = (φ ⊗ q)Ωk
the canonical φ-element associated with the Lie algebra g. In this section we consider φ’s
for which the canonical φ-elements associated with simple Lie algebras play an important
role in hypergeometric solutions of KZ-type differential equations. Theorem 3.3 together with
Theorem 4.2 give convenient forms of these canonical elements. An example of application will
be shown in Section 6.
   Suppose we are given a vector space W , and a vector φ(T ) ∈ W for every ordered |k|-tree
T on the vertex set T (k) ∪ {z}. This data induces a representation φ : A(k) → W if the
assignment T 7→ φ(T ) respects relations R1 and R2 (see Section 2.1).
Notation. For an edge e of a spanning tree on the vertex set T (k) ∪ {z}, h(e) and t(e) denote
the head and tail of the edge e, i.e. the vertices adjacent to e, farther resp. closer to z.

                                                      (i)
5.1. Rational representation. Let W (tj , z) be the vector space of differential forms in the
variables T (k) ∪ {z}.
  POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL ELLIPTIC DIFFERENTIAL FORM 11

Theorem 5.1. Let the edges of an ordered |k|-tree be e1 , . . . , e|k| (in order). The map
                                                   |k|
                                                   ^
                                    T 7→ φ(T ) =         d log(h(ei ) − t(ei ))
                                                   i=1
                                                  (i)
defines a representation φrat : A(k) →        W (tj , z).
Proof. We need to check the consistency of the definition with relations R1 and R2 from Sec-
tion 2.1. Relation R1 follows from the antisymmetry of the ∧-product. In view of R1 it is
enough to check R2 for a = 1, b = 2. Let the three distinguished vertices be t, s, and u. Then
we need to check
          d(t − u) d(s − t) d(s − u) d(t − u) d(t − s) d(s − u) 
                   ∧         +           ∧          +          ∧            ∧ R = 0,
            t−u       s−t        s−u         t−u         t−s       s−u
                                                          |k|
where R is the ‘rest’ of the formula (i.e. R = ∧i=3 d log(h(ei ) − t(ei ))), but the first factor is 0.
                                                                                                     
   This representation of the canonical element (as well as the theorems corresponding to our
Theorems 3.3, 4.2) is explored in [RSV]. Observe that, according to [A], the rational represen-
tation is an isomorphism onto its image. Hence, the study of the ‘canonical differential form’
of [RSV] is equivalent to the study of the canonical element of this paper.
5.2. Theta representation. For z, τ ∈ C, Im τ > 0, the first Jacobi theta function is defined
by the infinite product
                                                                               ∞
                      πi(τ /4−z)        q                 2πiτ    2πiz
                                                                              Y
  θ(z) = θ(z, τ ) = ie           (x; q)( ; q)(q; q), q = e , x = e , (y; q) =     (1 − yq j ),
                                        x                                     j=0

[WW]. It is an entire holomorphic function of z satisfying
       θ(z + 1, τ ) = −θ(z, τ ),       θ(z + τ, τ ) = −e−πiτ −2πiz θ(z, τ ),             θ(−z, τ ) = −θ(z, τ ).
By θ′ (z, τ ) we will mean the derivative in the z variable.
Definition 5.2.
                                                         θ(w − t, τ )
                                σw (t) = σw (t, τ ) =                    · θ′ (0, τ ).
                                                        θ(w, τ )θ(t, τ )
   The listed properties of the theta function yield that the σ function—viewed as a function
of t—has simple poles at the points of Λτ = Z ⊕ Z τ ⊂ C, as well as the properties
(10)        σw (t + 1, τ ) = σw (t, τ ),     σw (t + τ, τ ) = e2πiw σ(t, τ ),            Rest=0 σw (t, τ ) = 1.
Theorem 5.3. We have
(11)        σw1 +w2 (t − u)σw2 (s − t) − σw2 (s − u)σw1 (t − u) + σw1 (t − s)σw1 +w2 (s − u) = 0.
Proof. Consider the left hand  side of the equation as a function f (t) of t.2πiw
                                                                               Then f is a function
on C \ (u + Λτ ) ∪ (s + Λτ ) , satisfying f (t + 1) = f (t), f (t + τ ) = e        1
                                                                                     f (t). The above
properties of σ also imply that
                  Rest=u f (t) =1 · σw2 (s − u) − σw2 (s − u) · 1 − 0 = 0
                     Rest=s f (t) =σw1 +w2 (s − u)(−1) + 0 + 1 · σw1 +w2 (s − u) = 0.
12                              G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

Therefore
        Pwe have     an entire function. According to f (t + 1) = f (t) this can be written in the
form of   dn e2πnit . Substituting f (t + τ ) = e2πiw1 f (t) we obtain that dn = 0 for all n.   
                                                                    (i)
  For k ∈ Nr we consider variables (weights) wj (i = 1, . . . , i, j = 1, . . . , ki ), and say that
                                 (i)              (i)
the weight of the coordinate tj ∈ T (k) is wj . Let T be a rooted tree (with root z) and v a
vertex of T . We define the branch B(v) of v to be the collection of those vertices w for which
the unique path connecting w with z contains v. By definition v ∈ B(v). The load L(v) of
a vertex v in a tree T is defined to be the sum of the weights of the vertices in B(v). Let
    (i)     (i)
W (tj , z, wj , τ ) be the vector space of differential forms in the variables T (k) ∪ {z} depending
                         (i)
on the parameters {wj } and τ .
Theorem 5.4. Let the edges of an ordered |k|-tree be e1 , . . . , e|k| (in order). The map
                                          |k|
                                          ^
                           T 7→ φ(T ) =         σL(h(ei )) (h(ei ) − t(ei )) d(h(ei ) − t(ei ))
                                          i=1
                                                     (i)        (i)
defines a representation φθ : A(k) → W (tj , z, wj , τ ).
Proof. We need to check the consistency of the definition with relations R1 and R2 from section
2.1. Relation R1 follows from the antisymmetry of the ∧-product.
  In view of R1 it is enough to check R2 for a = 1, b = 2. In R2, let the three distinguished
vertices be t (bottom), s (upper-right), u (upper-left). Because of symmetry, we can assume
that among t, s, u it is u that is the closest to the vertex z. Consider the first of the three
graphs pictured in R2. Let L1 be the total weight of the vertices in B(t) \ B(s), and let L2 be
the load of s, as in the following picture.

                       z         ···            u                         s    L2
                                                 ❅              2
                                                  1❅
                                                    ❅
                                                            t             L1

     With these notations we need to check
      
        σL1 +L2 (t − u)d(t − u) ∧ σL2 (s − t)d(s − t) + σL2 (s − u)d(s − u) ∧ σL1 (t − u)d(t − u)+
                                                                      
                         σL1 (t − s)d(t − s) ∧ σL1 +L2 (s − u)d(s − u) ∧ R = 0,
                                                      |k|
where R is the ‘rest’ of the formula, i.e. ∧i=3 σL(h(ei )) (h(ei ) − t(ei )) d(h(ei ) − t(ei )). Considering
the path connecting u with z one finds that R has a du factor, so our equation reduces to (11).
This proves the theorem.                                                                                   
Theorem 5.5. The representations φrat and φθ are injective.
Proof. The representation φrat is injective by [A]. The representation φθ is injective because
φrat is obtained from φθ by the following degeneration. As τ → i∞, the function σw (t, τ ) tends
to π sin(π(w − t))/(sin(πw) sin(πt)). This function tends to π/(e2πt − 1) as w tends to +∞.
For small t, that function approximates 2/t.                                                  
   POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL ELLIPTIC DIFFERENTIAL FORM 13

5.3. The g-theta representation. Let g be a simple Lie algebra with Cartan decomposition
g = n– ⊕ h ⊕ n+ and simple roots αi ∈ h∗ . Consider the theta representation from Section
                           (i)
5.2 with the choices wj = αi (λ), λ ∈ h. Thus we obtain a representation φg,θ : A(k) →
     (i)                           (i)                                                   (i)
W (tj , z, λ, τ ) to the space W (tj , z, λ, τ ) of differential forms in the variables tj , z depending
on λ ∈ h and τ ∈ C, Im τ > 0. We call this the g theta-representation.
5.4. The canonical elliptic differential form. For the simple Lie algebra g we defined
                                                                                (i)
a map on both factors of A(k) ⊗ U[k], namely φg,θ : A(k) → W (tj , z, λ, τ ) (Section 5.3),
and q : U[k] → U(n– )[k] (Definition 3.1). Let the canonical elliptic differential form Θgk =
      (i)                               (i)
Θgk (tj , z, λ, τ ) be the image in W (tj , z, λ, τ ) ⊗ U(n– )[k] of the canonical element Ωk under the
map φg,θ ⊗ q.
Example 5.6. By Theorems 3.3 and 4.2 we have
                                         Θsl
                                          (2,1) = (φsl3 ,θ ⊗ q)Ω(2,1) =
                                            3




                                   1
                                          t1                                   1 t1                 
                                                                       1             2             2
      = (φsl3 ,θ ⊗ 1) ASym z                          ⊗ f1 [f2 , f1 ] + ASym z t2            ⊗ f1 f2
                                     ❅      3                          2            ❅
                                     2                                              3
                                        t2 s1                                          s1
        = σα1 (λ) (t1 − z)dt1 ∧ σα1 (λ)+α2 (λ) (t2 − z)dt2 ∧ σα2 (λ) (s1 − t2 )ds1 −
                                                                                       
              σα1 (λ) (t2 − z)dt2 ∧ σα1 (λ)+α2 (λ) (t1 − z)dt1 ∧ σα2 (λ) (s1 − t1 )ds1 ⊗ f1 [f2 , f1 ]
                                                                                      
                  + σα1 (λ) (t1 − z)dt1 ∧ σα1 (λ) (t2 − z)dt2 ∧ σα2 (λ) (s1 − z)ds1 ⊗ f12 f2 .

  6. Application: Eigenfunctions of Calogero-Moser Hamiltonian operator.
  Let p and r be natural numbers, τ ∈ C, Im τ > 0. Consider the Hamilton operator of the
Calogero-Moser quantum r + 1-body system
                r+1
                X   ∂2                  X                                                 θ′ (t, τ )
            H=−        2
                         − 2p(p + 1)           ρ′ (λi − λj , τ ),            ρ(t, τ ) =              ,
                i=1
                    ∂λ i             1≤i<j≤r+1
                                                                                          θ(t, τ )

acting on scalar functions of λ1 , . . . , λr+1 , see [FV1].
                                                                                                    (−1)
Theorem 6.1. Let αj (λ) = λj − λj−1 and k = (rp, . . . , 2p, p). Use the notation tj      = 0 for
                  r+1                  (i)
any j. Let ξ ∈ C , and suppose that tj obey the ‘Bethe ansatz’ equations of [FV1, Th.11].
Then the function
                                     p
                                    Y                                                  
                   P                   Y
               2πi r+1   λ  ξ                                  (i)         (i−1)
(12)          e      j=1  j  j
                               Symk        σ(αi +...+αj )(λ) (t(j−i)p+l − t(j−i+1)p+l )
                                         l=1 1≤i≤j≤r

is an eigenfunction of H.
Proof. Consider g = slr+1 (C) with its Cartan decomposition and simple roots as in Theorem 4.2,
and the corresponding fi ∈ n– . The p(r + 1)’th symmetric power of the standard representation
                                                                     P
of slr+1 (C) is the highest weight module VΛ with highest weight Λ = i (r+1−i)p
                                                                           r+1
                                                                                  αi .
14                            G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

     The surjective map U(n– ) → VΛ , x 7→ x · vΛ induces the map
                              (i)                                          (i)
                         W (tj , z, λ, τ ) ⊗ U g(n– )[k] → W (tj , z, λ, τ ) ⊗ VΛ .
Let ΘVk Λ be the image of Θgk under this map. Theorem 11 of [FV1] states that the function
                                      P r+1                              ^ (i)
(13)                     ψγ (λ) = e2πi j=1 λj ξj · ΘVk Λ (t, z, λ, τ ) /  dtj
                                                                                      i,j

is an eigenfunction of the operator H, if z = 0, Im τ > 0, and t satisfies the Bethe ansatz
equations. We claim that
                    1      
             VΛ                        (1)                    (1) (2)
           Θk =        r
                         φθ String(z, t1 ))∗p ∗ String(z, t1 , t1 )∗p ∗ . . .
(14)              (p!)
                                                            
                                          (1)          (r)
                             ∗ String(z, t1 , . . . , t1 )∗p ⊗ f1p [f2 , f1 ]p . . . [f(r,r−1,...,1) ]p vΛ .
To prove this, choose the ordering of positive roots β and the Fβ ’s as in Theorem 4.2, and
consider ΘVk Λ in the induced PBW form:
                                   X
                                      Tp ⊗ Fβp11 · · · Fβpmm vΛ .
                                              p

Observe that the Fβ vΛ = 0 unless β = e1 − ej . Hence in a non-zero term the powers of the
factors Fr+1 , Fr+2 , . . . have to be zero. Therefore there is only one non-zero term
                              φθ (T(p,...,p) ) ⊗ f1p [f2 , f1 ]p . . . [f(r,r−1,...,1) ]p vΛ .
According to Theorems 3.3 and 4.2 this term is equal to the right hand side of formula (14).
  Tracing back the definitions of the star-product and φθ in (14), we obtain the theorem. 
   For sl2 (C) the Theorem is proved in [EK1]. A different Bethe ansatz formula is given in
[FV1].
   We used the elliptic version of the operator H. One can consider its trigonometric limit as
in [FV2]. To obtain eigenfunctions in that case we need to replace the representation φθ with
limτ →i∞ (φθ ) in (14).

                    7. Appendix: Notes on the theta representation
7.1. The image of the theta representation. We give a description of the image of the
                                        (i)    (i)
representation φθ : A(k) → W (tj , z, wj , τ ) for z = 0 and k = (1, . . . , 1) ∈ Nr and fixed τ ∈ C
with Im τ > 0. The general case can be derived from this special case.
  Fix k = (1, . . . , 1) ∈ Nr , z = 0, and τ ∈ C with Im τ > 0. Let A(k)(z=0) denote the space
A(k) with the substitution z = 0. The space A(k)(z=0) is spanned by ordered trees on the
                                                            (i)
vertex set {t1 , . . . , tr , 0} (we use the notation ti = t1 ). For such a tree T ,
                                      r
                                      ^
                          φθ (T ) =         σL(h(ei )) (h(ei ) − t(ei )) d(h(ei ) − t(ei ))
                                      i=1

is a meromorphic differential form in the variables t1 , . . . , tr and it depends meromorphically on
the complex parameters w1 , . . . , wr . Consider the translates of the discriminantal arrangement
   POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL ELLIPTIC DIFFERENTIAL FORM 15

C r (0) by the points of the lattice Λτ = Z + Z τ in each coordinates. Let Mr be the union of all
these translates, i.e.
                                            
                          Mr = ∪H∈C r (0) H + {(x1 , . . . , xr ) : xj ∈ Λτ }.

The differential form φθ (T ) has at most simple poles at points of Mr and it is holomorphic on
Cr −Mr .
Theorem 7.1. Let k = (1, . . . , 1) ∈ Nr and fix τ ∈ C with Im τ > 0. A meromorphic
differential r-form ψ in the variables t1 , . . . , tr , which depends meromorphically on the complex
parameters wi , is in the image of φθ : A(k)(z=0) → W (tj , 0, wj , τ ) if and only if the following
conditions hold.
    (1) ψ(. . . , tj + 1, . . .) = ψ(. . . , tj , . . .) for all j = 1, . . . , r.
    (2) ψ(. . . , tj + τ, . . .) = e2πiwj ψ(. . . , tj , . . .) for all j = 1, . . . , r.
    (3) For any subset {u1 , . . . , un } ⊂ {t1 , . . . , tr }, the differential form
                                                                                      
                                   Resu1 =0 Resu2 =0 . . . Resun =0 (ψ) . . .

        has at most simple poles at the points of Mr−n , and it is holomorphic on Cr−n −Mr−n .
Proof. First we show that Properties (1)–(3) hold for ψ ∈ Im(φθ ). Property (1) follows from
the first formula in (10). To prove Property (2) let T be an ordered spanning tree on the vertex
set {t1 , . . . , tr , 0}, and let v0 , . . . , vn be the neighbors of tj , among which v0 is the closest to 0
in T .
                                                             v1        L1

             0          ···            v0            tj            .
                                                          ❅        .
                                                           ❅       .
                                                            ❅
                                                                  vn              Ln

Let Li be the load of vi . The only factors of φθ (T ) that contain tj are
                                                                       n
                                                                       ^
                          σwj +   P
                                      Ll (tj   − v0 )d(tj − v0 ) ·           σLl (vl − tj )d(vl − tj ).
                                                                       l=1

                                                                                           (i)
According to the second formula from (10), after substituting tj + τ these factors get multi-
plied by
                                             n
                                             Y
                                     P
                            e2πi(wj + Ll ) ·   e2πi(−Ll ) = e2πiwj ,
                                                            l=1
                                                                                         (j) 
what we needed to prove. To prove Property (3) observe that Restj =0 φθ (T ) = φθ Res1 T .
Here Res on the left hand side means residue of differential forms, and on the right hand side
it is the one defined in Section 2.3. Therefore the multiple residue in Property (3) is the φθ
image of a certain tree; therefore ψ satisfies Property (3).
16                           G. FELDER, R. RIMÁNYI, AND A. VARCHENKO

   We will prove the other direction by induction on r. For k = (1) let ψ(t) satisfy the properties
of the Theorem. If its residue at t = 0 is c, then the differential form
                                                                    
                             ψ − c · σw (t)dt = ψ − φθ c · (0 1 t)

satisfies Properties (1), (2) and it is a holomorphic form; thus it has to be 0 (see the argument
at the end of the proof of Theorem 5.3).
  Now let ψ be a differential form in the variables t1 , . . . , tr satisfying the conditions of the
theorem. By the induction hypotheses we have Restj =0 ψ = φθ (Tj ). Consider
                                          X                      
                                  ψ − φθ       0 1 tj         Tj .
                                                  j

Here the root vertex 0 of Tj is glued to the vertex tj (and the name tj is kept for it); the numbers
on the edges of Tj are increased by 1. This form has Properties (1), (2), and its      P residues at
the hyperplanes tj = 0 are 0. Therefore this form is 0 (consider the new variable          tj , and the
argument at the end of the Proof of Theorem 5.3). Therefore ψ is in the image of φθ .                

7.2. Differential forms depending on τ . We will define a modification of the representation
φθ that takes into account the dependence on the modular parameter τ more naturally. Let
                                                     1
                            ωw (t) = σw (t, τ )dt −     ∂w σw (t, τ )dτ.
                                                    2πi
This form is used to construct hypergeometric solutions for elliptic KZ differential equations
in [FV1].
Theorem 7.2. The differential form ωw (t, τ ) is closed in (t, τ )-space.
Proof. We need to show that
                                         1
(15)                                  (∂τ + ∂t ∂w )σw (t, τ ) = 0.
                                        2πi
Differentiating the functional relation σw (t + τ, τ ) = exp(2πiw)σw (t, τ ) with respect to τ
and then with respect to t, w, we see that the left-hand side L(t) of (15) obeys L(t + τ ) =
exp(2πiw)L(t) (the main point is that the inhomogeneous term cancels). Also trivially L(t +
1) = L(t). The residue at the pole of σw at t = 0 is independent of w, τ (it is 1) so L(t) is an
entire function of t and must thus vanish.                                                     
Theorem 7.3. The form ω satisfies the following functional relation
     ωw1 +w2 (t − u) ∧ ωw2 (s − t) + ωw2 (s − u) ∧ ωw1 (t − u) + ωw1 (t − s) ∧ ωw1 +w2 (s − u) = 0.
Proof. The left hand side of the formula is (f1 dt ∧ ds + f2 ds ∧ du + f3 du ∧ dt) + (g1 dt + g2 ds +
g3 du) ∧ dτ . The first term vanishes by the formula in Theorem 5.3. The vanishing of the second
term reduces to the vanishing of ∂w1 and ∂w2 of the formula in Theorem 5.3.                         
Corollary 7.4. Let the edges of an ordered |k|-tree be e1 , . . . , e|k| (in order). The map
                                      |k|
                                      ^
                       T 7→ φ(T ) =         ωL(h(ei )) (h(ei ) − t(ei )) d(h(ei ) − t(ei ))
                                      i=1
      POINCARÉ-BIRKHOFF-WITT EXPANSIONS OF THE CANONICAL ELLIPTIC DIFFERENTIAL FORM 17

defines an injective representation of A(k) to the space of closed differential forms in the vari-
                                                          (i)
ables T (k) ∪ {z} ∪ {τ }, depending on the parameters {wj }.
                                                   References
[A]       V. I. Arnold. The cohomology ring of the colored braid group. Mat. Zametki 5 (1969), 227-231, Math.
          Notes 5 (1969) 138–140.
[EK1]     Etingof, Pavel I., Kirillov, Alexander A., Jr. Representations of affine Lie algebras, parabolic differential
          equations, and Lamé functions. Duke Math. J. 74 (1994), no. 3, 585–614.
[EK2]     Etingof, Pavel I., Kirillov, Alexander A., Jr. On the affine analogue of Jack’s and Macdonald’s poly-
          nomials, Duke Math. J. 78 (1995), no. 2, 229–256.
[FV1]     G. Felder and A. Varchenko. Integral representation of solutions of the elliptic Knizhnik-Zamolodchikov-
          Bernard equations. Int. Math. Res. Notices, (N. 5):221–233, 1995.
[FV2]     G. Felder and A. Varchenko. Three formulae for eigenfunctions of integrable Schrödinger operators
          Compositio Math., 107: 143–175, 1997.
[GH]      Gibbons, John, Hermsen, Theo. A generalisation of the Calogero-Moser system. Phys. D 11 (1984),
          no. 3, 337–348.
[RV]      N. Reshetikhin and A. Varchenko. Quasiclassical asymptotics of solutions to the KZ equations. In
          Geometry, Topology and Physics for R. Bott, pages 293–322, 1995.
[RSV]     R. Rimányi, L. Stevens, A. Varchenko. Combinatorics of rational functions and Poincare-Birkhoff-Witt
          expansions of the canonical U (n− )-valued differential form. To appear in Ann. Combinatorics
[SV]      V. Schechtman and A. Varchenko. Arrangements of hyperplanes and Lie algebra homology. Invent.
          Math., 106(1):139–194, 1991.
[WW]      E. T. Whittaker, G. N. Watson. A Course of Modern Analysis. Reprint of the fourth (1927) edition.
          Cambridge University Press (September 1996).

  Departement Mathematik, ETH-Zentrum, 8092 Zürich, Switzerland
  E-mail address: felder@math.ethz.ch

  Department of Mathematics, University of North Carolina at Chapel Hill, USA
  E-mail address: rimanyi@email.unc.edu

  Department of Mathematics, University of North Carolina at Chapel Hill, USA
  E-mail address: anv@email.unc.edu
