                                                                 THE G-STABLE PIECES OF THE
                                                               WONDERFUL COMPACTIFICATION
arXiv:math/0412302v3 [math.RT] 1 Feb 2006




                                                                                     Xuhua He

                                                 Abstract. Let G be a connected, simple algebraic group over an algebraically
                                                 closed field. There is a partition of the wonderful compactification Ḡ of G into
                                                 finite many G-stable pieces, which was introduced by Lusztig. In this paper, we will
                                                 investigate the closure of any G-stable piece in Ḡ. We will show that the closure is
                                                 a disjoint union of some G-stable pieces, which was first conjectured by Lusztig. We
                                                 will also prove the existence of cellular decomposition if the closure contains finitely
                                                 many G-orbits.



                                                                                   Introduction
                                               An adjoint semi-simple group G has a “wonderful” compactification Ḡ, intro-
                                            duced by De Concini and Procesi in [DP]. The variety Ḡ is a smooth variety with
                                            G × G action. Denote by Gdiag , the image of the diagonal embedding of G into
                                            G × G. The Gdiag -orbits of Ḡ were studied by Lusztig in [L4]. He introduced
                                            a partition of Ḡ into finitely many G-stable pieces. The G-orbits on each piece
                                            can be described explicitly. Based on the partition, he established the theory of
                                            “parabolic character sheaves” on Ḡ.
                                               The main results of this paper concern the closure of the G-stable pieces. The
                                            closure of each piece is a union of some other pieces and if the closure contains
                                            finitely many G-orbits, then it admits a cellular decomposition. I believe that our
                                            results are necessary ingredients for establishing the (conjectural) Kazhdan-Lusztig
                                            theory on the “Parabolic Character Sheaves” on Ḡ.
                                               We now review the content of this paper in more detail.
                                               In section 1, we recall the definition of G-stable pieces in [L4] and establish
                                            some basic results. The pieces are indexed by the pairs I = {(J, w)}, where J
                                            is a subset of the simple roots and w is an element of the Weyl group W , which
                                            has minimal length in the coset wWJ . One interesting result is that any G-stable
                                            piece is the minimal G-stable subset that contains a particular B × B-orbit, where
                                            B is the Borel subgroup. The closure of any B × B-orbit in Ḡ was studied by
                                            Springer in [S]. Based on his result and the relations between G-stable pieces and
                                            B × B-orbits, we are able to investigate the closure of the G-stable pieces.
                                              2000 Mathematics Subject Classification. 20G15, 14L30.

                                                                                                                        Typeset by AMS-TEX
                                                                                            1
2                                   XUHUA HE

   In section 2, we recall the definition of the “wonderful” compactification and
introduce “compactification through the fibres”, a technique tool that will be used
to prove the existence of cellular decomposition. In section 3, we describe a partial
order on I, which is the partial order that corresponds to the closure relation of
the G-stable piece, as we will see in section 4. In section 4, we also discuss the
closure of any G-stable piece that appears in [L3].
   In section 5, we discuss the existence of cellular decomposition. Each piece
does not have a cellular decomposition. However, a union of certain pieces has a
cellular decomposition. (This is motivated by Springer in [S], in which he showed
that a union of certain B × B-orbits is isomorphic to an affine space.) In fact, if
the closure contains finitely many G-orbits, then it has a cellular decomposition.
   The methods work for arbitrary connected component of a disconnected alge-
braic group with identity component G. The results for that component is just a
“twisted” version of the results for G itself.

                            1. The G-stable pieces
1.1. In the sequel G is a connected, semi-simple algebraic group of adjoint type
over an algebraically closed field. Let B be a Borel subgroup of G, B − be the
opposite Borel subgroup and T = B ∩ B − . Let (αi )i∈I be the set of simple roots.
For i ∈ I, we denote by si the corresponding simple reflection. For any element
w in the Weyl group W = N (T )/T , we will choose a representative ẇ in N (T ) in
the same way as in [L1, 1.1].
   For J ⊂ I, let PJ ⊃ B be the standard parabolic subgroup defined by J and
PJ− ⊃ B − be the opposite of PJ . Set LJ = PJ ∩ PJ− . Then LJ is a Levi subgroup
of PJ and PJ− . We denote by ΦJ the set of roots that are linear combination of
{(aj )j∈J }. Let ZJ be the center of LJ and GJ = LJ /ZJ be its adjoint group. We
denote by πPJ (resp. πP − ) the projection of PJ (resp. PJ− ) onto GJ .
                         J
   For any J ⊂ I, let PJ be the set of parabolic subgroups conjugate to PJ . We
will write B for P∅ .
   For any subset J of I, let WJ be the subgroup of W generated by {sj | j ∈ J}
and W J (resp. J W ) be the set of minimal length coset representatives of W/WJ
(resp. WJ \W ). Let w0J be the unique element of maximal length in WJ . (We will
simply write w0I as w0 .) For J, K ⊂ I, we write J W K for J W ∩ W K .
   For w ∈ W , we denote by supp(w) ⊂ I the set of simple roots whose associated
simple reflections occur in some (or equivalently, any) reduced decomposition of
w.
   For J, K ⊂ I, P ∈ PJ , Q ∈ PK and u ∈ J W K , we write pos(P, Q) = u if there
exists g ∈ G, such that g P = PJ and g Q = u̇ PK .
   For any parabolic subgroup P , we denote by UP its unipotent radical. We
will simply write U for UB and U − for UB− . For J ⊂ I, set UJ = U ∩ LJ and
UJ− = U − ∩ LJ .
   For any closed subgroup H of G, we denote by Hdiag the image of the diagonal
embedding of H in G × G. For any subgroup H and g ∈ G, we write g H for
        THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                                    3

gHg −1 . For any finite set A, we write |A| for the cardinal of X.
1.2. Let Ĝ be a possibly disconnected reductive algebraic group over and alge-
braically closed field with identity component G. Let G1 be a fixed connected
component of Ĝ. There exists an isomorphism δ : W −       → W such that δ(I) = I
and P ∈ Pδ(J) for g ∈ G and P ∈ PJ . There also exists g0 ∈ G1 such that g0
     g                     1

normalizes T and B. Moreover, g0 can be chosen in such a way that g0 LJ = Lδ(J)
for J ⊂ I. We will fix such g0 in the rest of this paper.
   In particular, if G1 = G, then δ = id, where id is the identity map. In this case,
we choose g0 to be the unit element 1 of G.
1.3. We will follow the set-up of [L4].
                                  ′
    Let J, J ′ ⊂ I and y ∈ J W J be such that Ad(y)δ(J) = J ′ . For P ∈ PJ ,
P ′ ∈ PJ ′ , define Ay (P, P ′ ) = {g ∈ G1 | pos(P ′ , g P ) = y}. Define

           Z̃J,y,δ = {(P, P ′ , γ) | P ∈ PJ , P ′ ∈ PJ ′ , γ ∈ UP ′ \Ay (P, P ′ )/UP }

with G × G action defined by (g1 , g2 )(P, P ′ , γ) = (g2 P, g1 P ′ , g1 γg2−1 ).
   By [L4, 8.9], Ay (P, P ′ ) is a single P ′ , P double coset. Thus G × G acts transi-
tively on ZJ,y,δ .
   Let z = (P, P ′ , γ) ∈ Z̃J,y,δ . Then there exists g ∈ γ such that g P contains some
                                                ′P           ′
Levi of P ∩ P ′ . Now set P1 = g −1 (g P )(P ) g, P1′ = P P . Define

                              α(P, P ′ , γ) = (P1 , P1′ , UP1′ gUP1 ).

By [L4, 8.11], The map α doesn’t depend on the choice of g.
   To z = (P, P ′ , γ) ∈ Z̃J,y,δ , we associate a sequence (Jk , Jk′ , uk , yk , Pk , Pk′ , γk )k>0
                                         ′
with Jk , Jk′ ⊂ I, uk ∈ W , yk ∈ Jk W δ(Jk ) , Ad(yk )δ(Jk ) = Jk′ , Pk ∈ PJk , Pk′ ∈
PJk′ , γk = UPk′ gUPk for some g ∈ G satisfies pos(Pk′ , g Pk ) = yk . The sequence is
defined as follows.

         P0 = P, P0′ = P ′ , γ0 = γ, J0 = J, J0′ = J ′ , u0 = pos(P0′ , P0 ), y0 = y.
                              ′               ′
Assume that k > 1, that Pm , Pm , γm , Jm , Jm  , um , ym are already defined for m < k
                     ′                       ′
and that um = pos(Pm , Pm ), Pm ∈ PJm , Pm ∈ PJm       ′ for m < k. Let

                           −1
      Jk = Jk−1 ∩ δ −1 Ad(yk−1 uk−1 )Jk−1 , Jk′ = Jk−1 ∩ Ad(u−1
                                                             k−1 yk−1 )δ(Jk−1 ),


             (Pk , Pk′ , γk ) = α(Pk−1 , Pk−1
                                          ′
                                              , γk−1 ) ∈ Z̃Jk ,yk ,δ (see [L4, 8.10]),
                 uk = pos(Pk′ , Pk ), yk = u−1
                                            k−1 yk−1 , γk = UPk gk−1 UPk .
                                                              ′


   It is known that the sequence is well defined. Moreover, for sufficient large
n, we have that Jn = Jn′ = Jn+1 = Jn+1′
                                           = · · · = J∞ , un = un+1 = · · · = 1,
yn = yn+1 = · · · = y∞ , Pn = Pn+1 = · · · = P∞ , Pn′ = Pn+1
                                                           ′              ′
                                                               = · · · = P∞ and
4                                           XUHUA HE

γn = γn+1 = · · · = γ∞ . Now we set β(z) = y∞ . Then we have that β(z) ∈ W δ(J) .
By [L4, 8.18] and [L3, 2.5], the sequence (Jn , Jn′ , un , yn )n>0 is uniquely determined
by β(z) and y.
   For w ∈ W δ(J) , set

                               w
                             Z̃J,y,δ = {z ∈ Z̃J,y,δ | β(z) = w}.

                w
   Then (Z̃J,y,δ     )w∈W δ(J ) is a partition of Z̃J,y,δ into locally closed G-stable subva-
                         w
rieties. We call (Z̃J,y,δ    )w∈W δ(J ) the G-stable pieces of Z̃J,y,δ . For w ∈ W δ(J) , let
(Jn , Jn′ , un , yn )n>0 be the sequence determined by w and y. The restriction of the
                  w                                               w
map α on Z̃J,y,δ       is a G-equivariant morphism from Z̃J,y,δ        onto Z̃Jw1 ,y1 ,δ . We also
denote this morphism by α. It is known that α induces a bijection from the set of
                    w
G-orbits on Z̃J,y,δ      to the set of G-orbits on Z̃Jw1 ,y1 ,δ .
                               w           α            α             α
   We have a consequence Z̃J,y,δ    −               → Z̃Jw2 ,y2 ,δ −
                                     → Z̃Jw1 ,y1 ,δ −              → · · · . For sufficiently
                 n     w          w
large n, ϑ = α : Z̃J,y,δ −  → Z̃J∞ ,w,δ is independent of the choice of n and is a
G-equivariant morphism. Moreover, ϑ induces a bijection from the set of G-orbits
     w
on Z̃J,y,δ to the set of G-orbits on Z̃Jw∞ ,w,δ .

  In the rest of this section, we will fix J, y, δ, w and J∞ . First, we will give an
explicit description of J∞ in terms of J, δ and w.
Lemma 1.4. Keep the notion of 1.3. Then

                         J∞ = max{K ⊂ J | Ad(w)δ(K) = K}.


   Proof. Set v = y1 w−1 . By [H, 2.2], v ∈ WJ . Now J1 = J ∩ δ −1 Ad(y1−1 )J. Thus
Φδ(J1 ) ⊂ Ad(y1−1 )ΦJ = Ad(w−1 )Ad(v −1 )ΦJ = Ad(w−1 )ΦJ .
   Let i ∈ J. Assume that αδ(i) ∈ Ad(y1−1 )ΦJ . Then αδ(i) = Ad(y1−1 )α =
Ad(y −1 )Ad(u0 )α for some α ∈ ΦJ . Then αAd(y)δ(i) = Ad(u0 )α. Note that
αAd(y)δ(i) is a simple root and u0 ∈ W J . Then α = αj for some j ∈ J. Hence
i = δ −1 Ad(y1−1 )j. Therefore, i ∈ J ∩ δ −1 Ad(y1−1 )J = J1 . So

                       J1 = max{K ⊂ J | Φδ(K) ⊂ Ad(w−1 )ΦJ }.

         ′                                           ′
   Set J∞  = max{K ⊂ J | Ad(w)δ(K) = K}. Then J∞       ⊂ J. Moreover, Φδ(J∞′ ) =
      −1              −1             ′
Ad(w )ΦJ∞   ′ ⊂ Ad(w )ΦJ . Thus J∞ ⊂ J1 . We can show by induction that
 ′                       ′
J∞ ⊂ Jn for all n. Thus J∞ ⊂ J∞ . By the definition, J∞ = J∞ ∩ δ −1 Ad(w−1 )J∞ .
                                   ′
Thus Ad(w)δ(J∞ ) = J∞ . So J∞ = J∞   . The lemma is proved. 
                                   −1
1.5. Now set h̃J,y,δ = (PJ , ẏ         PJ ′ , Uẏ−1 P ′ g0 UPJ ) ∈ ZJ,y,δ . For w ∈ W δ(J) and
                                                   J

             ^
v ∈ W , set [J, w, v]y,δ = (B × B)(ẇ, v̇) · h̃J,y,δ . Then we have the following result.
         THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                                                             5

Lemma 1.6. Keep the notion of 1.3. Let g ∈ PJ1 . Set z = (ẇ, g) · h̃J,y,δ and
z ′ = (ẇ, g) · h̃J1 ,y1 ,δ . Then α(z) = z ′ .
                                                  −1
   Proof. Set P = PJ , P ′ = ẇẏ PJ ′ , g1 = ẇg0 g and v = y1 w−1 . Then v ∈ WJ .
                                −1                                        ′    −1
   By the proof of [H, 2.3], v̇ LJ1′ is a Levi factor of P ∩ P ′ and P P = v̇ PJ1′ ,
              −1
(P ′ )P = ẇẏ PAd(y)δ(J1 ) . Moreover,

                                        −1
                  v̇ −1
                          LJ1′ = ẇẏ1 LJ1′ = ẇ Lδ(J1 ) = ẇg0 LJ1 ⊂ ẇg0 PJ = ẇg0 g PJ .

   So   g1
             P contains some Levi of P ∩ P ′ . We have that
                                                                 −1 −1
               ẇ ẏ −1                               −1     g     ẏ                        −1
g1−1 (g1 P )(             PAd(y1 )δ(J1 ) )
                                             g1 = g        P(    0     PAd(y)δ(J1 ) )
                                                                                        =g        PJ∩δ−1 Ad(y−1 )Ad(y)δ(J1 )
                                                      −1
                                               =g          PJ1 = PJ1 .

   Thus α(z) = z ′ . The lemma is proved.                                
Proposition 1.7. We have that

   w
 Z̃J,y,δ            ^
         = Gdiag · [J,
                                                    −1
                       w, 1]y,δ = Gdiag · (PJ , ẇẏ PJ ′ , Uẇẏ−1 P ′ ẇg0 (B ∩ LJ∞ )UPJ ).
                                                                                                  J




    Proof. It is easy to see that Z̃Jw∞ ,w,δ = Gdiag (ẇ, LJ∞ ) · h̃J∞ ,w,δ . Thus for any
b ∈ B, αn (ẇ, b)· h̃J,y,δ ∈ Z̃Jw∞ ,w,δ for sufficiently large n. Therefore, Gdiag (ẇ, B)·
                          
            w
h̃J,y,δ ⊂ Z̃J,y,δ .
    Note that ẇg0 normalizes (LJ∞ ) and (LJ∞ ) ∩ B. Thus

                              ẇg0 LJ∞ = {lẇg0 bl−1 | l ∈ LJ∞ , b ∈ LJ∞ ∩ B}.

Hence any element in Z̃Jw∞ ,w,δ is G-conjugate to (ẇ, l)·h̃J∞ ,w,δ for some l ∈ LJ∞ ∩B.
                w
Now let z ∈ Z̃J,y,δ  . Then ϑ(z) is G-conjugate to (ẇ, l)·h̃J∞ ,w,δ for some l ∈ LJ∞ ∩B.
       ′                      w
Set z = (ẇ, l) · h̃J,y,δ ∈ Z̃J,y,δ . Then ϑ(z ′ ) lies in the same G-orbit as ϑ(z). Since
                                                             w
ϑ induces a bijection from the set of G-orbits on Z̃J,y,δ         to the set of G-orbits on
Z̃Jw∞ ,w,δ . Thus z is G-conjugate to z ′ . So Z̃J,y,δ
                                                   w
                                                         = Gdiag (ẇ, B ∩ LJ∞ )) · h̃J,y,δ . The
proposition is proved. 
                                            w
1.8. In [L4, 8.20], Lusztig showed that Z̃J,y,δ is an iterated affine space bundle
over a fibre bundle over PJ∞ with fibres isomorphic to LJ∞ . In 1.10, we will prove
a similar (but more explicit) result, which will be used to establish the cellular
decomposition. Before doing that, we include the following result (see [SL, page
26, lemma 4]) which we will use in the proof of proposition 1.10 and proposition
5.5.
6                                              XUHUA HE

Lemma 1.9. Let H be a closed subgroup of G and Φ : X → G/H be a G-
equivariant morphism from the G-variety X to the homogeneous space G/H. Let
E ⊂ X be the fiber Φ−1 (H). Then E will be stabilized by H and the map Ψ :
G ×H E → X sending (g, e) to g · e defines an isomorphism of G-varieties.
Proposition 1.10. For a ∈ W , set Ua = U ∩ ȧ U − . Set

                             L̃w
                               J,y,d = (LJ∞ , LJ∞ )(ẇ, 1) · h̃J,y,δ .

    Then we have the following results.
          w
                is isomorphic to G ×PJ∞ (PJ∞ ) · L̃w
                                                        
    (1) Z̃J,y,δ                                    J,y,δ .
                                                     J∞    −1 J ′
    (2) (PJ ) · L̃w     = (B × B) · L̃w  ∼
                                         = (U ∩ ẇ0 ẇẏ ẇ0 U − ) × L̃w
            ∞       J,y,δ                        J,y,δ                                                            J,y,δ ,   where
L̃w
  J,y,δ is isomorphic to LJ∞ .
                                               w
    (3) Gdiag (ẇT, 1) · h̃J,y,δ is dense in Z̃J,y,δ .
   Proof. It is easy to see that L̃w    J,y,δ = (ẇ, LJ∞ ) · h̃J,y,δ is isomorphic to LJ∞ . By
1.7, Z̃J,y,δ = Gdiag · L̃J,y,δ . Consider the G-equivariant map p : Z̃Jw∞ ,w,δ −
       w                   w
                                                                                            → PJ∞
                                                         w
defined by p(P, P, γ) = P for (P, P, γ) ∈ Z̃J∞ ,w,δ . For l ∈ LJ∞ and g ∈ G,
if p ◦ ϑ (g, g)(ẇ, l) · h̃J,y,δ = PJ∞ , then g ∈ PJ∞ . Thus (PJ∞ )diag · L̃w
                                
                                                                                             J,y,δ =
       −1
(p ◦ ϑ) (PJ∞ ).
   Assume that (g, g)(ẇ, l1 ) · h̃w                         w
                                      J,y,δ = (ẇ, l2 ) · h̃J,y,δ for g ∈ G and l1 , l2 ∈ LJ∞ .
Then g PJ∞ = p ◦ ϑ (g, g)(ẇ, l1 ) · h̃w                                  w
                                                                              
                                         J,y,δ   = p ◦ ϑ  ( ẇ, l 2 ) · h̃J,y,δ = PJ∞ . So g ∈ PJ∞ .
Part (1) is proved.
   We have that (B × B) · L̃w                                    w                          w
                                                                                                  
                                  J,y,δ = (B)diag (1, B) · L̃J,y,δ and p ◦ ϑ (1, B) · L̃J,y,δ =
PJ∞ . Thus (B × B) · L̃w                                            w                     w
                               J,y,δ ⊂ (B)diag (PJ∞ )diag L̃J,y,δ = (PJ∞ )diag L̃J,y,δ . On
the other hand, (PJ∞ )diag L̃w                                  w                       w
                                  J,y,δ ⊂ (PJ∞ , PJ∞ ) · L̃J,y,δ = (B × B) · L̃J,y,δ . Hence
(PJ∞ ) · L̃w                      w
           J,y,δ = (B × B) · L̃J,y,δ .
                                 J∞                  ′
                                      ẇẏ −1 ẇ0J
    Now consider π : (U ∩ ẇ0                            U − ) × L̃w     → (B × B) · L̃w
                                                                   J,y,δ −             J,y,δ defined by
                                     J∞       −1         J′
π(u, l) = (u, 1)l for u ∈ U ∩ ẇ0 ẇẏ ẇ0 U − and l ∈ L̃w
                                                         J,y,δ .
   Note that (1, BLJ∞ ) · h̃J,y,δ = (1, UPJ LJ∞ UJ ) · h̃J,y,δ = (Uδ(J) , LJ∞ ) · h̃J,y,δ .
Since w ∈ W δ(J) , B ẇUδ(J) = B ẇ = UPJ∞ LJ∞ ẇ. Hence

    (B ẇ, BLJ∞ ) · h̃J,y,δ = (UPJ∞ ẇLδ(J∞ ) , LJ∞ ) · h̃J,y,δ = (UPJ∞ ẇ, LJ∞ ) · h̃J,y,δ .
                     ′
Since wy −1 ∈ W J and Ad(yw−1 )J∞ ⊂ J ′ , then
                                                −1              ′                                 −1
                                                         ẇ0J
                   UPJ∞ = (UPJ∞ ∩ ẇẏ                              U − )(UPJ∞ ∩ ẇẏ                  UP J ′ )
                                                         ′
                                      ẇ0J∞ ẇẏ −1 ẇ0J                                          −1
                            = (U ∩                                  U − )(UPJ∞ ∩ ẇẏ                  UPJ ′ ).
                                                                      J∞                   ′
                                                                           ẇ ẏ −1 ẇ0J
   Therefore, (B ẇ, BLJ∞ ) · h̃J,y,δ = (U ∩ ẇ0                                               U − )ẇ, LJ∞ · h̃J,y,δ . So π is
                                                                                                           

surjective.
       THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                               7

                  J∞      −1   J′
   Let u ∈ U ∩ ẇ0 ẇẏ ẇ0 U − and l1 , l2 ∈ LJ∞ . Assume that (u, 1)(ẇ, l1 ) · h̃J,y,δ =
(ẇ, l2 ) · h̃J,y,δ . Note that the isotropy subgroup of G × G at the point (ẇ, 1) · h̃J,y,δ
is {(Uẇẏ−1 P ′ l′ , UPJ g0−1 ẇ−1 l′ ẇg0 ) | l′ ∈ ẇ Lδ(J) }.
            J

   Thus u ∈ Uẇẏ−1 P ′ l′ and l2−1 l1 ∈ UPJ g0−1 ẇ−1 l′ ẇg0 for some l′ ∈ ẇ Lδ(J) . Then
                     J
l′ ∈ LJ∞ and u = 1. Thus π is injective.
   In fact, we can show that the bijective morphism π is an isomorphism. The
verification is omitted.
   Part (3) can be proved in the same way as in [H, 2.7]. 

1.11. For P ∈ PJ , let HP be the inverse image of the connected center of P/UP
under P − → P/UP . We can regard HP /UP as a single torus ∆J independent of P .
Then ∆J acts (freely) in the natural way on Z̃J,y,δ and the action commutes with
                                        w
the action of G. Moreover, each piece Z̃J,y,δ is ∆J -stable.
   Define

          ZJ,y,δ = {(P, P ′ , γ) | P ∈ PJ , P ′ ∈ PJ ′ , γ ∈ HP ′ \Ay (P, P ′ )/UP }
                 = {(P, P ′ , γ) | P ∈ PJ , P ′ ∈ PJ ′ , γ ∈ UP ′ \Ay (P, P ′ )/HP }

with G × G action defined by (g1 , g2 )(P, P ′ , γ) = (g2 P, g1 P ′ , g1 γg2−1 ).
   Then ZJ,y,δ and ∆J \Z̃J,y,δ can be identified in the natural way as varieties with
                w             w
G-action. Set ZJ,y,δ = ∆J \Z̃J,y,δ . Then

                                                         w
                                    ZJ,y,δ = ⊔w∈W δ(J ) ZJ,y,δ .

             w
   We call (ZJ,y,δ )w∈W δ(J ) the G-stable pieces of ZJ,y,δ . Set

                                           −1
                       hJ,y,δ = (PJ , ẏ        PJ ′ , Hẏ−1 P ′ g0 UPJ ) ∈ ZJ,y,δ ,
                                                             J

                    Lw
                     J,y,δ = (LJ∞ , LJ∞ )(ẇ, 1) · hJ,y,δ .


For w ∈ W δ(J) and v ∈ W , set [J, w, v]y,δ = (B × B)(ẇ, v̇) · hJ,y,δ . Then as a
consequence of 1.7 and 1.10, we have the following result.

Proposition 1.12. For w ∈ W δ(J) , we have that
       w
  (1) ZJ,y,δ = Gdiag · [J, w, 1]y,δ .
       w
  (2) ZJ,y,δ is isomorphic to G ×PJ∞ (PJ∞ ) · Lw
                                                    
                                               J,y,δ .
                                                                                ′
                                            ∼      ẇ0J∞ ẇẏ −1 ẇ0J
  (3) (PJ∞ ) · Lw                      w
                 J,y,δ = (B × B) · LJ,y,δ = (U ∩                      U − ) × Lw
                                                                               J,y,δ , where
 w
LJ,y,δ is isomorphic to LJ∞ /Z(LJ ).
                                           w
  (4) Gdiag (ẇT, 1) · hJ,y,δ is dense in ZJ,y,δ .
8                                          XUHUA HE

                   2. Compactification through the fibres
2.1. For any connected, semi-simple algebraic group of adjoint type, De Concini
and Procesi introduced its wonderful compactification Ḡ(see [DP]). It is an irre-
ducible, projective smooth G × G-variety. The G × G-orbits ZJ of Ḡ are indexed
by the subsets J of I. Moreover, ZJ = (G × G) ×P − ×PJ GJ , where PJ− × PJ acts
                                                        J
on the right on G × G and on the left on GJ by (q, p) · z = πP − (q)zπPJ (p). Denote
                                                                  J
by hJ the image of (1, 1, 1) in ZJ . We will identify ZJ with ZJ,w0 w0J ,id and hJ with
hJ,w0 w0J ,id , where id is the identity map on I (see [H, 2.5]).
   Let us consider the B × B-orbits on Ḡ. For    F any F J ⊂ I, u ∈ W J and v ∈ W ,
set [J, u, v] = (B × B)(u̇, v̇) · hJ . Then Ḡ =                [J, x, w]. The following
                                                  J⊂I x∈W J ,w∈W
result is due to Springer (see [S, 2.4]).
Theorem. Let x ∈ W J , x′ ∈ W K , w, w′ ∈ W . Then [K, x′ , w′ ] is contained in
the closure of [J, x, w] if and only if K ⊂ J and there exists u ∈ WK , v ∈ WJ ∩W K
with xvu−1 6 x′ , w′ u 6 wv and l(wv) = l(w) + l(v). In particular, for J ⊂ I and
w ∈ W J , the closure of [J, w, 1] in Ḡ is ⊔K⊂J ⊔x∈W K ,u∈WJ , and x>wu [K, x, u].
2.2. We have defined ZJ,y,δ in 1.11. As we have seen, ZJ,y,δ is a locally trivial fibre
bundle over PJ × PJ ′ with fibres isomorphic to LJ /Z(LJ ). Note that LJ /Z(LJ ) is
a connected, semi-simple algebraic group of adjoint type. Thus we can define the
wonderful compactification LJ /Z(LJ ) of LJ /Z(LJ ). In this section, we will define
ZJ,y,δ , which is a locally trivial fibre bundle over PJ × PJ ′ with fibres isomorphic
to LJ /Z(LJ ).
2.3. We keep the notation of 1.3. Fix g ∈ Ay (P, P ′ ). Then Ay (P, P ′ )g −1 = P ′ Ug P
(see [L4, 8.9]). Set
                          LP,P ′ ,g = g P ∩ P ′ /Hg P ∩P ′ .
    Let Φg : HP ′ \Ay (P, P ′ )/HP −
                                   → LP,P ′ ,g be the morphism defined by

                                   ·g −1                              i
           HP ′ \Ay (P, P ′ )/HP −−−→ HP ′ \Ay (P, P ′ )g −1 /Hg P ←
                                                                   − LP,P ′ ,g ,

where i is the obvious isomorphism.
   The P × P ′ action on HP ′ \Ay (P, P ′ )/HP induces a P × P ′ action on LP,P ′ ,g .
                                                                  ≃
Now for g, g ′ ∈ Ay (P, P ′ ), set Φg,g ′ = Φg ′ Φ−1
                                                  g  : LP,P ′ ,g −→ LP,P ′ ,g ′ . Then Φg,g ′
is compatible with the P × P ′ action. Moreover, (LP,P ′ ,g , Φg,g ′ ) forms an inverse
system and
                         HP ′ \Ay (P, P ′ )/HP = lim LP,P ′ ,g .
                                                      ←

   Note that LP,P ′ ,g is a semi-simple group of adjoint type. Then we can define
the De Concini-Procesi compactification LP,P ′ ,g of LP,P ′ ,g . The P × P ′ action on
LP,P ′ ,g can be extended in the unique way to a P × P ′ action on LP,P ′ ,g . The
                                ≃
isomorphism Φg,g ′ : LP,P ′ ,g −→ LP,P ′ ,g ′ can be extended in the unique way to an
          THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                                             9

isomorphism from LP,P ′ ,g onto LP,P ′ ,g ′ . We will also denote this isomorphism by
Φg,g ′ . It is easy to see that this isomorphism is compatible with the P × P ′ action.
Now (LP,P ′ ,g , Φg,g ′ ) forms an inverse system. Define
                                   HP ′ \Ay (P, P ′ )/HP = lim LP,P ′ ,g .
                                                                  ←

  We also obtain a P × P ′ action on HP ′ \Ay (P, P ′ )/HP . Thus we can identify
HP ′ \Ay (P, P ′ )/HP with LP,P ′ ,g g as varieties with P × P ′ action.
Remark. HP ′ \Ay (P, P ′ )/HP is isomorphic to LP,P ′ ,g as a variety. However, we
are also concerned with the P ′ × P action. In this case, HP ′ \Ay (P, P ′ )/HP is
regarded as LP,P ′ ,g g with “twisted” P ′ × P action.
2.4. In this section, we will consider a special case, namely, P = P ′ = G0 . In this
case, Ay (P, P ′ ) = G1 and we will identify HG \Ay (G, G)/HG with G1 .
   Let VG be the projective variety whose points are the dim(G)-dimensional Lie
subalgebras of Lie(G × G). The Ĝ × Ĝ action on Lie(G × G) which is defined
by (g1 , g2 ) · (a, b) = (Ad(g2 )a, Ad(g1 )b) for g1 , g2 ∈ Ĝ and a, b ∈ Lie(G) induces a
Ĝ × Ĝ action on VG . To each g ∈ Ĝ, we associate a dim(G)-dimensional subspace
Vg = {(a, Ad(g)a) | a ∈ Lie(G)} of Lie(G × G). Then Vg1 gg −1 = (g1 , g2 ) · Vg for
                                                                                   2

g1 , g, g2 ∈ Ĝ and g 7→ Vg is an embedding G1 ⊂ VG . We denote the image by
i(G1 ).
    If G1 = G, then the closure of i(G) in VG is Ḡ (see [DP]). Note that Vgg0 =
(1, g0−1 )Vg for all g ∈ G. Thus i(G1 ) = (1, g0−1 )i(G). Hence the closure of i(G1 ) in
VG is (1, g0−1 )Ḡ, which is just Ḡ1 defined above.
Remark. In [L4, 12.3], Lusztig defined the compactification of G1 to be the
closure of i(G1 ) in VG . As we have seen, our definition coincides with his definition.
2.5. In [L4, 12.3], Lusztig showed that
                                                                            w
                   Ḡ1 = ⊔J⊂I ZJ,w            δ(J )      = ⊔J⊂I ⊔w∈W δ(J ) ZJ,w      δ(J )      ,
                                           0 w0     ,δ                            0 w0     ,δ
                                                            −
where the base point hJ,w               δ(J )      = (PJ , Pδ(J) , HP − g0 HPJ ) is identified with the
                                     0 w0     ,δ                      δ(J )

dim(G)-dimensional subalgebra {(lu, g0 lg0−1 u′ ) | l ∈ LJ , u ∈ UPJ , u′ ∈ UP − } of
                                                                                                    δ(J )
Lie(G × G). We will simply write hJ,w0 wδ(J ) ,δ as hJ,δ , [J, w, v]w0wδ(J ) ,δ as [J, w, v]δ
                                                            0                             0
and Z w        δ(J )
                                w
                            as ZJ,δ             w
                                    . We call (ZJ,δ )J⊂I,w∈W δ(J ) the G-stable pieces of Ḡ1 . If
         J,w0 w0       ,δ
  1
G = G, then hJ,id = hJ and [J, w, v]id = [J, w, v].
   Note that hJ corresponds to the dim(G)-dimensional subalgebra {(lu, lu′ ) | l ∈
LJ , u ∈ UPJ , u′ ∈ UP − } of Lie(G × G). Thus hJ,δ = (1, g0−1)hδ(J) . Hence
                               J


              [J, w, v]δ = (B × B)(ẇ, v̇) · hJ,δ = (B × B)(ẇ, v̇)(1, g0−1 ) · hJ
                                         ˙ ·h
               = (1, g0−1 )(B × B)(ẇ, δ(v))                 −1
                                                 δ(J) = (1, g0 )[δ(J), w, δ(v)].

      Thus we have the following result.
10                                             XUHUA HE

Proposition. Let J ⊂ I and w ∈ W δ(J) . Then the closure of [J, w, 1]δ in Ḡ1 is
⊔K⊂J ⊔x∈W δ(K) ,u∈WJ , and x>wδ(u) [K, x, u]δ .
2.6. Define
          ZJ,y,δ = {(P, P ′ , γ) | P ∈ PJ , P ′ ∈ PJ ′ , γ ∈ HP ′ \Ay (P, P ′ )/HP }

   with G × G action defined by (g1 , g2 )(P, P ′ , γ) = (g2 P, g1 P ′ , g1 γg2−1 ).
                             −1
   Set P = PJ and P ′ = ẏ PJ ′ . Then Ay (P, P ′ ) can be identified with LP,P ′ ,g0 g0
as varieties with P ′ × P action. Moreover, we have a canonical isomorphism be-
tween LP,P ′ ,g0 and Lδ(J) . For K ⊂ J, I will identify hδ(K) g0 with the corresponding
element in Ay (P, P ′ ).
   Then the G × G-orbits in ZJ,y,δ are in one-to-one correspondence with the
subsets of J, i. e.,
                              ZJ,y,δ = ⊔K⊂J (G × G) · (P, P ′ , hδ(K) g0 ).
                  δ(J)        δ(K)
     Set yK = yw0           w0       . Note that UPJ (LJ ∩ UPK ) = UPK and
                      −1                         −1            −1         −1
           UP ′ (ẏ        LJ ′ ∩ UP − ) = (ẏK UẏK P ′ )ẏK (ẏK ẏ          LJ ′ ∩ ẏK UP − )
                                      δ(K)                                                 δ(K)
                  −1                                            −1
                ẏK                                           ẏK
            =          (UPJ ′ (LJ ′ ∩ UPAd(yK )δ(K) )) =             UPAd(yK )δ(K) .

     The isotropic subgroup of G × G at (P, P ′ , hδ(K) g0 ) is {(l1 u1 , g0−1 l2 g0 u2 ) |
l1 , l2 ∈ Lδ(K) , l1 l2−1 ∈ Z(Lδ(K) ), u1 ∈ Uẏ−1         , u2 ∈ UPK }. Now set
                                                          K   PAd(yK )δ(K)
                         −1
Q = PK , Q ′ =          PAd(yK )δ(K) and γ = HQ′ g0 HQ . Then pos(Q′ , g0 Q) = yK
                       ẏK

and (Q, Q , γ) ∈ ZK,yK ,δ . The isotropic subgroup of G × G at (P, P ′ , hδ(K) g0 ) is
           ′

the same as the isotropic subgroup of G × G at (Q, Q′ , γ) ∈ ZK,yK ,δ . Thus we can
identify (P, P ′ , hδ(K) g0 ) with (Q, Q′ , γ) and (G × G) · (P, P ′ , hδ(K) g0 ) with ZK,yK ,δ
as varieties with G × G action. In other words,
                                     ZJ,y,δ = ⊔K⊂J ZK,ywδ(J )wδ(K) ,δ .
                                                              0       0

                                       3. Partial order on Iδ
  In this section, we will only consider subvarieties of G and for any subvariety
X of G, we denote by X̄ the closure of X in G.
3.1. Let y, w ∈ W . Then y 6 w if and only if for any reduced expression w =
s1 s2 · · · sq , there exists a subsequence i1 < i2 < · · · < ir of 1, 2, . . . , q such that
y = si1 si2 · · · sir . (see [L2, 2.4])
    The following assertion follows from the above property.
    (1) If l(wu) = l(w) + l(u), then for any w1 6 w and u1 6 u, w1 u1 6 wu.
    (2) Let u, v ∈ W and i ∈ I. Assume that si v < v, then u 6 v ⇔ su 6 v.
    (3) Let u, v ∈ W and i ∈ I. Assume that u < si u, then u 6 v ⇔ u 6 si v.
    The assertion (1) follows directly from the above property. The proofs of asser-
tions (2) and (3) can be found in [L2, 2.5].
        THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                                  11

3.2. It is known that G = ⊔w∈W B ẇB and for w, w′ ∈ W , B ẇB ⊂ B ẇ′ B if and
only if w 6 w′ . Moreover,
                                      B ẇB,     if si w < w;
                                    
                      B s˙i B ẇB =
                                      B ṡi ẇB, if si w > w.
   Similarly, G = ⊔w∈W B ẇB − and for w, w′ ∈ W , B ẇB − ⊂ B ẇ′ B − if and only
if w > w′ . Moreover,
                                         B ẇB − ,     if si w > w;
                                       
                      B s˙i B ẇB − =
                                         B ṡi ẇB − , if si w < w.
Lemma 3.3. Let u, w ∈ W . Then
   (1) The subset {vw | v 6 u} of W contains a unique minimal element y.
Moreover, l(y) = l(w) − l(yw−1 ) and B u̇B ẇB − = B ẏB − .
   (2) The subset {vw | v 6 u} of W contains a unique maximal element y ′ .
Moreover, l(y ′ ) = l(w) + l(y ′ w−1 ) and B u̇B ẇB = B ẏ ′ B.
    Proof. We will only prove part (1). Part (2) can be proved in the same way.
    For any v 6 u, B v̇ ⊂ B u̇B. Thus B v̇ẇB − ⊂ B u̇B ẇB − ⊂ B u̇B ẇB − . On the
other hand, B u̇B ẇB − is an irreducible, closed, B × B − -stable subvariety of G.
Thus there exists y ∈ W , such that B u̇B ẇB − = B ẏB − . Since B v̇ẇB − ⊂ B ẏB − ,
we have that vw > y. Now it suffices to prove that y = vw for some v 6 u with
l(vw) = l(w) − l(v).
    We argue by induction on l(u). If l(u) = 0, then u = 1 and statement is clear.
Assume now that l(u) > 0. Then there exists i ∈ I, such that si u < u. We denote
si u by u′ . Now
                     B u̇B ẇB − = B ṡi B u̇′ B ẇB − = B ṡi B u̇′ B ẇB − .
   By induction hypothesis, there exists v ′ 6 u′ , such that l(v ′ w) = l(w) − l(v ′ )
and B u̇′ B ẇB − = B v̇ ′ ẇB − . Thus
                                                           B v̇ ′ ẇB − ,     if si v ′ w > v ′ w;
                                                        
          ′     −             ′    −            ′
B ṡi B u̇ B ẇB = B ṡi B v̇ ẇB = B ṡi B v̇ ẇB = −
                                                           B ṡi v̇ ′ ẇB − , if si v ′ w < v ′ w.
   Note that si u < u and v ′ 6 si u < u. Thus si v ′ 6 u. Moreover, if si v ′ w < v ′ w,
then l(si v ′ w) = l(v ′ w) − 1 = l(w) − l(v ′ ) − 1. Thus we have that l(si v ′ ) = l(v) + 1
and l(si v ′ w) = l(w) − l(si v ′ ). Therefore, the statement holds for u. 
Corollary 3.4. Let u, w, w′ ∈ W with w′ 6 w. Then
  (1) There exists v 6 u, such that vw′ 6 uw.
  (2) There exists v ′ 6 u, such that uw′ 6 v ′ w.
   Proof. Let v 6 u be the element of W such that vw′ is the unique minimal
element in {v ′ w′ | v ′ 6 u}. Then B u̇B ẇ′ B − = B v̇ẇ′ B − . Since w′ 6 w, we have
that B ẇB − ⊂ B ẇ′ B − . Thus
           B u̇ẇB − ⊂ B u̇B ẇB − ⊂ B u̇B ẇ′ B − ⊂ B u̇B ẇ′ B − = B v̇ẇ′ B − .
  So uw > vw′ . Thus Part (1) is proved. Part (2) can be proved in the same
way. 
12                                   XUHUA HE

3.5. We will recall some known results about W J .
   (1) If w ∈ W J and i ∈ I, then there are three possibilities.
      (a) si w > w and si w ∈ W J ;
      (b) si w > w and si w = wsj for some j ∈ J;
      (c) si w < w in which case si w ∈ W J .
   (2) If w ∈ W J , v ∈ WJ and K ⊂ J, then v ∈ W K if and only if wv ∈ W K .
                ′
   (3) If w ∈ J W J and u ∈ WJ ′ , then uw ∈ W J if and only if u ∈ W K , where
K = J ′ ∩ Ad(w)J.
                          ′
Lemma 3.6. Let w ∈ J W J , u ∈ WJ ′ and K = J ′ ∩ Ad(w)J, then uw = vwu′
for some v ∈ WJ ′ ∩ W K and u′ ∈ WAd(w−1 )K .
   Proof. We argue by induction on l(u). If u = 1, then the statement is clear.
Now assume that u = si u1 for some i ∈ J ′ and l(u1 ) < l(u). Then by induction
hypothesis, u1 w = v1 wu′1 for some v1 ∈ WJ ′ ∩ W K and u′1 ∈ WAd(w−1 )K .
   If si v1 w ∈ W J , then the statement holds for u. Now assume that si v1 w ∈
                                                                              / WJ.
                                                        / W K . Thus si v1 = v1 sk for
Then si v1 w > v1 w. Hence si v1 > v1 . Moreover, si v1 ∈
some k ∈ K. Note that sk w = wsl for some l ∈ Ad(w−1 )K. Thus the statement
holds for u. The lemma is proved. 
3.7. Let J ⊂ I and w, w′ ∈ W with l(w) = l(w′ ). We say that w′ can be obtained
from w via a (J, δ)-cyclic shift if w = si1 si2 · · · sin is a reduced expression and
either (1) i1 ∈ J and w′ = si1 wsδ(i1 ) or (2) in ∈ δ(J) and w′ = sδ−1 (in ) wsin .
We say that w and w′ are equivalent in J if there exists a finite sequences of
elements w = w0 , w1 , . . . , wm = w′ such that wk+1 can be obtained from wk via a
(J, δ)-cyclic shift. (We then write w ∼J,δ w′ .)
Proposition 3.8. Let (J, w) ∈ Iδ and w′ ∈ W . The following conditions on w′
are equivalent:
   (1) w′ > u−1 wδ(u) for some u ∈ WJ .
   (2) w′ > u−1 wδ(v) for some u 6 v ∈ WJ .
   (3) w′ > w1 for some w1 ∼J,δ w.
   Proof. The implication (1)⇒(2) is trivial. The implication (3)⇒(1) follows
from the definition. We now prove the implication (2)⇒(3) by induction on |J|.
Assume that the implication holds for all J ′ ⊂ I with |J ′ | < |J|. Then we prove
that the implication holds for J by induction on l(v).
   Set w = xy with x ∈ WJ and y ∈ J W δ(J) . Set K = J ∩ δ −1 Ad(y −1 )J,
v = v1 v2 with v1 ∈ WK , v2 ∈ K W and u = u1 u2 with u1 6 v1 , u2 6 v2 and
l(u) = l(u1 ) + l(u2 ). There are two cases.
   Case 1. u2 = v2 = 1.
   In this case, u, v ∈ WK and w ∈ W δ(K) . If |K| < |J|, then by induction
hypothesis, u−1 wδ(v) > w1 for some w1 ∼K,δ w. If K = J, then since w = xy ∈
W δ(J) , we have that x = 1. Thus u−1 wδ(v) > w. The implication is proved in
this case.
   Case 2. v2 6= 1.
       THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                                     13

   In this case, l(v1 ) < l(v). By induction hypothesis, there exists w1 ∼J,δ w, such
that w1 6 u−11 wδ(v1 ). Let u3 6 u2 be the element in W such that u3 w1 is the
                                                                              −1
                                                                 −1
unique minimal element in {(u′ )−1 w1 | u′ 6 u2 }. Then l(u3 w1 ) = l(w1 ) − l(u3 )
and u−1          −1 −1
      3 w1 6 u2 u1 wδ(v1 ) = u
                                     −1
                                        wδ(v1 ). By 3.6, u−1 w = ab for some a ∈ W δ(J)
and b ∈ Wδ(K) . Thus l(u−1 wδ(v1 v2 )) = l(abδ(v1 v2 )) = l(a) + l(bδ(v1 v2 )) =
l(a) + l(bδ(v1 )) + l(δ(v2 )) = l(abδ(v1 )) + l(δ(v2 )) = l(u−1 wδ(v1 )) + l(δ(v2 )). By
3.1, u−1
      3 w1 δ(u3 ) 6 u
                        −1
                           wδ(v).
   Now assume that u3 = si1 si2 · · · sik and u−1    3 w1 = sj1 sj2 · · · sjl are reduced
expressions. For m = 1, 2, . . . , k + 1, set

            xm = (sim sim+1 · · · sik )(sj1 sj2 · · · sjl )(sδ(i1 ) sδ(i2 ) · · · sδ(im−1 ) ).

Then l(xm ) 6 k + l = l(w1 ) for all m. On the other hand, for any m, there
                                    −1
exists ym ∈ WJ , such that xm = ym     wδ(ym ). Note that w ∈ W J , we have that
   −1                            −1
l(ym wδ(ym )) > l(wδ(ym ))−l(ym ) = l(w) = l(w1 ) for all ym ∈ WJ . Thus l(xm ) =
l(w1 ) and xm ∼J,δ w1 for all m. In particular, u−1
                                                 3 w1 δ(u3 ) = xk+1 ∼J,δ w1 . The
implication is proved in this case. 
Remark. We see from the proof that u−1 wδ(v) > x−1 wδ(x) for some x 6 u.
This result will be used in the proof of 5.2.
3.9. Let (J, w) ∈ Iδ and w′ ∈ W , we say that w′ >J,δ w if w′ satisfies the
equivalent conditions 3.8 (1)-(3). It is easy to see that x > w ⇒ x >J,δ w ⇒
l(x) > l(w).
    Now for (J1 , w1 ), (J2 , w2 ) ∈ Iδ , we say that (J1 , w1 ) 6δ (J2 , w2 ) if J1 ⊂ J2 and
w1 >J,δ w2 . In the end of this section, we will show that 6 is a partial order on
Iδ . (The definition of partial order can be found in 3.12).
Lemma 3.10. Let J ⊂ I, w ∈ W J , u ∈ W with l(uw) = l(u) + l(w). Assume
that uw = xv with x ∈ W J and v ∈ WJ . Then for any v ′ 6 v, there exists u′ 6 u,
such that u′ w = xv ′ .
    Proof. We argue by induction on l(u). If l(u) = 0, then u = 1 and statement is
clear. Assume now that l(u) > 0. Then there exists i ∈ I, such that si u < u. We
denote si u by u1 . Let u1 w = x1 v1 with x1 ∈ W J and v1 ∈ WJ . Then si x1 > x1 .
    If si x1 ∈ W J , then the lemma holds by induction hypothesis. If si x1 ∈     / WJ,
then there exists j ∈ J, such that si x1 = x1 sj . In this case, sj v1 > v1 . Let
v ′ 6 sj v1 . If v ′ 6 v1 , then the lemma holds by induction hypothesis. If v ′ 
 v1 ,
then v ′ = sj v1′ for some v1′ 6 v1 . By induction hypothesis, there exists u′1 6 u1 ,
such that u′1 w = x1 v1′ . Thus si u′1 w = x1 sj v1′ . The lemma holds in this case. 
Lemma 3.11. Fix J ⊂ I and w ∈ W δ(J) . For any K ⊂ J, w′ ∈ W δ(K) with
w′ >J,δ w, there exists x ∈ W δ(K) , u ∈ WJ and u1 ∈ WK , such that x > wδ(u)
and w′ = u−1
           1 u
               −1
                  xδ(u1 ).
   Proof. Since w′ >J,δ w, there exists v1 ∈ WJ , such that w′ > v1−1 wδ(v1 ). By
3.4, there exists v ′ 6 v1 , such that v ′ w′ > wδ(v1 ) > wδ(v ′ ). Let v be a minimal
14                                           XUHUA HE

element in the set {v ∈ WJ | vw′ > wδ(v)}. Then l(vw′ ) = l(v) + l(w′ ). Now
assume that vw′ = xδ(v ′ ) for some x ∈ W δ(K) and v ′ ∈ WK . Then there exists
v1′ 6 v ′ , such that x > wδ(v)δ(v1′ )−1 . By 3.10, xδ(v1′ ) = v2 w′ for some v2 6 v.
Since l(xδ(v1′ )) = l(x) + l(v1′ ), v2 w′ = xδ(v1′ ) > wδ(v) > wδ(v2 ). Therefore, v2 = v
and v1′ = v ′ . So x > wδ(v)δ(v ′ )−1 . Now set u = v(v ′ )−1 and u1 = v ′ . Then
w′ = v −1 xδ(v ′ ) = u−1
                      1 u
                          −1
                             xδ(u1 ). 
3.12. A relation 6 is a partial order on a set S if it has:
   1. Reflexivity: a 6 a for all a ∈ S.
   2. Antisymmetry: a 6 b and b 6 a implies a = b.
   3. Transitivity: a 6 b and b 6 c implies a 6 c.
Proposition 3.13. The relation 6δ on the set Iδ is a partial order.
   Proof. Reflexivity is clear from the definition.
   For (J1 , w1 ), (J2 , w2 ) ∈ Iδ with (J1 , w1 ) 6δ (J2 , w2 ) and (J2 , w2 ) 6δ (J1 , w1 ),
we have that J1 = J2 and l(w1 ) = l(w2 ). Since w1 > w2′ for some w2′ ∼J,δ w2
and l(w1 ) = l(w2 ) = l(w2′ ), w1 = w2′ ∈ W δ(J2 ) . Hence w1 = w2′ = w2 . Therefore
(J1 , w1 ) = (J2 , w2 ). Antisymmetry is proved.
   Let (J1 , w1 ), (J2 , w2 ) and (J3 , w3 ) ∈ Iδ . Assume that (J1 , w1 ) 6δ (J2 , w2 ) and
(J2 , w2 ) 6δ (J3 , w3 ). Then J1 ⊂ J2 ⊂ J3 . Moreover, there exists x ∈ W δ(J2 ) ,
u ∈ WJ3 and u1 ∈ WJ2 , such that x > w3 δ(u) and w2 = u−1             1 u
                                                                           −1
                                                                              xδ(u1 ). Since
                                                                 −1 −1
w1 >J2 ,δ w2 , there exists u2 ∈ WJ2 , such that w1 > u2 u xδ(u2 ). Note that
l(xδ(u2 )) = l(x) + l(u2 ) and x > w3 δ(u). Thus xδ(u2 ) > w3 δ(uu2 ). By 3.4, there
exists v 6 uu2 , such that w1 > v −1 w3 δ(uu2 ). By 3.7, w1 >J3 ,δ w3 . Transitivity is
proved. 

                        4. The closure of any G-stable piece
4.1. We have that

                                      δ(J)                               δ(J)
              G1 = ⊔w∈W B ẇU − ẇ0           g0 = ⊔w∈W B ẇẇ0                 UP − Uδ(J) g0 .
                                                                                    δ(J )



     Moreover, B ẇU − = ⊔b∈U − ∩ẇ−1 U − B ẇUP − b. Thus
                                J                        J



            B ẇUP − UJ = B ẇẇ0J U − ẇ0J = ⊔                    (ẇẇJ )−1 −   B ẇẇ0J UP − bẇ0J
                    J                              b∈UJ− ∩              0    U                J

                         = ⊔b∈UJ ∩   ẇ−1   U − B ẇU   PJ−   b.

     Note that if w = w′ u with w′ ∈ W J and u ∈ WJ , then
               −1         −1                ′ −1               −1                                 −1
        UJ ∩ ẇ U − = u̇ (u̇ UJ ∩ (ẇ ) U − ) = u̇ (u̇ UJ ∩ UJ− ) = UJ ∩ u̇ UJ− .
        THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                                  15

Lemma 4.2. Let (J, w) ∈ Iδ . For any u ∈ W and b ∈ B, there exists v 6 u, such
that u̇bẇ ∈ B v̇ ẇUP − Uδ(J) .
                      δ(J )


  Proof. We will prove the statement by induction on l(u).
  If u = 1, then the statement holds. If u = si u1 with l(u1 ) = l(u) − 1, then
by induction hypothesis, there exists v1 6 u1 , such that u̇1 bẇ ∈ b′ v̇1 ẇUP − Uδ(J)
                                                                                       δ(J )
for some b′ ∈ B. Write b′ = b1 b2 , where b1 ∈ UP{i} and b2 ∈ U{i} . Then
ṡi b′ v̇1 ẇ = (ṡi b1 ṡ−1                             −1
                          i )ṡi b2 v̇1 ẇ with ṡi b1 ṡi  ∈ B.
                 −1
     If (v̇1 ẇ) b2 v̇1 ẇ ∈ UP − Uδ(J) , then ṡi b2 v̇1 ẇ ∈ ṡi v̇1 ẇUP − Uδ(J) . Otherwise,
                                  δ(J )                                 δ(J )
                              −                                            −
b2 6= 1 and (v̇1 ẇ)−1 U{i}     v̇1 ẇ ⊂ UP − Uδ(J) . Note that ṡi b2 ∈ BU{i} . Thus
                                            δ(J )
ṡi b2 v̇1 ẇ ∈ B v̇1 ẇUP − Uδ(J) . The statement holds in both cases. 
                      δ(J )


4.3. Let z ∈ (G, 1) · hJ,δ . Then z can be written as z = (bẇu̇b′ , 1) · hJ,δ with b ∈ B,
                                            −1    −
w ∈ W δ(J) , u ∈ Wδ(J) and b′ ∈ Uδ(J) ∩ u̇ Uδ(J)     . Moreover, w, u, b′ are uniquely
determined by z.
   Set J0 = J. To z ∈ (G, 1) · hJ,δ , we associate a sequence (Ji , wi , vi , vi′ , ci , zi )i>1
                                                                                −1
                                                                                         −
with Ji ⊂ J, wi ∈ W δ(J) , vi ∈ WJi−1 ∩ Ji W , vi′ ∈ WJi , ci ∈ Uδ(Ji−1 ) ∩ δ̇(vi ) Uδ(J    i−1 )

and zi ∈ (B ẇi δ̇(vi′ )Uδ(J) δ̇(vi )ci , 1) · hJ,δ and in the same Gdiag -orbit as z. The
sequence is defined as follows.
   Assume that z ∈ (B ẇδ̇(u)Uδ(J) , 1) · hJ,δ with w ∈ W δ(J) and u ∈ Wδ(J) . Then
set z1 = z, J1 = J, w1 = w, v1 = 1, v1′ = u and c1 = 1.
   Assume that k > 1, that Jk , wk , vk , vk′ , ck , zk are already defined and that Jk ⊂
Jk−1 , wk ∈ W δ(J) , WJk−1 wk ⊂ W δ(J) Wδ(Jk ) , vk ∈ WJk−1 ∩ Jk W , vk′ ∈ WJk ,
                     −1
                          −
ck ∈ Uδ(Jk−1 ) ∩ δ̇(vk ) Uδ(Jk−1 )
                                    and zk ∈ (B ẇk δ̇(vk′ )Uδ(J) δ̇(vk )ck , 1)·hJ,δ . Set zk+1 =
(g0−1 δ̇(vk )ck g0 , g0−1 δ̇(vk )ck g0 )zk . Then zk+1 ∈ (G, 1) · hJ,δ . Moreover, by 4.2, there
exists xk 6 vk , such that zk+1 ∈ (B ẋk wk δ̇(vk′ )Uδ(J) , 1) · hJ,δ .
   Let yk+1 be the unique element of the minimal length in WJk xk wk δ(vk′ )Wδ(J) .
                                    −1
Set Jk+1 = Jk ∩ δ −1 Ad(yk+1             )Jk . Since WJk−1 wk ⊂ W δ(J) Wδ(Jk ) , then we have
that xk wk δ(vk′ ) = wk+1 δ(vk+1     ′                                       ′
                                          vk+1 ) for some wk+1 ∈ W δ(J) , vk+1    ∈ WJk+1 and
                      Jk+1                                     δ(J)
vk+1 ∈ WJk ∩                W . Note that WJk wk+1 ⊂ W              Wδ(J)∩Ad(y−1 )Jk . On the
                                                                                k+1

other hand, WJk wk+1 ⊂ WJk−1 wk Wδ(Jk ) ⊂ W δ(J) Wδ(Jk ) . Thus WJk wk+1 ⊂
(W δ(J) Wδ(J)∩Ad(y−1 )Jk ) ∩ (W δ(J) Wδ(Jk ) ) = W δ(J) Wδ(Jk+1 ) .
                     k+1
                                ′
   Moreover zk+1 ∈ (B ẇk+1 δ̇(vk+1 )Uδ(J) δ̇(vk+1 )ck+1 , 1) · hJ,δ for a unique ck+1 ∈
          −1
UJk ∩ δ̇(vk+1 ) UJ−k .
     This completes the inductive definition. Moreover, for sufficient large n, we
have that Jn = Jn+1 = · · · , wn = wn+1 = · · · , vn′ = vn+1
                                                         ′
                                                             = · · · and vn = vn+1 =
· · · = 1.
                              K
4.4. Let K ⊂ J, y ∈               W δ(K) and K = Ad(y)δ(K). Then for any u ∈ WK , we
16                                          XUHUA HE

have that

     (B ẏ δ̇(u)Uδ(K) , 1) · hJ,δ ⊂ Gdiag (ẏLδ(K) , B) · hJ,δ = Gdiag (ẏLδ(K) , UPK ) · hJ,δ .

  For any l ∈ LK , there exists l′ ∈ LK , such that l′ ẏg0 l(l′ )−1 ∈ ẏg0 (LK ∩ B).
Thus (LK )diag (ẏ(Lδ(K) ∩ B), UPK ) · hJ,δ = (ẏLδ(K) , UPK ) · hJ,δ . Hence

                                                                                     y
(B ẏ δ̇(u)Uδ(K) , 1)·hJ,δ ⊂ Gdiag (ẏ(Lδ(K) ∩B), UPK )·hJ,δ = Gdiag (ẏ, B)·hJ,δ = ZJ,δ .

   Now for any z ∈ (G, 1) · hJ,δ , let (zi , Ji , wi , vi , vi′ , ci )i>1 be the sequence associ-
ated to z. Assume that Jn = Jn+1 = · · · , wn = wn+1 = · · · , vn′ = vn+1          ′
                                                                                       = · · · and
                                                                        wn             wn
vn = vn+1 = · · · = 1. Then we have showed that zn ∈ ZJ,δ . Thus z ∈ ZJ,δ                 .
   Note that for any z ∈ ZJ,δ , z is in the same G-orbit as an element of the form
(G, 1) · hJ,δ . Therefore, given z ∈ ZJ,δ , our procedure determines the G-stable
         w
piece ZJ,δ  that contains z.

                                                 w
  Now we are able to describe the closure of ZJ,δ  . In 4.5, we will only consider
                  1                              1
subvarieties of Ḡ and for any subvariety X of Ḡ , we denote by X̄ the closure of
X in Ḡ1 .
Theorem 4.5. For any (J, w) ∈ Iδ , we have that
                                                                 ′
                                   w =⊔                  w
                                  ZJ,δ (K,w ′ )6δ (J,w) ZK,δ .



   Proof. Define π ′ : G × [I, 1, 1]δ −
                                      → Ḡ1 by π(g, z) = (g, g) · z. The morphism
is invariant under the B-action defined by b(g, z) = (gb−1 , π ′ (b, z)). Denote by
G ×B [I, 1, 1]δ the quotient, we obtain a morphism π : G ×B [I, 1, 1]δ −       → Ḡ1 .
Because G/B is projective, π is proper and hence surjective.
                                                                                 w
   Note that [J, w, 1]δ = ⊔K⊂J ⊔x∈W δ(K) ,u∈WJ , and x>wδ(u) [K, x, u]δ . Since ZJ,δ =
π(G ×B [J, w, 1]δ ), we have that

                w =⊔
               ZJ,δ K⊂J ∪x∈W δ(K) ,u∈WJ , and            x>wδ(u)
                                                                     Gdiag · [K, x, u]δ .

     For any z ∈ [K, x, u]δ with x ∈ W δ(K) , u ∈ WJ and x > wδ(u), we have that
z ∈ (B ẋ, B u̇) · hK,δ = Gdiag (u̇−1 B ẋ, 1) · hK,δ ⊂ ⊔v6u−1 Gdiag (B v̇ẋUδ(K) , 1) · hK,δ .
     Fix v 6 u−1 and z ′ ∈ (B v̇ẋUδ(K) , 1) · hK,δ . Let (zi , Ji , wi , vi , vi′ , ci )i>1 be the se-
quence associated to z ′ . Then for any i, there exists xi 6 vi , such that xi wi δ(vi′ ) =
          ′
wi+1 δ(vi+1  vi+1 ). Assume that Jn = Jn+1 = · · · , wn = wn+1 = · · · , vn′ = vn+1              ′
                                                                                                     =
                                                                                    ′
· · · and vn = vn+1 = · · · = 1. Set x∞ = xn xn−1 · · · x2 and v∞ = vn (vn vn−1 · · · v2 ).
Note that x1 = v1 = 1. Then x∞ vx = x∞ w1 δ(v1′ ) = wn δ(v∞ ). Since vn′ ∈ WJn+1
and vi ∈ WJi ∩Ji+1 W , we have that l(v∞ ) = l(vn′ )+l(vn )+l(vn−1 )+· · ·+l(v2 ). Thus
x∞ 6 v∞ . By 4.4, z ′ ∈ ZK,x∞ vxδ(v∞    −1 . Note that v
                                            )
                                                           −1
                                                                6 u and l(wu) = l(w) +l(u).
        THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                               17

Thus wδ(v −1 ) 6 wδ(u) 6 x. Similarly, wδ(v −1 x−1                    −1
                                                        ∞ ) 6 xδ(v∞ ). By 3.4, there
exist v ′ 6 v −1 x−1
                  ∞ , such that (v )
                                      ′ −1
                                           wδ(v −1 x−1                −1
                                                    ∞ ) 6 x∞ vxδ(v∞ ). Thus by 3.8,
            −1
x∞ vxδ(v∞ ) >J,δ w.
    For any K ⊂ J and w′ ∈ W δ(K) with w′ >J,δ w, there exists x ∈ W δ(K) , u ∈ WJ
and u1 ∈ WK , such that x > wδ(u) and w′ = u−1         1 u
                                                           −1
                                                              xδ(u1 ). Since [K, x, u]δ ⊂
[J, w, 1]δ . We have that (ẋT, u̇) · hK,δ ⊂ ZJ,δ . Therefore (u̇−1 ẋT, 1) · hK,δ ⊂ ZJ,δ
                                                w                                      w
                                                                                          .
               −1       ′      −1                ′     −1                  w
Note that u x = u1 w δ(u1 ) . Then (u̇1 ẇ δ̇(u1 ) T, 1) · hK,δ ⊂ ZJ,δ . Thus

             (u̇−1    −1        ′
                1 , u̇1 )(u̇1 ẇ δ̇(u1 )
                                         −1
                                            T, 1) · hK,δ = (ẇ′ T, 1) · hK,δ ⊂ ZJ,δ
                                                                                w
                                                                                    .

                 ′
             w      w . The theorem is proved.
   By 1.12, ZK,δ ⊂ ZJ,δ                                      

   Our method also works in another situation.
                                                                                        ′
                                 w                                       w
Proposition 4.6. The closure of ZJ,1,δ in ZJ,1,δ is ⊔w′ ∈W δ(J ),w>J w′ ZJ,1,δ .
    Proof. In the proof, we will only consider subvarieties of ZJ,1,δ and for any
subvariety X of ZJ,1,δ , we denote by X̄ its closure in ZJ,1,δ .
    Note that the morphism π : ZJ,1,δ −           → PJ defined by π(P, Q, γ) = P for
(P, Q, γ) ∈ ZJ,1,δ is a locally trivial fibration with isomorphic fibers. Moreover,
i : π −1 (PJ ) −  → G1 /HPJ defined by i(P, Q, γ) = γ for (P, Q, γ) ∈ π −1 (PJ ) is an
isomorphism. Now [J, w, 1]1,δ ⊂ π −1 (PJ ) and i([J, w, 1]1,δ ) = B ẇBg0 /HPJ . Thus
[J, w, 1]1,δ = ⊔w′ 6w [J, w′ , 1]1,δ . For any w′ ∈ W J with w >J,δ w′ , there exists u ∈
WJ , such that w > u−1 w′ δ(u). Thus (u̇−1 ẇ′ δ̇(u)T, 1) · hJ,1,δ ⊂ [J, w, 1]1,δ . Hence
                                                                               w′
Gdiag (u̇−1 ẇ′ δ̇(u)T, 1) · hJ,1,δ = Gdiag (ẇ′ T, 1) · hJ,1,δ ⊂ ZJ,1,δ
                                                                   w     . So ZJ,1,δ    w
                                                                                     ⊂ ZJ,1,δ .
                                                   ′
    On the other hand, for any z ∈ [J, w , 1]1,δ , by the similar argument as we
did in 4.3 and 4.4, there exists u 6 v ∈ WJ , such that uw′ δ(v −1 ) ∈ W δ(J) and
       uw ′ v −1
z ∈ ZJ,1,δ       . If moreover, w′ 6 w, then w > u−1 (uw′ δ(v −1 ))δ(v). Thus w >J,δ
                                                     w′
uw′ v −1 . Therefore z ∈ ⊔w′ ∈W δ(J ),w>J,δ w′ ZJ,1,δ    . The proposition is proved. 

                          5. The cellular decomposition
5.1. A finite partition of a variety X into subsets is said to be an α-partition if
the subsets in the partition can be indexed X1 , X2 , . . . , Xn in such a way that
X1 ∪ X2 ∪ · · · ∪ Xi is closed in X for i = 1, 2, . . . , n. We say that a variety
has a cellular decomposition if it admits an α-partition into subvarieties which
are affine spaces. It is easy to see that if a variety X admits an α-partition into
subvarieties and each subvariety has a cellular decomposition, then X has a cellular
decomposition.
Lemma 5.2. Let (J, w) ∈ Iδ , K ⊂ J and w′ ∈ W with Ad(w′ )δ(K) = K. If
w′ v >J,δ w for some v ∈ Wδ(K) , then w′ >J,δ w.
   Proof. Fix w′ and (J, w). It suffices to prove the following statement:
18                                            XUHUA HE

   Let u ∈ WJ and v ∈ Wδ(K) . If w′ v > u−1 wδ(u), then w′ >J,δ w.
   We argue by induction on l(u). Assume that the statement holds for all u′ < u.
Then I will prove that the statement holds for u by induction on l(v). If l(v) = 0,
then v = 1 and the statement holds in this case. Now assume that l(v) > 0.
   Set u = u1 u2 with u1 ∈ W K and u2 ∈ WK . If u2 = 1, then u ∈ W K
and wδ(u) ∈ W δ(K) . By 3.4, there exists u′ 6 u, such that u′ w′ v > wδ(u).
Assume that v = v ′ sk for v ′ < v and k ∈ δ(K). Then wδ(u) < wδ(u)sk . By 3.1,
wδ(u) 6 u′ w′ v ′ . By 3.4, there exists u′1 6 u′ 6 u, such that w′ v ′ > (u′1 )−1 wδ(u).
By the remark of 3.8, w′ v ′ > (u′2 )−1 wδ(u′2 ) for some u′2 6 u′1 . Thus by induction
hypothesis, w′ >J,δ w.
   If u2 6= 1. Then l(u1 ) < l(u). By 3.4, there exists u3 6 u2 and u4 6 u−1    2 , such
           ′            −1                            ′         ′     ′ −1   ′
that u3 w vδ(u4 ) > u1 wδ(u1 ). Note that u3 w vu4 = w ((w ) u3 w )vδ(u4 ) ∈
w′ Wδ(K) . By induction hypothesis on l(u1 ), w′ >J,δ w. 
5.3. Let J ⊂ I. For w ∈ W , set

                       I1 (J, w, δ) = max{K ⊂ J | w ∈ W δ(K) },
                       I2 (J, w, δ) = max{K ⊂ J | Ad(w)Φδ(K) = ΦK }.

     Now let (J, w) ∈ Iδ . Set

               Wδ (J, w) = {u ∈ W | u >J,δ w, I2 (J, u, δ) ⊂ I1 (J, u, δ)}.

     For any u ∈ Wδ (J, w), set

                     Xu(J,w,δ) = ⊔K⊂I1 (J,u,δ) ⊔v∈Wδ(I                        uv
                                                                     ∩W δ(K) ZK,δ
                                                              2 (J,u,δ))
                                                                        uv
                                = ⊔v∈Wδ(I2 (J,u,δ))     ⊔K⊂I1 (J,uv,δ) ZK,δ .

                                                                                         ′
    For w′ >J,δ w, we have that w′ = uv for some u ∈ W δ(I2 (J,w )) and v ∈
Wδ(I2 (J,w′ )) . Then I2 (J, u, δ) = I2 (J, w′ , δ) ⊂ I1 (J, u, δ). By 5.2, u >J,δ w. Thus
                                        w′        (J,w,δ)
u ∈ Wδ (J, w) and ⊔K⊂I1 (J,w′ ,δ) ZK,δ      ⊂ Xu          .
    For u1 , u2 ∈ W (J, w) and v1 ∈ Wδ(I2 (J,u1 )) , v2 ∈ Wδ(I2 (J,u2 )) with u1 v1 = u2 v2 ,
we have that I2 (J, u1 , δ) = I2 (J, u1 v1 , δ) = I2 (J, u2 v2 , δ) = I2 (J, u2 , δ). Note that
u1 , u2 ∈ W δ(I2 (J,u1 )) . Thus u1 = u2 and v1 = v2 .
                  w =⊔                  (J,w,δ)
    Therefore ZJ,δ          u∈Wδ (J,w) Xu       .
Lemma 5.4. Let (J, w) ∈ Iδ . Set I2 = I2 (J, w, δ). For K ⊂ J, we have that

        ⊔v∈Wδ(I      ∩W δ(K) (LI2 )diag (ẇ v̇, B   ∩ LI2 ) · hK,δ = (LI2 , LI2 )(ẇ, 1) · hK,δ .
                2)




   Proof. At first, we will prove the case when K ⊂ I2 . In this case, set
g1 = g0 ẇ. Then g1 Lδ(I2 ) g1−1 = Lδ(I2 ) and g1 (Lδ(I2 ) ∩ B)g1−1 = Lδ(I2 ) ∩ B. Now
       THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                                                   19

consider Lδ(I2 ) /Z(Lδ(I2 ) )g1 (a variety that is isomorphic to Lδ(I2 ) /Z(Lδ(I2 ) ), but
with “twisted” Lδ(I2 ) × Lδ(I2 ) action, see 2.3). We have that

⊔v∈Wδ(I      ∩W δ(K) (Lδ(I2 ) )diag (v̇, B         ∩ Lδ(I2 ) ) · (hδ(K) g1 ) = (Lδ(I2 ) , Lδ(I2 ) ) · (hδ(K) g1 ).
        2)



   (In the case when g1n ∈ Lδ(I2 ) for some n ∈ N, Lδ(I2 ) g1 is a connected component
of the group generated by Lδ(I2 ) and g1 . In this case, the left hand side is the union
of some Lδ(I2 ) -stable pieces and the equality follows from [L4, 12,3]. The general
case can be shown in the same way.)
   Therefore

          ⊔v∈Wδ(I         ∩W δ(K)    (ẇ−1 , g0 )(LI2 )diag (ẇ, g0−1 )(v̇, B ∩ Lδ(I2 ) ) · hδ(K)
                     2)
                                                                   −1
          = ⊔v∈Wδ(I            ∩W δ(K) (1, g1 )(Lδ(I2 ) )diag (1, g1 )(v̇, B       ∩ Lδ(I2 ) ) · hδ(K)
                          2)

          = (Lδ(I2 ) , Lδ(I2 ) )(ẇ, 1) · hδ(K) .

   Note that hK,δ = hδ(K) g0 . Then ⊔v∈Wδ(I ) ∩W δ(K) (ẇ−1 , 1)(LI2 )diag (ẇv̇, B∩LI2 )·
                                                  2
hK,δ = (Lδ(I2 ) , LI2 ) · hK,δ . Hence ⊔v∈Wδ(I ) ∩W δ(K) (LI2 )diag (ẇv̇, B ∩ LI2 ) · hK,δ =
                                                2
(LI2 , LI2 ) · hK,δ .
   In the general case, Consider π : (Lδ(I2 ) , LI2 ) · hK,δ −   → Lδ(I2 ) /Z(Lδ(I2 ) )g0 de-
fined by π (l1 , l2 )hK,δ = (l1 , l2 ) · (hδ(K)∩δ(I2 ) g0 ) for l1 ∈ Lδ(I2 ) , l2 ∈ LI2 . Here
hδ(K)∩δ(I2 ) on the right side is the base point in Lδ(I2 ) /Z(Lδ(I2 ) ) that corresponds
to δ(K) ∩ δ(I2 ). It is easy to see that the morphism is well-defined.              Now de-
fine the T -action on (Lδ(I2 ) , LI2 ) · hK,δ by t · (l1 , l2 )hK,δ = (tl1 , l2 )hK,δ for
t ∈ T and l1 ∈ Lδ(I2 ) , l2 ∈ LI2 . Then T acts transitively on π −1 (a) for any
a ∈ (Lδ(I2 ) , LI2 ) · (hδ(K)∩δ(I2 ) g0 ). Now

                                    π (ẇ−1 , 1)(LI2 )diag · (ẇv̇, B ∩ LI2 ) · hK,δ
                                                                                             
          ⊔v∈Wδ(I       ∩W δ(K)
                     2)
                                             −1
          = ⊔v∈Wδ(I            ∩W δ(K) (ẇ        , 1)(LI2 )diag (ẇv̇, B ∩ LI2 ) · (hδ(K)∩δ(I2 ) g0 )
                          2)

          = (Lδ(I2 ) , LI2 ) · (hδ(K)∩δ(I2 ) g0 ).

Moreover ⊔v∈Wδ(I ) ∩W δ(K) (ẇ−1 , 1)(LI2 )diag · (ẇv̇, B ∩ LI2 ) · hK,δ is stable under T -
                2
action. Thus ⊔v∈Wδ(I ) ∩W δ(K) (ẇ−1 , 1)(LI2 )diag ·(ẇv̇, B ∩LI2 )·hK,δ = (Lδ(I2 ) , LI2 )·
                    2
hK,δ . The lemma is proved. 
Proposition 5.5. Let (J, w) ∈ Iδ and u ∈ Wδ (J, w). Set I1 = I1 (J, u, δ), I2 =
                     (J,w,δ)
I2 (J, u, δ) and Lu          = ⊔K⊂I1 (LI2 , LI2 )(u̇, 1) · hK,δ . Then we have that
          (J,w,δ)
    (1) Lu         is a fibre bundle over LI2 /Z(LI2 ) with fibres isomorphic to an affine
space of dimension |I1 | − |I2 |.
           (J,w,δ)               (J,w,δ)                                            (J,w,δ) 
    (2) Xu          = Gdiag · Lu         is isomorphic to G ×PI2 (PI2 )diag · Lu             .
                        (J,w,δ)                (J,w,δ) ∼          I2             (J,w,δ)
    (3) (PI )diag · Lu
             2
                                = (B × B) · Lu         = (U ∩ ẇ0 u̇ẇ0 U − ) × Lu       .
20                                           XUHUA HE

                                                 (J,u,δ)
   Proof. For part (1), note that Lu              = ⊔K⊂I1 (u̇, 1)(Lδ(I2 ) , LI2 ) · hK,δ =
                                     
(u̇Lδ(I2 ) , LI2 ) · ⊔K⊂I1 (T, 1)hK,δ is a variety. Consider the morphism

                  π ′ : ⊔K⊂I1 (Lδ(I2 ) , LI2 ) · hK,δ −
                                                      → Lδ(I2 ) /Z(Lδ(I2 ) )g0

defined by π ′ (l1 , l2 )hK,δ = (l1 , l2 ) · (hδ(K)∩δ(I2 ) g0 ) for l1 ∈ Lδ(I2 ) , l2 ∈ LI2 . It
                             

is easy to see that π ′ is well defined and is a locally trivial fibration with fibers
isomorphic to an affine space of dimension |I1 | − |I2 |.
    Let v ∈ Wδ(I2 ) . For K ⊂ J, if Ad(uv)δ(K) = K, then Ad(u)Φδ(K) =
Ad(uv −1 u−1 )ΦK . Since uv −1 u−1 ∈ WI2 , we have that Ad(u)Φδ(K) ⊂ ΦK∪I2 .
Thus Ad(u)Φδ(K∪I2 ) ⊂ ΦK∪I2 . By the maximal property of I2 , K ∪ I2 ⊂ I2 . Thus
I2 (J, uv, δ) ⊂ I2 . Therefore,


Gdiag · L(J,w,δ)
                                                                    
         u       = Gdiag ⊔K⊂I1 (LI2 , LI2 )(u̇, 1) · hK,δ
                                                                                                             
                  = Gdiag ⊔K⊂I1 ⊔v∈Wδ(I             ∩W   δ(K)   (LI2 )diag (u̇v̇, B ∩ LI2 (J,u,δ) ) · hK,δ
                                                 2)

                  = ⊔K⊂I1 ⊔v∈Wδ(I           ∩W δ(K)   Gdiag (u̇v̇, B ∩ LI2 ) · hK,δ
                                       2)
                                      uv
                  = ⊔K⊂I1 ⊔v∈Wδ(I2 ) ZJ,δ = Xu(J,w,δ) .
                                                                             (J,u,δ)
     Assume that (g, g)a = b for some g ∈ G and a, b ∈ Lu                    . Then a, b are in
                                                           (J,u,δ)
the same G orbit. Note that any element in Lu                       is conjugate by LI2 to an
element of the form (u̇v̇, l)hK,δ with v ∈ Wδ(I2 ) , K ⊂ I1 (J, uv, δ) and l ∈ LI2 ∩ B.
                                             uv
Moreover, (u̇v̇, LI2 ∩ B) · hK,δ ⊂ ZK,δ         . Thus if v1 6= v2 or K1 6= K2 , then for any
l, l ∈ LI2 ∩ B, (u̇v̇1 , l) · hK1 ,δ and (u̇v̇2 , l′ ) · hK2 ,δ are not in the same G orbit.
    ′

Thus (g, g)(u̇v̇, l1 ) · hK,δ = (u̇v̇, l2 ) · hK,δ for some v ∈ Wδ(I2 ) , K ⊂ I1 (J, uv, δ) and
l1 , l2 ∈ LI2 ∩ B. By 1.12, g ∈ PI2 (K,uv,δ). Since I2 (K, uv, δ) ⊂ I2 (J, uv, δ) ⊂ I2 ,
                                         (J,w,δ) ∼                          (J,w,δ) 
we have that g ∈ PI2 . By 1.9, Xu                 = G ×PI2 (PI2 )diag · Lu            . Part (2) is
proved.
                                                                   (J,w,δ)                 (J,w,δ)
     For part (3), it is easy to see that (PI2 (J,u,δ) )diag · Lu          ⊂ (B × B) · Lu          .
On the other hand,

 (B × B) · L(J,w,δ)
                                                                                                
              u        = (UPI2 , UPI2 )(LI2 )diag ⊔v∈Wδ(I2 ) ⊔K⊂I2 (J,uv,δ) (u̇v̇, B) · hK,δ
                                                                                                
                       = (LI2 )diag (UPI2 , UPI2 ) ⊔v∈Wδ(I2 ) ⊔K⊂I2 (J,uv,δ) (u̇v̇, B) · hK,δ .

  By 1.12, (UPI2 , UPI2 )(u̇v̇, B) · hK,δ = (B × B)(u̇v̇, 1) · hK,δ ⊂ (PI2 (K,uv,δ))diag ·
(LI2 (K,uv,δ), LI2 (K,uv,δ) )(u̇v̇, 1)hK,δ . We have showed that I2 (K, uv, δ) ⊂ I2 . Hence
                                                    (J,w,δ)                           (J,w,δ)
(UPI2 , UPI2 )(u̇v̇, B)·hK,δ ⊂ (PI2 (J,u,δ) )diag ·Lu       . Therefore, (PI2 )diag ·Lu       =
              (J,w,δ)
(B × B) · Lu       .
                                           I2               (J,w,δ)                   (J,w,δ)
   Consider the morphism π : (U ∩ ẇ0 u̇ẇ0 U − ) × Lu              −→ (B × B) · Lu
                                              I2                    (J,w,δ)
defined by π(b, l) = (b, 1) · l for b ∈ U ∩ ẇ0 u̇ẇ0 U − and l ∈ Lu        . By the similar
argument as we did in 1.10, we can show that π is an isomorphism. 
       THE G-STABLE PIECES OF THE WONDERFUL COMPACTIFICATION                           21

                                                                                   (J,w,δ)
Corollary 5.6. We keep the notation of 5.5. If moreover, I2 = ∅, then Xu
admits a cellular decomposition.
                               (J,w,δ)                              (J,w,δ)
   Proof. If I2 = ∅, then Lu         is an affine space. Thus Xu          is isomorphic
                                     (J,w,δ)
to G × BC, where C = (B × B) · Lu            . By part (3) of 5.5, C is an affine space.
                                                             (J,w,δ)
It is easy to see that B acts linearly on C. Therefore Xu            is a vector bundle
over B. Note that B admits a cellular decomposition. By a well-known result (see
                      (J,w,δ)
[Q], [Su] or [VS]), Xu        admits a cellular decomposition. 

5.7. For w1 , w2 ∈ Wδ (J, w), we say w2 6′ w1 if there exists w1 = x0 , x1 , · · · , xn =
w2 , vi ∈ δ(I2 (J, xi+1 , δ)) for all i, such that xi+1 vi >I1 (J,xi ,δ),δ xi .
              (J,w,δ)     (J,w,δ)
   By 4.5, Xu1        ∩ Xu2       = ∅ if u2 
′ u1 . hence if 6′ is a partial order on
                                       (J,w,δ)
                   w =⊔
Wδ (J, w), then ZJ,δ       u∈Wδ (J,w) Xu       is an α-partition. We will show that 6′
                        w
is a partial order if ZJ,δ contains finitely many G-orbits.

Lemma 5.8. Let J ⊂ I, u ∈ W , w ∈ W J and v ∈ WJ . Assume that uwv = w′ v ′
for some w′ ∈ W J and v ′ ∈ WJ . If l(uwv) = l(wv) − l(u), then w′ 6 w. If
moreover, w′ = w, then Ad(w−1 )supp(u) ⊂ J.

   Proof. If u = si for some i ∈ J and l(sj wv) = l(wv) − 1, then either si w < w
and si w ∈ W J or si w = wsj for some j ∈ J. It is easy to check that the statement
holds in both cases.
   The general case can be proved by induction on l(u). 

Lemma 5.9. If w1 , w2 ∈ Wδ (J, w) with w1 6′ w2 and w2 6′ w1 and I2 (J, w1 , δ) =
I2 (J, w2 , δ) = ∅, then w1 = w2 .

    Proof. We will prove the case: if w1 >I1 (J,w2 ,δ),δ w2 , w2 >I1 (J,w1 ,δ),δ w1 and
I2 (J, w1 , δ) = ∅, then w1 = w2 . The general case can be proved in the similar
way.
    We argue by induction on |J|. Since l(w1 ) > l(w2 ) and l(w2 ) > l(w1 ), we
have that l(w1 ) = l(w2 ). Thus w1 = u−1                             −1
                                            2 w2 δ(u2 ) and w2 = u1 w1 δ(u1 ) for some
u1 ∈ WI1 (J,w1 ,δ) and u2 ∈ WI1 (J,w2 ,δ) . By induction hypothesis, it suffices to prove
the case when J = supp(u1 ) ∪ supp(u2 ).
    We have that w1 = w1′ δ(v1 ) and w2 = w2′ δ(v2 ) for some w1′ , w2′ ∈ W δ(J)
and v1 , v2 ∈ WJ . Note that w1′ δ(v1 ) = u−1         ′                 −1 ′
                                                 2 w2 δ(v2 u2 ) and l(u2 w2 δ(v2 u2 )) =
l(w2′ δ(v2 u2 )) − l(u2 ). By 5.8, w1′ 6 w2′ . Similarly w2′ 6 w1′ . Therefore w1′ = w2′ .
By 5.8, Ad(w2′ )−1 supp(u2 ) ⊂ δ(J) and Ad(w1′ )−1 supp(u1 ) ⊂ δ(J). Therefore
Ad(w1′ )−1 J ⊂ δ(J). Hence Ad(w1 )−1 ΦJ = Φδ(J) . Since I2 (J, w1 , δ) = ∅, we have
that J = ∅. Therefore w1 > w2 and w2 > w1 . Thus w1 = w2 . The case is
proved. 

   As a summary, we have the following result.
22                                      XUHUA HE

                  w contains only finitely many G-orbits, then it has a cellular
Theorem 5.10. If ZJ,δ
decomposition.
               w contains only finitely many G-orbits, then I (J, u, δ) = ∅ for
  Proof. If ZJ,δ                                              2
u >J,δ w. In this case, Wδ (J, w) = {u ∈ W | u >J,δ w}. We have that

                                w
                               ZJ,δ = ⊔u∈Wδ (J,δ) Xu(J,w,δ).

                                                                 w has a cellular
  By 5.7 and 5.9, the partition is an α-partition. Thus by 5.6, ZJ,δ
decomposition. 

                                 Acknowledgements.
   We thank George Lusztig for suggesting the problem and for many helpful
discussions. We thank T. A. Springer and David Vogan for some useful comments.
We also thank Jiang-hua Lu for point out a mistake in the previous version and
suggested the reference [SL].

                                      References
[DP] C. De Concini and C.Procesi, Complete symmetric varieties, Invariant theory (Montecatini
     1982), Lect. Notes Math., vol. 996, Springer, 1983, pp. 1-44.
[H] X. He, Unipotent variety in the group compactification, Adv. in Math., in press.
[L1] G. Lusztig, Total positivity in reductive groups, Lie Theory and Geometry: in honor of
     Bertram Kostant, Progress in Math. 123 (1994), Birkhäuser, Boston, 531-568.
[L2] G. Lusztig, Hecke algebras with unequal parameters, CRM Monograph Series, 18, American
     Mathematical Society, Providence, RI, 2003.
[L3] G. Lusztig, Parabolic character sheaves I, Moscow Math.J 4 (2004), 153-179.
[L4] G. Lusztig, Parabolic character sheaves II, Moscow Math.J 4 (2004), 869-896.
[Q] D. Quillen, Projective modules over polynomial rings, Invent. Math. 36 (1976), 167-171.
[S] T. A. Springer, Intersection cohomology of B × B-orbits closures in group compactifica-
     tions,, J. Alg. 258 (2002), 71-111.
[SL] P. Slodowy, Simple singularities and simple algebraic groups, Lecture Notes in Mathemat-
     ics, 815, Springer, Berlin, 1980.
[Su] A. A. Suslin, Projective modules over polynomial rings are free (Russian), Dokl. Akad.
     Nauk SSSR 229 (1976), no. 5, 1063-1066.
[VS] L. N. Vaserstein and A. A. Suslin, Serre’s problem on projective modules over polynomial
     rings, and algebraic K-theory (Russian), Izv. Akad. Nauk SSSR Ser. Mat. 40 (1976), no.
     5, 993–1054, 1199.

     Department of Mathematics, M.I.T., Cambridge, MA 02139
     E-mail address: xuhua@mit.edu, hugo@math.mit.edu
