arXiv:math/0504543v1 [math.RT] 26 Apr 2005




                                                      Noncommutative Deformations of Type A Kleinian
                                                            Singularities and Hilbert Schemes.
                                                                                   Ian M. Musson∗
                                                                       Department of Mathematical Sciences
                                                                      University of Wisconsin-Milwaukee, USA
                                                                             E-mail: musson@uwm.edu

                                                                                   November 14, 2017



                                                                                         Abstract
                                                          Let Hk be a symplectic reflection algebra corresponding to a cyclic subgroup
                                                       Γ ⊆ SL2 C of order n and Uk = eHk e the spherical subalgebra of Hk . We show
                                                       that for suitable k there is a filtered Zn−1 -algebra R such that
                                                        (1) there is an equivalence of categories R − qgr ≃ Uk -mod ,
                                                        (2) there is an equivalence of categories grR − qgr ≃ Coh(HilbΓC2 ).
                                                       Here Coh(HilbΓ C2 ) is the category of coherent sheaves on the Γ-Hilbert scheme.
                                                       and for a graded algebra R, we write R−qgr for the quotient category of finitely
                                                       generated graded R-modules modulo torsion.



                                             1        Introduction
                                             This paper is motivated by a construction of Iain Gordon and Toby Stafford concern-
                                             ing the representation theory of a symplectic reflection algebra Hc and the spherical
                                             subalgebra Uc of Hc . This construction addresses issues raised in Conjecture 1.6 in
                                             [GK]. We refer to [EG] for the definition of symplectic reflection algebra and to [GS1]
                                             for background and the analogy for with the Beilinson-Bernstein theorem.
                                                 Suppose that G is a finite subgroup of SL2 C, and let Γ = G ≀ Sm , the wreath
                                             product of G by the symmetric group Sm . The group Γ acts on V = (C2 )m preserv-
                                             ing the natural sympletic structure. Let YΓ,m be the set of Γ-invariant ideals I in the
                                             Hilbert scheme of m|G| points in C2 such that the quotient C[x, y]/I is isomorphic
                                             to a direct sum of m copies of the regular representation of G. By [W, Theorem 4.2]
                                             there is a crepant resolution
                                                                                 YΓ,m −→ V /Γ.
                                             This gives the bottom arrow in the diagram below. The algebra Uc has a filtration
                                             such that the associated graded algebra is isomorphic to O(V /Γ)−mod. The passage
                                                 ∗
                                                     partially supported by NSF grant DMS-0099923.


                                                                                              1
to associated graded modules is indicated by the vertical arrow on the left. Gordon
and Stafford suggest that there is a suitable category that will complete the diagram.
                                              ≃
                             Uc −mod                   ✲    ???
                              gr                           gr
                                   ❄                            ❄
                           O(V /Γ)−mod            ✲   OYΓ,m −mod


The main theorem in [GS1] shows that this is possible in the crucial special case
where G = 1, and so Γ = Sm . Applications of this result are given in [GS2]. Another
special case arises when m = 1, and so G = Γ. Then V /Γ is a Kleinian singularity
and the algebras Hc were actually introduced earlier by Hodges [H] if Γ is cyclic,
and by Crawley-Boevey and Holland [CBH] in general. The purpose of this paper is
to solve the problem of Gordon and Stafford when Γ is cyclic of order n. Note that
when Γ is the symmetric group or a finite subgroup of SL2 C then YΓ,m is the same
as the Γ-Hilbert scheme HilbΓ C2 .
    To state the main theorem requires some notation. There is an action of Γ on
the first Weyl algebra C[∂, y] and on the localization C[∂, y ±1 ]. For k ∈ Cn−1 , we
construct Uk and Hk as subalgebras of the crossed product C[∂, y ±1 ]∗Γ. Our param-
eterization of these algebras is different from what is usually used, hence the change
in notation. Then for suitable k′ , k ∈ Cn−1 , we find Uk′ −Uk -bimodules B(k′ , k) and
give a sufficient condition for these bimodules to induce a Morita equivalence. Next
following [GS1], we assemble the bimodules B(k′ , k) to form a Morita Zn−1 -algebra
R. This is an algebra, without identity which is graded by Zn−1 × Zn−1 . Since the
algebras Uk and the bimodules B(k′ , k) are contained in C[∂, y ±1 ] ∗ Γ, they have
a filtration given by the order of the differential operators. The algebra R inherits
this filtration and we write grR for the associated graded algebra. The associated
graded algebra of Uk is isomorphic to O(V /Γ). We write Coh(HilbΓ C2 ) for the cat-
egory of coherent sheaves on HilbΓ C2 . For a graded algebra R, we write R − qgr for
the quotient category of finitely generated graded R-modules modulo torsion. This
notation is explained more fully at the start of Section 3. We can now state our
main result. The definition of dominance is immediately given before Theorem 5.3.

Main Theorem. If k is dominant then
(1) there is an equivalence of categories R − qgr ≃ Uk -mod ,
(2) there is an equivalence of categories grR − qgr ≃ Coh(HilbΓ C2 ).

    A brief outline of the proof is as follows. In the next section we recall the
construction of Coh(HilbΓ C2 ) as a toric variety from [IN]. We also show that there is
a Nn−1 -graded ring S such that the category S−qgr is equivalent to Coh(HilbΓ C2 ).
We construct a Zn−1 -algebra Sb such that the categories S−qgr b       and S−qgr are
equivalent. The algebra grR is also N    n−1 -graded and it is not hard to show that
Sb ⊆ grR. The proof of (2) is completed using a Poincaré series argument as in
[GS1, Section 6] to show that Sb = grR. The proof of (1) uses a generalization of


                                          2
the Z-algebra machinery developed in [GS1, Section 5].
    I would like to thank Iain Gordon for suggesting the problem considered in this
paper, and for outlining the approach which led to a solution. The material in Sec-
tion 3 and the proof of Lemma 4.2 are due to him. I also thank Mitya Boyarchenko
of the University of Chicago for some helpful correspondence. Mitya has informed
me that he is close to a solution of this problem for general Kleinian singularities.



2    Toric Varieties
Let Γ be a finite subgroup of SL2 C. The Γ-Hilbert scheme HilbΓ C2 is the scheme
which parameterizes Γ-invariant ideals I of C[u, v] such that C[u, v]/I is isomorphic
to the regular representation of Γ. The Hilbert-Chow morphism

                                   HilbΓ C2 −→ C2 /Γ

gives a minimal (equivalently crepant) resolution of the quotient singularity, [W].
For Γ cyclic of order n we construct this morphism using toric varieties.
    Let N = Z2 , M = Hom(N, Z), and write < , >: M × N −→ Z. for the natural
bilinear pairing. Set vi = (1, i) for 0 ≤ i ≤ n. Then let ∆ be the fan in NR = N ⊗Z R
with one dimensional cones R+ vi and 2 dimensional cones σi = R+ vi−1 + R+ vi for
1 ≤ i ≤ n. The cone σi∨ in MR dual to σi is σi∨ = R+ (i, −1) + R+ (1 − i, 1) and we
set
                           Ai = C[M ∪ σi∨ ], Xi = SpecAi .
Let X = X(∆) = ∪ni=1 Xi be the toric variety determined  by ∆ and let T = TN
                                                i     −1
be the dense torus acting on X. Since det                  = 1, it follows from [F,
                                              1−i 1
Proposition, page 29] that X is nonsingular. We write elements of Ai multiplicatively
by setting
                               x = (1, 0), z = (0, 1).
Then Ai = C[xi z −1 , x1−i z] and the maximal ideal mi of Ai corresponding to the T
fixed point pi ∈ Xi is
                                  mi = (xi z −1 , x1−i z).                     (2.1)
In order to relate X to the singularity it is convenient to introduce new indetermi-
nates u, v satisfying
                                 v n = z, uv = x,
so that un = xn z −1 . Then

                              Ai = C[ui v i−n , v n+1−i u1−i ].

Note that the fan ∆ is obtained by subdividing the fan ∆′ with the single 2-
dimensional cone σ = R+ (1, 0) + R+ (1, n). Also σ ∨ = R+ (0, 1) + R+ (n, −1), so
the toric variety X ′ corresponding to ∆′ is Spec C Γ where C = C[u, v]. It follows
easily that the map X −→ X ′ is the minimal resolution of the singularity.

                                             3
   For 1 ≤ i ≤ n, let Ui be the set of Γ-invariant ideals of C[u, v] such that the
elements
                          1, u, . . . , ui−1 , v, v 2 , . . . , v n−i
form a basis for the factor algebra C[u, v]/I. If I is a Γ-invariant ideal of C[u, v]
such that the factor algebra is isomorphic to CΓ, then un , uv, v n ∈ I, and it follows
that I ∈ Ui for some i. Furthermore if I ∈ Ui then for a unique (a, b) ∈ C2 we have

                         ui ≡ av n−i , v n−i+1 ≡ bui−1           mod I.

This identifies Ui with C2 and O(Ui ) with C[ui v i−n , v n+1−i u1−i ] = Ai . The open
sets Ui are glued together in the same way as the Xi and it follows easily that the
resolution X −→ X ′ constructed above is the Hilbert-Chow morphism, [IN]. This
map is equivariant for the action of a dense torus T = C× × C× . Let X(T ) =
Zχ1 ⊕ Zχ2 be the character group of T. If T acts rationallyL         on a vector space V
we define the weight space decomposition of V to be V =               χ∈X(T ) V (χ), where
V (χ) = {v ∈ V |τ · v = χ(τ )v for all τ ∈ T }. If dimV (χ) < ∞ for all χ ∈ X(T ) we
define the Poincaré series HV (q, t) of V by
                                     X
                        HV (q, t) =      dim V (rχ1 + sχ2 ) q r ts .
                                      r,s

We assume that T acts on C so that u ∈ C(χ1 ) and v ∈ C(χ2 ). We have

                            x ∈ C(χ1 + χ2 );          z ∈ C(nχ2 ).                  (2.2)
Let Di be the divisor on X corresponding to vi . By [F, 3.4] there is an exact sequence.
                                 α                     β
                      0 −→ M −→ ⊕ni=0 ZDi −→ P ic(X) −→ 0.
                P
where α(m) = ni=0 < m, vi > Di and β sends a divisor D to its class [D] in P ic(X).
It follows that P ic(X) is generated by the Di which are subject to the relations
                                n
                                X             n
                                              X
                                      Di =            iDi = 0.                      (2.3)
                                i=0           i=0

                             n−1
This implies that P ic(X) = ⊕i=1 ZD(i), where for 1 ≤ i ≤ n − 1, we define
                                            i−1
                                            X
                                D(i) =            (i − j)Dn−j .                     (2.4)
                                            j=0

For b ∈ Zn−1 set
                                              n−1
                                              X
                                  D(b) =              bi D(i).                      (2.5)
                                              i=1

The polynomial ring C[x0 , . . . , xn ] is graded by P ic(X) where we define

                               deg(xi ) = [Di ] ∈ P ic(X).

                                                  4
We recall Proposition 1.1 in [Cox]. Let

                   Sb = span{s ∈ C[x0 , . . . , xn ]|deg(s) = [D(b)]}.

Then there is an isomorphism Sb ∼
                                = H 0 (X, O(D(b)))

                             φb : Sb −→ H 0 (X, O(D(b)))

and a commutative diagram

                   Sb ⊗ Sc                                       ✲ Sb+c



                       ❄                                                 ❄
    H 0 (X, O(D(b))) ⊗ H 0 (X, O(D(c)))              ✲     H 0 (X, O(D(b + c)))


where the horizontal arrows are multiplication and the vertical arrows are φb ⊗ φc
and φb+c .

Lemma 2.1. If b ∈ Nn−1 , and D = D(b), then
(1) O(D(b)) is generated by its global sections
(2) H i (X, O(D)) = 0 for i > 0.


Proof. (1) Let ψD be the piecewise linear function associated to D = D(b) in [F,
Section 3.4]. It is easy to see that if b ∈ Nn−1 , then ψD is convex. The result follows
from [F, Proposition, page 68].
(2) This follows from (1) and [F, Corollary, page 74].


Corollary 2.2. For b, c ∈ Nn−1 we have

             H 0 (X, O(D(b)))H 0 (X, O(D(c))) = H 0 (X, O(D(b + c))).

Proof. This follows by part (1) of the Lemma and the first exercise on page 69 of [F].

   Our goal is to compute a graded Poincaré series for H 0 (X, O(D)). To do this we
need the Atiyah-Bott-Lefschetz theorem, which we state next.

Theorem 2.3. Let T = C× × C× be a 2 dimensional torus acting on a smooth
surface X such that the fixed point set X T is finite. Let A be a T -equivariant locally
free sheaf on X. Let mx be the maximal ideal of the local ring at x, Ax the stalk at
x, and A(x) = Ax /mx Ax . If x is a T -fixed point then T acts on A(x). Suppose that
τ acts on with eigenvalues vx (q, t) and wx (q, t) on the cotangent space mx /m2x at x.
Then we have
     X                             X
         (−1)i HH i (X,A) (q, t) =    HA(x) (q, t)/(1 − vx (q, t))(1 − wx (q, t)). (2.6)
     i≥0                        x∈X T


                                           5
Proof. See [AB] for the compact case. This form is a special case of [Ha, Theorem
3.1].

    The denominator in (2.6) is equal to detmx /m2x (1 − τ ). We apply Theorem 2.3
when A is the invertible sheaf corresponding to the divisor D = D(b) on X as in
(2.5).

Lemma 2.4. If b ∈ Nn−1 and D = D(b), then O(D)(Xi+1 ) is a free O(Xi+1 )-
module generated by xm1 z m2 where
                             n−1
                             X                                       n−1
                                                                     X
                     m1 =            (n − j)bj ,         m2 = −            bj .     (2.7)
                             j=n−i                                j=n−i
                        Pn
Proof. We have D =        i=0 ai Di ,   where
                                           n−1
                                           X
                              ak =                 (j + k − n)bj .                  (2.8)
                                        j=n+1−k

   As in [F, page 66] we set

              PD (σi+1 ) = {u ∈ MR | < u, vj > ≥ −aj for j = i, i + 1}.

Then
                     H 0 (Xi+1 , O(D)) = ⊕u∈PD (σi+1 )∩M Cxu1 z u2 .
Note that if u = (u1 , u2 ) ∈ MR , then u ∈ PD (σi+1 ) if and only if

                                        u1 + iu2 ≥ −ai

and
                                u1 + (i + 1)u2 ≥ −ai+1 .
It follows that O(D)(Xi+1 ) is freely generated over O(Xi+1 ) by xm1 z m2 where
m1 + im2 = −ai and m1 + (i + 1)m2 = −ai+1 , that is

                   m1 = iai+1 − (i + 1)ai              and   m2 = ai − ai+1 .       (2.9)
Now the result follows easily from (2.8).


Theorem 2.5. If b ∈ Nn−1 and N (b) = H 0 (X, O(D(b))), then
                                             P n−1               P n−1
                                     n−1
                                     X      q j=n−i (n−j)bj t− j=n−i jbj
                   HN (b) (q, t) =                                             .   (2.10)
                                           (1 − ti+1−n q i+1 )(1 − tn−i q −i )
                                     i=0




                                                   6
Proof. By Lemma 2.1, the higher cohomology of O(D) vanishes, so the left side of
(2.6) equals HN (b) (q, t). On the other hand from (2.2) and Lemma 2.4 we have
                                                        P n−1                 P n−1
                   HA(pi+1 ) = q m1 tm1 +nm2 = q         j=n−i (n−j)bj   t−    j=n−i   jbj
                                                                                             ,    (2.11)

and by (2.1) that the determinant of (1 − τ ) on the cotangent space at pi+1 is

                                  (1 − ti+1−n q i+1 )(1 − tn−i q −i ).

Therefore the result follows from Theorem 2.3.



3     Multi-homogeneous coordinate rings
            L                  m
Let R =       i∈Nm R(i) be a N -graded algebra. We introduce several abelian cat-
egories that we will need. First we write R-Grmod for the category of Zm -graded
R–modules with degree zero homomorphisms, and R-grmod for the full subcategory
of R-Grmod consisting finitely generated graded R–modules.
    If i, j ∈ Zm we write i ≥ j if i − j ∈ Nm . We say that a property (P) holds
for large enough b ∈ Zm if there exists j ∈ ZmL    such that (P) holds for all b ≥ j.
A finitely generated graded R–module M =            i∈Zm M (i) is bounded if M (i) =
0 for large enough i, and a graded R–module is torsion if it is the direct limit
of a system of bounded modules. We denote the Serre subcategories of R-grmod
and R-Grmod consisting of bounded and torsion modules by R-tors and R-Tors
respectively. Finally, we define the quotient categories

               R−Qgr = R-Grmod/R-Tors         R−qgr = R-grmod/R-tors.
                                                                  L
    Let Sb = H 0 (X, O(D(b))) as in Section 2 and set S = b∈Nn−1 Sb . We show
that there is an equivalence of categories between S−qgr and Coh(X), the category
of coherent sheaves on X. To do this adapt the proof of an equivalence of categories
for twisted homogeneous coordinate rings, and for twisted multi-homogeneous coor-
dinate rings obtained in [AV, Theorem 1.3] and [Chan, Theorem 3.4] respectively.
The proof works in greater generality.
    Let X be a variety, projective over Spec S with S a a noetherian k-algebra .
Assume we have a system of invertible sheaves (L1 , . . . , Lm ) on X with the following
properties:
    1. There exists N ≫ 0 such that for all n ≥ N we have H p (X, Lni ) = 0 for
       each i and for all positive integers p. (Note that by Grothendieck’s vanishing
       theorem we need only consider p ≤ dim X, so for each 1 ≤ i ≤ m and for each
       1 ≤ p ≤ dim X we can look for a positive integer N (i, p) with the cohomology
       vanishing property above, and then set N to be the maximum value amongst
       the N (i, p).)
    2. For a coherent sheaf F on X there exists a sequence of integers (c1 , . . . , cm ) such
       that for all (b1 , . . . , bm ) ≥ (c1 , . . . , cm ), we have H p (X, F ⊗ Lb11 · · · Lbmm ) = 0 for
       all positive integers p.

                                                    7
We call such a system an ample system. To ease notation we write

                                   L(b) = Lb11 · · · Lbmm                         (3.1)

for b = (b1 , . . . , bm ) ∈ Zm . Define the following graded algebras:
                                 M                  M
                           L=         L(b); A =         H 0 (X, L(b)).
                            b∈Zm                 b∈Nm

   Then L is a strongly Zm –graded OX –algebra with L(0) = OX . The algebra A is
an Nm –graded OX (X)–algebra. A graded L–module M has the form
                                      M
                                M=        M(i)
                                           i∈Zm

with each M(i) a quasi-coherent OX –sheaf, such that L(i)·M(j) ⊆ M(i+j). We have
then the categories L-Grmod of graded L–modules with degree zero homomorphisms,
and its subcategory L-grmod consisting of finitely generated L–modules.

Theorem 3.1. There is an equivalence of categories between Qcoh X and A−Qgr
which restricts to an equivalence between Coh X and A−qgr.

   The proof goes in two stages. First we have

Lemma 3.2. The correspondences

                                  M −→ L ⊗OX M
                                 N (0) ←− N

induce inverse equivalences of categories between Qcoh X and L-Grmod.


Proof. The proof is easily adapted from the corresponding result about strongly
graded rings, [D].

Lemma 3.3. Let F be a coherent sheaf on X. Then for large enough i, F ⊗ L(i) is
generated by global sections.

Proof. (Adapted from [Hart, Proposition III.5.3].) Let P ∈ X be a closed point
and IP its ideal sheaf. We have a short exact sequence

                        0 −→ IP F −→ F −→ F ⊗ k(P ) −→ 0.

Tensoring this by L(i) gives

             0 −→ IP F ⊗ L(i) −→ F ⊗ L(i) −→ F ⊗ L(i) ⊗ k(P ) −→ 0.

By hypothesis we can find j such that H 1 (X, IP F ⊗ L(i)) = 0 for all i ≥ j. Therefore
the mapping
                  H 0 (X, F ⊗ L(i)) −→ H 0 (X, F ⊗ L(i) ⊗ k(P ))

                                             8
is surjective for all i ≥ j. So, by Nakayama’s lemma, the stalk at P of F ⊗ L(i) is
generated by global sections. Hence, there exists an open neighbourhood U of P
such that F ⊗ L(i) is generated by global sections on all of U . However this open
set depends on the choice of i. So pick the U corresponding to j.
     If we refine the argument in the above paragraph to work with F = OX we
can see (using property (1) of our ample system) that we can find neighbourhoods
V1 , . . . , Vm of P and integers ℓ1 , . . . , ℓm such that for each i, Lni i is generated by
global sections on Vi for all ni ≥ ℓi .
     Therefore on U ∩ V1 ∩ . . . ∩ Vm the sheaf F ⊗ L(j) ⊗ L(n) is generated by its
global sections for any n ≥ l. Covering X with a finite number of open sets of the
above form proves the lemma.

   To complete the proof of Theorem 3.1 we consider the functors

                    F : A−mod −→ L−Grmod :         M −→ L ⊗A M
                                                            M
      G : L−Grmod −→ A−mod :            M −→ H 0 (X, M)≥0 =   H 0 (X, M(i)).
                                                                  i∈Nm

Lemma 3.4. The functors F and G induce an equivalence of categories between
L − Grmod and A−Qgr.

Proof. The proof in [AV] goes through verbatim using Lemma 3.3 in place of [AV,
3.2 (ii)].
Proof of Theorem 3.1. This now follows by combining Lemmas 3.2 and 3.4. In
particular the equivalences are given as follows:
                                                M
               Qcoh X −→ A−Qgr : F 7→             H 0 (X, F ⊗ L(i)),
                                                    i∈Nn

and
                    A−Qgr −→ Qcoh X          :   M −→ (L ⊗A M )(0).
    Now suppose that X is the minimal resolution the cyclic singularity of type An−1
as in Section 2. The map X −→ C2 /Γ is a projective morphism, since it is obtained
by successive blow-ups. For 1 ≤ i ≤ n − 1 set Li = O(D(i)). Then if we define L(b)
for b ∈ Zn−1 as in equation (3.1), we have L(b) = O(D(b)).

Lemma 3.5. The invertible sheaves O(D(i)) for 1 ≤ i ≤ n − 1 form an ample
system on X.

Proof. Property (1) in the definition of an ample system holds by Lemma 2.1. To
check property (2) suppose that F be a coherent sheaf on X. We show that for
large enough i we have H p (X, F ⊗ L(i)) = 0 for all positive p. By [Hart, Corollary
II. 5.18] the coherent sheaf F can be written as a quotient, E/G, of a finite direct
sum of twisted structure sheaves. Now by [F, Proposition 3.4], the group of T –
Cartier divisors maps onto the Picard group of X, and because X is smooth every
T –Cartier divisor is T –Weil. Hence every invertible sheaf (and in particular any
twisted structure sheaf) has the form L(k) for some k ∈ Zn−1 .

                                             9
    We have a short exact sequence

                  0 −→ G ⊗ L(i) −→ E ⊗ L(i) −→ F ⊗ L(i) −→ 0

which leads to a long exact sequence in cohomology. For large enough i we can force
the vanishing of H p (X, E ⊗ L(i)) for positive p so we can deduce that

                       H p (X, F ⊗ L(i)) ∼
                                         = H p+1 (X, G ⊗ L(i)).

Since G is coherent we have by induction that the cohomology group on the right
hand side vanishes, as required.


4    Zm -algebras.
We need a routine generalization of the notion of a Z-algebra introduced in [BP].
Let A be a free abelian group of rank m. Thus A ∼  = Zm , and we write A+ for the
                                      m
submonoid of A corresponding to N . We define a partial order on
                  +                    m
                                                                    L A by writing
i ≥ j if i − j ∈ A . A (triangular) Z -algebra is an algebra B =       B(i, j) where
each B(i, j) is an additive subgroup of B, and the sum is over all i, j ∈ A such
that i ≥ j. The multiplication in B resembles matrix multiplication, that is we have
B(i, j)B(p, q) = 0 if j 6= p, and

                                B(i, j)B(j, l) ⊆ B(i, l).                          (4.1)

whenever i ≥ j ≥ l.
    There are                 m -algebras that will be of interest to us. Suppose first
            L two kinds of Z m                              b =L          b
that R = b∈Nm Rb is an N -graded algebra and set R                  i≥j≥0 R(i, j) where
 b j) = Ri−j . The multiplication in R
R(i,                                    b is induced from that in R. We call R     b the
  m
Z -algebra arising from R.
    Let B be a Zm -algebra.
                       L        We consider the category B−Grmod of Nm -graded
left B-modules M =        j≥0 M (j) such that B(i, j)M (j) ⊆ M (j) for all i ≥ j and
B(i, j)M (k) = 0 if k 6= j. Morphisms in B−Grmod are graded homomorphisms of
degree zero. It is now clear how to define the categories B−grmod, B−Qgr and
B−qgr by analogy with the definitions we made for Nm -graded algebras.
    Returning to the algebras R and R, b let R−Grmod≥0 be the full subcategory of
                               m
R−Grmod consisting of all N -graded modules. We define the categories R−Qgr      b
      b
L R−qgr in the obvious way. For M an object in R−Grmod we set M≥0 =
and
   j≥0 M (j) and write π(M ) for the image of M in R − Qgr.

Lemma 4.1. (1) The identity map yields equivalences of categories
                        b
           R−Grmod≥0 −→ R−Grmod,                b − grmod.
                                 R − grmod≥0 −→ R

(2) The equivalences in (1) induce equivalences
                                b
                       R−Qgr −→ R−Qgr                   b
                                                Rqgr −→ R−qgr


                                           10
Proof. (1) is immediate. For (2) the only point to note is that π(M ) = π(M≥0 ),
since M/M≥0 is torsion.

    For the second class of Zm -algebras, let w1 , . . . , wm be linearly independent
elements of Cm , and set A = ⊕m             +      m
                                i=1 Zwi , A = ⊕i=1 Nwi . Suppose that Q is a C-
algebra and that for i, j ∈ Cm with i ≥ j we are given subrings Ri , Rj and Ri − Rj
sub-bimodules B(i, j) of Q such that B(i, i) = Ri and (4.1) holds.
    Fix k ∈ Cm and set
                               R(k) = ⊕i≥j≥k B(i, j).
If the bimodules B(i, j) in this sum induce a Morita equivalence between Ri and Rj ,
we say that R(k) is the Morita Zm -algebra associated to the data (Ri , B(i, j)). For
this to happen it is necessary that equality holds in (4.1).
Lemma 4.2. Suppose that R(k) is the Morita Zm -algebra associated to the data
Ri , B(i, j), with R = Rk Noetherian, then
(1) each finitely generated left R(k)-module is Noetherian,
(2) the association φ : M −→ ⊕i≥k B(i, k)⊗R M induces an equivalence of categories
between R−mod and R(k)−qgr.
Proof. Part (2) of the lemma follows the proof of [GS1, Lemma 5.5 (2)] verbatim,
so we have only to check part (1). As in the proof of the [GS1, Lemma 5.5] it is
enough to show that                  M
                                M=       B(i, b)
                                            i≥b
                            L
is noetherian. So let L =     i≥b L(i)   ⊆ M be a graded submodule. For i ≥ b set

                            X(i) = B(i, b)∗ ⊗ L(i) ⊆ Rb .
                               P              P
As Rb is noetherian we have i≥b X(i) = j≥i≥b X(i) for some j. Observe that
there are only finitely many values of i between b and j. Therefore, if k ≥ j we have
                         X                    X                           X
L(k) = B(k, b)X(k) ⊆          B(k, b)X(i) =        B(k, i)B(i, b)X(i) =        B(k, i)L(i).
                          j≥i≥b                     j≥i≥b                j≥i≥b

    Now fix 1 ≤ t ≤ m. For each a such that bt ≤ a < jt we have a Zm−1 –algebra
R(t,a) defined as                     M
                           R(t,a) =          B(i, j).
                                          i≥j,it =jt =a

   The   R(t,a) –module                  M
                                                B(i, b)
                                    i≥b,it =a

is finitely generated noetherian by induction on m. Therefore we can find a finite
set I(t, a) ⊆ {i : it = a} such that for all k with kt = a we have
                                         X
                               L(k) ⊆          B(k, i)L(i).
                                         i∈I(t,a)


                                              11
     S L is generated by the L(i) where i belongs to the finite set {i : b ≤ i ≤
    Thus
j} ∪ 1≤t≤m,bt ≤a<jt I(t, a). Since each L(i) is finitely generated as a Ri -module the
proof is finished.

    The Zm -algebras we require can be constructed from certain bimodules that we
call basic. These are the bimodules B(j + wp , j) for j ∈ Cm and 1 ≤ p ≤ m. The
basic bimodules are required to satisfy a suitable compatibility condition. Namely
for all j ∈ Cm and 1 ≤ p, q ≤ m we require
 B(j + wp + wq , j + wp )B(j + wp , j) = B(j + wp + wq , j + wq )B(j + wq , j). (4.2)
   Then we define B(j, k) for j ≥ k as follows. Choose r0 , . . . , rs ∈ A such that
r0 = k, rs = j and ri = ri−1 + wt(i) where t(i) ∈ {1, . . . m} for 1 ≤ i ≤ s. Then set
                      B(j, k) = B(rs , rs−1 ) . . . B(ri , ri−1 ) . . . B(r1 , r0 ).                           (4.3)
    By equation (4.2) this definition is independent of the choice of the ri , and it is
clear that (4.1) holds.



5    Morita Theory for Spherical Subalgebras.
Suppose that Γ = (γ) is cyclic of order n and that Γ acts on the first Weyl algebra
C[∂, y] so that in the crossed product we have
                                        yγ = ωγy,              γ∂ = ω∂γ
where ω = e2πi/n . We do some computations in Q = C[∂, y ±1 ] ∗ Γ. For 0 ≤ i ≤ n − 1
set
                                          n−1
                                          X
                               ei = (1/n)     (ω i γ)j
                                                           j=0

and note that yei = ei+1 y and ei ∂ = ∂ei+1 , where the indices are read mod n. Fix
k = (k1 , . . . , kn−1 ) ∈ Cn−1 , set k0 = 0, and then define kj for j ∈ Z by kj = ki where
j ≡ i mod n and 0 ≤ i ≤ n − 1. Then set e = e0 and
                                                                n−1
                                                                X
                                        dk = ∂ − y −1                  ki ei .
                                                                 i=1

Let Hk be the subalgebra of the crossed product generated by dk , y and Γ, and set
Uk = eHk e. We define
                                                           n−1
                                                           X
                                  θ = y∂ = ydk +                     ki ei ∈ Hk .
                                                               i=1

Note that Q = Hk [y −1 ] for all k. By induction we have
                      p
                      Y                n−1
                                       X                                   p−1
                                                                           Y                n−1
                                                                                            X
          dpk y p =         (θ + i −         ki+j ej ),        y p dpk =         (θ − i −         kj−i ej ).   (5.1)
                      i=1              j=0                                 i=0              j=0


                                                          12
Since the ei are orthogonal idempotents which commute with θ, it follows that
                                 p
                                 Y                                               p−1
                                                                                 Y
              ej dpk y p = ej          (θ + i − ki+j ),        ej y p dpk = ej         (θ − i − kj−i ).   (5.2)
                                 i=1                                             i=0
                                                                         P
                                                           set wp = n pi=1 vi , A =
    Let v1 , . . . , vn−1 be the standard basis for Cn−1 , P
  n−1                      n−1                               n−1
⊕i=1  Zwi , and A+ = ⊕i=1      Nwi . If j ≥ k, then j − k ∈ j=1  Nwj . It is convenient
                      Pn−1           Pn−1 Pn−1
to define F (b) = j=1 bj wj = n i=1 ( j=i bj )vj . Then we have isomorphisms
                                                        n−1
                                    P ic(X) ←− Zn−1 −→ ⊕i=1 Zwi


                                           D(b) ←− b −→ F (b).                                            (5.3)
Lemma 5.1. Fix p ∈ N with 1 ≤ p ≤ n − 1, and set k′ = k + wp . Then

                                            y p eHk e = ep Hk′ ep y p .                                   (5.4)

Proof. To simplify notation write d = dk and d1 = dk′ . We have
                           p
                           Y                                       n
                                                                   Y
                                                                                     ′
                      ep         (θ + i − p − ki ) = ep                    (θ + j − kp+j )
                           i=1                                  j=n−p+1

and
                                n
                                Y                                   n−p
                                                                    Y
                                                                                    ′
                          ep           (θ + i − p − ki ) = ep             (θ + j − kp+j ).
                               i=p+1                                j=1

To see this set j = i + n − p, (resp. j = i − p) in the left side of the first (resp.
second) equation above to obtain the right side. Since yθy −1 = θ − 1 it follows from
(5.2) that

                          n
                          Y                           n
                                                      Y
      y p edn y −p = ep     (θ + i − p − ki )y −n = ep (θ + i − kp+i
                                                                 ′
                                                                     )y −n = ep dn1 .                     (5.5)
                          i=1                                      i=1

The left side of (5.4) equals y p eC[y n , yd, dn ] and the right side equals ep C[y n , yd1 , dn1 ]y p .
By (5.5) we have
                                       y p edn = ep dn1 y p                                   (5.6)
and it easy to see that

                                           y p eyd = ep (yd1 − κ)y p ,
for some κ ∈ C. Therefore

                                y p ey an (yd)b dcn = ep y an (yd1 − κ)b dcn p
                                                                          1 y .

The result follows from this.


                                                          13
   We use Lemma 5.1 to define the basic bimodules for our Zn−1 −algebras. Fix p
with 1 ≤ p ≤ n − 1, and k ∈ Cn−1 , and set k′ = k + wp and

                              B(k′ , k) = Bp (k) = eHk′ ep y p ,

By Lemma 5.1,

               Bp (k) · Uk = eHk′ ep · y p eHk e = eHk′ ep Hk′ ep y p ⊆ Bp (k)

It follows that Bp (k) is a Uk′ − Uk -bimodule. Similarly Cp (k) = y −p ep Hk′ e is a
Uk − Uk′ bimodule and we have a Morita context
                                                
                                    Uk ′  Bp (k)
                                                                                (5.7)
                                   Cp (k)   Uk

Theorem 5.2. (1) Bp (k)Cp (k) = Uk′ provided {i − ki }pi=1 ∩ {j − kj }nj=p+1 = ∅.
(2) Cp (k)Bp (k) = Uk provided {i − ki }pi=1 ∩ {j + n − kj }nj=p+1 = ∅.

Proof.       By (5.2) Bp (k)Cp (k) contains the elements

                       edpk′ ep y p · y −p ep y p e = edpk′ y p = eg(θ).

and

                                  ey n−p dkn−p
                                            ′  = eh(θ).

where g(θ) = Πpi=1 (θ + i − n − ki ) and h(θ) = Πnj=p+1 (θ + j − n − kj ). Since g and
h are relatively prime if and only if {i − ki }pi=1 ∩ {j − kj }nj=p+1 = ∅, this proves (1)
and the proof of (2) is similar.

   We can express the conditions in Theorem 5.2 in terms of a root systems. We
embed Cn−1 in Cn as Cn−1 × {0}, and let v1 , . . . , vn be the standard basis for Cn .
Define a symmetric bilinear form ( , ) on Cn by (vi , vj ) = δi,j . The set

                                     Φ = {vi − vj |i 6= j}

forms a root system of type An−1 . As a base for the root system we choose B =
{α1 , . . . , αn−1 }, where αi = vi − vi+1 for 1 ≤ i ≤ n − 1. Let Φ+ denote the corre-
sponding set of positive roots. Given a ∈ Cn−1 , we set Φa = {α ∈ Φ|(a, α) ∈ Z}.
    Fix k = (k1 , . . . , kn−1 ), and let ρ = (n − 1, . . . , 2, 1) ∈ Cn−1 . Then (k + ρ, vi −
vj ) = (ki − i) − (kj − j). Set ai = (n − i + ki )/n for 1 ≤ i ≤ n − 1, an = 0 and
a = (a1 , . . . , an−1 ). We have
                                          k + ρ = na.                                    (5.8)
                                                                       Pn
Note also that (wp , αi ) = nδi,p for 1 ≤ i, p ≤ n − 1. Let 1 = i=1 vi . It follows that
(wp − p1)/n is the pth fundamental weight corresponding to the basis B. We say
that k is dominant if (k + ρ, α) > 0 for all α ∈ Φa ∩ Φ+ . For similar definitions in
the enveloping algebra context see [J, Section 2.5].


                                                14
Theorem 5.3. If k is dominant and k′ = k + wp , then k′ is dominant and Uk and
Uk′ are Morita equivalent.

Proof. The Morita equivalence follows from Theorem 5.2, and it is easy to check
that k′ is dominant.

   We check that the basic bimodules B(k′ , k) satisfy (4.2).
                                                                ′′                                    ′′′
Lemma 5.4. If k′ = k + wp , k = k + wq , and k = k + wp + wq , then
                                            ′′′         ′                  ′                   ′′′   ′′           ′′
                                  B(k , k )B(k , k) = B(k , k )B(k , k).

Proof. We first show that

                                            B(k , k) = Uk′ edpk′ y p + Uk′ ey n .
                                                            ′
                                                                                                                                           (5.9)

Since e0 Hk′ ep = eC[dk′ , y]ep , and

                                                     edak′ y b ep = eep+b−a dak′ y b ,

it follows that eHk′ ep is spanned by all elements of the form edak′ y b ep with a ≡
p + b mod n. Equation (5.9) follows easily from this. Thus

                     B(k , k )B(k , k) = B(k , k )dpk′ y p e + B(k , k )y n e
                            ′′′    ′                ′                              ′′′   ′                              ′′′       ′



                                                                     ′′′       ′                                  ′′′         ′       ′
Using the analog of (5.9) for B(k , k ), we see that B(k , k )B(k , k) is generated
as a left Uk′′′ - module by the elements

                                                  edqk′′′ y q · dpk′ y p ,                   ey n · dpk′ y p ,

                                                            edqk′′′ y q · y n ,              ey n · y n .
               ′′′     ′′              ′′
Similarly B(k , k )B(k , k) is generated as a left Uk′′′ - module by the elements

                                              edpk′′′ y p · dqk′′ y q ,                      ey n · dqk′′ y q ,

                                                            edpk′′′ y p · y n ,              ey n · y n .
Assume that p ≤ q. We have the following identities,


                                                        ey n dpk′ y p = edpk′′′ y p+n                                                     (5.10)

and
                                                  edqk′′′ y q dpk′ y p = edpk′′′ y p dqk′′ y q .                                          (5.11)
These identities follows easily from (5.2). For example both sides of (5.11) are equal
to
                      eΠpi=1 (θ + i − 2n − ki )Πqi=1 (θ + i − n − ki ).


                                                                                   15
    It remains to show that

                           edqk′′′ y q+n ∈ B(k , k )B(k , k)
                                              ′′′   ′′       ′′
                                                                                         (5.12)

and

                            ey n dqk′′ y q ∈ B(k , k )B(k , k).
                                              ′′′   ′    ′
                                                                                         (5.13)

By (5.2) ey n dqk′′ y q is a C[θ]-multiple of ey n dpk′ y p . This gives (5.13) and the proof of
(5.12) is similar.

   By Lemma 5.4 it now makes sense to define the bimodules B(j, k) for j ≥ k using
equation (4.3).


Theorem 5.5. If k is dominant then R(k) = ⊕i≥j≥k B(i, j) is a Morita Zn−1 -algebra
Rk = Uk .


6     Proof of the Main Theorem.
Suppose that R = R(k) is as in Theorem 5.5. The algebra D = C[y ±1 , ∂] ∗ Γ is equal
to D = C[y ±1 , dk ]∗Γ for all
                           Lk    ∈ Cn−1 . We consider the differential
                                                                  LNoperator   filtration
                               N      ±1      i                             ±1       i
on D defined by DN =
    PN                         i=0 C[y ] ∗ Γ∂ . We have DN =         i=0 C[y ] ∗ Γdk . If
a = j=0 fj (y)∂ ∈ C[y , ∂] with fi (y) ∈ C[y ], fN 6= 0 we set gr(a) = fN (u)v N .
                  j       ±1                      ±1

We extend gr to a linear map from D = C[y ±1 , ∂] ∗ Γ to C[u±1 , v] ∗ Γ such that
gr(γa) = γgr(a). Note in particular that u = gr y, v = gr dk and gr dk = v n = z.
Also


                                   gr(bdnk ) = gr(b)z                                     (6.1)

for all b ∈ D. Since Hk and Uk are subalgebras of D they have an induced filtration,
and we have
                       grHk ∼= C[u, v] ∗ Γ, grUk ∼= C[u, v]Γ .
   Similarly there is a differential operator filtration {Bn (r′ , r)}n≥0 on B(r′ , r) and
we obtain a filtration on R by setting Rn = ⊕r′ ≥r≥k Bn (r′ , r).

   Recall the isomorphisms from equation (5.3). The key remaining step in the
proof of the main theorem is the following.

Theorem 6.1. Assume that k ∈ Cn−1 is dominant and r′ ≥ r ≥ k with r′ =
r + F (b). Then
                     grB(r′ , r) = H 0 (X, O(D(b))).

Proof of the Main Theorem.
(1) The equivalence of categories R − qgr ≃ Uk -mod follows from Theorem 5.5 and
Lemma 4.2.

                                              16
             L
(2) Let S = b∈Nn−1 H 0 (X, O(D(b))). By Theorem 3.1 and Lemma 3.5 we know
the category S − qgr is equivalent to Coh(HilbΓ C2 ). On the other hand by Theorem
6.1 the associated graded ring of the Zn−1 -algebra R(k) is
                           M
                                 H 0 (X, O(D(F −1 (r′ − r))),
                           r′ ≥r≥k

and this is the Zn−1 -algebra arising from the Nn−1 -graded algebra S. Hence the re-
sult follows from Lemma 4.1.

   It is easy to check Theorem 6.1 for basic bimodules.
Lemma 6.2. If 1 ≤ p ≤ n − 1, and r′ = r + wp , we have

                            gr(B(r′ , r)) ∼
                                          = H 0 (X, O(D(vp ))

Proof. By (5.9) grB(r′ , r) ∼
                            = C Γ up v p + C Γ un = C Γ xp + C Γ xn z −1 . On the other
hand Lemma 2.4 implies that

                        H 0 (X, O(D(vp )) = C Γ + C Γ xn−p z −1 .

The isomorphism is multiplication by x−p .
                                       Pn−1
Lemma 6.3. For b ∈ Nn−1 , set f (b) = j=1   jbj . There is an injective linear map

                        H 0 (X, O(D(b))) −→ gr B(r + F (b), r)                    (6.2)
given by multiplication by xf (b) .
Proof. Using Corollary 2.2, induction and then [GS1, Lemma 6.7 (1)] we get

   H 0 (X, O(D(b + c)))xf (b+c) = H 0 (X, O(D(b)))xf (c) H 0 (X, O(D(c)))xf (b) ⊆

   gr B(r + F (b + c), r + F (c))gr B(r + F (c), r) ⊆ gr B(r + F (b + c), r).

    From now on we assume that k ∈ Cn−1 is dominant and fix r′ ≥ r ≥ k with
r′ = r + F (b). Note that r′ and r are also dominant. We write B(b) and d instead
of B(r′ , r) and dr respectively We have
                                                     n−1
                                                     X
                                      ri′ = ri + n         bj                     (6.3)
                                                     j=i

for 1 ≤ i ≤ n − 1.

    We explain how the proof of Theorem 6.1 reduces to a Poincaré series com-
putation. Note that the torus T acts on both the domain and target of the map
in equation
     L      (6.2). Set P = gr B(b) and consider the weight space decomposition
P = χ∈X(T ) P (χ). Since gr B(b) ⊆ C[u, v] it follows that

                         {χ ∈ X(T )|P (χ) 6= 0} ⊆ Nχ1 + Nχ2 .

                                              17
Because z ∈ C[nχ2 ], this implies that ∩m≥0 P z m = 0. Therefore by Nakayama’s
lemma if B is a subspace of P whose image in P = P ⊗C[z] C is a basis, then B
generates P as a C[z]-module. We will show that dimP (χ) < ∞ for all χ ∈ X(T ).
Then since P is a torsion-free C[z]-module, we have

                              HP (q, t) = (1 − tn )HP (q, t).

Now we view C× as the subtorus {(λ, λ−1 )|λ ∈ C× } of T. Then X(C× ) = Zη,
where η = χ1 | × = −χ2 | × . For a C× -module V we now have the weight space
              C   L     C
decomposition V = m∈Z V [m], where

                    V [m] = {v ∈ V |τ · v = η(τ )m v for all τ ∈ C× }.

If dimV [m] < ∞ for all m, we define the one variable Poincaré series
                                         X
                              HV (s) =         dim V [m] sm .
                                         m∈Z
                L
Clearly P [m] =   P (χ) where the sum is over all χ ∈ X(T ) such that χ|C× = mη. If
we can show that dimP [m] < ∞ for all m ∈ Z, then dimP (χ) < ∞ for all χ ∈ X(T )
and we have
                              HP (s, s−1 ) = HP (s).
Similarly if N = N (b) ⊗C[z] C, then

                     HN (s) = HN (s, s−1 ) = (1 − s−n )HN (s, s−1 ).

Therefore by equation (2.10)
                                         Pn−1      P n−1
                                           i=0   sn j=n−i bj
                             HN (s) =                        .                (6.4)
                                               (1 − sn )

    On the other hand the map in equation (6.2) is equivariant for the action of
C× , since x = uv ∈ C[0]. Hence to prove Theorem 6.1 it suffices to show that the
Poincaré series HP (s) is given by equation (6.4). We do this by developing some
representation theory of the algebras Hr and Ur , and the bimodules B(b).

   The algebra Hr has a Z-grading in which the degrees of the generators satisfy

                        deg y = 1,    deg d = −1,      deg γ = 0.

   If M = ⊕α∈Z Mα is a graded Hr -module with dim Mα < ∞ for all α, we define
the Poincaré series of M to be
                                       X
                             p(M, s) =   (dim Mα )sα .
                                          α∈Z

Lemma 6.4.
                          Hgr B(b) (s) = p(B(b) ⊗C[dn ] C, s).


                                            18
Proof. Note that u = gr y ∈ C[u, v][1], and v = gr d ∈ C[u, v][−1]. Since Z ∼   = Zη is
the character group of C× , this gives an action of C× on C[y ±1 , ∂] ∗ Γ such that the
map gr is C× -equivariant. Therefore as C× -modules

                                   B(b) ∼
                                        = gr B(b).                                 (6.5)

Furthermore by equation (6.1)

                                 B(b)dn ∼
                                        = gr B(b)z.                                (6.6)

The result follows since B(b) ⊗C[dn ] C is the quotient of the left side of (6.5) by the
left side of (6.6), and gr B(b) = (gr B(b)) ⊗C[z] C is the corresponding quotient of
the right sides.

    Let Or denote the category whose objects are finitely generated Hr -modules on
which the action of d is locally nilpotent. As in [GS1, Section 6.12] and [GGOR,
Section 2.4] we use a graded version O   er of the category Or . Objects in O   er are
Z-graded Hr -modules which are also objects in Or . Morphisms in Or (resp. O        er )
are Hr -module homomorphisms (resp. Hr -module homomorphisms which are ho-
mogeneous of degree zero). We write Let OrU for the category of finitely generated
Ur -modules on which the action of dn is locally nilpotent, and let O   erU denote the
corresponding category of graded Ur -modules.
    If M = ⊕α∈Z Mα is a module in O   er it follows from the local nilpotence of d and
finite generation that dim Mα < ∞ for all α, so p(M, s) is defined. For β ∈ Z, the
                     er is defined by (M [β])α = Mα−β . We have
shift functor [β] in O

                               p(M [β], s) = sβ p(M, s).

The algebra Hr has a triangular decomposition

                              Hr = C[y] ⊗ C[Γ] ⊗ C[d].

    For i = 0, . . . , n − 1 let Cεi denote the one-dimensional CΓ-module on which ei
acts as the identity and make Cεi into a C[d] ∗ Γ-module with dεi = 0. Then we
define the standard module Mr (εi ) by

                              Mr (εi ) = Hr ⊗C[d]∗Γ Cεi .

Note that θ acts on the subspace 1 ⊗ Cεi of Mr (εi ) as multiplication by the scalar
ri . We also define the graded standard module Mfr (εi ) to be an isomorphic copy of
Mr (εi ) as an Hr -module, with grading defined by deg(1 ⊗ εi ) = 0.
     To prove the main theorem we compute the Poincaré series of B(b) ⊗C[dn ] C and
show that it equals (6.4). To do this we observe that

                     B(b) ⊗C[dn ] C ∼
                                    = B(b) ⊗eHr e eHr e ⊗C[dn ] C.

So we begin our analysis with the left Hr -module G = Hr e ⊗C[dn ] C. This module
inherits a grading from Hr , in which deg(e ⊗ 1) = 0.

                                          19
                                                     er , we have
Lemma 6.5. In the Grothendieck group of the category O
                                              n−1
                                              X
                                fr (ǫ0 )] +
                         [G] = [M                 fr (εn−i )[−i]].
                                                 [M                                (6.7)
                                              i=1

Proof. For    ≤ i ≤ n−1 set ui = di e⊗1 ∈ G, Ni = Hr ui and Nn = 0. It is easy to see
          P0n−1
that G = i=0 C[y]ui , a free C[y]-module of rank n. Thus Ni /Ni+1 ∼=M fr (εn−i )[−i]
for 0 ≤ i ≤ n − 1, and the result follows from this.
                                                                      eU′ we
Key Lemma. Assume that r is dominant. Then as objects of the category Or
have, for 1 ≤ i ≤ n − 1
                                 fr (εi ) ∼
                         B(b) ⊗ eM           fr′ (εi )[ri′ − ri ].
                                          = eM                                     (6.8)

    To prove this we need several preliminary results. First we state an easy char-
acterization of the Ur′ -modules eMr′ (εi ).

Lemma 6.6. Suppose that M = C[y n ]v is a left Ur′ -module which is generated by
an element v such that dnr′ v = 0, θv = (n − i + ri′ )v, and M is a free C[y n ]-module,
then M ∼
       = eMr′ (εi ).

   In the next lemma we assume that R and S are subrings of a C-algebra Q and
that B is an R − S bimodule and C an S − R-bimodule such that the functors

                            B⊗      : S−mod −→ R−mod
and
                            C⊗      : R−mod −→ S−mod
are inverse equivalences of categories. Suppose that T is a multiplicatively closed
subset of both R and S and that T is an Ore set in R. Assume also that C satisfies
an Ore condition with respect to T : given t ∈ T and c ∈ C there exist t′ ∈ T and
c′ ∈ C such that
                                      c′ t = t′ c.                            (6.9)
In the following “torsion” means torsion with respect to T .

Lemma 6.7. Let M be an S-module, and N an R-module.
(1) If N is torsion so is C ⊗ N.
(2) If M is torsion-free so is B ⊗ M.

Proof. (1) Suppose that n ∈ N, t ∈ T and tn = 0. If c ∈ C, we find c′ and t′ as in
(6.9). Then t′ (c ⊗ n) = c′ ⊗ tn = 0.
(2) Since T is Ore in R the set N of torsion elements of B ⊗ M forms a submodule.
By (1), C ⊗N is a torsion submodule of C ⊗B⊗M, but by assumption C ⊗B⊗M ∼    =M
which is torsion free.

Corollary 6.8. Bp (r) ⊗ eMr (εi ) is a torsion-free C[y n ]-module.



                                            20
Proof. We apply Lemma 6.7 with R = Ur′ , S = Ur , B = Bp (r) and T = C[y n ] \ {0}.
The Ore conditions follow from the existence of the localizations. Indeed, it is easy
to see that

                           Hr ⊗C[yn ] C(y n ) = C[y ±1 , ∂] ∗ Γ
                            Ur ⊗C[yn ] C(y n ) = eC[y ±1 , ∂] ∗ Γe

and

                       Bp (r) ⊗C[yn ] C(y n ) = eC[y ±1 , ∂] ∗ Γep y p
                                                  = C(y n ) ⊗C[yn ] Bp (r).

Lemma 6.9. Assume that r is dominant and set B = Bp (r). Consider the elements
v = ey n ⊗ y n−i εi and w = edpr′ y p ⊗ y n−i εi of B ⊗ eMr (εi ). Then
(1) dnr′ w = 0.
(2) If 1 ≤ i ≤ p, then dnr′ v = w = 0.
(3) If p + 1 ≤ i ≤ n − 1, then y n w = κv for some nonzero κ ∈ C.
(4) B ⊗ eMr (εi ) = Ur′ v + Ur′ w.


Proof. We use the following identity repeatedly

                    (θ + j − rj′ )y n−i εi = (ri + n − i + j − rj′ )y n−i εi .            (6.10)
Equation (6.10) holds because both sides are equal to y n−i (θ + n − i + j − rj′ )εi .
(1) Multiplying (5.6) on the left by dpr′ gives ednr′ · dpr′ y p = edpr′ y p · dnr . Therefore

                                  dnr′ w = ednr′ · dpr′ y p ⊗ y n−i εi

                                   = edpr′ y p ⊗ dnr y n−i εi = 0.
(2) We first show that y n w = 0. Indeed by (5.2) and (6.10),

                                  y n w = ey n · dpr′ y p ⊗ y n−i εi

                                            p
                                            Y
                                 = ey n ⊗       (θ + j − rj′ )y n−i εi
                                            j=1
                                          p
                                          Y
                             n      n−i
                       = ey ⊗ y               (ri + n − i + j − rj′ )εi = 0,
                                          j=1

since the term in the product with j = i is zero.

    It follows from Corollary 6.8 that w = 0. Now by equations (5.2) and (6.10),
                                                       n
                                                       Y
                   dnr′ v = ednr′ y n ⊗ y n−i εi = e       (θ + j − rj′ ) ⊗ y n−i εi
                                                       j=1


                                                  21
                                              n
                                              Y
                            = edpr′ y p ⊗            (θ + j − rj′ )y n−i εi
                                             j=p+1
                                              n
                                              Y
                       = edpr′ y p ⊗ y n−i           (ri + n − i + j − rj′ )εi .
                                             j=p+1

The result follows since this is a multiple of w.
(3) As in the proof of (2),
                                               p
                                               Y
                       y n w = ey n ⊗ y n−i          (ri + n − i + j − rj′ )εi ,
                                               j=1

but now the terms (ri + n − i + j − rj′ ) are nonzero, since i ≥ p + 1 > j and r is
dominant.
(4) Since B ⊗ eMfr (εi ) = B ⊗ y n−i C[y n ]εi = B ⊗ y n−i εi , the result follows from
equation (5.9).

Proof of the Key Lemma. We can assume that r′ = r + wp . Set B = Bp (r). Sup-
pose that p + 1 ≤ i ≤ n − 1. By (1), (3) and (4) in Lemma 6.9 B ⊗ eM     fr (εi ) = U ′ w,
                                                                                     r
      n                                    n                         n
and dr′ w = 0. Hence B ⊗ eMr (εi ) = C[y ]w and this is a free C[y ]-module, since it
is torsion free by Corollary 6.8. It is easy to check that θw = (n − i + ri )w and that
w has the same degree as y n−i εi . So the result in this case follows from Lemma 6.6.
The proof for the case where 1 ≤ i ≤ p, is similar using v instead of w.

Proof of Theorem 6.1. By Lemma 6.3 there is an inclusion H 0 (X, O(D(b))) ⊆
grB(b). To show the reverse inclusion, it suffices to show that

                                        grB(b) ⊗C[z] C

and
                                  H o (X, O(D(b))) ⊗C[z] C
have the same Poincaré series.

      By equations (6.7) and (6.8) we have in the Grothendieck group of the category
er′
O
                                             n−1
                                             X
                          fr′ (ǫ0 )] +
          [B(b) ⊗ eG] = [eM                          fr′ (εn−i )[−i − rn−i + rn−i
                                                   [eM                        ′
                                                                                  ]].   (6.11)
                                             i=1

      Since ey i = y i en−i it follows that for 1 ≤ i ≤ n − 1

                                   fr′ (εn−i ) = y i C[y n ]εn−i
                                  eM
and so
                                 fr′ (εn−i ), s) = si (1 − sn )−1 .
                              p(eM                                                      (6.12)

                                                    22
In addition we have
                                 fr′ (ε0 ), s) = (1 − sn )−1 .
                              p(eM                                                   (6.13)
We combine (6.12) and (6.13) with equation (6.11) and then use equation (6.3) to
obtain,
                                n−1
                                X
              p(B(b) ⊗ eG, s) =        fr′ (εn−i ), s)s−i−rn−i +rn−i
                                    p(eM
                                                                 ′


                                      i=0
                                       n
                                       X    ′
                                          sri −ri
                                     =
                                         (1 − sn )
                                         i=1
                                      Pn            P n−1
                                          sn j=i bj
                                 = i=1              .
                                        1 − sn
Since this is the same as equation (6.4), the proof is complete.


7    Concluding remarks.
We relate our work to that of Hodges, [H] and Crawley-Boevey and Holland [CBH].
As in [H] we fix a monic polynomial v(x) ∈ C[x] and let T (v) be the algebra generated
by the elements h, a, b such that

             ha − ah = a,     hb − bh = −b,         ba = v(h),   ab = v(h − 1).

Fix k = (k1 , . . . , kn−1 ) ∈ Cn−1 , and let a = (a1 , . . . , an−1 ) ∈ Cn−1 be as equation
(5.8), and an = 0.
                               Q
Lemma 7.1. Set v(x) = ni=1 (x − ai ). Then T (v) ∼         = Uk .
Proof. The algebra Uk is generated by A = ey n , B = e(dk /n)n and H = e(θ + n)/n.
We have HA − AH = A, and HB − BH = −B. Using equation (5.2) we see that
                                   n
                                   Y
                          BA = e     ((θ + i − ki )/n) = v(H)
                                   i=1

and similarly AB = v(H − 1). Hence there is a surjective ring homomorphism from
T (v) to Uk sending a, b, h to A, B, H respectively. The map is injective since T (v)
and Uk have the same associated graded ring.

   Now define an action of the symmetric group Sn−1 on Cn−1 by s(x)i = xs−1 i .
Define the dot action of Sn−1 on Cn−1 by s · x = s(x + ρ) − ρ.
Corollary 7.2. For all s ∈ Sn−1 , Uk ∼
                                     = Us·k .
  Now suppose that v(x) = w(x)u(x) is a factorization of v with u, w monic.
Hodges considers the T (v)-module

                                Pw = T (v)a + T (v)w(h).                              (7.1)

The next result is [H, Lemma 2.4].

                                               23
Theorem 7.3. The left T (v) module Pw is projective if u(x) and w(x) are relatively
prime, and is a generator if u(x) and w(x + 1) are relatively prime.

     We compare Q  Pw to the Uk′ − Uk -bimodules Bp (k). To do this we now assume
that let v(x) = ni=1 (x − a′i ), where a′i = (n − i + ki′ )/n for 1 ≤ i ≤ n − 1, and
a′n = 0 so that T (v) ∼
                      = Uk′ . We identify T (v)Qwith Uk′ using this isomorphism. By
Corollary 7.2 we may assume that w(x) = pi=1 (x − a′i ). Then by equation (5.2)
e(dk′ /p)n y n = w(H). So comparing equations (5.9) and (7.1) we see that Pw is iden-
tified with Bp (k). Now it is easy to see that Theorem 5.2 is equivalent to Theorem
7.3.

   For a finite subgroup Γ of SL2 C, and λ a central element in CΓ, Crawley-Boevey
and Holland define the algebras

                        S λ = (C < x, y > Γ)/(xy − yx − λ),

and Oλ = eS λ e, [CBH]. For Γ cyclic of order n, we compare the S λ to the algebras
Hk . By equation (5.1)
                                      n−1
                                      X                        n−1
                                                               X
                   dk y − ydk = 1 +         (kj − kj+1 )ej =         λj ej ,    (7.2)
                                      j=0                      j=0

                                                         Pn−1
where λj = (1/n) + kj − k1+j . Note that the trace of λ = j=0 λj ej on the regular
representation of Γ equals 1. Also if we are given λ ∈ CΓ with trace 1, there is a
unique solution to equation (7.2) with k0 = kn = 0 and k ∈ Cn−1 . Clearly we have
   = Hk , and Oλ ∼
Sλ ∼              = Uk .



References
[AB] M.F. Atiyah, R. Bott, A Lefschetz fixed point formula for elliptic differential
     operators. Bull. Amer. Math. Soc. 72 (1966), 245–250.

[AV] M. Artin and M. Van den Bergh, Twisted homogeneous coordinate rings. J.
     Algebra 133 (1990), no. 2, 249–271.

[BP] A.I. Bondal, and A. E. Polishchuk, Homological properties of associative al-
     gebras: the method of helices. (Russian) Izv. Ross. Akad. Nauk Ser. Mat. 57
     (1993), no. 2, 3–50; translation in Russian Acad. Sci. Izv. Math. 42 (1994),
     no. 2, 219–260

[Chan] D. Chan, Twisted multi-homogeneous coordinate rings. J. Algebra 223
     (2000), no. 2, 438–456.

[Cox] D.A. Cox, The homogeneous coordinate ring of a toric variety. J. Algebraic
      Geom. 4 (1995), no. 1, 17–50.


                                             24
[CBH] W.Crawley-Boevey, M.P.Holland, Noncommutative deformations of Kleinian
    singularities. Duke Math. J. 92 (1998), 605–635.

[D]   E.C.Dade, Group-graded rings and modules. Math. Z. 174 (1980), no. 3, 241–
      262.

[EG] P. Etingof, V. Ginzburg, Symplectic reflection algebras, Calogero-Moser space,
     and deformed Harish-Chandra homomorphism. Invent. Math. 147 (2002), 243–
     348.

[F]   W. Fulton, Introduction to toric varieties (Princeton University Press, 1993).

[GGOR] V. Ginzburg, N. Guay, E. Opdam and R. Rouquier, On the category O for
    rational Cherednik algebras. Invent. Math. 154 (2003), 617–651.

[GK] V. Ginzburg and D. Kaledin. Poisson deformations of symplectic quotient
     singularities. math.AG/0212279

[GS1] I. Gordon and J. T. Stafford. Rational Cherednik algebras and Hilbert
     schemes. math.RA/0407516.

[GS2] I. Gordon and J. T. Stafford. Rational Cherednik algebras and Hilbert
     schemes II: representations and sheaves, math.RT/0410293.

[Ha] M. Haiman, t, q-Catalan numbers and the Hilbert scheme. Discrete Math. 193
     (1998), 201–224.

[Hart] R. Hartshorne, Algebraic geometry. Graduate Texts in Mathematics, No. 52.
      Springer-Verlag, New York-Heidelberg, 1977.

[H]   T.J. Hodges, Noncommutative deformations of type-A Kleinian singularities.
      J. Algebra 161 (1993), 271–290.

[IN] Y. Ito and I. Nakamura, McKay correspondence and Hilbert schemes. Proc.
     Japan Acad. Ser. A Math. Sci. 72 (1996), no. 7, 135–138.

[J]   J. C, Jantzen, Einhllende Algebren halbeinfacher Lie-Algebren. Ergebnisse der
      Mathematik und ihrer Grenzgebiete (3). Springer-Verlag, Berlin, 1983.

[W] W. Wang, Algebraic structures behind Hilbert schemes and wreath products.
    Recent developments in infinite-dimensional Lie algebras and conformal field
    theory (Charlottesville, VA, 2000), 271–295, Contemp. Math., 297, Amer.
    Math. Soc., Providence, RI, 2002.




                                         25
