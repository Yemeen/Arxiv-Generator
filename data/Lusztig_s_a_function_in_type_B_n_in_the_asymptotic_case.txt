                                                     LUSZTIG’S a-FUNCTION IN TYPE Bn IN THE
                                                                ASYMPTOTIC CASE
arXiv:math/0504213v2 [math.RT] 5 Sep 2005




                                                               MEINOLF GECK AND LACRIMIOARA IANCU

                                                                     To George Lusztig on his 60th birthday


                                                    Abstract. In this paper, we study Lusztig’s a-function for a Coxeter
                                                    group with unequal parameters. We determine that function explicitly
                                                    in the “asymptotic case” in type Bn , where the left cells have been deter-
                                                    mined in terms of a generalized Robinson–Schensted correspondence by
                                                    Bonnafé and the second author. As a consequence, we can show that all
                                                    of Lusztig’s conjectural properties (P1)–(P15) hold in this case, except
                                                    possibly (P9), (P10) and (P15). Our methods rely on the “leading ma-
                                                    trix coefficients” introduced by the first author. We also interprete the
                                                    ideal structure defined by the two-sided cells in the associated Iwahori–
                                                    Hecke algebra Hn in terms of the Dipper–James–Murphy basis of Hn .




                                                                             1. Introduction
                                               Let (W, S) be a Coxeter system where W is finite. We shall be interested
                                            in the Kazhdan–Lusztig cells and Lusztig’s a-function on W , which play an
                                            important role in the representation theory of finite reductive groups. The
                                            notions of cells and a-functions are defined in terms of the Iwahori–Hecke
                                            algebra associated with W . Originally, Kazhdan–Lusztig [17] and Lusztig
                                            [19] only considered the case of a one-parameter Iwahori–Hecke algebra;
                                            subsequently, the theory has been extended to the case of unequal param-
                                            eters by Lusztig [18], [21]. However, many results that are known to hold
                                            in the equal parameter case (thanks to a geometric interpretation of the
                                            Kazhdan–Lusztig basis) are only conjectural in the general case of unequal
                                            parameters. A precise set of conjectures has been formulated by Lusztig in
                                            [21, Chap. 14], (P1)–(P15). (We recall these conjectures in Section 2.)
                                               The aim of this paper is to determine Lusztig’s a-function explicitly in the
                                            case where W = Wn is of type Bn and the parameters satisfy the “asymp-
                                            totic” conditions in Bonnafé–Iancu [2]. As an application, we show that all
                                            of the conjectures in [21, Chap. 14] hold in this case, except possibly (P9),
                                            (P10) and (P15)1. We also determine the structure of the associated ring J.
                                            Our methods rely on the “leading matrix coefficients” introduced by the first
                                               Date: April, 2005.
                                               2000 Mathematics Subject Classification. Primary 20C08; Secondary 20G40.
                                               1In a subsequent paper [13], using completely different methods, the first author shows
                                            that (P9), (P10) and a weak version of (P15) also hold. Thus, eventually, (P1)–(P14) and
                                            a weak version of (P15) are known to hold in the “asymptotic case” in type Bn .
                                                                                        1
2                               Geck and Iancu

named author [10]. It is our hope that similar methods may also be applied
to other choices of parameters in type Bn where the left cell representations
are expected to be irreducible.
   In a different direction, we show that the ideal structure defined by the
two-sided cells in the “asymptotic” case in type Bn corresponds precisely to
the ideal structure given in terms of the Dipper–James–Murphy basis [6].
   To state our main results more precisely, we have to introduce some nota-
tion. In [21], an Iwahori–Hecke algebra with possibly unequal parameters is
defined with respect to an integer-valued weight function on W . Following
a suggestion of Bonnafé [3], we can slightly modify Lusztig’s definition so
as to include the more general setting in [18] as well. Let Γ be an abelian
group (written additively) and assume that there is a total order 6 on Γ
compatible with the group structure. (In the setting of [21], Γ = Z with the
natural order.)
   Let A = Z[Γ] be the free abelian group with basis {eγ | γ ∈ Γ}. There is
                                                  ′         ′
a well-defined ring structure on A such that eγ eγ = eγ+γ for all γ, γ ′ ∈ Γ.
(Hence, if Γ = Z, then A is nothing but the ring of Laurent polynomials in
an indeterminate e.) We write 1 P  = e0 ∈ A. Given a ∈ A we denote by aγ
the coefficient of eγ , so that a = γ∈Γ aγ eγ . We denote by A>0 the set of
Z-linear combinations of elements eγ where γ > 0. Similarly, we define A>0 ,
A60 and A<0 . We say that a function
                                 L: W → Γ
is a weight function if L(ww′ ) = L(w) + L(w′ ) whenever we have ℓ(ww′ ) =
ℓ(w) + ℓ(w′ ) where ℓ : W → N is the usual length function. (We denote
N = {0, 1, 2, . . .}.) We assume throughout that L(s) > 0 for all s ∈ S.
Let H = H(W, S, L) be the generic Iwahori–Hecke algebra over A with
parameters {vs | s ∈ S} where vs := eL(s) for s ∈ S. The algebra H is free
over A with basis {Tw | w ∈ W }, and the multiplication is given by the rule
                       
                                 Tsw           if ℓ(sw) > ℓ(w),
            Ts Tw =
                         Tsw + (vs − vs−1 )Tw  if ℓ(sw) < ℓ(w),
where s ∈ S and w ∈ W . Having fixed a total order on Γ, we have a
corresponding Kazhdan–Lusztig basis {Cw′ | w ∈ W } of H; we have
                                X
                     Cw′ = Tw +        ∗
                                     Py,w Ty ∈ H,
                                    y∈W
                                    y<w

where < denotes the Bruhat–Chevalley order on W and Py,w      ∗ ∈ A
                                                                    <0 for all
                                                                       ∗ are
y < w in W ; see [18, §6]. (In the framework of [21], the polynomials Py,w
denoted py,w and the basis elements Cw′ are denoted cw .) Given x, y ∈ W ,
we write                   X
                Cx′ Cy′ =       hx,y,z Cz′ where hx,y,z ∈ A.
                         z∈W
For a fixed z ∈ W , we set
           a(z) := min{γ > 0 | eγ hx,y,z ∈ A>0 for all x, y ∈ W };
                                   Lusztig’s a-function                           3

this is Lusztig’s function a : W → Γ. (If Γ = Z with its natural order,
then this reduces to the function defined by Lusztig [19].) In Section 2, we
recall Lusztig’s conjectures concerning the a-function and its relation with
the pre-order relations 6L , 6R and 6LR . In the case where W is a Weyl
group and L is constant on S, these conjectures are known to hold, thanks
to a geometric interpretation which yields certain “positivity properties”;
see Lusztig [19]. In the general case of unequal parameters, it is known that
these positivity properties are no longer satisfied.
   In this paper, we will be dealing with a Coxeter group of type Bn where
the parameters are specified as follows.
Example 1.1. Let Γ be any totally ordered abelian group. Let Wn be a
Coxeter group of type Bn (n > 2), with generators, relations and weight
function L : Wn → Γ given by the following diagram:
                     t        s1          s2                  sn−1
             Bn       ✐        ✐           ✐         · · ·      ✐
             L:      b         a           a                   a

where a, b ∈ Γ are such that
                                   b > (n − 1)a > 0.
(Here, (n − 1)a means a + · · · + a in Γ, with n − 1 summands.) We refer
to this hypothesis as the “asymptotic case” in type Bn . Let Hn be the
corresponding Iwahori–Hecke algebra over A = Z[Γ], where we set

            V := vt = eb       and         v := vs1 = · · · = vsn−1 = ea .

We have the following special case worth mentioning: Let Γ0 = Z2 . Let 6
be the usual lexicographic order so that (i, j) < (i′ , j ′ ) if i < i′ or if i = i′
and j < j ′ . Then A0 = Z[Γ0 ] is nothing but the ring of Laurent polynomials
in two independent indeterminates V0 = e(1,0) and v0 = e(0,1) . This is the
set-up originally considered by Bonnafé–Iancu [2]; we may refer to this case
as the “generic asymptotic case” in type Bn .
   In Bonnafé–Iancu [2] (for the “generic” case), the left cells of Wn are
determined explicitly in terms of a generalized Robinson–Schensted corre-
spondence. This correspondence associates to each element w ∈ Wn a pair
of standard bitableaux of the same shape and total size n. (By a bitableau,
we mean an ordered pair of two tableaux; the shape of a bitableau is an
ordered pair of partitions, that is, a bipartition.) Subsequently, Bonnafé [3]
has shown that these results remain valid in the general “asymptotic case”.
(In Section 5, we recall in more detail the main results of [2], [3].)
  Our first main result gives an explicit description of the a-function.
Theorem 1.2. In the setting of Example 1.1, let w ∈ Wn and assume that
w corresponds to a pair of bitableaux of shape (λ1 , λ2 ) by the generalized
4                                Geck and Iancu

Robinson–Schensted correspondance defined in [2], where λ1 and λ2 are par-
titions such that |λ1 | + |λ2 | = n. Then
                a(w) = b |λ2 | + a (n(λ1 ) + 2n(λ∗2 ) − n(λ2 )).
Here, n(µ) = i (i − 1)µ(i) for any partition µ = (µ(1) > µ(2) > . . . > 0)
             P
and µ∗ denotes the conjugate partition.
    In the “generic asymptotic case”, the above formula reads
                   a(w) = (|λ2 |, n(λ1 ) + 2n(λ∗2 ) − n(λ2 )).
The proof will be given in Section 5, using the general methods developed
in Section 4. The main ingredients in that proof are Bonnafé’s results [3]
on the two-sided cells in Wn , and the orthogonal representations and lead-
ing matrix coefficients introduced in [10]. These are generalizations of the
leading coefficients of character values considered by Lusztig [20]. As an
application, we obtain the following result. (See Section 5 for the proof.)
Theorem 1.3. In the setting of Example 1.1, all the conjectures (P1)–(P15)
in [21, Chap. 14] hold except possibly (P9), (P10) and (P15). The set of
“distinguished involutions” is given by D = {z ∈ Wn | z 2 = 1}.
  Thanks to the validity of the properties in Theorem 1.3, we can construct
the ring J as explained in [21, Chap. 18]. As an abelian group, J is free
with a basis {tw | w ∈ Wn }. The multiplication is given by
                          X
                tx · ty =    γx,y,z −1 tz   for all x, y ∈ Wn ,
                         z∈W

where γx,y,z −1 ∈ Z is the constant term of ea(z) hx,y,z ∈ A>0 .
Theorem L  1.4. In the setting of Example 1.1, we have an isomorphism of
        ∼
rings J =     λ Mdλ (Z), where λ = (λ1 , λ2 ) runs over all bipartitions of n
and dλ is the number of standard bitableaux of shape λ. We have
                               if x ∼L y −1 , y ∼L z −1 , z ∼L x−1 ,
                   
                     ±1
          γx,y,z =
                      0        otherwise.
   The proof in Proposition 4.9 actually yields an explicit isomorphism which
shows that ±tw (w ∈ Wn ) corresponds to a matrix unit in Mdλ (Z) for some
bipartition λ. Furthermore, the signs are interpreted in terms of leading
matrix coefficients.
   Finally, we show that the Kazhdan–Lusztig basis in the asymptotic case is
compatible with the basis constructed by Dipper–James–Murphy [6]. That
basis is denoted {xst} where (s, t) runs over all pairs of standard bitableaux
of total size n and of the same shape; see [6, Theorem 4.14]. Note that
the construction of the elements xst does not rely on the choice of any total
order on Γ. Given a bipartition λ of n, let N λ ⊆ Hn be the A-submodule
spanned by all xst where the shape of s and t is a bipartition µ of n such
that λ E µ. By [6, Cor. 4.13], N λ is a two-sided ideal of Hn . Now we can
state (see the end of Section 5 for the proof):
                                  Lusztig’s a-function                         5

Theorem 1.5. In the setting of Example 1.1, let λ = (λ1 , λ2 ) be a bipar-
tition of n. Then N λ is spanned by the basis elements Cw′ where w ∈ Wn
corresponds, via the generalized Robinson–Schensted correspondence, to a
bitableau of shape ν = (ν1 , ν2 ) such that (λ1 , λ2 ) E (ν2 , ν1∗ ).
   This paper is organized as follows. In Section 2, we recall the basic defini-
tions concerning the Kazhdan–Lusztig pre-orders on a finite Coxeter group
W and state Lusztig’s conjectures (P1)–(P15), following [21, Chap. 14].
   In Section 3, we deal with the leading coefficients of the matrix repre-
sentations of the Iwahori–Hecke algebra associated with W and show that,
under suitable hypotheses, these leading coefficients can be used to detect
left, right and two-sided cells. This is an elaboration, with some refinements,
of the ideas in [10].
   In Section 4, we present some criteria and tools for attacking Lusztig’s
conjectures. It is our hope that these methods will also be applicable to other
situations where the left cell representations are expected to be irreducible.
   In Section 5, we show that the hypotheses required for the criteria in
Section 4 are all satisfied for the “asymptotic case” in type Bn . This heavily
relies on the fact that Hoefsmit’s [16] matrix representations in type Bn are
“orthogonal representations” in the sense of [10]; hence the theory of leading
coefficients and the results in Sections 3 and 4 can be applied in this case.

               2. Left cells and Lusztig’s conjectures
    We keep the basic set-up introduced in Section 1 where W is a finite
Coxeter group and H is the corresponding Iwahori–Hecke algebra over A,
with parameters {vs | s ∈ S} where vs = eL(s) and L(s) > 0 for all s ∈ S.
    Since we will be dealing with a-invariants of elements in W and of irre-
ducible representations, it will be technically more convenient to work with
a slightly different version of the Kazhdan–Lusztig basis of H. (The reasons
can be P seen, for example, in [21, Chap. 18].) For any a ∈ A, we define
ā := γ∈Γ aγ e−γ . Then we have a unique ring involution j : H → H such
that j(a) = ā for a ∈ A and j(Tw ) = εw Tw for w ∈ W , where we set
εw = (−1)ℓ(w) . As in [18, §6], we set Cw := εw j(Cw′ ). Then we have
                            X            ∗
                Cw = Tw +        εy εw P y,w Ty  for all w ∈ W .
                            y∈W
                            y<w

The multiplication rule now reads:
                     X
            Cx Cy =      εx εy εz hx,y,z Cz              for any x, y ∈ W .
                      z∈W

For example, if x = s ∈ S, we have (see [18, §6]):
                              X
                                            s
                     Csy −
                                    εy εz Mz,y Cz              if sy > y,
          Cs Cy =             z∈W
                             sz<z<y
                       −(vs + vs−1 ) Cy
                    
                                                                if sy < y,
                    
6                                   Geck and Iancu

          s ∈ A is determined as in [18, §3]. Note that we have M        s
                                                                         s
where Mz,y                                                        z,y = Mz,y .
   Throughout this paper, we will make use of another important feature of
Iwahori–Hecke algebras, namely, the fact that these algebras carry a natural
symmetrizing trace. Indeed, consider the linear map τ : H → A defined by
τ (T1 ) = 1 and τ (Tw ) = 0 for 1 6= w ∈ W . Then we have
                                             if w′ = w−1 ,
                                   
                                      1
                     τ (Tw Tw′ ) =
                                      0      if w′ 6= w−1 ;
see [15, §8.1]. Thus, τ is a symmetrizing trace on H. In the following
discussion, we shall also need the basis of H which is dual to the basis {Cw }
with respect to the symmetrizing trace τ . For any y ∈ W we set
                                  X ∗
                      Dy := Ty +       P ww0 ,yw0 Tw ∈ H,
                                     w∈W
                                     y<w

where w0 ∈ W is the unique element of maximal length in W . Then we
have                                  
                                        1    if y = w,
                       τ (Cw Dy−1 ) =
                                        0    if y 6= w.
(See [10, 2.4]; see also [21, Prop. 11.5] where the analogous statement is
proved for the C ′ -basis.) This immediately yields the following result:
Corollary 2.1. For any z ∈ W , we have
         a(z) = min{γ > 0 | eγ τ (Cx Cy Dz −1 ) ∈ A>0 for all x, y ∈ W }.
    (Indeed, just note that τ (Cx Cy Dz −1 ) = εx εy εz hx,y,z .)
   We recall the definition of the left cells of W and the corresponding left
cell representations of H (see [18] or [21]).
   We write z ←L y if there exists some s ∈ S such that hs,y,z 6= 0, that is, Cz′
occurs in Cs′ Cy′ (when expressed in the C ′ -basis) or, equivalently, Cz occurs
in Cs Cy (when expressed in the C-basis). Let 6L be the pre-order relation
on W generated by ←L , that is, we have z 6L y if there exist elements
z = z0 , z1 , . . . , zk = y such that zi−1 ←L zi for 1 6 i 6 k. The equivalence
relation associated with 6L will be denoted by ∼L and the corresponding
equivalence classes are called the left cells of W .
   Similarly, we can define a pre-order 6R by considering multiplication by
Cs′ on the right in the defining relation. The equivalence relation associated
with 6R will be denoted by ∼R and the corresponding equivalence classes
are called the right cells of W . We have
                           x 6R y      ⇔     x−1 6L y −1 .
This follows by using the anti-automorphism ♭ : H → H given by Tw♭ = Tw−1 ;
we have Cw′♭ = Cw′ −1 and Cw♭ = Cw−1 for all w ∈ W ; see [21, 5.6]. Thus,
any statement concerning the left pre-order relation 6L has an equivalent
version for the right pre-order relation 6R , via ♭.
  Finally, we define a pre-order 6LR by the condition that x 6LR y if there
exists a sequence x = x0 , x1 , . . . , xk = y such that, for each i ∈ {1, . . . , k},
                                  Lusztig’s a-function                           7

we have xi−1 6L xi or xi−1 6R xi . The equivalence relation associated with
6LR will be denoted by ∼LR and the corresponding equivalence classes are
called the two-sided cells of W .
   Each left cell C gives rise to a representation of H. This is constructed
as follows (see [18, §7]). Let [C]A be an A-module with a free A-basis {cw |
w ∈ C}. Then the action of Cw (w ∈ W ) on [C]A is given by the above
multiplication formulas, i.e., we have
                   X
         Cw .cx =      εw εx εy hw,x,y cy   for all x ∈ C and w ∈ W .
                   y∈C

Remark 2.2. It is also possible to define a left cell module using the C ′ -basis.
Recall that Cw = εw j(Cw′ ) for all w ∈ W . Let C be a left cell of W and
let [C]′A be a free A-module with a basis {c′x | x ∈ C}. Then we have an
H-module structure on [C]′A given by the formula
                        X
             Cw′ .c′x =   hw,x,y c′y    for all x ∈ C and w ∈ W .
                         y∈W

The passage between the two definitions can be performed using the A-
algebra automorphism δ : H → H given by Ts 7→ −Ts−1 for s ∈ S. Note that,
by the definition of the Kazhdan–Lusztig basis, the elements Cw and Cw′ are
fixed under the composition δ ◦j. Hence, we have Cw′ = εw j(Cw ) = εw δ(Cw )
for all w ∈ W . This shows that we have an isomorphism of H-modules
                                δ
                                  [C]A ∼
                                       = [C]′     A
where  δ [C]is the H-module obtained from [C]A by composing the original
            A
action of H with δ. This remark will play a role in Example 3.11 below.
  For the convenience of the reader, we restate here Lusztig’s conjectures
(P1)–(P15) in [21, Chap. 14] in the general framework involving a totally
ordered abelian group Γ. For z ∈ W , we define an element ∆(z) ∈ Γ and
an integer 0 6= nz ∈ Z by the condition
                       ∗
                e∆(z) P1,z ≡ nz      mod A<0 ;           see [21, 14.1].
Note that ∆(z) > 0. Furthermore, given x, y, z ∈ W , we define γx,y,z −1 ∈ Z
by
             γx,y,z −1 = constant term of ea(z) hx,y,z ∈ A>0 .
Conjecture 2.3 (Lusztig [21, 14.2]). Let D = {z ∈ W | a(z) = ∆(z)}.
Then the following properties hold.
  P1. For any z ∈ W we have a(z) 6 ∆(z).
  P2. If d ∈ D and x, y ∈ W satisfy γx,y,d 6= 0, then x = y −1 .
  P3. If y ∈ W , there exists a unique d ∈ D such that γy−1 ,y,d 6= 0.
  P4. If z ′ 6LR z then a(z ′ ) > a(z). Hence, if z ′ ∼LR z, then a(z) = a(z ′ ).
  P5. If d ∈ D, y ∈ W , γy−1 ,y,d 6= 0, then γy−1 ,y,d = nd = ±1.
  P6. If d ∈ D, then d2 = 1.
  P7. For any x, y, z ∈ W , we have γx,y,z = γy,z,x .
8                                         Geck and Iancu

     P8. Let x, y, z ∈ W be such that γx,y,z 6= 0. Then x ∼L y −1 , y ∼L z −1 ,
         z ∼L x−1 .
     P9. If z ′ 6L z and a(z ′ ) = a(z), then z ′ ∼L z.
    P10. If z ′ 6R z and a(z ′ ) = a(z), then z ′ ∼R z.
    P11. If z ′ 6LR z and a(z ′ ) = a(z), then z ′ ∼LR z.
    P12. Let I ⊂ S and WI be the parabolic subgroup generated by I. If
         y ∈ WI , then a(y) computed in terms of WI is equal to a(y) computed
         in terms of W .
    P13. Any left cell C of W contains a unique element d ∈ D. We have
         γx−1 ,x,d 6= 0 for all x ∈ C.
    P14. For any z ∈ W , we have z ∼LR z −1 .
    P15. If x, x′ , y, w ∈ W are such that a(w) = a(y), then
          X                             X
                hw,x′ ,y′ ⊗Z hx,y′ ,y =    hx,w,y′ ⊗Z hy′ ,x′ ,y in A ⊗Z A.
           y ′ ∈W                          y ′ ∈W

     (The above formulation of (P15) is taken from Bonnafé [3].)
Remark 2.4. For all x, y, z ∈ W , we have
                                                              ∗
                    hx,y,z = hy−1 ,x−1 ,z −1        and      Px,y = Px∗−1 ,y−1 .
Hence, we have a(z) = a(z −1 ), nz = nz −1 , ∆(z) = ∆(z −1 ), D = D −1 .
Proof. We have already remarked above that there is an anti-automorphism
♭ : H → H such that Tw♭ = Tw−1 for all w ∈ W . By the argument in [21,
5.6], we have Cw♭ = Cw−1 . This yields all the above statements.       
   If W is the symmetric group Sn , the above conjectures are all known
to hold; see [21, Chap. 15]2. Hence the information about left, right and
two-sided cells, as well as the a-function, is rather complete in this case.
We close this section by summarizing some known results on Sn . (This
information will be needed in the proof of Theorem 1.2; see Section 5.)
Example 2.5. Let Sn = hs1 , . . . , sn−1 i be the symmetric group, where
si = (i, i + 1) for 1 6 i 6 n − 1. The diagram is given as follows.
                                   s1          s2                    sn−1
                     An−1            ✐         ✐          · · ·       ✐

We consider the abelian group Γ = Z with its natural order and denote
v := e1 . Then A = Z[v, v −1 ] is the ring of Laurent polynomials in an
indeterminate v. Let L : W → Z be any weight function such that L(si ) > 0
for all i. Since all generators are conjugate, L takes the same value on
each si . Thus, we are in the case of “equal parameters”.
   The classical Robinson–Schensted correspondence associates with each
element σ ∈ Sn a pair of standard tableaux (P (σ), Q(σ)) of the same shape.
The tableau P (σ) is obtained by “row-insertion” of the numbers σ.1, . . . , σ.n
     2In a recent preprint [14], the first named author has given elementary proofs of (P1)–
(P15) for W = Sn .
                                       Lusztig’s a-function                        9

(in this order) into an initially empty tableau; the tableau Q(σ) “keeps the
record” of the order by which the positions in P (σ) have been filled; see
Fulton [9, Chap. 4]. For any partition ν ⊢ n, we set

              Rν := {σ ∈ Sn | P (σ), Q(σ) have shape ν}.
                   `
Thus, we have Sn = ν⊢n Rν . Then the following hold.
    (a) For a fixed standard tableau T , the set {σ ∈ Sn | Q(σ) = T } is
        a left cell of Sn and {σ ∈ Sn | P (σ) = T } is a right cell of Sn .
        Furthermore, all left cells and all right cells arise in this way.
This was first proved by Kazhdan–Lusztig [17, §4]; for a more direct and
elementary proof, see Ariki [1].
   (b) The sets Rν , ν ⊢ n are precisely the two-sided cells of Sn .
This is seen as follows. First note that the statements (P1)–(P15) in Conjec-
ture 2.3 are known to hold for W = Sn (see [21, Chap. 15] and the references
there). Now (P4), (P9), (P10) imply that x, y ∈ Sn lie in the same two-sided
cell if and only if there exists a sequence of elements x = x0 , x1 , . . . , xk = y
in Sn such that, for each i, we have xi−1 ∼L xi or xi−1 ∼R xi . Now (b)
follows from (a).
    (c) For any ν ⊢ n, we have σν ∗ ∈ Rν , where σν ∗ is the longest ele-
        ment in the Young subgroup Sν ∗ ⊆ Sn and ν ∗ denotes the conjugate
        partition.
This is a purely combinatorial exercice: it is enough to apply the Robinson–
Schensted correspondence to the element σν∗ and to verify that the corre-
sponding tableaux have shape ν.
   (d) If σ ∈ Rν , then a(σ) = n(ν), where n(ν) is defined as in Theo-
       rem 1.2.
This is seen as follows. Again, we use the fact that (P1)–(P15) in Conjec-
ture 2.3 hold for W = Sn . Since, by (P4), the a-function is constant on
the two-sided cells, (c) shows that it is enough to compute a(σν ) for any
ν ⊢ n. But, since σν is the longest element in a parabolic subgroup, we have
a(σν ) = ℓ(σν ) by (P12) and [21, 13.8]. It remains to note that ℓ(σν ) = n(ν ∗ ).
    (e) If σ ∈ Rν and σ ′ ∈ Rν ′ are such that σ 6LR σ ′ , then we have ν E ν ′ ,
        where E denotes the dominance order. This means that
                       k                   k
                                                      (i)
                       X                   X
                                 (i)
                             ν         6         ν′         for all k > 0,
                       i=1                 i=1

        where ν (i) and ν ′ (i) are the parts of ν and ν ′ , respectively.
This follows from a result of Lusztig–Xi [22, 3.2]; see Du–Parshall–Scott
[8, 2.13.1] and the references there. (Note that, here again, (P1)–(P15) are
used.)
10                              Geck and Iancu

                    3. Leading matrix coefficients
   We now recall the basic facts concerning the leading matrix coefficients
introduced in [10]. We extend scalars from Z to R and consider the group
algebra R[Γ]. Since Γ is totally ordered, R[Γ] is an integral domain; let K
be its field of fractions. We define I>0 ⊂ R[Γ] to be the set of all f ∈ R[Γ]
such that
       f = 1 + R-linear combination of elements of eγ where γ > 0.
Note that I>0 is multiplicatively closed. Furthermore, every element x ∈ K
can be written in the form
          x = rx eγx f /g   where rx ∈ R, γx ∈ Γ and f, g ∈ I>0 ;
note that, if x 6= 0, then rx and γx indeed are uniquely determined by x; if
x = 0, we have r0 = 0 and we set γ0 := +∞ by convention. We set
        O := {x ∈ K | γx > 0}       and          p := {x ∈ K | γx > 0}.
Then it is easily verified that O is a valuation ring in K, that is, O is a
subring of K such that, for any 0 6= x ∈ K, we have x ∈ O or x−1 ∈ O.
Furthermore, O is a local ring with maximal ideal p. The group of units in
O is given by
                       O× = {x ∈ O | rx 6= 0, γx = 0}.
Note that we have
                    O ∩ R[Γ] = R[Γ]>0 := heγ | γ > 0iR ,
                     p ∩ R[Γ] = R[Γ]>0 := heγ | γ > 0iR .
We have a well-defined R-linear ring homomorphism O → R with kernel p.
The image of x ∈ O in R is called the constant term of x. Thus, the constant
term of x is 0 if x ∈ p; the constant term equals rx if x ∈ O× .
   Extending scalars from A to K, we obtain a finite dimensional K-algebra
HK , with basis {Tw | w ∈ W } and multiplication as specified in Section 1.
We have:
Remark 3.1. The algebra HK is split semisimple and abstractly isomorphic
to the group algebra of W over K.
Proof. Since the situation here is somewhat more general than usual, let
us indicate the main ingredients. To show that HK is semisimple, we use
the R-linear ring homomorphism θ : R[Γ] → R such that θ(eγ ) = 1 for all
γ ∈ Γ. By extension of scalars, we obtain R ⊗R[Γ] H ∼   = R[W ], the group
algebra of W over R. Since the latter algebra is known to be semisimple,
a standard argument (using Tits’ Deformation Theorem) shows that HK
must be semisimple, too. (See, for example, [15, 7.4.6 and 8.1.7].) But then
it is also known that HK is split and abstractly isomorphic to K[W ]; see
[15, 9.3.5 and 9.3.9] and the references there.                           
                                  Lusztig’s a-function                        11

   Let Irr(HK ) be the set of irreducible characters of HK . We write this set
in the form
                           Irr(HK ) = {χλ | λ ∈ Λ},
where Λ is some finite indexing set. The algebra HK is symmetric with
respect to the trace function τ : HK → K defined by τ (T1 ) = 1 and τ (Tw ) =
0 for 1 6= w ∈ W (see Section 2). The fact that HK is split semisimple yields
that
                       X 1
                   τ=          χλ     where 0 6= cλ ∈ R[Γ].
                            cλ
                       λ∈Λ
The elements cλ are called thePSchur elements. By [15, 8.1.8], we have
cλ = PW,L /Dλ where PW,L = w∈W e2L(w) is the Poincaré polynomial of
W, L and Dλ is the “generic degree” associated with χλ . We can write
        cλ = rλ e−2αλ fλ         where rλ ∈ R>0 , fλ ∈ I>0 and αλ > 0.
The element αλ ∈ Γ is called the generalized a-invariant of χλ ; see [10, §3].
(Note that the notation in [loc. cit.] has to be adapted to the present setting
where we write the elements of R[Γ] exponentially.)
   By [10, Prop. 4.3], every χλ is afforded by a so-called orthogonal repre-
sentation. This means that there exists a matrix representation Xλ : HK →
Mdλ (K) with character χλ and an invertible diagonal matrix P ∈ Mdλ (K)
such that the following conditions hold:
  (O1) We have Xλ (Tw−1 ) = P −1 · Xλ (Tw )tr · P for all w ∈ W , and
  (O2) the diagonal entries of P lie in I>0 .
This has the following consequence. Let λ ∈ Λ and 1 6 i, j 6 dλ . For any
h ∈ HK , we denote by Xijλ (h) the (i, j)-entry of the matrix Xλ (h). Then, by
[10, Theorem 4.4 and Remark 4.5], we have
        eαλ Xij
             λ (Tw ) ∈ O,        eαλ Xij
                                      λ (Cw ) ∈ O,       eαλ Xij
                                                              λ (Dw ) ∈ O
for any w ∈ W and
              eαλ Xij         αλ ij        αλ ij
                   λ (Tw ) ≡ e Xλ (Cw ) ≡ e Xλ (Dw ) mod p.
Hence, the above three elements of O have the same constant term which
we write as εw cij                     ij
                  w,λ . The constants cw,λ ∈ R are called the leading matrix
coefficients of Xλ . By [10, Theorem 4.4], these coefficients have the following
property:
                     cij     ji
                      w,λ = cw −1 ,λ        for all w ∈ W ,
                     cij
                      w,λ 6= 0              for some w ∈ W .
Furthermore, we have
    αλ = min{γ > 0 | eγ Xij
                         λ (Tw ) ∈ O for all w ∈ W and 1 6 i, j 6 dλ }
       = min{γ > 0 | eγ Xij
                         λ (Cw ) ∈ O for all w ∈ W and 1 6 i, j 6 dλ }
       = min{γ > 0 | eγ Xij
                         λ (Dw ) ∈ O for all w ∈ W and 1 6 i, j 6 dλ }.
12                               Geck and Iancu

The leading matrix coefficients satisfy the following Schur relations. Let
λ, µ ∈ Λ, 1 6 i, j 6 dλ and 1 6 k, l 6 dµ ; then
                                    
                    X ij
                              kl      δik δjl rλ if λ = µ,
                        cw,λ cw,µ =
                                           0     if λ 6= µ;
                   w∈W
                                                  2
                                           P
see [10, Theorem 4.4]. Since |W | =          λ∈Λ dλ , we can invert the above
relations and obtain another set of relations (analogous to the “second”
orthogonality relations for the characters of a finite group): For any y, w ∈
W we have
                         dλ                 
                   XX        1 ij ij          1 if y = w,
                                cy,λ cw,λ =
                             rλ               0 if y 6= w.
                   λ∈Λ i,j=1
                                                      S
The above relations immediately imply that W = λ∈Λ Tλ , where we set

              Tλ := {w ∈ W | cij
                              w,λ 6= 0 for some 1 6 i, j 6 dλ }.

The leading matrix coefficients are related to the left cells of W by the
following result. Recall that, given a left cell C, we have a corresponding left
cell module [C]A . Extending scalars from A to K, we obtain an HK -module
[C]K . We denote by χC the character of [C]K . Then we have:
Proposition 3.2 (See [10, Prop. 4.7]). Let λ ∈ Λ and C be a left cell in W .
Denote by [χC : χλ ] the multiplicity of χλ in χC. Then we have
            dλ X
            X
                (cik   2
                  y,λ ) = [χC : χλ ] rλ ,         for any 1 6 i 6 dλ .
            k=1 y∈C

In particular, if w ∈ Tλ , then χλ occurs with non-zero multiplicity in χC,
where C is the left cell containing w.
Proof. The formula is proved in [loc. cit.]. Now fix λ ∈ Λ and let w ∈ Tλ ;
then cij
      w,λ 6= 0 for some 1 6 i, j 6 dλ . Let C be the left cell containing w.
Now all terms on the left hand side of the formula are non-negative, and the
term corresponding to y = w and k = j is strictly positive. Hence the left
hand side is non-zero and so [χC : χλ ] 6= 0.                             

   The Schur relations lead to particularly strong results when some addi-
tional hypotheses are satisfied. These are isolated in the following definition.
Definition 3.3. We say that H is integral if
            cij
             w,λ ∈ Z      for all w ∈ W , λ ∈ Λ and 1 6 i, j 6 dλ .

Furthermore, recall that cλ = rλ e−2αλ fλ , where rλ is a positive real number
and fλ ∈ I>0 . We say that H is normalized if
                           rλ = 1     for all λ ∈ Λ.
                                Lusztig’s a-function                            13

Remark 3.4. Suppose that H is normalized and that Lusztig’s conjectures
(P1)–(P15) in [21, Chap. 14] are satisfied. Then we necessarily have that
χC ∈ Irr(HK ) for all left cells C in W ; see [12, Cor. 4.8]. Thus, the conditions
in Definition 3.3 should be considered as rather severe restrictions on the
structure of H.
   Since the Schur elements cλ are known in all cases (see the appendices
of Carter [4] and Geck–Pfeiffer [15], for example) the condition that H be
normalized is rather straightforward to verify. The condition that H be
integral is more subtle. Let us describe here a convenient setting in which
this condition can be dealt with. Let λ ∈ Λ and assume that we have a
matrix representation Yλ : HK → Mdλ (K) affording χλ such that Yλ is
integral, in the sense that
                     Yλ (Tw ) ∈ Md (A)        for all w ∈ W .
Furthermore, assume that there is a symmetric matrix Ω = (ωij ) ∈ Mdλ (A)
satisfying the following two conditions:
  (F1) We have Yλ (Tw−1 ) = Ω−1 · Yλ (Tw )tr · Ω for all w ∈ W , and
  (F2) all principal minors of Ω lie in 1 + A>0 .
Note that 1 + A>0 = A ∩ I>0 .
Lemma 3.5. In the above setting, there is an orthogonal representation
Xλ : HK → Mdλ (K) affording χλ such that the corresponding leading co-
efficients satisfy cij
                    w,λ ∈ Z for all w ∈ W and 1 6 i, j 6 dλ . We have
Xλ (Tw ) ∈ Mdλ (K0 ), where K0 is the field of fractions of A.
Proof. Let R := {f /g | f ∈ A, g ∈ 1 + A>0 } ⊆ K, a subring of K.
   Now we consider the system of equations Πtr ·Z ·Π = Ω, where Π = (πij ) is
an upper triangular matrix with 1 on the diagonal (and unknown coefficients
above the diagonal) and Z = (zij ) is a diagonal matrix (with unknown
coefficients on the diagonal). It is well-known and easy to see that the
above system has a unique solution (Π, Z), where zii ∈ R× for all i and
πij ∈ R for all i < j. (Note that all principal minors of Ω are invertible
in R.) Since Ω and Z have the same principal minors, there exists some
f ∈ 1 + A>0 such that
                       f zii ∈ 1 + A>0 ⊆ I>0           for all i.
We set P := f Z and define Xλ by
               Xλ (Tw ) := Π · Yλ (Tw ) · Π−1           for all w ∈ W .
Then, clearly, Xλ affords χλ , and a straightforward computation yields
            Xλ (Tw−1 ) = Z −1 · Xλ (Tw )tr · Z = P −1 · Xλ (Tw )tr · P.
So Xλ and P satisfy the conditions (O1) and (O2). Now note that Π (being
triangular with 1 on the diagonal) is invertible over R; let us denote
           Π−1 = (π̃ij )     where π̃ii = 1 and π̃ij ∈ R for all i, j.
14                                      Geck and Iancu

Hence, for any 1 6 i, j 6 dλ , we obtain
                                        dλ
                                     dλ X                          
                      Xij
                                     X
                 αλ
                e      λ (Tw )   =             πik π̃lj eαλ Ykl
                                                             λ (Tw ) ∈ R.
                                     k=1 l=1

On the other hand, Xλ is an orthogonal representation; hence the above
element lies in O ∩ R. Consequently, the corresponding leading matrix co-
efficient cij
           w,λ will lie in Z, as required.                             

Example 3.6. Let W = Wn and L : Wn → Γ be as in Example 1.1 (the
“asymptotic case” in type Bn ). Let Hn be the corresponding Iwahori–Hecke
algebra and write Hn,K = K⊗A Hn . Then we have a natural parametrization
                             Irr(Hn,K ) = {χλ | λ ∈ Λn }
where Λn is the set of all bipartitions λ = (λ1 , λ2 ) such that |λ1 | + |λ2 | = n;
see [15, Chap. 5]. For any (λ1 , λ2 ) ∈ Λn , we have
     r(λ1 ,λ2 ) = 1   and α(λ1 ,λ2 ) = b |λ2 | + a (n(λ1 ) + 2n(λ2 ) − n(λ∗2 )),
                                         (i) for any partition ν = (ν (1) > · · · >
                            P
where we set n(ν) =           i (i − 1)ν
ν (r) > 0) and where ν ∗ denotes the conjugate partition. Thus, Hn is nor-
malized. (For the proof, see [10, Remark 5.1] and the references there.
Actually, in [loc. cit.], we only consider the “generic asymptotic case”. But
it is readily checked, using the formula for cλ in [4, p. 447], that the above
formulas also hold in the “asymptotic case”. For a weight function with
values in Z, explicit formulas for r(λ1 ,λ2 ) and α(λ1 ,λ2 ) are given by Lusztig
[21, Prop. 22.14]; then it is a purely combinatorial exercise to show that, in
the case b > (n − 1)a, Lusztig’s formulas can be rewritten as above.)
    Furthermore, by the discussion in [10, §5], Hn is integral. Since that
discussion is somewhat sketchy (and only deals with the “generic asymp-
totic case”), let us add a more rigorous argument, based on Dipper–James–
Murphy [6], [7] and Lemma 3.5. That argument also shows that we can
work with the field of fractions of A instead of K.
    Let λ ∈ Λn and S̃ λ be the corresponding Specht module over K, as con-
structed in [6, 4.19]. The modules S̃ λ are absolutely irreducible and pairwise
non-isomorphic [6, 4.22]. Let Tλ be the set of standard bitableaux of shape
λ. Then S̃ λ has a standard basis {et | t ∈ Tλ } such that the corresponding
matrix representation is integral in the above sense. Furthermore, by [6, §5],
there is a non-degenerate bilinear form h , iλ on S̃ λ , satisfying the condition
hTs x, x′ iλ = hx, Ts x′ iλ for all x, x′ ∈ S̃ λ and all s ∈ S. The Gram matrix
of h , iλ with respect to the standard basis of S̃ λ has coefficients in A and
a non-zero determinant. We will have to slightly modify the standard basis
of S̃ λ in order to make sure that (F1) and (F2) hold for the corresponding
matrix representation.
    Now, by [6, Theorem 8.11], there is an orthogonal basis {ft | t ∈ Tλ } with
respect to the above bilinear form; moreover, the matrix transforming the
                                       Lusztig’s a-function                                  15

standard basis into the orthogonal basis is triangular with 1 on the diagonal3.
Using the recursion formula in [7, Proposition 3.8], it is straightforward to
show that, for each basis element ft , there exist integers st , ati , btj , ctk , dtl ∈ Z
such that
            ati > 0,          btj > 0,          b + ctk a > 0,              b + dtl a > 0,
and
                                                                         2(b+ctk a)
                                  (1 + e2a + · · · + e2ati a )
                                                                 Q                  
                                                                   k 1+e
                              Q
                     2st a      i
      hft , ft iλ = e        ·Q         2a            2btj a )
                                                               · Q      2(b+dtl a)
                                                                                   .
                                j (1 + e + · · · + e               l 1+e
The fact that b + ctk a and b + dtl a are strictly positive essentially relies on
the condition that b > (n − 1)a. Hence, setting
                     Y                              Y                  
     f˜t := e−st a ·    (1 + e2a + · · · + e2btj a ) ·  (1 + e2(b+dtl a) ) · ft ,
                        j                                           l

we obtain hf˜t , f˜t iλ ∈ 1 + A>0 for all t. Now let
                              ẽt = e−st a et            for all t ∈ Tλ .
Then {ẽt | t ∈ Tλ } is a new basis of          S̃ λ .
                                           Let Yλ be the corresponding matrix
representation and Ω be the corresponding Gram matrix of h , iλ . Then Yλ
is still integral, Ω has coefficients in A and (F1) holds. Now, the matrix
transforming ẽt to the basis f˜t is triangular with quotients of elements from
1+A>0 on the diagonal. Hence, up to quotients of elements from 1+A>0 , the
principal minors of Ω are products of terms hf˜t , f˜t iλ ∈ 1 + A>0 , for various t.
We conclude that each principal minor of Ω is a quotient of elements from
1 + A>0 . Since, on the other hand, the coefficients of Ω lie in A, so do all
principal minors of Ω. Hence (F2) holds. So Lemma 3.5 shows that Hn is
integral.
Remark 3.7. In the above setting, consider the special case where Γ = Z
and A is the ring of Laurent polynomials in v = e1 . The parabolic subgroup
Sn := hs1 , . . . , sn−1 i ⊆ Wn can be identified with the symmetric group
on {1, . . . , n} where si corresponds to the basic transposition (i, i + 1) for
1 6 i 6 n − 1. Let H(Sn ) ⊆ Hn be the corresponding parabolic subalgebra.
We have the following diagram:
                              s1         s2                             sn−1
              Sn                ✐         ✐              · · ·           ✐
              L:               a          a                             a
Now, by Hoefsmit [16, §2.3], we obtain a complete set of irreducible repre-
sentations of H(Sn )K by restricting the irreducible representations of Hn,K
with label of the form λ = (λ1 , ∅), where λ1 is a partition of n. Hence, the
fact that Hn is integral and normalized immediately implies that H(Sn ) is
  3It is remarked in [6] that the orthogonal representation with respect to the basis {f }
                                                                                        t
actually coincides with the one defined by Hoefsmit [16].
16                                       Geck and Iancu

integral and normalized, too. Alternatively, one could also work directly
with the Dipper–James construction of Hoefsmit’s matrices for type An−1
in [5, Theorem 4.9].
     The following arguments are inspired from the proof of [10, Theorem 4.10].
Lemma 3.8. Assume that H is integral and normalized.
      (a) We have cij
                    w,λ ∈ {0, ±1} for all w ∈ W , λ ∈ Λ and 1 6 i, j 6 dλ .
      (b) For any λ ∈ Λ and 1 6 i, j 6 dλ , there exists a unique w ∈ W
          such that cij
                     w,λ 6= 0; we denote that element by w = wλ (i, j). The
          correspondence (λ, i, j) 7→ wλ (i, j) defines a bijective map
                       {(λ, i, j)} | λ ∈ Λ, 1 6 i, j 6 dλ } −→ W.
In particular, the sets Tλ defined above form a partition of W :
                    a
             W =       Tλ      and     |Tλ | = d2λ for all λ ∈ Λ.
                        λ∈Λ

Proof. First we construct the desired map in (b). Fix λ ∈ Λ and 1 6 i, j 6
dλ . Then consider the Schur relation where λ = µ, i = l and j = k:
                           X ij
                                (cw,λ )2 = rλ = 1.
                                   w∈W
Since the leading matrix coefficients are integers, we conclude that there
exists a unique w = wλ (i, j) such that cij                 ij
                                             w,λ = ±1 and cy,λ = 0 for all
y ∈ W \ {w}. Thus, we have a map (λ, i, j) 7→ w = wλ (i, j); furthermore,
note that once we have shown that this map is bijective, then (a) follows.
  Next we show that the above map is surjective. Let w ∈ W . Then the
“second Schur relations” show that there exist some λ ∈ Λ and 1 6 i, j 6 dλ
such that cij
           w,λ 6= 0. The previous argument implies that w = wλ (i, j). Thus,
the above map is surjective. Since dim HK = |W | = λ∈Λ d2λ , that map is
                                                      P
between finits sets of the same cardinality. Hence, the map is bijective. 
Remark 3.9. In the setting of Lemma 3.8, let λ ∈ Λ and consider the set
Tλ . First of all, we have a unique labelling of the elements in Tλ :
                              Tλ = {wλ (i, j) | 1 6 i, j 6 dλ }.
It follows from [10, Theorem 4.4(b)] that
(a)                                wλ (i, j)−1 = wλ (j, i).
In particular, wλ (i, j) is an involution if and only of i = j. Furthermore, let
i, j ∈ {1, . . . , dλ } and define
        j
(b)         Tλ := {wλ (k, j) | 1 6 k 6 dλ } and Tiλ := {wλ (i, l) | 1 6 l 6 dλ }.
It is shown in [10, Theorem 4.10] that j Tλ is contained in a left cell of W
and Tjλ is contained in a right cell of W . In particular, the whole set Tλ is
contained in a two-sided cell of W .
                                Lusztig’s a-function                           17

Lemma 3.10. Assume that H is integral and normalized. Furthermore,
assume that χC ∈ Irr(HK ) for all left cells C of W . Then the sets
                          {j Tλ | λ ∈ Λ, 1 6 j 6 dλ }
are precisely the left cells of W . The character of the left cell representation
afforded by j Tλ is given by χλ . Furthermore, each left cell contains a unique
involution.
Proof. Let λ ∈ Λ and 1 6 j 6 dλ . By Remark 3.9, there is a left cell C
of W such that j Tλ ⊆ C. Now Proposition 3.2 shows that χλ occurs with
non-zero multiplicity in χC. Since χC ∈ Irr(HK ), we conclude that χC = χλ .
In particular, this means that the underlying HK -modules have the same
dimension and so |C| = χλ (1) = dλ . Consequently, we have C = j Tλ . Thus,
we have shown that each set j Tλ is a left cell of W . Since these sets form a
partition of W , we conclude that they are precisely the left cells of W . The
statement concerning involutions now follows from Remark 3.9(a).            
Example 3.11. Let W = Wn and L : Wn → Γ be as in Example 1.1 (the
“asymptotic case” in type Bn ). We have already noted in Example 3.6 that
Hn is integral and normalized. Thus, by Lemma 3.8, we have a partition
                                  a
                         Wn =            T(λ1 ,λ2 ) .
                                  (λ1 ,λ2 )∈Λn

Let us identify the sets T(λ1 ,λ2 ) . For this purpose, we need the results of
Bonnafé–Iancu [2] concerning the left cells of Wn and their characters. These
results remain valid in the “asymptotic case” by Bonnafé [3, §5]. More pre-
cisely, in [2, Theorem 7.7], the left cells in the “generic asymptotic case”
(that is, with respect to the weight function L0 : Wn → Γ0 ) are described in
terms of a generalized Robinson–Schensted correspondence. In [3, Cor. 5.2],
it is shown that two elements of Wn lie in the same left cell with respect
to L : Wn → Γ if and only if this is the case with respect to L0 . Hence
the combinatorial description of the left cells remains valid in the “asymp-
totic case”. The fact that the characters afforded by the left cells are all
irreducible now follows by exactly the same argument as in [2, Prop. 7.9].
   Now let C be a left cell. Then C is precisely the set of elements in a gen-
eralized Robinson–Schensted cell (RS-cell for short). Such a cell is labelled
by a pair of bitableaux of the same shape and size n. Let (λ1 , λ2 ) ∈ Λn be
the bipartition specifying the shape of the bitableaux. Then we have
                          χC = χ(λ1 ,λ∗2 ) ∈ Irr(Hn,K ).
(Note that, in [2, Prop. 7.11], the labelling is given by (λ2 , λ∗1 ). The reason
for the different labelling is that, in [2], the left cell representations are
defined using the C ′ -basis while here we use the C-basis. As explained in
Remark 2.2, the character of the left cell representation defined with respect
to the C ′ -basis is given by χC ◦ δ. On the level of characters of Wn , this
corresponds to tensoring with the sign character; see [15, 9.4.1] for a precise
18                                  Geck and Iancu

statement and more details. The effect of tensoring with the sign character
is described in [15, 5.5.6].) Now we claim that
      T(λ1 ,λ∗2 ) = {w ∈ W | w belongs to an RS-cell of shape (λ1 , λ2 )}.
Indeed, let w ∈ T(λ1 ,λ∗2 ) . Then, by Proposition 3.2, the character χ(λ1 ,λ∗2 )
occurs with non-zero multiplicity in χC, where C is the left cell containing
w. So the above formula for χC shows that w belongs to an RS-cell of shape
(λ1 , λ2 ). The reverse implication now follows formally from the fact that
both the sets T(λ1 ,λ2 ) and the RS-cells form a partition of W .

                       4. On Lusztig’s conjectures
   We keep the setting of the previous section. Now our aim is to de-
velop some tools and criteria for attacking the properties in Conjecture 2.3.
Throughout this section, we assume that
            H is integral and normalized (see Definition 3.3).
We begin with an alternative characterization of the a-function. First note
that
             a(z) = min{γ > 0 | eγ hx,y,z ∈ O for all x, y ∈ W }
for any z ∈ W . This simply follows from the equality O ∩ A = A>0 .
Proposition 4.1. For any z ∈ W , we have
     a(z) = min{γ > 0 | eγ Xij
                            λ (Dz −1 ) ∈ O for all λ ∈ Λ, 1 6 i, j 6 dλ }.
Furthermore, if z ∈ Tλ0 (see Lemma 3.8), we have αλ0 6 a(z).
Proof. Let γ0 > 0 be minimal such that eγ0 Xij        λ (Dz −1 ) ∈ O for all λ ∈ Λ,
1 6 i, j 6 dλ . First we show that a(z) 6 γ0 . For this purpose, it is enough
to show that eγ0 hx,y,z ∈ O for all x, y ∈ W . Let x, y ∈ W . To evaluate
hx,y,z , we use the formula
                                                 X 1
            εx εy εz hx,y,z = τ (Cx Cy Dz −1 ) =        χλ (Cx Cy Dz −1 )
                                                     cλ
                                                 λ∈Λ
                              X 1                                     
                            =        trace Xλ (Cx )Xλ (Cy )Xλ (Dz −1 )
                                  cλ
                              λ∈Λ
                             dλ
                                 1 ij
                                  X (Cx ) Xjk
                           X X
                                                    ki
                         =                 λ (Cy ) Xλ (Dz −1 ).
                                cλ λ
                              λ∈Λ i,j,k=1

Now, for any λ ∈ Λ, we have rλ = 1 and so cλ = e−2αλ fλ where fλ ∈ I>0 .
Thus, we obtain
                    dλ                                                
                       fλ−1 eαλ Xij           αλ jk
              X X
  γ0                                                         γ0 ki
 e hx,y,z = ±                    λ  (C x )   e  Xλ  (C y )  e  Xλ  (Dz −1 ) .
                λ∈Λ i,j,k=1
As we have already noted, for all w ∈ W , we have
                        eαλ Xij            ij
                             λ (Cw ) ≡ εw cw,λ       mod p.
                                        Lusztig’s a-function                              19

Hence, since fλ−1 ∈ O, all terms on the right hand side of the above identity
lie in O. So we obtain eγ0 hx,y,z ∈ O as desired. Next we show that γ0 6 a(z).
By the definition of γ0 , there exists some λ0 ∈ Λ such that
          eγ0 Xkλ00i0 (Dz −1 ) 6≡ 0      mod p          for some 1 6 i0 , k0 6 dλ0 .

We also know by Lemma 3.8 that there exist x0 , y0 ∈ W such that cix00k,λ0 0 =
±1 and cyk00,λ
            k0
              0
                = ±1. As before, we obtain an identity
                       dλ                                                            
                                   fλ−1 eαλ Xij            αλ jk
                     X X
eγ0 hx0 ,y0 ,z = ±                           λ  (C x 0 )  e  Xλ  (C y 0 )  eγ0 ki
                                                                              Xλ  (Dz −1 ) .
                     λ∈Λ i,j,k=1

All terms on the right hand side lie in O. So we obtain
                                  dλ                                      
                                              cij    jk
                                X X
          eγ0 hx0 ,y0 ,z ≡ ±                        c
                                               x0 ,λ y0 ,λ  eγ0 ki
                                                               Xλ  (Dz −1 )  mod p;
                                λ∈Λ i,j,k=1

note that fλ−1 ≡ 1 mod p since fλ ∈ I>0 . Now, by Lemma 3.8, we have
                           cij
                            x0 ,λ 6= 0 ⇒ (λ, i, j) = (λ0 , i0 , k0 ),

                           cjk
                            y0 ,λ 6= 0 ⇒ (λ, j, k) = (λ0 , k0 , k0 ).

Hence we obtain
                                                                               
                     eγ0 hx0 ,y0 ,z ≡ ±cix00k,λ0 0 cyk00,λ
                                                        k0
                                                          0
                                                              eγ0 k0 i0
                                                                 Xλ0    (Dz −1 )
                                    ≡ ±eγ0 Xkλ00i0 (Dz −1 ) 6≡ 0 mod p
Consequently, we must have γ0 6 a(z) and so γ0 = a(z).
  Finally, if z ∈ Tλ0 , then cij
                              z,λ0 = ±1 for some i, j. Since

               εz eαλ0 Xji             ji          ij
                        λ0 (Dz −1 ) ≡ cz −1 ,λ0 ≡ cz,λ0 ≡ ±1               mod p,
we conclude that a(z) > αλ0 .                                                             
Definition 4.2. Recall that H is assumed to be normalized and integral.
Let z ∈ W . Then we set
                              αz := αλ ,
where λ is the unique element of Λ such that z ∈ Tλ ; see Lemma 3.8. By
Proposition 4.1, we have αz 6 a(z) for all z ∈ W .
   The following result shows that the identity a(z) = αz holds for z ∈ W
once we know that (P4) from the list of Lusztig’s conjectures holds. Note,
however, that it seems to be very hard to prove (P4) directly. Therefore,
in Lemma 4.4 below, we shall establish a somewhat different criterion for
proving that the identity a(z) = αz holds for all z ∈ W (and it is this latter
criterion which will be used in Section 5 in dealing with type Bn ).
Lemma 4.3. Assume that (P4) holds. Then a(z) = αz for all z ∈ W .
20                                  Geck and Iancu

Proof. Let z ∈ W . We already know by Proposition 4.1 that αz 6 a(z). To
prove the reverse inequality, let x, y ∈ W be such that ea(z) hx,y,z ∈ A>0 has
a non-zero constant term. As in the proof of Proposition 4.1, we have
                               dλ                             
                                    cij  jk
                        X X
          a(z)                                 a(z) ki
        e hx,y,z ≡ ±                    c
                                     x,λ y,λ  e    Xλ  (Dz −1 )  mod p.
                           λ∈Λ i,j,k=1
We are assuming that the left hand side is 6≡ 0 mod p. So there exists some
λ0 ∈ Λ and 1 6 i, j, k 6 dλ0 such that cij          jk
                                        x,λ0 6= 0, cy,λ0 6= 0 and

(†)                        ea(z) Xki
                                  λ0 (Dz −1 ) 6≡ 0 mod p.
The condition (†) implies that αλ0 > a(z). Furthermore, we have x, y ∈ Tλ0
and so a(x) > αλ0 , a(y) > αλ0 by Proposition 4.1. Hence we obtain
                                a(x) > αλ0 > a(z).
But, since hx,y,z 6= 0, we have z 6R x and so a(x) 6 a(z), thanks to the
assumption that (P4) holds. Thus, we conclude that a(z) = αλ0 . But then
(†) also yields that cik       ki
                       z,λ0 = cz −1 ,λ0 6= 0 and so z ∈ Tλ0 . Thus, we have
a(z) = αλ0 = αz , as claimed.                                            
Lemma 4.4. Assume that the following implication holds for any x, y ∈ W :
(♣)                      x 6LR y            ⇒        αy 6 αx .
Then we have a(z) = αz for all z ∈ W (and, consequently, (P4) holds).
Proof. Let z ∈ W . By Proposition 4.1, we already know that αz 6 a(z);
furthermore, in order to prove equality, it will be enough to show that
            eαz Xij
                 λ (Dz −1 ) ∈ O          for all λ ∈ Λ and 1 6 i, j 6 dλ .
To prove this, let λ ∈ Λ be such that Xij    λ (Dz −1 ) 6= 0 for some i, j. Let C be a
left cell such that [χC : χλ ] 6= 0, that is, χλ occurs with non-zero multiplicity
in the character afforded by C. Then Xλ will occur (up to equivalence) in the
decomposition of XC as a direct sum of irreducible representations. Hence,
since Xλ (Dz −1 ) 6= 0, we will also have XC(Dz −1 ) 6= 0. Recalling the definition
of XC, we deduce that there exists some x ∈ C such that Dz −1 Cx 6= 0. Since
τ is non-degenerate, we have
                    τ (Dz −1 Cx Cw ) 6= 0       for some w ∈ W .
This yields ±hx,w,z = τ (Cx Cw Dz −1 ) = τ (Dz −1 Cx Cw ) 6= 0 and so z 6R x.
Hence (♣) implies that αx 6 αz . Now we claim that αx = αλ . This can be
seen as follows. Let i ∈ {1, . . . , dλ }. Then the right hand side of the formula
in Proposition 3.2 is non-zero and so there exists some y ∈ C and some k
such that cik
            y,λ 6= 0. Consequently, we have y ∈ Tλ and so αy = αλ . On the
other hand, (♣) implies that the function w 7→ αw is constant on two-sided
cells. Hence we can deduce that αx = αy = αλ , as claimed.
   Now the inequality αx 6 αz yields αλ 6 αz and so
                   eαz Xij            αλ ij
                        λ (Dz −1 ) = e Xλ (Dz −1 ) e
                                                    αz −αλ
                                                           ∈ O,
                                        Lusztig’s a-function                    21

as desired.                                                                     
  We will now show that the validity of the identity a(z) = αz for all z ∈ W
together with (P4) formally imply most of the remaining conjectures from
the list (P1)–(P15).
  We introduce the following notation. Let x, y ∈ W . By Lemma 3.8, we
can write x = wλ (i0 , j0 ) and y = wµ (k0 , l0 ) where λ, µ ∈ Λ, 1 6 i0 , j0 6 dλ
and 1 6 k0 , l0 6 dµ are uniquely determined. Then we set
                 z = x ⋆ y := wλ (l0 , i0 )          if λ = µ and j0 = k0 .
We note the following equivalences for x, y, z ∈ Tλ :
(♥)                 z =x⋆y         ⇔       x=y⋆z           ⇔   y = z ⋆ x.
If z = x ⋆ y as above, we also set
                                        i0 j0 j0 l0 l0 i0
                              nx,y,z = cx,λ  cy,λ cz,λ = ±1.
Note that (♥) implies nx,y,z = ny,z,x = nz,x,y . With this notation, we now
have the following result.
Lemma 4.5. Assume that (P4) holds. Let x, y, z ∈ W . If there is no λ ∈ Λ
such that x, y, z ∈ Tλ , then γx,y,z = 0. If x, y, z ∈ Tλ , then
                                       
                                          nx,y,z        if z = x ⋆ y,
           γx,y,z = γy,z,x = γz,x,y =
                                             0          otherwise.
Proof. By Remark 2.4, we have a(z) = a(z −1 ). This yields
                             γx,y,z ≡ ea(z) hx,y,z −1
                                                    mod p.
                    = εx εy εz τ (Cx Cy Dz ) and τ = µ c−1
                                                     P
Writing hx,y,z −1                                        µ χµ , we obtain
                           dµ                                    
                         X X
              γx,y,z ≡                 cij cjk
                                        x,µ y,µ  εz ea(z) ki
                                                         Xµ  (Dz )     mod p;
                         µ∈Λ i,j,k=1

see the argument in the proof of Proposition 4.1. Now, if there is no λ such
that x, y ∈ Tλ , then the above sum certainly is zero.
   Hence it remains to consider the case where x, y ∈ Tλ for some λ ∈ Λ
(which is uniquely determined). We write x = wλ (i0 , j0 ) and y = wλ (k0 , l0 ),
where 1 6 i0 , j0 , k0 , l0 6 dλ are uniquely determined. Then the above sum
reduces to
                                                              
                               i0 j0 k0 l0
            γx,y,z ≡ δj0 k0 cx,λ    cy,λ εz ea(z) Xlλ0 i0 (Dz )  mod p.
First assume that z = x ⋆ y, that is, we have j0 = k0 and z = wλ (l0 , i0 ). In
particular, z ∈ Tλ and so a(z) = αλ by Lemma 4.3. Hence, we obtain
                                   i0 j0 k0 l0 l0 i0
                         γx,y,z = cx,λ  cy,λ cz,λ = nx,y,z = ±1,
as desired.
   Conversely, assume that γx,y,z 6= 0. First of all, this means that j0 = k0 .
Furthermore, the constant term of ea(z) Xlλ0 i0 (Dz ) is non-zero and so αλ >
22                                      Geck and Iancu

a(z). On the other hand, we have hx,y,z −1 6= 0 and so z −1 6R x. Hence
(P4) yields a(z) = a(z −1 ) > a(x) = αλ (since x ∈ Tλ ) and so a(z) = αλ .
Consequently, the constant term of εz ea(z) Xlλ0 i0 (Dz ) is clz,λ
                                                                0 i0
                                                                     and so
                                            i0 j0 j0 l0 l0 i0
                             0 6= γx,y,z = cx,λ  cy,λ cz,λ .
Hence, we must have j0 = k0 and z = x ⋆ y.
  The identity γx,y,z = γy,z,x = γz,x,y easily follows from the symmetry in
(♥).                                                                     
Lemma 4.6. Assume that (P4) holds. Then (P1), (P2), (P3), (P5), (P6),
(P7), (P8) and (P14) hold.
Proof. (P1) Let z ∈ W . We must show a(z) 6 ∆(z). Now, by the definition
of the symmetrizing trace τ , we have
                                                       ∗
                              τ (Cz ) = εz P 1,z .
                                      P −1
On the other hand, we have τ =          λ cλ χλ . Using the expression cλ =
e−2αλ fλ where fλ−1 ∈ O, this yields the identity
                                   dλ
                        ∗         XX
                   εz P 1,z   =                fλ−1 (eαλ Xii        αλ
                                                          λ (Cz )) e .
                                  λ∈Λ i=1
Assume that the term in the sum corresponding to λ ∈ Λ and 1 6 i 6 dλ
is non-zero. Let C be a left cell such that [χC : χλ ] 6= 0, that is, χλ occurs
with non-zero multiplicity in the character afforded by C. Then Xλ will occur
(up to equivalence) in the decomposition of XC as a direct sum of irreducible
representations. Hence, since Xλ (Cz ) 6= 0, we will also have XC(Cz ) 6= 0.
Recalling the definition of XC, we deduce that there exist some x, y ∈ C such
that hz,x,y 6= 0. But then we have y 6R z and so a(z) 6 a(y), by (P4). Now,
as in the proof of Lemma 4.4, we conclude that a(y) = a(y ′ ) = αλ , where
y ′ ∈ C is chosen such that cik
                             y ′ ,λ 6= 0 for some k. Hence, we have a(z) 6 αλ
for all non-zero terms in the above sum. Thus, we obtain
                                 dλ
                    ∗          X X
         εz e−a(z) P 1,z =                     fλ−1 (eαλ Xii
                                                          λ (Cz )) e
                                                                    αλ −a(z)
                                                                             ∈ O.
                                λ∈Λ      i=1
                              a(z)6αλ

                                                                         ∗
Since the left hand side lies in A, we conclude that e−a(z) P 1,z ∈ A>0 and so
a(z) 6 ∆(z), as desired.
  (P2), (P5) Let x, y ∈ W and d ∈ D be such that γx,y,d 6= 0. We must
show that x = y −1 and γy−1 ,y,d = nd = ±1. Now, using the expression of
Cw in terms of the T -basis, we obtain
                      X                            X                ∗
         τ (Cx Cy ) =    εx εy εz hx,y,z τ (Cz ) =   εx εy hx,y,z P 1,z
                        z∈W                                z∈W
                        X
                                        a(z)           −a(z)  ∗
                   =          εx εy e          hx,y,z (e    P 1,z ).
                        z∈W
                                     Lusztig’s a-function                            23

By the definition of a(z) and (P1) (see the proof above), we have ea(z) hx,y,z ∈
                  ∗
A>0 and e−a(z) P 1,z ∈ A>0 . So the terms of the above sum lie in A>0 and
we have                         X
                   τ (Cx Cy ) ≡   εx εy γx,y,z −1 nz mod p.
                                 z∈D
By Remark 2.4, we have nz = nz −1 and D −1 = D. So the above congruence
can also be written in the form
                                X
                   τ (Cx Cy ) ≡   εx εy γx,y,z nz mod p.
                                     z∈D
Now, Lemma 4.5 shows that the only non-zero term in the above sum is
γx,y,d and that d = x ⋆ y. So we have
                   τ (Cx Cy ) ≡ εx εy γx,y,d nd 6≡ 0           mod p.
On the other hand, we also have
                          τ (Cx Cy ) ≡ δx−1 y mod A>0 ,
where δx−1 y denotes the Kronecker symbol. (This easily follows from the
defining formulas; see [21, 14.5(a)].) Hence we obtain the congruence
               δx−1 y ≡ τ (Cx Cy ) ≡ εx εy γx,y,d nd 6≡ 0            mod p.
So we must have x−1 = y. But then we also get γy−1 ,y,d nd = 1, as required.
  (P3) Let y ∈ W . We want to show that there exists a unique z ∈ D such
that γy−1 ,y,z 6= 0. As in the proof of (P2), we have
                    X
                        γy−1 ,y,z nz ≡ τ (Cy−1 Cy ) ≡ 1 mod p.
                  z∈D
Consequently, there exists some z ∈ D such that γy−1 ,y,z 6= 0. By Lemma 4.5,
z = y −1 ⋆ y is uniquely determined with this property.
  (P6) This is a formal consequence of (P2) and (P3); see [21, 14.6].
  (P7), (P8) This is clear by Lemma 4.5 and Remark 3.9.
  (P14) This is clear by Remark 3.9.                                                 
Corollary 4.7. We keep the hypotheses of Lemma 4.6. Let z ∈ D and
λ ∈ Λ be such that z ∈ Tλ . Then the constant nz = ±1 is determined by the
formula
                         εz eαλ χλ (Tz ) ≡ nz mod p.
Thus, nz is precisely the leading coefficient of a character value as defined
by Lusztig [20].
Proof. Since z ∈ D, we have z 2 = 1 and so z = wλ (i0 , i0 ) for a unique
i0 ∈ {1, . . . , dλ }. Hence we obtain
                               dλ                     dλ
                                                                    i0 i0
                               X                      X
        εz eαλ χλ (Tz ) ≡ εz         eαλ Xii
                                          λ (Tz ) ≡         cii
                                                             z,λ ≡ cz,λ     mod p.
                               i=1                    i=1
24                              Geck and Iancu


On the other hand, by (P5) and Lemma 4.5, we have nz = γz,z,z = ciz,λ
                                                                   0 i0
                                                                        , as
required.                                                                 
Lemma 4.8. We keep the hypotheses of Lemma 4.6 and assume, in addi-
tion, that χC ∈ Irr(HK ) for every left cell C of W . Then (P13) holds and
we have
                          D = {z ∈ W | z 2 = 1}.
Proof. Let C be a left cell of W . Let x ∈ C. By Lemma 4.6, (P3) holds and
so there exists a unique d ∈ D such that γx−1 ,x,d 6= 0. By (P8), we have
d ∼L x and so d ∈ C. Thus, each left cell contains an element of D. Note
that the above argument also shows that (P13) holds, once we know that
each left cell contains a unique element of D.             P
  Now, by Lemma 3.10, the total number of left cells equals λ∈Λ dλ . Thus,
we have                                X
                                |D| >      dλ .
                                      λ∈Λ
On the other hand, by a well-known result due to Frobenius–Schur, the
number on the right hand side is the number of all z ∈ W such that z 2 = 1.
(We also use the fact that every irreducible character of W can be realized
over R; see [15, 6.3.8].) Since d2 = 1 for all d ∈ D by (P6), we conclude that
                           D = {z ∈ W | z 2 = 1}
and that C contains a unique element from D.                                
  Finally, let J be the free abelian group with basis {tw | w ∈ W }. We
define a bilinear pairing on J by
                           X
                 tx · ty =    γx,y,z −1 tz for all x, y ∈ W ,
                         z∈W

where the constants γx,y,z −1 ∈ Z were introduced in Section 2.
Proposition 4.9. PAssume that (P4) holds. Then J is an associative ring
with identity 1J = z∈D nz tz . For any λ ∈ Λ, we set
                          Jλ := htw | w ∈ Tλ i ⊆ J.
Then Jλ is a two-sided
                  L ideal which is isomorphic to the matrix ring Mdλ (Z),
and we have J = λ∈Λ Jλ .
We have t2z = nz tz for any z ∈ D.
   In Example 5.7, we will see that negative coefficients actually do occur
in 1J .
Proof. By Lemma 4.6, we know that (P1)–(P8) hold. Hence J can be con-
structed as explained in [21, Chap. 18]. Now LemmaL4.5 immediately shows
that Jλ is a two-sided ideal and so we have J = λ Jλ . To establish the
stated isomorphism Jλ ∼ = Mdλ (Z), we explicitly construct a set of “matrix
                                      Lusztig’s a-function                               25

units” in Jλ . This is done as follows. Let us fix λ ∈ Λ. For any 1 6 i, j 6 dλ ,
we set
            Eλij := cij
                      w,λ tw    where w = wλ (i, j) and cij
                                                          w,λ = ±1.
Now let 1 6 i, j, k, l 6 dλ and write x = wλ (i, j), y = wλ (k, l). Then we
have
           Eλij · Eλkl = cij                  ij kl
                                                       X
                               kl
                          x,λ cy,λ tx · ty = cx,λ cy,λ   γx,y,z tz −1 .
                                                              z∈W
Now Lemma 4.5 shows that the result will be zero unless j = k. So let us
finally assume that j = k. Then we obtain
                         Eλij · Eλjl = cij   jl
                                        x,λ cy,λ γx,y,z0 tz −1 ,
                                                              0

                                      =   cij   jl li               il
                                           x,λ cy,λ cz0 ,λ γx,y,z0 Eλ ,

where z0 := x ⋆ y = wλ (l, i). By Lemma 4.5, the coefficient of Eλil in the
above expression equals 1. Thus, we have shown that
                  Eλij · Eλkl = δjk Eλil        for 1 6 i, j, k, l 6 dλ .
Hence, the elements      Eλij
                            multiply in exactly the same way as the matrix
units in Mdλ (Z), which yields the desired isomorphism.
   The formula for t2z , where z ∈ D, is obtained as follows. We have t2z =
γz,z,xtx−1 where x = z ⋆ z and γz,z,x 6= 0. By (P2), (P6), (P7), we have
γx,z,z 6= 0 and so x = z −1 = z. Then (P5) yields γz,z,z = nz = ±1.       
Remark 4.10. We keep the setting of Proposition 4.9. Let us also assume
that χC ∈ Irr(HK ) for all left cells C in W . Let x, y, z ∈ W be such that
x, y, z ∈ Tλ for some λ. Then note that, by Remark 3.9 and Lemma 3.10,
the condition z = x ⋆ y is equivalent to the conditions x ∼L y −1 , y ∼L z −1 ,
z ∼L x−1 . Thus, the multiplication rule in J can now be formulated as
follows:
                                 if x ∼L y −1 , y ∼L z −1 , z ∼L x−1 ,
                    
                      ±tz −1
          tx · ty =
                        0        otherwise.
   Summarizing the results in this section, we see that for a normalized and
integral Iwahori–Hecke algebra, property (P4) (or the variant in Lemma 4.4)
implies all the remaining properties in the list of Lusztig’s conjectures except
(P9)–(P12) and (P15).

      5. The a-function in the “asymptotic case” in type Bn
   Throughout this section, we place ourselves in the setting of Example 1.1,
where Wn is a Coxeter group of type Bn and the weight function L : Wn → Γ
is given by the following diagram:
            t       s1          s2                        sn−1
    Bn      ✐        ✐            ✐          · · ·           ✐
                                                                      b > (n − 1)a > 0
   {vs }:   eb      ea           ea                          ea
26                                      Geck and Iancu

Let Hn be the corresponding Iwahori–Hecke algebra over A where V = eb is
the parameter associated with the generator t and v = ea is the parameter
associated with the generators s1 , . . . , sn−1 of Wn . Our aim is to see that
we can apply the methods in Section 4. In Corollary 5.5, we will be able to
show that the key condition (♣) in Lemma 4.4 holds in the present setting.
   We shall need some notation from [2]. Given w ∈ Wn , we denote by ℓt (w)
the number of occurrences of the generator t in a reduced expression for w,
and call this the “t-length” of w.
   The parabolic subgroup Sn = hs1 , . . . , sn−1 i is naturally isomorphic to
the symmetric group on {1, . . . , n}, where si corresponds to the basic trans-
position (i, i + 1). For 1 6 l 6 n − 1, we set Σl,n−l := {s1 , . . . , sn−1 } \ {sl }.
For l = 0 or l = n, we also set Σ0,n = Σn,0 = {s1 , . . . , sn−1 }. Let
Yl,n−l be the set of distinguished left coset representatives of the Young
subgroup Sl,n−l := hΣl,n−l i in Sn . We have the parabolic subalgebra
Hl,n−l = hTσ | σ ∈ Sl,n−l iA ⊆ Hn .
   We denote by 6L,l the Kazhdan–Lusztig (left) pre-order relation on Sl,n−l
and by ∼L,l the corresponding equivalence relation. The symbols 6R,l ,
6LR,l , ∼R,l and ∼LR,l have a similar meaning.
   Furthermore, as in [2, §4], we set a0 = 1 and
              al := t(s1 t)(s2 s1 t) · · · (sl−1 sl−2 · · · s1 t)   for l > 0.
Then, by [2, Prop. 4.4], the set Yl,n−l al precisely is the set of distinguished
left coset representatives of Sn in Wn whose t-length equals l. Furthermore,
every element w ∈ Wn has a unique decomposition
     w = aw al σw b−1
                   w         where l = ℓt (w), σw ∈ Sl,n−l and aw , bw ∈ Yl,n−l ;
see [2, 4.6]. With this notation, we have the following result.
Theorem 5.1 (Bonnafé–Iancu [2] and Bonnafé [3, §5]). In the above setting,
let x, y ∈ Wn . Then we have x ∼L y if and only if l := ℓt (x) = ℓt (y), bx = by
and σx ∼L,l σy .
   (In [2, Theorem 7.7], the above statement is proved in the “generic as-
ymptotic case”. As already discussed in Example 3.11, this remains valid in
the “asymptotic case” by [3, Cor. 5.2].)
   We shall also need the following result on the elementary steps in the
relation 6L .
Proposition 5.2 (Bonnafé–Iancu [2] and Bonnafé [3, §5]). In the above
setting, let x, y ∈ Wn be such that x ←L y. Then we have ℓt (x) = ℓt (y) or
x = ty > y. In particular, we always have ℓt (y) 6 ℓt (x). (A similar result
holds for ←R .)
   (The precise references are Theorems 6.3, 6.6 and Corollary 6.7 in [2]
for the “generic asymptotic case”. In [3, Cor. 5.2], it is shown that, if
x ←L y with respect to L : Wn → Γ, then we also have x ←L y with
respect to L0 : Wn → Γ0 as in Example 1.1. Hence the assertions hold in
the “asymptotic case” too.)
                                         Lusztig’s a-function                           27

  As discussed in Example 3.11, let Λn be the set of bipartitions of n. Then
the partition                      a
                        Wn =             T(λ1 ,λ2 )
                                            (λ1 ,λ2 )∈Λn
is explicitly given by
      T(λ1 ,λ∗2 ) = {w ∈ Wn | w belongs to an RS-cell of shape (λ1 , λ2 )}.
Furthermore, for w ∈ T(λ1 ,λ∗2 ) , we have
             αw = α(λ1 ,λ∗2 ) = b |λ2 | + a (n(λ1 ) + 2n(λ∗2 ) − n(λ2 )).
Finally, we need the following result concerning the relation 6LR .
Theorem 5.3 (Bonnafé [3]). In the above setting, let x, y ∈ Wn be such
that l := ℓt (x) = ℓt (y). Then we have x 6LR y if and only if σx 6LR,l σy .
Furthermore, the sets T(λ1 ,λ2 ) , (λ1 , λ2 ) ∈ Λn , are precisely the two-sided cells
of Wn .
   Using known results on the two-sided cells in the symmetric group and the
Robinson–Schensted correspondence, we can translate the above statement
into a combinatorial description of the relation 6LR for Wn . To state this,
we need to introduce some notation. Recall the definition of the dominance
order on partitions in Example 2.5. Following Dipper–James–Murphy [6,
§3], we can extend this partial order to bipartitions, as follows.
   Let λ = (λ1 , λ2 ) and µ = (µ1 , µ2 ) be bipartitions of n, with parts
                (1)      (2)                                         (1)       (2)
       λ1 = (λ1 > λ1 > · · · > 0),                      λ2 = (λ2 > λ2 > · · · > 0),
                (1)      (2)                                         (1)       (2)
       µ1 = (µ1 > µ1 > · · · > 0),                      µ2 = (µ2 > µ2 > · · · > 0).
Then we write λ E µ if
                            j               j
                                   (j)              (j)
                            X               X
                                  λ1 6             µ1           for all j
                            i=1              i=1
and
                            j                           j
                                   (j)                         (j)
                            X                           X
                  |λ1 | +         λ2 6 |µ1 | +                µ2           for all j.
                            i=1                         i=1
Note that, if |λ1 | = |µ1 |, then we have
                      λEµ          ⇔        λ1 E µ 1          and    λ2 E µ2 ,
where, on the right, the symbol E just denotes the usual dominance order
on partitions, as in Example 2.5. The following result is a refinement of [3,
Remark 3.7] (which only deals with elements of the same t-length).
Proposition 5.4. Let x, y ∈ Wn be such that x 6LR y. Assume that x
belongs to an RS-cell of shape (λ1 , λ2 ) and y belongs to an RS-cell of shape
(µ1 , µ2 ). Then we have
                             (λ1 , λ∗2 ) E (µ1 , µ∗2 ),
with equality only if x ∼LR y.
28                                     Geck and Iancu

Proof. Let w ∈ Wn and write w = aw al σw b−1     w where l = ℓt (w). Now the
parabolic subgroup Sl,n−l is a direct product of Sl = hs1 , . . . , sl−1 i and
S[l+1,n] = hsl+1 , . . . , sn−1 i. Thus, we have
                    ′ ′′                ′ ∈ S and σ ′′ ∈ S
              σw = σw σw         where σw    l     w      [l+1,n] .

Since Sl is a Coxeter group of type Al−1 , the classical Robinson–Schensted
correspondence associates to σw   ′ a pair of tableaux whose shape is a partition

of l, say ν2 . Similarly, since S[l+1,n] is of type An−l , the classical Robinson–
Schensted correspondence associates to σw       ′′ a pair of tableaux whose shape

is a partition of n − l, say ν1 . Then, by the discussion in [2, 4.7], we have
    (♠) w belongs to an RS-cell of shape (ν1 , ν2∗ ).
Now consider the given two elements x, y ∈ Wn such that x 6LR y. By
Proposition 5.2, this implies ℓt (y) 6 ℓt (x). In particular, x and y cannot lie
in the same two-sided cell unless x and y have the same t-length. We now
distinguish two cases.
   Case 1. Assume that l := ℓt (x) = ℓt (y). By Theorem 5.3, we know that
x 6LR y implies that σx 6LR,l σy . Furthermore, it is well-known and easy
to check that the Kazhdan–Lusztig pre-order relations are compatible with
direct products; in particular, we have
                        σx′ 6′LR σy′       and      σx′′ 6′′LR σy′′ ,
where a single dash denotes the pre-order relation on Sl and a double-dash
denotes the pre-order on S[l+1,n] . Now (♠) shows that
     • σx′ is associated with the partition λ∗2 ,
     • σy′ is associated with the partition µ∗2 ,
     • σx′′ is associated with the partition λ1 ,
     • σy′′ is associated with the partition µ1 .
Thus, we are reduced to statements concerning two-sided cells in the sym-
metric group. Now Example 2.5(e) shows that we have the implications
     σx′ 6′LR σy′   ⇒      λ∗2 E µ∗2       and      σx′′ 6′LR σy′′      ⇒   λ1 E µ 1 .
This yields (λ1 , λ∗2 ) E (µ1 , µ∗2 ) as required.       Furthermore, if (λ1 , λ∗2 ) =
(µ1 , µ∗2 ), then x ∼LR y by Theorem 5.3.
   Case 2. Assume that ℓt (y) < ℓt (x). By Case 1 and the definition of
6LR , it is enough to consider an elementary step, where ℓt (y) < ℓt (x) and
x ←L y or x ←R y. Since w ∼LR w−1 for all w ∈ Wn , we can even assume
that x ←R y, that is, hy,s,x 6= 0 for some s ∈ {t, s1 , s2 , . . . , sn−1 }. Since
we are assuming ℓt (y) < ℓt (x), we must have s = t and x = yt > y by
Proposition 5.2. Thus, it remains to consider the effect of multiplying with
t on the generalized Robinson–Schensted correspondence. We claim that, if
x = yt > y, then
      • λ1 is obtained from µ1 by decreasing one part by 1, and
      • λ∗2 is obtained from µ∗2 by increasing one part by 1.
                                  Lusztig’s a-function                              29

This is seen as follows. Recall the basic ingredients of the generalized
Robinson-Schensted correspondence. We write y ∈ Wn as a signed per-
mutation                                          
                       1         2      ···    n
                                                             (ε1 = 1)
                    ε1 · p1 ε2 · p2 · · · εn · pn
where the sequence p1 , . . . , pn is a permutation of 1, . . . , n and where εi = ±1
for all i. The fact that ε1 = 1 follows from our assumption that yt > y. Let
1 6 i1 < i2 < · · · < ik 6 n be the sequence of indices where the sign is “+”
and let 1 6 j1 < j2 < · · · < jl 6 n be the sequence of indices where the sign
is “−”. Applying the usual “insertion algorithm” to these two sequences
of numbers, we obtain a standard bitableau (A+ (y), A− (y)) of size n and
shape (µ1 , µ2 ), where ℓt (y) = |µ2 | = l.
   Now let us multiply y on the right by t. Then the corresponding signed
permutation is given by
                                                             
                              1          2    ···     n
                                                                  .
                          −ε1 · p1 ε2 · p2 · · · εn · pn
Thus, the only effect of multiplying by t is to change the sign in the first po-
sition of the above array. Hence, in order to obtain the tableaux A+ (yt) and
A− (yt), we must apply the insertion algorithm to the sequences pi2 , . . . , pik
and pi1 , pj1 , pj2 , . . . , pjl , respectively. Thus, we are reduced to a purely com-
binatorial statement. Using [9, §5, Prop. 1], one shows that the partition
giving the shape of A+ (yt) is obtained from the partition giving the shape
of A+ (y) by decreasing one part by 1. The same argument shows that the
partition giving the shape of A− (yt) is obtained from the partition giving
the shape of A− (y) by increasing one part by 1. (A much more general
statement can be found in [23, Theorem 4.2].)
   Now the definition of E immediately shows that, if (λ1 , λ2 ) is obtained
from (µ1 , µ2 ) by the above procedure, then (λ1 , λ∗2 ) E (µ1 , µ∗2 ) as required.
                                                                                     
Corollary 5.5. Let x, y ∈ Wn be such that x 6LR y. Then we have αy 6 αx ,
with equality only if x ∼LR y.
Proof. Assume that x belongs to an RS-cell of shape (λ1 , λ2 ) and y belongs
to an RS-cell of shape (µ1 , µ2 ). Hence, by Example 3.11, we have
                    αx = α(λ1 ,λ∗2 )      and      αy = α(µ1 ,µ∗2 ) .
The description of the generalized Robinson–Schensted correspondence in
[2] shows that ℓt (x) = |λ2 | = |λ∗2 | and ℓt (y) = |µ2 | = |µ∗2 |. Now, by Proposi-
tion 5.2, the condition x 6LR y implies that ℓt (y) 6 ℓt (x).
   Case 1. Assume that l := ℓt (x) = ℓt (y). Then we have
                           λ1 E µ 1       and       λ∗2 E µ∗2
by Proposition 5.4. Now note the following property of the dominance order.
For any partitions ν and ν ′ of n, we have
            ν ∗ E ν ′∗      ⇔          ν′ E ν      ⇒        n(ν) 6 n(ν ′ ),
30                                   Geck and Iancu

with equality only for ν = ν ′ ; see, for example, [15, Exercise 5.6]. Using the
above property, we conclude that
               n(µ1 ) + 2n(µ∗2 ) − n(µ2 ) 6 n(λ1 ) + 2n(λ∗2 ) − n(λ2 ),
with equality only if (µ1 , µ2 ) = (λ1 , λ2 ). Hence, the formula for αw shows
that αy 6 αx , as required. Furthermore, if αx = αy , then we necessarily
have (λ1 , λ2 ) = (µ1 , µ2 ), and so x ∼LR y by Theorem 5.3.
   Case 2. Assume that ℓt (y) < ℓt (x). As in the proof of Proposition 5.4,
we can reduce to the case where x = yt > y.
In this case we have αx − αy = b + a(2r ′ − m − r), where m, r, r ′ are integers
determined by the conditions :
            (m)       (m)           (r)      (r)            ∗(r ′ )      ∗(r ′ )
          λ1      = µ1      − 1,   λ2 = µ2 + 1,            λ2         = µ2         + 1.
Now note that we have 2r ′ −m−r +n−1 > 0, hence αx > αy as desired. 

Proofs of Theorem 1.2, Theorem 1.3 and Theorem 1.4. Let us recall
the principal ingredients. By Example 3.6, we know that Hn is integral and
normalized. Furthermore, by the discussion in Example 3.11, the characters
afforded by all left cells are irreducible. Finally, the assumption (♣) in
Lemma 4.4 holds by Corollary 5.5. Thus, we can conclude that
                         a(w) = α(λ1 ,λ2 )         (w ∈ T(λ1 ,λ2 ) ).
The identification of T(λ1 ,λ2 ) in Example 3.11 and the formula for α(λ1 ,λ2 )
in Example 3.6 now yield the explicit description of the a-function of Wn ,
proving Theorem 1.2.
   Now, once the a-function is determined, condition (♣) in Lemma 4.4
yields the implication “x 6LR y ⇒ a(y) 6 a(x)” for any x, y ∈ Wn , that
is, (P4) holds. But then Corollary 5.5 also yields the fact that, if x 6LR y
and a(x) = a(y), then x ∼LR y, that is, (P11) holds. Now Lemma 4.6 and
Lemma 4.8 show that all the other properties mentioned in Theorem 1.3
hold. As far as (P12) is concerned, note that every parabolic subgroup of
Wn is a direct product of a group of type Bk and possibly some factors of
type Ani . Since (P1)–(P15) are known to hold for groups of type Ani , we
conclude that (P3), (P4), (P8) hold for every parabolic subgroup of Wn .
This formally implies that (P12) holds; see [21, 14.12].
   Finally, as explained in [21, 18.3], the ring J can be constructed once
it is known that (P1)–(P8) are known to hold. The structure of J is now
determined by Proposition 4.9 (and Remark 4.10).
Remark 5.6. Bonnafé has remarked at the end of [3, §4] that, once the
equality a(z) = αz (z ∈ Wn ) is established, the methods in his paper [3] yield
properties (P1), (P4), (P6), (P11), (P12) and the first assertion of (P13).
However, it does not seem to be possible to gain control over the constants
γx,y,z in his approach, and this is where the leading matrix coefficients of
orthogonal representations naturally come into play.
                                     Lusztig’s a-function                                31

Example 5.7. Let us consider the case n = 2, where W2 = ht, s1 i is the
                                                           ∗ and the left
dihedral group of order 8. We set s0 = t. The polynomials Py,w
cells have already been determined by an explicit computation in [18, §6].
The left cells are
       {1},    {s1 },     {s0 , s1 s0 },   {s0 s1 , s1 s0 s1 },   {s0 s1 s0 },   {w0 }
where w0 = s1 s0 s1 s0 is the unique element of maximal length. Using the
             ∗ , we compute:
polynomials Py,w
                            ∆(1) = 0,                         n1 = 1,
                           ∆(s1 ) = a,                       ns1 = 1,
                           ∆(s0 ) = b,                       ns0 = 1,
                     ∆(s1 s0 s1 ) = b,                  ns1 s0 s2 = 1,
                     ∆(s0 s1 s0 ) = 2b − a,             ns0 s1 s0 = −1,
                          ∆(w0 ) = 2b + 2a,                 nw0 = 1.
In particular, we see that the coefficients nz can be negative. Proposition 4.9
shows that
               t2s0 s1 s0 = −ts0s1 s0 ;      see also Lusztig [21, 18.7].
There is a unique irreducible character χλ of degree 2; it is labelled by
λ = ((1), (1)). A corresponding orthogonal representation and the leading
matrix coefficients are explicitly described in [10, Exp. 5.5]. We have αλ = b
and the representation Xλ is given by
                                                  v − v −1    1 + V 2 v −2
                                                                         
                  V     0                  1
   Xλ : Ts0 7→               ,   T s1 →
                                      7                                       .
                  0 −V −1               V 2 + 1 1 + V 2 v 2 V 2 (v − v −1 )
Thus, we see that c2,2      1,1                  2,1         1,2
                   s0 ,λ = cs1 s0 s1 ,λ = 1 and cs0 s1 ,λ = cs1 s0 ,λ = −1. We
conclude that
  s1 s0 s1 = wλ (1, 1),    s1 s0 = wλ (1, 2),
                                            s0 s1 = wλ (2, 1), s0 = wλ (2, 2).
Hence, Proposition 4.9 yields a ring isomorphism Jλ ∼     = M2 (Z) where
                                                                       
                1 0                 0 −1                0 0               0 0
 ts1 s0 s1 7→         , ts1 s0 7→         , ts0 s1 7→          , ts0 7→         .
                0 0                 0 0                 −1 0              0 1
Note that one also obtains an isomorphism Jλ ∼     = M2 (Z) by sending the above
four elements tx directly to the corresponding matrix units (omitting the sign
in the matrices), as in [21, 18.7]. The signs arise from the construction in
the proof of Proposition 4.9 and the choice of the orthogonal representation.
Note that the latter is not unique: for example, one can conjugate Xλ by a
diagonal matrix with ±1 on the diagonal.

Proof of Theorem 1.5. Let us recall some ingredients of the construction
of the Dipper–James–Murphy basis. Let λ = (λ1 , λ2 ) be a bipartition of
n; let (s, t) be a pair of standard bitableaux of shape λ. By [6, §4], we
32                                       Geck and Iancu

have xst = Td xλ Td′ where d, d′ are certain elements in Sn ; the element xλ is
defined in [6, 4.1]. Since N λ is a two-sided ideal, we conclude that
                                     X
                           Nλ =             H n xµ H n .
                                         µ∈Λn ; λEµ

We must show that    =     Nλ     M λ,
                               where we set
                 w corresponds to an RS-cell of shape
            D                                                  E
    M λ := Cw′                                                   ⊆ Hn .
                  ν = (ν1 , ν2 ) where (λ1 , λ2 ) E (ν2 , ν1∗ ) A
One easily checks that (ν1 , ν2∗ ) E (λ∗2 , λ∗1 ) ⇔ (λ1 , λ2 ) E (ν2 , ν1∗ ) (using the
analogous statement for the dominance order on partitions; see [15, Exer-
cise 5.6]). Hence, by Proposition 5.4, M λ is a two-sided ideal of Hn .
   We now show that N λ ⊆ M λ . Let µ = (µ1 , µ2 ) be a bipartition of n such
that (λ1 , λ2 ) E (µ1 , µ2 ). Let l := |µ1 |. The element xµ is defined as the
product of three factors u+   l , xµ1 , xµ2 . The formula in Bonnafé [3, Prop. 2.5]
shows that, up to multiplying by a monomial in V and v, the factor u+          l equals
Tσl Ca′ l where σl is the longest element in Sl = hs1 , . . . , sl−1 i. Furthermore,
by Lusztig [21, Cor. 12.2], we have xµ1 xµ2 = v l(wµ ) Cw′ µ where wµ is the
longest element in the Young subgroup of Sl,n−l given by µ = (µ1 , µ2 ).
Finally, by [3, Prop. 2.3], we have Ca′ l Cw′ µ = Ca′ l wµ . Hence, we obtain
       xµ = Tσl Ca′ l wµ        (up to multiplying by a monomial in V and v).
By relation (♠) in the proof of Proposition 5.4, al wµ belongs to an RS-cell of
shape (µ∗2 , µ1 ). Hence, since (λ1 , λ2 ) E (µ1 , µ2 ) and since M λ is an ideal, we
obtain that xµ ∈ M λ . As this holds for all µ such that λ E µ, we conclude
that N λ ⊆ M λ .
   In order to show equality, we note that M λ is free over A of rank λEν d2ν ,
                                                                           P

where dν denotes the number of standard bitableaux of shape ν. By [6, 4.15],
N λ is free over A of the same rank. Consequently, we have K0 ⊗A N λ =
K0 ⊗A M λ , where K0 is the field of fractions of A. So there exists some
0 6= f ∈ A such that f M λ ⊆ N λ ⊆ M λ . Now, since the generators of N λ
can be extended to an A-basis of Hn (see [6, §4]), the quotient Hn /N λ is a
free A-module. Hence, M λ ⊆ N λ and the conclusion follows.
Acknowledgements. This paper was written while the first named au-
thor enjoyed the hospitality of the Bernoulli Center at the EPFL Lausanne
(Switzerland), during the research program “Group representation theory”
from january to june 2005. The second named author gratefully acknowl-
edges support by the Fonds National Suisse de la Recherche Scientifique.

                                         References
     [1] S. Ariki, Robinson-Schensted correspondence and left cells. Combinatorial methods
         in representation theory (Kyoto, 1998), 1–20, Adv. Stud. Pure Math., 28, Kinoku-
         niya, Tokyo, 2000.
     [2] C. Bonnafé and L. Iancu, Left cells in type Bn with unequal parameters, Repre-
         sent. Theory 7 (2003), 587–609.
                                    Lusztig’s a-function                                 33

  [3] C. Bonnafé, Tow-sided cells in type B in the asymptotic case, preprint available
      at arXiv.org/math.RT/0502086
  [4] R. W. Carter, Finite groups of Lie type: Conjugacy classes and complex charac-
      ters, Wiley, New York, 1985; reprinted 1993 as Wiley Classics Library Edition.
  [5] R. Dipper and G. D. James, Blocks and idempotents of Hecke algebras of general
      linear groups, Proc. London Math. Soc. 54 (1989), 57–82.
  [6] R. Dipper, G. D. James and G. E. Murphy, Hecke algebras of type Bn at roots
      of unity, Proc. London Math. Soc. 70 (1995), 505–528.
  [7] R. Dipper, G. James and G. E. Murphy, Gram determinants of type Bn , J.
      Algebra 189 (1997), 481–505.
  [8] J. Du, B. Parshall, and L. Scott, Cells and q-Schur algebras, Transformation
      Groups 3 (1998), 33–49.
  [9] W. Fulton, Young tableaux, London Math. Soc. Stud. Texts, vol. 35, Cambridge
      University Press, 1997.
 [10] M. Geck, Constructible characters, leading coefficients and left cells for finite Cox-
      eter groups with unequal parameters, Represent. Theory 6 (2002), 1–30 (electronic).
 [11] M. Geck, Computing Kazhdan–Lusztig cells for unequal parameters, J. Algebra
      281 (2004), 342–365; section ”Computational Algebra”.
 [12] M. Geck, Left cells and constructible representations, Represent. Theory 9 (2005),
      385–416.
 [13] M. Geck, Relative Kazhdan–Lusztig cells (submitted); preprint available at
      arXiv.org/math.RT/0504216
 [14] M. Geck, Kazhdan–Lusztig cells and the Murphy basis (submitted); preprint avail-
      abe at arXiv.org/math.RT/0504217
 [15] M. Geck and G. Pfeiffer, Characters of finite Coxeter groups and Iwahori–Hecke
      algebras, London Math. Soc. Monographs, New Series 21, Oxford University Press,
      2000.
 [16] P. N. Hoefsmit, Representations of Hecke algebras of finite groups with BN pairs
      of classical type, Ph.D. thesis, University of British Columbia, Vancouver, 1974.
 [17] D. Kazhdan and G. Lusztig, Representations of Coxeter groups and Hecke alge-
      bras, Invent. Math. 53 (1979), 165–184.
 [18] G. Lusztig, Left cells in Weyl groups, Lie Group Representations, I (R. L. R. Herb
      and J. Rosenberg, eds.), Lecture Notes in Math., vol. 1024, Springer-Verlag, 1983,
      pp. 99–111.
 [19] G. Lusztig, Cells in affine Weyl groups, Advanced Studies in Pure Math. 6, Alge-
      braic groups and related topics, Kinokuniya and North–Holland, 1985, 255–287.
 [20] G. Lusztig, Leading coefficients of character values of Hecke algebras, Proc. Symp.
      Pure Math. 47, Amer. Math. Soc., Providence, RI, 1987, pp. 235–262.
 [21] G. Lusztig, Hecke algebras with unequal parameters, CRM Monographs Ser. 18,
      Amer. Math. Soc., Providence, RI, 2003.
 [22] G. Lusztig and N. Xi, Canonical left cells in affine Weyl groups, Advances in
      Math. 72 (1988), 284–288.
 [23] B. Srinivasan, A geometric approach to the Littlewood–Richardson rule, J. Algebra
      187 (1997), 227–235.




   M.G.: Institut Camille Jordan, Université Lyon 1, 21 av Claude Bernard,
69622 Villeurbanne cedex, France
   Current address: Department of Mathematical Sciences, King’s College, Aberdeen Uni-
versity, Aberdeen AB24 3UE, Scotland, U.K.
   E-mail address: m.geck@maths.abdn.ac.uk
34                                  Geck and Iancu

   L.I.: IGAT, EPFL, Bâtiment de chimie, 1015 Lausanne, Switzerland
   Current address: Department of Mathematical Sciences, King’s College, Aberdeen Uni-
versity, Aberdeen AB24 3UE, Scotland, U.K.
   E-mail address: l.iancu@maths.abdn.ac.uk
