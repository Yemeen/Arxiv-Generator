                                                                    Analysis of systematic scan Metropolis algorithms
                                                                         using Iwahori-Hecke algebra techniques
arXiv:math/0401318v1 [math.RT] 23 Jan 2004




                                                                                            Persi Diaconis∗
                                                                                       Department of Mathematics
                                                                                          Stanford University
                                                                                          Stanford, CA 94305

                                                                                              Arun Ram∗∗
                                                                                      Department of Mathematics
                                                                                    University of Wisconsin, Madison
                                                                                          Madison, WI 53706
                                                                                          ram@math.wisc.edu

                                             Abstract. We give the first analysis of a systematic scan version of the Metropolis algorithm.
                                             Our examples include generating random elements of a Coxeter group with probability determined
                                             by the length function. The analysis is based on interpreting Metropolis walks in terms of the
                                             multiplication in the Iwahori-Hecke algebra.

                                             1. Introduction
                                                   When faced with a complex task, is it better to be systematic or proceed by making random
                                             adjustments? We study aspects of this problem in the context of generating random elements of a
                                             finite group. For example, suppose we want to fill n empty spaces with zeros and ones such that
                                             the probability of configuration x = (x1 , . . . , xn ) is θ n−|x| (1 − θ)|x| with |x| the number of ones in
                                             x. A systematic scan approach works left to right filling each successive place with a θ-coin toss.
                                             A random scan approach picks places at random and a given site may be hit many times before all
                                             sites are hit. The systematic approach takes order n steps and the random approach takes order
                                             1
                                             4 n log n steps.
                                                   Realistic versions of this toy problem arise in image analysis and Ising like simulations where
                                             one must generate a random array by a Monte Carlo Markov chain. Systematic updating and ran-
                                             dom updating are competing algorithms discussed in detail in Section 2. There are some successful
                                             analyses for random scan algorithms, but the intuitively appealing systematic scan algorithms have
                                             resisted analysis.
                                                   Our main results show that the binary problem above is exceptional; for the examples analyzed
                                             in this paper, systematic and random scans converge in about the same number of steps.
                                                   Let W be a finite Coxeter group generated by simple reflections s1 , s2 , . . . , sn , where s2i = id.
                                             For example, W may be the permutation group Sn+1 with si = (i, i + 1). The length function ℓ(w)
                                             is the smallest k such that w = si1 si2 · · · sik . Fix 0 < θ ≤ 1 and define a probability distribution
                                             on W by
                                                                                θ −ℓ(w)                          −1
                                                                                                                        X
                                                                     π(w) =               ,     where     P   (θ    ) =      θ −ℓ(w)                (1.1)
                                                                               PW (θ −1 )                   W
                                                                                                                          w∈W

                                                  ∗
                                                      Research supported in part by National Science Foundation grant DMS-9504379.
                                                  ∗∗
                                                       Research supported in part by National Science Foundation grant DMS-9622985.
2                                           persi diaconis                and       arun ram

is the normalizing constant. Thus π(w) is smallest when w = id and, as θ → 1, π tends to the
uniform distribution. These non-uniform distributions arise in statistical work as Mallows models.
Background and references are in Section 2e.
      A standard Monte Carlo Markov chain algorithm for sampling from π is the Metropolis algo-
rithm with a systematic scan. This algorithm cycles through the generators in order. If multiplying
by the current generator increases length this multiplication is made. If the length decreases, then
the multiplication is made with probability θ and omitted with probability 1 − θ. One scan uses
s1 , s2 , . . . , sn−1 , sn , sn , sn−1 , . . . , s1 , in order. Define

                K(w, w′ ) = the chance that a systematic scan started at w ends in w′ .                                                   (1.2)

Repeated scans of the algorithm are defined by
                                      X
                       K ℓ (w, w′ ) =   K ℓ−1 (w, w′′ )K(w′′ , w′ ),                                   ℓ ≥ 2.                             (1.3)
                                                     w ′′

In Section 2c and 4a we show that this Markov chain has π as unique stationary distribution.
    The main results of this paper derive sharp results on rates of convergence for these walks.
As an example of what our methods give, we show that order n scans are necessary and suffice to
reach stationary on the symmetric group starting from the identity. More precisely, we prove

Theorem 1.4. Let Sn be the permutation group on n letters. Fix θ, 0 < θ ≤ 1. Let
K1ℓ (w) = K ℓ (id, w) be the systematic scan chain on Sn defined by (1.2) and (1.3). For ℓ =
n/2 − (log n)/(log θ) + c with c > 0,
                                     2c+1           2
                   kK1ℓ − πθ k2T V ≤ eθ    − 1 + n!θ n /8−n(log n)/(log θ)+n(c+1/4) .   (1.5)

Conversely, if ℓ ≤ n/4 then, for fixed θ, kK1ℓ − πkT V tends to 1 as n → ∞.

     The total variation norm above is defined in Section 2a below. Note that the upper bound
in (1.5) tends to zero for c large, so that about n/2 scans suffice to reach stationarity. The lower
bound shows this is of the right order for large n.
     Each scan above uses 2n multiplications. Thus Theorem 1.4 implies that the systematic scan
approach reaches stationarity in n2 operations up to lower order terms. We also conjecture that
the random scan approach (see Section 2b) for this example takes order n2 operations. Further,
in Section 7, we prove that the scan based on the sequence

          (s1 , s2 , . . . , sn , sn , . . . , s1 ), (s1 , . . . , sn−1 , sn−1 , . . . , s1 ), . . . , (s1 , s2 , s2 , s1 ), (s1 , s1 )

converges in one pass. Thus, again, up to lower order terms, n2 operations suffice to reach sta-
tionarity. These results shows that various different scanning strategies take the same number of
operations to reach stationarity.
     One novel aspect of present arguments is our use of the Iwahori-Hecke algebra H spanned by
the symbols {Tw }w∈W . This is generated by Ti = Tsi , 1 ≤ i ≤ n with the relations
                                  
                                    Tsi w ,              if ℓ(si w) > ℓ(w),
                         Ti Tw =
                                    qTsi w + (q − 1)Tw , if ℓ(si w) < ℓ(w).

We have succeeded in giving an algebraic interpretation of the Markov chain K(w, w′ ) as multipli-
cation in the Iwahori-Hecke algebra H. From there, knowledge of the center of H (via a result of
                          Metropolis scans and Hecke algebras                                       3

Brieskorn-Saito and Deligne) allows us to explicitly diagonalize K(w, w′ ). Convergence bounds are
given in terms of the eigenvalues and the generic degrees of representation theory. Then calculus
leads to results like Theorem 1.4.
     Section 2 collects together probabilistic background and tools. We explain Markov chains, the
Metropolis algorithm, systematic scans, and relate the basic Metropolis chain to a natural walk
on the chambers of a building. In Section 2e we develop properties of the measures π. Some of
these are new even for reflection groups of type A (the symmetric group). These properties will
be applied to prove lower bounds for walks as in Theorem 1.4.
     Section 3 collects together representation theoretic background and tools and connects the
representation theory to Markov chains. Section 4 connects Hecke algebras to the Metropolis
algorithm and specializes the results from Section 3. A basic upper bound for convergence is
derived by relating two inner products.
     Sections 5 and 6 derive results for the hypercube and the dihedral groups. Here we find that
both the systematic and random scans converge in about the same number of steps – the differences
are only in the lead term constants (which are functions of θ).
     Section 7 derives results for two different systematic scanning plans for the symmetric group.
Though we do not have the space to treat further examples in this paper, it should be remarked
that the methods of Section 7 should also produce analogous results for the Weyl groups of type
Bn and the imprimitive complex reflection groups G(r, 1, n). The long and short systematic scans
can be defined in a similar way and the representation theory goes through without problems (see
[Hf], [Ra] and [AK]). The remaining necessary ingredient is an analogue of Lemma 7.2.
Acknowledgement. This paper is dedicated to our friend Bill Fulton. We are also thankful to Ruth
Lawrence for early efforts to help understand deformed random walks.

2. Probabilistic background
     In this section we give background material for Markov chains, the Metropolis algorithm, and
systematic scans. In Section 2d we interpret the basic walk as a walk on flags and the chambers
of a building and in Section 2e we derive basic properties of the stationary distributions.

2a. Markov chains
    Background for Markov chains may be found in any standard probability text e.g. Feller [Fe,
Chapter XV]. For the quantitative theory developed here see Saloff-Coste [SC] and the references
therein.
    Let X be a finite set. A Markov chain on X is a matrix K = (K(x, y))x,y∈X such that
                                                             X
                           K(x, y) ∈ [0, 1]       and              K(x, y) = 1.
                                                             y∈X


The set X is the state space and K(x, y) gives the probability of moving from x to y in one step.
Powers of the matrix K give the probability of moving from x to y in more steps. For example,
                                                  X
                                   K 2 (x, y) =         K(x, z)K(z, y)
                                                  z∈X


indicates that to move from x to y in two steps the chain must move to z and then from z to y.
The chain is irreducible and aperiodic if there is an ℓ > 0 such that K ℓ (x, y) > 0 for all x, y ∈ X.
4                                persi diaconis            and   arun ram
                                                                                              X
The chain K is reversible if there is a stationary distribution π: X → [0, 1],                      π(x) = 1, such
                                                                                              x∈X
that, for all x, y ∈ X,
                                     π(x)K(x, y) = π(y)K(y, x).
For irreducible aperiodic K, reversibility implies that, for each x ∈ X, the real numbers K ℓ (x, y)
converge to π(y) as ℓ → ∞.
     The quantitative theory of Markov chains studies the speed of convergence. The total variation
distance of K ℓ (x, ·) to π is defined by
                                                                      
                                                                      
                                                   X                  
                                   ℓ                     ℓ
                                kKx − πkT V = max 
                                                      K (x, y) − π(y) .
                                              A⊆X                     
                                                   y∈A


Using the set A = {y ∈ X | K ℓ (x, y) > π(y)} it is easily shown that

                                                    1 X ℓ
                               kKxℓ − πkT V =          |K (x, y) − π(y)|.                                    (2.1)
                                                    2
                                                     y∈X


Let L2 (π) be the space of functions f : X → R with the norm
                                                    X
                                     hf, gi2 =            f (x)g(x)π(x).                                     (2.2)
                                                    x∈X


The following lemma provides a relation between the total variation and the L2 (π) norms. This
bound is the primary tool for studying rates of convergence of Markov chains.

Lemma 2.3. Let f ∈ L2 (π). Then kf k2T V ≤ 14 kf /πk22 .

Proof. By the Cauchy-Schwartz inequality,
                                       !2                        !                !
                     X |f (x)| p                     X f (x)2        X
        2        1                              1
     kf kT V =   4
                         p      π(x)        ≤   4                          π(x)       = 14 hf /π, f /πi2 .
                           π(x)                        π(x)
                     x∈X                            x∈X              x∈X



2b. Systematic scan algorithms
     Let π be a probability distribution on a finite set X and let K1 , K2 , . . . , Kn be Markov chains
on X each having stationary distribution π. Then any product Kiℓ Kiℓ−1 · · · Ki1 has stationary
distribution π and a choice of an infinite sequence {iℓ }∞  ℓ=1 gives a scanning strategy. A ran-
dom choice of indices gives a random scanning stategy. If each Ki is reversible for π, then
K1 K2 · · · Kn−1 Kn Kn Kn−1 · · · K2 K1 is an example of a reversible systematic scanning strategy
(while K1 · · · Kn is not necessarily reversible).
     In routine applications of the Metropolis algorithm to image analysis and Ising-like models the
state space has coordinates. Randomized strategies choose a coordinate at random and attempt
to change it. Systematic strategies cycle through the coordinates in various orders. Fishman [Fi]
reviews the literature on scanning strategies and gives some practical comparison. The scheme
underlying Theorem 1.4 is Fishman’s Plan 3.
     There has been some rigorous work on rates of convergence for systematic scans in a related
case: Gaussian distribution of coordinates with the stochastic updating done by the heat bath
                          Metropolis scans and Hecke algebras                                     5

algorithm (also known as Glauber dynamics or the Gibbs sampler). One fascinating study by
Goodman and Sokal [GS] relates scanning strategies to standard approaches for solving large
linear systems. They show that the systematic scan heat bath algorithm is a stochastic analog of
the Gauss-Seidel algorithm. Moreover, they show how previous analyses of Gauss-Seidel give the
eigenvalues of its stochastic counterpart. Amit [Am1-2] and Amit and Grenander [AG] have pushed
forward and carried out these ideas to give some comparison of systematic and randomized sweeps
in the Gaussian case. Their approach uses the fact that the heat bath algorithm is a projection
operator. In the Gaussian case the problem reduces to the computation of angles between subspaces
of a Hilbert space. Baronne and Frigessi [BF] and Roberts and Sahk [RS] are related references.

2c. The Metropolis algorithm
    The Metropolis algorithm gives a way of changing the stationary distribution of a given Markov
chain into any distribution. It was invented by Metropolis et al [MR]. A clear description is in
Hammersley and Handscomb [HH] and a recent survey appears in [DS].
    Let X be a finite set. Let P (x, y) = P (y, x) be a symmetric Markov matrix on X and let π
be a fixed probability distribution on X. Form a new chain by the following recipe:
                  
                  
                   P (x, y),                                if x 6= y and π(y) ≥ π(x),
                  
                  
                  
                  
                  
                            π(y)
                    P (x, y)      ,                          if x 6= y and π(y) < π(x),
       M (x, y) =            π(x)                                                             (2.4)
                  
                                                       
                  
                                  X                π(z)
                  
                   P (x, x) +         P (x, z) 1 −       , if x = y.
                  
                                                   π(x)
                               π(z)<π(x)


In words:
     Form the Metropolis chain from x by choosing y from P (x, y). If π(y) ≥ π(x) move to
     x. If π(y) < π(x) flip a coin with chance of heads π(y)/π(x). If the coin comes up heads
     move to y. In all other cases stay at x.
As shown in the references above, the Metropolis chain is reversible with stationary distribution
π. It is of practical importance that the chain M can be run knowing π only up to a normalizing
constant. Irreducibility and aperiodicity of M must be checked on a case by case basis.
     An example of interest is X = W , where W is a finite real reflection group generated by simple
reflections s1 , s2 , . . . , sn . Let P (x, y) be the Markov chain given by
                                                 
                                                    1/n, if y = si x for some i,
                                      P (x, y) =
                                                    0,   otherwise.

Here P (x, y) is the usual random walk based on         a generating set. It has uniform stationary
distribution. Fix θ, 0 < θ ≤ 1 and let π be as in       (1.1). The Metropolis construction gives the
Markov chain
                            
                             1/n,                      if y = si x and ℓ(y) > ℓ(x),
                            
                            
                            
                            
                            
                             θ/n,                      if y = si x and ℓ(y) < ℓ(x),
                            
                            
                  M (x, y) = 1        X                                                        (2.5)
                            
                                            (1 − θ),   if y = x,
                            
                            
                            
                              n
                                ℓ(si x)<ℓ(x)
                            
                            
                              0,                        otherwise,
6                                    persi diaconis      and     arun ram

which has stationary distribution π. In Section 4a we demonstrate that this is exactly the chain
given by left multiplication by a uniformly chosen generator T̃i in the Iwahori-Hecke algebra H with
q = θ −1 . Similarly, the systematic scan chain of Theorem 1.4 can be interpreted via multiplication
in H.
     Despite its widespread use there has been very limited success in analyzing the time to sta-
tionarity of the Metropolis algorithm. In the present paper we carry this out for the random scan
Metropolis algorithm (2.5) on the hypercube (Section 5) and on the dihedral group (Section 6).
Though we have not analyzed the random scan Metropolis algorithm on the symmetric group we
conjecture that order n2 steps are necessary and sufficient to achieve stationarity. A survey of
what is rigorously known appears in [DS].
     Diaconis and Hanlon [DH] studied the example given by W = Sn , the symmetric group, (so
c(w) = n − [# of cycles in w]), with input chain
                                  1
                                  ,      if y = (i, j)x for some transposition (i, j),
                                   n
                    P (x, y) =        2                                                                    (2.6)
                                 
                                     0,    otherwise,

and stationary distribution π(w) = zθ c(w), where z is a normalizing constant and c(w) is the
minimum number of transpositions needed to sort w. They showed that all eigenvectors of the
resulting Metropolis chain are given by the coefficients of Jack’s symmetric functions (expanded in
terms of the power sum symmetric functions) and they used the corresponding eigenvalues to give
a complete analysis of the running time.
     Similar analyses were carried out in the Ph.D. theses of Belsley [Be2] and Silver [Si]. They
worked in abelian groups with π proportional to θ ℓ(y) where ℓ is the length function with respect
to a natural set of generators. In several cases they found that the eigenfunctions were natural
deformations of classical orthogonal polynomials. Ross and Xu [RX] studied the random scan
Metropolis algorithm on the hypercube using its representation as a random walk on a hypergroup.
It should be emphasized that for other choices of π, or in non-group cases, careful analysis of rates
of convergence for the Metropolis algorithm is completely open.

2d. Some other interpretations of the walks
     We have presented Theorem 1.4 in an algorithmic context. Here we show how the walk (2.5)
arises geometrically on the space of flags and as the natural nearest neighbor walk on the chambers
of a building. The systematic scan walks have similar interpretations.
     Let Fq be a finite field. A complete flag F = (0 = F0 ⊆ F1 ⊆ F2 ⊆ · · · ⊆ Fn−1 ⊆ Fn = V )
is a nested increasing sequence of subspaces of an n-dimensional vector space V over Fq with
dim(Fi ) = i. A natural random walk on complete flags may be performed as follows:
          Choose i, 1 ≤ i ≤ n − 1, uniformly.
          Replace Fi by a uniformly chosen subspace F̃i with Fi−1 ⊆ F̃i ⊆ Fi+1 .
This walk is symmetric, irreducible and aperiodic. It thus has the uniform distribution as its
unique stationary measure. It is instructive to think of the “q = 1” case. Then a flag is a nested
increasing chain {i1 } ⊆ {i1 , i2 } ⊆ · · · ⊆ {i1 , i2 , . . . , in } of elements of an n set or, equivalently, a
permutation (i1 , i2 , . . . , in ). In this case the walk is multiplication by random pairwise adjacent
transpositions.
     The space of flags may also be identified as the chambers of a building of type An−1 and in
this formulation the walk is described as follows:
          From a chamber C of the building choose one of the adjacent chambers uniformly at
          random and move there.
                           Metropolis scans and Hecke algebras                                     7

In the elegant, readable treatment of buildings by Brown [Bw], he explains that flag space may
be represented as G/B with G = GLn (Fq ) and B the subgroup of upper triangular matrices in
GLn (Fq ). Then two flags g1 B and g2 B differ in the ith step as above if and only if g1 Pi = g2 Pi
where Pi is the parabolic subgroup Pi = B ∪ Bsi B (see [Bw, pp. 102-103]). Thus, if flags g1 B
and g2 B are i-adjacent then g2 = g1 b or g2 = g1 bsi b′ with b, b′ ∈ B, and so the walk on G/B
moves from gB to gg ′ B with g ′ uniformly chosen in B or Bsi B. In this way, choosing an adjacent
chamber of the building at random produces a B-invariant walk on G/B. Finally, the walk on flags
gives rise to a natural walk on the double coset space B\G/B (described in more detail in Section
3b). The double coset space is identifiable with the symmetric group Sn and the induced Markov
chain is given by (2.5) with θ = 1/q. A similar story holds for the natural walk on any spherical
building.

2e. Properties of the stationary distribution
    Suppose that (X, d) is a finite metric space. A simple way of building probability models on
X is to fix 0 < θ ≤ 1 and x0 ∈ X and define

                         q d(x,x0 )                                     X
                π(x) =              ,   where q = θ −1   and PX (q) =         q d(x,x0 )        (2.7)
                          PX (q)
                                                                        x∈X

is a normalizing constant. When q = 1 the distribution is uniform.
     Models of the form (2.7) were introduced by Mallows [Ma] for the study of permutations. He
used the length function as a distance, ℓ(x−1 x0 ) = d(x, x0 ), and estimated q and x0 to match data.
Such Mallows models have had application and development for ranked and partially ranked data
using a variety of metrics [D], [Cr], [FV], [Mar]. They have also been used for phylogenetic trees
[BHV], classification trees [SB] and compositions [Det].
     One problem in studying Mallows models is that the normalizing constant PX (q) is uncom-
putable in general. In such cases properties of π can be studied by simulation using the Metropolis
algorithm given in Section 2c.
     For the examples based on reflection groups the normalizing constants are known and further
there is a simple algorithm available for exact generation from π. These properties are collected
together here. In each case the properties are illustrated for the permutation group; some of our
results are new for the original Mallows model. Further, the properties of π (particularly Property
4 below) are used in proving the lower bounds in Theorem 1.4.
     Throughout this section we work with the model where the underlying space X = W is a
finite Coxeter group generated by simple reflections, x0 is the identity element of W , and the
length function is the distance on W . Thus the model is

                          q ℓ(w)                                         X
                 π(w) =          ,      where q = θ −1   and PW (q) =           q ℓ(w)          (2.8)
                          PW (q)
                                                                         w∈W

is the Poincaré polynomial of the group W . It is a classical theorem that the normalizing constant
has a simple form:
                                                   n
                                                  Y   q di − 1
                                       PW (q) =                ,                               (2.9)
                                                  i=1
                                                       q−1

for known integers di , the degrees of W (see [Hu, Theorem 3.15]). For the symmetric group Sn+1 ,
di = i + 1 for 1 ≤ i ≤ n. The Poincaré polynomial PW (q) will be used crucially in what follows.
Property 1. π(w) = π(w−1 ), since ℓ(w) = ℓ(w−1 ).
8                                  persi diaconis       and      arun ram

This invariance under inversion was first used by Mallows [Ma] to characterize Mallows models
in a larger class of measures as follows: Suppose n objects are to be ranked by making pairwise
comparisons. Suppose the true ranking is 1 < 2 < 3 < · · · < n and a subject ranks objects i and j
correctly with probability pij . Let Q(w) be the chance that the comparisons
                                                                           lead to the permutation
w given that they are all consistent. Of course, Q(w) depends on the n2 parameters pij . Mallows
                               −1                                                     ℓ(w) r(w)
proved that
         P if Q(w) = Q(w ), then for some real numbers q and φ, Q(w) = zq                 φ     with
r(w) =      iw(i) and z a normalizing constant. He further showed that the two parameters q
and φ were practically indistinguishable for large n and suggested setting φ = 1, leading to the
distribution π(w).
Property 2. Let J ⊆ {1, 2, . . . , n} and let WJ be the subgroup of W generated by the the
generators si for i ∈ J . The group WJ is a parabolic subgroup of W . Each coset of WJ in W
contains a unique coset representative xj of minimal length [Hu, Prop. 1.10] and the probability
of any such coset is computable via

                                                               PWJ (q)
                                        π(xj WJ ) = q ℓ(xj )             .                           (2.10)
                                                               PW (q)


As an example suppose that W is the symmetric group Sn generated by s1 , s2 , . . . , sn−1 where
si = (i, i + 1). If J = {1, 2, . . . , n − 2} then WJ is the subgroup of permutations which leave n
fixed. The minimal length coset representatives xj for the cosets of WJ in W have j in position n
and the rest of the entries in order. Property 2 says that

                                                                         (1 − q)
                               π ({w ∈ Sn | w(n) = j}) = q n−j                     .                 (2.11)
                                                                        (1 − q n )

Similarly, if J = {2, 3, . . . , n − 1} Property 2 yields

                                                                      (1 − q)
                                π ({w ∈ Sn | w(1) = j}) = q j−1                 .                    (2.12)
                                                                     (1 − q n )

Similar formulas can be derived for the cases where J consists of the first j or last j elements of
{1, 2, . . . , n}.
     In combination with Property 1, (2.11) also provides a fomula for the probability of the set of
permutations with j in the nth position and (2.12) gives the probability of the set of permutations
with j in the first position. More generally, one can give formulas for the probability of the set of
permutations which have 1, 2, . . . , j in any given relative position.
Property 3. Let J1 ⊇ J2 ⊇ · · · ⊇ Jk = ∅ be a sequence of subsets of {1, 2, . . . , n}. Then a
sequential algorithm for generating w in W from π is to choose, for each 1 ≤ i ≤ k − 1, the minimal
length coset representative of a coset of WJi+1 in WJi , 1 ≤ i ≤ k − 1 and multiply these together.
If xi is a minimal length coset representative of a coset in WJi /WJi+1 choose xi with probability
q ℓ(xi ) PWJi+1 (q)/PWJi (q).
    As an example, suppose W is the symmetric group Sn generated by s1 , s2 , . . . , sn−1 . If J1 ⊇
J2 ⊇ · · · ⊇ Jn−1 is given by Ji = {i, i + 1, . . . , n − 1} the algorithm can be realized as the following
sequential procedure: Place symbols down sequentially beginning with 1. If symbols 1, 2, . . . , i − 1
have been placed in some order, place i first with probability q i−1 (1 − q)/(1 − q i ), second with
probability q i−2 (1 − q)/(1 − q i ), . . ., ith with probability (1 − q)/(1 − q i ). Continuing until all n
elements are placed gives an efficient method of choosing from π.
                             Metropolis scans and Hecke algebras                                        9

    An application of this is the following clever algorithm suggested by Pak [Pa] for generating
a uniformly chosen element of GLn (Fq ). Choose w ∈ Sn with probability proportional to q ℓ(w) .
Then form b1 wb2 with b1 and b2 uniformly chosen in the lower triangular matrices in GLn (Fq ).
This yields an efficient algorithm for uniform choice in GLn (Fq ). With obvious modifications this
procedure easily adapts to the other finite groups with a BN pair.

Property 4. Consider a finite Coxeter group with probability distibution π as given in (2.8). Let
Z be the random variable given by Z(w) = ℓ(w) for w ∈ W . Then, with di as in (2.9),

                            n
                       X di q di                                                  n
                                                                               X d2 q di
                 nq                                                   nq               i
       Eπ (Z) =      −             ,            and     Varπ (Z) =           −                  .   (2.13)
                1 − q i=1 1 − q di                                 (1 − q) 2
                                                                               i=1
                                                                                   (1 − q di )2



Proof. The moment generating function of Z is

                                                                 n
                                   1    X             P (et q) Y (1 − (et q)di ) (1 − q)
         MZ (t) = Eπ (etZ ) =             (et q)ℓ(w) = W      =                            .
                                 PW (q)                PW (q)   i=1
                                                                    (1 − et q) (1 − q di )
                                        w∈W


It follows that Z is the sum of independent random variables Z1 , . . . , Zn , where

                                                 (1 − (et q)di ) (1 − q)
                                     MZi (t) =                            .
                                                   (1 − et q) (1 − q di )

Then
                                             d                q     di q di
                                Eπ (Zi ) =      MZi (t)t=0 =     −
                                             dt               1−q   1 − q di
and
                          d2                   q        2di q di +1      2q 2      d2i q di
            Eπ (Zi2 ) =       M Z   (t)     =     −                   +         −           .
                          dt2     i      t=0   1−q   (1 − q)(1 − q di ) (1 − q)2   1 − q di
It follows that
                                                   q         d2i q di
                                 Varπ (Zi ) =            −              .
                                                (1 − q)2   (1 − q di )2

     We remark that for Coxeter groups of type An , Bn , Dn under the probability distribution π,
ℓ(w) has an approximately normal distribution with mean and variance as in (2.13). This follows
from its representation as a sum of independent variables in the proof of Property 4. For details,
see [D, Ch. 6C, Cor. 1-2].

3. Hecke algebras

    This section introduces Hecke algebras as bi-invariant functions on a group. We develop
the needed Fourier analysis and then specialize to the Iwahori-Hecke algebras associated to finite
Coxeter groups.

3a. Algebras and Fourier analysis
10                                 persi diaconis        and   arun ram

    Random walks are traditionally analyzed using Fourier analysis [D]. We find this possible in
our examples and here explain the basic tools.
    An algebra H over C is (split) semisimple if it is isomorphic to a direct sum of matrix algebras.
This means that there exists a finite index set Ŵ , and positive integers dλ , λ ∈ Ŵ , such that
                                              M
                                         H∼=       Mdλ (C),
                                                 λ∈Ŵ

where Mdλ (C) is the algebra of dλ × dλ matrices with entries in C. Fix an isomorphism
           M
  φ: H −→      Mdλ (C)       and define     eλST = φ−1 (EST
                                                         λ
                                                            ),     λ ∈ Ŵ , 1 ≤ S, T ≤ dλ ,           (3.1)
              λ

         λ
                              L
where EST   is the matrix in    λ Mdλ (C) which has a 1 in the (S, T ) entry of the λth block and
zeros everywhere else. The elements eλST ∈ H are a set of matrix units for H.
     The matrix units {eλST } form a basis of H and we write
                                       X       X
                                  h=                ρλST (h)eλST ,                           (3.2)
                                          λ∈Ŵ 1≤S,T ≤dλ

for h ∈ H. The homomorphisms ρλ : H → Mdλ (C) and the linear functionals χλH : H → C given by
                                   
                  ρλ (h) = ρλST (h) 1≤S,T ≤d  and     χλH (h) = Tr(ρλ (h))
                                                 λ


 are the irreducible representations and the irreducible characters of H, respectively. The homo-
 morphisms ρλ depend on the choice of φ but the irreducible characters χλH do not.
      A trace on H is a linear functional ~t: H → C such that ~t(h1 h2 ) = ~t(h2 h1 ), for all h1 , h2 ∈ H.
 Up to constant multiples there is a unique trace on Mdλ (C) and this implies that for any trace
~t: H → C on H there are unique tλ ∈ C, λ ∈ Ŵ , such that
                                                  X
                                             ~t =   tλ χλH .                                           (3.3)
                                                  λ∈Ŵ

The trace ~t is nondegenerate if tλ 6= 0 for all λ ∈ Ŵ . Define a symmetric bilinear form h, iH : H×H →
C on H by
                                hh1 , h2 iH = ~t(h1 h2 ),    for h1 , h2 ∈ H.
The form h, iH is nondegenerate if and only if ~t is a nondegenerateP
                                                                    trace.
     Let {Tw }w∈W be a basis of H. The Fourier transform of h = w∈W hw Tw at the representa-
tion ρ is                                      X
                                      ĥ(ρ) =        hw ρ(Tw ).                        (3.4)
                                                  w∈W

The Fourier inversion theorems describe the change of basis matrix between {Tw } and {eλST } and
recovers h from {ĥ(ρλ )}λ∈Ŵ .

Theorem 3.5. (Fourier inversion and Plancherel) Let H be a semisimple algebra over C with a
nodegenerate trace ~t. Let {Tw }w∈W be a basis for the algebra H. Let {T̃w∗ }w∈W be the dual basis
with respect to h, iH , that is hT̃w∗ , Tv iH = δwv . Then, with notations as in (3.1-3.4),
                                                 X
                                          eλST =       tλ ρλT S (T̃w∗ )Tw ,
                                               w∈W
                                  Metropolis scans and Hecke algebras                                                         11

and, for any h, h1 , h2 ∈ H,
                                         X
                                  hw =          tλ Tr(ĥ(ρλ )ρλ (T̃w∗ )),        for h ∈ H, and                          (3.6)
                                         λ∈Ŵ

                                            X                            
                        hh1 , h2 iH =             tλ Tr ĥ1 (ρλ )ĥ2 (ρλ ) ,          for h1 , h2 ∈ H.                   (3.7)
                                           λ∈Ŵ


                                                                            P
Proof. Since ~t is nondegenerate, the equation ~t(eλST ) =                               µ   λ
                                                                                µ∈Ŵ tµ χH (eST )     = tλ δST implies that
                             
                      eλT S                                        λ 	
                                    is the dual basis to           eST             with respect to h, iH .
                       tλ

                          1
By (3.2), ρλST (a) =        ha, eλT S iH . Thus
                         tλ
                                         X                       X
                              eλST =        heλST , T̃w∗ iH Tw =   tλ ρλT S (T̃w∗ )Tw .
                                           w∈W                          w∈W

The equation (3.6) is
                                                         X                         X
               hw = hh, T̃w∗ iH = ~t(hT̃w∗ ) =                 tλ χλH (hT̃w∗ ) =          tλ Tr(ĥ(ρλ )ρλ (T̃w∗ )),
                                                        λ∈Ŵ                       λ∈Ŵ

and (3.7) is
                                                  X                         X
               hh1 , h2 iH = ~t(h1 h2 ) =              tλ χλH (h1 h2 ) =        tλ Tr(ĥ1 (ρλ )ĥ2 (ρλ )).
                                                   λ                        λ



3b. Coset chains and Hecke algebras
     Let G be a finite group, B a subgroup of G and let Q be a left B-invariant probability
distribution on G. Right multiplication by random picks from Q induces a random walk on G,

                                         X0 = x0 , X1 = x0 g1 , X2 = x0 g1 g2 , . . . ,                                  (3.8)

which, in turn, induces a process on B cosets, Y0 , Y1 , Y2 , . . ., where Yi is the coset containing Xi .
The chain on G produced by right multiplication by random picks from Q is K̃(x, y) = Q(x−1 y).
The chance that this chain winds up in an element of yB is K̃(x, yB) = Q(x−1 yB) and, since Q is
left B-invariant, K̃(x, yB) = K̃(xb, yB) for any b ∈ B. This invariance is a necessary and sufficient
condition for the induced coset process to be a Markov chain for any starting state x0 B ∈ G/B
(see Theorem 6.32 of [KS]). If the support of Q is not a coset of a subgroup of G then the chain in
(3.8) is irreducible and aperiodic with uniform stationary distribution. The resulting coset chain
is
             K(xB, yB) = Q(x−1 yB) with stationary distribution π(xB) = |B|/|G|.
    If the probability Q is B bi-invariant then the right process (3.8) on G induces a process on B
double cosets by simply reporting which double coset the element Xi is in. The chance the G-chain
moves from x to an element of ByB in one step is Q(x−1 ByB) and since this only depends on the
12                                   persi diaconis          and    arun ram

double coset of x the induced process is a Markov chain on double cosets for any starting state
Bx0 B. Letting W be a set of coset representatives for the double cosets of B in G, the chain is
given by
          K(w, w′ ) = K(w−1 Bw′ B),               with stationary distribution π(w) = |BwB|/|G|,
where we view the double coset chain as a Markov chain on the set W .
    The Hecke algebra of the pair (G, B) is the subalgebra of the group algebra of G consisting of
the B bi-invariant functions on G,
                     H = {f : G → C | f (g) = f (b1 gb2 ), for g ∈ G, b1 , b2 ∈ B}.
Background on Hecke algebras may be found in Curtis and Reiner [CR, §11D]. If H is commutative
then (G, B) is called a Gelfand pair and there is a well developed probabilistic literature surveyed
in [Le1-2] or [D, Ch. 3F].
     Let W be a set of representatives of the double cosets in B\G/B. The functions
                                           1
                                    Tw =      δBwB ,     w ∈ W,
                                          |B|
form a basis of H, where δBwB is the characteristic function of the double coset BwB. The
natural anti-involution on G given by g 7→ g −1 induces an anti-involution ∗ : H → H on H given
by Tw 7→ Tw−1 . The trivial representation of G restricts to the index representation of H given by
                                                                   |BwB|
                         ρ1 (Tw ) = ind(w),     where ind(w) =            .                     (3.9)
                                                                     |B|
An example to keep in mind is G = GLn (Fq ) with B the subgroup of upper triangular matrices.
Then W is the set of permutation matrices and ind(w) = q ℓ(w) .
     Let L(G/B) = {f : G → C | f (g) = f (gb) for g ∈ G, b ∈ B}. The group G acts on the left of
L(G/B) and H(G/B) acts on the right of L(G/B) by convolution. The raison d’etre for the Hecke
algebra is that H = EndG (L(G/B)) and, as (G, H) bimodules,
                                                 X
                                     L(G/B) =        Gλ ⊗ H λ ,                                (3.10)
                                                          λ∈Ŵ

where λ runs over an index set Ŵ of all the irreducible representations of H, Gλ is an irreducible
G-module and H λ is an irreducible H module, see [CR, (11.25)(ii)]. Centralizers of the action of
a finite group, in this case G acting on L(G/B), are semisimple (our base field is C) and therefore
theory of Section 3a applies to Hecke algebras. The trace of the action of H on L(G/B) is given
by                                          
                                   ~t(Tw ) = |G|/|B|, if w = 1,                              (3.11)
                                              0,      otherwise.
The decomposition (3.10) yields
                                        X
                               ~t =            tλ χλH ,    where tλ = dim(Gλ ),                    (3.12)
                                        λ∈Ŵ
      λ
and χH are the irreducible characters of H. Define an inner product on H by
                                    hh1 , h2 iH = ~t(h1 h2 ),      h1 , h2 ∈ H.
The basis                          
                            Tw−1
                                                     is the dual basis to     {Tw }w∈W             (3.13)
                           ind(w)       w∈W
with respect to h, iH , i.e. h(1/ind(v))Tv−1 , Tw iH = δvw , for all v, w ∈ W (see [CR, (11.30)(iii)]).

3c. Iwahori-Hecke algebras
                          Metropolis scans and Hecke algebras                                       13

     The Hecke algebras associated to finite Chevalley groups G and their Borel subgroups B have
a remarkable structure theory for their double cosets – they are indexed by the elements of a finite
Coxeter group W . For example, in the case of the group G = GLn (Fq ) and its Borel subgroup
B of upper triangular matrices, the group W is the symmetric group. There are many wonderful
references for this material; Brown [Bw], Bourbaki [Bou, Ch. IV §2 Ex. 22-27], Curtis and Reiner
[CR, §67-68] or Carter [Ca, §10.8-10.11]. We develop what we need in this section and give the
relation to probability theory.
     Let W be a finite Coxeter group generated by simple reflections s1 , . . . , sn . These define a
length function with ℓ(id) = 0, ℓ(si ) = 1, and ℓ(si w) = ℓ(w) ± 1 for each w ∈ W , 1 ≤ i ≤ n. The
Iwahori-Hecke algebra H corresponding to W is the vector space with basis {Tw | w ∈ W } and
multiplication given by
                                    
                                        Tsi w ,              if ℓ(si w) = ℓ(w) + 1,
                        Ti Tw =                                                                 (3.14)
                                        (q − 1)Tw + qTsi w , if ℓ(si w) = ℓ(w) − 1.

where Ti = Tsi for 1 ≤ i ≤ n. When w = si , Ti2 = (q −1)Ti +q or, equivalently, (Ti −q)(Ti +1) = 0.
     Let Ŵ be an index set for the irreducible representations of W . For each λ ∈ Ŵ let χλW
be the corresponding irreducible character of W and let dλ = χλW (1) be the dimension of this
representation. The irreducible representations of the Iwahori-Hecke algebra H are in one-to-one
correspondence with the irreducible representations of W in such a way that if χλH is the character
of the irreducible representation of H indexed by λ ∈ Ŵ then
                                                     
                                            χλH (Tw )q=1 = χλW (w),

for all w ∈ W , see [CR, (68.21)]. In particular, the dimension of the irreducible representation of
H indexed by λ is dλ .
     Define a trace ~t: H → C on H by
                              
                                  PW (q), if w = 1,                             X
                  ~t(Tw ) =                                   where PW (q) =          q ℓ(w)
                                  0,      otherwise,
                                                                               w∈W


is the Poincaré polynomial of W . Then ~t is the trace on H given by (3.11) and the generic degrees
are the constants tλ defined by                 X
                                           ~t =      tλ χλH .                                 (3.15)
                                                     λ∈Ŵ

where χλH , λ ∈ Ŵ , are the irreducible characters of H (see (3.2)). If h, iH : H × H → C is the inner
product on H given by hh1 , h2 iH = ~t(h1 h2 ), for all h1 , h2 ∈ H, then

                         hTx , Ty−1 iH = δxy q ℓ(y) PW (q),      for all x, y ∈ W ,             (3.16)

see [CR, (68.29)].
     The “trivial” representation ρ1 of the Iwahori-Hecke algebra H is the one-dimensional repre-
sentation corresponding to the trivial representation of W . For w ∈ W ,

                                                                         1    X
                     ρ1 (Tw ) = χ1H (Tw ) = q ℓ(w) ,        and π =             Tw
                                                                       PW (q)
                                                                             w∈W
14                                    persi diaconis             and        arun ram

is the corresponding minimal central idempotent of H (cf. (3.9)). Since t1 = 1,

                                ~t(hπ) = t1 χ1 (h),          and            Tw π = q ℓ(w) π,                   (3.17)

for all h ∈ H and w ∈ W , see [CR, (68.23) and (68.28)].
     Let tr be the trace of the regular representation of H, i.e. tr(h) is the trace of the linear
transformation obtained from the action of h on H by left multiplication. Then
                                                        X
                                                 tr =            dλ χλH ,                                      (3.18)
                                                        λ∈Ŵ


where dλ are the dimensions of the irreducible representations of H (see [CR, (3.37)(iii)]).
Both traces tr and ~t are important in our analysis of Metropolis walks (see, for example, the proof
of Proposition 4.8).

4. Metropolis walks and systematic scans
     This section brings together previous results in the form needed to prove our main theo-
rems. We show that the various systematic scans are precisely represented as multiplication in
the Iwahori-Hecke algebra. Then representation theory yields tractable expressions for the norms
involved.

4a. Metropolis walks on W
     Let W be a finite Coxeter group generated by simple reflections s1 , . . . , sn and, for each
1 ≤ i ≤ n, let Pi (x, y) be the Markov chain on W given by
                                                        
                                                            1,    if y = si x,
                                         Pi (x, y) =
                                                            0,    otherwise.

Fix θ, 0 < θ ≤ 1, and let π be as in (1.1) Then             the Metropolis construction produces the Markov
chain                               
                                     1,      if            y = si x and ℓ(y) > ℓ(x),
                         Ki (x, y) = θ,       if            y = si x and ℓ(y) < ℓ(x),                           (4.1)
                                    
                                      1 − θ, if             y = x.
The chain Ki can be interpreted as follows:
     From w, try to multiply by si . If this increases the length, carry out the multiplica-
     tion. If it decreases the length flip a θ-coin. If the coin comes out heads carry out the
     multiplication. If it comes up tails the chain stays at w.
Of course, the chain based on a fixed value of i is not irreducible. However, any convex linear
combination and any symmetric product of reversible Markov chains with a fixed stationary dis-
tribution is reversible with the same stationary distribution. If W is the symmetric group then the
following chains are reversible for π:
                                 n
                              1X
                                    Ki                                              (random scan Metropolis)
                              n i=1
                    K1 K2 · · · Kn Kn · · · K2 K1                                    (short systematic scan)    (4.2)

     (K1 K2 · · · Kn Kn · · · K2 K1 ) · · · (K1 K2 K2 K1 )(K1K1 )                     (long systematic scan)
                             Metropolis scans and Hecke algebras                                                      15

Note that K1 K2 · · · Kn is an irreducible Markov chain with π stationary. However, it is not
reversible in general.
     The following Theorem (which follows directly from our setup) shows that many Markov chains
on W can be obtained by left multiplication by elements of H on the basis {T̃w }. The remaining
results in this subsection provide the necessary tools for studying the convergence of these chains
by using the representation theory of the Iwahori-Hecke algebra H. Though we have chosen to
focus here on the Iwahori-Hecke algebras related to finite reflection groups W , the results of this
section hold in a general Hecke algebra context.

Theorem 4.3. Let W be a finite Coxeter group and let H be the Iwahori-Hecke algebra with
basis {Tw }w∈W as defined in (3.14). Let

                q = θ −1 ,         T̃i = Ti /q,          and       T̃w = q −ℓ(w) Tw ,      for w ∈ W .

The Metropolis chain Ki in (4.1) is the same as the matrix of left multiplication by T̃i with respect
to the basis {T̃w }w∈W of H:
                                         
                                             T̃si w ,                   if ℓ(si w) > ℓ(w),
                             T̃i T̃w =                                                                             (4.4)
                                             (1 − θ)T̃w + θ T̃si w ,    if ℓ(si w) < ℓ(w).


    Identify functions f : X → R in L2 (π) with elements of the Iwahori-Hecke algebra H via
                                                          X
                                                    f=          f (x)T̃x .                                         (4.5)
                                                          x∈W


The following Proposition shows that we can use the inner product h, iH on H (defined in Section
3c) to compute norms in L2 (π). Coupled with Lemma 2.3 it gives bounds on rates of convergence
in total variation distance.

Proposition 4.6. Let W be a finite Coxeter group and let π be as in (1.1). With the identification
of L2 (π) and the Iwahori-Hecke algebra H given by (4.5),

                             hf /π, g/πi2 = hf, g ∗ iH ,            for all f, g ∈ L2 (π).

where ∗ : H → H is the involutive anti-automorphism of H defined by Tw∗ = Tw−1 .
                                     X                    X                          X
Proof. Use the notation f =                  f (x)T̃x =         f (x)q −ℓ(x)Tx =           fx Tx . Then, since θ = q −1 ,
                                    x∈W                   x∈W                        x∈W
(2.2) and (1.1) give

                         X f (x)g(x)   X fx q ℓ(x) gx q ℓ(x)              X
        hf /π, g/πi2 =               =          −ℓ(x)
                                                             PW (θ −1 ) =   fx gx q ℓ(x) PW (q).
                              π(x)            θ
                         x∈W                      x∈W                                    x∈W


Thus, by (3.16),
                             X                                  X
          hf /π, g/πi2 =           fx gx hTx , Ty−1 iH =               fx gy hTx , Ty−1 iH = hf, g ∗ iH .
                             x∈W                               x,y∈W
16                                    persi diaconis        and     arun ram

     The following lemma shows that the inner product in L2 (π), reversibility, and the involution
∗: H → H are simply related.

Lemma 4.7.          Let H be the Iwahori-Hecke algebra corresponding to a finite real reflection
group W and let π be as in (1.1). Let K be a reversible Markov chain on W determined by
left multiplication
           X        by an element of H (also denoted by K). The chain K operates on L2 (π) by
Kf (x) =       K(x, y)f (y). Then the following are equivalent:
            y∈W
(a) K is reversible with respect to π,
(b) K is self adjoint with respect to h, i2 ,
 (c) K = K ∗ in the Iwahori-Hecke algebra H,
where h, i2 is the norm on L2 (π) defined in (2.2) and ∗ : H → H is the involutive anti-automorphism
of H defined by Tw∗ = Tw−1 .

Proof. If K is reversible then
                       X                           X
          hKf, gi2 =        K(x, y)f (y)g(x)π(x) =   f (y)K(y, x)g(x)π(y) = hf, Kgi2 ,
                       x,y∈X                                x,y∈X


and, conversely, if K is self adjoint then

                         π(x)K(x, y) = hδx , Kδy i = hKδx, δy i = π(y)K(y, x),

where δz denotes the delta function at z, given by δz (x) = δzx (Kronecker delta). So K is reversible
if and only if K is self adjoint.
     If K is self adjoint with respect to h, i2 then, by Proposition 4.6,

               hKf, g ∗ iH = hKf /π, g/πi2 = hf /π, Kg/πi2 = hf, (Kg)∗iH = hf, g ∗ K ∗ iH .

Thus, for all w ∈ W , hK, Tw iH = h1, Tw K ∗ iH = hTw , K ∗ iH = hK ∗, Tw iH . So K = K ∗ .

    The following Proposition is a primary tool for studying rates of convergence of Markov chains
on Iwahori-Hecke algebras. It bounds the L2 (π) norm of Lemma 2.3 in terms of characters of the
Iwahori-Hecke algebra. In contrast with the way that random walks are often analyzed (see, for
example [DS2]) the following Proposition also shows that the Markov chain given by K can be
analyzed without knowing the eigenvalues of K – it is only necessary to compute traces.

Proposition 4.8. Let H be the Iwahori-Hecke algebra corresponding to a finite real reflection
group W . Let K be a reversible Markov chain on W with stationary distribution π determined
by left multiplication by an element of H (also denoted by K). Let Kxℓ denote the Markov chain
started at x after ℓ steps. Then
                               X
 (a) kKxℓ /π − 1k22 = q −2ℓ(x)   tλ χλH (Tx−1 K 2ℓ Tx ),
                               λ6=1
      X                            X
(b)         π(x)kKxℓ /π − 1k22 =          dλ χλH (K 2ℓ ),
      x∈W                          λ6=1
        λ
where χH are the irreducible characters, tλ the generic degrees (3.15), and dλ the dimensions of
the irreducible representations of H.
                           Metropolis scans and Hecke algebras                                         17

Proof. Equation (3.17) says ~t(hπ) = t1 χ1H (h), and T̃w π = π, for all h ∈ H and w ∈ W . Thus, since
Kxℓ is a probability, Proposition 4.6 gives

                   1 = hKx2ℓ /π, 1i2 = hK 2ℓ T̃x , πiH = hK 2ℓ T̃x , T̃x−1 πiH
                     = ~t(K 2ℓ T̃x T̃x−1 π) = t1 χ1H (K 2ℓ T̃x T̃x−1 ) = t1 χ1H (T̃x−1 K 2ℓ T̃x ).

Then, by Proposition 4.6,
                  
 ℓ            D                      E  D                        E
                   Kx /π, Kxℓ /π = K ℓ T̃x , (K ℓ T̃x )∗   = K ℓ T̃x , T̃x−1 (K ℓ )∗   .
                                    2
                                                                H                                  H


Thus, by (3.12) and Lemma 4.7(c),
    
 ℓ              D                  E                              X
     Kx /π, Kxℓ /π = K ℓ T̃x , T̃x−1 K ℓ   = ~t T̃x−1 K 2ℓ T̃x = q −2ℓ(x)   tλ χλH (Tx−1 K 2ℓ Tx ).
                    2
                                                H
                                                                                      λ∈Ŵ
                      
                         
             
Now (a) follows since Kxℓ /π − 1, Kxℓ /π − 1 2 = Kxℓ /π, Kxℓ /π 2 −1. Part (b) follows similarly from
the following calculation. Using the definition (2.2) of the norm on L2 (π),
      X        
                X      K ℓ(x, y)K ℓ (x, y)   X      K ℓ (y, x)K ℓ (x, y)
           π(x) Kxℓ /π, Kxℓ /π =   π(x)                     =   π(y)
                               2               π(y)                          π(y)
     x∈W                                x,y∈W                                 x,y∈W


                                        X                                 X
                                   =          K 2ℓ (y, y) = tr(K 2ℓ ) =          dλ χλH (K 2ℓ ),
                                        y∈W                               λ∈Ŵ

where tr is the trace of the regular representation of H given in (3.18).


4b. Systematic scans
     One case of Proposition 4.8 which can be analyzed for all finite Coxeter groups W is the case
when the Markov chain K is a (generalized) systematic scan. This is when K is given by left
multiplication by the element T̃w2 0 in the Iwahori-Hecke algebra. In terms of the geometry of the
Coxeter group this chain is the Metropolis walk on the chambers which tries to move a chamber
to its opposite chamber and back again by successive reflections in the walls of chambers. Since
each step is a Metropolis step the chance that the chamber returns to its original position after
one pass is not 1, but depends on the parameter θ. In the case when W is the symmetric group
this chain is the long systematic scan defined in (4.2).
     Let z be the sum of all the reflections in W . Then z is a central element (since it is a conjugacy
class sum) in the group algebra of W and thus, by Schur’s Lemma, z acts by a constant cλ on the
irreducible representation of W labeled by λ ∈ Ŵ . The following well known result shows that the
element T̃w2 0 , where w0 is the longest element of W , is an Iwahori-Hecke algebra analogue of the
element z. From the point of view provided by Theorem 4.3 the following Proposition determines
the eigenvalues (with their multiplicities) of the systematic scan Metropolis chain K on W .

Proposition 4.9. Let z be the sum of all the reflections in W and let w0 be the longest element
of W . The element T̃w2 0 is in the center of the Iwahori-Hecke algebra H and

                                                                                 χλW (z)
                           ρλ (T̃w2 0 ) = q cλ −ℓ(w0 ) Id,    where cλ =                 ,
                                                                                   dλ
18                                   persi diaconis               and   arun ram

ρλ is the irreducible representation of H indexed by λ, χλW is the irreducible character of W labeled
by λ, and dλ = χλW (1) is the dimension of this representation.

Proof. This result is standard, see [Ra, (2.4) and (2.5)], so we only sketch the proof here. A
result of Brieskorn-Saito [BS] and Deligne [De] says that Tw2 0 is in the center of the corresponding
braid group. Since the Iwahori-Hecke algebra H is a quotient of the group algebra of the braid
group it follows that Tw2 0 is in the center of H. The constant by which it acts on the irreducible
representation labeled by λ can be checked as follows. The element Tw2 0 − q ℓ(w0 ) is divisible by
(q − 1) and
                       T 2 − q ℓ(w0 )              q ℓ(w0 )+cλ − q ℓ(w0 ) 
                   z = w0               .     Since                              = cλ ,
                            q−1         q=1                  q−1               q=1

and z acts by the constant cλ the element Tw2 0 must act by the constant q ℓ(w0 )+cλ . The result of
the Proposition now follows since T̃w2 0 = q −2ℓ(w0 ) Tw2 0 . An alternative way to obtain the constant
q ℓ(w0 )+cλ which Tw2 0 acts by is to note that

                                                                  λ          λ
                              det(ρλ (Ti )) = (−1)(dλ−χW (si ))/2 q (dλ +χW (si ))/2 ,

for all 1 ≤ i ≤ n, and this and [Bou, Ch. VI §1 Cor. 2] imply that
                                                           λ
                         det(Tw2 0 ) = q 2ℓ(w0 )dλ +2χW (z))/2 = q dλ (ℓ(w0 )+cλ ) .

     Combining Propositions 4.9 and 4.8 gives the following bounds on the convergence of the
systematic scan Metropolis walk on a finite Coxeter group W . Explicit analyses of these bounds
in examples are given in Sections 5,6,7.

Theorem 4.10. Let H be the Iwahori-Hecke algebra corresponding to a finite real reflection group
W . Let K be the systematic scan Metropolis chain on W , i.e. the reversible Markov chain on W
with stationary distribution π determined by left multiplication by the element T̃w2 0 of H where
w0 is the longest element of W . Then
                     X
(a) kK1ℓ /π − 1k22 =    tλ dλ θ 2ℓ(ℓ(w0 )−cλ ) ,
                       λ6=1
      X                            X
(b)         π(x)kKxℓ /π − 1k22 =          d2λ θ 2ℓ(ℓ(w0)−cλ ) ,
      x∈W                          λ6=1

where ℓ(w0 ) is the length of w0 , tλ are the generic degrees (see (3.15)), dλ the dimensions of the
irreducible representations of H, and the constants cλ are as given in Proposition 4.9.


5. The hypercube
     We begin with a simple but instructive example where all details can be carried out. We are
able to analyze and compare both randomized and systematic scans. We show that both kinds of
scans take order n log n operations to converge to stationarity. For small values of θ the systematic
scan converges faster and for θ close to 1 the random scan converges faster.

5a. Preliminaries
                            Metropolis scans and Hecke algebras                                      19

    The Coxeter group W = (Z/2Z)n has generators s1 , s2 , . . . , sn and relations

                             s2i = 1,       si sj = sj si ,       for all 1 ≤ i, j ≤ n.

The set X = W = (Z/2Z)n is the space of binary n-tuples, si is the vector with 1 in the ith
coordinate and 0 elsewhere, and the length function is given by ℓ(x) = |x| = (# of ones in x). The
longest element of W is w0 = s1 s2 · · · sn and ℓ(w0 ) = n.
    The irreducible representations ρλ of the Iwahori-Hecke algebra of (Z/2Z)n are all one-
dimensional and are indexed by n-tuples λ = (λ1 , . . . , λn ), λi ∈ {0, 1}. Let |λ| = λ1 + · · · + λn .
Then                    
               λ          q,   if λi = 0,
              ρ (Ti ) =                           cλ = n − 2|λ|,     and      tλ = q |λ| ,        (5.1)
                          −1, if λi = 1,
where cλ and tλ are the constants defined in Proposition 4.9 and (3.15), respectively.
    Fix 0 < θ ≤ 1 and let

                             q ℓ(x)
                   π(x) =           ,       where q = θ −1               and PW (q) = (1 + q)n    (5.2)
                            PW (q)

is a normalizing constant. Then π is a product measure on (Z/2Z)n since
                                                          ℓ(x)           n−ℓ(x)
                                                 q                     1
                                  π(x) =                                              .
                                                1+q                   1+q


5b. Random scan Metropolis
    The random scan Metropolis algorithm proceeds by choosing a coordinate at random and
attempting to change to its opposite mod 2. If this results in a one, the change is made. If the
change in a zero, flip a coin with parameter θ. If the flip comes up heads change the chosen
coordinate to 0 and if it comes up tails then the coordinate stays at 1. The resulting chain is
                                   
                                    (1/n),             if ℓ(y) = ℓ(x) + 1,
                                   
                                   
                                   
                                   
                                   
                                    (1/n)θ,
                                                       if ℓ(y) = ℓ(x) − 1,
                         K(x, y) =                                                             (5.3)
                                   
                                   
                                   
                                    (ℓ(x)/n)(1  − θ),  if y = x,
                                   
                                   
                                   
                                   
                                     0,                 otherwise.
The following theorem shows that order n log n steps are necessary and sufficient to reach station-
arity.

Theorem 5.4. Let the random scan Metropolis algorithm on (Z/2Z)n be defined by (5.3) with
0 < θ ≤ 1. Then, for any starting state x, and any ℓ,
                                                                                     2ℓ
                                                X                         |λ|
                          kKxℓ /π       2
                                    − 1k2 =            θ   2λ·x−|λ|
                                                                       1−     (1 + θ)     .       (5.5)
                                                                           n
                                                λ6=0

For 0 < θ < 1 and ℓ = n(log n − log θ + c)/2(1 + θ) with c > 0,
                                                −c     
                               kKxℓ − πk2T V ≤ ee − 1 + e−c/2 .                                   (5.6)
20                                                 persi diaconis                 and      arun ram

The bound in (5.6) is sharp in the sense that if ℓ = n(log n − log θ + c)/2(1 + θ) then for all ǫ > 0
there exists a c < 0 such that kK0ℓ − πkT V > 1 − ǫ for all sufficiently large n.

Proof. From the definitions of the irreducible representations of H,
                                                                    
          λ
         χH T̃         x−1   (( n1 )(T̃1   + · · · + T̃n )) T̃x = n−2ℓ q −2ℓ(x)−2ℓ χλH (T1 + · · · + Tn )2ℓ χλH (Tx )2
                                                           2ℓ

                                                                                                           2ℓ
                                                                         = n−2ℓ q −2ℓ ((n − |λ|)q − |λ|) q 2(|x|−λ·x) q −2|x|
                                                                                                    2ℓ
                                                                         = (1 − (|λ|/n)(1 + θ)) θ 2λ·x .

The first statement then follows from Theorem 4.10(a) with the value for tλ given in (5.1). For the
second statement we need to bound the sum on the right hand side of (5.5). Since θ ≤ 1, θ λ·x ≤ θ 0
and
                                          n                     2ℓ
                              ℓ      2
                                         X   n −j         j
                          kKx /π − 1k2 ≤         θ    1 − (1 + θ)      .
                                         j=1
                                             j            n
                                                                           n
                                                                            
Break the sum at n/2. For the first half use                               j     ≤ nj /j! and 1 − x ≤ e−x to give an upper bound

                                           n/2                       n/2
                                           X   1  n j −j(1+θ)2ℓ/n X e−jc      −c
                                                       e           =        ≤ ee − 1.
                                               j! θ                      j!
                                           j=1                                       j=1


For the second half change j to n − k and use the same inequalities to get an upper bound

              n/2 k                                              n/2
              X  n               k−n −(n−k)(1+θ)2ℓ/n
                                                                 X   1 k(log n+log θ+2ℓ(1+θ)/n)−n log θ−2ℓn(1+θ)/n
                             θ      e                          =        e
                       k!                                            k!
              k=0                                                   k=0

        Pm    Ak
Using     k=0 k!         ≤ Am for A ≥ 2 the bound for the second half becomes

         e(n/2)(log n+log θ+2ℓ(1+θ)/n)−n log θ−2ℓn(1+θ)/n = e(n/2)(log n−log θ−2ℓ(1+θ)/n) = e−nc/2 .

     To show that this upper bound is sharp we use the second moment method. With respect to
the action of K on L2 (π) defined in Lemma 4.7 the matrix K(x, y) of (5.3) has an orthonormal
basis of eigenfunctions

                                                                                           |λ|
        fλ (y) = θ −|λ|/2 (−θ)λ·y ,                      with eigenvalues 1 −                  (1 + θ),       λ ∈ (Z/2Z)n .     (5.7)
                                                                                            n

Let ei ∈ (Z/2Z)n be the vector with 1 in the ith entry and 0 elsewhere. We shall use the test
function,
                                                  n                                                                     
               X
                                           −1/2
                                                  X
                                                               yi         −1/2                      n         |y|(1 + θ)
     T (y) =            fei (y) = θ                     (−θ)        =θ           (n − |y|(1 + θ)) = √      1−              .    (5.8)
                   i                              i=1
                                                                                                     θ             n

The expectation and the variance of T with respect to the distribution π are

                                           Eπ (T ) = 0              and          Varπ (T ) = Eπ (T 2 ) = n.                     (5.9)
                              Metropolis scans and Hecke algebras                                21

For i 6= j,
                                                                          1−θ
                             fei fej = fei +ej ,      and      fe2i = f0 + √ fei ,
                                                                            θ
where the second identity is verified by checking that both sides agree when evaluated at each of
the two cases: y such that yi = 1 and y such that yi = 0. We can compute the expectation and
variance of T under the distribution K0ℓ as follows:

                                             n                              ℓ
                    X                        X                  n        1+θ
      Eℓ,0 (T ) =       K ℓ (0, y)T (y) =        (K ℓfei )(0) = √     1−        ,    and      (5.10)
                    y                                            θ        n
                                             i=1


    Varℓ,0 (T ) = Eℓ,0 (T 2 ) − Eℓ,0 (T )2
                                                   
                           n                              2
                                                                      2ℓ
                         X
                                2
                                      X                 n        1 + θ
                = Eℓ,0        fe i +     fe i fe j  −       1−
                          i=1
                                                        θ          n
                                      i6=j
                                   ℓ                        ℓ              2ℓ
                   n(1 − θ)     1+θ      n(n − 1)     2(1 + θ)      n2      1+θ
               =n+           1−        +           1−             −      1−         .
                      θ          n          θ            n          θ        n
    We want to use these formulas to show that ℓ = (n/2(1 + θ))(log n − log θ + c) steps are sharp.
                                                           2
Fixing k and using log(1 − x) = −x − x2 /2 + O(x3 ) and e−x /2 = 1 − x2 /2 + O(x4),
                     ℓ                                     −c k/2                  
             k(1 + θ)       ℓ(−k(1+θ)/n−ℓk 2(1+θ)2 /2n2 )    θe           ℓk 2 (1 + θ)2
          1−             ∼e                               ∼            1−                 ,
                n                                             n                 2n2

when n is large. Thus, for ℓ = (n/2(1 + θ))(log n − log θ + c) and n large,
                √ −c/2
    Eℓ,0 (T ) ∼   ne     , and
                    r                                                                        
                      n           −c/2            −c      ℓ4(1 + θ)2     n2 θ −c     2ℓ(1 + θ)2
  Varℓ,0 (T ) ∼ n +      (1 − θ)e      + (n − 1)e     1−               −     e    1−
                      θ                                       2n2        θ n            2n2
                                                     
                          √                ℓ2(1 + θ)2
              ∼ n + Oc,θ ( n) + ne−c −                  − e−c
                                              2n2
                          √
              = n + Oc,θ ( n) + Oc,θ (log n),

with the error terms depending on c and θ. By first choosing c to be a fixed (large) √  negative
number and then letting n → ∞, we see that, if b is large, the set Ab = {x | |T (x)| ≤ b n} has
probability 1 − 1/b2 under π and probability O(1/b2) under K0ℓ . This completes the proof of the
last statement.


5c. Systematic scan Metropolis

     We turn next to the systematic scan version. Order n log n steps are required here too. Lest
the reader think this contradicts the example which begins this paper, we note that the opening
example (which actually corresponds to the heat bath updating setup) replaces each coordinate
with a freshly chosen pick. Thus a zero coordinate which is chosen can remain zero with probability
θ. For the Metropolis version analyzed here a chosen zero must change to a one.
22                                   persi diaconis        and        arun ram
                                                                                                     
                                                                                              0    1
     With notation as in Section 5a, let N be the chain on Z/2Z with matrix                             . On
                                                                                              θ   1−θ
(Z/2Z)n define Ki acting as N on the ith coordinate. Let

                                         K = K1 K2 · · · Kn Kn · · · K1 .                              (5.11)

This is the systematic scan Metropolis algorithm with stationary distribution π. The following
theorem gives bounds on the distance to stationarity.

Theorem 5.12. Let the systematic scan Metropolis algorithm on (Z/2Z)n be defined by (5.11)
with 0 < θ ≤ 1. Then, for any starting state x and any ℓ
                                                         X
                                     kKxℓ /π − 1k22 =          θ (4ℓ−1)|λ|+2λ·x .                      (5.13)
                                                        λ6=0

                                               
                         1       log n + c
For, 0 < θ < 1 and ℓ =                     +1       with c > 0,
                         4       log(1/θ)

                                                   1  e−c       
                                       kKxℓ − πk2T V ≤ e     −1 .                             (5.14)
                                                   4
                                                                           
                                                          1 log n + c
The bound in (5.14) is sharp in the sense that if ℓ =                   + 1 then for all ǫ > 0 there
                                                          4 log(1/θ)
exists a c < 0 such that kK0ℓ − πkT V > 1 − ǫ for all sufficiently large n.

Proof. From the definitions of the ireducible representations of H,
                                                         
                                      χλH T̃x−1 T̃w2ℓ0 T̃x = θ 4ℓ|λ|+2λ·x .

The first statement then follows from Proposition 4.8(a). Since θ ≤ 1, θ 2λx ≤ θ 0 , and

                                                n                              n
                    kKxℓ /π − 1k22 = 1 + θ 4ℓ−1 − 1 = 1 + e(4ℓ−1) log θ − 1
                                     (4ℓ−1) log θ n          log n+(4ℓ−1) log θ
                                   ≤ ee               − 1 = ee                    − 1,

and the upper bound follows.
    The proof of the lower bound is similar to the random scan case and we only give the variants
needed. As in (5.7) the eigenvectors of the Markov chain are

           fλ (y) = θ −|λ|/2 (−θ)λ·y ,        but with eigenvalues θ 2ℓ|λ| ,        λ ∈ (Z/2Z)n .

Use the same test statistic T as in (5.8). The expectation and the variance of T with respect to
the distribution π are the same as in (5.9) and a calculation similar to that in (5.10) yields that
the expectation and variance of T under the distribution M0ℓ are
                                                                                       
                          n                                               1 − θ 2ℓ 1 4ℓ
              Eℓ,0 (T ) = √ θ 2ℓ ,         and        Varℓ,0 (T ) = n 1 +      θ − θ      .
                           θ                                                θ      θ
                            Metropolis scans and Hecke algebras                               23

               1
For ℓ =              (log n + c),
          4 log(1/θ)

              √                                                      
               n                                   1 − θ −c/2    1 −c                   √
  Eℓ,0 (T ) = √ e−c/2 ,     and Varℓ,0 (T ) = n 1 + √ e       −    e    = n(1 + Oc,θ (1/ n)).
                θ                                  θ n          θn


This allows the argument to conclude as in the proof of Theorem 5.4.


    After ℓ passes the systematic scan algorithm makes 2ℓn basic steps. Thus the results of
Theorems 5.4 and 5.12 show that both scanning strategies converge in order n log n basic steps.
The following table compares the lead term constants for the two scanning strategies at various
values of θ.
                               θ                  random                 systematic

                                                 n log(n/θ)                 n log n
                            general
                                                  2(1 + θ)                2 log(1/θ)
                              1                    n log n                  n log n
                             1+ǫ                      4                  2 log(1 + ǫ)
                               1                  n log 2n                  n log n
                               2                      3                     2 log 2
                                                 n log(n/ǫ)                 n log n
                               ǫ
                                                      2                   2 log(1/ǫ)

We see that the lead term constants make the random scan faster as θ → 1 while the systematic
scan is faster as θ → 0.


6. The dihedral group.

     The hypercube of Section 5 is commutative. This section treats the simplest noncommutative
example – the dihedral group D2n . We completely analyze the convergence of both the randomized
and systematic scans. We find that both scanning strategies take order n operations to converge
to stationarity.


6a. Preliminaries

    The dihedral group of order 2n is the group W given by generators s1 , s2 and relations


                           s21 = 1,   s22 = 1,     and   s1 s2 s1 · · · = s2 s1 s2 · · · .
                                                         | {z } | {z }
                                                           n factors        n factors



This is the group of symmetries of a regular 2n-gon where s1 and s2 act by reflection in axes
24                                                            persi diaconis                                                                                           and                                    arun ram

through the center of the 2n-gon which form an angle of 2π/2n.


                                                                                                                                                                                                                         ...
                                                                                                                                                                                                                     ...
                                                                                                                                                                                                                  ..
                                                                                                                                                                                                              ....
                                                                                                                                                                                                           ...
                                                                                                                                                                                                        ...
                                                                                                                                                                                                       ..
                                                                                      ..................................................................................................................
                                                                                      .
                                                                                   ... .                                                                                                       ... ...
                                                                               ... .                                                                                                         ... .....
                                                                            ...                   .                                                                                      ..
                                                                                                                                                                                           ..                ...
                                                                        ...                          .                                                                                 ..                       ...
                                                                      ..                                                                                                              ..                           ...
                                                              ..
                                                                 ....                                    .
                                                                                                            .
                                                                                                                    s         1                          id                     ..
                                                                                                                                                                                  ....                                ...
                                                                                                                                                                                                                          ...
                                                             .                                                                                                                  .                                            ...
                                                           ..
                                                           .                                                   .                                                             ..
                                                                                                                                                                              .                                                 ...
                                                      ..
                                                       .
                                                         ..
                                                         .                      s s         1           2         .
                                                                                                                     .                                                  .
                                                                                                                                                                        ..
                                                                                                                                                                           ..
                                                                                                                                                                           .          s       2                                   ...
                                                                                                                                                                                                                               . .....
                                                   ... . .                                                                                                           ...                                               .               ...
                                                ...                       .                                             .
                                                                                                                                                                  ....                                          .                        ...
                                              ...                                . .                                       .                                     ..                                . .                                      ...
                                            ..                                                 .                               .                               ..                             .                                                ...
                                          ...
                                          .                                                         .                             .                        .
                                                                                                                                                           ....                         .                                                        ...
                                        .
                                        .                                                                  .                                             .
                                                                                                                                                         .                         .                                                               ...
                                                                                                               .                                                              .
                                 .......
                                                         s s s1 2 1                                                  . . .
                                                                                                                                .       . .. . .
                                                                                                                                                   .
                                                                                                                                                     ....               .                        s s     2 1
                                                                                                                                                                                                                                                     ...
                                                                                                                                                                                                                                                        ...
                                                                                                                                                                                                                                                          ...
                               ...                                                                                                   . . ... .                                                                                                              .
                            .... . . . . . . . . . . . . . . . .. ...... .. . . . . . . . . . . . . . . . ......
                               ...                                                                                                      .   . ..
                                                                                                                                            .                                                                                                               .
                                 ...                                                                                              . ..     .              .                                                                                               ..
                                                                                                                                                                                                                                                          .
                                   ...
                                      ...
                                        ...
                                                   s s s s
                                                         1 2 1 2 . . . ......
                                                                                                                             .          .           .
                                                                                                                                                       .
                                                                                                                                                                .
                                                                                                                                                                     .
                                                                                                                                                                          .
                                                                                                                                                                                .
                                                                                                                                                                                           s s s  2            1               2                   ....
                                                                                                                                                                                                                                                       ...

                                                                                                                                ...                        .                                                                                     ...
                                          ...
                                            ...                                                   . .                         ...                             .
                                                                                                                                                                                     . .
                                                                                                                                                                                                                                              ...
                                                                                            .                                                                                                   .
                                              ...
                                                ...                           .
                                                                                     .
                                                                                                                          ....                                   .                                     .
                                                                                                                                                                                                            .                            . ...
                                                  ... . .                                                                .
                                                                                                                         .                                          .                                              .                    ..
                                                     ... .                                                            ...                                              .                                                   . . ....
                                                       ...                                                         ...                                                    .                                                         ..
                                                         ...                                                     ..                                                                                                               ..
                                                           ...                                                ....                                                           .                                                 ...
                                                             ...                                            .
                                                                                                            ..                                                                  .                                          ....
                                                                 ...                                     ...                                                                       .                                   ...
                                                                    ...                                ..                                                                                                           ..
                                                                       ...
                                                                          ...                       ...                                                                                .                         ...
                                                                             ...                 .
                                                                                                 ...                                                                                      .                  .
                                                                                                                                                                                                             ...
                                                                                ... ...                                                                                                      .            ..
                                                                                   ... ...                                                                                                      . ..
                                                                                     ....................................................................................................................
                                                                                     .
                                                                                     ..
                                                                                 ...
                                                                              ..
                                                                           ...
                                                                       .
                                                                       ...
                                                                   ...
                                                               ...




     Fix 0 < θ ≤ 1 and consider the distribution on W given by

                      q ℓ(w)                                                                                                                                         (q 2 − 1) (q n − 1)
            π(w) =           ,                                  where PW (q) =                                                                                                                                                                                  and q = θ −1 .
                     PW (q)                                                                                                                                           (q − 1) (q − 1)

This measure is largest at the longest element of W , w0 = s1 s2 s1 · · · (n factors), and ℓ(w0 ) = n.
The walks to be analyzed will all start at the identity.
      One may picture the walks described in this section on the 2n chambers of an n-gon. Pick
one chamber (labeled with identity) and identify the two internal sides with s1 , s2 . Reflecting the
fundamental chamber around gives each edge and each chamber a label. The distance ℓ(w) is the
smallest number of chambers required to walk from the chamber labeled by w to the identity. For
example, in D12 , pictured above ℓ(s1 s2 s1 s2 ) = 4.
      The random scan Metropolis walk proceeds from w by choosing one of s1 , s2 with probability
1/2. If ℓ(si w) > ℓ(w) the move is accepted. If ℓ(si w) < ℓ(w) the move is accepted with probability
θ and rejected with probability 1 − θ.
      One pass of the systematic scan Metropolis algorithm chooses n generators in the order
s1 , s2 , s1 , s2 , . . .. Geometrically, starting from the identity, this amounts to marching around the
n-gon. If no rejections are made one complete scan ends in w0 .
      Our bounds result in explicit expressions for the convergence of the two walks. One of these
has been carefully analyzed by Belsey [Be, Ch. VI Thm. 2-10]. He showed

Proposition 6.1. For the random scan Metropolis algorithm starting from the identity
                                          r
                         ℓ       2     −n   1+θ            √ 2ℓ
                      kK1 /π − 1k2 ≤ θ           1 − 12 (1 − θ)2    .                                                                                                                                                                                                                      (6.2)
                                            1−θ
                                                                                                                                                                                                                                                                   n log θ
For 0 < θ < 1 the right hand side of (6.2) is small for k of order                                                                                                                                                                                                              √      .
                                                                                                                                                                                                                                                          2 log(1 − (1/2)(1 −    θ)2 )
                             Metropolis scans and Hecke algebras                                                   25

Belsley [Be, Ch. VI Thm. 4-12] further shows that the random scan Metropolis algorithm has a
total variation cutoff at
                                           2n      √
                                      ℓ=       + c n.
                                          1−θ
       For the systematic scan algorithm our results show
                                                        2              
                     ℓ        2     (4ℓ−1)n    (2ℓ−1)n  θ − 1 θn − 1
                   kK1 /π − 1k2 = θ         +θ               ·       − 1 − θ 2ℓn ,
                                                         θ−1 θ−1

and so, when ℓ = 1,
                                                                             
                                                          θ 2 − 1 −1                  2θ n+1
                            kK1ℓ /π       2
                                      − 1k2 ≤ θ   n
                                                                 ·   −1           =          .                   (6.3)
                                                          1−θ θ−1                     1−θ

Thus, for large n and fixed 0 < θ ≤ 1, a single scan suffices to achieve randomness.
    A comparison of the results in (6.2) and (6.3) shows a mild advantage for systematic scans.
The effect is most pronounced as θ approaches 1.

6b. Representation theory
     References for the statements in this paragraph are [KSo] and [CR, §67C]. The two dimensional
irreducible representations of the Iwahori-Hecke algebra H are indexed by 0 < λ < n/2 and are
given explicitly by
                                                                                    
            λ          1/2   −dξ (1 + ad)ξ                   λ          1/2   a 1 + ad
           ρ (T1 ) = q                        ,    and      ρ (T2 ) = q                  ,   (6.4)
                             ξ −1  −aξ −1                                     1    d

where

  ξ = e2πiλ/n ,       and the equations a + d = q 1/2 − q −1/2                and      − aξ −1 + dξ = q 1/2 − q −1/2

determine a and d. For these representations

                                                      1 (q n − 1) (1 − ξ)(1 − ξ −1 )
                      cλ = 0       and        tλ =                                   q(q + 1).                   (6.5)
                                                      n (q − 1) (q − ξ)(q − ξ −1 )

If n is odd there are two one-dimensional representations of H, the “trivial” representation and
the “sign” representation,

                  ρ1 (T1 ) = ρ1 (T2 ) = q,                with        c1 = n,          and        t1 = 1,


               ρsgn (T1 ) = ρsgn (T2 ) = −1,              with       csgn = −n,        and       tsgn = q n .

If n is even there are two additional one dimensional representations of H,

                                 ρ+ (T1 ) = q,                        ρ− (T1 ) = −1,
                                                            and
                                 ρ+ (T2 ) = −1,                       ρ− (T2 ) = q,

with
                                                                              2q(q n − 1)
                             c+ = c− = 0,             and         t+ = t− =               .
                                                                              n(q 2 − 1)
26                                  persi diaconis       and     arun ram

    The next Proposition computes the traces on the Iwahori-Hecke algebra which are needed in
order to use Proposition 4.8 to give upper bounds for the convergence of the random and systematic
scan Metropolis walks on the dihedral group.

Proposition 6.6. Let W be the dihedral group of order 2n and let w0 be the longest element of
W . Let θ = q −1 and T̃w = q −ℓ(w)Tw as in Theorem 4.3. If χλH is the character of a two dimensional
representation of the Iwahori-Hecke algebra H then
                              
               χλH (T̃w2 0 )2ℓ = 2θ 2ℓn ,   and
                                θ − 2 cos(πλ/n)θ 1/2 − 1 2ℓ  θ + 2 cos(πλ/n)θ 1/2 − 1 2ℓ
     λ                      2ℓ
    χH ((1/2)(T̃1 + T̃2 ))       =                             +                               ,
                                              2                                2

For the one dimensional irreducible characters of H,
                                                                
             χ1H (T̃w2 0 )2ℓ = 1,                  χsgn
                                                     H
                                                         ( T̃ 2 2ℓ
                                                             w0 )    = θ 4ℓn ,
                                                                               
             χ1H ((1/2)(T̃1 + T̃2 )2ℓ = 1,         χsgn
                                                     H
                                                         ((1/2)(  T̃1 + T̃2 )) 2ℓ
                                                                                    = θ 2ℓ ,

and, if n is even,
                                                            
                              χ+
                               H
                                  ( T̃ 2 2ℓ
                                      w0 )    = χ−
                                                 H
                                                     ( T̃ 2 2ℓ
                                                         w0 )    = θ 2ℓn ,      and
                                                                             θ − 1 2ℓ
                 χ+  ((1/2)( T̃1 + T̃2 )) 2ℓ
                                               = χ−
                                                      ((1/2)( T̃1 + T̃2 )) 2ℓ
                                                                               =            .
                  H                               H
                                                                                    2


Proof. The formulas for χλH ((T̃w2 0 )2ℓ ) follow from Proposition 4.9. The results for the one di-
mensional representations are easy consequences of the definitions of the representations ρλ . Let
us compute χλH ((T1 + T2 )m ) for the two dimensional representations. From the definition of the
representations ρλ in 6.4                        
                              Tr ρλ (T1 + T2 ) = 2q 1/2 (q 1/2 − q −1/2 )
and                                                                                             
                det(ρλ (T1 + T2 )) = q (a − dξ)(d − aξ −1 ) + (1 + ξ −1 )(1 + ad)(1 + ξ)
                                                                                  
                                   = q (a + d)(−aξ −1 − dξ) − (1 + ξ −1 )(1 + ξ)
                                                                             
                                   = q (q 1/2 − q −1/2 )2 − (ξ 1/2 + ξ −1/2 )2 .

where ξ = e2πiλ/n . Thus the characteristic polynomial of ρλ (T1 + T2 ) is
                                                                          
 t2 −2q 1/2 (q 1/2 − q −1/2 )t + q (q 1/2 − q −1/2 )2 − (ξ 1/2 + ξ −1/2 )2
                                                                                                        
      = t − q 1/2 ((q 1/2 − q −1/2 ) + (ξ 1/2 + ξ −1/2 )) t − q 1/2 ((q 1/2 − q −1/2 ) − (ξ 1/2 + ξ −1/2 )) .

This determines the eigenvalues of ρλ (T1 + T2 ) and the results follow after substitution of q = θ −1
and T̃i = q −1 Ti .

    The next two theorems give explicit expressions for the norms kK1ℓ /π − 1k22 for the random
and systematic scan Metropolis walks on the dihedral group. Bounds on rates of convergence based
on these expressions appear in the summary of results in Section 6a above.
                                      Metropolis scans and Hecke algebras                                                                                  27

Theorem 6.7. Let K be the systematic scan Metropolis algorithm on the dihedral group defined
by multiplication by the element T̃w2 0 = T̃1 T̃2 T̃1 · · · (2n factors) in the Iwahori-Hecke algebra. Then
                                           2                         
       ℓ        2     (4ℓ−1)n     (2ℓ−1)n   θ − 1 θn − 1
(a) kK1 /π − 1k2 = θ          +θ                        ·         − 1 − θ 2ℓn , and
                                             θ−1 θ−1
    X
(b)      π(x)kKxℓ /π − 1k22 = θ 4ℓn + (2n − 2)θ 2ℓn .
      x∈W


Proof. From (3.15) we have that
                                                                                                                              
                          X                                                   qn − 1                 −n                 θn − 1
                               tλ dλ = PW (q) = (1 + q)                                      =θ           (θ + 1)                    .
                                                                               q−1                                       θ−1
                          λ


From Theorem 4.10(a)
                                                                                                 !
                              X                                           X
      kK1ℓ /π         2
                − 1k2 =              tλ d λ θ   2ℓ(ℓ(w0)−cλ )
                                                                 =              tλ d λ θ   2ℓn
                                                                                                     − t1 d1 θ 2ℓn + tsgn dsgn (θ 4ℓn − θ 2ℓn )
                              λ6=1                                         λ
                               2ℓn                      2ℓn      −n       4ℓn
                          =θ         PW (q) − θ+ θ (θ   − θ 2ℓn )
                                                2                
                             (4ℓ−1)n    (2ℓ−1)  θ − 1 θn − 1
                          =θ         +θ               ·        − 1 − θ 2ℓn .
                                                 θ−1 θ−1
                                          P
Similarly, use the fact that                    λ∈Ŵ    d2λ = 2n to obtain
                                                                                                          !
      X                                         X                                       X
            π(x)kKxℓ /π − 1k22 =                       d2λ θ 2ℓ(ℓ(w0 )−cλ ) =                 d2λ θ 2ℓn       − d21 θ 2ℓn + d2sgn (θ 4ℓn − θ 2ℓn )
      x∈W                                       λ6=1                                     λ
                                                 2ℓn            2ℓn           4ℓn        2ℓn
                                         =θ            2n − θ         +θ            −θ         = θ 4ℓn + (2n − 2)θ 2ℓn .


Theorem 6.8. Let K be the random scan Metropolis algorithm on the dihedral group defined by
multiplication by the element (1/2)(T̃1 + T̃2 ) in the Iwahori-Hecke algebra. Then
                                                                                 
                                    θ 1−n              θ2 − 1         θn − 1
 kK1ℓ /π         2
            − 1k2 = θ      2ℓ−n
                                  +
                                       n               θ−1             θ−1
                                                                                                                                                    2ℓ
                                                         X           2 − 2 cos(2πλ/n)                             θ + 2 cos(πλ/n)θ 1/2 − 1
                                                  ×                                                                                                        ,
                                                                (θ 2 − 2 cos(2πλ/n)θ + 1)                                    2
                                                       0<λ<n


and
                                                                                                                                2ℓ
                     X                                                     X                 θ + 2 cos(πλ/n)θ 1/2 − 1
                           π(x)kKxℓ /π                   2
                                                 − 1k2 = θ      2ℓ
                                                                      +             2                                                    .
                                                                                                        2
                     x∈W                                                  0<λ<n



Proof. Substituting q = θ −1 in the formulas for tλ gives tsgn = θ −n ,
                                                                                                                                                       
          2                    θn − 1                                     θ 1−n (θ + 1)     2 − 2 cos(2πλ/n)                                     θn − 1
 t+ = t− = θ 1−n                                        and          tλ =                                                                                     ,
          n                    θ2 − 1                                           n         2
                                                                                        (θ − 2 cos(2πλ/n)θ + 1)                                   θ−1
28                                        persi diaconis                    and      arun ram

for 0 < λ < n/2. Thus, if K = (1/2)(T̃1 + T̃2 ), Theorem 4.10a gives
                                                               2ℓ                       2ℓ
                     X                                    1−θ                        θ−1                            X
  kK1ℓ /π − 1k22 =          tλ χλ (K 2ℓ ) = t+                          + t−                     + tsgn θ 2ℓ +              tλ χλ (K 2ℓ )
                                                           2                          2
                     λ6=1                                                                                         0<λ<n/2
                                     n
                                                         2ℓ
                             4       θ −1            θ−1                               X
                = θ 1−n                                             + θ 2ℓ−n +                   tλ χλ (K 2ℓ ),
                             n       θ2 − 1           2
                                                                                     0<λ<n/2


where the first term appears only if n is even. The result now follows from Proposition 6.6.
Similarly,
                                                                                      2ℓ
         X                                    X                                  1−θ                       X
              π(x)kKxℓ /π − 1k22 =                   dλ χλ (K 2ℓ ) = 2                       + θ 2ℓ +               2χλ (K 2ℓ )
                                                                                  2
        x∈W                                   λ6=1                                                      0<λ<n/2
                                                                                                        2ℓ
                                               2ℓ
                                                          X             θ + 2 cos(πλ/n)θ 1/2 − 1
                                          =θ        +           2                                              .
                                                                                   2
                                                        0<λ<n




7. The symmetric group
     This section proves Theorem 1.4 and a similar result for a different scanning strategy. The
results show that both scanning strategies require n2 operations up to lead term constants.

Preliminaries
    The symmetric group Sn is generated by the simple transpositions si = (i, i+1), 1 ≤ i ≤ n−1,
and the longest element of Sn is the reversal permutation
                                                                                                            
                                 1  2               ···   n−1           n                                     n
                     w0 =                                                            with         ℓ(w0 ) =      .
                                 n n−1              ···    2            1                                     2

The book of Fulton [Fu] provides a review of the representation theory of Sn and we will adopt the
conventions for tableaux used there. The irreducible representations of the Iwahori-Hecke algebra
H are indexed by partitions λ with n boxes.




                                                      λ=




Number the rows and columns of λ as for matrices. If λi and λ′j denote the length of the ith row
and j th column of λ respectively, the content and the hook length of a box b in position (i, j) of λ
are
                         c(b) = j − i    and     hb = λi − i + λ′j − j + 1,
                                    Metropolis scans and Hecke algebras                                               29

respectively. Set
                ℓ(λ)
                X                                             qk − 1
       n(λ) =           (i − 1)λi ,     and let     [k]q =             and [k]q ! = [k]q [k − 1]q · · · [2]q [1]q ,
                  i=1
                                                               q−1
for each positive integer k. With these notations the dimensions dλ of the irreducible representa-
tions of H, the generic degrees tλ defined in (3.15), and the constants cλ defined in Proposition
4.9, are given by
                          n!            X                                [n]q !
                   dλ = Y ,        cλ =      c(b)    and    tλ = q n(λ) Y          ,         (7.1)
                            hb           b∈λ                               [h b ]q
                               b∈λ                                                       b∈λ
respectively (see [Fu, §7.2 Prop. 2], [Mac, I §7 Ex. 7 and §1 Ex. 3], [Hf, 3.4.14] and [Mac, IV
(6.7)]). The dimension dλ is also equal to the number of standard tableaux of shape λ, i.e. fillings
of the boxes of λ with 1, 2, . . . , n such that the rows are increasing left to right and the columns
are increasing top to bottom (see [Fu, p.53]).
     The next lemma provides bounds on the constants in (7.1) which will be useful for proving
bounds on the convergence times of the systematic scan Metropolis walks that we analyze here.
The bounds on cλ given in part (c) are essentially those given by Diaconis and Shahshahani, see
[D, 3D Lemma 2].

Lemma 7.2. For each partition λ let tλ , cλ and dλ be as defined in (7.1).
                                                λ1    n
     (a)    When θ = 1/q and 0 < θ ≤ 1, tλ ≤ θ ( 2 )−( 2 ) dλ ,
            X                       X          n2j
     (b)      d2λ = n!,    and           d2λ ≤      ,        for each 1 ≤ j ≤ n.
                                                j!
            λ⊢n                      λ
                                             λ1 =n−j
                  
                  λ1 + 1 (n − λ1 )(n − λ1 − 3), if λ1 ≥ n/2,
                 
                     2     2
     (c)    cλ ≤
                 
                  2
                   n /4 − n,                     if λ1 ≤ n/2.
Proof. Set θ = 1/q and use [Mac, I §1 Ex. 2] and [Mac, III §6 Ex. 2], to get
                          n
                                  P      [n]θ !              n     [n]θ !         n X
            tλ = θ −n(λ)−( 2 )−n+( hb ) Y         = θ n(λ )−( 2 ) Y         = θ −( 2 )
                                                         ′
                                                                                         θ r(Q) ,
                                           [hb ]θ                    [hb ]θ            Q
                                                  b∈λ                     b∈λ
where the sum is over all standard tableaux Q of shape λ and r(Q) is the sum of i such that i + 1 is
to the right
            of iλ1in Q. nThus
                                tλ is a sum of dλ monomials where the lowest degree term has degree
    ′     n
n(λ ) − 2 ≥ 2 − 2 . Part (a) follows.
      We can bound   the number of standard tableaux Q of shape λ with λ1 = n − j√ by noting
that there are nj ways of picking the elements not in the first row of Q and at most j! ways of
arranging these to complete a standard tableau. Thus
                                               2
                                                            2
                        X               X              n p           n2j        n2j
                             d2λ ≤          dλ  ≤          j! ≤        2
                                                                           j! =     .
                                                       j            (j!)         j!
                         λ                λ1 =n−j
                          λ1 =n−j

     The inequalities in (c) are direct consequences of
            cλ ≤ c(λ1 ,n−λ1 ) , if λ ≥ n/2,             and       cλ ≤ c(n/2,n/2) , if λ1 ≤ n/2.

Long systematic scan
30                                      persi diaconis              and    arun ram

     As in Section 4a we fix 0 < θ ≤ 1 and consider the Markov chain
                                    
                                     1,      if y = si x and ℓ(y) > ℓ(x),
                        Ki (x, y) = θ,        if y = si x and ℓ(y) < ℓ(x),                              (7.3)
                                    
                                      1 − θ, if y = x.

which is produced by applying the Metropolis construction to the base chain
                                             
                                               1, if y = si x,
                                 Pi (x, y) =
                                               0, otherwise,

with the distribution π as given in (1.1). Recall that the chain Ki can be interpreted as follows:
    From w, try to multiply by si . If this increases the number of inversions of w, carry out
    the multiplication. If it decreases the the number of inversion flip a θ-coin and carry out
    the multiplication if the coin comes up heads. Otherwise stay at w.
The long systematic scan Metropolis chain is the chain given by

                     K = (K1 K2 · · · Kn Kn · · · K2 K1 ) · · · (K1 K2 K2 K1 )(K1K1 ).

The following theorem bounds the rate of convergence of this Markov chain. It shows that a single
scan suffices to be close to stationarity.

Proposition 7.4. Let K be the long systematic scan Metropolis walk on the symmetric group
Sn defined by (4.2). Let dλ , tλ and cλ be the constants given in (7.1) Then, for 0 < θ ≤ 1,
                     X                n
(a) kK1ℓ /π − 1k22 =      tλ dλ θ 2ℓ(( 2 )−cλ ) ,
                      λ6=(n)
     and, with ℓ = 1,                               2 n/2         2
                                    kK11 − πk2T V ≤ en θ − 1 + n!θ n /8+5n/4 ,

    which, when θ < 1, approaches 0 as n → ∞.
    X                        X            n
(b)     π(x)kKxℓ /π − 1k22 =    d2λ θ 2ℓ(( 2 )−cλ ) .
     x∈W                             λ6=(n)
     and, with ℓ = 1,            X                          2 n           2
                                     π(x)kKxℓ /π − 1k2T V ≤ en θ − 1 + n!θ n /2+n ,
                             x∈W

     which, when θ < 1, approaches 0 as n → ∞.

Proof. By Theorem 4.3 this walk is equivalent to the walk on the Iwahori-Hecke algebra H defined
by multiplication by T̃w2 0 with respect to the basis {T̃w | w ∈ Sn }. Thus the equalities in (a) and
(b) are consequences of Theorem 4.10.
     Fix ℓ = 1. If λ1 = n − j and j ≤ n/2 then the bound on cλ from Lemma 7.2(c) gives
               λ1    n       n
             θ ( 2 )−( 2 )+2( 2 )−2cλ ≤ θ j(n−j/2−1/2)−j(j−3) = θ j(n−3j/2+5/2) ≤ θ j(n/4+5/2) ,

and, by using the bounds in Lemma 7.2(a-b), it follows that
                    n/2                                       n/2 2j
                    X   X                      n              X  n
                                    tλ dλ θ 2ℓ(( 2 )−cλ ) ≤
                                                                                         2 n/4
                                                                         θ j(n/4+5/2) ≤ en   θ
                                                                                                 − 1.
                    j=1    λ6=(n)                             j=1
                                                                    j!
                          λ1 =n−j
                           Metropolis scans and Hecke algebras                                          31

When λ1 ≤ n/2, the bound in Lemma 7.2(c) gives
                                X             λ1     n     n
                                         d2λ θ ( 2 )−( 2 )+2( 2 )−2cλ ≤ n!θ n
                                                                             2
                                                                                 /8+5n/4
                                                                                            .
                                  λ
                               λ1 ≤n/2



The upper bound on kK11 − πkT V follows by combining these expressions. The upper bound in (b)
is proved similarly.


Short systematic scan
     We now analyze the convergence of the short systematic scan and prove Theorem 1.4 of the
introduction. The short systematic scan Metropolis chain on the symmetric group is given by

                                         K = K1 K2 · · · Kn Kn · · · K2 K1 ,

where Ki is as in (7.3). The Theorem shows that order n short systematic scans are necessary
and suffice to reach stationarity when starting from the identity. In part (b′ ) it is shown that for
typical starting values this chain converges in order log n scans.

Theorem 7.5. Let K be the short systematic scan Metropolis algorithm on the symmetric group
defined by (4.2). Let dλ , tλ and cλ be the constants given in (7.1). Then
                      X        X
(a) kK1ℓ /π − 1k22 =        tλ   θ 2ℓ(n−1−c(S(n))), where
                      λ6=(n)     S

      the sum is over standard tableaux of shape λ and S(n) denotes the box of S containing n.
  ′
(a ) For ℓ = n/2 − (log n/ log θ) + c with c > 0,
                                      2c+1           2
                      kK1ℓ − πk2T V ≤ eθ    − 1 + n!θ n /8−n(log n)/(log θ)+n(c+1/4) .

    Conversely, if ℓ < n/4 then, for fixed 0 < θ < 1, kK1ℓ − πkT V tends to 1 as n → ∞.
    X                         X        X
(b)     π(x)kK1ℓ/π − 1k22 =        dλ     θ 2ℓ(n−1−c(S(n))), where
      x∈W                        λ6=(n)        S

      the sum is over standard tableaux of shape λ and S(n) denotes the box of S containing n.
  ′
(b ) For 0 < θ < 1 and ℓ = −(log n)/(log θ) + c with c > 0,
                                                                                     n
                         X                                
                                                               θ 2c
                                                                                θc             √
                               π(x)kKxℓ /π           2
                                               − 1k2 ≤ e              −1 +                 e1/12 2πn.
                                                                                 e
                        x∈Sn




Proof. By Theorem 4.3 the Markov chain K is the random walk on {T̃w | w ∈ Sn } defined by
multiplication by T̃n−1 · · · T̃2 T̃12 T̃2 · · · T̃n−1 in the Iwahori-Hecke algebra H corresponding to the
symmetric group Sn . Let H ′ be the Iwahori-Hecke algebra corresponding to the symmetric group
Sn−1 and let H be the Iwahori-Hecke algebra corresponding to Sn . Let w0′ be the longest element
of Sn−1 and let w0 be the longest element of Sn . The inclusion Sn−1 ⊆ Sn induces an inclusion
32                                          persi diaconis            and       arun ram

H ′ ⊆ H of the corresponding Iwahori Hecke algebras. In H the generators Ti are invertible with
Ti−1 = q −1 Ti + (1 − q −1 ). Then

                                           T̃w2 0 T̃w−2                     2
                                                      ′ = T̃n−1 · · · T̃2 T̃1 T̃2 · · · T̃n−1
                                                        0


and so it follows from Proposition 4.9 that, in the representation ρλ of H indexed by the partition
λ, the element

                      K = T̃n−1 · · · T̃2 T̃12 T̃2 · · · T̃n−1       has eigenvalues                θ n−1−c(S(n)) ,

where S runs over standard tableaux of shape λ and S(n) denotes the box of S containing n. This
determines the eigenvalues of K 2ℓ in the representation ρλ and so
                                               X
                                 χλH (K 2ℓ ) =   θ 2ℓ(n−1−c(S(n))),
                                                                 S

where χλH is the irreducible character of the Iwahori-Hecke algebra corresponding to the partition
λ. Parts (a) and (b) now follow from Proposition 4.8.
    Using θ 2ℓ(n−1−c(S(n))) ≤ θ 2ℓ(n−λ1 ) , and the bound for tλ in Lemma 7.2 gives
                          X λ1 n                X               X 1
        kK1ℓ /π − 1k22 ≤       θ ( 2 )−( 2 ) dλ   θ 2ℓ(n−λ1 ) ≤    θ 2 (n−λ1 )(n−λ1 +4ℓ+1−2n) d2λ ,
                                 λ6=(n)                     S                   λ6=(n)


since dλ is the number of standard tableaux of shape λ. Fix ℓ = n/2 − (log n)/(log θ) + c. Then,
using the bound on the sum of d2λ from Lemma 7.2,

     n/2                                          n/2 1 j(1+4ℓ+1−2n+4(log n/ log θ))                ∞
     X   X            1
                                                  X  θ2                                             X θ (2c+1)j          2c+1
                     θ 2 j(j+4ℓ+1−2n) d2λ ≤                                                     =                 = eθ          − 1.
     j=1    λ6=(n)                                j=1
                                                                       j!                           j=1
                                                                                                           j!
           λ1 =n−j



The function (n − λ1 )(n − λ1 + 4ℓ + 1 − 2n) has a minimum at n − λ1 = (−1/2)(4ℓ + 1 − 2n). At
this minimum λ1 = n − 2(log n)/(log θ) + 2c + 1/2 ≥ n/2, and so
     X 1                                    1                              2
         θ 2 (n−λ1 )(n−λ1 +4ℓ+1−2n) d2λ ≤ θ 2 (n/2)(n/2+4ℓ+1−2n) n! = n!θ n /8−(n log n)/(log θ)+n(c+1/4) .
        λ
     λ1 ≤n/2



Combining these sums establishes the upper bound in (a′ ).
   To prove the lower bound in (a′ ) let
                                                                             
                                                          n 
     A = {w ∈ Sn | ℓ(w) > 2ℓ(n − 1)} = w ∈ Sn  ℓ(w) −        < 2(n − 1)(n/4 − ℓ) .
                                                            2

Since each pass of the systematic scan can change the length of a permutation by at most 2(n − 1),

                                                            K1ℓ (A) = 0.                                                           (7.6)

From equation (2.13),
                                              n                  n                        n                  
                         (n − 1) X j           X       (n − 1) X jθ j                                        n
           Eπ (ℓ(w)) = −        +            =     j −        +            =                                    + O(n),
                          1−θ     j=2
                                      1 − θj   j=2
                                                        1−θ     j=2
                                                                    1 − θj                                   2
                                    Metropolis scans and Hecke algebras                                                        33

  and
                                                                         n
                                                  (n − 1)θ X j 2 θ j           (n − 1)θ
                          Varπ (ℓ(w)) =                   2
                                                            −           j  2
                                                                             =          + O(1).
                                                  (1 − θ)     j=2
                                                                  (1 − θ )     (1 − θ)2

  Thus Chebychev’s inequality implies that, when n is large,
                                                                                   
                               Varπ (ℓ(w))                            θ
            π(A) ∼ 1 −                          ∼ 1−                                    .                                    (7.7)
                         (2(n − 1)(n/4 − ℓ))2             4(n − 1)(1 − θ)2 (n/4 − ℓ)2

  If ℓ < n/4 then the right hand side approaches 1 as n → ∞. Thus (7.5) and (7.6) imply that
  kK1ℓ − πkT V → 1 as n → ∞ and this proves the second statement of (a′ ).
        (b′ ) Using the bound θ 2ℓ(n−1−c(S(n))) ≤ θ 2ℓ(n−λ1 ) , gives
                                       X                                               X
                                                 π(x)kK1ℓ /π − 1k22 ≤                        θ 2ℓ(n−λ1 ) d2λ .
                                       x∈Sn                                         λ6=(n)


  Fix ℓ = −(log n)/(log θ) + c. Using the bound in Lemma 7.2(a) gives

                    n/2                              n/2               2j        n/2 2j(ℓ+(log n/ log θ))
                                                               2ℓj n                θ
                    X   X                            X                           X                                  2c
                                     θ 2ℓj d2λ   ≤         θ                 =                                   = eθ − 1,
                    j=1    λ6=(n)                    j=1
                                                                    j!           j=1
                                                                                                 j!
                          λ1 =n−j



  and, by using the bound in Lemma 7.2(b) and the bound on n! given in [Fe, (9.15)],
                                                                                                       n
                           X                                                                       θc             √
                                    θ 2ℓ(n−λ1 ) d2λ            ℓn
                                                      ≤ θ n! = n!n                −n cn
                                                                                       θ   ≤                 e1/12 2πn.
                             λ
                                                                                                   e
                          λ1 ≤n/2



  The result follows by combining the bounds for these two sums.



                                                                 References

[Am1] Y. Amit, Convergence properties of the Gibbs sampler for perturbations of Gaussians, Ann.
      Statistics 24 (1995), 122–140.
[Am2] Y. Amit, On rates of convergence of stochastic relaxation for Gaussian and non-Gaussian
      distributions, J. Multiv. Anal. 38 (1991), 82–99.
 [AG] Y. Amit and U. Grenander, Comparing sweep strategies for stochastic relaxation, J. Mul-
      tiv. Anal. 37 (1991), 197–222.
 [AK] S. Ariki and K. Koike, A Hecke algebra of (Z/rZ) ≀ Sn and construction of its irreducible
      representations, Adv. Math. 106 (1994), 216–243.
  [Be] E. Belsley, Rates of convergence of random walk on distance regular graphs, Probab. Theory
       Related Fields 112 (1998), 493–533.
[Be2] E. Belsley, Rates of convergence of Markov chains related to association schemes, Ph.D.
      thesis, Harvard, 1993.
  34                              persi diaconis     and    arun ram

 [BF] P. Barone and A. Frigessi, Improving stochastic relaxation for Gaussian random fields,
      Probab. Eng. Inform. Sci. 4 (1990), 369–389.
[BHV] L. Billera, S. Holmes, K. Vogtman, Geometry of the space of phylogenetic trees, Technical
      Report, Department of Statistics, Stanford University, 1999.
  [BS] E. Brieskorn and K. Saito, Artin-Gruppen und Coxeter-Gruppen, Invent. Math. 17 (1972),
       245–271.
[Bou] N. Bourbaki, Groupes et algèbres de Lie, Ch. 4,5 et 6, Masson, Paris, 1981.
 [Bw] K. Brown, Buildings, Springer-Verlag, New York-Berlin, 1989.
  [Ca] R. Carter, Finite groups of Lie type – Conjugacy classes and complex characters, Wiley-
       Interscience, John Wiley & Sons, Inc., New York, 1985.
  [Cr] D. Critchlow, Metric methods for analyzing partially ranked data, Lecture Notes in Statis-
       tics 34, Springer-Verlag, Berlin, 1985.
 [CR] C. Curtis and I. Reiner, Methods of representation theory – with applications to finite
      groups and orders, Volumes I and II, Wiley-Interscience, John Wiley & Sons, Inc., New York,
      1981 and 1987.
  [De] P. Deligne, Les immeubles des groupes de tresses généralisés, Invent. Math. 17 (1972), 273–
       302.
   [D] P. Diaconis, Group representations in probability and statistics, Institute of Mathematical
       Statistics, Hayward, CA, 1988.
 [DH] P. Diaconis and P. Hanlon, Eigen-analysis for some examples of the Metropolis algorithm,
      in Hypergeometric functions on domains of positivity, Jack polynomials, and applications
      (Tampa, FL, 1991), 99–117, Contemp. Math., 138, Amer. Math. Soc., Providence, RI, 1992.
 [Det] P. Diaconis, S. Holmes, S. Janson, S. Lalley, R. Pemantle, Metrics on compositions
       and coincidences among renewal sequences, in Random discrete structures, D. Aldous and R.
       Pemantle eds., Springer, New York, 1996.
 [DS] P. Diaconis and L. Saloff-Coste, What do we know about the Metropolis algorithm?, J.
      Computer and System Sciences 57 (1998), 20-36.
  [Fe] W. Feller, An introduction to probability theory and its applications, J. Wiley and Sons,
       New York, 1968.
  [Fi] G. Fishman, Coordinate selection rules for Gibbs sampling, Ann. Appl. Probab. 6 (1996)
       444–465.
 [FV] M. Figner and J. Verducci, Probability models and statistical analyses for ranking data,
      Springer Lecture Notes in Statistics 80, Springer, New York, 1993.
  [Fu] W. Fulton, Young tableaux, With applications to representation theory and geometry, Lon-
       don Math. Soc. Student Texts 35, Cambridge Univ. Press, Cambridge, 1997.
 [GS] J. Goodman and A. Sokal, Multigrid Monte-Carlo method. Conceptual foundations, Phys.
      Rev. D 40 (1989), 2035–2071.
 [HH] J. Hammersley and D. Handscomb, Monte Carlo Methods, Chapman and Hall, London,
      1964.
                           Metropolis scans and Hecke algebras                                   35

 [Hf] P.N. Hoefsmit, Representations of Hecke algebras of finite groups with BN-pairs of classical
      type, Ph.D. Thesis, University of British Columbia, 1974.
 [Hu] J. Humphreys, Reflection groups and Coxeter groups, Cambridge University Press, 1990.
 [KS] J. Kemeny and L. Snell, Finite Markov chains, The University Series in Undergraduate
      Mathematics, Van Nostrand, Princeton, 1960.
[KSo] R. Kilmoyer and L. Solomon, On the theorem of Feit-Higman, J. Combinatorial Theory
      A 15 (1973), 310-322.
[Le1] G. Letac, Problèmes classiques de probabilité sur un couple de Gelfand, in Lect. Notes in
      Math. 861, Springer-Verlag, New York, 1981.
[Le2] G. Letac, Les fonctions sphériques d’un couple de Gelfand symétrique et les chaînes de
      Markov, Advances in Appl. Prob. 14 (1982), 272-294.
[Ma] C.L. Mallows, Non-null ranking models I, Biometrika 44 (1957), 114-130.
[Mac] I.G. Macdonald, Symmetric functions and Hall polynomials, Second edition, Oxford Math-
      ematical Monographs, Oxford University Press, New York, 1995.
[Mar] J. Marden, Analyzing and modeling rank data, Monographs on Statistics and Applied Prob-
      ability 64, Chapman & Hall, London, 1995.
[MR] N. Metropolis, A. Rosenbluth, M. Rosenbluth, A. Teller and E. Teller, Equa-
     tions of state calculations by fast computing machines, J. Chem. Phys. 21 (1953), 1087-1092.
 [Pa] I. Pak, When and how n choose k, in Randomization methods in algorithm design (Princeton,
      NJ, 1997), 191–238, DIMACS Ser. Discrete Math. Theoret. Comput. Sci. 43, Amer. Math.
      Soc., Providence, RI, 1999.
 [Ra] A. Ram, Seminormal representations of Weyl groups and Iwahori-Hecke algebras, Proc. Lon-
      don Math. Soc. (3) 75 (1997), 99–133.
 [RS] G. Roberts and S. Sahk, Updating schemes, correlation schemes, correlation structure,
      blocking and parameterization for the Gibb sampler, J. Royal Statist. Soc. 59 (1997), 291–318.
[RX] K. Ross and D. Xu, Hypergroup deformations and Markov chains, J. Theor. Probability 7
     (1994), 813–830.
 [SB] W. Shannon and D. Banks, Combining classification trees using MLE, Statistics in Medicine
      18 (1999), 727-740.
 [SC] L. Saloff-Coste, Lectures on probability theory and statistics (Saint-Flour, 1996), 301–413,
      Lecture Notes in Math. 1665, Springer, Berlin, 1997.
 [Sc] C. Schoolfield, Random walks on wreath products of groups and Markov chains on related
      homogeneous spaces, Ph.D. Thesis, Dept. of Appl. Math., Johns Hopkins Univ., 1998.
  [Si] J. Silver, Weighted Poincaré and exhaustive approximation techniques for scaled Metropolis-
       Hastings and spectral total variation convergence bounds in infinite commutable Markov chain
       theory, Ph.D. Thesis, Dept. of Math., Harvard University, 1996.
