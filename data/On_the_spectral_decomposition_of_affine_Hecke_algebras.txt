                                              ON THE SPECTRAL DECOMPOSITION OF AFFINE
                                                          HECKE ALGEBRAS
arXiv:math/0101007v4 [math.RT] 18 Sep 2003




                                                                            ERIC M. OPDAM

                                                    Abstract. An affine Hecke algebra H contains a large abelian
                                                    subalgebra A spanned by the Bernstein-Zelevinski-Lusztig basis
                                                    elements θx , where x runs over (an extension of) the root lattice.
                                                    The center Z of H is the subalgebra of Weyl group invariant ele-
                                                    ments in A. The natural trace (“evaluation at the identity”) of the
                                                    affine Hecke algebra can be written as integral of a certain rational
                                                    n-form (with values in the linear dual of H) over a cycle in the al-
                                                    gebraic torus T = spec(A). This cycle is homologous to a union of
                                                    “local cycles”. We show that this gives rise to a decomposition of
                                                    the trace as an integral of positive local traces against an explicit
                                                    probability measure on the spectrum W0 \T of Z. From this result
                                                    we derive the Plancherel formula of the affine Hecke algebra.




                                               Date: February 1, 2008.
                                               1991 Mathematics Subject Classification. 20C08, 22D25, 22E35, 43A32.
                                               The author would like to thank Erik van den Ban, Patrick Delorme, Gerrit
                                             Heckman, Mark Reeder, Klaas Slooten and Atsuko Yamamoto for their helpful
                                             comments and remarks.
                                                                                     1
2

                             Contents
    1. Introduction                                                 3
    2. Preliminaries and description of results                     8
    2.1. The affine Weyl group and its root datum                   9
    2.2. Parabolic subsystems                                      11
    2.3. Root labels                                               11
    2.4. The Iwahori-Hecke algebra as a Hilbert algebra            12
    2.5. Bernstein’s description of the center Z                   15
    2.6. Positive elements and positive functionals                18
    2.7. Casselman’s criteria                                      19
    2.8. The Plancherel measure                                    22
    2.9. Outline of the main results                               23
    3. Localization of τ on Spec(Z)                                28
    3.1. ω-residual cosets                                         30
    3.2. The contour shift and the local contributions             32
    3.3. Application to the trace functional                       42
    3.4. The Plancherel measure ν of Z, and the A-weights of χt    48
    3.5. Discrete series                                           55
    3.6. Temperedness of the traces χt                             57
    4. Localization of the Hecke algebra                           58
    4.1. Lusztig’s structure theorem and parabolic induction       61
    4.2. The tracial states χt and parabolic induction             69
    4.3. The generic residue of the Hecke algebra                  74
    4.4. Unitarity and regularity of intertwining operators        80
    4.5. The Plancherel decomposition of the trace τ               82
    5. Base change invariance of the residual algebra              93
    5.1. Scaling of the root labels                                93
    5.2. Application to the residual algebras                      96
    6. Applications and closing remarks                            98
    6.1. Formation of L-packets of unipotent representations       98
    6.2. Operator norm estimate and the Schwartz completion       100
    6.3. A Hilbert algebra isomorphism; abelian subalgebras       104
    6.4. Central idempotents of C and S                           105
    6.5. Some examples                                            107
    6.6. K-types                                                  112
    6.7. A remark on the residual degrees dπ                      113
    7. Appendix: Residual Cosets                                  114
    7.1. Introduction and quick guide                             114
    7.2. Definition and Classification of Residual Cosets         116
    7.3. Properties of residual and tempered cosets               120
    8. Appendix: Kazhdan-Lusztig parameters                       124
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS                3

  References                                                           129
  Index                                                                132



1. Introduction
   In this paper we will discuss the spectral decomposition of an affine
Hecke algebra H defined over C or, more precisely, of a natural pos-
itive trace τ defined on H. In the standard basis of H, τ is simply
defined by τ (Te ) = 1 and τ (Tw ) = 0 if w 6= e. In addition, H comes
equipped with the natural ∗-operator Tw∗ = Tw−1 . This defines a pre-
Hilbert structure on H by (x, y) := τ (x∗ y). The regular representation
λ × ρ extends to the Hilbert completion H of H, and by the spectral
decomposition of τ we mean the decomposition of H in irreducible ∗-
representations of H × H. By classical results on the decomposition
of traces on C ∗ -algebras of type I (see for example [15]), this is equiv-
alent to the problem of decomposing the trace τ as a superposition
of irreducible characters of ∗-representations of H. We will call this
decomposition the Plancherel decomposition of H, and the associated
positive measure on the spectrum Ĥ will be called the Plancherel mea-
sure.
   In the case of a Hecke algebra of finite type we have the well known
decomposition formula
                                   1 X
(1.1)                         τ=         χπ dπ ,
                                   P
where P denotes the Poincaré polynomial of H (we assume that P 6= 0),
π runs over the finite set of irreducible representations of H, χπ denotes
the corresponding character of π, and dπ is the generic degree of π. The
formula we are going to discuss in the present paper is the affine analog
of equation (1.1).
   This paper is the sequel to [37], where we made a basic study of the
Eisenstein functionals of an affine Hecke algebra H. These Eisenstein
functionals are holomorphic functions of a spectral parameter t ∈ T ,
where T is a complex n-dimensional algebraic torus naturally associ-
ated to H. In [37], we derived a representation of τ as the integral of
the normalized Eisenstein functional times the holomorphic extension
of the Haar measure of the compact form of T , against a certain “global
n-cycle” (a coset of the compact form of T ) in T . The kernel of this
integral is a meromorphic (n, 0)-form on T .
   The present paper takes off from that starting point, and refines
step-by-step the above basic complex function theoretic representation
4                            ERIC M. OPDAM

formula for τ until we reach the level of the spectral decomposition of
τ , extended to a tracial state on the C ∗ -algebra hull C of the regular
representation of H (Main Theorem 4.43). On the simpler level of the
spherical or the anti-spherical subalgebra, a similar approach can be
found in [34] and [19]. In the case of the spherical algebra one should of
course also mention the classical work [31], although the point of view
is different there, and based on analysis on a reductive p-adic group.

1.0.1. Motivation. There are various motivations for the study of the
spectral resolution of τ . A natural application of such a decomposition
is the p-adic analog of the Howlett-Lehrer theory for finite reductive
groups, see for instance [36], [28], [19], [39] and [40]. Here one considers
an affine Hecke algebra which arises as the centralizer algebra of a
certain induced representation of a p-adic reductive group G. The
Plancherel measure of H can be interpreted as the Plancherel measure
of G on a part of Ĝ in this situation. In view of this application
it is important that we obtain an (almost) explicit product formula
for the Plancherel measure (see Main Theorem 4.43). In addition we
characterize exactly which characters W0 r ∈ W0 \T of the spectrum
of the center Z of H support a discrete series representation of H (see
Theorem 3.29). These are the so-called “residual points” (see Appendix
7). This result was recently applied to the representation theory of
reductive p-adic groups, see [20].
   Another motivation for this approach is that it sets the stage for
the definition of a Schwartz-completion S of H (see Subsection 6.2),
and for the subsequent study of the Fourier transform and its inver-
sion on the level of this Fréchet algebra (joint work with Patrick De-
lorme, to appear). This is related to the study of the K-theory and
the cyclic homology of H and its reduced C ∗ -algebra C, in the spirit of
[50], [51]. This point of view is particularly interesting for non-simply
laced cases, since it is natural to expect that the K-theory does not de-
pend on the parameters q(s) of the Hecke algebra. On the other hand,
in the “generic case” these matters seem to be considerably easier to
understand than in the “natural cases”, where the logarithms of the
parameters have rational relations. In view of this, it is important that
we allow the parameters q(s) of the affine Hecke algebra to assume any
real value > 0.

1.0.2. Outline. It may be helpful to give the reader a rough outline of
this paper, and an indication of the guiding principles in the various
stages. We also refer the reader to Subsection 2.9 for a more detailed
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS                5

outline and formulation of the main results (see in particular 2.9.4,
2.9.5 for the results on the Plancherel measure).
   (0). The starting point of the present paper is the definition of
the Eisenstein functional of the affine Hecke algebra, in [37]. These
functionals are matrix coefficients of minimal principal series modules.
The study of their intertwining operators led to a representation of the
trace τ of H, as an integral of a certain rational kernel over a “global”
cycle (see formula (3.1)).
   (1). In section 2 we recall the definition and first properties of (ex-
tended) affine Hecke algebras, we collect some basic facts from the
theory of C ∗ -algebras, and we adapt certain classical results from the
representation theory of reductive groups to our context. We conclude
this section with a discussion of the properties of the natural map
pz : Ĉ → Spec(Z), the spectrum of the center Z of H, in view of the
main results of this paper.
   (2). The study of the residues of the rational kernel for τ as in
formula (3.1), in Section 3. This involves a general (but basic) scheme
for the calculation of multivariable residues. After symmetrization over
the Weyl group, the result is a decomposition of τ as an integral of local
tracial states against an explicit probability measure on the spectrum
Spec(Z) = W0 \T . The main tools in this process are the positivity
of τ , and the geometric properties of the collection of residual cosets
(Appendix 7). This step is called the “localization of the trace τ ”.
   (3). The local trace (as was mentioned in (2)) defined at an orbit
W0 t ⊂ T , arises as an integral of the Eisenstein kernel over a “local
cycle” which is defined in an arbitrarily small neighborhood of the orbit
W0 t. This gives a natural extension of the local trace to localizations
of the Hecke algebra itself (localization as a module over the sheaf of
analytic functions on W0 \T ).
   The analytic localization of the Hecke algebra has a remarkable struc-
ture discovered by Lusztig in [26]. This part of the paper is not self-
contained, but draws heavily on the paper [26]. By Lusztig’s wonderful
structure theorem we can now investigate the local traces. We find
in this way that everything is organized in accordance with Harish-
Chandra parabolic induction (the philosophy of cusp forms). The local
traces at residual cosets give rise to finite dimensional Hilbert algebras
which we call “residual algebras”. Their generic structure reduces (via
parabolic induction) to the case of the residual algebras at “residual
points” of certain semisimple subquotients of the Hecke algebra (see
Subsection 4.3).
6                             ERIC M. OPDAM

   These matters concerning the localization of H are studied in Sec-
tion 4, leading to the main result Theorem 4.43. The support of the
Plancherel measure and the Plancherel density are expressed in terms
of the discrete series of Levi subquotient algebras of H, and their
Plancherel masses (formal dimensions).
   (4). At this point, two essential problems remain: The classification
of the discrete series representations, and the determination of their
formal dimensions. Regarding the first problem, we have determined
the orbits W0 r ∈ W0 \T which arise as the central character of a dis-
crete series representation of H in Theorem 3.29. We have no further
information to offer on this problem in this paper.
   Section 5 is devoted to the second of these problems. In order to ex-
plain our approach, let ν({W0 r}) denote the Plancherel mass of the cen-
tral character W0 r with respect to the restriction of the tracial state τ to
the center Z of H. In Subsection 3.4 we find that the formal dimension
of an irreducible discrete series representation δ whose central charac-
ter is a certain residual point W0 r, is equal to the product of ν({W0 r})
and a certain positive real number dδ > 0 (called “the residual degree”
of δ) depending on δ (see Corollary 3.32 and  P Theorem 3.25). (These
residual degrees are normalized such that         dim(δ)dδ = 1, where the
sum runs over all square integrable δ whose central character is W0 r).
   The factor ν({W0 r}) is a certain explicit product (explicit up to a
nonzero rational multiple) of rational functions evaluated at the central
character W0 r. The problem that arises here is that we have not much
information about the behaviour of the individual “residual degrees”
dδ as functions of the parameters q(s).
   In Section 5 we resolve this matter. If we write the labels q(s) > 0 in
the form q(s) = qfs for certain real numbers fs and q > 1, we prove that
the residual Hilbert algebras are independent of the base q > 1. In other
words, the constants dδ > 0 are independent of q > 1. This proves
that all irreducible discrete series representations of H associated with
a central character W0 r, have a formal dimension which is proportional
to the mass ν({W0 r}), with a positive real ratio of proportionality which
is independent of q > 1.
   In addition we conjecture that the positive reals dδ are actually ratio-
nal numbers (cf. Conjecture 2.27). This conjecture is subject of joint
work in progress with Mark Reeder and Antony Wasserman.
   (5). In Appendix 7 we study the geometry of the set of singularities
with maximal pole order of the rational n-form

                                     dt
(1.2)
                                 c(t)c(t−1 )
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS                 7

on T . This leads to the notion “residual coset”, which is crucially
important for the understanding of the residues of the kernel for τ in
(3.1). It is analogous to the notion of residual subspace which was
introduced in [18]. The collection of these cosets can be classified, and
from this classification we verify certain important geometric properties
of this collection. These geometric facts are used in Section 3 (especially
in Subsection 3.4) to establish regularity properties of the residues to
be considered in this paper.

1.0.3. Residue calculus. Let us make some remarks about the “residue
calculus” on which much of this paper is ultimately based. At the
heart of it lies the elementary Lemma 3.4, which is an adapted version
of Lemma 3.1 of [18]. This lemma roughly states that on a complex
torus T , any linear functional τ on the ring of Laurent polynomials
C[T ] of the form
                                      Z
(1.3)                        τ (f ) =   fω
                                      t0 Tu

where ω is a rational (n, 0)-form whose pole set is a union of cosets of
codimension 1 subtori of T , can be represented by a unique collection
of “local distributions” living on certain cosets of the compact form Tu
of T , and satisfying certain support conditions.
   In the context of the representation theory of H, this lemma be-
comes remarkably efficient. We apply the lemma to linear functionals
of the form a → τ (ah), where h ∈ H and a ∈ A, a maximal abelian
subalgebra of H, using formula (3.1). At this stage we symmetrize
the “local distributions” for the action of W0 . Using the elementary
notion of “approximating sequence” (see Lemma 3.5) it is not hard to
show that the symmetrized local distributions inherit the positivity of
τ . This implies easily that these symmetrized distributions are in fact
compactly supported measures on the spectrum W0 \T of the center
Z = AW0 of H, with values in the positive traces on H (see Corollary
3.23). This means that all higher order terms in the local distributions
cancel out by the symmetrization by W0 .
   In addition it follows by positivity that all measures are absolutely
continuous with respect to a scalar measure ν, the Plancherel measure
of the center Z of H. In fact ν is obtained by evaluation of the sym-
metrized local distributions at 1 ∈ H. Fortunately the poles of formula
(3.1) simplify to the poles of expression (1.2) by this evaluation. In
this way we see that the contributions at non-residual, quasi-residual
cosets must cancel. We can bring into play the geometric properties of
the residual subspaces now, established in Appendix 7, to prove that
8                           ERIC M. OPDAM

the Plancherel measure is smooth on its support, that the local traces
are tempered, and that the local traces at discrete mass points of ν are
finite linear combinations of discrete series characters.
   We get in this way a decomposition of τ as a superposition of posi-
tive “local traces”, which is an important step towards the Plancherel
decomposition of H.
   At the time of the writing of the paper [18], working on the quan-
tum theory of a certain exactly solvable n-particle systems, we were
not aware of the already existing results in the spirit of the above
lemma on existence and uniqueness of residue distributions. But we
should certainly mention here the basic work of Langlands [24], where
residues of Eisenstein series are studied in the theory of automorphic
forms for reductive groupes. We also mention the work of Arthur [1],
[3] in this direction. Langlands’ work [24] was elucidated by Moeglin
and Waldspurger in [35]. Langlands’ result on existence of “residue
data” can be found in Theorem V.2.2, and on uniqueness of “residue
data” in the formulation of Theorem V.3.13(i) of [35]. It should be
pointed out however that these results are of a different nature than
our basic Lemma 3.4. Lemma 3.4 is a (very elementary) general result
in distribution theory, which has nothing to do with group theory. On
the other hand, the above results in [35] are formulated with already
symmetrized “residue data”, using intertwining operators. In order to
even formulate a uniqueness property in this setting, one first needs
to show rather deep statements on the holomorphic continuation of
certain residue sums of Eisenstein series (see V.3.2 of [35]).
   More recently, inspired by the approach in [18], Van den Ban and
Schlichtkrull [5] extended the method by allowing for so-called residue
weights. In this generality they applied the residue calculus in their
proof of the Plancherel formula for semisimple symmetric spaces.


2. Preliminaries and description of results
   The algebraic background for our analysis was discussed in the paper
[37]. The main result of that paper is an inversion formula (see equation
(3.1)) which will be the starting point in this paper. The purpose of
this section is to define the affine Hecke algebra H and to review the
relevant notations and concepts involved in the above result. Moreover
we introduce a C ∗ -algebra hull C of H, which will be the main object
of study in this paper. Finally we will give a more precise outline of
the results in the paper. We refer the reader to [26] and [37] for a more
systematic introduction of the basic algebraic notions.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS                  9

2.1. The affine Weyl group and its root datum
   A reduced root datum is a 5-tuple R = (X, Y, R0 , R0∨ , F0 ) , where
X and Y are free abelian groups with perfect pairing over Z, R0 ⊂ X
is a reduced integral root system, R0∨ ⊂ Y is the dual root system of
coroots of R0 , and F0 ⊂ R0 is a basis of simple roots. Each element
α ∈ R0 determines a reflection sα ∈ GL(X) by
(2.1)                      sα (x) = x − x(α∨ )α.
The group W0 in GL(X) generated by the sα is called the Weyl group.
As is well known, this group is in fact generated by the set S0 consisting
of the reflections sα with α ∈ F0 . The set S0 is called the set of simple
reflections in W0 .
   By definition the affine Weyl group W associated with a reduced
root datum R is the group W = W0 ⋉ X. This group W naturally acts
on the set X.
   We choose once and for all a rational, symmetric, positive definite,
W0 -invariant pairing h·, ·i on Q ⊗ Y . This defines a W0 pairing on the
Euclidean spaces t := R ⊗ Y and its dual t∗ = R ⊗ Y . The action of
W on X extends to an action of W on t∗ by means of isometries.
   We can identify the set of integral affine linear functions on X with
Y × Z via (y, k)(x) := (x, y) + k. It is clear that w · f (x) := f (w −1x)
defines an action of W on Y ×Z. The affine root system is by definition
the subset Raff = R0∨ × Z ⊂ Y × Z . Notice that Raff is a W -invariant
set in Y × Z containing the set of coroots R0∨ . Every element a =
(α∨, k) ∈ Raff defines an affine reflection sa ∈ W , acting on X by
(2.2)                       sa (x) = x − a(x)α.
The reflections sa with a ∈ Raff generate a normal subgroup W aff =
W0 ⋉ Q of W , where Q ⊂ X denotes the root lattice Q = ZR0 . We
can choose a basis of simple affine roots F aff by
(2.3)       F aff := {(α∨, 1) | α ∈ S m } ∪ {(α∨ , 0) | α ∈ F0 },
where S m consists of the set of minimal coroots with respect to the
dominance ordering on Y . It is easy to see that every affine root is
an integral linear combination of elements from F aff with either all
nonnegative or all nonpositive coefficients. The set Raff of affine roots
                                                              aff
is thus a disjoint union of the set of positive affine roots R+   and the set
                           aff           aff
of negative affine roots R− . The set S of simple reflections in W is by
definition the set of reflections in W associated with the fundamental
affine roots. They constitute a set of Coxeter generators for the normal
subgroup W aff ⊂ W .
10                            ERIC M. OPDAM

  There exists an Abelian complement to W aff in W . This is best
understood by introducing the important length function l on W . The
splitting Raff = R+aff   aff
                       ∪R−                                 aff
                             described above implies that R+         aff
                                                               ∩sa (R−   )=
                 aff
{a} when a ∈ F . Define, as usual, the length of an element w ∈ W
by
                                  aff
                        l(w) := |R+   ∩ w −1 (R−
                                               aff
                                                   )|.
 It follows that, when a ∈ F aff ,
                           (
                             l(w) + 1 if w −1 (a) ∈ R+
                                                     aff
                                                         .
(2.4)            l(sa w) =                 −1        aff
                             l(w) − 1 if w (a) ∈ R− .

For any w ∈ W we may therefore write w = ω w̃ with w̃ ∈ W aff and
with l(ω) = 0 (or equivalently, ω(F aff ) = F aff ). This shows that the set
Ω of elements of length 0 is a subgroup of W which is complementary
to the normal subgroup W aff , so that we have the decomposition

                              W = Ω ⋉ W aff .

Hence Ω ≃ W/W aff ≃ X/Q is a finitely generated Abelian group.
   Let m : X → P (where P denotes the weight lattice) denote the
homomorphism that is adjoint to the inclusion Q∨ → Y . If we write
ZX ⊂ X for its kernel, then ZX ⊂ Ω. We have Ω/ZX = Ωf where ZX
is free and Ωf = m(X)/Q ⊂ P/Q is finite. It is easy to see that ZX is
the subgroup of elements in X that are central in W . The finite group
Ωf acts faithfully on S aff by diagram automorphisms.
   The dual cone X + of the cone Q+ spanned by the positive roots is
called the cone of dominant elements of X. Thus x ∈ X belongs to X +
if and only if hx, α∨i ≥ 0 for all positive roots α ∈ R0,+ . Notice that
X + ∩ X − equals the sublattice ZX ⊂ X of translations of length 0.
   Write v = v0 + v 0 for the splitting of v ∈ t∗ according to the orthog-
onal decomposition t∗ = t∗ 0 + t∗0 , where t∗ 0 = R ⊗ Q. We define a
norm

(2.5)                    N (w) = l(w) + kw(0)0k

 for w ∈ W . Notice that for all w, w ′ ∈ W , ww ′(0)0 = w(0)0 + w ′(0)0 .
Thus N (ωw) = N (wω) = l(w) + N (ω) if w ∈ W aff and ω ∈ Ω. We
also see that for all ω ∈ Ω, N (ω k ) = kN (ω) for k ∈ N. It follows easily
that ω ∈ Ω has finite order if and only if N (ω) = 0. Finally notice that
it also follows that

(2.6)                   N (ww ′) ≤ N (w) + N (w ′)
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 11

2.2. Parabolic subsystems
  An important role will be played by parabolic subgroups of a Weyl
group. A root subsystem R′ ⊂ R0 is called parabolic if R′ = R0 ∩ QR′ .
Let P ⊂ R0,+ ∩ R′ be the basis of simple roots. We then often write
RP instead of R′ . The subgroup WP := W (RP ) is called the associated
parabolic subgroup. If P ⊂ F0 , we call RP and WP standard para-
bolic. Every parabolic subgroup is conjugate to a standard parabolic
subgroup. We denote by W P the set of left cosets W0 /WP . If WP is
standard, we identify this quotient with the set of distinguished coset
representatives of minimal length.
  In many instances we obtain a parabolic subsystem R′ as the set of
roots orthogonal to some subspace V L ⊂ t := R ⊗ Y which has the
property that V L = ∩ ker(α) where we take the intersection over all
the roots α such that α(V L ) = 0. By abuse of notation we usually
denote this parabolic subsystem by RL . Similarly we write WL and
W L. We now denote the basis of RL,+ by FL .
  To a parabolic subsystem RP ⊂ R0 we associate a root datum RP :=
(X, Y, RP , RP∨ , P ) and a root datum RP := (XP , YP , RP , RP∨ , P ) where
YP := Y ∩ QRP∨ and XP := X/(X ∩ (RP∨ )⊥ ).

2.3. Root labels
  The second ingredient in the definition of H is a function q on S aff
with values in the group of invertible elements of a commutative ring,
such that
(2.7)         q(s) = q(s′ ) if s and s′ are conjugate in W.
A function q on S aff , satisfying 2.7, can clearly be extended uniquely
to a length-multiplicative function on W , also denoted by q. By this
we mean that the extension satisfies
(2.8)                      q(ww ′) = q(w)q(w ′)
whenever
(2.9)                     l(ww ′) = l(w) + l(w ′ ),
and in addition,
(2.10)                     ∀ω ∈ Ω : q(ω) = 1.
Conversely, every length multiplicative function on W restricts to a
function on S aff that satisfies 2.7. Another way to capture the same
12                           ERIC M. OPDAM

information is by assigning labels qa to the affine roots a ∈ Raff . These
labels are uniquely determined by the rules
                       (i) qwa = qa ∀w ∈ W, and
(2.11)
                      (ii) q(sa ) = qa+1 ∀a ∈ F aff .
Note that a translation tx acts on an affine root a = (α∨ , k) by tx a =
a − α∨ (x). Hence by (i), qa = qα∨ , except when α∨ ∈ 2Y , in which case
qa = q(α∨ ,k(mod2)) . This last case occurs iff W contains direct factors
which are isomorphic to the affine Coxeter group whose diagram equals
Cnaff .
   Yet another manner of labeling will play an important role. It in-
volves a possibly non-reduced root system Rnr , which is defined by:
(2.12)             Rnr := R0 ∪ {2α | α∨ ∈ R0∨ ∩ 2Y }.
Now define labels for the roots α∨ /2 in Rnr∨
                                              \R0∨ by:
                                      q1+α∨
                            qα∨ /2 :=       .
                                       qα∨
 This choice is natural, because it implies the formula
                                     Y
(2.13)                q(w) =                  qα∨ ,
                               α∈Rnr,+ ∩w −1 Rnr,−

for all w ∈ W0 .
   Let RL ⊂ R0 be a parabolic root subsystem. With respect to the
root datum RL we have RL,nr = QRL ∩ Rnr ⊂ Rnr . In this sense we
can define a label function denoted by qL for the root datum RL , by
                   ∨      ∨
restriction from Rnr to RL,nr . Similarly, we define q L by restriction of
q to RL .
   We denote by R1 the root system of long roots in Rnr . In other words
(2.14)                R1 := {α ∈ Rnr | 2α 6∈ Rnr }.

2.4. The Iwahori-Hecke algebra as a Hilbert algebra
  Many of the results of this subsection are well known, see [34]. Let
R be a root datum, and let q be a real number with q > 1. We assume
that for all s ∈ S aff we are given a real number fs . Throughout this
paper we use the convention that the labels as discussed in the previous
subsection are defined by:
Convention 2.1. The labels are of the form
(2.15)                    q(s) = qfs ∀s ∈ S aff .
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 13

   We write q := (q(s))s∈S aff for the corresponding label function on
S aff . The following theorem is well known.
Theorem 2.2. There exists a unique complex associative algebra H =
H(R, q) with C-basis (Tw )w∈W which satisfy the following relations:
    (a) If l(ww ′ ) = l(w) + l(w ′ ) then Tw Tw′ = Tww′ .
    (b) If s ∈ S aff then (Ts + 1)(Ts − q(s)) = 0.
The algebra H = H(R, q) is called the affine Hecke algebra (or Iwahori-
Hecke algebra) associated to (R, q).
  We equip the Hecke algebra H with an anti-linear anti-involutive ∗
operator defined by
                                Tw∗ = Tw−1 .
In addition, we define a trace functional τ on H, by means of τ (Tw ) =
δw,e . It is a well known basic fact that
                        τ (Tw∗ Tw′ ) = δw,w′ q(w),
implying that τ is positive and central. Hence the formula
                          (h1 , h2 ) := τ (h∗1 h2 ),
defines an Hermitian inner product satisfying the following rules:
                      (i) (h1 , h2 ) = (h∗2 , h∗1 ).
(2.16)
                     (ii) (h1 h2 , h3 ) = (h2 , h∗1 h3 ).
The basis Tw is orthogonal for (·, ·). We put
(2.17)                    Nw := q(w)−1/2 Tw
 for the orthonormal basis of H that is obtained from the orthogonal
basis Tw by scaling. Let us denote by λ(h) and ρ(h) the left and right
multiplication operators on H by an element h ∈ H. Let H be the
Hilbert space obtained from H by completion; in other words, H is
the Hilbert space with Hilbert basis Nw . The operator ∗ extends to
an isometric involution on H. Let B(H) denote the space of bounded
operators on the Hilbert space H.
Lemma 2.3. For all h ∈ H, both λ(h) and ρ(h) extend to H as bounded
operators (elements of B(H)), with kλ(h)k = kρ(h)k. For a simple
reflection s ∈ S aff , kλ(Ns )k = max{q(s)±1/2 }.
Proof. We first prove the formula for the norm of kλ(Ns )k (s ∈ S aff ).
For every w such that l(sw) > l(w), λ(Ns ) acts on the two-dimensional
subspace Vw of H spanned by Nw and Nsw as a self-adjoint operator
with eigenvalues q(s)1/2 and −q(s)−1/2 . Since H is the Hilbert sum
of the subspaces Vw , we see that λ(Ns ) extends to H as a self-adjoint
14                           ERIC M. OPDAM

operator with operator norm equal to q(s)±1/2 . Hence for any h ∈
H, λ(h) extends as a bounded operator on H. Finally notice that
(λ(h)∗ (x))∗ = ρ(h)(x), proving the equality kλ(h)k = kρ(h)k.   

  The above lemma shows that H has the structure of a Hilbert algebra
in the sense of Dixmier [14]. Moreover, this Hilbert algebra is unital,
and the Hermitian product is defined with respect to the trace τ .
  We define the operator norm k·ko on H by khko := kλ(h)k = kρ(h)k.
The closure of H with respect to the operator norm k · ko is denoted by
C. The map λ (ρ) extends to an isometry from C to the C ∗ -subalgebra
λ(C) ⊂ B(H) (ρ(C) ⊂ B(H) resp.), the norm closure of λ(H) (ρ(H)
resp.).
  We identify C with a subset of H via the continuous injection c →
λ(c)(1). We equip C with the structure of a unital C ∗ -algebra by the
product c1 c2 := λ(c1 )(c2 ) = ρ(c2 )(c1 ) and the ∗-operator coming from
H. Then λ (ρ) is a faithful left (right) representation of C in the Hilbert
space H (note that we consider ρ as a right representation on H).
Definition 2.4. We call C the reduced C ∗ -algebra of H, and λ (ρ) is
called the left (right) regular representation of C on H.
  An element a ∈ H is called bounded if there exists an element λ(a) ∈
B(H) such that for all h ∈ H,
(2.18)                     λ(a)(h) = ρ(h)(a).
By continuity we see that λ(a) is uniquely determined by a = λ(a)(1).
   When a ∈ H is bounded, there also exists a unique ρ(a) such that
for all h ∈ H,
(2.19)                     ρ(a)(h) = λ(h)(a).
It is obvious that the elements of C are bounded. Let us denote by N ⊂
H the subspace of bounded elements. We equip N with the involutive
algebra structure defined by the product n1 n2 := λ(n1 )(n2 ) = ρ(n2 )(n1 )
and the ∗ operator as before.
Proposition 2.5. The subspace λ(N) := {λ(a) | a ∈ N} ⊂ B(H) is the
von Neumann algebra completion of λ(H). In other words, λ(N) is the
closure of λ(H) in B(H) with respect to the strong topology (defined by
the semi-norms T → kT (x)k with x ∈ H). The analogous statements
hold when we replace λ by ρ. The centralizing algebra of λ(N) is ρ(N).
Proof. All this can be found in [14], Chapitre I, paragraphe 5. In
general, λ(N) is a two-sided ideal of the von Neumann algebra hull of
λ(H), but in the presence of the unit 1 ∈ H the two spaces coincide.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 15

In fact, when A ∈ B(H) and A is in the strong closure of λ(H), it is
simple to see that A(1) ∈ H is bounded.                           

   The pre-Hilbert structure coming from H gives N itself the structure
of a unital Hilbert algebra. The algebra N can and will be identified
with its associated standard von Neumann algebra λ(N). In this situ-
ation, N is said to be a saturated Hilbert algebra (with unit element).
   Let H∗ denote the algebraic dual of H, equipped with its weak topol-
ogy. Notice that τ extends to H∗ by the formula τ (φ) := φ(1). The
∗-operator can be extended to H∗ by φ∗ (h) := φ(h∗ ). We have the
following chain of inclusions:
(2.20)                H ⊂ C ⊂ N ⊂ H ⊂ C′ ⊂ H∗ .
(where C′ denotes the space of continuous linear functionals on C).
Proposition 2.6. The restriction of τ to N is central, positive and
finite. It is the natural trace of the Hilbert algebra N, in the sense that
(2.21)                         τ (a) = (b, b)
for every positive a ∈ N, and b ∈ N such that a = b2 .
Proof. A square root b is in N and is Hermitian (i.e. b∗ = b). Then
(b, b) = (1, a) = τ (a).                                         

Corollary 2.7. The Hilbert algebra N is finite.
Corollary 2.8. The tracial state τ on C is finite, and we have λ = λτ
and ρ = ρτ , where λτ and ρτ are the representations of C naturally
associated with the state τ (the classical GNS-construction).
Proof. This is immediate from the definitions, see [15], Paragraphe 6.7.



2.5. Bernstein’s description of the center Z
   By a well known (unpublished) result of J. Bernstein (see [26]), H
can be viewed as the product H0 A or AH0 of an abelian subalgebra
A (isomorphic to the group algebra of the lattice X), and the Hecke
algebra H0 = H(W0 , q|S0 ) of the finite Weyl group W0 . Both product
decompositions H0 A and AH0 give a linear isomorphism of H with the
tensor product H0 ⊗ A. The relations between products in H0 A and in
AH0 are described by the Bernstein-Zelevinski-Lusztig relations (see for
example [37], Theorem 1.10), and with the above additional description
of the structure of A and H0 these give a complete presentation of H.
16                           ERIC M. OPDAM

   The algebra A has a C-basis of invertible elements θx (with x ∈ X)
such that x → θx is a monomorphism of X into the group of invertible
elements of H. This monomorphism is uniquely determined by the
property that θx = Ntx (see (2.17)) when x ∈ X + . As an important
corollary of this presentation of H, Bernstein identified the center Z
of H as the space Z = AW0 of W0 -invariant elements in A (see [37],
Theorem 1.11). The following Proposition is well known and easy (cf.
[37], Proposition 1.12):
Proposition 2.9. Let w0 ∈ W0 denote the longest element of W0 .
Then we have for all x ∈ X:
(2.22)                    θx∗ = Tw0 θ−w0 (x) Tw−1
                                                0
                                                  .
In particular, A ⊂ H is not a ∗-subalgebra in general. The center
Z ⊂ H is a Hilbert subalgebra.
  Let T = Spec(A) = HomZ (X, C× ) . This algebraic torus of complex
characters of X has a natural W0 -action, and we have Spec(Z) ≃
W0 \T .
Proposition 2.10. The Hecke algebra H is finitely generated over its
center Z. At a maximal ideal m = mt (with t ∈ T ) of Z, the local rank
equals |W0 |2 if and only if the stabilizer group Wt ⊂ W0 is generated by
reflections.
Proof. It is clear that H ≃ H0 ⊗ A is finitely generated over Z = AW0 .
When Wt is generated by reflections, it is easy to see that the rank of
m-adic completion Âm over Ẑm is exactly |W0 | (see Proposition 2.23(4)
of [37]).                                                             

  This fact plays a predominant role in the representation theory of C.
Let us look at some basic consequences.
Corollary 2.11.          (i) Let π be a finite dimensional irreducible rep-
         resentation of H with representation space V . The dimension
         of V is less than or equal to |W0 |.
    (ii) In addition, the center Z of H acts by scalars on V . Thus π
         determines a “central character” tπ ∈ Spec(Z) such that for
         all z ∈ Z, π(z) = tπ (z) IdV .
   (iii) The characters of any finite set of inequivalent finite dimen-
         sional irreducible representations of H are linearly indepen-
         dent.
   (iv) A topologically irreducible ∗-representation π of the involutive
         algebra H is finite dimensional.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 17

Proof. Elementary and well known. Use the Frobenius-Schur theorem
for (iii), Dixmier’s version of Schur’s lemma for (iv), and Proposition
2.10.                                                                 

Corollary 2.12. (See also [34]) Restriction to H induces an injec-
tion of the set Ĉ into the space Ĥ of finite dimensional irreducible
∗-representations of H. Consequently, the C ∗ -algebra C is of finite type
I.
Proof. Because H ⊂ C is dense, it is clear that a representation of C is
determined by its restriction to H and that (topological) irreducibility
is preserved. Hence by the previous Corollary, all irreducible represen-
tations of C have finite dimension.                                   

   We equip T and W0 \T with the analytic topology. Given π ∈ Ĉ
we denote by W0 tπ ∈ W0 \T the character of Z such that χπ (z) =
dim(π)z(tπ ) (note that π(Z) can not vanish identically since 1 ∈ Z).
   By Proposition 2.9, the ∗-operator on Z is such that z ∗ (t) = z(t−1 ).
When π ∈ Ĉ, we have χπ (x∗ ) = χπ (x). It follows that t−1   π ∈ W0 tπ
                                        herm
for all π ∈ Ĉ. Let us denote by W0 \T       the closed subset {W0 t ∈
         −1
W0 \T | tπ ∈ W0 tπ } of W0 \T .
Proposition 2.13. The map pz : Ĉ → W0 \T defined by pz (π) = W0 tπ
is continuous and finite. Its image S = pz (Ĉ) ⊂ W0 \T herm is the
spectrum Ẑ of the closure Z of Z in C. The map pz : Ĉ → S is closed.
Proof. It is clear that the image is in W0 \T herm and that the map is
finite (by Proposition 2.10). Since W0 \T is Hausdorff and Ĉ is compact,
the map pz is closed if it is continuous.
   So it remains to show that pz is continuous. The closure Z ⊂ C is
a unital commutative C ∗ -subalgebra of C. By the Gelfand transform
it is isomorphic to the algebra of continuous functions C(Ẑ) on the
compact Hausdorff space Ẑ. Denote by α the map α : Ĉ → Ẑ defined
by the condition χπ |Z = dim(π)α(π). By Proposition 2.10.2 of [15], α is
surjective. In other words, every primitive ideal M of C intersects Z in
a maximal ideal m of Z, and all maximal ideals of Z are of this form.
The corresponding surjective map from the set Prim(C) of primitive
ideals of C to the set of maximal ideals Max(Z) is also denoted by
α. Next we claim that α is continuous. The topologies of Ĉ and Ẑ
are defined by the Jacobson topologies on Prim(C) and Max(Z). This
means that U ⊂ Prim(C) is closed if and only if every M ∈ Prim(C)
which contains I(U) = ∩u∈U u is in U. Let V ⊂ Max(Z) be closed, and
18                          ERIC M. OPDAM

put U = α−1 (V ). By the surjectivity of α we have I(U) ∩ Z = I(V ).
Hence if M ∈ Prim(C) contains I(U), then α(M) = M ∩ Z contains
I(V ), implying that α(M) ∈ V . Therefore M ∈ U, proving that U is
closed as desired.
   Next, we consider the injective map β : Ẑ → W0 \T defined by
restriction to Z ⊂ Z. Its image S ⊂ W0 \T herm is bounded because for
every z ∈ Z, kzko = maxχ∈Zˆ |χ(z)| = maxs∈S |z(s)|, showing that each
|z| with z ∈ Z has a maximum on S. Because S ⊂ W0 \T herm, we see
that z ∗ (s) = z(s) for each z ∈ Z and s ∈ S. By the Stone-Weierstrass
theorem, the restriction to S of a continuous function f ∈ C(W0 \T ) can
be uniformly approximated by elements in Z considered as functions
on S. In other words, there exists a z ∈ Z such that f (β(χ)) = χ(z)
for all χ ∈ Ẑ. Hence f ◦ β is continuous on Ẑ for all f ∈ C(W0 \T ),
showing that β is continuous and S = S. Since Ẑ is compact and
S is Hausdorff it follows that β : Ẑ → S is a homeomorphism. The
proposition now follows from the remark that pz = β ◦ α.               


2.6. Positive elements and positive functionals
Definition 2.14. We denote by H+ the set of Hermitian elements
h ∈ H such that ∀x ∈ H : (hx, x) ≥ 0. We call this the set of positive
elements of H.
   By spectral theory in the Hilbert completion H ⊃ H, this is equiv-
alent to saying that λ(h) ∈ B(H) is Hermitian and has its spectrum
in R≥0 . Thus H+ is the intersection of H with the usual positive cone
C+ of the completion C. It is clear that for all x ∈ H, x∗ x ∈ H+ but
not every positive element is of this form. We write Hre for the real
subspace of Hermitian (or real) elements, i.e. h ∈ H such that h∗ = h.
Lemma 2.15.           (i) If z ∈ Z+ , h ∈ H+ then zh ∈ H+ .
     (ii) If h ∈ Hre and A ∈ R+ such that A ≥ khko , then A.1 + h ∈
          H+ .
                      √
Proof. A square root√ z ∈ Z,√the closure of Z in C, of z has obviously
the property that λ( z) = ρ( z). Hence for every x ∈ H, h ∈ H+ :
                                  √        √
                  (zhx, x) = (hλ( z)x, λ( z)x) ≥ 0.
The second assertion follows since Spec(λ(h)) ⊂ [−khko , khko ].      

Definition 2.16. We call a linear functional χ ∈ H∗ positive if χ(x) ≥
0 for all x ∈ H+ .
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 19

Corollary 2.17.          (i) A positive linear functional χ ∈ H∗ extends
         uniquely to a continuous functional χ ∈ C′ with norm kχk =
         χ(1).
    (ii) The character χπ of an irreducible representation π of C is a
         positive functional χπ ∈ C′ .
   (iii) An irreducible ∗-representation π of H extends to C if and
         only if its character is a positive functional.
Proof. (i). By the above Lemma 2.15, |χ(x)| ≤ χ(1)kxko for all Her-
mitian x ∈ H. In addition, the bitrace (x, y) := χ(x∗ y) is a posi-
tive semi-definite Hermitian form, and thus satisfies the Schwarz in-
equality. Hence for arbitrary x ∈ H we have |χ(x)|2 ≤ χ(x∗ x)χ(1) ≤
χ(1)2 kx∗ xko = χ(1)2 kxk2o , proving the continuity of χ.
   (ii). Because every irreducible representation π of C is finite dimen-
sional (Corollary 2.12), it is clear that the character χπ (x) is a well
defined positive functional on C. It is continuous by (i).
   (iii). If the character χπ is positive, we have by (i) that χπ extends
to a finite continuous character of C. Because C is of finite type I (and
thus liminal), the standard construction in [15], paragraphe 6.7 shows
that there is up to equivalence a unique irreducible representation π̃ of
C whose character is χπ . The converse statement follows by (ii).       

Remark 2.18. In general not all irreducible ∗-representations of H
extend to C. See for instance Corollary 6.4.

2.7. Casselman’s criteria
   For later use, we discuss in this subsection a suitable version of Cas-
selman’s criteria (see [11], Lemma 4.4.1) to decide whether a represen-
tation of H is tempered (see the definition below) or is a subrepresen-
tation of H. See also [34].
   Recall the norm function N on W as was introduced in Section 2.
Definition 2.19. A functional f ∈ H∗ is called tempered if there exists
an N ∈ N and constant C > 0 such that for all w ∈ W ,
(2.23)                 |f (Nw )| ≤ C(1 + N (w))N .
Here Nw = q(w)−1/2 Tw are the orthonormal basis elements of H intro-
duced in (2.17).
  Let (V, π) be a finite dimensional module over H, and let t ∈ T .
We define Vt := {v ∈ V | ∀a ∈ A ∃n ∈ N : (a − a(t))n (v) = 0}.
The nonzero subspaces of the form Vt ⊂ V are called the generalized
20                             ERIC M. OPDAM

A-weight spaces of V . We call the corresponding elements t ∈ T the
A-weights of V .
Lemma 2.20. (Casselman’s criterion for temperedness). The follow-
ing statements are equivalent:
      (i) All matrix coefficients of π are tempered.
     (ii) The character χ of π is tempered.
    (iii) The weights t of the generalized A-weight spaces of V satisfy
          |x(t)| ≤ 1, for all x ∈ X + .
Proof. (i)⇒(ii). This is trivial.
  (ii)⇒(iii). If there exists a weight t of V violating the condition,
then there exists a x ∈ X + such that |x(t)| > 1. We may assume that
|x(t)| ≥ |x(t′ )| for all weights t′ of V . By Lemma 4.4.1 of [11], the
function
                               X
(2.24)       fx (n) = |x(t)|−n      dim(Vt′ )x(t′ )n = |x(t)|−n χ(θnx )
                                   t′

is not summable on N. Hence for all ǫ > 0, χ(θnx ) can not be bounded
by a constant times |x(t)|n(1−ǫ) . On the other hand, suppose that χ
is tempered. Since θnx = Nnx and N (nx) = nN (x), we obtain that
χ(θnx ) is bounded by a polynomial in n, a contradiction.
   (iii)⇒(i) Recall that the elements Tu θx Tv with x ∈ X + , u, v ∈ W0
span the subspace of H with basis Nw , where w runs over the double
coset W0 xW0 ⊂ W (see the proof of Lemma 3.1 of [37]). It is not
difficult to see that in fact we can write, for w = uxv ∈ W0 xW0 with
x ∈ X +,
                               X
(2.25)                Nw =          cw,(u′ ,v′ ) Tu′ θx Tv′ ,
                              v′ ,u′ ∈W0

such that the coefficients cuxv,(u′ ,v′ ) and cuyv,(u′ ,v′ ) are equal if x and y
belong to the same facet of the cone X + . Moreover, by the length
formula [37], equation 1.1, we have
(2.26)            l(x) − |R0,+ | ≤ l(uxv) ≤ l(x) + |R0,+ |
with l(x) = x(2ρ∨ ). Thus we also have
(2.27)         N (x) − |R0,+ | ≤ N (uxv) ≤ N (x) + |R0,+ |.
It therefore suffices to show that the matrix entries of π(θx ) with x ∈
X + are polynomially bounded in N (x) = x(2ρ∨ ) + kx0 k. Since V is a
direct sum of generalized A-weight spaces Vt , it is enough to consider
the matrix coefficients of a generalized A-weight space Vt with weight
t, satisfying the condition (iii). Observe finally that it is sufficient to
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 21

consider the case that x = x0 + x0 ∈ Q + ZX , a sublattice in X of finite
index.
   By Lie’s Theorem we can put the π(θx ) simultaneously in upper
triangular form. Choose Z+ -generators x1 , . . . , xm for the cone Q+ ,
and a basis xm+1 , . . . , xn for the lattice ZX . The Jordan decomposition
π(θxi ) = Di Ui gives mutually commuting matrices Di and Ui , with Di
semisimple and Ui unipotent upper triangular. By conjugation in the
group of invertible upper triangular matrices we may assume that the
commuting semisimple matrices Di are diagonal. The strictly upper
triangular matrices Mi = log(Ui ) are commuting and satisfy
(2.28)                  π(θxi )|Vt = xi (t) exp(Mi )|Vt .
                Pn
Hence for x =     i=1 li xi ,   with li ∈ Z+ when 1 ≤ i ≤ m, we have
                                             n
                                             X
(2.29)               π(θx )|Vt = x(t) exp(         li Mi |Vt ).
                                             i=1

Since |x(t)| ≤ 1 by assumption, and the exponential map is polynomial
of degree N := maxt {dim(Vt )} − 1 on the space of strictly upper tri-
angular matrices commuting with π(A), we see that the matrix entries
are bounded by a polynomial of degree N in the coefficients li . Ob-
serve that xi (2ρ∨ ) ∈ Z>0 when 1 ≤ i ≤ m. Since the coefficients li are
nonnegative this implies that for all 1 ≤ i ≤ m, li ≤ x(2ρ∨ ). On the
other hand, there exists a constant d > 0 independent of x such that
|li | ≤ dkx0 k for all i > m. Thus there exists a constant d′ independent
of x such that |li| ≤ d′ N (x) for all i. This gives us the desired estimate
of the matrix entries by a polynomial in N (x), of degree N.              

Definition 2.21. A representation π of H satisfying the above equiv-
alent conditions is called a tempered representation of H.
  Along the same lines one proves:
Lemma 2.22. (Casselman’s criterion for discrete series representa-
tions.) Let (V, π) be a finite dimensional representation of H. The
following are equivalent:
       (i) (V, π) is a subrepresentation of (H, λ).
      (ii) All matrix coefficients of π belong to H.
     (iii) The character χ of π belongs to H.
     (iv) The weights t ∈ T of the generalized A-weight spaces of V
           satisfy: |x(t)| < 1, for all 0 6= x ∈ X + .
      (v) ZX = {0}, and there exist C > 0, ǫ > 0 such that the inequality
           |m(Nw )| < Cq−ǫl(x) holds for all matrix coefficients m of π.
22                           ERIC M. OPDAM

Proof. (i)⇔(ii) Let E denote the projector of H onto V . Then E = ρ(e)
for some idempotent of N, and since E is open we have V = He ⊂
N. Choose an orthonormal basis vi of V . The corresponding matrix
coefficients (vi , xvj ) = (vi vj∗ , x) can be identified with the elements
vj vi∗ ∈ H. Conversely, suppose that, given a basis vi of V with dual
basis φj of V ∗ , there exist elements hi,j ∈ H such that for all x ∈ H,
φi (π(x)vj ) = (h∗i,j , x). It follows that for each i, the map vj → hi,j
defines an embedding of (V, π) as a subrepresentation of (H, λ).
   (ii)⇒(iii)⇒(iv)⇒(v) This is similar to the proof of Lemma 2.20. For
the last implication we first remark that (iv) implies that X + can not
contain −x for any x ∈ X + . Thus ZX = {0} in this case, hence
N (x) = l(x).
   (v)⇒(ii) The number of elements in W with length l grows poly-
nomially
P          in l. Thus, by the exponential decay, it is clear that m =
          ∗                                                       ∗
   w m(Nw )Nw is convergent in H, and moreover m(x) = (m , x).           

Corollary 2.23. If the A-weights of a finite dimensional representa-
tion (V, π) of H satisfy the condition of Lemma 2.22(iv), then V carries
a Hilbert structure such that π is a ∗-representation of H, and moreover
π extends to a representation of C.
Definition 2.24. Irreducible representations of H satisfying the equiv-
alent conditions of Lemma 2.22 are called discrete series representa-
tions.

2.8. The Plancherel measure
  Since C is separable, liminal and unital, the spectrum Ĉ is a compact
T1 space with countable base. Moreover it contains an open dense
Hausdorff subset.
  The algebra C comes equipped with the tracial state τ , defining the
representations λ, ρ : C → B(H) of C (see Corollary 2.8). The general
theory of the decomposition of a trace on a separable, liminal C ∗ -
algebras (see [15], paragraphe 8.8), asserts that there exists a unique
positive Borel measure µP l on Ĉ such that
                            Z ⊕
(2.30)                  H≃       End(Vπ )dµP l (π)
                              Ĉ
and such that
                                   Z
(2.31)                  τ (h) =             χπ (h)dµP l (π).
                                       Ĉ
The measure µP l is called the Plancherel measure.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 23

Theorem 2.25. The support of µP l is equal to Ĉ. In addition, an
irreducible representation π of C is a subrepresentation of (H, λ) if and
only if µP l (π) > 0
Proof. The representation λτ = λ associated with the state τ is faithful
(see Subsection 2.4). The results thus follow from Proposition 8.6.8 of
[15].                                                                 

  The center Z of N will be mapped onto the algebra of diagonalizable
operators L∞ (Ĉ, µP l). This is an isomorphism of algebras, continuous
when we give Z the weak operator topology and L∞ (Ĉ, µP l ) the weak
topology of the dual of L1 (Ĉ, µP l ). It is an isometry.
Remark 2.26. In many cases there exist non µP l -negligible subsets V
of Ĉ such that 1 < |p−1
                       z (y)|(< ∞) for all y ∈ pz (V ). For instance, the
affine Hecke algebra of type G2 has two discrete series representations
π3 , π2,1 associated with the subregular unipotent class G2 (a1) (notation
as in [10], Section 13.3) of the complex algebraic group of type G2 (also
see Appendix 8). Then pz (π3 ) = pz (π2,1 ) is equal to the W0 -orbit of the
weighted Dynkin diagram associated with G2 (a1). According to Lemma
2.22 and Theorem 2.25, both {π3 } and {π2,1 } are non-negligible.
   In such case, the above remarks imply in particular that the weak
closure of Z in N is strictly smaller than Z, the center of N.

2.9. Outline of the main results
   This subsection is a continuation of the outline given in 1.0.2.
   It is our goal to describe the spectral measure of the tracial state τ
of C explicitly. We will not completely succeed, as was explained in
1.0.2(4), but we will obtain a product formula for the density of µP l on
each component of its support, explicit up to a (intractable) positive
real constant factor. An important intermediate step is the description
of the more easily accessible spectral measure ν of the restriction of τ
to the closure Z ⊂ C.

2.9.1. Plancherel measure ν of Z. The subalgebra Z ⊂ H is a ∗-
subalgebra. The spectral measure ν of the restriction of τ to Z is
determined in Subsection 3.4 by the use of the residue calculus.
  A residual coset L ⊂ T is a coset of a subtorus of T such that the
pole order of the rational function
                                      1
(2.32)
                              c(t, q)c(t−1 , q)
24                             ERIC M. OPDAM

along L is equal to codim(L). Here c(t, q) denotes Macdonald’s c-
function, see equation (3.4). In Appendix 7 this collection of residual
cosets is carefully introduced, classified and studied. It turns out to be
a finite, W0 -invariant collection of cosets, with various good properties
which play an important role in the calculus of residues (see Subsection
7.3 of Appendix). The residual cosets are of the form (cf. Proposition
7.3 and 7.4) L = rL T L, where T L is the connected component of the
unit element e in the fix point set in T of the Weyl group WL of a
parabolic subsystem RL of R0 (a subtorus of T ), and where rL ∈ TL =
Hom(XL , C× ) ⊂ T is a residual point with respect to the root datum
RL and the restriction qL of q (see Subsection 2.3). This reduces the
classification of these cosets to the case of the residual points. The
tempered form Ltemp of L = rL T L is the compact form of L defined by
Ltemp := rL TuL .
   Using the identification of the space of W0 -invariant continuous func-
tions on T and the space of continuous functions on W0 \T , ν can be
viewed as a W0 -invariant measure on T supported on ∪L Ltemp (union
over the residual cosets). We show
                                 P (cf. Theorem 3.25, Proposition 3.27
and Theorem 3.29) that ν =          νL , where the sum is over all residual
cosets L, and where νL is a smooth (with respect to the Haar measure dL
on Ltemp ) measure with support equal to L, such that for all w ∈ W0 ,
νwL = w∗ νL (the push forward of νL along w : Ltemp → (wL)temp ).
There is an explicit (up to a certain rational constant factor κWL L )
product formula for νL , compatible with parabolic induction (Proposi-
tion 3.27(iv)):

(2.33)         νL (rL tL ) = kLνRL ,{rL } ({rL})mL (rL tL )dL tL ,

where kL = |KL | with KL = TL ∩T L , mL is the rational function (3.57),
and νRL ,{rL } ({rL }) is the the mass of the residual point {rL } ⊂ TL with
respect to the WL -invariant spectral measure νRL on TL determined by
(RL , qL ). In the case where L = {r} is a residual point we have (cf.
Theorem 3.25)

(2.34)                   ν{r} ({r}) = κW0 r m{r} (r),

where m{r} is the given by the product (3.47).
   The support of ν is by definition equal to the image S of the map pz
(cf. Proposition 2.13). Thus we conclude from the above description of
ν that S = W0 \ ∪L Ltemp (union over all residual cosets L with respect
to R and root labels q).
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 25

2.9.2. Separation by central character. Next we deduce the formula (cf.
Corollary 3.23)
                                Z
(2.35)                 τ (hz) =    z(t)χt (h)dν(t)
                                   T

for all z ∈ Z and h ∈ H. The W0 -invariant function t → χt ∈ H∗
(defined on the support ∪L Ltemp of ν, and extended to T by 0) has
values in the positive tracial states of C. It follows that χt is a finite
positive linear combination of irreducible characters of C, which have
central character W0 t (cf. Definition 3.24 and Theorem 4.23). In other
words, the state χt is a positive linear combination of the irreducible
characters of C in the (finite) fiber p−1
                                       z (W0 t). This decomposition of χt
is the subject of Section 4, and will be described below.

2.9.3. Generic spectrum and residual algebra. The projection pz : Ĉ →
S = Ẑ is complicated near non-Hausdorff points of Ĉ. Using a variation
of techniques introduced in [26] we define an open dense subset S gen ⊂
S such that the restriction of pz to p−1  z (S
                                                gen
                                                    ) is a covering map (cf.
Theorem 4.39).
   The absolute continuity of νL with respect to the Haar measure dL
on Ltemp enables us to disregard a set of positive codimension, so that
we can restrict the domain of integration in the above integral to (the
pull back to T of) S gen .
   Given t ∈ T such that W0 t ∈ S gen , there exists a unique resid-
ual coset L such that t ∈ Ltemp . Choose rL ∈ TL ∩ L, and write
t = rL tL with tL ∈ TuL. The results of [26], suitably adapted, show
that in this situation there exists a bijective correspondence between
the equivalence classes [∆RL ,WL rL ] of irreducible discrete series repre-
sentations of HL := H(RL , qL ) with central character WL rL and the
equivalence classes of irreducible tempered representations of H with
central character W0 t. The correspondence is established by an infla-
tion to HL := H(RL , q L ) using the induction parameter tL ∈ TuL , and
induction from HL to H (Subsection 4.1, in particular Corollary 4.18).
   For t = rL tL ∈ Ltemp,gen such that RL ⊂ R0 is standard parabolic
(cf. Theorem 4.23) we obtain
                                X
(2.36)         χt = |W L|−1              dRL ,δ χRL ,WL rL ,δ,tL ,
                             δ∈∆RL ,WL rL

where χRL ,WL rL ,δ,tL is the character of the representation πRL ,WLrL ,δ,tL
which is induced from the irreducible discrete series module δ of HL
(with central character WL rL ) with induction parameter tL , and where
26                           ERIC M. OPDAM

dRL ,δ denotes the coefficient of the character χδ in the decomposition
of the tracial state χRL ,rL of HL .
   The point is that the coefficients in (2.36) are independent of the
induction parameter tL . They are certain positive real constants, which
we conjecture to be rational, see Conjecture 2.27 below.
   The positive real dR,δ is the degree of δ with respect to the finite
dimensional “residual Hilbert algebra” Hr , the quotient of H with re-
spect to the radical of the positive semi-definite form defined by the
tracial state χr . Hence we have (cf. Corollary 3.32)
(2.37)                  µP l ({δ}) = dR,δ ν({W0 r}).
Although Conjecture 2.27 is out of reach for the methods used in this
paper, there is a weaker statement which is relatively easy to prove
within the context of this paper, and which is already useful for cer-
tain applications (see Subsection 6.1). We prove in Section 5 that the
real constants dR,δ are independent of q, where we assume that q(s) is
written in the form Convention 2.1.

2.9.4. Plancherel measure µP l and Fourier transform. Equations (2.35)
and (2.36) yield a decomposition of the trace τ in terms of an integral
over t ∈ S reg , where the integration kernel is a sum over the finite fiber
pz (W0 t). This integral can be rewritten more sensibly as an integral
over a space of “standard induction data” Ξ, invariant for the action of
a groupoid W acting on the standard induction data (cf. Subsection
4.5). Next we decompose W\Ξ in its connected components. This leads
to the final formulation of the spectral decomposition of H in terms of
the Fourier isomorphism F (cf. Theorem 4.43). This formulation is
parallel to the formulation of the Harish-Chandra Plancherel formula
for p-adic groups, cf. [49], [12].
   Let RP ⊂ R0 be standard parabolic root system, and δ an irre-
ducible discrete series representation of HP = H(RP , qP ) with central
character WP r. The space O of all equivalence classes of “twists of
δ”, representations of HP of the form δtP where tP varies over TuP , is
a compact torus of the form Kδ \TuP , where Kδ is the isotropy sub-
group of [δ] in KP = T P ∩ TP . There exists a principal fiber bundle
VO over O whose fiber at ω = (RP , WP rP , δ, Kδ tP ) ∈ O is equal to
the common representation space i(Vδ ) of the induced representations
π(RP , WP rP , δ, tP ). Thanks to the regularity of certain intertwining
operators (see Subsection 4.3) there exists a natural action of the group
W (O) = {w ∈ W0 | w(RP,+ ) = RP,+ , and ∃k ∈ KP : Ψw (δ) ≃ Ψk (δ)}
(where Ψw (δ), Ψk (δ) denote twists of δ by automorphisms ψw , ψk of HP
induced by w and k respectively) on the smooth sections of End(VO ).
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 27

  The Fourier transform FH is the algebra homomorphism from H into
the direct sum of the algebras of smooth, W (O)-equivariant sections
of End(VO ), defined by (FH (h))(ω) = π(RP , WP rP , δ, tP )(h) if ω =
(RP , WP rP , δ, Kδ tP ).
  In this terminology the Plancherel measure can be expressed as fol-
lows (cf. Theorem 4.43):
(2.38)        dµP l (π(ω)) = µRP ,P l ({δ})|KP δ|mP (ω)dO ω,
 where KP δ denotes the set of equivalence classes of discrete series rep-
resentations of HP in the KP -orbit of δ, dO is the normalized Haar mea-
sure on O, mP (ω) = mP (rP tP ) is as in equation (2.33), and µRP ,P l ({δ})
is given by (2.37) (applied to RP ). When we equip the space of smooth
sections of End(VO )W (O) with the inner product
                         X            Z
                                   −1
(2.39)      (f1 , f2 ) =   |W (O)|       tr(f1 (ω)∗f2 (ω))dµP l(π(ω)),
                      O/∼              O

then the Fourier transform FH is an isometry, which extends uniquely
to a unitary isomorphism F : H → L2 (End(VΞ ))W .
2.9.5. Further remarks. In [13] we prove that the Fourier isomorphism
restricts to an isomorphism of the Schwartz completion S of H (cf.
6.2.2) onto C ∞ (End(VΞ ))W . Consequently, C ≃ F (C) = C(End(VΞ ))W .
In particular, the connected components of Ĉ are the closures ĈO of
π(Ogen ) ⊂ Ĉ. We expect that these results will provide an effective
approach towards the problem of classification of irreducible tempered
modules, using an analog of the analytic R-group (see for example [2])
in our context, granted the classification of the discrete series.
   The methods used in this paper are not suitable to obtain a parame-
trization of the finite set of discrete series representations [∆W0 r ] with
central character W0 r. If all the labels of H are equal this information
is contained in the work of Kazhdan and Lusztig [23]. They solved this
problem using equivariant K-theory in the case when the labels qi are
equal, and X = P . This result can be extended to the general equal
label case, see [38], [41]. In the appendix Section 8 one can find an
account of the results of Kazhdan and Lusztig, and the relation with
residual cosets.
   Let F be a p-adic field and let G be the group of F -rational points
in an adjoint semisimple group over F which splits over an unramified
extension of F . Lusztig [27], [29] solved the above classification problem
in principle for any Hecke algebra which arises as the centralizer algebra
of a representation of G which is induced from a cuspidal unipotent
representation of (the Levi quotient of) a parahoric subgroup of G.
28                          ERIC M. OPDAM

The Hecke algebras that are not dealt with by Lusztig are “generic”,
and these generic algebras are simpler with respect to this problem of
parametrization.
  Starting from the generic case, Slooten [45] formulated an interesting
combinatorics which (among others) conjecturally parametrizes the ir-
reducible tempered modules with real central character for all classical
root systems (a generalized Springer correspondence).
  For δ ∈ ∆W0 r we define λδ := κW0 r |W0 r|dδ , so that
(2.40)                   µP l ({δ}) = λδ m{r} (r)
(see (2.34) and (2.37)). This constant λδ has been computed explicitly
by Mark Reeder in the cases where the Hecke algebra arises as the
endomorphism algebra of a representation of a simple p-adic group of
exceptional, split adjoint type which is induced from a cuspidal unipo-
tent representation of a parahoric subgroup [40]. He conjectured an
interpretation (in this situation) of λδ (see also [39]) in terms of the
Kazhdan-Lusztig parameters of δ. In the exceptional cases he verified
this conjecture, using a formula of Schneider and Stuhler [42] for the
formal degree of a discrete series representation of an almost simple
p-adic group which contains fixed vectors for the pro-unipotent radical
U of a maximal compact subgroup K. This formula of Schneider and
Stuhler however is an alternating sum of terms which does not explain
the product structure of the formal dimension. In order to rewrite
this sum as a product one needs to resort to a case-by-case analysis
(computer aided) in [40].
   The method of [40] is likely to extend to the general case (joint work
with Mark Reeder and Antony Wasserman, in progress). This would
imply the following conjecture:
Conjecture 2.27. The dδ (equivalently, the λδ ) are rational numbers.


3. Localization of τ on Spec(Z)
  Recall the decomposition of τ we derived in [37], Theorem 3.7:
                         Z                    
                                       Et
(3.1)               τ=                           ω
                          t∈t0 Tu   q(w0 )∆(t)
where ω denotes the rational (n, 0)-form
                                        dt
(3.2)                     ω :=
                                 c(t, q)c(t−1 , q)
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 29

 on T . Let us briefly review the various ingredients of this formula.
First of all, Tu = Hom(X, S 1 ) , the compact form of the algebraic torus
T = Hom(X, C× ), and t0 ∈ Trs , the real split part of T , and should
be deep in the negative chamber Trs,− . The precise conditions will be
formulated below, see equation (3.7).
   The form dt denotes the holomorphic (n, 0)-form on T which restricts
to the normalized Haar measure on Tu . It is given by the formula
           dt := (2πi)−n (x1 x2 . . . xn )−1 dx1 ∧ dx2 ∧ · · · ∧ dxn
if (x1 , . . . , xn ) is a basis of
                                 Q X.
   The function ∆(t) := α∈R1,+ ∆α (t) with
(3.3)                       ∆α := 1 − θ−α ∈ A
is the Weyl denominator. Here we use the convention to consider the
subalgebra A ⊂ H as the algebra of regular functions on T via θx (t) :=
x(t).
   The function c(t) = c(t, q) is Macdonald’s c-function. This c-function
is introduced as an element of F A , the field of fractions of A, and will
be interpreted as a rational function on T (cf. [37], Definition 1.13).
Explicitly, we put
                               Y          Y
(3.4)                  c :=         cα =       cα .
                               α∈R0,+      α∈R1,+

Here we define cα for α ∈ R1 by
                        −1/2               −1/2
                                           −1
                 (1 + qα∨ θ−α/2 )(1 − qα∨ q2α∨ θ−α/2 )
(3.5)      cα :=                                       ∈ F A.
                              1 − θ−α
If α ∈ R0 \R1 then we define cα := c2α .
Remark 3.1. We have thus associated a c-function cα to each root
α ∈ Rnr , but cα only depends on the direction of α. This convention is
different from the one used in [37]. It is handy to write the formulas
for the c functions in the above form, but strictly speaking incorrect if
α ∈ R1 and α/2 6∈ X. However, we formally put q2α∨ = 1 if α/2 6∈ R0 ,
and then rewrite the numerator as (1 − qα−1∨ θ−α ). Here and below we
use this convention.
  The exact inequalities which have to be met by t0 ∈ Trs in order
to represent the trace functional τ are as follows. If q(s) > 1 for all
s ∈ S aff , then according to [37], Definition 1.4 and Corollary 3.2, the
representation (3.1) holds if
                                                  −1/2
(3.6)                  ∀α ∈ F0 : α(t0 ) < qα−1∨ qα∨ /2 .
30                             ERIC M. OPDAM

It is clear that this representation of τ remains true if we vary the
parameters q in a connected open set U such that {q | ∀s : q(s) >
1} ⊂ U ⊂ {q | ∀s : q(s) > 0}, as long as the poles of the kernel of
the integral for any q ∈ U do not intersect the integration cycle t0 Tu .
It follows that the representation (3.1) of τ holds for any q such that
∀s ∈ S aff : q(s) > 0, provided that
                                                 1/2            ±1/2
(3.7)          ∀α ∈ F0 : α(t0 ) < min{(qα∨ qα∨ /2 )±1 , qα∨ /2 }.
Observe that
                     1/2      1/2 1/2      1/2          −1/2 1/2
(3.8)           qα∨ qα∨ /2 = qα∨ qα∨ +1 ; qα∨ /2 = qα∨ qα∨ +1
  The expression Et ∈ H∗ is the holomorphic Eisenstein series for H,
with the following defining properties (cf. [37], Propositions 2.23 and
2.24):
           (i) ∀h ∈ H, the map T ∋ t → Et (h) is regular.
(3.9)      (ii) ∀x, y ∈ X, h ∈ H, Et (θx hθy ) = t(x + y)Et (h).
          (iii) Et (1) = q(w0 )∆(t).
We want to rewrite the integral (3.1) representing the trace functional
as an integral over the collection of tempered residual cosets, by a
contour shift. It turns out that such a representation exists and is
unique. To find it, we need an intermediate step. We will first rewrite
the integral as a sum of integrals over a larger set of tempered “quasi-
residual cosets”, and then we will show that if we symmetrize the result
over W0 , all the contributions of non-residual cosets cancel.

3.1. ω-residual cosets
  The basic scheme to compute residues has nothing to do with the
properties of root systems. It is therefore convenient to formulate ev-
erything in a more general setting first. Later we will consider the
consequences that are specific to our context.
  Let T be a complex algebraic torus with character lattice X.
Definition 3.2. Let ω = pdt/q be a rational (n, 0)-form on T . Assume
that p, q are of the form
                   Y                           Y
(3.10)     q(t) =      (d−1
                         m mx (t) − 1); p(t) =     (d−1
                                                     m′ xm′ (t) − 1),
                  m∈M                                  m′ ∈M′

where the products are taken over finite multisets M, M′. The multi-
sets M and M′ come equipped with maps m → (xm , dm ) ∈ X × C× .
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 31

For m ∈ M ∪ M′ we denote by Lm ⊂ T the codimension 1 sub-
variety
P       Lm =P{t | xm (t) = dm }, and we denote by Dω the divisor
  m∈M Lm −     m′ ∈M′ Lm′ on T of q/p.
  An ω-residual coset L is a connected component of ∩m∈J Lm for some
J ⊂ M, such that the pole order iL of ω along L satisfies
  iL := |{m ∈ M | L ⊂ Lm }| − |{m′ ∈ M′ | L ⊂ Lm′ }| ≥ codim(L).
 The collection of ω-residual cosets is denoted by Lω . This is a fi-
nite, nonempty collection of cosets of subtori of T , which includes by
definition T itself (the empty intersection of the cosets Lm ).
   Note that ω as in the above definition is completely determined by
the divisor Dω on T .
   Let h·, ·i be a rational inner product on the vector space Q⊗Y , where
Y is the cocharacter lattice of T . This defines an isomorphism between
Q ⊗ X and Q ⊗ Y , and we also denote by h·, ·i the corresponding inner
product on Q⊗X. Through the exponential map exp : tC := C⊗Y → T
we obtain a distance function on T . It is defined by taking the distance
between 2πiY -orbits in tC . We denote by |t| the distance of t ∈ T to
e ∈ T.
   Suppose that L is a connected component of the intersection ∩m∈J Lm
for some subset J ⊂ M. Then L is a coset for the connected component
of e of the subgroup ∩m∈J T m ⊂ T , where T m := {t ∈ T | xm (t) = 1}.
We denote this connected component by T L ⊂ T . Its character
                                                            P      lattice
   L             L    ×                            L
X := Hom(T , C ) is equal to the quotient X = X/(( m∈J Qxm ) ∩
X). Let XL be the quotient XL := X/(∩m∈J x⊥          m ∩ X). Then TL :=
Hom(XL , C× ) is an algebraic subtorus of T , the subtorus “orthogonal
to T L ”. The intersection KL := TL ∩T L is a finite abelian group, and is
canonically isomorphic to character group of the quotient X/(XL +X L ).
It follows that L ∩ TL is a coset for the finite subgroup KL ⊂ Tu .
   We denote by ML ⊂ M the subset {m ∈ M | xm (L) = dm }. We
choose an element rL = sL cL ∈ TL ∩ L for each L so that we can write
L = rL T L . We call cL ∈ Trs the center of L, and note that this center
is determined uniquely by L. We write cL = exp γL with γL ∈ tL . The
set of centers of the ω-residual cosets is denoted by C ω . The tempered
form of a ω-residual L = rL T L is by definition Ltemp := rL TuL (which
is independent of the choice of rL ), and such a coset will be called an
ω-tempered coset.
   Basically, the only properties of the collection Lω we will need are
Proposition 3.3.          (i) If c ∈ C ω then the union
                     Sc := ∪{L∈Lω |cL=c} Ltemp ⊂ cTu
32                              ERIC M. OPDAM

           is a regular support in the sense of [43] in cTu . This means
          that a distribution on cTu with support in Sc can be written as
          a sum of derivatives of push forwards of measures on Sc ⊂ cTu .
     (ii) If c = exp γ ∈ Trs , and L is ω-residual with |γL| ≥ |γ| but γL 6=
          γ, then there exists a m ∈ ML such that f (t) = xm (t) − dm is
          non-vanishing on cTu .
Proof. The set Sc is a finite union of smooth varieties, obviously satisfy-
ing the condition of [43], Chapitre III, §9 for regularity, proving (i). As
for (ii), first note that the assumption implies that γL 6= 0, hence that
L 6= T . Thus the codimension of L is positive, and ML 6= ∅. Clearly
γ 6∈ γL + tL = log(Trs ∩ LTu ) since γL is the unique smallest vector in
this affine linear space. Because {xm | m ∈ ML } spans tL = (tL )⊥ ,
we can find a m ∈ ML such that xm (γ) 6= xm (γL ). This implies the
result.                                                                  

3.2. The contour shift and the local contributions
   The following lemma is essentially the same as Lemma 3.1 of [18],
but because of its basic importance we have included the proof here,
adapted to the present context. See also [5] for a more general method
in the same spirit.
Lemma 3.4. Let ω be as in Definition 3.2 and let t0 ∈ Trs \ ∪ (Trs ∩
Tu Lm ). Fix an inner product h·, ·i on Q⊗Y . Then there exists a unique
collection of distributions {Xc ∈ C −∞ (cTu )}c∈C ω such that the following
conditions hold:
       (i) The support of Xc satisfies supp(Xc ) ⊂ Sc (cf. Proposition
           3.3).
      (ii) For every a ∈ Aan (T ) (the ring of analytic functions on T )
           we have Z
                                        X
(3.11)                      a(t)ω(t) =      Xc (a|cTu ).
                      t∈t0 Tu           c∈C ω

Proof. The existence is proved by induction on the dimension n of T ,
the case of n = 0 being trivial. Suppose that the result is true for
tori of dimension n − 1. Choose a smooth path in Trs from t0 to the
identity e which intersects the real projection Lm,r = Trs ∩ Tu Lm of the
codimension 1 cosets Lm transversally and in at most one point t(Lm,r ).
We may assume that the intersection points are mutually distinct with
possible exception for the cases t(Lm,r ) = e, i.e. when e ∈ Lm,r . When
we move t0 along the curve towards e, then we pick up residues when
we pass at a point t = t(Lm,r ) 6= e on the curve. We may assume that
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 33

the cosets Lm are connected (by factoring the defining equations, and
adapting M accordingly). Let L = Lm be such that t ∈ Lm,r . For
simplicity of notation we write (x, d) instead of (xm , dm ). Recall the
decomposition L = rL T L = sL cL T L with rL ∈ TL . Let dL t denote
the holomorphic extension to T L of the normalized Haar measure on
TuL, and similarly for dL t on TL . Let KL = T L ∩ TL , and let kL be
its order. The product homomorphism π : T L × TL → T has kernel
{(k, k −1 ) | k ∈ KL }. The residue that is picked up on L when we cross
at t can be written as follows:
               Z      X Z
                                 (ap/q)(tsLtL tL )dL (tL )dL (tL ),
                  tL ∈TuL k∈K      tL ∈kC
                              L


where C denotes a small circle in TL ≃ C× around 1. Using the action
of Ker(π) and the invariance of dL and dL , and in addition using rL as
a base point of L, this equals
               Z          Z
            kL                 (ap/q)(rL tL tL )dL (tL )dL (tL ).
                      tL ∈tc−1 L
                            L Tu    tL ∈C

   Let xL ∈ XL be a generator of XL . Let D be the holomorphic
constant vector field on TL which is dual to xL . We extend D to a
constant holomorphic vector field on T . We define a kL-th root of d by
xL (rL ) = d1/kL , so that the pull back of d−1 x − 1 to TL × T L factors as
follows:
                      Y                                Y
     (d−1 x − 1) =        (xL (k −1 )d−1/kL xL − 1) :=    (d−1
                                                            k xL − 1).
                        k∈KL                          k∈KL

With these notations, the above residue contribution is of the form
   Z
                                                     
             BiL −1 (D)(((d−1        iL         L             L L
                           k xL − 1) p/q)a)(rL t tL ) |tL =1 d (t ),
     t′ ∈tc−1 L
           L Tu

where Bj (T ) ∈ Q[T ] is a certain polynomial of degree j. Note that
there may exist other Lm′ with t ∈ Lm′ ,r . We pick up similar residues
with respect to these cosets as well when we cross at t.
  The above integral can be rearranged as follows
                         L −1 Z
                        iX
                                  (D j (a)|L)ωj ,
                                  j=0   tsL TuL

where ωj is itself a rational (n − 1, 0)-form on L which is a linear
combination                      X
                           ωj =     fj,iωj,i
                                                  i
34                             ERIC M. OPDAM

on L with regular holomorphic coefficients fj,i, and (n − 1, 0)-forms ωj,i
which factor as in Definition 3.2. The forms ωj,i have poles along the
intersections L′n = L ∩ Ln (with n ∈ M) which are of codimension 1 in
L. A simple computation shows that we can choose this decomposition
of ωj such that for every j, i and every connected component H of an
intersection of cosets of the form L′n ⊂ L, the index iωj,i ,H of H ⊂ L
satisfies iωj,i ,H ≤ (iω,H − 1) − j. It follows that the union over all j, i of
the ωj,i-residual cosets in L is contained in the collection of ω-residual
cosets of T . Moreover, when we take rL as a base point of L, so that
we identify L with T L through the map tL → rL tL , then the tempered
form of a ωj,i-residual coset in L is equal to its tempered form as a ω-
residual coset in T . By the induction hypotheses we can thus rewrite
the residue on L in the desired form, where the role of the identity
element in the coset L is now played by rL .
   At the identity e ∈ T itself we have to take a boundary value of
ω towards Tu , which defines a distribution on Tu . This proves the
existence.
   The uniqueness is proved as follows. Suppose that we have a collec-
tion {Yc ∈ C −∞ (cTu )}c∈C ω of distributions such that
       (i) supp(Yc ) ⊂ P  Sc .
      (ii) ∀a ∈ C[T ] : c∈C ω Yc (a|cTu ) = 0.
We show that Yc = 0 by induction on |γ = log(c)|. Choose c ∈ C ω such
that Yc′ = 0 for all c′ with |γ ′ | < |γ|. For each L ∈ Lω with |γL | ≥ |γ|
and γL 6= γ we choose a l ∈ ML such that xl (t) − dl does not vanish
on cTu (Proposition 3.3) and we set
                                     Y
                     ν(t) :=                    (xl (t) − dl ).
                           {L:|γL |≥|γ| and γL 6=γ}

It is clear that for sufficiently large N ∈ N, Yc (ν N a) = 0 for all a ∈
C[T ]. On the other hand, by the theory of Fourier series of distributions
on Tu , C[T ]|cTu is a dense set of test functions on cTu . Since ν N is
nonvanishing on cTu , this function is a unit in the space of test functions
in cTu . Thus also ν N C[T ]|cTu is dense in the space of test functions. It
follows that Yc = 0.                                                      

3.2.1. Approximating sequences. There is an “analytically dual” for-
mulation of the result on residue distributions that will be useful later
on. The idea to deal with the residue distributions in this way was in-
spired by the approach in [21] to prove the positivity of certain residual
spherical functions.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 35

Lemma 3.5. For all N ∈ N there exists a collection of sequences
{aN,c             ω
  n }n∈N (c ∈ C ) in A with the following properties:
                        P
      (i) For all n ∈ N, c∈C ω aN,c
                                n = 1.
     (ii) For every holomorphic constant coefficient differential opera-
          tor D of order at most N on T , D(aN,c   n ) → D(1) uniformly
          on Sc and D(aN,c
                        n  ) → 0 on S c ′ if c ′
                                                 6
                                                 = c.
Proof. We construct the sequences with induction on the norm |γ =
log(c)|. We fix N and suppress it from the notation. Let c ∈ C ω and
                                                              ′
assume that we have already constructed such sequences acn satisfying
(ii) for all c′ with |γ ′ | < |γ|. Consider the function ν constructed in
the second part of the proof of Lemma 3.4. By Fourier analysis on cTu
it is clear that there exists a sequence {φn }n∈N in C[T ] such that for
each holomorphic constant coefficient differential operator D of order
at most N there exists a constant cD such that
                  k(D(φn ) − D(ν −(N +1) ))|cTu k∞ < cD /n
Applying Leibniz’ rule to ν (N +1) φn − 1 = ν (N +1) (φn − ν −(N +1) ) repeat-
edly we see that this implies that there exists a constant c′D for each
holomorphic constant coefficient differential operator D, such that
                 k(D(ν (N +1) φn ) − D(1))|cTu k∞ < c′D /n.
Notice that D(ν (N +1) φn ) = 0 on all Sc′ with |γ ′ | ≥ |γ| but γ ′ 6= γ. On
the other hand, for each holomorphicP       constant coefficient differential
                                                  ′
operator E the function E(1 − {c′ ||γ ′ |<|γ|} ack ) converges uniformly to
zero on each Sc′ with |γ ′ | < |γ|. Again applying Leibniz’ rule repeatedly
we see that there exist a k ∈ N (depending on n) such that the function
                                              X          ′
                    acn := ν (N +1) φn (1 −           ack )
                                           {c′ ||γ ′ |<|γ|}

has the property that
                          kD(acn )|∪Sc′ k∞ < c′D /n,
where the union is taken over all c′ with |γ ′ | < |γ|. It is clear that the
sequence acn thus constructed satisfies (ii). We continue this process
until we have only one center c left. For this last center we can simply
put                                   X ′
                          acn := 1 −      acn .
                                        c′ 6=c

This satisfies the property (ii), and forces (i) to be valid.              

  The use of such collections of sequences is the following:
36                           ERIC M. OPDAM

Proposition 3.6. In the situation of Lemma 3.4 and given any col-
lection of sequences {acn } as constructed in Lemma 3.5 we can express
the residue distributions as (with a ∈ A):
                          Xc (a) = lim τ (acn a),
                                   n→∞

provided N (in Lemma 3.5) is chosen sufficiently large.
Proof. Because we are working with distributions on compact spaces,
the orders of the distributions are finite. Take N larger than the max-
imum of all orders of the Xc . By Proposition 3.3 we can thus express
Xc′ as a sum of derivatives of order at most N of measures supported
on Sc′ . The result now follows directly from the defining properties of
the sequence acn .                                                    

3.2.2. Cycles of integration. Yet another useful way to express the
residue distribution is by means of integration of aω over a suitable
compact n-cycle. The results of this subsection will be needed later
on to compute certain residue distributions at “generic” points of their
support.
   In the proposition below we will use the distance function on T which
measures the distance between 2πiY -orbits in tC . For δ > 0 and each
L which is a connected component of an intersection of codimension 1
cosets Lm ⊂ T with m ∈ M, we denote by BL (rL , δ) a ball in TL with
                                   L
radius δ and center rL , and by Brs  (δ) a ball with radius δ and center
       L
e in Trs . We put ML ⊂ M for the m ∈ M such that L ⊂ Lm , and
ML ⊂ M for the m ∈ M such that Lm ∩ L has codimension 1 in L.
We write T m = {t | xm (t) = 1}.
   Let U L (δ) ⊂ T L be the open set {t ∈ T L | ∀m ∈ ML : tBL (rL , δ) ∩
Lm = ∅}. Note that U L (δ1 ) ⊂ U L (δ2 ) if δ1 > δ2 , and that the union of
these open sets is equal to the complement of union of the codimension
1 subsets rL−1 (L ∩ Lm ) ⊂ T L with m ∈ ML .
Proposition 3.7. Let ǫ > 0 be such that for all m ∈ M and L ∈ Lω ,
                 L
Lm ∩ BL (rL , ǫ)Brs (ǫ)TuL 6= ∅ implies that Ltemp ∩ Lm 6= ∅. Denote by
ML,temp the set of m ∈ ML such that Ltemp ∩ Lm 6= ∅. There exist
      (i) ∀L ∈ Lω , a point ǫL ∈ Brs L
                                       (ǫ)\ ∪m∈ML,temp T m ,
     (ii) a 0 < δ < ǫ such that ∀L ∈ Lω , ǫL TuL ⊂ U L (δ), and
    (iii) ∀L ∈ Lω , a compact cycle ξL ⊂ BL (rL , δ)\ ∪m∈ML Lm of di-
          mension dimC (TL ),
such that
                                                     X
(3.12)         ∀c ∈ C ω , ∀φ ∈ C ∞ (cTu ) : Xc (φ) =         XL (φ),
                                                    {L|cL =c}
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 37

where XL is the distribution on cTu with support Ltemp defined by
                                     Z
(3.13)              ∀a ∈ A : XL(a) =          aω.
                                              ǫL TuL ×ξL

If ML,temp = ∅ we may take ǫL = e.
Proof. We begin the proof by remarking that (i), (ii) and (iii) imply
that the functional XL on A indeed defines a distribution on cL Tu ,
supported on Ltemp . Consider for t ∈ U L (δ) the inner integral
                         Z
(3.14)                      aω := i(a, t)dL t.
                             tξ

Then i(a, t) is a linear combination of (possibly higher order) partial
derivatives Dκ a of a at rL t in the direction of TL , with coefficients in
the ring of meromorphic functions on T L which are regular outside the
codimension 1 intersections rL−1 (L ∩ Lm ):
                                     X
(3.15)                     i(a, t) =    fκ Dκ a.
                                          κ

Hence XL (a) is equal to the sum of the boundary value distributions
BVǫL ,fκ of the meromorphic coefficient functions, applied to the corre-
sponding partial derivative Dκ a of a, restricted to Ltemp :
                             X
(3.16)              XL (a) =    BVǫL ,fκ (Dκ a|Ltemp ).
                                  κ

We see that XL is a distribution supported in Ltemp ⊂ cL Tu , which
                                                   L
only depends on ξL and on the component of Brs       (ǫ)\ ∪m∈ML,temp T m in
         L
which ǫ lies.
   Hence, by the uniqueness assertion of Lemma 3.4, we conclude that
it is sufficient to prove that we can choose ǫL , δ, ξL in such a way that
                                Z         X
(3.17)                ∀a ∈ A :      aω =       XL (a).
                                  t0 Tu       L∈Lω

In order to prove this it is enough to show that we can choose ǫL , δ, ξL
as in (i), (ii) and (iii) for the larger collection L̃ω of all the connected
components of intersections of the Lm (with m ∈ M), such that
(3.18)                  t0 Tu ∼ ∪L∈L̃ω ǫL TuL × ξL .
Here ∼ means that the left hand side and the right hand side are ho-
mologous cycles in T \ ∪m∈M Lm . The desired result follows from this,
since the functional XL is equal to 0 unless L is ω-residual (because the
38                             ERIC M. OPDAM

inner integral (3.14) is identically equal to 0 for non-residual intersec-
tions, by an elementary argument which is given in detail in the proof
of Theorem 3.25).
   Let k ∈ {0, 1, . . . , n−1}. Denote by L̃ω (k) the collection of connected
components of intersections of the Lm (m ∈ M) such that codim(L) <
k. Assume that we already have constructed points ǫL , δ, ξL satisfying
(i), (ii) and (iii) for all L ∈ L̃ω (k) and in addition, for each L ∈ L̃ω with
                                                  L
codim(L) = k, a finite set of points ΩL ⊂ Trs       such that ΩL TuL ⊂ U L (δ)
and a cycle ξL,w ⊂ BL (rL , δ)\ ∪m∈ML Lm for each w ∈ ΩL , such that
t0 Tu is homologous to
(3.19)   ∪L∈L̃ω (k) (ǫL TuL × ξL) ∪ ∪L∈L̃ω (k+1)\L̃ω (k) ∪w∈ΩL (wTuL × ξL,w ).
This equation holds for k = 0, with ΩT = {t0 }, which is the starting
point of the inductive construction to be discussed below. We will
construct ǫL , δ1 and ξL for L ∈ L̃ω (k + 1)\L̃ω (k), and finite sets ΩL for
L ∈ L̃ω (k + 2)\L̃ω (k + 1), with a cycle ξw for each w ∈ ΩL such that
equation (3.19) holds with k replaced by k + 1, and δ by δ1 .
    First of all, notice that we may replace δ by any 0 < δ ′ < δ in
equation (3.19), because we can shrink the ξL and ξL,w within their
homology class to fit in the smaller sets BL (rL , δ ′ )\ ∪m∈ML Lm . Choose
δ ′ small enough such that for each L ∈ L̃ω (k + 1)\L̃ω (k) there exists a
point ǫL ∈ Brs L
                 (ǫ) with the property that ǫL TuL ⊂ U L (δ ′ ).
    The singularities of the inner integral are located at codimension 1
cosets in T L of the form rL−1 N, where N is a connected component of
L ∩ Lm for some m ∈ ML . We have rL−1 N = rL−1 rN T N ⊂ T L, and thus
c−1      N       L                         L
 L cN Trs ⊂ Trs . Choose paths inside Trs from w ∈ ΩL to the point ǫ .
                                                                              L

We choose each path such that it intersects the real cosets c−1       L cN Trs
                                                                              N

transversally and in at most one point, and such that these intersection
points are distinct. If p = γ(x0 ) is the intersection point with the path
γ from w ∈ ΩL to ǫL then p is of the form p = c−1                     −1
                                                     L cN wL,N,w ∈ cL cN Trs
                                                                              N
                   N
with wL,N,w ∈ Trs    . Given N ∈ L̃ω (k + 2)\L̃ω (k + 1) we denote by ΩN
the set of all wL,N,w arising in this way, for all the L ∈ L̃ω (k + 1)\L̃ω (k)
such that L ⊃ N, and w ∈ ΩL .
                                                       −1
    Notice that if v = wL,N,w ∈ ΩN and vs ∈ rN            (N ∩ Lm ) for some
                                                                             N′
          N                                 −1
m ∈ M and s ∈ Tu , we have that cL cN v ∈ c−1                    N
                                                          L (cN Trs ∩ cN ′ Trs )
                                   ′
where N ′ = L ∩ Lm . Since T N 6= T N , this contradicts the assertion
that the intersection points of the paths in Trs L
                                                    and the cosets c−1L cN Trs
                                                                              N
                                                                            N
are distinct. We conclude in particular that the compact set ΩN Tu is
contained in the union of the open sets U N (δ ′ ). We can thus choose δ ′
small enough such that in fact ΩN TuN ⊂ U N (δ ′ ), as required in equation
(3.19).
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 39

   Write TN ⊂L for the identity component of the 1-dimensional intersec-
tion TN ∩ T L , and decompose the torus T L as the product T N × TN ⊂L .
Let v = wL,N,w ∈ ΩN and put p = c−1    L cN v for the corresponding inter-
section point in Trs . Notice that for a codimension 1 coset rL−1 N ′ ⊂ T L
                   L

with N ′ ∈ L̃ω we have that
                                    (
                                                     N′
                           −1 ′       ∅ if c−1
                                            L cN ′ T    6= c−1    N
                                                            L cN T ,
(3.20)         pTN ⊂L,u ∩ rL N =
                                      GL,N ′ ,w otherwise
where GL,N ′ ,w is a coset of the subgroup TN ⊂L ∩ T N of the finite group
KN ′ = KN = TN ∩ T N ⊂ TuN , of the form
(3.21)                GL,N ′ ,w = (TN ⊂L ∩ T N )rL−1 rN ′ v.
The cosets GL,N ′ ,w are disjoint. Let δ(L, w) be the minimum distance
of two points in the union of these cosets, and let δ(k + 1) denote the
minimum of the positive real numbers δ(L, w) when we vary over all
the L and w ∈ ΩL . Choose δ1 > 0 smaller than the minimum of δ ′ and
δ(k + 1). Let η be a circle of radius δ1 /2 with center e in TN ⊂L . Next
we make δ ′ sufficiently small so that ∪N ′ GL,N ′ ,w η ⊂ U L (δ ′ ). For x− , x+
suitably close to x0 with x− < x0 < x+ we have in U L (δ ′ ):
(3.22)         γ(x− )TN ⊂L,u ∼ γ(x+ )TN ⊂L,u ∪ ∪N ′ GL,N ′ ,w η,
                                                                 ′
where the union is over all N ′ ⊂ L such that c−1
                                               L cN ′ T
                                                        N
                                                          = c−1    N
                                                             L cN T .
Define
(3.23)                    ξL,N ′,v := rL−1 rN ′ η × ξL,w .
Observe that TN ⊂L,u × TuN is a |TN ⊂L ∩ T N |-fold covering of TuL , and
that gη × vTuN ∼ g ′ η × vTuN if g, g ′ ∈ GL,N ′ ,w . We thus have
(3.24)      γ(x− )TuL × ξL,w ∼ γ(x+ )TuL × ξL,w ∪ ∪N ′ vTuN × ξL,N ′,v .
By possibly making δ ′ smaller we get that ξL,N,v ⊂ BN (rN , δ1 ) for all
possible choices N, L and w. If Lm ⊃ N but Lm 6⊃ L, then, since
rL−1 rN η ⊂ U L (δ ′ ) and ξL,w ⊂ BL (rL , δ ′ ), we have ξL,N,v ∩ Lm = ∅. If on
the other hand Lm ⊃ L then ξL,N,v ∩ Lm = rL−1 rN η × (ξL,w ∩ Lm ) = ∅.
Finally we put
(3.25)                       ξN,v := ∪(L,w) ξL,N,v ,
where we take the union over all pairs (L, w) with L ∈ L̃ω (k +1)\L̃ω (k)
such that L ⊃ N and w ∈ ΩL such that there is an intersection point
wL,N,w with wL,N,w = v. We have shown that
(3.26)                ξN,v ⊂ BN (rN , δ1 )\ ∪m∈MN Lm ,
as required in equation (3.19).
40                           ERIC M. OPDAM

    Applying equation (3.24) for all the intersections of all the paths we
chose, we obtain equation (3.19) with k replaced by k + 1 and δ by
δ1 . We thus take ξL = ∪w∈ΩL ξL,w for L ∈ L̃ω (k + 1)\L̃ω (k), and for
N ∈ L̃ω (k + 2)\L̃ω (k + 1) we take ΩN and ξN,v as constructed above.
    This process continues until we have k = n − 1 in equation (3.19).
In the next step we proceed in the same way. Notice that for N ∈
L̃ω (n + 1)\L̃ω (n), either ΩN = {e} (if we cross c−1
                                                    L cN with some curve
                       L
from ΩL to ǫL in Trs     , for one of the one dimensional residual cosets
L containing N), or else ΩN = ∅. The process now stops, since also
ǫN = e. This proves the desired result, with δ equal to the δ1 obtained
in the last step of the inductive construction.                          

Remark 3.8. The homology classes of the cycles ξL are P   not uniquely
determined by the above algorithm. The splitting Xc = {L|cL =c} XL
is not unique without further assumptions. However, in our applica-
tion to spectral theory of C, we shall see that the decomposition Xc =
P
   {L|cL =c} XL is such that each XL is a regular measure supported on
  temp
L      , and such a decomposition is of course unique.
   We list some useful properties of the cycles ξL. We fix ω, and suppress
it from the notation.
Definition 3.9. Let L ∈ L. Denote by LL the configuration of real
cosets M L := cL Trs
                   M
                      where M ∈ L such that M ⊃ L, M 6= T . The
“dual” configuration, consisting of the cosets ML := cL TM,rs ⊂ TL with
M ∈ L such that M % L, is denoted by LL . Given an (open) chamber
C in the complement of LL, we call C d = {cL exp(v) | (v, w) < 0∀w ∈
log(c−1
     L C)\{0}} the anti-dual cone. This anti-dual cone is the interior
of the closure of a union of chambers of the dual configuration LL in
TL . We denote byPL(L) the residual cosets
                                        P in TL with respect to KL -
invariant divisor m∈ML (Lm ∩ TL ) − m′ ∈M′ (Lm′ ∩ TL ) on TL .
                                                L


Proposition 3.10.         (i) If t0 is moved inside a chamber of LL we
        can leave ξL unchanged.
                       L
   (ii) Let t0 (L) = Trs t0 ∩ TL . For each k ∈ KL := T L ∩ TL , we
        can choose the cycle ξkrL (L) (defined with respect to the con-
        figuration L(L) in TL and initial point t0 (L) ∈ TL ) equal to
        kξL .
Proof. (i) If t0 is moved within a chamber of LL , the path from t0 to
e can be chosen equal to the original path up to a path which only
crosses codimension one cosets of the form Lm Tu ∩ Trs which do not
contain c = cL . Therefore this does not change ξL .
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 41

   (ii) We may replace M by ML and M′ by M′L and leave ξL is un-
changed, because the Lm 6⊃ L do not contribute to ξL in the procedure
of the proof of Proposition 3.7. By (i) we may also replace t0 by t0 (L)
without changing ξL . We apply Proposition 3.7 in this situation in
                                                             L
P. Then we intersect with TL and use the formula TL ∩ (Tu × ξL ) =
T
   k∈KL kξL .                                                         

Proposition 3.11. Write L = rL T L = cL sL T L as usual, and let M ∈
L. Then Ltemp ⊂ M temp if and only if L ⊂ M and e ∈ ML . In
particular, Ltemp is maximal in the collection of ω-tempered cosets if
and only if e is regular with respect to the configuration LL .
Proof. If M ∈ L, then Ltemp ⊂ M temp ⇔ L ⊂ M and cL = cM (since
then sL ∈ (c−1                M
            M M) ∩ Tu = sM Tu , implying that rL ∈ M
                                                     temp
                                                          ). Now
cL = cM ⇔ cL ∈ TM ⇔ e ∈ ML .                                   
Proposition 3.12. (cf. [18], Lemma 3.3.) If e is not in the closure of
the anti-dual cone of the chamber of LL in which t0 lies, we can take
ξL = ∅.
Proof. By Proposition 3.10 it is sufficient to show this in the case where
L = rL is a residual point.
   We identify Trs with the real vector space t via the map t → log(c−1
                                                                      L t),
and we denote by h·, ·i the Euclidean inner product thus obtained on
Trs . Notice that the role of the origin is played by cL . The sets M L =
      M                               M
cM Trs  with M ∈ L(L) satisfy cM Trs     ∋ cL , and are equipped with the
induced Euclidean inner product.
   By the assumption and Proposition 3.10 we can choose t0 within its
chamber such that ht0 , ei > 0. Assume by induction that in the k-th
step of the inductive process of Proposition 3.7 we have, ∀N ∈ L(L)
with codim(N) = k and ∀w ∈ ΩN , that
(3.27)                        hcN w, cN i > 0
(see equation (3.19) for the meaning of ΩN ). Notice in particular that
this implies that ΩN = ∅ if cN = cL . By choosing ǫ sufficiently small,
we therefore have hcN ǫN , cN i > 0 when ΩN 6= ∅. Take the path γ in TrsN
                  N             −1        N                    N
from w ∈ ΩN to ǫ equal to cN [cN w, cN ǫ ], where [cN w, cN ǫ ] denotes
the (geodesic) segment from cN w to cN ǫN in the Euclidean space cN TrsN
                                                                         .
                                                            N
Consequently, we have hx, cN i > 0 for all x ∈ [cN w, cN ǫ ]. Let M ⊂
L(L) with codim(M) = k + 1 and M ⊂ N. If γ intersects c−1              M
                                                                 N cM Trs
    −1
in cN cM wN,M,w , then we have 0 < hcM wN,M,w , cN i = hcM wN,M,w , cM i.
By induction on k this proves that we can perform the contour shifts
in such a way that (3.27) holds for each k ∈ {0, . . . , codim(L)}. This
implies that ΩL = ∅, and thus that ξL = ∅.                             
42                           ERIC M. OPDAM

   In the next proposition we view the constants dm as variables. We
choose a continuous path [0, 1] ∋ σ → (dm (σ))m∈M from (dm )m∈M to
(d′m )m∈M , and consider the resulting deformation of ω and L. The end
point of the path corresponds to the form ω ′ and its collection of ω ′ -
residual cosets, denoted by L′ . Recall that ML denotes the multiset
of m ∈ M such that Lm ⊃ L. Assume that ∩m∈ML Lm (σ) 6= ∅ for
all σ. In this situation there exists a continuous path σ → rL (σ)
such that L(σ) := rL (σ)T L is a connected component of ∩m∈ML Lm (σ).
We may take rL (σ) ∈ TL ∩ L(σ). We put L′ = L(1). Assume that
{m ∈ M | xm (L′ ) = d′m } = {m ∈ M | xm (L) = dm }.
Proposition 3.13. Assume that e(σ) := cL c−1     L(σ) stays within a facet
                                      −1
of LL for all σ, and t0 (σ) := t0 cL cL(σ) stays within a chamber of LL .
With these assumptions we can take ξL′ = rL−1 rL′ ξL.
Proof. As above, we may assume that in fact L = rL is a point. The
only contributions to ξL come from contour shifts inside residual cosets
of the configuration L(L) as in the proof of Proposition 3.12. Likewise,
for the construction of ξL′ we only need to consider the translated
configuration rL−1 rL′ L(L). By the assumption on t0 and Proposition
3.10 we can construct rL rL−1′ ξL′ by working with L(L) and t0 , but with
the center e of T replaced by e′ := e(1).
   We now follow the deformations of the centers cM (σ) with σ ∈ [0, 1]
and M ∈ L(L). The assumption on e(σ) implies that cM 6= cL ⇔ ∀σ :
cM (σ) 6= cL . This implies we can use ξL also as the cycle associated
with L relative to the center e′ .                                     

Remark 3.14. Note that for some σ ∈ (0, 1) there may be additional
M ∈ L(σ) such that L(σ) ⊂ M. It may also happen that for some
values of σ ∈ [0, 1], L(σ)temp contains smaller tempered cosets. We
may need to adjust ǫL(σ) accordingly.

3.3. Application to the trace functional
  We will now apply the above results to the integral (3.1). We thus
use the rational (n, 0)-form
                                       dt
(3.28)             η(t) :=
                            q(w0 ) ∆(t)c(t, q)c(t−1 , q)
                                  2

and define the notion of quasi-residual coset as the η-residual cosets
introduced above. We write Lqu for the collection of these η-residual
spaces, C qu for their centers etc. Note: the collection of residual cosets
of Appendix 7 is strictly included in this collection.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 43

  Apply Lemma 3.4 to η of equation (3.28), with t0 such that (3.7) is
satisfied. Denote the resulting local distributions by Xη,c .
Proposition 3.15. The collection {Xhc }c∈C qu ,h∈H of distributions Xhc ∈
C −∞ (cTu ) defined by Xhc (a) := Xη,c ({t → a(t)Et (h)}) satisfies
      (i) supp(Xhc ) ⊂ Scqu . P
     (ii) ∀a ∈ A : τ (ah) = c∈C qu Xhc (a) (where Xc (a) means Xc (a|cTu )).
    (iii) The application h → Xhc is C-linear.
    (iv) ∀a, b ∈ A, h ∈ H : Xah            h
                                c (b) = Xc (ab).

Proof. These properties are simple consequences of 3.9.                 

3.3.1. Symmetrization and positivity. The main objects of this section
are the W0 -symmetric versions of the local distributions Xhc .
Definition 3.16. Let C−qu denote the set of elements in C qu which lie
in the closure of the negative chamber Trs,− = {t ∈ Trs | ∀α ∈ R0,+ :
α(t) < 1}. For h ∈ H, a ∈ A, and c ∈ C−qu put:
                                   X
(3.29)                  Yhc (a) :=     Xhc′ (ā),
                                     c′ ∈W0 c
                        P
 where ā := |W0 |−1 w∈W0 aw . Then Yhc is a W0 -invariant distribution
on ∪c′ ∈W0 c c′ Tu , with support in W0 Scqu , such that for all z ∈ Z:
                                       X
(3.30)                        τ (zh) =       Yhc (z).
                                        qu
                                     c∈C−

  It is elementary to compute the distribution Yhc when c = e. Re-
call that ([37], Corollary 2.26) we have the following identity for the
character of the minimal principal series It :
                                   X
(3.31)              χIt = q(w0 )−1     ∆(wt)−1 Ewt .
                                    w∈W0

Hence we can write for all z ∈ Z:
                            Z
                    h
                 Ye (z) =        z(t)Et (h)η(t)
                              Tu
(3.32)                      Z
                         =          z(t)χIt (h)dµT (t),
                              W0 \Tu

where µT is the positive measure on Tu given by
                                           dt
(3.33)                 dµT (t) :=                     .
                                    q(w0 )c(t)c(t−1 )
44                             ERIC M. OPDAM

Here we used the W0 -invariance of c(t)c(t−1 ), and the fact that for
t ∈ Tu we have
(3.34)                 c(t)c(t−1 ) = c(t)c(t̄) = |c(t)|2 .
We see that h → Yhe (1) is the integral of the function Tu = Se ∋ t →
χIt (h) against a positive measure on Tu . Moreover, for every t ∈ Tu , the
function h → χIt (h) is positive and central, and is a Z-eigenfunction
with character t. Our first task will be to prove these properties for
arbitrary centers c ∈ C qu . The main tools we will employ are the
approximating sequences.

3.3.2. Positivity and centrality of the kernel. Let us choose, for a suit-
ably large N, approximating sequences acn for the distributions Xη,c .
We remark that the group ±W0 acts on the collection of quasi-residual
subspaces. In addition, complex conjugation also leaves this collection
stable. We define an action · on A of the group G of automorphisms
of T generated by W0 , inv : t → t−1 and conj : t → t̄. For elements
g ∈ ±W0 this action is given by g · a := ag , and (conj ·a)(t) := a(t).
Lemma 3.17. We can choose the acn in a G-equivariant way, i.e. such
that ∀g ∈ G : agc        c
               n = g · (an ).

Proof. Just notice that for any given collection of approximating se-
                                                   −1
quences A := {acn } and any g ∈ G, g · A = {g · ang c } is also a collection
of approximating sequences for the distributions Xη,c , and this defines
an action of G on the set of collections of approximating sequences for
the Xη,c . Hence we can take the average over G.                           

     For c ∈ C−qu we now define
                                         X            ′
(3.35)                         znc :=              acn .
                                        c′ ∈W0 c

Then these sequences in the center Z of H have the property that for
all c ∈ C−qu , z ∈ Z and h ∈ H:
(3.36)                     Yhc (z) = lim τ (znc zh).
                                        n→∞

     It is easy to see that the map h → Yhc is central:
Proposition 3.18. For all c ∈ C−qu , we have Yhc = 0 if h is a commu-
tator.
Proof. We compute Yhc (z) = limn→∞ τ (znc zh) = 0, because znc zh is also
a commutator and τ is central.                                         
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 45

  We define an anti-holomorphic involutive map t → t∗ on T by t∗ :=
t−1 . In view of the action of conjugation on A, we see that for all
z ∈ Z, z ∗ (t) = z(t∗ ). By Lemma 3.17 we have, for each c ∈ C−qu ,
                          ∗
(3.37)                  znc (t) = znc (t−1 ) = (znc )∗ (t).
  Now we embark on the proof that the distributions Yhc are in fact
(complex) measures.
Lemma 3.19.         (i) If c∗ 6∈ W0 c then Yhc = 0.
   (ii) Let c ∈ W0 c, and cs ∈ Scqu such that (cs)∗ = c−1 s 6∈ W0 (cs).
             ∗

        Then cs 6∈ Supp(Yhc ).
Proof. (i). Any h ∈ H can be decomposed as h = hr + ihi with h∗r = hr
and h∗i = hi , so it suffices to prove the assertion for h ∈ Hre . Thus by
Lemma 2.15 it is sufficient to prove the assertion for a positive element
h ∈ H+ . Similarly z ∈ Z is a linear combination of positive central
elements, so that it is sufficient to show that Yhc (z) = Yzhc (1) = 0 for
each positive central element z. By Lemma 2.15 this reduces our task
to proving that Yhc (1) = 0 for an arbitrary element h ∈ H+ . Then
                              ∗               ∗
(3.38)   0 ≤ lim τ (h(znc + uznc )∗ (znc + uznc )) = uYhc (1) + uYhc∗ (1).
              n→∞

It follows easily that Yhc∗ (1) = Yhc (1) = 0.
    (ii). This is essentially the same argument that we used to prove
(i). Since (cs)∗ 6∈ W0 (cs), we can find an open neighborhood U ∋ cs
in cTu such that W0 U ∩ U ∗ = ∅. Let φ ∈ Cc∞ (W0 U)W0 . Then φ∗ φ = 0,
where φ∗ (x) := φ(x∗ ). We want to prove that Yhc (φ) = 0 for h ∈ H+ .
By Fourier analysis on cTu we can find a sequence fn ∈ AWc such
that D(fn ) converges uniformly to D(φ) on cTu for every holomorphic
constant coefficient differential operator D on T of order at most N on
T . We can then find a sequence gn of the form gn = fn ack(n) such that
D(gn ) converges uniformly to D(φ) on Scqu , and to 0 on Scqu ′ for every

c′ 6= c. Hence if we put
                                   X
                             φn =        gnw ∈ Z,
                                      w∈W c

then for each holomorphic constant coefficient differential operator D
on T of order at most N, D(φn ) → D(φ) uniformly on W0 Scqu , and
D(φn ) → 0 uniformly on Scqu      ′
                           ′ for c 6∈ W0 c. Hence ∀h ∈ H+ , u ∈ C,


                  0 ≤ lim τ (h(uznc + φn )∗ (uznc + φn ))
                        n→∞
(3.39)
                    =   |u|2Yhc (1)   + uYhc (φ∗ ) + uYhc (φ)
46                              ERIC M. OPDAM

If we divide this inequality by |u| and send |u| to 0, we get that ∀ǫ ∈ C
with |ǫ| = 1,
(3.40)                      0 ≤ ǫYhc (φ∗ ) + ǫYhc (φ)
It follows that ∀h ∈ H+ , Yhc (φ) = Yhc (φ∗ ) = 0. Hence the same is true
for arbitrary h ∈ H.                                                   

Corollary 3.20. If h ∈ H+ , the distribution Yhc is a W0 -invariant
positive Radon measure on W0 cTu , supported on W0 Scqu .
Proof. It suffices to show that Yhc is a positive distribution. Assume
            ∞         W0
√ φ ∈ C (W∞0 cTu ) and
that
                          W0
                              that φ > 0. Then the positive square root
  φ is also in C (W0 cTu ) . Using the approximating sequences as   √ we
did before, we can find a sequence fn ∈ Z such that D(fn ) → D( φ),
uniformly on W0 Scqu , and to 0 on Scqu′  for c′ 6= c. By Lemma 3.19,
the support of Yhc is contained in W0 Scherm := W0 Scqu ∩ T herm , where
T herm := {t ∈ T | t∗ ∈ W0 t}. This is itself a regular support for
distributions. On W0 Scherm , the sequence φn := fn∗ fn ∈ Z+ converges
uniformly to φ up to derivatives of order N. Hence
(3.41)                   0 ≤ lim τ (hfn∗ fn ) = Yhc (φ).
                             n→∞

This proves the desired inequality.                                          

Corollary 3.21. Put νc := Y1c . This is a positive Radon measure,
with support in W0 Scqu , and for all h ∈ H, Yhc is absolutely continuous
with respect to νc .
Proof. It is enough to prove this for h ∈ H which are Hermitian, i.e.
such that h∗ = h. By Lemma 2.15 and Corollary 3.20 we see that for
positive functions φ ∈ C ∞ (W0 cTu )W0 ,
(3.42)             −khko νc (φ) ≤ Yhc (φ) ≤ khko νc (φ).
                                                                             
                                P
Definition 3.22. Let ν :=             qu
                                   c∈C−    νc . By equation (3.30), this is the
spectral measure on Ẑ of the restriction of τ to Z (the “Plancherel mea-
sure” of Z). For h ∈ H we define a measurable, essentially bounded,
W0 -invariant function t → χt (h) on T by
                 X                      Z
                        h
(3.43)                Yc (φ|W0 Scqu ) =   φ(t)χt (h)dν(t)
                    qu                       T
                 c∈C−

for each φ ∈ Cc (T )W0 . For t outside the support of ν we set χt (h) = 0.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 47

Corollary 3.23. The function t → χt ∈ H∗ satisfies
      (i) The support of t → χt is the support of ν.
     (ii) χt ∈ H∗ is a positive, central functional such that χt (1) = 1,
          ν almost everywhere on T .
    (iii) For h ∈ H, z ∈ Z : χt (zh) = z(t)χt (h), ν almost everywhere
          on T .
    (iv) χt extends, for ν-almost all t, to a continuous tracial state of
          the C ∗ -algebra C.
     (v) We have the following decomposition of τ for all h ∈ H,
                                   Z
(3.44)                     τ (h) =   χt (h)dν(t).
                                      T

Proof. Everything is clear. Assertion (iv) follows from Corollary 2.17
by (ii).                                                            

  For t ∈ Supp(ν), we define the positive semi-definite Hermitian form
(x, y)t := χt (x∗ y) associated to the tracial state χt of H. It is clear that
the maximal ideal It ⊂ Z of elements vanishing at t is contained in the
radical Radt of (·, ·)t. Hence the radical is a cofinite two-sided ideal of
H. Consequently the GNS-construction produces a finite dimensional
Hilbert algebra associated with χt :

Definition 3.24. The algebra Ht := H/ Radt is a finite dimensional
Hilbert algebra with trace χt . We will refer to this Hilbert algebra as
the residual algebra at t.
   Let {ei }li=1
              t
                 denote the set of minimal central idempotents of Ht , and
χt,i the associated irreducible characters given by

(3.45)            χt,i (x) = dim(ei Ht )1/2 χt (ei )−1 χt (ei x)

We define dt,i := dim(ei Ht )−1/2 χt (ei ) ∈ R+ , so that
                                      lt
                                      X
(3.46)                         χt =         χt,i dt,i .
                                      i=1

Note that everything in sight depends on the orbit W0 t rather than on t
itself. We will sometimes use the notation dW0 t,i etc. in order to stress
this. (This notation and parametrization for the irreducible characters
of Ht is provisional. We return to these matters in a systematic way
in Section 4 (see e.g. Theorem 4.23).)
48                           ERIC M. OPDAM

3.4. The Plancherel measure ν of Z, and the A-weights of χt
   The results in this subsection are based on the fact that the Eisen-
stein kernel of (3.1) simplifies considerably when restricted to the sub-
algebra A ⊃ Z of H. This means that the (n, 0)-form η (see (3.28)) can
be replaced by the better behaved (n, 0)-form ω (cf. (3.2) and subsec-
tion 7.1) in the residue calculus. This has as an important consequence
(see below) that the support of the measure ν can be identified as the
union of the tempered residual cosets, which is only a small subcollec-
tion of the tempered quasi residual cosets, and very well behaved (see
Subsection 7.3 of Appendix 7). Since we have derived that Yh is ab-
solutely continuous with respect to ν for general h ∈ H(see Corollary
3.21), we conclude that the support of the density function t → χt is
the union of the tempered residual cosets.
   The probability measure ν can be computed almost explicitly, due
to the good properties of residual cosets. We will exploit these facts
here to study the behaviour of the states χt on A.
Theorem 3.25. P The W0 -invariant probability measure ν has a decom-
position ν = L νL , where L runs over the collection of residual cosets
as defined in Appendix 7, and where νL is the push forward to T of a
smooth measure on Ltemp . Let dL denote the normalized Haar measure
on TuL , transported to the coset Ltemp by translation. The measure νL
is given by a density function κWL L mL (t) := dνdLL(t)
                                                      t
                                                         , where κWL L ∈ Q
is a constant, and where mL is of the form
(3.47)                               Q′
                                       α∈R1 (α(t) − 1)
   mL (t) = q(w0 ) Q′      1/2              Q′       1/2
                                                                           .
                                   1/2 + 1)                       1/2 − 1)
                    α∈R1 (qα∨ α(t)            α∈R1 (qα∨ q2α∨ α(t)

Here we used the convention of Remark 3.1. The constant κWL L is
independent
         Q of q if we assume q to be as in Convention 2.1. The
notation ′ means that we omit the factors which are identically equal
to 0 on L. The density mL is a smooth function on Ltemp .
Proof. We know already that ν is a W0 -invariant measure supported on
the union of the tempered quasi residual cosets. We apply Proposition
3.7 to the integral
                            Z           X
                    τ (a) =      aω =       X1c (a)
                               t0 Tu      c∈C qu

(cf. equations (3.1), (3.2) and 3.9). Choose ǫ > 0. For a suitably small
δ > 0 we can find, for each quasi residual subspace L, an ǫL ∈ Trs  L
                                                                      in
                                                               ′
an ǫ neighborhood of e, and a cycle ξL ⊂ BL (rL , δ)\ ∪L′m ⊃L Lm , where
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 49

BL (rL , δ) ⊂ TL denotes a ball of radius δ > 0 centered around rL , such
that
(3.48)                   Z       Z                                
               X                                     dL (t′ )
     1                                    ′
    Xc (a) :=         kL              a(tt )                    −1   dL (t).
                             L L                       ′      ′
                                             q(w0 )c(tt )c((tt ) )
              L:cL =c     t∈ǫ Tu   ξL

Here dL (t) is the holomorphic extension to L of dL , and dL t′ denotes
the Haar measure on TL,u , also extended as a holomorphic form on TL .
We assume that δ is small enough to assure that log is well defined
on BL (rL , δ). For the inner integral we use a basis (xi ) of X ∩ QRL
as coordinates on log (BL (rL , δ)), shifted so that the coordinates are
centered at log(rL ). We can then write the integration kernel as:
(3.49)                t′ → a(tt′ )mL (tt′ )(1 + ft (t′ ))ωL(t′ )
where ωL is a rational homogeneous (l := dim(TL ), 0)-form (indepen-
dent of t) in the xi , and ft is a power series in xi such that ft (0) = 0. In
fact, the form ωL is easily seen to be (including the factor kL of (3.48))
                            Q
                              α∈RzL α(x)
(3.50)        ωL (x) =          Q           dx1 ∧ dx2 · · · ∧ dxl .
                         (2πi)l β∈Rp β(x)
                                         L

By Corollary 7.12 it follows that the form ωL has homogeneous degree
≥ 0 if L is residual in the sense of Definition 7.1. A homogeneous closed
rational form of positive homogeneous degree is exact. Hence the inner
integral will be nonzero only if L is in fact a residual coset. In that
case the inner integral will have value
(3.51)                           κL a(rL t)mL (rL t)
with
                                             Z
(3.52)                              κL =          ωL .
                                             ξL

 We note that κL ∈ Q, since ωL defines a rational cohomology class. Let
us therefore assume that L is residual from now on. Write rL = sc. By
Theorem 7.14 we know that rL∗ = sc−1 = ws (rL ) with ws ∈ W (RL,s,1).
When t ∈ Ltemp , the expression mL (t) can be rewritten as
(3.53)
                            Y                           |1 − α(t)|2
 q(w L)mRL ,{rL } (rL )                       1/2
                                                                                        .
                                       |1 + q     α(t) 1/2 |2 |1 − q 1/2 q ∨ α(t)1/2 |2
                        α∈R1,+ \RL,1,+       α ∨                    α ∨   2α

Here we used that if t = cu ∈ Ltemp with u ∈ sTuL , we have ws c = c−1 ,
ws u = u, and ws (R1,+ \RL,1,+ ) = R1,+ \RL,1,+ . By the same argument
as was used in Theorem 3.13 of [18] we see that this expression is real
analytic on Ltemp . This implies that we can in fact take ǫL = e for all
50                            ERIC M. OPDAM

residual L in equation (3.48) after we evaluate the inner integrals. This
leads to
                          X       Z
                  1
(3.54)          Xc (a) =       κL        a(t)mL (t)dL (t).
                          L:cL =c    Ltemp

where the sum is taken over residual cosets only. When we combine
terms over W0 orbits of residual cosets we find the desired result. Let
W0 L denote the set of residual cosets in the orbit of L. We have to
take
                                 1     X
(3.55)                κ WL L =               κL′ .
                               |W0 L| ′
                                         L ∈W0 L

 When we now define a measure νL on Ltemp by
       Z                            Z
(3.56)        f (t)dνL (t) := κWL L     f (rL tL )mL (rL tL )dL (tL )
           t∈Ltemp                       tL ∈TuL
                                P
then we have the equality ν = L νL (sum over the residual subspaces).
   We note in addition that κL = kL κRL ,{rL } , because the cycle ξL is
constructed inside TL , entirely in terms of the root system RL (see
Proposition 3.10) (the factor kL comes from the facorization dt =
kLdL tL dL tL , see (3.48)). Also, it is clear that mRL ,{rL } (rL ) is inde-
pendent of the choice of rL , because the finite group KL = TL ∩ T L is
contained in the simultaneous kernel of the roots of RL . Finally, the
independence of q is clear from Proposition 3.13. When we apply a
scaling transformation q → qǫ , the point cL moves such that the facet
of the dual configuration containing e does not change. Hence rL−1 ξL
and ωL will be independent of ǫ.                                           

Remark 3.26. We note that the smoothness of mL implies Theorem
7.17, similar to [18], Remark 3.14.
Proposition 3.27. For L residual consider the root datum RL =
(XL , YL, RL , RL∨ , FL ) (see Subsection 2.2) associated with the parabolic
root subsystem RL ⊂ R0 . Let qL be the restriction of the label function
q to RL . Then {rL} ⊂ TL is a (RL , qL ) residual point. Assume that
RL is a standard parabolic subsystem of roots, and thus that FL ⊂ F0 .
Denote by WL the standard parabolic subgroup WL = W (RL) of W0 ,
and let W L denote the set of minimal length representatives of the left
WL cosets in W0 .
      (i) When w ∈ W L , we may take ξwL = w(ξL). Consequently,
          κL = κwL if w ∈ W L .
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 51

     (ii) Put
(3.57)
                          Y
  mL (t) = q(w L)−1                cα (t)−1
                      α∈R1 \RL,1
                          Y                                 |1 − α(t)|2
(3.58)   = q(w L)                             1/2                    1/2
                                                                                    .
                    α∈R1,+ \RL,1,+   |1 + qα∨ α(t)1/2 |2 |1 − qα∨ q2α∨ α(t)1/2 |2

           Then mL and mL are Aut(W0 )-equivariant, i.e. mL (t) =
          mgL (gt) and mL (t) = mgL (gt) for every g ∈ Aut(W0 ). In
          particular, mL and mL are invariant for the stabilizer NL of
          L in W0 .
    (iii) We have κL = kLκRL ,{rL } , κWLL = kL κRL ,WL rL .
    (iv) For z ∈ Z, we have
                 Z                                  Z
            1
(3.59)              zdνW0 L = kL νRL ,{rL } ({rL })        z(t)mL (t)dL (t).
          |W0 L| T                                   Ltemp


     (v) Assuming that q is expressed as in Convention 2.1 with fs ∈
         2Z. Then νRL ,{rL } ({rL}) = κRL ,WLrL mRL ,{rL } (rL ) is of the
         form dqn f (q), where d ∈ Q, n ∈ Z, and where f is a quotient
         of products of cyclotomic polynomials in q.
Proof. (i). We note that for w ∈ W L , t0 and w −1 t0 are in the same
chamber of LL . Hence, by application of Proposition 3.10, we may
replace ξwL by w(ξL).
   (ii). This is trivial.
   (iii). The formula κL = kL κRL ,{rL } was explained in the proof of
Theorem 3.25. Let WL = W (RL ). Let NT L be the stabilizer of T L
in W0 . Observe that NL ⊂ NT L and WL ⊳ NT L . If we define ΓL =
NT L ∩ W L then ΓL is a complementary subgroup of WL in NT L . Using
(i), (ii) and the remark κL = kL κRL ,{rL } we see that
                            1      X
                κWL L =                  κL′
                          |W0 L| L′ ∈W L
                                         0

                        |W0 TL |       X
(3.60)                =                               κL′
                         |W0 L|
                                     L′ ∈N   TL
                                                  L

                          |W0 TL ||NT L L|
                      =                    kLκRL ,WL rL = kL κRL ,WLrL
                              |W0 L|
Using Theorem 3.25 and equation (3.53) the result follows.
 (iv). Follows easily from (iii).
52                            ERIC M. OPDAM

   (v). Since equation (3.47) involves only roots in R0 , it is sufficient to
prove the statement for R0 indecomposable and X = Q. Notice that
for all α ∈ R0 , α(s) is a root of unity and, by Theorem 7.14(iii), α(c) is
an integral power of q. Looking at the explicit formula (3.47), we see
that it remains to show that this expression has rational coefficients if
L = r = sc is a residual point. Let k be the extension of Q by the
values of α(s), where α runs over R0 . In the case where R is of type Cnaff
it follows by Lemma 7.6 that k = Q, and we are done. For the other
classical cases it follows from the result of Borel and de Siebenthal [8]
that the order of s is at most two, and hence that k = Q. Next let R be
of exceptional type, and σ ∈ Gal(k/Q). Define a character σ(s) of X =
Q by Q ∋ x → σ(x(s)) =: x(σ(s)). By Lemma 7.8 we see that there
exists a w1 ∈ W0 such that σ(s) = w1 s. Moreover, w1 : Rs,0 → Rs,0 acts
as an automorphism and c is an Rs,0 -residual point. If Fs,0 contains
isomorphic components then these are of type A, which has only one
real residual point up to the action of W (Rs,0 ). Hence by Theorem
7.14(i), there exists a w2 ∈ W (Rs,0) such that w1 (c) = w2 (c). Put
w = w2−1 w1 , so that wr = cσ(s). By the W0 -equivariance of m{r} (r)
we see that (with the action of σ being extended to k[q, q−1 ] by its
action on the coefficients) σ(m{r} (r)) = m{wr} (wr) = m{r} (r), whence
the desired rationality.                                                   

  The next proposition is a direct consequence of (the proof of) The-
orem 3.25 and the definition of χt .
Proposition 3.28. Let r = sc ∈ T be a residual point, and let a ∈ A.
Then
                                      X
(3.61)       ν(W0 r)χr (a) = m{r} (r)     κ{r′ } a(r ′ ).
                                          r ′ ∈W0 r

Theorem 3.29. The support of ν is exactly equal to the union of the
tempered residual cosets. In other words, S = W0 \ ∪L residual Ltemp .
Proof. The equality S = W0 \ Supp(ν) was explained in 2.9.1, so it suf-
fices to show that the support of ν is equal to the union of the tempered
residual cosets. By Theorem 3.25 we know that ν is supported on this
set, so we need only to show that W0 Ltemp is contained in the support
for each tempered residual coset L.
    By Proposition 3.27 this reduces to the case of a residual point r = sc.
By Proposition 3.28 it is enough to show that there exists at least one
r ′ = wr ∈ W0 r such that κ{r′ } 6= 0. In other words, using Proposition
3.28 we single out the point residue at r ′ . In particular, we ignore all
residues at residual cosets which do not contain r ′ and thus do not
contribute to κ{r′ } in the argument below.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 53

  By the W0 -invariance of ω, we can formulate the problem as follows.
Recall from the proof of Theorem 3.25 that
                                        Z
(3.62)                   κ{r} m{r} (r) = ω,
                                              ξ

where ξ is the residue cycle at r, which is obtained from Proposition
3.7 if we use the n-form
                                      dt
(3.63)                    ω(t) =
                                  c(t)c(t−1 )
and a base point t0 ∈ Trs such that ∀αi ∈ F0 : αi (t0 ) < q(si). By
definition, m{r} (r) 6= 0. For r ′ = wr we have
                                            Z
(3.64)                     κ{r } m{r} (r) =
                              ′                ω,
                                             ξ(w)

where ξ(w) is the cycle near r which we obtain in Proposition 3.7 when
we replace t0 by w −1t0 . Hence we have to show that there exists a
proper choice for t0 such that when we start the contour shift algorithm
from this point, the corresponding point residue at r will be nonzero.
The problem we have to surmount is possible cancellation of nonzero
contributions to κ{r′ } . We will do this by showing that there exists
at least one chamber such that the residue at r consists only of one
nonzero contribution.
   We consider the real arrangement L{r} in Trs , and transport the
Euclidean structure of t to Trs by means of t → log(c−1 t). Then L{r} is
the lattice of intersections of a central arrangement of hyperplanes with
center c. We assign indices iL to the elements of L{r} by considering
the index of the corresponding complex coset containing r, and we
note that by Corollary 7.12, i{r} = n := codim({r}). From Corollary
7.12 we further obtain the result that there exist full flags of subspaces
     L
cL Trs   ∈ L{r} such that iL = codim(L). In particular, there exists at
least one line l through r with il = n − 1.
   By Theorem 7.17 we see that the centers cL , cL′ of two “residual
                             ′                                         ′
subspaces” cL T L ⊂ cL′ T L (i.e. codim(T L ) = iL and codim(T L ) = iL′ )
                                                 ′
in L{r} satisfy cL′ 6= cL unless cL T L = cL′ T L . Hence d(e, cL′ ) ≤ d(e, cL)
(where d denotes the distance function), with equality only if cL T L =
       ′
cL′ T L . In the case of a residual line l ∈ L{r} , cT l is divided in two half
lines by c, and cl lies in one of the two halves (i.e. does not coincide
with c).
   We want to find a chamber for t0 such that the corresponding point
residue κ{r′ } m{r} (r) at r is nonzero. We argue by induction on the
rank. If the rank of R0 is 1, obviously we get κ{r′ } 6= 0 if we choose t0
54                            ERIC M. OPDAM

in the half line not containing e = cT , because we then have to pass a
simple pole of ω at r when moving the contour t0 Tu to Tu (since t0 and
e = cT are separated by c). Assume by induction that for any residual
point p of a rank n − 1 root system, we can choose a chamber for t0
such that κ{p} 6= 0. Let S ⊂ Trs be a sphere centered at r through e,
and consider the configuration of hyperspheres in L{r} ∩ S. Let us call
                                               L
e ∈ S the north pole of S. If LS = cL Trs        ∩ S with dim(T L ) > 1, we
denote by cL∩S the intersection of the half line through cL beginning
in c (recall that c 6= cL ) and LS . By the above remarks, cL∩S is in the
northern hemisphere for all residual L ⊃ r of dimension > 1. We call
this point cL∩S the center of LS .
   In the case when dim(T L ) = 1, LS is disconnected and consists of
two antipodal points cL∩S (north) and cL∩S (south), its opposite. In
this case of residual lines through r, both of these antipodal points are
considered as centers of L{r} ∩S. We call cL∩S the northern center, and
its opposite is called the southern center. All centers of L{r} ∩ S lie in
the northern hemisphere, with the exception of the southern centers of
the residual lines through r.
   Consider a closed (spherical) ball D ⊂ S centered at e such that D
contains a southern center p in its boundary, but no southern centers
in its interior. Since e is regular with respect to L{r} (a trivial case of
Theorem 7.17, as e is the center of T ), we have D 6= S.
   We take t0 in S, and we apply the algorithm as described in the
proof of Proposition 3.7, but now on the sphere S, and with respect to
the sets LS and their centers.
   By the induction hypothesis, we can take t0 ∈ S close to p in a
chamber of the configuration L{r} ∩ S which contains p in its closure,
such that a nonzero residue at l is picked up in p. Denote by Lp ∩ S the
central subarrangement of elements of L{r} ∩ S containing p. Consider
any alternative “identity element” ẽ which belongs to the same chamber
of the dual configuration of Lp ∩S as the real (original) identity element
e.
   As was explained in (the proof of) Proposition 3.13, when we apply
the contour shifts as in (the proof of) Proposition 3.7 to L{r} ∩ S,
the residue at p only depends on the dual chamber which contains the
identity element. In other words, we may use the new identity ẽ instead
of e without changing the residue at p. We can and will choose ẽ close
to p, and in the interior of D. By Proposition 3.7 we can replace
the integral over t0 Tu by a sum of integrals over cosets of the form
c̃L∩S s̃L TuL (for some s̃L ∈ Tu ) of the residue kernel κ̃L mL (cf. equation
(3.51)) on L. As was mentioned above, we are only interested in such
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 55

contributions when r ∈ L, which means that we may take s̃L = s. The
new “centers” c̃L∩S with respect to the new identity element ẽ are in
the interior of D.
   Next we apply the algorithm of contour shifts as in Proposition 3.7 to
move the cycles c̃L∩S sTuL to cL∩S sTuL. Since both the new centers c̃L∩S
and the original centers cL∩S belong to the interior of D, and since the
intersection of D with LS is connected if dim(LS ) > 0, we can choose
every path in the contour shifting algorithm inside the interior of D.
Thus, the centers cL∩S of the residual cosets L that arise in addition
the one southern center cl = p in the above process are in the interior
of D. In particular, with the exception of psTul , the one dimensional
cosets of integration which show up in this way, all have a northern
center.
   Finally, in order to compute the residue κr′ m{r} (r) at r ′ , we now
have to move the center cL∩S ∈ S of LS to the corresponding center
cL ∈ Trs of L,Rfor each residual coset L which contains r and which
contributes to t0 Tu ω. The only such center of L{r} ∩ S which will cross
c is the southern center p. Since ml has a simple pole at r = sc, we
conclude that this gives a nonzero residue at r. Hence with the above
choice of t0 we get κ{r′ } 6= 0, which is what we wanted to show.      

3.5. Discrete series
  In this subsection we show that the irreducible characters χr,i (see
Definition 3.24) associated to a residual point are in fact discrete series
characters.
Corollary 3.30. (of P   Theorem 3.29) For every residual point r = sc,
the sum κW0 r |W0 r| = r′ ∈W0 r κr′ 6= 0, and for all a ∈ A:
                                 1        X
(3.65)             χr (a) =                   κ{r′ } a(r ′ ).
                            κW0 r |W0 r| ′
                                        r ∈W0 r

Moreover, κ{r′ } = 0 unless ∀x ∈ X + \{0} : |x(r ′ )| < 1 (where X +
denotes the set of dominant elements in X).
Proof. This is immediate from Proposition 3.28 and Theorem 3.29,
except for the last assertion. This fact follows from Proposition 3.12.
We know that e is regular in L{r′ } by Theorem 7.17. On the other
                                                                         ′
hand, t0 lies in c′ Trs,− , which is clearly a subset of a chamber of L{r } .
                                         ′
The anti-dual of the chamber of L{r } containing t0 is thus a subset of
c′ Trs
    +          +
       , with Trs := {t ∈ Trs | ∀x ∈ X + \{0} : x(t) > 1}. Thus when e is
contained in the anti-dual chamber we have c′ ∈ Trs     −
                                                           as desired.    
56                             ERIC M. OPDAM

   We introduce the notation ∆R (= ∆R,q ) for a complete set of rep-
resentatives of the finite set of equivalence classes of the irreducible
discrete series representations of H(R, q), and ∆R,W0 r (= ∆R,W0 r,q ) for
the representatives of the classes of irreducible discrete series of H(R, q)
with central character W0 r. (We sometimes drop R from the notation
if no confusion is possible, and write ∆W0 r .)
Lemma 3.31. ∆W0 r is nonempty if and only if r is residual. If r is
residual, ∆W0 r is in bijective correspondence with the collection {δr,i } of
irreducible characters of Hr . In particular, H(R, q) has at most finitely
many discrete series representation.
Proof. We have
                                     X                   ′
                                                      r
(3.66)                 χr,i (a) =               dim(Vr,i )a(r ′ ).
                                    r ′ ∈W0 r

Hence from dr,i > 0,
                                        X
(3.67)                     χr (a) =             χr,i (a)dr,i ,
                                          i

and Corollary 3.30 we conclude that the generalized weight spaces of
Vr,i indeed satisfy the Casselman criterion Lemma 2.22 for discrete
series.
   Conversely, if δ is a discrete series representation, Theorem 2.25 im-
plies that µP l (δ) > 0. By Corollary 3.23, the central character W0 r of
δ is such that ν({r}) > 0. Theorem 3.25 implies that such points r are
necessarily residual.                                                  

  In view of the above, we adapt the notations of Definition 3.24 ac-
cordingly, i.e. we write dR,δ (or simply dδ ) instead of dr,i if δ ∈ ∆R,W0 r ,
and its character χδ descends to χr,i on Hr etc.
Corollary 3.32. Let δ ∈ ∆W0 r . The formal dimension µP l (δ) of δ
equals
(3.68)      µP l (δ) = fdim(δ) = dδ ν({W0 r}) = |W0 r|κW0 r dδ m{r} (r)
Proof. Combine equation (2.31), Corollary 3.23, and Theorem 3.25. 

Corollary 3.33. For a residual point r there exist constants C, ǫ > 0
such that
(3.69)                  |χr (Nw )| ≤ C exp(−ǫl(w)).
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 57

Corollary 3.34. The residual degrees dδ > 0 of the irreducible charac-
ters χδ of the residual algebra Hr (with r a residual point) satisfy the
following system of linear equations.
                     X             ′         κ{r′ }
(3.70)                      dim(Vδr )dδ =              .
                                          κW0 r |W0 r|
                  δ∈[∆R,W0 r ]

         ′
(with Vδr the generalized r ′ -weight space in the space Vδ of δ). In par-
ticular we conclude that the nonzero κ{r′ } all have the same sign (equal
to the sign of m{r} (r)).

Remark 3.35. We note in addition that if the restrictions χδ |A to A of
the characters χδ are linearly independent, it follows from the equations
(3.70) that dδ ∈ Q for all δ ∈ [∆R ]. I did not find any argument in
favor of this linear independence. However, we do conjecture that the
constants dδ are rational, see Conjecture 2.27.


3.6. Temperedness of the traces χt
  In this subsection we discuss the tempered growth behaviour of the
χt on the orthonormal basis Nw of H, as a corollary of the analysis of
the A-weights of χt .

Proposition 3.36. Let L be residual such that WL is a standard par-
abolic subgroup of W0 . For t ∈ Ltemp we write t = rL tL , with tL ∈ TuL .
We consider χt |A as a formal linear combination of elements of T .
Likewise, let AL = C[XL ] be the ring of regular functions on TL ⊂ T .
We consider χRL ,{rL } |AL as a formal linear combination of elements of
TL . In this sense we have, νL -almost everywhere on Ltemp ,
                             1 X
(3.71)           χt |A =            w(tLχRL ,{rL } |AL ).
                           |W L | L
                                 w∈W

Hence ν-almost everywhere, χt is a nonzero tempered functional on H.

Proof. Equation (3.71) follows by a straightforward computation simi-
lar to Proposition 3.28, using Proposition 3.27 and the definition of χt .
Since χt is a positive combination of the irreducible characters of the
residual algebra Ht , it follows that the weights t′ ∈ W0 t of the gener-
alized A-eigenspaces of the irreducible characters of Ht all satisfy the
condition ∀x ∈ X + : |x(t′ )| ≤ 1. This shows, by Casselman’s criterion
Lemma 2.20, that χt is a tempered functional on H.                     
58                                 ERIC M. OPDAM

4. Localization of the Hecke algebra
   We have obtained thus far a decomposition of the trace τ as an inte-
gral of positive, finite traces χt against an explicit probability measure
ν on T , such that each χt is a finite positive linear combination of fi-
nite dimensional, irreducible characters of C. This is an important step
towards our goal of finding the Plancherel decomposition, but it is not
yet satisfactory because we know virtually nothing about the behav-
ior of the decomposition of χt in irreducible characters at this stage,
neither as a function of t, nor as a function of q. In particular, the
residual degrees dt,i ∈ R+ of the residual algebras are obscure at this
point, and these degrees are involved in the Plancherel measure µP l .
   In the remaining part of the paper we will formulate the Plancherel
theorem, and also remedy to some extend the above problems. The
support S of ν (viewed as a W0 -invariant measure on T ) decomposes
as a union of the closed sets Ltemp (see 2.9.1). For each L we show
that, up to isomorphism of Hilbert algebras, the residual algebras Ht
are independent of t, ν-almost everywhere on Ltemp .
   The above is based on ideas of Lusztig [26] about completions of the
affine Hecke algebra. Lusztig describes the It -adic completion of H,
where It is a maximal ideal of Z. It is not hard to see that Lusztig’s
arguments can be adapted to (analytic) localization with respect to
suitably small open neighborhoods U ⊃ W0 t of orbits of points in T ,
and this will be discussed in present section.
   When s = sα ∈ S0 (with α ∈ F1 ), we define an intertwining element
ιs as follows:
                                                       1/2
            ιs = (1 − θ−α )Ts + ((1 − qα∨ q2α∨ ) + qα∨ (1 − q2α∨ )θ−α/2 )
(4.1)                                                   1/2
                  = Ts (1 − θα ) + ((qα∨ q2α∨ − 1)θα + qα∨ (q2α∨ − 1)θα/2 )
 We remind the reader of the convention of Remark 3.1. These elements
are important tools to study the Hecke algebra. We recall from [37],
Theorem 2.8 that these elements satisfy the braid relations, and they
satisfy (for all x ∈ X)
                             ιs θx = θs(x) ιs ,
and finally they satisfy
            1/2              1/2          1/2                 1/2
     ι2s = (qα∨ + θ−α/2 )(qα∨ + θα/2 )(qα∨ q2α∨ − θ−α/2 )(qα∨ q2α∨ − θα/2 ).
(where we have again used the convention of Remark 3.1!). Suitably
normalized versions of the ιs generate a group isomorphic to the Weyl
group W0 . In order to normalize the intertwiners, we need to tensor
H by the field of fractions F of the center Z. So let us introduce the
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 59

algebra
(4.2)                         FH   := F ⊗Z H
 with the multiplication defined by (f ⊗ h)(f ′ ⊗ h′ ) := f f ′ ⊗ hh′ .
Notice that this an algebra over F of dimension |W0 |2 . The subalgebra
F A = F ⊗Z A is isomorphic to the field of fractions of A. The field
extension F ⊂ F A has Galois group W0 , and we denote by f → f w
the natural action of W0 on the field of rational functions on T . The
elements Tw with w ∈ W0 form a basis for F H for multiplication on
the left or multiplication on the right by F A, in the sense that
(4.3)              FH   = ⊕w∈W0 F ATw = ⊕w∈W0 TwF A.
The algebra structure of F H is determined by the Bernstein-Zelevinski-
Lusztig relations as before: when f ∈ F A and s = sα with α ∈ F1 , we
have
                                           1/2                  f − fs
(4.4)   f Ts − Ts f s = ((q2α∨ qα∨ − 1) + qα∨ (q2α∨ − 1)θ−α/2 )
                                                                1 − θ−α
We have identified A with the algebra of regular functions on T in the
above formula.
  Let us introduce
              nα := q(sα )∆α cα
(4.5)                1/2           1/2
                 = (qα∨ + θ−α/2 )(qα∨ q2α∨ − θ−α/2 ) ∈ A,
 where we used the Macdonald c-function introduced in equation (3.3)
and (3.4).
  The normalized intertwiners are now defined by (with s = sα , α ∈
R1 ):
(4.6)                       ι0s := n−1
                                    α ιs ∈ F H.

By the properties of the intertwiners listed above it is clear that (ι0s )2 =
1. In particular, ι0s ∈ F H× , the group of invertible elements of F H.
From the above we have the following result:
Lemma 4.1. The map S0 ∋ s → ι0s ∈ F H× extends (uniquely) to a
homomorphism W0 ∋ w → ι0w ∈ F H× . Moreover, for all f ∈ F A we
have that ι0w f ι0w−1 = f w .
  Lusztig ([26], Proposition 5.5) proved that in fact
Theorem 4.2.
(4.7)              FH   = ⊕w∈W0 ι0w F A = ⊕w∈W0 F Aι0w
60                            ERIC M. OPDAM

   Let U ⊂ T be a nonempty, open, W0 -invariant subset. We denote by
Z an (U) the ring of W0 -invariant holomorphic functions of U. Consider
the algebras Aan (U) := Z an (U)⊗Z A and Han (T ) := Z an (T )⊗Z H. The
algebra structure on Han (T ) is defined by (f ⊗ h)(f ′ ⊗ h′ ) := f f ′ ⊗ hh′
(similar to the definition of F H).
   Let us first remark that the finite dimensional representation theory
of the “analytic” affine Hecke algebra Han (T ) is the same as the finite
dimensional representation theory of H. Every finite dimensional rep-
resentation π of H determines a co-finite ideal Jπ ⊂ Z, the ideal of
central elements of H which are annihilated by π. Denote by Jπan the
ideal of Z an (T ) generated by Jπ . Because of the co-finiteness we have
an isomorphism
(4.8)                         ˜ an (T )/Jπan (T ).
                         Z/Jπ →Z
This shows that π can be uniquely lifted to a representation π an of
Han (T ) whose restriction to H is π. The functor π → π an defines an
equivalence between the categories of finite dimensional representations
of H and Han (T ) (with the inverse given by restriction).
   For any W0 -invariant nonempty open set U ⊂ T we define the local-
ized affine Hecke algebra
(4.9)                   Han (U) := Z an (U) ⊗Z H.
 This defines a presheaf of Z an -algebras on W0 \T , which is finitely gen-
erated over the analytic structure sheaf Z an of the geometric quotient
W0 \T .
  A similar argument as above shows that
Proposition 4.3. The category Rep(Han (U)) of finite dimensional
modules πUan over Han (U) is equivalent to the category RepU (H) of
finite dimensional modules π over H whose Z-spectrum is contained in
U.
Lemma 4.4. For every W0 -invariant nonempty open set U in T , we
have the isomorphism Aan (U) ≃ Z an (U) ⊗Z A, where Aan (U) denotes
the ring of analytic functions on U.
Proof. Both the left and the right hand side are finitely generated mod-
ules over Z an (U), and we have a natural morphism from the right hand
side to the left hand side (product map). In order to prove that this
map is an isomorphism it suffices to show this in the stalks of the cor-
responding sheaves at each point of W0 \U. Let It denote the maximal
ideal in Z corresponding to W0 t, and let Ẑt denote the It -adic com-
pletion. Because Ẑt is faithfully flat over Ztan (the stalk at W0 t of the
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 61

sheaf Z an ), it suffices to check that for each t ∈ U, we have
(4.10)                   Ẑt ⊗Ztan Aan
                                    W0 t ≃ Ẑt ⊗Z A,

where Aan               an
           W0 t = ⊕t′ At′ denotes the space of analytic germs at the set
W t. Let mt denote the maximal ideal of A at t ∈ T , and let It A =
Q0                                             ′               dan
 t′ ∈W0 t jt′ with jt′ = It A ∩ mt′ . For all t ∈ W0 t we have At′ j ′ Aan =
                                                                    t   t′

            Aan
Âjt′ . Sincet    ∩ It Aan
                        W0 t  =jt Aan
                                   t ,the left hand side of 4.10 is equal to
⊕t′ ∈W0 t Âjt′ , the sum of the completions of A with respect to jt′ . The
right hand side of 4.10 is equal to the completion ÂIt A . By the Chinese
remainder theorem, ÂIt A ≃ ⊕t′ ∈W0 t Âjt′ , finishing the proof.        

Proposition 4.5. The algebra Han (U) is a free Aan (U) module of rank
|W0 |, with basis Tw ⊗ 1 (w ∈ W0 ). When f ∈ Aan (U) and s = sα with
α ∈ F1 we have again the Bernstein-Zelevinski-Lusztig relation
                                          1/2                  f − fs
(4.11) f Ts − Ts f s = ((q2α∨ qα∨ − 1) + qα∨ (q2α∨ − 1)θ−α/2 )         .
                                                               1 − θ−α
This describes the multiplication in the algebra Han (U). The center of
Han (U) is equal to Z an (U).
 Similarly we have the localized meromorphic affine Hecke algebra
Hme (U), which is defined by
(4.12)                   Hme (U) := F me (U) ⊗Z H,
 where F me (U) it the quotient field of Z an (U). We write Ame (U) :=
F me (U) ⊗Z A . It is the ring of meromorphic functions on U.
Theorem 4.6.
(4.13)         Hme (U) = ⊕w∈W0 Ame (U)ι0w = ⊕w∈W0 ι0w Ame (U)
Proof. This is clear from Theorem 4.2 by the remark that Hme arises
from the F -algebra F H by extension of scalars according to
                        Hme (U) = F me (U) ⊗Z H
(4.14)
                                  = F me (U) ⊗F F H.
                                                                             


4.1. Lusztig’s structure theorem and parabolic induction
  We shall investigate the structure of the tracial states χt , using
Lusztig’s technique of localization of H as discussed above. The re-
sults in the present subsection are substitutes for the usual techniques
62                           ERIC M. OPDAM

of parabolic induction for reductive groups. The results in this sub-
section are closely related to the results on parabolic induction in the
paper [7].
   We use in fact a slight variation of the results of Lusztig [26]. There
are two main differences. First of all we work with analytic localiza-
tion at suitably small neighborhoods, instead of Lusztig’s use of adic
completion. In addition we have replaced the root system of the local-
ized algebra which Lusztig has defined by something slightly different.
Lusztig’s construction only works with the additional assumption in
Convention 2.1 that fs ∈ N, and this assumption is not natural in our
context. We have therefore adapted the construction.
   We define a function
(4.15)        T ∋ t → RP (t) ⊂ R0 , a parabolic subsystem
 by putting RP (t) := R0 ∩ t∗ <t> , with t∗ <t> ⊂ t∗ = R ⊗Z X the subspace
spanned by the roots α ∈ R0 for which one of the following properties
holds
       (i) cα 6∈ Ot× (the invertible holomorphic germs at t).
      (ii) α(t) = 1,
     (iii) α(t) = −1 and α 6∈ 2X.
We let P (t) ⊂ RP (t),+ := RP (t) ∩ R0,+ be the basis of simple root for
RP (t),+ . We have the following easy consequences of the definition:
Proposition 4.7.         (i) t → RP (t) is lower semi-continuous with
        respect to the Zariski-topology of T and the ordering of subsets
        of R0 by inclusion.
   (ii) t → RP (t) is equivariant: for all w ∈ W we have RP (wt) =
        w(RP (t) .
   We denote by WP (t) the parabolic subgroup of W0 generated by the
reflections sα with α ∈ RP (t) . We say that t1 , t2 ∈ W0 t are equivalent
if there exists a w ∈ WP (t1 ) such that t2 = w(t1 ). To see that this is
actually an equivalence relation, observe that RP (t2 ) = RP (t1 ) for all
t2 ∈ WP (t1 ) t1 . The equivalence classes are the orbits ̟ = WP (t) t. This
gives a partition of W0 t in a collection equivalence classes which are
denoted by ̟ ⊂ W0 t. If t ∈ ̟ we sometimes write P (̟), WP (̟) etc.
instead of P (t), WP (t) etc. Note that W0 acts transitively on the set of
equivalence classes and that for each equivalence class ̟, WP (̟) acts
transitively on ̟.
   Let ̟ ⊂ W0 t be the equivalence class of t. We define:
(4.16)               W̟ := {w ∈ W0 | w(̟) = ̟}.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 63

 By Proposition 4.7 it is clear that WP (̟) ⊳ W̟ , and that this normal
subgroup is complemented by the subgroup
(4.17)          W (̟) := {w ∈ W̟ | w(P (̟)) = P (̟)}


Lemma 4.8. For α ∈ R0 we have: α ∈ RP (̟) ⇐⇒ sα ∈ W̟ .
Proof. We only need to show that sα ∈ W̟ implies that α ∈ RP (̟)
(the other direction being obvious). Notice that if t ∈ ̟ we have
(4.18)                    t−1 ̟ ⊂ ZRP∨ (̟) ⊗ C× .
If sα ∈ W̟ then sα (t) ∈ ̟, and thus
(4.19)                  α∨ ⊗ α(t) ∈ ZRP∨ (̟) ⊗ C× .
By Proposition 4.7, we have sα (RP (̟) ) = RP (̟) . Since RP (̟) is par-
abolic this implies that either α ∈ RP (̟) or that α(RP∨ (̟) ) = 0. In
the first case we are done, so let us assume the second case. By
(4.19) it follows that 1 = α(α∨ ⊗ α(t)) = α(t)2 . If α(t) = 1 we have
α ∈ RP (̟) by definition, contradicting the assumption. If α(t) = −1
and α 6∈ 2X then, by definition, α ∈ RP (̟) , contrary to the assump-
tion. If α(t) = −1 and α = 2x for some x ∈ X then (4.19) implies
1 = x(α∨ ⊗ α(t)) = α(t) = −1, again a contradiction. We conclude
that the second case does not arise altogether, and we are done.      

  Consider the algebra HP (t) := H(X, Y, RP (t) , RP∨ (t) , P (t)). Note that
W (̟) acts by means of automorphisms on RP (t) = (X, Y, RP (t) , R(t)  ∨
                                                                         , P (t)),
compatible with the root labels q. Thus we may define an action of
γ ∈ W (̟) on HP (t) by γ(Tw θx ) = T(γwγ −1 ) θγx . In this way we form
the algebra H̟ := HP (t) [W (̟)] , with its product being defined by
(h1 γ1 )(h2 γ2 ) = h1 γ1 (h2 )γ1 γ2 .
  By Proposition 4.7(i) it is obvious that for any t ∈ T there exists an
open ball B ⊂ tC centered around the origin such that the following
conditions are satisfied:
Conditions 4.9.           (i) ∀α ∈ R0 , b ∈ B : |Im (α(b))| < π. In par-
         ticular, the map exp : tC → T restricted to B is an analytic
         diffeomorphism onto its image exp(B) in T .
    (ii) If w ∈ W0 and t exp(B) ∩ w(t exp(B)) 6= ∅ then wt = t.
   (iii) For all t′ ∈ t exp(B), we have RP (t′ ) ⊂ RP (t) .
  Let t ∈ T . We take B ⊂ tC as above and we put U = W0 t exp(B).
Concerning the analytic localization Han (U) we have the following ana-
log of Lusztig’s first reduction theorem (see [26]):
64                            ERIC M. OPDAM

Theorem 4.10. For ̟ ⊂ W0 t an equivalence class, we put U̟ :=
̟ exp(B). We define 1̟ ∈ Aan (U) by 1̟ (u) = 1 if u ∈ U̟ and
1̟ (u) = 0 if u 6∈ U̟ . The elements 1̟ are mutually orthogonal idem-
potents. Let t ∈ ̟.
      (i) We have H̟,an (U̟ ) := HP (̟),an (U̟ )[W (̟)] ≃ 1̟ Han (U)1̟ .
     (ii) We can define linear isomorphisms
(4.20)           ∆̟1 ,̟2 : H̟,an (U̟ ) → 1̟1 Han (U)1̟2 .
            such that ∆̟1 ,̟2 (h)∆̟3 ,̟4 (h′ ) = ∆̟1 ,̟4 (hh′ ) if ̟2 = ̟3 ,
           and ∆̟1 ,̟2 (h)∆̟3 ,̟4 (h′ ) = 0 else.
     (iii) The center of H̟,an (U̟ ) is Z ̟,an (U̟ ) := (Aan (U̟ ))W̟ . This
           algebra is isomorphic to Z an (U) via the map z → 1̟ z, and
           this gives H̟,an (U̟ ) the structure of a Z an (U)-algebra.
     (iv) Let N denote the number of equivalence classes in W0 t. There
           exists an isomorphism Han (U) ≃ (H̟,an (U̟ ))N , the algebra
           of N ×N matrices with entries in 1̟ Han (U)1̟ ≃ H̟,an (U̟ ).
           It is an isomorphism of Z an (U)-algebras.
Proof. The difference with Lusztig’s approach is that he works with
the It -adic completions of the algebras instead of the localizations to
U. In addition, we have a different definition of the root system RP (t) .
  Using Lemma 4.4 we can copy the arguments of [26], because of the
Conditions 4.9 for B and because of Lemma 4.8 (which replaces in
our situation Lemma 8.2b of [26]). By this we see that the function
cα is analytic and invertible on U̟ ∪ Usα ̟ for all α ∈ R0 such that
sα 6∈ W̟ (compare [26], Lemma 8.9), and this is the crucial point of
the construction.                                                     

Corollary 4.11. The functor V → V̟ := 1̟ V defines an equivalence
between the category of finite dimensional representations of Han (U)
and the category of finite dimensional representations of H̟,an (U̟ ) =
HP (t),an (U̟ )[W (̟)]. We have dim(V ) = N dim(V̟ ) where N denotes
the number of equivalence classes in W0 t.                            

Definition 4.12. Let RP ⊂ R0 be a parabolic root subsystem, with
P ⊂ RP,+ := RP ∩ R0,+ its basis of simple roots. We denote the
corresponding parabolic subgroup of W0 by WP := W (RP ). We call
t ∈ T an RP -generic point if W̟ ⊂ WP for ̟ = WP (t) t.
Corollary 4.13. If t is RP -generic we have RP (t) ⊂ RP .
Proof. This is immediate from the definitions.                            
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 65

   We define for any parabolic subsystem RP ⊂ R0 with basis P of
RP,+ the parabolic subalgebra HP = H(X, Y, RP , RP∨ , P ) ⊂ H with
root labels q P .
   Assume that B satisfies the Conditions 4.9. Notice that if t is RP -
generic, then every t′ ∈ t exp(B) is RP -generic. Indeed, let ̟ ′ =
WP (t′ ) t′ and ̟ = WP (t) t. If w ∈ W̟′ , then there exists a w ′ ∈ WP (t′ ) ⊂
WP (t) (by condition 4.9(iii)) such that w ′ t′ = wt′ (since the equivalence
class of t′ is a WP (t′ ) -orbit). By condition 4.9(ii), also w ′ t = wt. Hence
w ∈ W̟ ⊂ WP , as required.
   We now put U = W0 t exp(B), UP = WP t exp(B) and consider the
localization HP,an (UP ).
Corollary 4.14. Assume that t ∈ T is RP -generic. We have Han (U) ≃
(HP,an (UP ))|W P | , where W P = W0 /WP . Moreover, when we define
      P
1P := ̟⊂WP t 1̟ then HP,an (UP ) ≃ 1P Han (U)1P . These are isomor-
phisms of Z an (U)-algebras.
Proof. The fact that t is RP -generic implies that the W0 -equivalence
classes of the elements of WP t are equal to the WP -equivalence classes of
these elements. Therefore we have, by the above theorem, HP,an (UP ) ≃
(H̟,an (U̟ ))nP , where nP is the number of equivalence classes ̟ ′ in
the orbit WP t. And for each w ∈ W0 , wWP t ⊂ W0 t is a union of nP
distinct W0 -equivalence classes. The orbit W0 t is the disjoint union
of |W P | subsets of the form wWP t ⊂ W0 t, since the stabilizer of t is
contained in WP (because t is RP -generic). Each subset wWP (t) t in
W0 t is partitioned into nP equivalence classes, and the result follows.


  Recall that, by Proposition 4.3, a finite dimensional representation
(V, π) of H with its Z-spectrum contained in U extends uniquely to a
representation (V an , π an ) of Han (U).
Corollary 4.15. In the situation of Corollary 4.14, there exists an
equivalence (V, π) → (VP , πP ) between RepU (H) and RepUP (HP ), char-
acterized by VPan = 1P V an . We have dim(V ) = |W P | dim(VP ), and
the inverse functor is given by VP → IndH  HP (VP ) = H ⊗HP VP . The
character χP of the module (VP , πP ) of HP is given in terms of the
character χπ of (V, π) by the formula χP (h) = χπ (1P h).
Proof. We localize both the algebras H and HP and use Proposition
4.3 and Corollary 4.14. Using Corollary 4.14 we see that the functor
V → 1P V an |HP is the required equivalence. The relation between the
dimensions of V and VP is obvious from this definition. Conversely,
66                              ERIC M. OPDAM

again using Corollary 4.14, we have
(4.21)
    1P (IndH
           HP VP )
                   an
                      = 1P (H ⊗HP VP )an
                             X
                      = 1P (   1P ′ HP,an (UP )1P ′′ ) ⊗HP,an (UP ) 1P V an
                             P ′ ,P ′′
                              an
                       = 1P V       = VPan ,
finishing the proof.                                                                     

Proposition 4.16. Let P ⊂ F0 be a subset, and let RP ⊂ R0 be
the corresponding standard parabolic subsystem. We define the subtori
TP , T P and the lattices XP , YP as in Proposition 7.3. Put RP =
(XP , YP , RP , RP∨ , FP ), and let t ∈ T P . There exists a surjective homo-
morphism φt : HP → HP which is characterized by (1) φt is the iden-
tity on the finite dimensional Hecke algebra H(WP ), and (2) φt (θx ) =
x(t)θx , where x ∈ XP is the natural image of x in XP = X/P X =
X/(X ∩ YP ⊥ ).
Proof. We have to check that φt is compatible with the Bernstein-
Zelevinski-Lusztig relations. Let s = sα with α ∈ P ⊂ F0 . Then
(4.22)
 θx Ts − Ts θs(x) =
       (                                 θx −θs(x)
                           (qα∨ − 1)      1−θ−α
                                                                        if 2α 6∈ Rnr .
     =                             1/2                      θx −θs(x)
            ((qα∨ /2 qα∨ − 1) +   qα∨ /2 (qα∨   −    1)θ−α ) 1−θ−2α     if 2α ∈ Rnr .
Since s acts trivially on T P , we have x(t) = sx(t). This implies the
result.                                                             

Definition 4.17. Let P ⊂ F0 be a subset. In this case we identify the
algebra HP = H(X, Y, RP , RP∨ , P ) with the subalgebra in H generated
by H(WP ) and C[X]. Let (V, δ) be a representation of HP with central
character WP r ∈ WP \TP , and let t ∈ T P . Denote by δt the representa-
tion δt = δ ◦ φt of HP . We define a representation π(RP , WP r, δ, t) of
H by π(RP , WP r, δ, t) = IndH
                             HP (δt ) . We refer to such representations
as parabolically induced representations.
Corollary 4.18. Let W0 t ∈ W0 \T , and let RP be a standard parabolic
subsystem of R0 . Suppose that there exists an r ∈ TP and tP ∈ T P such
that rtP ∈ W0 t is an RP -generic point. The map δ → π(RP , WP r, δ, tP )
gives an equivalence between the representations of H with central char-
acter W0 t and the representations of HP with central character WP r.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 67

Proof. By Corollary 4.15, the induction functor from representations
of HP to H gives rise to an equivalence between the representations
of HP with RP -regular central character WP t and the representations
of H with central character W0 t. If π is a representation of HP with
central character WP t, then it is easy to see that the annihilator of π
contains the kernel of the homomorphism φtP . Thus π is the lift via
φtP of a representation δ of HP . This gives an equivalence between the
category of representations of HP with central character WP r and the
representations of HP with central character WP t.                    

   The following proposition describes the induced modules analogous
to the “compact realization” of parabolically induced representations
of real reductive groups.
Proposition 4.19. Let (V, δ) be an irreducible representation of HP
with central character WP r ∈ WP \TP as before. Suppose that (V, δ)
is unitary with respect to an Hermitian inner product (·, ·), and that
t ∈ TuP . We identify the underlying representation space Vπ of π :=
π(RP , WP r, δ, t) with
(4.23)                      Vπ := H(W P ) ⊗ V,
where H(W P ) ⊂ H(W0 ) denotes the subspace spanned by the elements
Tw with w ∈ W P . Then π is unitary with respect to the Hermitian inner
product h·, ·i defined on Vπ by (with x, y ∈ H(W P ), and u, v ∈ V ):
(4.24)               hx ⊗ u, y ⊗ vi := τ (x∗ y)(u, v).
Proof. The above form is clearly Hermitian and positive definite. It
remains to show that the inner product satisfies
(4.25)              hπ(h)m1 , m2 i = hm1 , π(h∗ )m2 i
for each m1 , m2 ∈ Vπ , h ∈ H. To this end we recall Theorem 2.20 of
[37]. Let is : H → End(H0 ) denote the minimal principal series rep-
resentation induced from s ∈ T . Then the nondegenerate sesquilinear
pairing defined on H0 × H0 by
(4.26)                        (x, y) := τ (x∗ y)
satisfies the property
(4.27)                   (is (h)x, y) = (x, is∗ (h∗ )y)
(see Theorem 7.14 for the definition of s∗ ). We have H0 = H(W P ) ⊗
H(WP ), and the pairing (4.26) on H0 factors as the tensor product
of the pairings on H(W P ) and on H(WP ) which are also defined by
equation (4.26) but with x, y both in H(W P ) or both in H(WP ).
68                           ERIC M. OPDAM

    We choose r ∈ TP such that V contains a simultaneous eigenvector
v for XP with eigenvalue r. Via δt , the vector v ∈ V has eigenvalue
rt ∈ T with respect to X. Thus there is a surjective morphism of
HP -modules α : H(WP ) ։ V , where H(WP ) is the minimal prin-
cipal series module iPrt for HP , and V is the representation space of
δt . By the above, applied to HP , we have the adjoint injective mor-
phism α∗ : V ֒→ H(WP ), where the action on H(WP ) is via iPr∗ t (since
(rt)∗ = r ∗ t, because t ∈ TuP ). By the exactness and the transitivity
of induction we get morphisms of H-modules Ind(α) : irt ։ π and
Ind(α∗ ) : π ֒→ ir∗ t . Notice that Ind(α) = IdH(W P ) ⊗α and similarly,
Ind(α∗ ) = IdH(W P ) ⊗α∗ . By the factorization of the pairing (4.26) we
see that Ind(α) and Ind(α∗ ) are adjoint with respect to the pairings
h·, ·i on Vπ and (4.26) on H0 . This, the surjectivity of Ind(α) and (4.27)
gives the desired result (4.25).                                         

Proposition 4.20. With the notations as above, assume that (V, δ) is
a tempered representation with central character WP r ∈ WP \TP and
that t ∈ TuP . Then π := π(RP , WP r, δ, t) is a tempered representation
of H.

Proof. Recall that we have the identification

(4.28)                     Vπ := H(W P ) ⊗ V,

where H(W P ) ⊂ H(W0 ) denotes the subspace spanned by the elements
Tw with w ∈ W P . Recall from the proof of Lemma 2.20 that we can find
a basis (vj ) of V such that XP acts by upper triangular matrices with
respect to this basis. By Casselman’s criterion, the diagonal entries
are characters rj,j ∈ WP r of XP which satisfy |x(ri,i )| ≤ 1 for x ∈ XP+ .
Let (wi) denote an ordering of the set W P such that the length l(wi )
increases with i. We take the tensors Twi ⊗vj , ordered lexicographically,
as a basis for the representation space of π. From a direct application
of the Bernstein-Zelevinski-Lusztig relations we see that the θx are
simultaneously upper triangular in this basis, and that the diagonal
entries are the elements wi (trj,j ). Since wi ∈ W P , t ∈ TuP and since the
vector part of rj,j is an element of the cone generated by the negative
roots of RP∨ , it follows from a well known characterization of W P that
the vector parts of these diagonal entries are in the antidual of the
positive chamber. Again using Lemma 2.20 we conclude that π is
tempered.                                                                 
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 69

4.2. The tracial states χt and parabolic induction
   In this subsection we will compute the states χt on W0 -orbits of
tempered residual cosets of positive dimension in terms of the charac-
ters of unitary representations which are induced from discrete series
characters of parabolic subalgebras, as was discussed in Subsection 4.1.
   Let L be a residual coset such that RL ⊂ R0 is a standard para-
bolic subsystem. In other words, FL ⊂ F0 . Let us denote by HL the
affine Hecke algebra with root datum RL := (XL , YL , RL , RL∨ , FL ) and
root labels qL . (see Proposition 7.3). Let rL = cL sL ∈ TL be the
corresponding residual point of RL .
Lemma 4.21. Let U ⊂ T be a nonempty W0 -invariant open subset.
Let t ∈ U. There exists a unique extension of the Eisenstein func-
tional (cf. equations 3.9) Et (which we will also denote by Et ) to the
localization Han (U), such that Et (f h) = Et (hf ) = f (t)Et (h) for all
f ∈ Aan (U).
Proof. The functional Et factors to a functional of the finite dimen-
sional C-algebra Ht := H/It H , where It is the maximal ideal in
Z corresponding to W0 t. We have H/It H = Han (U)/Itan (U)Han (U)
for t ∈ U, and this defines the extension with the required property
uniquely.                                                          

Lemma 4.22. Let L be such that RL ⊂ R0 is a standard parabolic
subset of roots, and let t0 ∈ T be RL -generic. Set U = W0 t0 exp(B)
with B satisfying the conditions 4.9 (i), (ii), and (iii). As before, we
put UL = WL t0 exp(B).
  We denote by EtL the Eisenstein functional of the subalgebra HL ⊂
H. For tL ∈ TL we write EL,tL to denote the Eisenstein functional at
tL ∈ TL = Hom(XL , C× ) of the algebra HL . Let t = tL tL ∈ U with
tL ∈ T L and tL ∈ TL . Recall 1L is the characteristic function of UL .
We have, for all h ∈ HL :
      (i) Et (1L h1L ) = q(w L)1L (t)∆L (t)EtL (h).
     (ii) EtL (h) = EL,tL (φtL (h)).
Proof. Because these are both equalities of holomorphic functions of
t ∈ U it suffices to check them for t regular, and outside the union of
the residual cosets (in other words, c(t)c(t−1 ) 6= 0).
  (i). By the defining properties 3.9 and [37], 2.23(4) we need only
to show that the left hand side satisfies the properties Et (1L xh1L ) =
Et (1L hx1L ) = t(x)1L (t)Et (h) and Et (1L ) = q(w0 )1L (t)∆(t). These
facts follow from Lemma 4.21.
70                                ERIC M. OPDAM

     (ii). We see that

                  EL,tL (φtL (θx h)) = EL,tL (x(tL )θx φtL (h))
                                     = x(tL )x(tL )EL,tL (φtL (h))
                                     = x(t)EL,tL (φtL (h)),

and similarly for EL,tL (φtL (hθx )). The value at h = 1 is equal to
q(wL)∆L (t) on both the left and the right hand side. As in the proof
of (i), this is enough to prove the desired equality.              

Theorem 4.23. Let L be a residual coset such that RL ⊂ R0 is a stan-
dard parabolic subset of roots. Let tL ∈ TuL be such that t := rL tL ∈
Ltemp is RL -generic. Notice that this condition is satisfied outside a
finite union of real codimension one subsets in TuL . Let ∆RL ,WL rL be
complete set of inequivalent irreducible
                               P         representations of the residual
           rL
algebra HL , and let χHL ,rL = δ∈∆R ,W r χδ dRL ,δ be the correspond-
                                       L  L L
ing decomposition in irreducible discrete series characters of the tracial
state χHL ,rL of HL .
        (i) For all δ, π(RL , WL rL , δ, tL ) is irreducible, unitary and tem-
            pered with central character W0 t. These representations are
            mutually inequivalent.
       (ii) We have
                                    X
(4.29)             |W L |χt =                  χRL ,WL rL ,δ,tL dRL ,δ ,
                                δ∈∆RL ,WL rL



             where χRL ,WLrL ,δ,tL denotes the character of π(RL , WL rL , δ, tL ).
             In particular, the constants dt,i as in Definition 3.24 are in-
             dependent of t.
       (iii) For all (not necessarily RL -generic) t = rL tL ∈ Ltemp , the
             character χRL ,WL rL ,δ,tL is a positive trace on H. Consequently,
             the irreducible subrepresentations of π(RL , WL rL , δ, tL ) extend
             to C.

Proof. (i). This is a direct consequence of Corollary 4.18, Proposition
4.19 and Proposition 4.20.
  (ii). Recall the definition of the states χt . Recall that the support
of the measure ν is the union of the tempered residual cosets. We
combine Definition 3.16, Proposition 3.15, and Proposition 3.7 to see
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 71

that (with NL the stabilizer of L in W0 )
              Z
        |W0 |
(4.30)                z(t)χt (h)dνL (t)
        |NL | t∈Ltemp
                               X Z                      Z
                          =                                                z(t′ )Et′ (h)η(t′ )
                                    M ∈W0 L   tM ∈TuM       t′ ∈tM ǫM ξM




for all h ∈ H and z ∈ Z. Rewrite the right hand side as
                    Z         X
                kL
(4.31)                           Jw,L (ǫwL rwL w(tL ))dL (tL )
               |NL | tL ∈TuL w∈W
                                      0


where the inner integrals equal, with s ∈ wT L,
(4.32)             Z
                                      Et′ (h)                   1
    Jw,L (rwL s) =          z(t′ )         wL   ′
                                                    mwL (t′ )          ω (t′ ),
                                                                    ′ ) wL
                     ′
                    t ∈sξwL        q(w 0 )∆   (t  )           ∆wL (t
where
                                         dwL (twL )
(4.33)            ωwL (t) :=                                    .
                               q(wL )cRL (w −1 t)cRL (w −1t−1 )
Hence Jw,L (rwL s) is a linear combination of (possibly higher order)
partial derivatives (in the direction of wTL ) of the kernel
                                      Et′ (h)
(4.34)                    z(t′ )           wL ′
                                                mwL (t′ ),
                                   q(w0 )∆ (t )
evaluated at rwL s. The NL -invariant measure on Ltemp on the left hand
side of 4.30 is thus obtained by taking the boundary values ǫwL → 1 of
the Jw,L (ǫwL rwL w(t)), and then sum over the Weyl group as in equation
(4.31). Notice that the collection of RL -generic points in L is the
complement of a union of algebraic subsets of L of codimension ≥ 1.
The kernel (4.34) is regular at such points of L. The boundary values
at RL -generic points are therefore computed simply by specialization
at ǫwL = 1. We thus have
                                         kL X
(4.35)         z(t)χt (h)κWL L mL (t) =           Jw,L (rwL w(tL )).
                                        |W0 | w∈W
                                                              0


The expression on the left hand side can be extended uniquely to z ∈
Z an (U) and h ∈ Han (U). By equation (4.32), each summand in the
expression on the right hand can also be extended uniquely to such
locally defined analytic z and h.
72                             ERIC M. OPDAM

  Take U = W0 t exp(B). We restrict both sides to 1L HL 1L ⊂ HL,an (UL ).
Substitute h by 1Lh1L with h ∈ HL . On the left hand side we get, by
Corollary 4.15,
                       1
(4.36)                      z(t)χLt (h)κWL L mL (t)
                     |W L |
where χLt is a central functional on HL , normalized by χLt (e) = 1.
  On the other hand, by Lemma 4.22, if h = 1L h1L with h ∈ HL then
                         Z
                   L
                                              EL,t′L (φt′,L (h)) wL ′
(4.37) Jw,L (w(rL t )) =               z(t′ )                ′
                                                                 m (t )ωwL (t′ )
                            ′    L
                           t ∈w(t )ξwL        q(w  L )∆    (t
                                                         L L   )
if w(rLtL ) ∈ UL , and Jw,L (w(rL tL )) = 0 otherwise.
   Observe that, because of condition (ii) for B, wt ∈ UL implies that
there exists a w ′ ∈ WL such that wt = w ′ t. Since t = rL tL is RL -
generic, we see in particular that the stabilizer of t is contained in WL .
Thus wt ∈ UL implies that w ∈ WL , and hence that wt = w(rL )tL .
   Therefore the sum at the right hand side of equation (4.35) reduces,
if h is of the form 1L h1L with h ∈ HL , to
                        Z
              kL X                                   EL,t′ (φtL (h))
(4.38)                         z(tL t′ )mwL (tL t′ )                 ωwL (t′ )
             |W0 | w∈W t′ ∈ξwL                       q(wL )∆L (t′ )
                       L

The function wrL exp(B ∩ tL ) ∋ t′ → mwL (tL t′ ) is WL -invariant on
WL rL exp(B ∩ tL ) = (tL )−1 UL ∩ TL , because mL (t) is WL -equivariant
(i.e. mwL (wt) = mL (t) when w ∈ WL ). In other words, this function
is in the center of HLan ((tL )−1 UL ∩ TL ). By Definition 3.16, Corollary
3.20, Definition 3.22, and Theorem 3.25 applied to HL therefore, this
sum reduces to
             |WL |
(4.39)             z(t)χHL ,rL (φtL (h))mL (t)κWL L mRL ,rL (rL ),
             |W0 |
which we can rewrite as
                   |WL |
(4.40)                    z(t)χHL ,rL (φtL (h))κWL L mL (t).
                    |W0 |
Comparing this with (4.36) we see that, in view of equation (3.67), this
implies that for h ∈ HL ,
                               X
(4.41)       |W L|χt (1L h) =         χδ (φtL (h))dRL ,δ = χLt (h).
                               δ∈∆RL ,WL rL

Applying Corollary 4.15, Definition 4.17, and Corollary 4.18 we obtain
(ii).
   (iii). By Corollary 3.23, χt is ν-almost everywhere a positive trace.
On the set of RL -generic points t ∈ Ltemp , we have expressed χt as
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 73

a positive linear combination of the irreducible induced characters
χRL ,WL rL ,δ,tL . This gives the decomposition of χt in terms of irreducible
characters of the finite dimensional algebra Ht := H/Jt , where Jt de-
notes the two-sided ideal of H generated by the maximal ideal It of
the elements of the center Z which vanish at W0 t.
   On the other hand, we have the decomposition of χt in irreducible
characters of the finite dimensional Hilbert algebra Ht , as in Definition
3.24. This algebra is a quotient algebra of Ht . Because Ht is finite
dimensional, there is no distinction between topological and algebraic
irreducibility. We therefore have two decompositions of χt in terms
of irreducible characters of Ht . The irreducible characters of Ht are
linearly independent, and thus the two decompositions are necessarily
the same. This implies that the induced characters χRL ,WLrL ,δ,tL are
characters of the Hilbert algebra Ht . In particular, the characters are
positive traces for all RL -generic t ∈ Ltemp . These induced charac-
ters are regular functions of t ∈ Ltemp . Hence by continuity, they are
positive traces for all tL .
   By Corollary 2.17(i), χ(RL , WL rL , δ, tL ) extends to a continuous trace
of C for all t ∈ Ltemp . According to the construction in [15], Paragraphe
6.6. this character is the trace of a (obviously finite dimensional) repre-
sentation of C, quasi-equivalent with π(RL , WL rL , δ, tL ) when restricted
to H. Hence all subrepresentations of π(RL , WL rL , δ, tL ) extend to C.


Corollary 4.24. For all x ∈ H, the νL -measurable function Ltemp ∋
t → χt (x) can be defined by the restriction to Ltemp of a regular function
on L. For x ∈ C, the function t → χt (x) is continuous on Ltemp .
Proof. The first assertion was shown in the proof of Theorem 4.23(iii).
If x ∈ C there exists a sequence (xi ) with xi → x and xi ∈ H. By
Corollary 2.17(i), the function t → χt (x) is a uniform limit of the
functions t → χt (xi ), proving the continuity.                      

  The next Theorem basically is the Plancherel decomposition of H.
(In the next subsection we will refine the formula by adding more details
about the spectrum of C.)
Theorem 4.25. We have the following isomorphism of Hilbert spaces:
                       Z ⊕
(4.42)            H=          Ht |W0 t|dν(t).
                               W0 \T

The support of the probability measure ν is the union of the tempered
residual cosets. If t = rL tL ∈ Ltemp is RL -generic, then the residue
74                           ERIC M. OPDAM

algebra Ht has the structure

(4.43)                      Ht ≃ (HLrL )|W L| .

Finally, the residue algebra Hr at a residual point r ∈ T is of the form
                                 M
(4.44)                   Hr =          End(Vδ )
                               δ∈∆R,W0 r

with the Hermitian form on the summand End(Vδ ) given by
(4.45)                  (A, B) = dδ trace(A∗ B),
where the positive real numbers dδ are defined as in Definition 3.24
(with the notational convention that dδ = dr,i if δ = δi is the irreducible
representation of Hr corresponding to the central idempotent ei ).
Proof. The Hilbert space H is the completion of H with respect to the
positive trace τ . In Corollary 3.23(v) we have written τ as a positive
superposition of positive traces χt , with t ∈ W0 \T . In Theorem 4.23
we established that, outside a set of measure zero, χt is a finite linear
combination of traces of irreducible representations πRL ,WL rL ,δ,tL which
extend to C. Thus Corollary 3.23(v) is a positive decomposition of τ in
terms of traces of elements of Ĉ. This allows us to apply 8.8.5 and 8.8.6
of [15] in order to obtain (4.42). The statements about the residual
algebra of a residual point follow directly from the Definition 3.24.
Finally, equation (4.43) follows from Theorem 4.23 in combination with
the factorization Proposition 4.19 of the inner product h·, ·i on the
induced representations.                                                 


4.3. The generic residue of the Hecke algebra
   In this subsection we will use Theorem 4.23 in order to compute
explicitly the local traces χt when t = rL tL is an RL -generic element
of Ltemp . Here we assume that L is a residual coset such that RL is a
standard parabolic subset of R0 with basis FL of simple roots. Since
we assume that t is RL -generic, we have P (t) = FL . As before, we put
WL t = ̟, the equivalence class of t. By the genericity of t, W (̟) = 1.
   Observe that the residual algebra Ht (see Definition 3.24) is of the
form Ht = Ht / Radt , where Ht is the quotient algebra Ht := H/It H
(with It the maximal ideal of Z corresponding to t), and where Radt is
the radical of the positive semi-definite form (x, y)t := χt (x∗ y) (viewed
as a form on Ht ).
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 75

  By Lusztig’s Structure Theorem 4.10, Ht has the following decom-
position in the case where t is RL -generic:
                                M
(4.46)                 Ht =          ι0u e̟ HL ι0v−1
                                u,v∈W L

where e̟ = 1̟ mod(It Han (U)), the image of 1̟ in Ht (in the notation
of Section 4). We remark that this is not an orthogonal decomposition
with respect to (x, y)t .
   The subspace ι0u e̟ HL ι0v−1 is equal to eu̟ Ht ev̟ . If u = v then this
is a subalgebra of Ht . If u = v = e then this subalgebra is isomorphic
to HL,t via the isomorphism HL,t ∋ x → e̟ x ∈ e̟ HL .
   Let P, Q ⊂ F0 be subsets. We denote by W (P, Q) the following set
of Weyl group elements: W (P, Q) := {w ∈ W0 | w(P ) = Q} . If
P = Q ⊂ F0 then we simply write W (P ) = W (P, P )
   Let n ∈ W0 be such that n(FL ) = FM ⊂ F0 , in other words, let
n ∈ W (FL, FM ). Then the map
(4.47)                   ∆n̟,n̟ : e̟ HL → en̟ HM
                                          x → ι0n xι0n−1
 is an isomorphism. By the results of Lusztig [26], section 8, it satisfies
(with h ∈ HL ):
(4.48)                   ∆n̟,n̟ (e̟ h) = en̟ ψn (h),
              L      M
where ψn : H → H is the isomorphism of algebras defined by (with
w ∈ WL and x ∈ X):
(4.49)              ψn (Tw ) = Tnwn−1 , ψn (θx ) = θnx .
  Recall that Theorem 4.23(ii) implies that for all h ∈ HL ,
                                                  
(4.50)            |W L|χt (e̟ h) = χHL ,rL φtL (h) .
                                   ′
Corollary 4.26. Write n(t) = s = rM  sM .
      (i)
                                                  
(4.51)       χHM ,rM
                   ′ φsM (ψn (h)) = χHL ,rL φtL (h) .
     (ii) Let Ψn : ∆RL ,WLrL → ∆RM ,WM rM′  be the bijection such that
                        −1
          Ψn (δ) ≃ δ◦ψn . Then Ψn respects the residual degree: dRL ,δ =
          dRM ,Ψn (δ) .
Proof. (i) This follows from the above text, and the fact that χt is a
central functional.
   (ii) It is clear from Casselman’s criteria that Ψn indeed defines a
bijection between the sets of discrete series representations ∆RL ,WLrL
and ∆RM ,WM rM  ′ . The result follows from (i) and Theorem 4.23(ii). 
76                           ERIC M. OPDAM

Proposition 4.27. For all h, g ∈ HL we have
                                                            
(4.52)      |W L|mL (t)χt (e̟ h)∗ (e̟ g) = χHL ,rL φtL (h♯ g) ,
where ♯ denotes the ∗-operator of HL (thus Tw♯ = Tw−1 if w ∈ WL , and
θx♯ = TwL θ−wL x Tw−1
                    L
                      where wL denotes the longest element of WL ).
Proof. This will be proved by the computation in the proof of Theorem
4.30.                                                               
Corollary 4.28. We equip e̟ Ht e̟ with the positive semi-definite ses-
quilinear pairing obtained by restriction of the pairing |W L |mL (t)(x, y)t =
|W L|mL (t)χt (x∗ y) defined on Ht . The residual algebra HL,t is isomor-
phic as a Hilbert algebra to the quotient of e̟ Ht e̟ by the radical of
this pairing, via the map x → e̟ x.
Corollary 4.29. Recall the notation of Proposition 4.19. We consider
Vπ as a module over Ht . Put Vπ,̟ = π(e̟ )(Vπ ). Choose an isometric
embedding i : V → HLrL (as HL -modules). Let j denote the unique
module map j : Vπ → Ht such that j(1 ⊗ v) = e̟ (φtL )−1 (i(v)), where
φtL : HL,t → HLrL denotes the isometric isomorphism determined by the
homomorphism φtL (cf. Proposition 4.16). For any v ∈ V we denote
by i(v) any lift of i(v), and similarly for j. We have:
                                       ∼
       (i) Vπ,̟ = 1 ⊗ V , and j : Vπ,̟ → e̟ (φtL )−1 (i(V )).
      (ii) The positive definite Hermitian form h·, ·i on Vπ (see Propo-
           sition 4.19) can be expressed by:
(4.53)             hv, wi = |W L|mL (t)χt (j(v)∗ j(w)).
Proof. (i) is straightforward by observing that φtL descends to HL,t
and so defines an isometric isomorphism φtL by (4.50), applied to RL
instead of R (thus eω = 1, and |W L | = 1). Since Vπ is irreducible, it
is enough to compare the inner products on Vπ,̟ in order to prove (ii).
Apply Proposition 4.27 and Corollary 4.28.                           

  Assume that RM and RL are associate standard parabolic subsys-
tems. Let ̟1 = ̟ and ̟2 be equivalence classes inside W0 t such that
̟1 = WL t and ̟2 = WM s.
Theorem 4.30. Let n ∈ W (FM , FL ) be such that n(̟2 ) = ̟1 . Let
h ∈ HL and h′ ∈ HM such that e̟2 h′ = ι0n−1 e̟1 hι0n ∈ e̟2 HM . We
have
                                                             
          χt (he̟1 ι0n )∗ (he̟1 ι0n ) = χt (he̟1 )∗ (he̟1 )
                                                                 
                                       = χt (h′ e̟2 )∗ (h′ e̟2 )
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 77

Proof. Before we embark on this computation we establish some useful
relations. First recall that (Theorem 7.14) t∗ := t−1 ∈ WL t. Also recall
Proposition 2.9. We see that

(4.54)                    e∗̟1 = Tw0 ew0 ̟1 Tw−1
                                               0

                              = TwL ewL ̟1 Tw−1
                                              L,


where w L denotes the longest element of set of minimal coset represen-
tatives W L . Next we observe that for any w ∈ W0 ,
                                                    
                                          
                               Y      cα            
(4.55)          (ι0w )∗ = Tw0               ι0w′ −1  Tw−1 ,
                                α>0
                                      c −α
                                                          0

                               w′ (α)<0


where w ′ := w0 ww0 . This formula follows in a straightforward way
from Definition (4.6).
   If s is a simple reflection and ̟ ⊂ W0 t an equivalence class, we check
that (recall that t is RL -generic)
                             (
                               e̟ Ts             if s̟ = ̟
(4.56)          es̟ Ts e̟ =
                               es̟ q(s)cα ι0s   else.

Since we assume that t is RL -generic, we have u(̟1 ) 6= w(̟1) for all
w ∈ W L and all u ∈ W0 such that l(u) < l(w). From this, (4.56) and
induction to the length of l(w) we see that
                                    Y        
(4.57)          ew̟1 Tw e̟1 = q(w)          cα ι0w e̟1
                                             α>0
                                           w−1 (α)<0
                                                Y             
                            = ew̟1 q(w)                      cα ι0w
                                                   α>0
                                                 w−1 (α)<0


for all w ∈ W L . Observe that we also have
                                    Y        
(4.58)             ew̟1 Tw−1 e
                           −1 ̟1 =         c    0
                                             α ιw e̟1 .
                                            α>0
                                          w−1 (α)<0


We note that w0 = w L wL . Since wL and w0 are involutions, this implies
                  ′
that (w L)−1 = w L , where RL′ = w0 (RL ) (also a standard parabolic
subsystem).
  Let h = Tw θx ∈ HL , with w ∈ WL and x ∈ X. Keeping in mind
the above preliminary remarks, and the fact that χt is central, we now
78                                        ERIC M. OPDAM

compute (with x′ := −w0 (x) and w0 ̟1 = ̟1′ ):
(4.59)
                             
 χt (he̟1 ι0n )∗ (he̟1 ι0n )
                 Y  cα                                             
    = χt Tw0                    ι0n′ −1 e̟1′ θx′ Tw−1 Tw −1 T θ e  ι0
                                                             w x ̟1 n
                   α>0
                            c−α                     0

                    n′ (α)<0
               Y  cα                                                     
     = χt TwM ′          ι0n′ −1 e̟1′ θx′ Tw−1
                                             L′ T −1
                                                 wL wT −1 Tw θx e̟  ι0
                                                                   1 n Tw M
                α>0
                    c−α
                      n′ (α)<0
                         Y     Y       
     = χt e̟2 TwM ′ e̟2′     cα      c−1−1
                                      n′ α
                                    α>0                   α>0
                                    ′                     ′
                                  wM (α)<0              wL (α)<0
                                                                                                          
                                            −1
                         ι0n′ −1 θx′ e̟1′ T(w            −1                  0
                                              L )−1 e̟1 TwL Tw −1 Tw θx e̟1 ιn TwM

            ′
                            Y               Y             Y               
     = q(w M )χt e̟2 ι0wM ′             c−α               cα             c−1 −1
                                                                          n′ α
                                        α>0                       α>0                  α>0
                                         ′                        ′                    ′
                                       wM α<0                   wM (α)<0             wL (α)<0
                                                Y                                         
                                 ι0n′ −1 θx′                 cα ι0wL Tw−1 T
                                                                        L w
                                                                            −1 T θ e  ι0
                                                                                         T
                                                                                w x ̟1 n wM
                                                 α>0
                                                  ′
                                                wL α<0
                                        Y                          Y                     Y              
             L
     = q(w       )χt e̟2 ι0n−1 ι0wL′                    c   −n′ α                c   n′ α               c−1
                                                                                                         α
                                           α>0                          α>0                    α>0
                                            ′                           ′                      ′
                                          wM α<0                      wM (α)<0               wL (α)<0
                                          Y                                                   
                                                        cα θx′ ι0wL Tw−1 T
                                                                       L w
                                                                           −1 Tw θx e̟  ι0
                                                                                       1 n Tw M
                                                α>0
                                                 ′
                                               wL α<0
                          Y             Y           
     = q(w L)χt e̟2 ι0n−1     c−wL′ n′ α      cwL′ n′ α
                                     α>0                               α>0
                                      ′                                ′
                                    wM α<0                           wM (α)<0
                                                                                                              
                                                                θ−wL x Tw−1 T −1 Tw θx e̟1 ι0n TwM
                                                                          L w
                 Y                                 
     = q(w L)χt e̟1  cnα e̟1 θ−wL x Tw−1 T
                                       L w
                                           −1 T θ T
                                               w x wL
                               α6∈RM
                  Y                                               
     = q(w L)              cα (t) χt e̟1 TwL θ−wL x Tw−1
                                                       L
                                                         Tw −1 Tw θx

                   α6∈RL
                           
     = mL (t)−1 χt e̟1 h♯ h
                                           
     = |W L |−1 mL (t)−1 χHL ,rL φtL (h♯ h) .
The result is independent of n, implying the first equality of the the-
orem. The second equality follows because χt is central. Indeed, this
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 79

implies that we have
(4.60)                         χt (e̟1 h♯ h) = χt (e̟2 (h′ )♯ h′ ),
where the second ♯ of course refers to the ∗-structure on HM .
  In equation (4.59) we have used the evaluation
                  Y              Y           
(4.61)                   cα e̟1 =         cα (t) e̟1 .
                              α6∈RL                α6∈RL

This is allowed because the element
                            Y 
(4.62)                           cα ∈ A
                                         α6∈RL

is WL -invariant, and thus belongs to the center of HL .
   At several places in equations (4.59) and (4.60) we have freely used
formulae of Lusztig [26] (see Theorem 4.10) for the structure of Ht . For
example,
(4.63)                   ι0n−1 e̟1 hι0n = e̟2 ψn−1 (h) = e̟ h′
when h ∈ HL . By this we easily see that for all h ∈ HL ,
(4.64)                            ι0n−1 e̟1 h♯ ι0n = e̟2 (h′ )♯ ,
and hence we may conclude by equation (4.59) that
                                                         
(4.65)       χt (he̟1 )∗ (he̟1 ) = χt (h′ e̟2 )∗ (h′ e̟2 ) .
The proof is finished.                                                                         

Corollary 4.31. Let L, M1 , M2 be residual cosets such that FL , FM1
and FM2 are associate subsets of F0 , and let ni ∈ W (L, Mi ) (i = 1, 2).
The map
(4.66)        ∆n1 ̟,n2̟ : e̟ HL → ι0n1 e̟ HL ι0n−1 = en1 ̟ Hen2 ̟
                                                           2

                                      x → ι0n1 xι0n−1
                                                     2

is a partial isometry with respect to the natural positive semi-definite
pairing on Ht given by (x, y)t := χt (x∗ y).
                                                                      ′
Proof. We have, with ̟ ′ := n1 ̟, ∆n1 ̟,n2 ̟ = ∆̟
                                                ̟ ′ ,n                       −1 ′   ◦ ∆n1 ̟,n1 ̟ ,
                                                                          2 n1 ̟
         ̟′
where ∆̟′ ,n      −1 ′   is defined by
               2 n1 ̟
                          ′
(4.67)              ∆̟
                     ̟ ′ ,n2 n−1 ̟ ′
                                     : e̟′ HM1 → e̟′ HM1 ι0n1 n−1
                                 1                                        2

(4.68)                                            x → xι0n1 n−1
                                                               2

Both these respect the pairing (·, ·)t , by Theorem 4.30.                                      
80                             ERIC M. OPDAM

4.4. Unitarity and regularity of intertwining operators
   Let L, M be associate residual subspaces such that RL , RM are stan-
dard parabolic subsystems of R0 . Let n ∈ W0 be such that n(RL,+ ) =
RM,+ . As before we let ψn : HL → HM denote the isomorphism defined
by ψn (Tw ) = Tnwn−1 and ψn (θx ) = θnx . Let (V, δ) be an irreducible dis-
crete series representation of HLrL and let t = rL tL be an RL -generic
point of rL T L . Let s = n(t) = rM′
                                     sM , and let (V ′ , δ ′ ) be a realization
of the discrete series representation δ ′ = Ψn (δ).
   Choose a unitary isomorphism δ̃ : V → V ′ such that
(4.69)                  δ̃(δt (h)v) = δs′ (ψn (h))(δ̃(v)).
Recall that Vπ with π = π(RL , WL rL , δ, tL ) is isomorphic to
(4.70)                  Vπ ≃ Han (U) ⊗HL,an (U̟ ) VtL
(see Subsection 4.1), where VtL denotes the representation space V with
HL action defined by h → δ(φtL (h)). Put π ′ = π(RM , WM rM  ′
                                                               , δ ′ , sM ).
Definition 4.32. For tL ∈ T L such that rL tL is RL -generic, we define
an intertwining isomorphism A(n, RL , WL rL , δ, tL ) : Vπ → Vπ′ by
(4.71)         A(n, RL , WL rL , δ, tL ) : H ⊗HL VtL → H ⊗HM Vs′M
                                                h ⊗ v → hι0n−1 ⊗ δ̃(v)


  It is easy to check that this is well defined and that this map inter-
twines the H actions.
Theorem 4.33. Recall the compact realization Vπ = H(W L) ⊗ V , with
its inner product h·, ·iπ (see Proposition 4.19).
      (i) In the “compact realization”, the intertwining map
(4.72)       A(n, RL , WL rL , δ, tL ) : H(W L ) ⊗ V → H(W M ) ⊗ V ′
           is rational as a function of induction parameter tL , and regular
           outside the set of zeroes of the functions tL → ∆α cα (u(rL)tL ),
           where α runs over the set of positive roots in R1 such that
           n(α) < 0, and u(rL ) (with u ∈ WL ) runs over the set of XL -
           weights in V .
      (ii) When tL ∈ TuL and A(n, RL , WL rL , δ, tL ) is regular at tL , then
           in fact A(n, RL , WL rL , δ, tL ) is unitary with respect to the in-
           ner products h·, ·iπ and h·, ·iπ′ .
     (iii) With respect to these inner products we have
(4.73)    A∗ (n, RL , WL rL , δ, tL ) = A(n−1 , RM , WM rM
                                                         ′
                                                           , Ψn (δ), n(tL )).
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 81

Proof. (i) The representation π is cyclic and generated by 1 ⊗ v, with
v 6= 0 an arbitrary vector in V . By the intertwining property it is
therefore enough to show that A(n, RL , WL rL , δ, tL )(1 ⊗ v) ∈ H(W L ) ⊗
V is meromorphic in tL , and regular outside the indicated set. Using
equation (4.6), we have
(4.74)                                         Y
 A(n, RL , WL rL , δ, tL )(1 ⊗ v) = π(ιn−1 )π(        ∆α cα )−1 (1 ⊗ δ̃(v)).
                                                α>0,n(α)<0

Since π(h) is a regular function on T L for all h ∈ H, this is a ratio-
nal expression. The generalized
        L
                                   Q X-weights in 1 ⊗ VtL are of the form
u(rL)t . So the inverse of π( α>0,n(α)<0 ∆α cα ) can have poles only at
the indicated set.
   (ii) In order to see the unitarity, we first note that by Corollary
4.29(ii) and Theorem 4.30, the statement is equivalent to the unitarity
with respect to the inner products on Vπ and Vπ′ defined by the embed-
ding of these spaces in Ht as in Corollary 4.29. Choose an embedding
i : V → HLrL as in Corollary 4.29. By Theorem 4.30 and Corollary
4.26, the map ∆n̟,n̟ |j(Vπ,̟ ) is an isometry. By equation (4.48) we see
that this isometry satisfies, for h ∈ H L, ψn (h) · ∆n̟,n̟ (j(1 ⊗ v)) =
∆n̟,n̟ (j(1 ⊗ δtL (h)(v))). Hence if we identify VtL with j(Vπ,̟ ), we
               ′
can define Vn(t  L ) = ∆n̟,n̟ (VtL ). Then the map δ̃ = ∆n̟,n̟ defines a

unitary map satisfying (4.69).
   Now it is clear, in the notation of Corollary 4.29, that we can identify
the space j ′ (Vπ′ ,̟′ ) with j(Vπ,̟ )ι0n−1 , and the map A(n, RL , WL rL , δ, tL )
is then identified with the right multiplication with ι0n−1 , thus with
∆̟,n̟ . This is unitary on j(Vπ,̟ ), by Corollary 4.31. By the irre-
ducibility of Vπ and Vπ′ this concludes the proof of (ii).
   (iii) This last assertion of the Theorem is now obvious, since these
maps are clearly inverse to each other.                                         

  The next Corollary is an important classical application of the uni-
tarity of the intertwiners, see [4], Théorème 2.
Corollary 4.34. The intertwining map tL → A(n, RL , WL rL , δ, tL )
extends holomorphically to an open neighborhood of TuL in T L.
Proof. By the unitarity on TuL , the meromorphic matrix entries of
A(n, RL , WL rL , δ, tL ) are uniformly bounded for tL ∈ TuL in the open
set of TuL where A(n, RL , WL rL , δ, tL ) is well defined and regular. This
is the complement of the collection of real codimension 1 cosets in TuL
as described in Theorem 4.33. This implies that the singularities of the
matrix entries which meet TuL are actually removable.                     
82                          ERIC M. OPDAM

4.5. The Plancherel decomposition of the trace τ
   In this section we rewrite the decomposition Theorem 4.25 as a de-
composition of τ in terms of characters of irreducible tempered rep-
resentations induced from cuspidal representations of the subalgebras
HP .
   Using the results of the previous section, we show that the cor-
responding Fourier homomorphism maps H into a certain space of
smooth sections defined over orbits of irreducible cuspidal represen-
tations of the subalgebras HP , equivariant with respect to the natural
actions of intertwining operators.
   This final formulation of the results (Theorem 4.43) is inspired by
and parallel to the notations used in the theory of the Harish-Chandra
Plancherel formula for p-adic groups, as treated in [49] and [12].
   We need to develop some notations. Let P ⊂ F0 denote the power
set of F0 , and let Γ denote the set of all pairs γ = (RP , WP r) with
P ∈ P, RP the associated parabolic root datum, and WP r an orbit of
residual points in TP . We consider the disjoint union of the set of all
triples Λ = {(RP , WP r, t)} , where (RP , WP r) ∈ Γ and t ∈ TuP . Let
ΛRP ,WP r = Λγ be the subspace of such triples with γ = (RP , WP r) ∈ Γ
fixed. Hence for all γ ∈ Γ, Λγ is a copy of TuP and Λ = ∪Λγ (disjoint
union). Therefore Λ is a disjoint union of finitely many compact tori,
which gives Λ the structure of a compact Hausdorff space. In addition,
each Λγ comes with its (normalized) Haar measure, thus defining a
measure on Λ. We denote by Λgen     γ  the open, dense subset of triples
(RP , WP r, t) such that (RP , WP r) = γ and rt is RP -generic. We put
Λgen = ∪Λgenγ   (disjoint union over γ ∈ Γ).
   Define a map m : Λ → S ⊂ W0 \T by

(4.75)                 m(RP , WP r, t) = W0 (rt)

 By Theorem 3.29, m is surjective, and obviously m is continuous and
finite.
   Let P, Q ∈ P. Recall the set W (P, Q) ⊂ W0 defined by W (P, Q) :=
{n ∈ W0 | n(P ) = Q}. We put W (P ) = W (P, P ), which is a subgroup
of W0 and acts on RP through diagram automorphisms. Observe that
W (P ) ⊂ NW0 (WP ) is a subgroup which is complementary to the normal
subgroup WP ⊂ NW0 (WP ). Moreover, W (P, Q) is a left W (P ) coset
and a right W (Q) coset.
   The action of n ∈ W (P, Q) on T restricts to isomorphisms TP → TQ
and T P → T Q . Recall that KP = TP ∩ T P , so that n ∈ W (P, Q) gives
rise to an isomorphism n : KP → KQ .
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 83

  Consider the groupoid W whose set of objects is P, with morphisms
HomW (P, Q) = W(P, Q) := KQ ×W (P, Q) and the composition defined
by (k1 × n1 ) ◦ (k2 × n2 ) = k1 n1 (k2 ) × (n1 ◦ n2 ). We denote by W(P )
the group W(P ) = W(P, P ).
  If k × n ∈ W(P, Q) we define for γ = (RP , WP r) ∈ ΓP :
(4.76)     (k × n)(γ) = (k × n)(RP , WP r) := (RQ , WQ (k −1 n(r))).
This defines a left action of W on Γ. If t ∈ TuP then (γ, t) ∈ Λγ , and
we define
(4.77)             (k × n)(γ, t) := ((k × n)(γ), kn(t)).
This defines a left action of W on Λ. With these definitions we obvi-
ously have
(4.78)                       m(g(λ)) = m(λ)
for all g ∈ Hom(W) and λ ∈ Λ such that g(λ) is defined. In other
words, m is W-invariant.
Lemma 4.35. The action of W on Λgen is free.
Proof. Let λ = (RP , WP r, t) ∈ Λgen
                                  RP ,WP r and let g = k × n ∈ W(P, Q)
be such that g(λ) = λ. Then Q = P , g fixes WP r, and kn(t) = t. We
have g(WP r) := WP (k −1 n(r)), thus n(r) = kw(r) for some w ∈ WP .
Hence n(rt) = n(r)n(t) = w(r)(kn(t)) = w(rt). Since rt is RP -generic
this implies that w −1 n ∈ WP . Hence n = e, and thus also k = e.   

Lemma 4.36. Let L be a residual subspace, and let t = rL tL ∈ Ltemp
be RL generic. Then m−1 (W0 t) is a W-orbit in Λ.
Proof. By making a suitable choice of t in the orbit W0 t we may assume
that RL = RP for some P ∈ P. We write rP instead of rL and tP
instead of tL . Thus it is assumed that t = rP tP ∈ Ltemp = rP TuP is
RP -generic. Define λ := (RP , WP rP , tP ) ∈ Λgen
                                                RP ,WP rP . Clearly, W · λ ⊂
  −1
m (W0 t) by the W-invariance of m.
   Conversely, suppose that µ = (RQ , WQ rQ , tQ ) ∈ m−1 (W0 t). Hence
there exists a w ∈ W0 such that rQ tQ = wt = w(rP )w(tP ). This
is an element of the tempered residual subspace Ltemp     Q    := rQ TuQ , so
                                  temp
that RQ ⊂ RP (wt) . Since t ∈ L         is RP generic, we have RP (t) =
RP by Corollary 4.13. Because RP (wt) = w(RP (t) ), we obtain RQ ⊂
w(RP ). This implies that w(Ltemp ) = w(t)w(TuP ) ⊃ rQ TuQ = Ltemp  Q   . By
                               temp        temp
Theorem 7.17 we see that w(L        ) = LQ . Hence we have w(RP ) =
                           P      Q                          −1
RQ , w(TP ) = TQ and w(T ) = T . We conclude that rQ            w(rP ) = k ∈
KQ . There exists a unique u ∈ WQ such that uw ∈ W (P, Q). One
easily checks that µ = (k × uw)(λ).
84                           ERIC M. OPDAM

  Note that it follows that the intersection m−1 (W0 t) ∩ ΛRP ,WP rP is
contained in Λgen
              RP ,WP rP (for any choice of P ∈ P and WP rP ).        

Corollary 4.37. We form the quotients Σ = W\Λ and Σgen = W\Λgen .
The map m factors through Σ, and defines a homeomorphism (also de-
noted by m) from Σgen onto the open dense set S gen := m(Λgen ) ⊂ S.

Proof. By equation (4.78), m is well defined on Σ, and thus m(Σ) =
m(Λ) = S. By the previous lemma, the set Λgen is m-saturated. Since
m is closed, this implies that S gen = m(Λgen ) ⊂ S is open (and obvi-
ously dense) in S = m(Σ). Finally, again by the previous lemma, m is
injective on Σgen . Thus, being a closed map, m is homeomorphic onto
its image.                                                          

   Σ can be realized as a disjoint union of orbifolds as follows. Choose a
complete set Γa of representatives for the association classes (the orbits
of W) of elements in Γ. Put
(4.79)                      Σγ := W(γ)\Λγ ,
where W(γ) denotes the isotropy group of γ ∈ Γ in W. Then
(4.80)                          Σ ≃ ∪Σγ ,
where the (disjoint) union is taken over the set of γ ∈ Γa .
4.5.1. Groupoid WΞ of standard induction data. Recall the complete
set of representatives ∆γ (γ = (RP , WP rP ) ∈ Γ) of the irreducible
discrete series representations with central character WP rP of HP . We
denote by ∆ = ∪∆γ the disjoint union of these sets over all γ ∈ Γ. The
composition ∆ → Γ → P gives a surjection of ∆ → P, whose fibers
are denoted by ∆P .
  There is a natural left action Ψ of W on ∆ as follows: When k ∈
KP = T P ∩ TP , we have an automorphism ψk : HP → HP defined
by ψk (θx Tw ) = k(x)θx Tw . This induces an isomorphism ψk : HPrP →
     −1
HPk rP . We define a bijection Ψk from ∆RP ,WP rP to ∆RP ,k−1 WP rP by
Ψk (δ) ≃ δ ◦ ψk−1 .
  Let Q ∈ F0 be associate to P , and n ∈ W (P, Q). Then n induces
an isomorphism of root data and labels (RP , q) → (RQ , q), thus in-
ducing an isomorphism ψn on HP → HQ . Recall that ψn induces an
                             n(r )
isomorphism ψn : HPrP → HQ P (Corollary 4.26), and thus a bijection
Ψn : ∆RP ,WP rP → ∆RQ ,WQ n(rP ) by Ψn (δ) ≃ δ ◦ ψn−1 . One easily checks
that these definitions combine to define a left action Ψ of W on ∆ ,
compatible with the surjection ∆ → P mentioned above.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 85

   Consider the product Ξ := Λ ×Γ ∆ . This set comes equipped with a
natural surjection Ξ → P and compatible left action of W (the diagonal
action). We form the cross product WΞ := W ×P Ξ , which has itself a
natural groupoid structure with Obj(WΞ ) := Ξ, and HomWΞ (ξ1 , ξ2 ) :=
{w ∈ W | w(ξ1 ) = ξ2 }. The composition maps are defined by the
composition in W. We will refer to this structure as the groupoid of
standard induction data of H. Its set of objects Ξ has the structure of a
disjoint union of compact tori, and with this structure WΞ is obviously
a smooth compact groupoid.
   Recall that we associated to each ξ = λ × δ = (RP , WP rP , t) ×
(RP , δ) ∈ Ξ (i.e. δ is an irreducible discrete series representation of
H(RP , q) with central character equal to WP rP ) a tempered, unitary
representation π(ξ) = π(RP , WP rP , δ, t) of H with central character
m(λ) = W0 (rP t) and representation space Vπ(ξ) = H(W P ) ⊗ Vδ (the
compact realization) (cf. Definition 4.17, Proposition 4.19 and Propo-
sition 4.20).
   For every (g, ξ) ∈ WΞ with source ξ = λ × δ, we choose a unitary
isomorphism δ̃g : Vδ → VΨg (δ) so that we have
(4.81)                 Ψg (δ)(h) ◦ δ̃g = δ̃g ◦ δ(ψg−1 h)
for h ∈ HP (where P = P (δ)).
   This enables us to define intertwining operators (depending on the
choices of the isomorphisms δ̃g )
(4.82)                A(g, ξ) ∈ HomH (Vπ(ξ) , Vπ(g(ξ)) )
as follows:
  For k ∈ KP and h ∈ HP we have φkt (h) = ψk (φt (h)), so that if
h ∈ HP we have that δ̃k ◦ δ(φt (h)) = Ψk (δ)(φkt (h)) ◦ δ̃k . With this
notation we have for each δ ∈ ∆RP ,WP rP , in view of Proposition 4.19,
a unitary intertwining isomorphism
(4.83)                   Id ⊗δ̃k : π(ξ) → π(k(ξ)).
We denote this unitary intertwining operator by A(k, RP , WP r, δ, t) or
more simply A(k, ξ). Notice that it is constant, i.e. independent of t.
   For n ∈ W (P, Q) (with P, Q ∈ P associate subsets) we defined
(cf. Theorem 4.33 and Corollary 4.34) an intertwining isomorphism
(depending on the choice of δ̃n )
(4.84)
A(n, RP , WP rP , δ, t) : π(RP , WP rP , δ, t) → π(RQ , WQ n(rP ), Ψn (δ), n(t)),
which is rational in t, well defined and regular in a neighborhood of TuP ,
and unitary for t ∈ TuP . We now denote this isomorphism by A(n, ξ).
86                           ERIC M. OPDAM

  The above intertwining isomorphisms combine (as one easily checks
directly from the definitions) to a functor
(4.85)                  WΞ → P Repunit,temp (H)
where P Repunit,temp (H) denotes the category of finite dimensional, tem-
pered, unitary modules over H, with morphisms HomP Rep (π1 , π2 ) =
P UH (Vπ1 , Vπ2 ) (the space of unitary intertwiners modulo the action of
scalars).
  Summarizing the above we have:
Theorem 4.38. There exists an induction functor
(4.86)                 π : WΞ → P Repunit,temp (H)
 such that for ξ = (RP , WP rP , t) × (RP , δ) ∈ Ξ and (g, ξ) ∈ WΞ
(thus g ∈ W with source P (ξ) = P ), π(ξ) := π(RP , WP rP , δ, t) and
π(g, ξ) := A(g, ξ) = A(n, RP , WP rP , δ, t).
4.5.2. Generic spectrum. Consider the natural projection
(4.87)         pΣ : WΞ \Ξ = W\(Λ ×Γ ∆) → Σ = W\Λ.
  Since the action of W is free on the set of generic points Λgen , we
obtain a finite covering
(4.88)                    pΣ : WΞ \Ξgen → Σgen ,
where Ξgen := Λgen ×Γ ∆ .
   By what was said in the previous subsection and Corollary 4.18, it
is clear that the map (see Proposition 2.13 for the definition of pz ):
                          [π] : Ξgen → p−1
                                        z (S
                                             gen
                                                 )
(4.89)
                                  ξ → [π(ξ)]
factors through the quotient WΞ \Ξgen . We thus have the following
commutative diagram:
                                    [π]
                       WΞ \Ξgen −−−→ p−1
                                      z (S
                                           gen
                                               )
                                        
                                        pz
(4.90)                  pΣ y             y
                          Σgen    −−−→       S gen
                                    m

Theorem 4.39. The map [π] in the diagram 4.90 is a homeomorphism.
Proof. The topology on Ĉ is second countable since C is separable.
Thus, in order to check the continuity of [π], it suffices to check that [π]
maps a converging sequence λi × δ → λ × δ ∈ ΛRP ,WP r to a converging
sequence in Ĉ. We check this using the Fell-topology description of
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 87

the topology of Ĉ (see [16]). By [16], Proposition 1.17, restriction to
the dense subalgebra H ⊂ C is a homeomorphism with respect to the
Fell topologies. Let Vλ×δ = H(W P ) ⊗ V be the representation space of
π(λ × δ) (with λ ∈ ΛRP ,WP r ). We equip Vλ×δ with the inner product
h·, ·i of Proposition 4.19 (which is independent of λ ∈ ΛRP ,WP r ), and
we choose an orthonormal basis (ei ) of Vλ×δ . In order to check that
π(λi × δ) → π(λ × δ) in the Fell topology with respect to H, we need
to check that for all h ∈ H, π(λi × δ)(h)k,l → π(λ × δ)(h)k,l for all
matrix coefficients. This is clear since the matrix coefficients are regular
functions of the induction parameter.
   To see that the map [π] is closed, assume that we have a sequence
ρi = [π](λi × δi ) converging to ρ ∈ p−1  z (S
                                               gen
                                                   ). Since m is a homeo-
                   gen
morphism and Σ         is a finite quotient of Λgen , we may assume that
λi converges, to λ0 ∈ Λgen say, by possibly replacing the sequence by a
subsequence. Since ∆RP ,WP r is finite for each RP and WP r, we may as-
sume that ∀i : δi = δ, again by taking a subsequence. Then d = dim(ρi )
is independent of i, and lower semi-continuity of dim on Ĉ implies that
dim(ρ) ≤ d. Choose an orthonormal basis B for ρ. Convergence in the
Fell-topology means that there exists for all i an orthonormal subset
Bi of size dim(ρ) in the representation space Vρi = H(W P ) ⊗ V of ρi ,
such that the matrix coefficients of ρi with respect to Bi converge to
the matrix coefficients of ρ with respect to B. By the independence of
the inner product h·, ·i of the induction parameter (Proposition 4.19)
we may assume, by further restricting to a subsequence, that the sets
Bi converge in H(W P ) ⊗ V to an orthonormal set B0 . It follows that
the matrix of ρ(x) with respect to B equals a principal block of the
matrix of π(λ0 × δ)(x) with respect to a suitable orthonormal basis B̃
of H(W P ) ⊗ V for π(λ0 × δ). Since π(λ0 × δ) is irreducible it is easy
to see that this is impossible unless ρ ≃ π(λ0 × δ).
   The map [π] is injective by Corollary 4.18 and Lemma 4.36.
   Finally, by Theorem 3.25, Theorem 3.29, Theorem 4.23 and Theorem
4.25 we see that the complement of [π](WΞ \Ξreg ) has measure 0 in Ĉ
with respect to the Plancherel measure of the representation H of C.
The support of the Plancherel measure is equal to Ĉ, since H is a
faithful representation of C (by definition of C). Thus the closure of
[π](WΞ \Ξreg ) is Ĉ. But [π](WΞ \Ξreg ) ⊂ p−1
                                             z (S
                                                   reg
                                                       ) is closed as we have
seen above, implying that [π] is surjective.                               


Corollary 4.40. The restriction of the map pz of Corollary 2.13 to
p−1
 z (S
      reg
          ) is a covering map.
88                            ERIC M. OPDAM

4.5.3. Fourier transform. Let Õ ⊂ Ξ be a connected component of Ξ.
Thus there exists a δ ∈ ∆ such that Õ = Λγ × {δ} := Õδ , where
γ = γ(δ) ∈ Γ. Explicitly, if γ(δ) = (RP , WP rP ) then Õδ is a copy of
the subtorus TuP ⊂ Tu .
   The representation space Vπ(ξ) of π(ξ) is equal to Vπ(ξ) = H(W P )⊗Vδ
for ξ ∈ Õδ with δ ∈ ∆P . In particular, Vπ(ξ) depends only on the
connected component Õδ of Ξ containing ξ, and not on the choice of
ξ ∈ Õδ . We will use the notation i(Vδ ) := H(W P ) ⊗ Vδ = Vπ(ξ) for any
choice of ξ ∈ Õδ (where P = P (δ) ∈ P).
   We form the trivial fiber bundle VÕ = Õδ × i(Vδ ) over Õ = Õδ , and
put
(4.91)                       VΞ := ∪δ∈∆ VÕδ .
 We identify the connected component Õδ of Ξ with the compact torus
TuP (P = P (δ)). This allows us to define the function spaces Pol(Ξ)
(Laurent polynomials on Ξ) and C ∞ (Ξ) . We also introduce the space
Ratreg (Ξ) = ⊕δ∈∆ Ratreg (Õd ), where Ratreg (Õd ) denotes the space of
restrictions to TuP (which we identify with Õd ) of rational functions on
T P which are regular in a open neighborhood of TuP . The corresponding
spaces of (global) sections are denoted by Pol(VΞ ) = Pol(Ξ) ⊗ VΞ ,
C ∞ (VΞ ) = C ∞ (Ξ) ⊗ VΞ , and Ratreg (VΞ ) = Ratreg (Ξ) ⊗ VΞ respectively.
   Recall that π(g, ξ) ∈ P UH (i(Vδ ), i(Vgd )) (with ξ = λ×δ = (RP , WP r, t)
× δ) is rational and regular for t ∈ T P in a neighborhood of TuP (Corol-
lary 4.34). We define
 Pol( End(VΞ ))W
     ={f ∈ Pol(End(VΞ )) | ∀(g, ξ) ∈ WΞ : π(g, ξ)f (ξ) = f (gξ)π(g, ξ)}
       M
     ≃    Pol(VÕ )W(Õ,Õ)
         Õ
 where the direct sum runs over a complete set of representatives of
connected components Õ for the action of W, and W(Õ1 , Õ2 ) denotes
the set of w ∈ W such that w(Õ1 ) = Õ2 . We define the space of WΞ -
equivariant sections in other spaces of sections of End(VΞ ) similarly.
Definition 4.41. The Fourier transform is the algebra homomorphism
                       FH : H → Pol(End(VΞ ))W
                              h → {ξ → π(ξ)(h)}
  We would like to replace Ξ by the set of equivalence classes of cuspidal
representations of the standard parabolic subalgebras HP . This can be
done as follows. Consider the subgroupoid K ⊂ W of W, with set of
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 89

objects P, and K(P1 , P2 ) = ∅ if P1 6= P2 , and K(P, P ) = KP . This
subgroupoid is normal in the sense that gKP g −1 = KQ if g ∈ W(P, Q).
The quotient groupoid W/K = W/K has P as set of objects, and
W/K(P, Q) = W (P, Q).
   Suppose that δt ≃ δs′ with δ, δ ′ ∈ ∆RP and s, t ∈ TuP . Then WP rt =
WP r ′ s, and thus s = kt for some k ∈ KP , and δs′ = Ψk (δ)kt . Conversely,
in view of the text above (4.83), ξ ≃ k(ξ) for every k ∈ KP and ξ ∈ ΞP ,
viewed as representation of HP .
   The connected components O of the quotient K\Ξ are called “orbits
of twists of cuspidal representations” of the parabolic subalgebras HP .
Such a component can be viewed as the collection of mutually inequiv-
alent representations of HP of the form δt . It is isomorphic to a smooth
quotient O ≃ K(Õ, Õ)\Õ, a finite quotient of the subtorus TuP ⊂ Tu .
   We have W\Ξ = (K\W)\(K\Ξ). For O a connected component
of K\Ξ, we choose a connected component Ξ ⊃ Õ → O covering O.
Let Õ = Λγ × δ and write P (γ) = P . The isotropy group {k ∈
KP | k(Õ) = Õ} equals the isotropy group Kδ . Notice that Kδ is
independent of the choice of Õ → O. We define the principal fiber
bundle VO := Õ ×Kδ i(Vδ ) over O. This fiber bundle is not necessarily
trivial. We put
                                                       KP
                                     M
(4.92)         Pol(End(VO )) =          Pol(End(VÕ ))
                                  Õ:Õ→O

                             ≃ Pol(End(VÕ ))Kδ
and
                                        M
(4.93)          Pol(End(V(K\Ξ) )) =             Pol(End(VO ))
                                      O orbit

  The quotient W/K acts on K\Ξ and thus also on the set of or-
bits. Given orbits O1 , O2 with P (Oi ) := Pi and Oi = Λγi × δi , we
have W/K(O1 , O2 ) = {n ∈ W/K(P1 , P2 ) | n(O1 ) = O2 } = {n ∈
W (P1, P2 ) | ∃k ∈ KP2 : k × n ∈ W(δ1 , δ2 )}. We denote this set by
W (O1 , O2 ) . We also put W (O) := W (O, O) .
  In this way we get
(4.94)         Pol(End(VΞ ))W = Pol(End(V(K\Ξ) ))K\W
                                M
                              ≃     Pol(End(VO ))W (O) ,
                                    O

where the direct sum runs over a complete set of representatives of
orbits O modulo the action of W/K (association classes of orbits).
90                             ERIC M. OPDAM

  We use similar notations for spaces of sections with coefficients in
other types of functions spaces (e.g. continuous, C ∞ , etc.) in End(VΞ )
and End(V(K\Ξ) ).

4.5.4. Averaging projections. Consider a function space F on Ξ which
is a module over Ratreg (Ξ). Due to the regularity of the intertwining op-
erators (cf. Corollary 4.34), there exists a natural averaging projection
f → f from F (End(VΞ )) (sections of End(VΞ ) with coefficients in F ) to
F (End(VΞ ))W . It is defined by (where Wξ = {g ∈ W | (g, ξ) ∈ WΞ })
                               X
(4.95)        f (ξ) = |Wξ |−1      π(g, ξ)−1f (g(ξ))π(g, ξ).
                               g∈Wξ

Notice that the function space F = Pol(Ξ) is too small; in general the
average of f ∈ Pol(End(VΞ )) will be in Ratreg (End(VΞ ))W .
   There is a similar averaging procedure f → f K which sends the space
of sections F (End(VΞ )) to F (End(V(K\Ξ) )) (in this case F should be a
module over C).

4.5.5. Plancherel formula. We now define the Plancherel measure on
W\Ξ. The following proposition says that the natural action of WΞ
(via ψ) on the residual algebras is through isomorphisms of Hilbert
algebras.
Proposition 4.42. Let δ ∈ ∆RP ,WP r and let g = (k × n) ∈ WRP ,WP r .
We have (in the notation of Theorem 4.23) dRP ,Ψg (δ) = dRP ,δ .
Proof. This is a simple extension of Corollary 4.26, with a similar proof.


  Let Õ = Λγ × δ and let O = Kδ \Õ. If P = P (γ) then O is a
copy of the subquotient torus Kδ \TuP . For ω ∈ O we put dO ω for
the normalized Haar measure on O. Let γ = (RP , WP r) and let ω =
(RP , WP r, δ, Kδ tP ) be RP -generic. Let Ltemp = rTuP denote a residual
subspace underlying Õ. We define
          dµP l (π(ω)) = |W0 (rtP )||W P |−1 dRP ,δ dνL (rtP )
                           |WP |
(4.96)                 =              νR ({r})dRP ,δ kP mP (rtP )dP (tP )
                         |WP ∩ Wr | P
                       = µRP ,P l ({δ})|KP δ|mP (ω)dO ω,
 where dRP ,δ > 0 is the residual degree of δ in the residual algebra
HLr , µRP ,P l is given in Corollary 3.32, mP (ω) = mL (ω) is the common
value of mL (as defined in Proposition 3.27) on the Kδ orbit ω, and
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 91

kP := |KP |. We have used that the isotropy subgroup WrtP equals
WP ∩ Wr if rtP is RP -generic.
  Recall that by definition we have
                          X
(4.97)                          dim(δ)dRP ,δ = 1
                      δ∈∆RP ,WP r

Recall Conjecture 2.27 stating that dRP ,δ ∈ Q+ .
  We define an Hermitian inner product on Pol(End(V(K\Ξ) )) as fol-
lows:
                       X            Z
                                 −1
(4.98)    (f1 , f2 ) =   |W (O)|      tr(f1 (ω)∗f2 (ω))dµP l(π(ω)),
                       O                O

 where the sum runs over a complete set of representatives for the asso-
ciation classes of orbits O (an association classes is an orbit under the
action of W/K). Note that f1 , f2 are in fact Kδ -equivariant sections
over the covering Õ → O. The expression tr(f1 (ξ)∗ f2 (ξ)) is indepen-
dent of a choice of ξ ∈ Õ such that Kδ ξ = ω. The common value is
denoted by tr(f1 (ω)∗ f2 (ω)).
Theorem 4.43. (Main Theorem)
     (i) Let O be an orbit (a connected component of K\Ξ). We put
         Ĉgen
           O   = [π](W (O)\Ogen ) ⊂ Ĉ, and we denote its closure by
         CO ⊂ Ĉ . Then Cgen     gen
                          O1 ∩ CO2 = ∅ unless O1 and O2 are in the
         same W/K-orbit, and

(4.99)                       Ĉgen := ∪Ĉgen
                                         O

          (union over a complete set of representatives for the associa-
          tion classes of orbits) is a dense set in C, whose complement
          has measure zero.
     (ii) The Plancherel measure of C (i.e. the measure on Ĉ deter-
          mined by the tracial state τ of C) is given on ĈO by equation
          (4.96). The decomposition of τ in irreducible, mutually dis-
          tinct characters of C is given by
                        XZ
(4.100)            τ=                   χπ(ω) dµP l (π(ω))
                        O   ω∈W (O)\O

          (sum over a complete set of representatives for the association
          classes of orbits).
    (iii) Equivalently, the algebra homomorphism FH (see (4.92) and
          (4.94)) is an isometry with respect to the inner product (4.98),
92                             ERIC M. OPDAM

        and extends uniquely to an isomorphism of C × C modules
                   ∼
                                       M
(4.101)      F : H → L2 (End(VΞ ))W ≃     L2 (End(VO ))W (O)
                                                   O

         (sum over a complete set of representatives for the association
         classes of orbits).
Proof. (i) See Theorem 4.39. The complement of Ĉgen has measure
zero by the argument in the last part of the proof of that theorem.
The density follows since Ĉ is the support of the Plancherel measure
(cf. Theorem 2.25).
   (ii) By formula of Proposition 3.15(v) and Corollary 4.37 we have
                          Z
(4.102)                τ=          χm(λ) dν(m(λ))
                               W\Λreg

We decompose χm(λ) according to Theorem 4.23(ii) to obtain
              Z                     X
(4.103)  τ=            |W P (λ) |−1    dR(λ),δ χπ(λ×δ) dν(m(λ))
                   λ∈W\Λreg              δ∈∆γ(λ)

By Corollary 4.18 and Theorem 4.39 we have {[π](λ × δ)}δ∈∆γ =
[π](p−1
     Σ (Wλ)). Thus (by Theorem 4.39) we can rewrite the integral
as integral over W\Ξreg . When we use parameters and notations as
explained in equation (4.96), and we express dν according to Proposi-
tion 3.27, we obtain
                Z
(4.104)     τ=           |W P (λ) |−1 |W0 (rtP )|dR(ξ),δ(ξ) χπ(ξ) dνL (rtP )
                  ξ∈W\Ξreg

According to our definition of µP l this is equal to
                     XZ
(4.105)         τ=                     χπ(ω) dµP l (π(ω))
                       O      ω∈W (O)\O reg

This is a decomposition of τ in characters of inequivalent irreducible
representations of C (see Theorem 4.23(iii)). Hence this uniquely de-
termines the Plancherel measure (by [15], Théorème 8.8.6) on Ĉ. We
conclude that µP l is equal to the Plancherel measure of C.
  (iii) The equivalence of (ii) and (iii) is well known, see the proof
of Theorem 4.25. It is allowed to use the formulation with W (O)-
equivariant sections because of the unitarity and the regularity of in-
tertwining operators (Theorem 4.33) and by Proposition 4.42.         

Remark 4.44. In [13] it is shown that the ĈO are the components of
Ĉ. Moreover, F (S) (see 6.2.2 for the definition of S) and F (C) are
determined in [13].
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 93

Corollary 4.45. Let J : L2 (End(V(K\Ξ) )) → H denote the adjoint of
F . Then J F = Id and F J (f ) = f (see subsection 4.5.4).

Proof. By the isometry property of F , (J F (x), y) = (x, y) for all x, y ∈
H. Whence the first assertion. It is clear that J (f ) = J (f ). If
g ∈ L2 (End(VΞ ))W then g = F (x) for some x ∈ H. Thus F J (g) =
F J F (x) = F (x) = g for W-equivariant g. Hence F J (f ) = F J (f) =
f.                                                                        



5. Base change invariance of the residual algebra
  Thus far we have found the spectral decomposition for H in terms of
the “residual degrees” dRL ,δ of the residual algebras HLr . We prove in
this section that the residual algebras are independent of q (using the
Convention 2.1), up to isomorphism of Hilbert algebras.


5.1. Scaling of the root labels
  Let r = sc ∈ T be fixed, with s ∈ Tu and c = exp(γ) with γ ∈ t.
Assume that B ⊂ tC is an open ball centered around the origin such
that the conditions 4.9 (with respect to r ∈ T ) are satisfied.
  The second condition implies that each connected component of the
union U := W0 (r exp(B)) contains a unique element of the orbit W0 r.
Given u ∈ U there is a unique r ′ = s′ c′ ∈ W0 r such that u ∈ r ′ exp(B).
By (i) there is a unique b ∈ B such that u = s′ c′ exp(b) = s′ exp(b + γ ′ ).
Now let ǫ ∈ (0, 1] be given. We define an analytic map σǫ on U by

(5.1)      σǫ (u) := s′ exp(ǫ log((s′ )−1 u)) = s′ exp(ǫ(b + γ ′ )).

Lemma 5.1. The map σǫ is an analytic, W0 -equivariant diffeomor-
phism from U onto Uǫ := W0 (scǫ exp(ǫB)). The inverse of σǫ will be
denoted by σ1/ǫ .

Proof. On the connected component r ′ exp(B) the map σǫ is equal to
σǫ = µs′ ◦ exp ◦Mǫ ◦ log ◦µ(s′ )−1 where µs′ is the multiplication in T
by s′ , and Mǫ is the multiplication in tC by ǫ. These are all analytic
diffeomorphisms, because of condition (i). The W0 equivariance follows
from the fact that log is well defined (and thus equivariant, since exp
is equivariant) from W0 exp(B + γ) to W0 (B + γ), and that Mǫ is W0 -
equivariant. This implies that for w ∈ W0 , w exp(ǫ log((s′ )−1 u)) =
94                             ERIC M. OPDAM

exp(ǫ log((ws′)−1 wu)). It follows that
                   σǫ (wu) = ws′ exp(ǫ log((ws′ )−1 wu))
(5.2)                       = ws′ w exp(ǫ log((s′ )−1 u))
                            = w(σǫ (u)).
                                                                               

Lemma 5.2. Denote by q ǫ the label function q ǫ (s) = q(s)ǫ = qǫfs , and
denote by Hqǫ the affine Hecke algebra with root datum R (same as the
root datum of the affine Hecke algebra H = Hq ), but with the labels q
replaced by q ǫ . Let cα,ǫ ∈ F Aqǫ ⊂ F Hqǫ be the corresponding Macdonald
c-functions. For every root α ∈ R1 we have:
(5.3)          U ∋ u → (cα,ǫ (σǫ (u))cα (u)−1 )±1 ∈ Aan (U).
Proof. For u in the connected component r ′ exp(B) of U we write u =
s′ v with v ∈ c′ exp(B). We have
(5.4)
                                  −ǫ/2
                            (1 + qα∨ α(v)−ǫ/2α(s′ )−1/2 )
    cα,ǫ (σǫ (u))cα (u)−1 =       −1/2
                            (1 + qα∨ α(v)−1/2 α(s′ )−1/2 )
                        −ǫ/2−ǫ       −ǫ/2
                  (1 − qα∨ q2α∨ α(v)      α(s′ )−1/2 )(1 − α(v)−1 α(s′ )−1 )
              ×         −1/2  −1
                   (1 − qα∨ q2α        −1/2 α(s′ )−1/2 )(1 − α(v)−ǫ α(s′ )−1 )
                                ∨ α(v)

We remind the reader of the convention Remark 3.1; in particular,
the expression α(s′ )1/2 occurs only if α/2 ∈ R0 , in which case this
expression stands for (α/2)(s′ ). If α/2 6∈ R0 , we should reduce formula
(5.4) to
(5.5)
                      −1   (1 − qα−ǫ∨ α(v)−ǫα(s′ )−1 )(1 − α(v)−1 α(s′)−1 )
    cα,ǫ (σǫ (u))cα(u) =
                           (1 − qα−1∨ α(v)−1 α(s′)−1 )(1 − α(v)−ǫ α(s′ )−1 )
By conditions (i) and (iii) it is clear that poles and zeroes of these
functions will only meet U if α(s′ ) = 1 when α ∈ R0 ∩R1 or α(s′ ) = ±1
if α ∈ 2R0 . In these cases the statement we want to prove reduces to
the statement that the function
                                  1 − exp(−ǫx)
(5.6)                    f (x) :=
                                   1 − exp(−x)
is holomorphic and invertible on the domain x ∈ p + α(γ ′ + B), where
p is a real number and α ∈ R0 . By condition (i) both the denominator
and the numerator of f have a zero in this domain only at x = 0 (if
this belong to the domain), and this zero is of order 1 both for the
numerator and the denominator. The desired result follows.            
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 95

   Recall Theorem 4.6. This result tells us that the structure of the
algebra with coefficients in the locally defined meromorphic functions
on U is independent of the root labels. We will now show that the
subalgebra with analytic coefficients (defined locally on U) is invariant
for scaling transformations.
Theorem 5.3. The map
              jǫ : Hme (U) 7→ Hqme
                                 ǫ (Uǫ )
                 X            X
(5.7)                f ι0 7→       (f ◦ σ                       0
                               w w                  w     1/ǫ )ιw,ǫ
                       w∈W0              w∈W0

 defines an isomorphism of C-algebras, with the property that jǫ (F me (U))
= Fqmeǫ (Uǫ ) and jǫ (A
                        me
                           (U)) = Ame
                                   q ǫ (Uǫ ). Moreover (and most signifi-
cantly), jǫ (H (U)) = Hqanǫ (Uǫ ).
               an

Proof. The map jǫ as defined above is clearly a C-linear isomorphism
by Theorem 4.6. It is an algebra homomorphism because we have
              X        X                  X
         jǫ (   fu ι0u    gv ι0v ) = jǫ (   fu gvu ι0uv )
              u∈W0      v∈W0                  u,v∈W0
                                          X
                                     =            (fu ◦ σ1/ǫ )(gvu ◦ σ1/ǫ )ι0uv,ǫ
                                         u,v∈W0
                                          X
(5.8)                                =            (fu ◦ σ1/ǫ )(gv ◦ σ1/ǫ )u ι0uv,ǫ
                                         u,v∈W0
                                          X
                                     =            (fu ◦ σ1/ǫ )ι0u,ǫ (gv ◦ σ1/ǫ )ι0v,ǫ
                                         u,v∈W0
                                              X                     X
                                     = jǫ (          fu ι0u )jǫ (          gv ι0v )
                                              u∈W0                  v∈W0

What remains is the proof that jǫ (H (U)) = Hqanǫ (Uǫ ). Notice that
                                               an

Han (U) is the subalgebra generated by Aan (U) and the elements Ts
where s = sα with α ∈ R1 . The jǫ -image of Aan (U) equals Aan   q ǫ (Uǫ )
since σǫ is an analytic diffeomorphism. To determine the image of Ts we
use formula Lemma 2.27(2) of [37], applied to the situation W0 = {e, s}.
This tells us that
(5.9)                   (1 + Ts ) = qα∨ q2α∨ cα (1 + ι0s ).
Hence we see that
            jǫ (Ts ) = qα∨ q2α∨ (cα ◦ σ1/ǫ )(1 + ι0s,ǫ ) − 1
(5.10)
                     = qα1−ǫ 1−ǫ              −1
                          ∨ q2α∨ (cα ◦ σ1/ǫ )cα,ǫ (1 + Ts,ǫ ) − 1.


By Lemma 5.2 it is clear that this is indeed in Hqanǫ (Uǫ ), and that these
elements together with Aan                       an
                         q ǫ (mǫ (U)) generate Hq ǫ (Uǫ ).               
96                               ERIC M. OPDAM

5.2. Application to the residual algebras
   In order to prove that the residual algebras Ht are invariant for the
scaling transformation q → qǫ it suffices to consider the case Hr for a
residual point r ∈ T . This follows from Theorem 4.23, expressing χt
in terms of characters induced from discrete series characters of proper
parabolic subalgebras.
   When r = sc ∈ T is a residual point, the state χr has a natural exten-
sion to the localized algebras Han (U) where U = W0 r exp(B), with B
an open ball in tC satisfying the conditions 4.9 with respect to the point
r ∈ T . Because the radical Radan                                      ∗
                                  r (U) of the bitrace (x, y)r := χr (x y)
on Han (U) is contained in the maximal ideal Iran (U) of functions in the
center Z an (U) which vanish in the orbit W0 r, we clearly have
(5.11)                    Hr = Han (U)/ Radan
                                           r (U).

The structure of this algebra as a Hilbert algebra is given by the bitrace
defined by χr . Therefore, we need to prove independence of χr for the
scaling transformation. We start with a simple lemma:
Lemma 5.4. Let h ∈ Han (U) We have
                        Eqǫ ,σǫ (t) (jǫ (h))     Et (h)
(5.12)                   ǫ
                                             =
                        q (w0 )∆(σǫ (t))       q(w0 )∆(t)
Proof. For all x ∈ X we have
(5.13)        Eqǫ ,σǫ (t) (jǫ (θx h)) = Eqǫ ,σǫ (t) (jǫ (θx )jǫ (h))
                                     = (x ◦ σ1/ǫ )(σǫ (t))Eqǫ ,σǫ (t) (jǫ (h))
                                     = x(t)Eqǫ ,σǫ (t) (jǫ (h)),
showing that the left hand side has the correct eigenvalue for multipli-
cation of h by θx on the left. For the multiplication of h by θx on the
right a similar computation holds. This shows, in view of Lemma 4.21
and [37], Proposition 2.23(3) that, for regular t and outside the union
of all residual cosets, the left and the right hand side are equal up to
normalization. But both the left and the right hand side are equal to
1 if h = Te = 1. Hence generically in t, we have the desired equality.
Since both expressions are holomorphic in t, the result extends to all
t ∈ T.                                                                

Lemma 5.5. Let ǫ ∈ (0, 1] be given. We have, for all h ∈ Han (U),
(5.14)                     χqǫ ,σǫ (r) (jǫ (h)) = χr (h).
Proof. Take a neighborhood U = W0 r exp(B) with B satisfying con-
ditions 4.9 relative to r. Let ∪ξ ∈ Hn (U) denote the n-cycle defined
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 97

by ∪ξ = ∪r′ ∈W0 r ξr′ . In view of Proposition 3.7, Definition 3.16 and
Definition 3.22 we see that, for all h ∈ H,
                                Z              
                                        Et (h)          dt
(5.15)       ν({W0 r})χr (h) =
                                 ∪ξ   q(w0 )∆(t) q(w0 )c(t)c(t−1 )

Let r ′ ∈ W0 r. The scaling operation sends the root labels q to q ǫ , and
follows the corresponding path of ǫ → σǫ (r ′ ) of the residual point r ′ .
                                                                      ′
Obviously the position of t0 (in equation (3.1)) relative to L{σǫ (r )} is
independent of ǫ. And also, the position of e relative to the facets of
the dual configuration L{σǫ (r′ )} is independent of ǫ, since the effect of
the scaling operation on L{r′ } ⊂ Trs simply amounts to the application
of the map c → cǫ . In view of Proposition 3.10 and Proposition 3.13,
we can take the cycle σǫ (∪ξ) ∈ Hn (σǫ (U)) in order to define the state
χσǫ (r) of Hqanǫ (σǫ (U)). In other words, we have, for h ∈ Han (U),

(5.16)    νqǫ ({W0 σǫ (r)})χqǫ ,σǫ (r) (jǫ (h))
                   Z                         
                               Et (jǫ (h))                dt
                =
                    σǫ (∪ξ)   q (w0 )∆(t) q (w0 )cǫ (t)cǫ (t−1 )
                               ǫ                   ǫ
                   Z                          
                            Eσǫ (t) (jǫ (h))                 d(σǫ (t))
                =
                    ∪ξ    q (w0 )∆(σǫ (t)) q (w0 )cǫ (σǫ (t))cǫ (σǫ (t−1 ))
                            ǫ                        ǫ
                   Z                    
                              Et (h)                      dt
                =                           φǫ (t)                   ,
                    ∪ξ    q(w0 )∆(t)               q(w0 )c(t)c(t−1 )

where
                                     ǫn q(w0 )c(t)c(t−1 )
(5.17)             φǫ (t) :=                                      .
                               q ǫ (w0 )cǫ (σǫ (t))cǫ (σǫ (t−1 ))

By Lemma 5.2, the function t → φǫ extends, for all ǫ ∈ (0, 1], to a
regular holomorphic function on U. Clearly, φǫ is W0 -invariant. In
other words, φǫ is an element of Z an (U). Its value in W0 r can be com-
puted easily, if we keep in mind that the index i{r′ } = n (by Theorem
7.10 applied to the residual coset r ′ ). We obtain, by a straightforward
computation:
                            mqǫ ,{σǫ (r)} (r)   νqǫ ({W0 σǫ (r)})
(5.18)        φǫ (W0 r) =                     =                   .
                               mr (r)               ν({W0 r})

We now continue the computation which we began in equation (5.16),
using the fact that φǫ ∈ Z an (U) and the fact that χr extends uniquely
to Han (U) in such a way that for all φ ∈ Z an (U) and h ∈ Han (U),
98                             ERIC M. OPDAM

χr (φh) = φ(r)χ(h). We get
(5.19)      νqǫ ({W0 σǫ (r)})χqǫ ,σǫ (r) (jǫ (h)) = ν({W0 r})χr (φǫ h)
                                                = νqǫ ({W0 σǫ (r)})χr (h).
This gives the desired result.                                               

Theorem 5.6. The “base change” isomorphism jǫ induces an isomor-
phism
                                            σ (r)
(5.20)                        j ǫ : Hr −→H
                                        ˜ qǫǫ
of Hilbert algebras. In particular, the positive constants dRP ,δ (in the
notation of Theorem 4.23, see also equation (4.96)) (in Corollary 3.32
these constant were denoted by dr,i ) are independent of q.
Proof. This is an immediate consequence of the previous lemma.               


6. Applications and closing remarks
6.1. Formation of L-packets of unipotent representations
   Let F be a nonarchimedean local field, and let G be a split simple
algebraic group of adjoint type defined over F . We denote by G the
group of F -rational points in G. The finite set of irreducible unipotent
discrete series representations of G is by definition the disjoint union of
the discrete series constituents of induced representations of the form
σPG , where P is a parahoric subgroup of G, σ is a cuspidal unipotent
representation of the Levi quotient L := P/UP of P, and the union
is taken over a complete set of representatives of conjugacy classes of
pairs (P, σ).
   The formal dimension is an effective tool to partition these unipotent
discrete series representations into L-packets. This observation is due
to Reeder [39]. He conjectured that the formal dimensions of the unipo-
tent discrete series representations of G within one unipotent discrete
series L-packet are proportional, with a rational ratio of proportionality
independent of F , and used this in [39] to form the unipotent L-packets
for groups of small rank.
   It is known [36] that the endomorphism algebra H(G, P, σ) of σPG has
the structure of an affine Hecke algebra, whose root datum and root
labels depend only on P. The root labels are integral powers qna of
the cardinality q of the residue field of F (cf. [28]), and are explicitly
known. Moreover, if we define a trace functional Tr on H(G, P, σ) by
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 99

Tr(f ) := Tr(f (e), Vσ ), this corresponds to the trace τ studied in this
paper by the formula
(6.1)                  Tr = Vol(P)−1 dim(Vσ )τ.
Thus there is a bijection between the set of discrete series represen-
tations of H(G, P, σ) (in the sense of this paper) and the unipotent
discrete series representations arising from the pair (P, σ). The formal
dimension of such a discrete series representation of G is then equal to
the formal dimension of the corresponding discrete series representation
of the affine Hecke algebra H(G, P, σ), but with its trace Tr normalized
by equation (6.1).
   In [19] we computed the formal dimension of the discrete series rep-
resentations of the “anti-spherical” subalgebra of the affine Hecke alge-
bra, i.e. the commutative subalgebra e− He− = e− Z, where e− denotes
the idempotent of H0 corresponding to the sign representation (see
Subsection 6.3). The formula we obtained was expressed entirely in
terms of the central character of the representation, the root datum
and the root labels. We conjectured in [19] that our formula would
also hold for the full affine Hecke algebra. For the group of type E8 ,
we showed that this, in combination with Reeder’s conjecture, leads
to a partitioning of the unipotent discrete series L-packets which is in
agreement with Lusztig’s conjecture [25] for the Langlands parameters
of the members of these packets. In other words, the formal dimension
seems to be a sufficient criterion to separate the L-packets of unipotent
representations in the case E8 . Theorem 4.43 of this paper proves the
conjecture in [19] mentioned above.
   Reeder [40] proves an exact formula for the formal dimension of the
unipotent discrete series representation of all split exceptional groups,
based on a result of Schneider and Stuhler [42]. In this approach one
first represents the formal dimension by an alternating sum of rational
functions (depending on the K-types (cf. Subsection 6.6)), rather than
the product formula which we have obtained. On the other hand, there
are no intractable constants such as the constant dδ in our formula. Us-
ing his previous work on non-standard intertwining operators for affine
Hecke algebra modules and Theorem 3.25 of the present paper, Reeder
gave the precise partitioning of the unipotent discrete series for ex-
ceptional groups into L-packets, in complete agreement with Lusztig’s
conjecture mentioned above.
   Recently, Lusztig [29] established the partitioning of unipotent dis-
crete series representations into L-packets if G is split over an unrami-
fied extension of F . This is based on a different approach. It is worth
mentioning that this classification includes a geometric parametrization
100                              ERIC M. OPDAM

of the set ∆W0 r of discrete series representations with central character
W0 r if the affine Hecke algebra arises as an endomorphism algebra of
an induced representation of the form σPG .

6.2. Operator norm estimate and the Schwartz completion
6.2.1. Uniform norm estimate. We know that the generators Ni :=
q(si)−1/2 Ti satisfy
(6.2)                      kNi ko = max{q(si )±1/2 }
Therefore we have the trivial estimate kNw ko ≤ max{q(w)±1/2 }. By
the spectral decomposition it is easy to see that the operator norm
kNw ko is actually bounded by a polynomial in N (w):
Theorem 6.1. Let q > 1 be fixed.
    (i) There exist constants C ∈ R+ and d ∈ N such that for all
        w ∈ W,
(6.3)                      kNw ko ≤ C(1 + N (w))d
        (ii) For a residual point r ∈ T , let ∆W0 r := ∆R,W0 r denote the col-
             lection of all discrete series representations with central char-
             acter W0 r. Denote by kxkds the operator norm of the left
             multiplication by x ∈ H, restricted to the finite dimensional
             subspace
(6.4)                Hds := ⊕W0 r ⊕π∈∆W0 r End(π) ⊂ H.
            Then there exist constants C, ǫ > 0 such that
(6.5)                         kNw kds ≤ Cq−ǫl(w) .
Proof. (i) As was explained in the proof of Lemma 2.20, it is sufficient
to prove this statement for w = x ∈ (ZX + Q) ∩ X + . Recall that in
this case Nx = θx . We have
(6.6)        kθx k2o = kθx∗ θx ko = sup{σ(π(Tw0 θ−w0 x Tw−1 θ )) | π ∈ Ĉ},
                                                          0 x

where σ(A) denotes the spectral radius of A. According to Theorem
4.43, the spectrum Ĉ equals the union of the compact sets ĈRP ,WP r,δ .
This set is by definition the closure in Ĉ of the set π(Γgen
                                                          RP ,WP r,δ ). It is
well known that for any h ∈ H, the map π → kπ(h)ko is lower semi-
continuous as a function of π ∈ Ĉ (cf. [16], VII, Proposition 1.14).
Since there are only finitely many triples (RP , WP r, δ), it is sufficient
to show that there exist constants C, d such that the spectral radius
of
(6.7)                 π(RP , WP r, δ, tP )(Tw0 θ−w0 x Tw−1 θ )
                                                         0 x
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 101

is bounded by C(1 + N (x))d , uniformly in tP .
    The roots of a monic polynomial are bounded by the sum of the
absolute values of the coefficients of the equation (including the top
coefficient 1). Hence the spectral radius of an m × m matrix A is
bounded by a polynomial of degree m in max(A) := max{|ai,j | | 1 ≤
i, j ≤ m}. Since m ≤ |W0 | it is sufficient to show that there exists
a suitable basis for the parameter family π(RP , WP r, δ, tP ) (with tP ∈
TuP ) of representations, in which the matrix coefficients of the θx (with
x ∈ (ZX +Q)∩X + ) are uniformly bounded by C(1+N (x))d for suitable
constants C and d.
    As in the proof of Proposition 4.20, there exists a basis Twi ⊗ (vj ) of
Vπ = H(W P ) ⊗ V , the representation space of π(RP , WP r, δ, tP ), such
that the θx (x ∈ X) simultaneously act by means of upper triangular
matrices in this basis. Moreover, by Proposition 4.20 it is clear that
the diagonal elements are bounded in norm by 1 when x ∈ X + . By
the compactness of TuP we conclude that there exists, for each x ∈ X + ,
an unipotent upper triangular matrix Ux with positive coefficients such
that every matrix coefficient of Mx (tP ) := π(RP , WP r, δ, tP )(θx ) in the
above basis is uniformly (in tP ) bounded by the corresponding matrix
coefficient of Ux .
    Let us denote by P the set of n × n matrices with non-negative
entries, and introduce the notation |A| = (|Ai,j |)i,j for complex matrices
A. Introduce a partial ordering in P by defining A ≤ B if and only if
B − A ∈ P . Since P is a semigroup for matrix multiplication, it is clear
that if A, B and C are in P and A ≤ B, then AC ≤ BC. In addition
we have the rule |AB| ≤ |A||B| for arbitrary complex matrices A and
B.
    Let x1 , . . . , xm denote a set of Z+ -generators for the cone Q+ , and
let moreover xm+1 , . . . , xN be a basis of ZX . Put Mi,ǫ (tP ) := Mǫxi (tP )
for 1 ≤ i ≤ N, ǫ = ±1 with ǫ = 1 if i ≤ m. We can thus find an
                                                                           P
upper triangular unipotent matrix
        P
                                      P U ∈ P such that for all i, ǫ, t :
|Mi,ǫ (t )| ≤ U. If we write x = i li xi with li ≥ 0 if i ≤ m, then
                                             X
                    N (x) = x(2ρ∨ ) + k            li xi k
                                             i>m
                               X                       X
                                            ∨
                           =         li xi (2ρ ) + k         li xi k
                               i≤m                     i>m




with xi (2ρ∨ ) ≥ 1 if i ≤ m. From this
                                    Pwe see that there exists a constant
K independent of x such that α :=      |li | ≤ KN (x). Thus, with log(U)
102                             ERIC M. OPDAM

the nilpotent logarithm of U, and li = ǫ(i)|li |:
           max(Mx (tP )) = max(|M1l1 (tP ) . . . MNlN (tP )|)
                                         |l |              |l |
                                     1
                           ≤ max(|M1,ǫ(1) (tP )| . . . |MN,ǫ(N
                                                          N        P
                                                               ) (t )|)
                           ≤ max(U α )
(6.8)                      ≤ max(exp(α log(U)))
                               d
                               X
                           ≤         max(log(U)i )αi /i!
                               i=0

                           ≤ cU (1 + N (x))d
where cU is a constant depending on U only, and d is the degree of the
polynomial function α → exp(α log(U)). This finishes the proof.
  (ii) As in the proof of (i), but we restrict ourselves to the (finitely
many) discrete series representations. This implies that we can find
U ∈ P unipotent and ǫ > 0 such that for all i, |Mi | ≤ q−2ǫ U. Inserting
this in the inequalities (6.8) we find that the matrix entries of Mx are
bounded by Cq−ǫl(x) , with C independent of x ∈ X + . Hence the spec-
tral radius of q2ǫl(x) Mx∗ Mx is uniformly bounded for x ∈ X + , proving
the desired estimate.                                                  

Corollary 6.2. Ĉ consists only of tempered representations.
Proof. The character χπ of π ∈ Ĉ is a positive trace, and thus satisfies
the inequality |χπ (x)| ≤ χπ (1)kxko by Corollary 2.17. By Casselman’s
criterion Lemma 2.20 and Theorem 6.1 this implies that π is tempered.


Proposition 6.3. The trivial representation πtriv (Tw ) = q(w) is tem-
pered if and only if the point rtriv ∈ Trs defined by ∀α ∈ F0 : α(rtriv ) =
 1/2                          − . It is discrete series if and only if r
qα∨ /2 qα∨ satisfies rtriv ∈ Trs                                         triv ∈
  −                                                    l(w)
Trs . The Steinberg representation πSt (Tw ) = (−1)         is tempered if and
          −1               −                                              −
only if rtriv := rSt ∈ Trs , and discrete series if and only if rSt ∈ Trs   .
Proof. This is well known, and follows easily by the remark that the
restriction to {θx | x ∈ X} of the trivial representation is equal the
square root of the Haar modulus δ (see e.g. [37], Corollary 1.5):
πtriv (θx ) = q(x)1/2 = δ 1/2 (x) := x(rtriv ). Now apply the Casselman
criteria Lemma 2.20. Similar remarks apply to the case of the Stein-
berg representation.                                                  

Corollary 6.4. If the trivial representation extends to C then rtriv ∈
 − . If the Steinberg representation extends to C then r         +
Trs                                                      triv ∈ Trs .
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 103

Proof. Use Corollary 6.2 and Proposition 6.3.                         


6.2.2. The Schwartz completion of H. Using Theorem 6.1 we now de-
fine a Fréchet completion of H. For all n ∈ N we define a norm pn on
H by

(6.9)             pn (h) = max |(Nw , h)|(1 + N (w))n
                            w∈W

Here N denotes the norm function on W which was defined by equation
(2.5).

Theorem 6.5. The functions τ , ∗ and the multiplication · of H are
continuous with respect to the family of norms pn .

Proof. The continuity of τ and ∗ is immediate from the definitions. So
let us look at the multiplication. Let us write
                                    X
(6.10)                     Nu Nv =     cw
                                        u,v Nw
                                    w


It is easy to see that w(0)0 = u(0)0 + v(0)0 and that l(w) ≤ l(u) + l(v)
if cw
    u,v 6= 0. Therefore


(6.11)            cw
                   u,v 6= 0 ⇒ N (w) ≤ N (u) + N (v),

and by Theorem 6.1, there exist constants C, d such that for all u, v
and w:

(6.12)        |cw                        d             d
                u,v | ≤ C min{(1 + N (u)) , (1 + N (v)) }


We put Dw = {(u, v) ∈ W × W | cw
                               u,v 6= 0}. It is easy to see that there
exists a b ∈ N such that
                      X          1
(6.13)                                   =µ<∞
                      u∈W
                            (1 + N (u))b

converges. By (6.11) we have that

(6.14)           (1 + N (u))(1 + N (v)) ≥ (1 + N (w))

for all (u, v) ∈ Dw . Given n ∈ N, letP
                                      k = max{b + d, n}. Using
                                                           P these
remarks we see that for all 0 6= x =    xu Nu and 0 6= y =   yv Nv in
104                                  ERIC M. OPDAM

H the following holds:
   pn (xy)             1
               =                 max |(xy, Nw )|(1 + N (w))n
p2k (x)p2k (y)   p2k (x)p2k (y) w
                        X         |xu ||yv |
               ≤ max                           |cw
                                                 u,v |(1 + N (w))
                                                                  n
                  w
                      u,v∈D
                              p 2k (x)p 2k (y)
                             w

                         X min{(1 + N (u))d , (1 + N (v))d }(1 + N (w))n
               ≤ C sup
                    w
                       u,v∈D
                                   (1 + N (u))2k (1 + N (v))2k
                                 w

                         X (1 + N (u))d(1 + N (v))d (1 + N (w))n−k
               ≤ C sup
                    w
                       u,v∈Dw
                                     (1 + N (u))k (1 + N (v))k
                   X
               ≤C     (1 + N (u))d−k (1 + N (v))d−k
                     u,v

               ≤ µ2 C
This finishes the proof.                                              

  Notice that, by Theorem 6.1, kxko ≤ Cpd (x) for all x ∈ H. Therefore
the completion of H with respect to the family of norms pn will be a
subspace of C.
Definition 6.6. We define the Schwartz completion S of H by
                      X
(6.15)      S := {x =     xw Nw ∈ H∗ | pn (x) < ∞ ∀n ∈ N}.
                              w

We have H ⊂ S ⊂ C, and S is a ∗-subalgebra of C. S is a nu-
clear Fréchet algebra with respect to the topology defined by the fam-
ily of norms pn . It comes equipped with continuous trace τ and anti-
involution ∗.

Corollary 6.7. (of definition) The topological dual S′ is the space of
tempered linear functionals on H.

6.3. A Hilbert algebra isomorphism; abelian subalgebras
  There exists a trace preserving ∗-algebra isomorphism
                           i : H(R, q) → H(R, q −1 )
                                      Nw → (−1)l(w) Nw .
(see [19]). Clearly this induces a ∗-algebra isomorphism, and τ is re-
spected. Thus i induces an isomorphism of C ∗ -algebras i : C(R, q) →
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 105

C(R, q −1 ), also respecting the traces. The corresponding homeomor-
phism î : Ĉ(R, q −1 ) → Ĉ(R, q) is therefore Plancherel measure pre-
serving. Note that i restricts to a (Plancherel measure preserving)
∗-isomorphism from the subalgebra e+ H(R, q)e+ (the spherical subal-
gebra) to the subalgebra e− H(R, q −1 )e− (the anti-spherical subalgebra)
(see [19]).

6.3.1. The Plancherel measure of the center. The commutative subal-
gebras e± H(R, q)e± are both isomorphic as algebras to the center Z
via the Satake isomorphism Z ∋ z → e± z ∈ e± H(R, q)e± . These sub-
algebras are commutative Hilbert subalgebras of H(R, q). They are in
general not isomorphic as Hilbert algebras. The Hilbert algebra iso-
morphism i restricts to an isomorphism Z(R, q) → Z(R, q −1 ). Recall
the ν is the Plancherel measure of Z ⊂ C. The above is reflected by
the symmetry
Corollary 6.8. ν(t, q) = ν(t, q −1 ),
which can be verified directly (see Theorem 3.25 and Proposition 3.27).
  The spherical algebra e+ H(R, q)e+ with X = P (weight lattice) and
q(s) > 1 has a very important basis, uniquely defined by orthogonality
and by a triangularity requirement with respect
                                           P to the    standard mono-
                               +                    µ
mial basis e+ mλ (with λ ∈ P and mλ = µ∈W0 λ t ∈ Z). In type A
these are the Hall-Littlewood polynomials. It would be interesting to
study such orthogonal, triangular bases for the center Z as well.

6.4. Central idempotents of C and S
   Recall that Ĉ = ∪ĈO (union over a complete set of representatives
of the association classes orbits). In Theorem 4.43 we have shown that
two distinct closed subsets in Ĉ of the form ĈOi (i = 1, 2) intersect in
a subset of measure 0. In fact more is true: according to [13], these
closed subsets are the components of Ĉ.
   There is a bijection I → Iˆ between the closed two-sided ideals of C
and the open subsets of Ĉ. Hence the decomposition of Ĉ into com-
ponents ĈO corresponds to the decomposition of 1 ∈ C as a sum of
minimal central orthogonal idempotents eO of C.
   If O = Kδ \(Λγ × δ), eO ∈ C is determined by
                                (
                                   Idi(Vδ ) if [π] ∈ ĈO
(6.16)             F (eO )(π) =
                                   0 else ,
where F is the isomorphism of Theorem 4.43.
106                                ERIC M. OPDAM

   In fact, the results of [13] on smooth wave packets even imply that
eO ∈ S. We thus have the following decomposition of the unit element
in central, Hermitian, mutually orthogonal, minimal idempotents of S:
                                    X
(6.17)                          1=     eO .
                                            O

Theorem 6.9.           (i) Let O = Kδ \(Λγ × δ). Then
(6.18)              (eO , eO ) = |W P | dim(δ)µP l (ĈO ).
     (ii) These idempotents have the following expansion with respect
          to any orthonormal basis B of H:
                                X
(6.19)                    eO =      χO (b∗ )b
                                         b∈B

         with
                                    Z
(6.20)               χO (b) :=                  χπ (b)dµP l (π).
                                        π∈ĈO

         In particular this holds with respect to the orthonormal basis
         (Nw )w∈W .
Proof. (i). The dimension of π ∈ ĈO equals |W P | dim(δ) on an open
dense subset, and the measure µP l is absolutely continuous with respect
to the Haar measure on O. Hence, using the fact that F is an isometry,
we find
                             Z
                (eO , eO ) =       TrVπ (F (eO )(π))dµP l (π)
(6.21)                        π∈Ĉ

                           = |W P | dim(δ)µP l (ĈO ).
  (ii). As in (i) we get
             χO (b) = (eO , b)
                      Z
                    =       TrVπ (F (eO )(π)F (b)(π))dµP l(π)
                      Zπ∈Ĉ
(6.22)
                    =         TrVπ (π(b))dµP l (π)
                       π∈ĈO
                      Z
                    =         χπ (b)dµP l (π).
                           π∈ĈO

                                                                      

   The above depends on the results of [13], but in the special case of
isolated points in Ĉ these facts are more elementary:
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 107

Proposition 6.10. When π ∈ ∆R , put Oπ = {[π]} for the correspond-
ing component of Ĉ (an isolated point). Put eπ for the corresponding
central idempotent of C. The expansion
                                      X
(6.23)                eπ = µP l ({π})   χπ (b∗ )b
                                       b∈B
is convergent in S.
Proof. The expansion follows as in the above Theorem. It is convergent
in S because of Corollary 3.33 and Definition 6.6.                  

Corollary 6.11. Let B be a Hilbert basis of H. For any residual point
r and discrete series representation π ∈ ∆W0 r we have
                  X                      dim(π)
(6.24)                |χπ (b)|2 =
                  b∈B
                                  |W0 r|κW0 r dπ m{r} (r)
where the constant κW0 r ∈ Q is defined by (3.55), the constant dπ ∈ R+
by Definition 3.24 and m{r} (r) by Theorem 3.25.
Proof. This follows from µP l (π) = |W0 r|κW0 r dπ m{r} (r). Note that dπ
is indeed constant (i.e. independent of q) by Theorem 5.6. Also note
Conjecture 2.27.                                                       


6.5. Some examples
6.5.1. The Steinberg representation. A basic example is the Steinberg
representation. We obtain a well known expression for the Poincaré
series of W .
   This result was first (for equal labels, using Morse theory) derived
by Bott [9], and by elementary means by Steinberg [47]. Macdonald
[32] observed that the arbitrary parameter case can be obtained by
Steinberg’s method. Macdonald proved formula (6.26) below, express-
ing the Poincaré polynomial in terms of the roots, in an elementary
way using case-by-case verifications. In [33] Macdonald reproved the
formula in a uniform way. Also note that the Steinberg representation
is a representation of e− He− (cf. 6.3). Hence its formal degree can also
be computed by means of the (simpler) techniques of [19].
   We assume that Q ⊂ X ⊂ P . Let πSt be the Steinberg repre-
sentation, which is the representation defined by πSt (Tw ) = (−1)l(w) .
This is a one dimensional discrete series representation provided that
         −
rSt ∈ Trs   (see Proposition 6.3). Recall that rSt ∈ Trs is defined by
                       −1/2
∀α ∈ F0 : α(rSt ) = qα∨ /2 qα−1∨ . Generically this residual point is regu-
lar. In this regular case, the residual codimension 1 cosets containing
108                            ERIC M. OPDAM

wrSt form a normal crossing divisor Dw locally at wrSt . By Proposi-
tion 3.12 we find that [ξwrSt ] ∈ Hn (U\Dw ) (with U a small ball around
wr) is zero if w 6= e, and for w = e it is straightforward to see that
[ξrSt ] = (−1)n .C, where C is the positive generator of Hn (U\De ). In
view of (3.50) we find that (still in the regular case)
                                       (−1)n δw,e
(6.25)                       κwrSt =              ,
                                        |X : Q|
and thus that κW0 rSt = (−1)n |W0 |−1 |X : Q|−1 .
  Hence if π is a discrete series representation with central character
rSt then, assuming that rSt is regular, equation (3.70) implies that π
can only have a nonzero weight space for the weight rSt . But this
weight space is one dimensional, so that π = πSt . Hence in the regular
case, the Steinberg representation is the only member of ∆W0 rSt , and
thus dπSt = 1 in this case.
  Inserting the values of these constants, above identity thus specializes
to (using the Hilbert bases (Nw )w∈W ) Macdonald’s product formula for
the Poincaré series of W :
                       X             (−1)n |X : Q|
(6.26)                      q(w)−1 =
                       w∈W
                                       m{rSt } (rSt )
                                                                  −
By continuity, this formula holds in general provided that rSt ∈ Trs .
                                     aff
When we take q(s) = q for all s ∈ S , and X = Q, then we obtain
                   X            Yn
                                       (qmi +1 − 1)
(6.27)                 q−l(w) =
                  w∈W           i=1
                                    (qmi − 1)(q − 1)
where (mi ) is the list of exponents of W0 .
6.5.2. The subregular unipotent orbit of Sp2n . Let F be a nonarchi-
medean local field, and let q be the cardinality of its residue field.
Consider the group G = SO2n+1 (F ) for n ≥ 3. The Langlands dual
group of G is Ĝ = Sp2n (C), whose root datum (with basis) we write as
R = (Cn , Zn , Bn , Zn , F0 ), with F0 = (e1 − e2 , . . . , en−1 − en , 2en ). We
normalize the Haar measure of G by Vol(I) = 1, where I ⊂ G is an
Iwahori subgroup. Let us compute the formal dimensions of the irre-
ducible square integrable, Iwahori-spherical representations of G whose
Kazhdan-Lusztig parameters (ru , u, ρ) (cf. Appendix 8) are such that
u is the subregular unipotent orbit of Ĝ. Take ru ∈ Trs dominant in its
W0 -orbit. It follows from the discussion in Appendix 8 that the value
α(ru ) with α ∈ F0 is given by qDu (α)/2 , where Du (α) is the weight of
α in the Bala-Carter diagram of u (cf. [10]). In our case, the vec-
tor of values α(ru ) with α ∈ F0 is (q, . . . , q, 1, q), which is a residual
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 109

point for (R, q1 ), where q1 denotes the length multiplicative function
q1 (w) = ql(w) .
   The Springer correspondence for all classical types has been com-
puted explicitly in [44]. We use the description of [30] (see [10]). In
our particular case, the partition λ ⊢ 2n of elementary divisors of u is
λ = (2, 2n − 2). Thus the Springer representation corresponding with
(u, 1) (1 denoting the trivial representation of the component group
A(ru , u) (see Appendix 8)) is the representation φ(n−1,1) of W0 labeled
by the double partition (n − 1, 1) of n. This is the reflection represen-
tation of W0 .
   The component group is equal to A(ru , u) ≃ C2 (Chapter 13, loc.
cit.). Both representations ±1 of A(ru , u) are geometric, and one easily
finds that the Springer correspondent of (u, −1) is the representation
φ(−,n) of W0 . This is the 1-dimensional representation in which si acts
by 1 for i = 1, . . . , n − 1, and in which sn acts by −1.
   Let us denote by π±1 the irreducible square integrable I-spherical
representations of G with the Kazhdan-Lusztig parameters (ru , u, ±1),
                      I
and put ρ±1,1 := π±1     . The Kazhdan-Lusztig model [23], and the explicit
results of [25] imply the following: ρ1,1 is an (n+1)-dimensional discrete
series representation of H(R, q1 ), with central character W0 ru , and with
restriction to H(W0 , q1 ) whose limit for q → 1 is equal to φ(−,1n ) ⊗
(φ(n−1,1) ⊕ φ(n,−) ) (here φ(−,1n ) is the sign representation, and φ(n,−)
is the trivial representation of W0 ). The representation ρ−1,1 is 1-
dimensional, and has H(W0 , q0 )-type corresponding to φ(−,1n ) ⊗φ(−,n) =
φ(1n ,−) in the limit q → 1.
   According to Corollary 3.32 (also see Subsection 6.1) we have
(6.28)          fdim(π±1 ) = |W0 ru |κW0 ru dρ±1 m{ru } (ru ),
with m{ru } (ru ) equal to the rational function (3.47), κW0 ru ∈ Q× and
dρ±1 ∈ R+ , subject to the condition (n + 1)dρ+1 + dρ−1 = 1.
   In general I do not know how to compute the constants κW0 ru and
dρ±1 (there is a tedious “algorithm” for κW0 ru (analogous to [18]), and
for dρ±1 not even that). However, in the case of regular central charac-
ters these constants are easy to determine. In the situation at hand we
we are able to determine the constants by slightly deforming q, since
the orbits of residual points that “emerge” from ru (there are two of
them, corresponding to the two representations ρ±1,1 ) under such a de-
formation are regular. Moreover, one can show in the current example
that the formal dimensions are continuous under this deformation.
   So let us consider generic root labels qf (cf. [18], [45]) defined by
qf (si ) = q (i = 1, . . . , n − 1) and qf (sn ) = qf , where 0 < f < 2,
f 6= 1. There are two generic orbits W0 r±1,f of residual points such
110                            ERIC M. OPDAM

that W0 r±1,1 = W0 ru . By the generic parametrization of [18] of or-
bits of residual points of the graded affine Hecke algebra (which, by
Theorem 7.7, can also be used for (R, qf ) residual points) of type
Cn such a generic orbit corresponds to a partition of n. In this case
the partitions are ξ1 = (n − 1, 1) and ξ−1 = 1n . The (standard ba-
sis) coordinates of these residual points (suitably chosen within their
W0 -orbits) are (by [18]) r1,f = (q2−n−f /2 , q3−n−f /2 , . . . , q1−f /2 ) and
r−1,f = (q1−n+f /2 , q2−n+f /2 , . . . , qf /2 ). In particular, these are regu-
lar orbits of residual points.
   By Theorem 3.29, for each of these central characters there exists at
least 1 irreducible square integrable representation of H. In addition,
it is not difficult to see (cf. [45]) that the residual Hilbert algebra of
a regular orbit of residual points is in fact simple. Thus for f 6= 1, we
find precisely two irreducible square integrable representations ρ±1,f ,
with central characters W0 r±1,f .
   One checks directly that r−1,f is the A-weight space of a 1 dimen-
sional (square integrable, by Casselman’s criterion) representation where
Ti (i < n) acts by −1, and Tn by qf . This is a continuous family of
square integrable representations in the parameter f (if f is in the
range 0 < f < 2 and n ≥ 3). We call this parameter family ρ−1,f .
   The other orbit W0 r1,f also carries a continuous parameter family
of square integrable representations ρ1,f , the twist by the automor-
phism i (see Subsection 6.3) of the affine reflection representation of
H (a representation of dimension (n + 1)). To see this, we give the
following model for the representation (there are several possible con-
structions one could invoke here, but none of these is obvious (as far as
I know)). Our approach here is based on the simplifying circumstance
that the representation contains the sign representation of H(W0 ) (is
“anti-spherical”).
   We will use the spherical function φ(µ, k) of the Yang system (cf.
[18]), with R = Cn , kα = log(q(sα )), and k = log(q). Recall that
this function depends analytically on (µ, k). First we consider −k < 0
(the attractive case in [18]), and we consider the residual point µ =
log(w0 r1,f ) = −k(f /2 + n − 2, f /2 + n − 3, . . . , f /2, f /2 − 1). The list
of positive roots α such that α(µ) = −kα is L = (e1 − e2 , . . . , en−1 −
en , 2en−1 ). In order to compute the dimension (in the regular case
f 6= 1) of the graded Hecke module generated by φ(µ, k) we have to
count the number of exponentials ewµ which have a nonzero coefficient
in φ(µ, k). Assuming that 0 < f < 2, f 6= 1, we see that µ satisfies
the condition of Lemma 3.3 of [18], and by Remark 3.4 of [18] this
shows that µ is an exponent of φ(µ, k). Then w −1 µ is also an exponent
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 111

iff wδ = w(n, n − 1, . . . , 1) satisfies wδ(α) > 0 for all α ∈ L. One
easily verifies that this is satisfied iff wδ = (n, n − 1, . . . , 2, ±1) or
wδ = (n, n−1, . . . , ĵ, . . . , 1, −j) (j = n, n−1, . . . , 2). Hence the module
generated by φ(µ, −k) (with µ as above, and 0 < f < 2) is a spherical
discrete series module of the graded Hecke algebra, which is irreducible
(this is always true, see the discussion above Section 3, loc. cit.), and
of dimension n + 1 if f 6= 1. Now apply the involution i (see Section
5, loc. cit., and also Subsection 6.3) to replace −k by k, and then
integrate the representation (as in [26], Section 9) so obtained to get
a representation of H. We obtain a parameter family (depending on
f with 0 < f < 2) of irreducible square integrable representations
generated by an anti-spherical vector, of dimension n + 1 if f 6= 1.
Now observe that for f = 1 this representation has to be irreducible of
dimension n + 1 as well, by the classification of the square integrable
representations with central character W0 ru as described above. We
call this n + 1-dimensional family ρ1,f . It follows easily from the above
discussion that the characters of ρ±1,f are continuous in 0 < f < 2,
and uniformly square integrable.
   Hence we can compute the formal dimension of both representations
by taking the limit for f → 1 of the corresponding generic formal
dimensions. It is easy to see that

                                              1
(6.29)              lim m{r±1,f } (r±1,f ) = ± m{ru } (ru ).
                    f →1                      2

For f 6= 1 one obviously has dρ± = 1 and κwr±1,f = ±(−1)n |X : Q|−1 =
±(−1)n /2 for all w such that wr±1,f is a weight in ρ±1,f , and = 0 else.
   Combining these facts, we find in the limit f → 1 that |W0 ru |κW0 ru =
(−1)n (n + 2)/4, and dρ±1 = 1/(n + 2). Hence both constants λρ±1 are
equal to (−1)n /4, which is in accordance with Reeder’s conjectural
formula ([40], equation (0.5)) for the formal dimension (up to a sign).
A computation yields:
                                                  Qn−2 2i+1
                          1 q(q − 1)n+2 (qn−2 − 1) i=1 (q     − 1)
(6.30)       fdim(π±1 ) =                        Qn−1
                          4     (q2 − 1)(qn − 1) i=1 (q2i − 1)

Remark 6.12. It would be interesting to work out the product for-
mula (3.68) for formal dimensions (without the precise analysis of the
constants λρ ) for classical root systems in general (for “special param-
eters”, see [45]), and to express the answer (in the case of real central
characters) in terms of the symbol of the Springer correspondent ac-
cording to the conjecture in [45].
112                            ERIC M. OPDAM

6.6. K-types
   We touch superficially upon the analogue of the problem of the “K-
type decomposition” of admissible representations of a reductive group
for tempered representations of the affine Hecke algebra H. We refer
to [40] for a deep connection between the “K-types” of an irreducible
discrete series representation, and its formal dimension. We refer to
[45] for precise conjectures on the K-types of the irreducible tempered
modules with real central character for affine Hecke algebras of classical
type (and general root labels).
   The role of K can be played by any maximal finite type Hecke sub-
algebra of the form H(WJ ) ⊂ H, with J ⊂ F aff a maximal proper
subset. Such a subalgebra is a finite dimensional ∗-subalgebra. The
restriction of τ to H(WJ ) is equal to the usual trace of the finite type
Hecke algebra H(WJ ), normalized in such a way that τ (Te ) = 1.
   For σ ∈ ŴJ we denote by dJ,σ (q) its generic degree with respect to
H(WJ ) with label q|WJ . Thus we have (1.1)
                                           X
(6.31)             τ |H(WJ ) = (PWJ (q))−1    dJ,σ (q)χσ ,
                                             σ∈WˆJ

where PWJ (q) denotes the Poincaré polynomial of WJ with respect to
the label function q (restricted to WJ ).
   Now observe that the restriction to H(WJ ) of π(ω) is independent
of ω ∈ O. We denote the multiplicities by nO (σ), thus
                                      X
(6.32)                χπ(ω) |H(WJ ) =     nO (σ)χσ .
                                         σ∈WˆJ

We introduce for γ = (RP , WP rP ) ∈ Γ the following rational functions
of q:
                            Z
(6.33)                Mγ :=        mP (rP t)dP t.
                                 t∈TuP

Notice that for all orbits of the form O = Kδ \Λγ × δ,
                          Z
(6.34)                        mP (ω)dO ω = Mγ .
                           O

From the Plancherel decomposition of H (Theorem 4.43) we thus obtain
the following identities: For all J ⊂ F aff a maximal proper subset, and
each σ ∈ ŴJ ,
                          X        X
(6.35) dJ,σ (q) = PWJ (q)     Mγ        |W (O)|−1nO (σ)µRP ,P l (KP (γ) δ),
                         γ∈Γa     δ∈∆γ,a
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 113

where Γa is a complete set of representatives for the association classes
(=W-orbits) in Γ, ∆γ,a is a complete set of representatives in ∆γ for
the action of W(γ), and where O denotes the orbit O = Kδ \Λγ × δ of
cuspidal representations of HP (γ) (for a given pair (γ, δ) ∈ Γa × ∆γ,a ).

Example 6.13. It is instructive to verify (6.35) for R0 = B2 (equal
label case), both for X = Q and X = P , using the discussion in Exam-
ple 7.9. The residual point (q, −1) for X = Q (notation of Example
7.9) is the most complicated part. This orbit of residual points carries
2 one-dimensional discrete series representations which are exchanged
by the nontrivial affine diagram automorphism. Their direct sum lifts
to the two-dimensional irreducible discrete series representation which
is carried by the (regular) orbit (q1/2 , −1) of residual points for the ex-
tended affine Hecke algebra with X = P . Using Corollary 6.11 one
concludes that the formal dimension of this two-dimensional represen-
tation (which is easily computed, since the underlying central character
is regular) is equal to the formal dimension of each of the two one-
dimensional discrete series in which it decomposes upon restriction to
the case X = Q.


6.7. A remark on the residual degrees dπ
  We mention one further consequence of Corollary 6.11 regarding the
constants dπ ∈ R+ .

Corollary 6.14. Assume that the constants fs in Convention 2.1 are
integers. Let r be a residual point, and let π ∈ ∆W0 r . Assume that the
character values of π on Tw are contained in k[q1/2 , q−1/2 ], where k is
a subfield of C. Then dπ ∈ R+ ∩ k.

  See also Conjecture 2.27; we expect that the dπ ∈ Q.

Proof. The main step is to show that Casselman’s bound of Corollary
3.33 becomes uniform in q under the assumption. Let r = sc and
choose n ∈ N such that sn = s. Let us first fix q > 1. Consider the
isomorphism of localized Hecke algebras

(6.36)                 j1/n : Hqann (U) → Han (U1/n ),

where U = W0 scn exp B = W0 r n exp B, with B a suitably small ball
around the origin in tC . We have, by the assumption that sn = s:

(6.37)                       j1/n (θx,qn ) = θnx .
114                              ERIC M. OPDAM

On the other hand, for all s ∈ F0 , the eigenvalues of the self adjoint
operator π(j1/n (Ns,qn )) are of the form ±q±fs n/2 . Hence the opera-
                                         ±1                       Mn
tor norms of the operators π(j1/n (Ns,q    n )) are bounded by q     , for a
suitable constant M.
  Given w ∈ W we can write w = uxv with x ∈ X + , u ∈ W x and
v ∈ W0 , where W x denotes the set of shortest length representatives of
the left cosets of the stabilizer Wx of x in W0 . If we write u = si1 . . . sik
and v = sj1 . . . sjl , we can thus choose signs ei and dj such that
(6.38)                Nw = Nie11 . . . Niekk θx Njd11 . . . Njdll .
Let us simply denote this decomposition by Nw = Nue θx Nvd .
   Now by Theorem 6.1(ii), and the remark that j1/n intertwines the
action of Hqann (U) on π|qn with that of Han (U1/n ) on π|q , we have (M
is a constant, not necessarily the same as above):
          |χπ,qn (Nw,qn )|2 = |χπ,q (j1/n (Nw,qn ))|2
                                             e      d              2
                             = |χπ,q (j1/n (Nu,q n Nv,qn )θnx,q )|
(6.39)
                             ≤ dim(π)2 kπ(j1/n (Nu,q
                                                 e      d       2         2
                                                     n Nv,qn ))ko kθnx,q kds


                             ≤ Cq2n(M −ǫl(x))
where C is independent of w and n. In particular, this implies that the
highest power of q in |χπ (Nw )|2 = χπ (Nw )χπ (Nw−1 ) ∈ kR [q1/2 , q−1/2 ]
tends to −∞ with l(w) (with kR := k ∩ R). Hence the left hand side of
the equality Corollary 6.11 is a Laurent series in q−1/2 with coefficients
in kR .
   On the other hand, according to Proposition 3.27(iv), m{r} (r)−1 can
be expanded as a Laurent series in q−1/2 with coefficients in Q. The
desired result follows.                                                 


7. Appendix: Residual Cosets
7.1. Introduction and quick guide
  Our approach to the spectral resolution is through residues of certain
rational n-forms on a complex torus T . In order for our method to work
well, we need to have a certain a priori knowledge on the geometric and
combinatorial properties of the set of poles of these rational forms. The
present section serves to collect such facts about the set of poles, and
to classify the collection of “residual cosets”, the sets of maximal pole
order, which will eventually turn out to constitute the projection of
support of the Plancherel measure to W0 \T .
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 115

   Recall that we have chosen a rational, positive definite, W0 -invariant
symmetric form on X. This defines an isomorphism between X ⊗Z Q
and Y ⊗Z Q, and thus also a rational, positive definite symmetric form
on Y . We extend this form to a positive definite Hermitian form on
tC := Lie(T ) = Y ⊗Z C, where T is the complex torus T = Hom(X, C× ).
Via the exponential covering map exp : tC → T this determines a
distance function on T .
   Let q be a set of root labels. If 2α 6∈ Rnr we formally put qα∨ /2 = 1,
              1/2
and always qα∨ /2 denotes the positive square root of qα∨ /2 . Let L be a
coset of a subtorus T L ⊂ T of T . Put RL := {α ∈ R0 | α(T L ) = 1}.
This is a parabolic subsystem of R0 . The corresponding parabolic
subgroup of W0 is denoted by WL . Define
                                            1/2           1/2
(7.1)      RLp := {α ∈ RL | α(L) = −qα∨ /2 or α(L) = qα∨ /2 qα∨ }
and
(7.2)                RLz := {α ∈ RL | α(L) = ±1}.
We write RLp,ess = RLp \RLz and RLz,ess = RLz \RLp . We define an index iL
by
(7.3)                      iL := |RLp | − |RLz |.
As a motivation for the somewhat more technical definition in the next
subsection, we remark that this index iL computes the order of the pole
along L of the rational (n, 0)-form
                                        dt
(7.4)                     ω :=                     ,
                                 c(t, q)c(t−1 , q)
 which plays a main role in this paper (cf. equation (3.1)). We will
find (cf. Corollary 7.12) that for each coset L of a subtorus of T ,
(7.5)                        iL ≤ codim(L).
Suppose that L is a coset such that iL < codim(L), and let TL de-
note the subtorus orthogonal to T L . Let CL be a cycle of dimen-
sion dim(CL ) = codim(L) in a sufficiently small neighborhood of e
in TL , and let C L be any compact cycle in L\ ∪L6⊂L′ L′ of dimension
dim(C L ) = dim(L). Then for every homolorphic function f on T ,
                            Z
(7.6)                             f ω = 0.
                              C L ×CL

We call a coset L residual if iL = codim(L). It will turn out that
the support of the spectral measure of the restriction of the trace τ to
the center of the Hecke algebra is precisely equal to the union of all
116                           ERIC M. OPDAM

the “tempered forms” of the residual cosets (see Theorem 3.29). The
spectral measure arises as a sum of integrals of the form (7.6).
  For technical convenience, the Definition 7.1 of the notion “residual
coset” in the next subsection is slightly more complicated. We will
define the residual cosets by induction on their codimension in T , in
such a way that the collection of residual cosets is easily amenable
to classification. In the next subsection we discuss their elementary
properties and show how the classification can be reduced to the case
of residual subspaces in the sense of [18]. These residual subspaces
were already classified in the paper [18]. By this classification we verify
equation (7.5) (cf. Corollary 7.12). Using Lemma 7.11 this implies that
the following are equivalent for a coset L ⊂ T :
       (i) L is residual (in the sense of Definition 7.1).
      (ii) iL ≥ codim(L).
     (iii) iL = codim(L).

7.2. Definition and Classification of Residual Cosets
  We give the following recursive definition of the notion residual coset.
Definition 7.1. A coset L of a subtorus of T is called residual if ei-
ther L = T , or else if there exists a residual coset M ⊃ L such that
dim(M) = dim(L) + 1 and
(7.7)                          iL ≥ iM + 1.
Corollary 7.2. The collection of residual cosets is a nonempty, finite
collection of cosets of algebraic subtori of T , closed for the action of the
group of automorphisms of the root system preserving q (in particular
the elements of W0 , but also for example − Id).
Proof. By induction on the codimension. In a residual coset M of codi-
mension k − 1 we find only finitely many cosets L ⊂ M of codimension
1 in M with iL > iM . The invariance is obvious from the invariance of
the index function iL .                                             

Proposition 7.3. If L is residual, then
     (i) RLp,ess spans a subspace VL of dimension codim(L) in the Q
         vectorspace V = X ⊗ Q.
    (ii) We have RL = VL ∩ R0 , and the rank of RL equals codim(L).
   (iii) Put L X := VL ∩ X and X L := X/LX. Then T L = {t ∈ T |
         x(t) = 1 ∀x ∈ L X} = Hom(X L , C× ) = (T WL )0 .
   (iv) Put YL := Y ∩ QRL∨ and L X := YL⊥ ∩ X. Let XL := X/L X.
         We identify RL with its image in XL . Let FL be the basis of
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 117

         RL such that FL ⊂ R0,+ . Then RL := (XL , YL , RL , RL∨ , FL ) is
         a root datum.
     (v) Put TL := Hom(XL , C× ) ⊂ T (we identify TL with its canon-
         ical image in T ). Then TL is the subtorus in T orthogonal to
         L. Define KL := T L ∩ TL = Hom(X/(LX + L X), C× ) ⊂ T ,
         a finite subgroup of T . The intersection L ∩ TL is a KL -coset
         consisting of residual points in TL with respect to the root da-
         tum RL and the root label qL obtained from q by restriction to
           ∨        ∨
         RL,nr ⊂ Rnr  . When rL ∈ TL ∩ L, we have L = rL T L . Such rL
         is determined up to multiplication by elements of KL .
Proof. By induction on codim(L) we may assume that the assertions
of (i) and (ii) hold true for M in (7.7). From the definition we see that
RLp,ess\RM
         p,ess
               is not the empty set. An element α of RLp,ess\RM  p,ess
                                                                       can
not be constant on M, and hence α 6∈ RM = VM ∩ R0 . Thus
        dim(VL ) ≥ dim(VM ) + 1 = codim(M) + 1 = codim(L).
Since also
                            VL ⊂ Lie(T L )⊥ ,
equality has to hold. Hence RL ⊂ VL and RL spans VL . Since RL is
parabolic, we conclude that RL = VL ∩ R0 . This proves (i) and (ii).
The subgroup {t ∈ T | x(t) = 1 ∀x ∈ L X} ⊂ T is isomorphic to
Hom(X L , C× ), which is a torus because X L is free. By (ii) then, its
dimension equals dim(T L). It contains T L , hence is equal to T L . It
follows that T L is the connected component of the group of fixed points
for WL , proving (iii). The statements (iv) and (v) are trivial.      

  For later reference we introduce the following notation. A residual
coset L determines a parabolic subsystem RL ⊂ R0 , and we associated
with this a root datum RL . When Σ ⊂ R0 is any root subsystem,
not necessarily parabolic, we associate to Σ two new root data, namely
RΣ := (X, Y, Σ, Σ∨ , FΣ ) with FΣ determined by the requirement FΣ ⊂
R0,+ , and RΣ := (XΣ , YΣ , Σ, Σ∨ , FΣ ) where the lattice X → XΣ is the
quotient of X by the sublattice orthogonal to Σ∨ , and YΣ ⊂ Y is the
sublattice of elements of Y which are in the R-linear span of Σ∨ .
  There is an obvious converse to Proposition 7.3:
Proposition 7.4. Let R′ ⊂ R0 be a parabolic subsystem of roots, and
let T L ⊂ T be the subtorus such that R′ = RL . Let TL ⊂ T be the
subtorus whose Lie algebra Lie(TL ) is spanned by RL∨ . Let r ∈ TL be a
residual point with respect to (RL , qL ) as in Proposition 7.3(v). Then
L := rT L is a residual coset for (R, q).
118                             ERIC M. OPDAM

   The recursive nature of the definition of residual cosets makes it
feasible to give a complete classification of them. By Lemma 7.3, this
classification problem reduces to the classification of the residual points.
In turn, Lusztig [26] indicates how the classification of residual points
reduces to the classification of residual points in the sense of [18] for
certain graded affine Hecke algebras. This classification is known by
the results in [18]. Let us explain this in detail. Following [26] we call
a root datum R = (X, Y, R0 , R0∨ , F0 ) primitive if one of the following
conditions is satisfied:
      (1) ∀α ∈ R0 : α∨ 6∈ 2Y .
      (2) There is a unique α ∈ F0 with α∨ ∈ 2Y and {w(α) | w ∈ W0 }
          generates X.
A primitive root datum R satisfying (2) is of the type Cnaff (n ≥ 1), by
which we mean that
 R = (Q(Bn ) = Zn , P (Cn ) = Zn , Bn , Cn , {e1 − e2 , . . . , en−1 − en , en }).
By [26] we know that every root datum is a direct sum of primitive
summands.
Proposition 7.5. Let r ∈ T be a residual point, and write r = sc ∈
Tu Trs for its polar decomposition (with Tu = Hom(X, S 1 ) and Trs =
Hom(X, R+ )). The root system
                         Rs,1 := {α ∈ R1 | α(s) = 1}
has rank dim(T ). The system
               Rs,0 := {α ∈ R0 | kα ∈ Rs,1 for some k ∈ N}
                    p,ess        z,ess
contains both R{r}        and R{r}     , and r is residual with respect to the
affine Hecke subalgebra H ⊂ H whose root datum is given by Rs :=
                               s
              ∨
(X, Y, Rs,0, Rs,0 , Fs,0) (with Fs,0 the basis of Rs,0 contained in R0,+ ).
                                                                       p,ess
Proof. It is clear from the definitions that Rs,0 contains R{r}              and
  z,ess
R{r} , and hence has maximal rank. Given a full flag of R-residual
subspaces {c} = L0 ⊂ L1 ⊂ · · · ⊂ Ln = T , satisfying (7.7) at each
level, we see that the sets RLp i , RLz i are contained in Rs,0 . It follows by
reverse induction on i (starting with Ln = T ) that each element of the
flag is Rs -residual.                                                          

Lemma 7.6. Given a residual point r = sc, let s0 ∈ Tu = Hom(X, S 1 )
be the element which coincides with s on each primitive summand of
type Cnaff and is trivial on the complement of these summands. Then
s0 has at most order 2.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 119

Proof. To see this we may assume that R is of type Cnaff . Then R1 is
of type Cn , s = s0 , and Rs,1 = {α ∈ R1 | α(s0 ) = 1}, being of maximal
rank in R1 , is of type Ck + Cn−k for some k. In particular, ±2ei ∈ Rs,1
for all i = 1, . . . , n. Moreover the index of ZRs,1 in ZR1 is at most 2.
Thus s0 takes values in {±1} on R1 , and is trivial on elements of the
form ±2ei . It follows that s0 is of order at most 2 on X = Zn .        

   Denote by h ∈ Hom(Q, S 1 ) the image of s0 in Hom(Q, S 1 ). Choose
root labels kα = ks,α ∈ R with α ∈ Rs,0 by the requirement (kα depends
on the image of s in Hom(Q, S 1 ), but we suppress this in the notation
if there is no danger of confusion)
                           h(α)/2 1/2
                    ekα =qα∨ qα∨ +1
                         ( 1/2
(7.8)                      q ∨ qα∨ if h(α) = +1
                        = α1/2/2
                           qα∨ /2   if h(α) = −1

Theorem 7.7. Let r = sc be a (R, q)-residual point. Then γ :=
log(c) ∈ t := Lie(Trs ) is a residual point in the sense of [18] for the
graded Hecke algebra H s = C[W (Rs,0)] ⊗ Sym(t) with root system Rs,0
and root labels ks := (ks,α)α∈Rs,0 . This means explicitly that there exists
a full flag of affine linear subspaces {γ} = ln ⊂ ln−1 ⊂ · · · ⊂ l0 = t
such that the sequence
                                    p           z
(7.9)                    is,li := |Rs,0,i | − |Rs,0,i |
is strictly increasing, where
                     p
(7.10)              Rs,0,i = {α ∈ Rs,0 | α(li ) = ks,α },
and
                      z
(7.11)               Rs,0,i = {α ∈ Rs,0 | α(li ) = 0}.
Conversely, given a s ∈ Tu such that Rs,1 ⊂ R1 has rank equal to
rank(X), and a residual point γ ∈ t for the root system Rs,0 with labels
(ks,α) defined by (7.8), the point r := s exp γ is (R, q)-residual. This
sets up a 1 − 1 correspondence between W0 -orbits of (R, q)- residual
points and the collection of pairs (s, γ) where s runs over the W0 -orbits
of elements of Tu such that Rs,1 has rank equal to rank(X), and γ ∈ t
runs over the W (Rs,0)-orbits of residual points (in the sense of [18])
for Rs,0 with the labels ks .
Proof. Straightforward from the definitions.                              

  For convenience we include the following lemma:
120                           ERIC M. OPDAM

Lemma 7.8. If the rank of R0 equals the rank of X (a necessary
condition for existence of residual points!), the W0 -orbits of points
s ∈ Tu such that Rs,1 ⊂ R1 has maximal rank correspond 1 − 1 to
the Hom(P (R1 )/X, S 1 ) ≃ Y /Q(R1∨)-orbits on the affine Dynkin di-
         (1)
agram R1 . In particular, Rs,1 only depends on the corresponding
                                      (1)
P (R1∨)/Q(R1∨ )-orbit of vertices of R1 .
Proof. In the compact torus Hom(P (R1 ), S 1 ), the W0 -orbits of such
points correspond to the vertices of the fundamental alcove for the
action of the affine Weyl group W0 ⋉ 2πiQ(R1∨ ) on Y ⊗ 2πiR. Now we
have to restrict to X ⊂ P (R1 ).                                    

  With the results of this subsection at hand, the classification of resid-
ual cosets is now reduced to the classification of residual subspaces as
was given in [18].
Example 7.9. Let R0 = B2 = {±e1 , ±e2 , ±e1 ± e2 } with basis α1 =
e1 − e2 , α2 = e2 , and let X = Q = Z2 (this is C2aff ). Assume that
q(si) = q for i = 0, 1, 2. Then R1 = {±2e1 , ±2e2 , ±e1 ± e2 } and
thus X = P (R1 ). We use (α1 , α2 ) as a basis of X (so a point t ∈ T
is represented by (α1 (t), α2 (t))). The orbits of points s ∈ Tu such that
Rs,1 has rank 2 are represented by (1, 1), (1, −1) and (−1, 1). The latter
point corresponds to Rs,0 = {±e1 , ±e2 }, but since it has value −1 on
±e1 , the labels of ±e1 are equal to 1 (by (7.8)). Therefore there are no
residual points associated with (−1, 1). The other two points each give
one orbit of residual points, namely (q, q) and (q, −1).
   In addition we have 2 orbits of one-dimensional residual cosets (with
K{1} = C2 and K{2} = 1), and finally the principal two-dimensional
one, T .
   Let us now consider R0 = B2 with the lattice X = P and again
q(si) = q for i = 0, 1, 2. We take (α1 /2, α2 ) as a basis for P . Now
R1 = R0 , and thus X = P (R1 ). So again we have 3 orbits of points s
for which the rank of Rs,0 is 2, namely (1, 1), (1, −1) and (−1, 1). Each
corresponds to a (regular) orbit of residual points: (q1/2 , q), (q1/2 , −1),
and (−q1/2 , q).
   In addition there are 3 one-dimensional residual cosets, 2 associated
with P = {1} (with K{1} = 1) and 1 with P = {2} (with K{2} = C2 ).
Finally we have the principal residual coset T .

7.3. Properties of residual and tempered cosets
  In the derivation of the Plancherel formula of the affine Hecke alge-
bra, the following properties of residual cosets will play a crucial role.
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 121

Theorem 7.10. For each residual coset L ⊂ T we have
(7.12)                       iL = codim(L).
In other words, for every inclusion L ⊂ M of residual cosets with
dim(L) = dim(M) − 1, the inequality (7.7) is actually an equality.
Proof. Unfortunately, I have no classification free proof of this fact.
With the classification of residual subspaces at hand it can be checked
on a case-by-case basis. By the previous subsection (Proposition 7.3
and Theorem 7.7) the verification reduces to the case of residual points
for graded affine Hecke algebras. In [18] (cf. Theorem 3.9) this matter
was verified.                                                         

   Theorem 7.10 has important consequences, as we will see later. At
this point we show that the definition of residual cosets can be sim-
plified as a consequence of Theorem 7.10. We begin with a simple
lemma:
Lemma 7.11. Let V be a complex vector space of dimension n, and
suppose that L is the intersection lattice of a set P of linear hyperplanes
in V . Assume that each hyperplane H ∈ P comes with a multiplicity  P
mH ∈ Z, and define the multiplicity mL for L ∈ L by mL :=              mH ,
where the sum is taken over the hyperplanes H ∈ P such that L ⊂ H.
Assume that {0} ∈ L and that m{0} ≥ n. Then there exists a full flag
of subspaces V = V0 ⊃ V1 · · · ⊃ Vn = {0} such that mk := mVk ≥ k.
Proof. We construct the sequence inductively, starting with V0 . Sup-
pose we already constructed the flag up to Vk , with k ≤ n − 2. Let
Pk ⊂ L denote the set of elements of L of dimension n − k − 1 con-
tained in Vk , and let Nk denote the cardinality of Pk . By assumption,
Nk ≥ n − k ≥ 2. Since every H ∈ P either contains Vk or intersects Vk
in an element of Pk , we have
                       X
(7.13)                    (mL − mk ) = mn − mk .
                      L∈Pk

Assume that ∀L ∈ Pk : mL ≤ k. Then, because mk ≥ k and Nk ≥ 2,
(7.14)           mn ≤ kNk + (1 − Nk )mk ≤ k ≤ n − 2,
contradicting the assumption mn ≥ n. Hence there exists a L ∈ Pk
with mL ≥ k + 1, which we can define to be Vk+1 .              

Corollary 7.12. For every coset L ⊂ T one has iL ≤ codim(L), and
L is residual if and only if iL = codim(L).
122                          ERIC M. OPDAM

Proof. Define P to be the (multi-)set of codimension 1 cosets of T
arising as connected components of the following codimension 1 sets:
                                                 1/2
                   L+
                    α,1 := {t ∈ T | α(t) = qα∨ qα∨ /2 }
                                                1/2
                   L+
                    α,2 := {t ∈ T | α(t) = −qα∨ /2 }
(7.15)
                   L−
                    α,1 := {t ∈ T | α(t) = 1}

                   L−
                    α,2 := {t ∈ T | α(t) = −1}

Here α ∈ R0 , and qα∨ /2 = 1 when 2α 6∈ R1 . We give the components
of L+       +                                                    −    −
     α,1 , Lα,1 the index +1, and we give the components of Lα,1 , Lα,1
index −1.
   Suppose that L is any coset of a subtorus T L in T . Then iL is equal
to the sum of the indices the elements of P containing L.
   Assume that iL ≥ codim(L) = k. By Lemma 7.11 there exists a se-
quence L ⊂ Lk−e ⊂ Lk−e−1 · · · ⊂ L0 = T of components of intersections
of elements of P such that iLk−e = iL ≥ k and iLj ≥ j = codim(Lj ) (we
did not assume that L is a component of an intersection of elements in
the multiset P, hence e > 0 may occur). If k(0) is the smallest index
such that iLk(0) > k(0), then Lk(0) is by definition residual, and thus
violates Theorem 7.10. Hence such k(0) does not exist and we conclude
that iLk = k for all k. This proves that e = 0 and that L is residual. 

Remark 7.13. This solves the question raised in Remark 3.11 of [18].
Theorem 7.14.           (i) Let R0 be indecomposable, and let r = c be
         a real residual point in Trs,+ . If ω : Trs → Trs is a homomor-
         phism which acts on the root system R0 by means of a diagram
         automorphism of F0 , then ω(r) = r.
    (ii) Define ∗ : T → T by x(t∗ ) = x(t)−1 . If r = cs ∈ T is a
         residual point, then r ∗ ∈ W (Rs,0 )r.
   (iii) If r = sc is a residual point, then the values α(c) of the roots
         α ∈ R0 on c are in the subgroup of R+ generated by the positive
         square roots of the root labels qα∨ , with α ∈ Rnr .
Proof. (i). If R0 allows a nontrivial diagram automorphism then R0 is
simply laced. So we are in the situation of the Bala-Carter classification
of distinguished weighted Dynkin diagrams. A glance at the tables of
section 5.9 of [10] shows that this fact holds true.
   (ii). This is a consequence of (i), since ∗ : sTrs → sTrs acts on Rs,0
by means of an automorphism (see also [18], Theorem 3.10) which acts
trivially on the set of indecomposable summands of Rs,0 .
   (iii). For this fact I have also no other proof to offer than a case-
by-case checking, using the results of this section and the list of real
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 123

residual points from [18]. The amount of work reduces a lot by the
remark that it is well known in the simply laced cases (see Corollary
8.2 of the appendix Section 8).
   In the classical cases other than Cnaff , it follows from a well known
theorem of Borel and de Siebenthal [8] that the index of Q(Rs,0 ) ⊂ Q
is at most 2. Hence the desired result follows if we verify that for real
residual points of the classical root systems, the values α(c) are in the
subgroup of R+ generated by the root labels, which is direct from the
classification lists in [18].
   For the real points of Cnaff it is also immediate from the above and
(7.8). For nonreal points r = sc we look at (the proof of) Lemma 7.6.
If s has order 2, then Rs,1 is of type Ck + Cn−k . We need to check the
values of the roots en and ek − ek+1 on c in this case. But the roots 2ei
are in Rs,1 , and take rational values in the labels qα∨ (α ∈ Rnr ) on c.
   The real residual points of F4 are all rational in the root labels (see
[18]). Again using the Theorem of Borel and de Siebenthal, we need
to check in addition the nonreal residual points r = sc with Rs,0 =
A2 × A2 ⊂ F4 (generating a lattice of index 3 in Q(F4 )) and Rs,0 =
A3 × A1 ⊂ F4 (index 4). These cases can be checked without difficulty.
   In the case of G2 , there are generically 3 real residual points, two of
which have rational coordinates and one has rational coordinates only
in the square roots of the labels. In addition there are two nonreal
residual points r = sc for G2 , which are easily checked. (We need to
check only the case with Rs,0 = A2 (index 3 in Q(G2 ))).                 

Remark 7.15. In fact the result (ii) of the previous Theorem will also
turn out to be a consequence of Theorem 3.29, in view of Proposition
2.13.
Definition 7.16. Let L be a residual coset, and write L = rL T L with
rL ∈ TL ∩ L. This is determined up to multiplication of rL by elements
of the finite group KL = TL ∩ T L . Write rL = sL cL with sL ∈ TL,u and
cL ∈ TL,rs . We call cL the “center” of L, and we call Ltemp := rL TuL
the tempered compact form of L (both notions are independent of the
choice of rL , since KL ⊂ TuL ). The cosets of the form Ltemp in T will
be called “tempered residual cosets”.

Theorem 7.17. Suppose that L ⊂ M are two residual cosets. Write
L = rL T L = sL cL T L and M = rM T M = sM cM T M as before. If
cL = cM then L = M.
Proof. According to Proposition 3.11, cL = cM ⇔ e ∈ c−1   L TM,rs :=
        temp     temp
ML ⇔ L       ⊂M       . Hence the proof reduces to Remark 3.14 of [18],
124                          ERIC M. OPDAM

or can be proved directly in our setup in the same way, cf. Remark
3.26.                                                           

   Theorem 7.17 shows that a tempered coset can not be a subset of a
strictly larger tempered coset. In fact even more is true:
Theorem 7.18. (Slooten [46] (cf. [45] for the classical cases)) Let L1
and L2 be residual subspaces. If Ltemp
                                  1    ∩ Ltemp
                                          2    6= ∅ then L1 = w(L2 ) for
some w ∈ W0 .
  We will not use this result in this paper, but it is important for
the combinatorial fine structure of the spectrum of C. We note that
the proof of this statement reduces easily to the case of two residual
subspaces (in the sense of [18]) with the same center. This reduces the
statement of the theorem to the problem in Remark 3.12 of [18]. This
problem was solved by Slooten [46].


8. Appendix: Kazhdan-Lusztig parameters
   Let F be a p-adic field. Let G be the group of F -rational points of a
split semisimple algebraic group of adjoint type over F , and let I be an
Iwahori subgroup of G. The centralizer algebra of the representation of
G induced from the trivial representation of I is isomorphic to an affine
Hecke algebra H with “equal labels”, that is, the labels are given as in
Convention 2.1 with q equal to the cardinality of the residue field of F ,
and the exponents fs all equal to 1. Moreover, the lattice X is equal
to the weight lattice of R0 in this case. The Langlands dual group G is
the simply connected semisimple group with root system R0 , and the
torus T can be viewed as a maximal torus in G.
   In this situation Kazhdan and Lusztig [23] have given a complete
classification of the irreducible representations of H, and also of the
tempered and square integrable irreducible representations. Let us
explain the connection with residual cosets explicitly.
   We assume that we are in the “equal label case” in this subsection,
unless stated otherwise. We put k = log(q)/2. Let G be a connected
semisimple group over C, with fixed maximal torus T = Hom(X, C× ).
We make no assumption on the isogeny class of G yet.
Proposition 8.1.        (i) If r is a residual point with polar decom-
       position r = sc = s exp(γ) ∈ Tu Trs and γ dominant, then the
       centralizer Cg(s) of s in g := Lie(G) is a semisimple subalge-
       bra of g of rank equal to rk(g), and γ/k is the weighted Dynkin
       diagram (cf. [10]) of a distinguished nilpotent class of Cg(s).
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 125

     (ii) Conversely, let s ∈ Tu be such that the centralizer algebra
          Cg(s) is semisimple and let e ∈ Cg(s) be a distinguished nilpo-
          tent element. If h denotes the weighted Dynkin diagram of e
          then r = sc with c := exp(kh) is a residual point.
    (iii) The above maps define a 1 − 1 correspondence between W0 -
          orbits of residual points on the one hand, and conjugacy classes
          of pairs (s, e) with s ∈ G semisimple such that Cg(s) is semisim-
          ple, and e a distinguished nilpotent element in Cg(s).
    (iv) Likewise there is a 1 − 1 correspondence between W0 -orbits
          of residual points and conjugacy classes of pairs (s, u) with
          CG (s) semisimple and u a distinguished unipotent element of
          CG (s)0 .
Proof. (i). We already saw in Appendix 7 that the rank of Cg(s) is
indeed maximal. So we are reduced to the case s = 1. Let hqi denote
the group of integer powers of q, and denote by Rq ⊂ R0 the root
subsystem of roots α ∈ R0 such that α(c) ∈ hqi. Now Rq is a root
subsystem of rank equal to rk(R0 ), with the property that ∀α, β ∈ Rq
such that α + β ∈ R0 we have α + β ∈ Rq . Of course, c is a residual
point of Rq . By an elementary result of Borel and De Siebenthal there
exists a finite subgroup Z ⊂ Tu such that Cg(Z) is semisimple with
root system Rq .
  We claim that for every simple root α of Rq we have α(c) = 1 or
α(c) = q. To see this, observe that all the roots α ∈ Rq with α(c) = q
are in the parabolic system obtained from Rq by omitting the simple
roots α such that α(c) = ql with l > 1. If this would be a proper
parabolic subsystem, c would violate Theorem 7.10 in this parabolic.
This proves the claim.
  Define the element h := γ/k. Note that h belongs to 2P (Rq∨) by the
previous remarks. Consider the grading of Rq given by this element,
and define a standard parabolic subalgebra p of Cg(Z) by
                            X              X
                 p := t ⊕            gα =      Cg(Z)(i).
                         {α∈Rq :α(h)≥0}          i≥0

Its nilpotent radical n is
                                    X
                             n :=         Cg(Z)(i),
                                    i≥2

and by the definition of residual points we see that P ⊂ Cg(Z) is a
distinguished parabolic subalgebra (see [10], Corollary 5.8.3.). According
to ([10], Proposition 5.8.8.) we can choose e ∈ n(2) in the Richardson
class associated with p, and f ∈ Cg(Z)(−2), such that (f, h, e) form a
sl2 -triple in Cg(Z). By sl2 representation theory it is now clear that
126                         ERIC M. OPDAM

h ∈ P (R0∨ ). Consider the grading of g and R0 induced by h. By
definition of Z we see that g(0) = Cg(Z)(0) and g(2) = Cg(Z)(2).
Hence e is distinguished in g by ([10], Proposition 5.7.5.), proving the
desired result. Note also that, by ([10], Proposition 5.7.6.), in fact
g(1) = 0, and hence that Rq = R0 .
  (ii). Is immediate from the defining property
                    dim(Cg(s)(0)) = dim(Cg(s)(2))
of the grading with respect to the Dynkin diagram of a distinguished
class.
   (iii). Is clear by the well known 1 − 1 correspondence between dis-
tinguished classes and their Dynkin diagrams.
   (iv). The result follows from the well known 1−1 correspondence be-
tween unipotent classes and nilpotent classes for connected semisimple
groups over C.                                                      

Corollary 8.2. From the proof of Proposition 8.1(i) we see that if
r = sc is a residual point, then α(c) ∈ hq1/2 i for all α ∈ R0 . If s = 1
we have α(c) ∈ hqi for all α ∈ R0 .
   Let M ⊂ T be a residual coset. Write M = rT M ⊂ T ⊂ G with
r ∈ TM as in Proposition 7.3. Let r = sc = s exp(kh/2) be the polar
decomposition of r in TM . Let LM ⊂ G be the Levi subgroup LM :=
CG (T M ) and let L′M denote its semisimple part. By Proposition 7.3
we see that the root system of L′M is RM , TM is a maximal torus of
L′M , and the connected center of LM is T M . Moreover, r ∈ TM is a
residual point with respect to RM . Thus by Proposition 8.1, CL′M (s)
is semisimple, and there exists a distinguished unipotent element u =
exp(e) in CL′M (s)0 such that [h, e] = 2e. This implies that the set
N = Nu of all elements t ∈ G such that
(8.1)                         tut−1 = uq .
is of the form N = rCG (u). The centralizer CG (r, u) = CG (s, c, u) is
known to be maximal reductive in CG (s, u), and it contains T M . Its
intersection with L′M is also reductive but, since u is distinguished in
CL′M (s)0 , the rank of this intersection is 0. Hence L′M ∩ CG (r, u) is
finite. We conclude that T M is a maximal torus in CG (s, u). Let u′
be another unipotent element in G such that M ⊂ N ′ = Nu′ and such
that T M is a maximal torus of CG (s, u′). We see that u′ ∈ CL′M (s)0
is distinguished and associated to the Dynkin diagram h. Hence u′ is
conjugate to u in CL′M (s)0 by an element of CL′M (r). We have shown:
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 127

Proposition 8.3. For each residual coset M = rT M = scT M ⊂ T
there exists a unipotent element u such that tut−1 = uq for all t ∈ M,
and such that T M is a maximal torus of CG (s, u). This u is an element
of CL′M (s) with LM := CG (T M ), and is distinguished in this semisimple
group. It is unique up to conjugation by elements of the reductive group
CL′M (r).
   Let us consider the converse construction. From now in this sub-
section we assume that G is simply connected. We will be interested
in conjugacy classes of pairs (t, u) with t semisimple and u unipotent,
satisfying (8.1). We choose an element (t, u) in the conjugacy class. By
Jacobson-Morozov’s theorem there exists a homomorphism
(8.2)                           φ : SL2 (C) 7→ G
such that                                       
                                           1 1
                                u=φ
                                           0 1
We put
                                                                           
               q1/2  0                         1 0                        0 1
  c := φ            −1/2       , h := dφ                  , e := dφ                 .
                0 q                            0 −1                       0 0
Denote by CG (φ) the centralizer of the image of φ. We have CG (φ) =
CG (dφ), and by sl2 representation theory we see that CG (dφ) = CG (h, e).
Hence CG (φ) = CG (c, u). By [23], Section 2, this is a maximal reductive
subgroup of CG (u), and we can choose φ in such a way that t ∈ cCG (φ).
In this case t commutes with c, and thus t1 := tc−1 ∈ CG (φ) commutes
with c, t, and is semisimple. It follows that CG (t1 , φ) = CG (φ) ∩ CG (t1 )
is reductive in CG (t1 ), and contains t1 in its center. According to [23],
the choice of φ such that t1 ∈ CG (φ) is unique up to conjugation by
elements in CG (t, u).
   By conjugating (t, u) and φ suitably we can arrange that T := (T ∩
CG (t1 , φ))0 is a maximal torus of CG (t1 , φ). Put L = CG (T ), a Levi
group of G. We claim that L is minimal among the Levi groups of
G containing φ and t1 . Indeed, if N would be a strictly smaller Levi
group of G also containing φ and t1 , then its connected center T N would
be a torus contained in CG (t1 , φ) on the one hand, but strictly larger
than T on the other hand. This contradicts the choice of T , proving
the claim. In particular, since the connected center T L of L satisfies
T ⊂ T L ⊂ CG (t1 , φ), we have the equality T = T L .
   Note that maximal tori of L are the maximal tori of G containing
T L, and these are conjugate under the action of L. The derived group
L′ is simply connected, because the cocharacter lattice YL of its torus
TL equals YL = Q(R0∨ ) ∩ QRL∨ = Q(RL∨ ). Hence, by a well known
128                          ERIC M. OPDAM

result of Steinberg, C := CL (t1 ) ⊂ L is connected, and reductive. This
implies that there exist maximal tori of C containing t. Thus there exist
maximal tori of L containing both the commuting semisimple elements
t1 and t. Therefore we may and will assume (after conjugation of (t, u)
and φ by a suitable element of L) that T L and the elements t1 , t are
inside T .
   Both the image of φ and t1 are contained in C. Let C ′ ⊂ L′ denote
its derived group. If the semisimple rank of C would be strictly smaller
than that of L, there would exist a Levi group N such that C ⊂ N $ L,
a contradiction. Hence C ′ has maximal rank in L′ .
   Choose sL in the intersection t1 T L ∩ L′ . By the above, sL is in TL,u ,
the compact form of the maximal torus TL := (L′ ∩ T )0 of L′ . We put
rL = sL c ∈ L′ , and we claim that this is a RL -residual point of TL . By
Proposition 8.1 this is equivalent to showing that u is a distinguished
unipotent element of C ′ = CL′ (sL ). This means that we have to show
that CL′ (sL , φ) does not contain a nontrivial torus. But L = CG (T L)
with T L a maximal torus in CG (t1 , φ). Hence CG (t1 , φ)0 ∩ L = T L , and
thus
(8.3)        CG (sL , φ)0 ∩ L′ = CG (t1 , φ)0 ∩ L′ = TL ∩ T L ,
proving the claim.
  This proves that M := tT L = rL T L ⊂ T is a residual coset, by
application of Proposition 7.4.
  Notice that (8.3) shows that T L is also a maximal torus of CG (sL , φ),
and thus of CG (sL , u).
  Finally notice that the W0 -orbit of the pair (t, M) is uniquely de-
termined by the conjugacy class of (t, u) by the above procedure. We
have shown:
Proposition 8.4. For every pair (t, u) with t semisimple and u unipo-
tent satisfying (8.1), we can find a homomorphism φ as in 8.2 such
that t commutes with c. Let T L be a maximal torus of CG (t1 = tc−1 , u)
and put M = tT L . By suitable conjugation we can arrange that t, c
and M are in T . Then M ⊂ T is a residual coset. If we write t = rtL
with r = sc ∈ TL,u TL,rs and tL ∈ T L , then T L is also a maximal torus
of CG (s, c, u). The W0 -orbit of the pair (t, M) is uniquely determined
by (t, u).
Corollary 8.5. There is a one-to-one correspondence between conju-
gacy classes of pairs (t, u) satisfying (8.1) and W0 -orbits of pairs (t, M)
with M ⊂ T a residual coset, and t ∈ M.
Proof. The maps between these two sets as defined in Proposition 8.3
and Proposition 8.4 are clearly inverse to each other.            
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 129

Remark 8.6. Let (c, u) (with c ∈ Trs ) be a pair satisfying (8.1), with
u a distinguished unipotent element of G. Then u will be distinguished
in CG (s) for each s in the finite group CG (c, u). In particular, CG (s) is
semisimple. Hence s gives rise to a residual point cs′ in T where s′ ∈ T
is conjugate with s in G. This defines a one-to-one correspondence be-
tween the orbits in CG (c, u) with respect to the normalizer NG (CG (c, u))
and the residual points in T with split part c.
  The Kazhdan-Lusztig parameters for irreducible representations of H
consist of triples (t, u, ρ) where (t, u) is as above, and ρ is an irreducible
representation of the finite group
                      A(t, u) = CG (t, u)/(ZG CG (t, u)0 ),
where ZG is the center of G. However, not all the irreducible represen-
tations of A(t, u) arise, but only those representations of A(t, u) which
appear in the natural action of A(t, u) on the homology of the variety
of Borel subgroups of G containing t and u.
   Moreover, Kazhdan and Lusztig show that the irreducible represen-
tation π(t, u, ρ) is tempered if and only if t ∈ M temp , where M is the
residual subspace associated to the pair (t, u). In this way we obtain a
precise geometric description of the set of minimal central idempotents
{ei }li=1
       t
          of the residue algebra Ht for RM -generic t ∈ M temp .


References
 [1] J. Arthur, Eisenstein series and the trace formula, Proc. of Symp. in Pure
     Math., AMS, 33 (1979), pp. 253–254.
 [2] J. Arthur, On elliptic tempered characters, Acta. Math., 171 (1993), pp. 73–
     138.
 [3] J. Arthur, A Paley-Wiener theorem for real reductive groups, Acta. Math. 150
     (1983), pp. 1–89.
 [4] E.P. van den Ban, J. Carmona, P. Delorme, Paquets d’ondes dans l’espace
     de Schwartz d’un espace symétrique réductif, J. Funct. Anal., 139 (1996), pp.
     225–243.
 [5] E.P. van den Ban, H. Schlichtkrull, A residue calculus for root systems, Comp.
     Math. 123, (2000), pp. 27–72,
 [6] E.P. van den Ban, H. Schlichtkrull, Fourier inversion on a reductive symmetric
     space, Acta. Math. 182 (1999), pp. 25–85.
 [7] D. Barbasch, A. Moy, Reduction to real infinitesimal character in affine Hecke
     algebras, Journal of the AMS 6(3) (1993), pp. 611–630.
 [8] A. Borel, J. de Siebenthal, Les sous-groupes fermés de rang maximum des
     groupes de Lie clos Comment. Math. Helv 23 (1949), pp. 200–221.
 [9] R. Bott, An application of the Morse theory to the topology of Lie groups, Bull.
     Soc. Math. France, 84 (1956), 251-282.
130                                ERIC M. OPDAM

[10] R.W. Carter, Finite groups of Lie type Wiley Classics Library, John Wiley and
     sons, Chichester, UK.
[11] W. Casselman, Introduction to the theory of admissible representations of p-
     adic reductive groups, mimeographed notes.
[12] P. Delorme, Espace de coefficients de répresentations admissibles d’un groupe
     réductif p-adique preprint (2003), to appear.
[13] P. Delorme, E.M.Opdam, The Schwartz algebra of an affine Hecke algebra, in
     preparation.
[14] J. Dixmier, Les algèbres d’opérateurs dans l’espace Hilbertien Cahiers scien-
     tifiques, fasc. XXV (1969), Gauthier-Villars, Paris.
[15] J. Dixmier, Les C ∗ -algèbres et leurs representations Cahiers scientifiques, fasc.
     XXIX (1969), Gauthier-Villars, Paris.
[16] J.M.G. Fell, R.S. Doran, Representations of *-Algebras, Locally Compact
     Groups, and Banach *-Algebraic Bundles Pure and Applied Mathematics 125,
     Academic Press.
[17] Harish-Chandra, Automorphic forms on semi-simple Lie groups, LN 62 (1968),
     Springer Verlag.
[18] G.J. Heckman, E.M. Opdam, Yang’s system of particles and Hecke algebras,
     Annals of mathematics 145 (1997), pp. 139–173.
[19] G.J. Heckman, E.M. Opdam, Harmonic analysis for affine Hecke algebras,
     Current Developments in Mathematics (S.-T. Yau, editor), 1996, Intern. Press,
     Boston.
[20] V. Heiermann, Décomposition spectrale et représentations spéciales d’un
     groupe réductif p-adique J. Inst. Math. Jussieu. (to appear).
[21] S.C. Hille, Canonical representations, Thesis University of Leiden (1999).
[22] S. Kato, Irreducibility of principal series representations for Hecke algebras, J.
     Fac. Sci., U. of Tokyo 28 (1982), pp. 929–943.
[23] D. Kazhdan, G. Lusztig, Proof of the Deligne-Langlands conjecture for affine
     Hecke algebras, Invent. Math. 87 (1987), pp. 153–215.
[24] R.P. Langlands, On the functional equations satisfied by Eisenstein series, LN
     544 (1976), Springer Verlag.
[25] G. Lusztig, Some examples of square integrable representations of semisimple
     p-adic groups, T.A.M.S. 277 (1983) no. 2, pp. 623–653.
[26] G. Lusztig, Affine Hecke algebras and their graded version, J. Amer. Math.
     Soc. 2 (1989), no. 3, pp. 599–635.
[27] G. Lusztig, Cuspidal local systems and graded Hecke algebras II, Representa-
     tions of Groups (B. Allison, G. Cliff editors), Conf. proc. Canad. Math. Soc.
     16, Amer. Math. Soc., Providence (1995), pp. 217–275.
[28] G. Lusztig, Classification of unipotent representations of simple p-adic groups,
     IMRS 11 (1995) pp. 517–589.
[29] G. Lusztig, Cuspidal local systems and graded Hecke algebras, III preprint
     RT/0108173 (2001).
[30] G. Lusztig, Left cells in Weyl groups Lecture notes in Mathematics 1024,
     Springer, 1983.
[31] I.G. Macdonald, Spherical functions on a group of p-adic type, Publ. Ramanu-
     jan Institute 2 (1971).
[32] I.G. Macdonald, The Poincare series of a Coxeter group, Math. Ann. 199
     (1972).
   ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 131

[33] I.G. Macdonald, A formal identity for affine root systems, preprint 1997.
[34] H. Matsumoto Analyse harmonique dans les systems de Tits bornologiques de
     type affine, Springer lecture notes 590 (1977).
[35] C. Moeglin, J.-L. Waldspurger, Spectral decomposition and Eisenstein series,
     Cambridge tracts in Mathematics 113, Cambridge University Press.
[36] L. Morris, Tamely ramified intertwining algebras, Invent. Math. 114 (1993),
     pp. 233–274.
[37] E.M. Opdam, A generating formula for the trace of the Iwahori-Hecke algebra,
     Progress in Mathematics 210 (2003), pp. 301–323 (also math.RT/0101006).
[38] A. Ram, J. Ramagge, Affine Hecke algebras, cyclotomic Hecke algebras and
     Clifford theory, preprint, (1999).
[39] M. Reeder, On the Iwahori spherical discrete series of p-adic Chevalley groups;
     formal degrees and L-packets, Ann. Sci. Ec. Norm. Sup. 27 (1994), pp. 463–491.
[40] M. Reeder, Formal degrees and L-packets of unipotent discrete series of excep-
     tional p-adic groups, with an appendix by Frank Lübeck, J. reine angew. Math.
     520 (2000), pp. 37–93.
[41] M. Reeder, Isogenies of Hecke algebras and Langlands correspondence for ram-
     ified principal series representations, Representation Theory 6 (2002), pp. 101–
     126.
[42] P. Schneider, U. Stuhler, Representation theory and sheaves on the Bruhat-Tits
     building Publ I.H.E.S. 85 (1997), pp. 97–191.
[43] L. Schwartz, Théorie des distributions I, Hermann, Paris.
[44] T. Shoji, On the Springer correspondents of the Weyl groups of classical alge-
     braic groups, Comm. in Alg. 7 (1979), no. 16, 1713-1745; correction on 2027-
     2033.
[45] K. Slooten, A combinatorial generalization of the Springer correspondence for
     classical type, Thesis, Universiteit van Amsterdam, 2003.
[46] K. Slooten, private communication.
[47] R. Steinberg, Endomorphisms of linear algebraic groups, Mem. Amer. Math.
     Soc. 80 (1968).
[48] R. Steinberg, On a theorem of Pittie, Topologie 14 (1975), pp. 173–177.
[49] J.L. Waldspurger, La formule de Plancherel d’après Harish-Chandra Journal
     de l’Institut de Mathematiques de Jussieu 2 (2003).
[50] A.J. Wassermann, Une démonstration de la conjecture de Connes-Kasparov
     pour les groupes de Lie linéaires connexes réductifs, C.R. Acad. Sc. Paris 304
     No. 18 (1987), pp. 559-562.
[51] A.J. Wassermann, Cyclic cohomology of algebras of smooth functions on orb-
     ifolds, In: Operator Algebras and Applications 1, Lond. Math. Soc. Lect. Note
     Series 136 (1988), pp. 229–251.
Index
(·, ·)                                         ΛRP ,WP r = Λγ , triples in Λ with γ =
   inner product on H, 13                             (RP , WP r) ∈ Γ fixed, 81
   inner product on Pol(End(V(K\Ξ) )),         Λgen
                                                  γ , triples in Λγ with rt RP -generic,
       90                                             81
(x, y)t = χt (x∗ y), semi-definite Her-        Ξ = Λ ×Γ ∆, 26–27, 84
       mitian form on Ht , 73                  Ξgen = Λgen ×Γ ∆, 85
k · ko , operator norm on H, 14                Σ, quotient space of Λ for the action
♯, the ∗-operator of HL , 75                          of W, 83
f → f , average of a section of End(VΞ ),      Ψ, left action of W on ∆, 83
       89                                      Ψg : ∆RL ,WL rL → ∆RM ,WM rM       ′ , bijec-

∗                                                     tion induced by ψg , 74, 83
   h → h∗ , conjugate linear anti-involution   Ω, length 0 elements in W , 10
       of H, 13                                Ωf = Ω/ZX , 10
   t → t∗ , anti-holomorphic involution        γL ∈ t, logarithm of cL , 31
       on T , 44, 120                          δ̃g : Vδ → VΨg (δ) , unitary isomorphism
h·, ·i                                                intertwining δ ◦ ψg and Ψg (δ), 84
   rational inner product on X,Y , 9,          θx , basis elements of A, 15
       31
                                               ιs , intertwining element of H, 58
   Euclidean inner product on Trs , 41
                                               ι0w , normalized intertwining element
   inner product on Vπ , 66
                                                      of F H, 59        R
1P , idempotent in Aan (U ), with sup-
                                               κL , rational number ξL ωL , 49
       port UP , 64
                                               κRL ,{rL } , see also κL
1̟ , idempotent in Aan (U ) with sup-
       port U̟ , 63                            κWL L , rational factor in νL ; average
Γ, set of all pairs (RP , WP r) with P ∈              of κL , 23–24, 49
       P and WP r an orbit of residual         κW0 r (=κR,W0 r ), rational factor in ν({r}),
       points in TP , 81                              23–24, 51, see also κWL L
Γa , complete set of representatives of        λδ (= λR,δ ) := κW0 r | W0 r | dδ , con-
       the association classes in Γ, 83               stant factor in µP l ({δ}), δ ∈ ∆W0 r ,
∆, Weyl denominator, 29                               27–28
∆ = ∪γ∈Γ ∆γ , 83                               λ(h), left multiplication by h ∈ H, 13
∆γ , fiber at γ ∈ Γ of the surjection          µP l , Plancherel measure on Ĉ, 22, 26,
       ∆ → Γ, 83                                      89
∆P , fiber at P ∈ P of the surjection          ν, Plancherel measure of Z on W0 \T ,
       ∆ → P, 83                                      23–24, 46
∆R,W0 r , irreducible discrete series rep-     νL , smooth measure
                                                                P         on Ltemp such
       resentations of H(R, q) with cen-              that ν = L νL , 23–24, 48
       tral character W0 r, 25–26, 55          νc = Y1c , positive W0 -invariant mea-
∆R (=∆R,q ), irreducible discrete se-                 sure on T , 46
       ries of H(R, q), 55                     ξL , compact cycle in BL (rL , δ)\∪m∈ML
∆̟1 ,̟2 : H̟,an (U̟ ) → 1̟1 Han (U )1̟2 ,             Lm , 36
       linear isomorphisms, 63, 74             π, induction functor on WΞ , 85
Λ, disjoint union of all triples of the        π(RP , WP r, δ, t) = IndH   HP (δt ), parabol-
       form {(RP , WP r, t)}, 81                      ically induced representation, 25–
Λgen = ∪Λgen  γ , 81                                  26, 66
                                         132
    ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 133

[π(ξ)], class of π(ξ) modulo equiva-             C ∞ (VΞ ) = C ∞ (Ξ) ⊗ VΞ , 87
      lence, 85                                  C ∞ (Ξ), space of C ∞ -functions on Ξ,
π an , π extended to Han , 59                          87
πUan
     , π extended to Han (U ), 60                C, the reduced C ∗ algebra of H, 14
ρ(h), right multiplication by h ∈ H,             C′ , dual of C as topological vector space,
      13                                               15
τ , trace functional of H, 13                    Ĉ, dual (spectrum) of C, 16
φt : HP → HP , surjective homomor-               ĈO , component of Ĉ, the closure of
      phism, 65                                        [π](W (O)\Ogen ) ⊂ Ĉ, 90, 104–
χδ , character of δ, 56                                106
χt , local trace of H, sum (over c) of           c = c(t, q), Macdonald’s c-function,
      densities d(Yhc )/dν at t, 24–26,                29
      46                                         cα , rank one c-function, 29
χRL ,WL rL ,δ,tL , character of the induced      cL , center of L, 31, 122
      representation π(RL , WL rL , δ, tL ),
      25–26, 69                                  Dω , minus the divisor of ω on T , 30
χt,i , irreducible character of Ht , 47,         dδ (= dR,δ ), residual degree; degree of
      56                                               δ in the residual Hilbert algebra
ψg : HL → HM , isomorphism for g ∈                     Hr , 25–26, 56
      KM × W (FL , FM ), 74, 83                  dt,i (= dW0 t,i ), residual degree; degree
            dt
ω = c(t,q)c(t  −1 ,q) , (n, 0)-form on T , 28,         of χt,i in Ht , 47, see also dδ , 56
      114                                        dt, holomorphic extension of Haar mea-
                                                       sure on Tu , 28
A(n, RL , WL rL , δ, tL ), unitary inter-        dL t (dL t), holomorphic extension of
     twining operator (n ∈ W (FL , FM )),              normalized Haar measure on TuL
     79                                                (TL,u ), 32
A, abelian subalgebra of H, 15
F A := F ⊗Z A, F field of fractions of           Et , Eisenstein functional, 30
     Z, 58                                       EtL , Eisenstein functional of HL , 68
Aan (U ) := Z an (U )⊗Z A, ring of holo-         EL,tL , Eisenstein functional of HL , 68
     morphic functions on U ⊂ T , 59             eO ∈ S, central idempotent associ-
Ame (U ) := F me (U ) ⊗Z A, ring of                    ated with O, 104
     meromorphic functions on U ⊂                e̟ , image of 1̟ in Ht , 74
     T , 60                                      ei , minimal central idempotent of Ht ,
a = (α∨ , k), affine root, 9                           47

B(H), bounded linear operators on H,             F aff , affine simple roots, 9
     13                                          F0 ⊂ R0 , simple roots of R0 , 9
 L
Brs               L
    (δ), ball in Trs , radius δ and center       F me (U ), quotient field of Z an (U ), 60
     e, 36                                       FH , Fourier transform on H, 26–27,
BL (rL , δ), ball in TL , center rL and                 87
     radius δ, 36                                F A,   field of fractions of A, 29
                                                 fs = logq (q(s)), 12
C ω , set of centers of ω-residual cosets,
       31                                        H, affine Hecke algebra, 13
C qu , centers of quasi-residual cosets,         H∗ , algebraic dual of H, 15
       42                                        H0 = H(W0 , q |S0 ) ⊂ H, 15
  qu
C−   , quasi-residual centers in Trs,− ,         Hre , Hermitian (or real) elements in
       43                                             H, 18
134                                 ERIC M. OPDAM

H+ , positive elements in H, 18                 m : Σgen → S gen := m(Λgen ) ⊂ S,
HP = H(RP , q P ), parabolic subalge-               homeomorphism, 83
     bra of H, 25–26, 64                       mL , quotient mL /kL νRL ,{rL } ({rL }),
HL := H(RL , qL ), semisimple quo-                  23–24, 50
     tient of HL , 25–26, 68                   mL , density function of νL /κWL L , 23–
H (U ) := F me (U ) ⊗Z H, localized
  me
                                                    24, 48
     Hecke algebra with meromorphic            m{r} (=mR,{r} ), see also mL
     coefficients, 60
F H := F ⊗Z H, F field of fractions of
                                               Nw , normalized basis elements of H,
     Z, 58                                          13
Han (U ) := Z an (U ) ⊗Z H, the Hecke          NW0 (WP ), normalizer of WP in W0 ,
     algebra with coefficients in Z an (U ),        81
     59                                        N , norm function on W , 10
H̟ , cross product of HP (̟) by W (̟),         N, von Neumann algebra completion
     62                                             of H, 14
Ht = H/It H, where It is the maxi-             nα , numerator of cα , 59
     mal ideal of W0 t in Z, 68
                                               O, orbit of twists of cuspidal repre-
Ht , residual Hilbert algebra at t, 47
                                                    sentations, 88
Ĥ, space of irreducible ∗-representations
                                               Õ, connected component of Ξ, 26–27,
     of H, 16
                                                    86
H, Hilbert completion of H, 13
                                               P , weight lattice, 10
i(Vδ ) = H(W P ) ⊗ Vδ if δ ∈ ∆P , 87
                                               P (̟) = P (t), basis of simple roots in
iL , pole order along L, 30
                                                     RP (t),+ where ̟ = WP (t) t, 61
jǫ : Hme (U ) 7→ Hqme
                    ǫ (Uǫ ), “scaling”
                                               P, power set of F0 , 81
     isomorphism of localized Hecke            pz : Ĉ → Spec(Z), projection, 17
     algebras, 94                              Pol(Ξ), space of Laurent polynomials
                                                     on Ξ, 87
KL , finite abelian group TL ∩ T L , 31        Pol(End(VO )), polynomial sections in
Kδ ⊂ KP , isotropy subgroup of [δ] ∈                 fiber bundle End(VO ), 88
      [∆P ], 88                                Pol(End(VΞ ))W , space of WΞ -equivariant
K, normal subgroupoid of W, 87                       sections in Pol(End(VΞ )), 87
kL , order of KL , 32                          Pol(End(V(K\Ξ) )), polynomial sections
                                                     in fiber bundle End(V(K\Ξ) ), 88
Ltemp , tempered residual coset, 23–           Pol(VΞ ) = Pol(Ξ) ⊗ VΞ , 87
      24, 31, 122
L(L), intersection of TL with residual         Q, root lattice, 9
      cosets ⊃ L, 40                           q, base for the labels q(s), 12
LL , real projections of residual cosets       q, l-multiplicative function on W , 11
      ⊃ L, 40                                  q L , restriction of q to RL , 12
LL , dual configuration of LL , 40             qL , restriction of q to RL , 12
Lω , collection of ω-residual cosets, 30       qa , affine root label, 12
Lqu , collection of quasi-residual cosets,     qα∨ , label for α∨ ∈ Rnr ∨
                                                                          , 12
      42                                       Quasi residual coset, 42
l, length function on W , 10
Length multiplicative function, 11             R, root datum, 9
                                               RL , root datum associated to L, 11
m                                              RL , semisimple root datum associated
    m : Λ → S ⊂ W0 \T , projection, 81              to L, 11
    ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 135

R0 ⊂ X, reduced integral root sys-           Tw , basis elements of H, 13
       tem, 9                                t, Lie algebra Lie(Trs ) = R ⊗ Y , 9
R0∨ ⊂ Y , coroot system, 9                   Tempered coset, 23–24
RP ⊂ R0 , parabolic subsystem, root
       system of RP , 11                     UP , certain WP -invariant open set in
R1 , system of long roots in Rnr , 12             T , 64
Rs,0 (Rs,1 ), roots of R0 (R1 ) vanish-
       ing in s ∈ T , 117                    (VP , πP ), representation of HP with
Rnr , non reduced root system, 12                 VP = 1P V , 65
Raff , affine root system, 9                 VÕ = Õδ × i(Vδ ), trivial fiber bundle
R±aff
      , positive (negative) affine roots,         over Õ = Õδ , 87
       10                                    VO := Õδ ×Kδ i(Vδ ), 88
RP (t) = RP (̟) ⊂ R0 , parabolic sub-        VΞ , trivial fiber bundle over Ξ, 87
       system associated with t ∈ ̟ ⊂
       T , 61                                W , affine Weyl group, 9
rL , element of L ∩ TL , 23–24, 31           W0 , Weyl group of R0 , 9
Ratreg (Õ), rational functions on Õ,       W aff = W0 ⋉ Q ⊂ W , 9
       regular in an open neighborhood       Wt , stabilizer in W0 of t ∈ T , 16
       of Õ ≃ TuP ⊂ T P , 87                WP , Weyl group of RP , parabolic sub-
Rat (VΞ ) = Ratreg (Ξ) ⊗ VΞ , 87
     reg                                           group W0 , 11
Ratreg (Ξ), regular rational functions       WP (t) = W (RP (t) ), parabolic subgroup
       on Ξ, 87                                    associated with t ∈ T , 62
RepU (H), category of finite dimen-          W P = W0 /WP , set of left cosets wWP .
       sional representations of H whose           If P ⊂ F0 , identified with short-
       Z-spectrum is contained in U , 60           est length representatives, 11
Residual coset, 23–24                        W̟ , stabilizer in W0 of ̟ = WP (t) t,
                                                   62
S ⊂ W0 \T , image of pz , 17, 23–24          W (̟) = {w ∈ W̟ | w(P (̟)) =
S aff , simple reflections of W aff , 9            P (̟)}, complement of WP (̟) in
S0 , simple reflections of W0 , 9                  W̟ , 62
Sc , support of Xc , 31                      W (P, Q) = {w ∈ W0 | w(P ) = Q},
Scqu , support of Xhc , 42                         with P, Q ⊂ F0 , 74
S, the Schwartz completion of H, 103         W (P ) for the stabilizer in W0 of P ⊂
sα , reflection in α, 9                            F0 , 74
sa , affine reflection in a, 9               W (O1 , O2 ) = {n ∈ W (P1 , P2 ) | ∃k ∈
                                                   KP2 : (k × n) ∈ W(δ1 , δ2 )}, 26–
T = HomZ (X, C× ), complex algebraic               27, 88
      torus, 16                              W (O) = W (O, O), 26–27, 88
T L ⊂ T , algebraic subtorus of which        W, groupoid whose set of objects is
      L is a coset, 31                             P, with morphisms HomW (P, Q) =
TL ⊂ T , algebraic subtorus orthogo-               W(P, Q) := KQ × W (P, Q), 26–
      nal to L, 31                                 27, 82
Trs = Hom(X, R×    + ), real split form of   W(P, Q) = HomW (P, Q), 82
      T , 28                                 W(P ) = W(P, P ), 82
Trs,− , negative chamber in Trs , 28         W(γ) = {g ∈ W | gγ = γ}, 83
  −
Trs , anti-dual of the positive chamber      WΞ := W ×P Ξ, groupoid of standard
      Trs,+ , 55                                   induction data, 84
Tu = Hom(X, S 1 ), compact form of           w0 , longest element of W0 , 16
      T , 28                                 wP , longest element of WP , 75
136                                ERIC M. OPDAM

wP , longest element of W P , 76

X, Y , lattices, 9
XL ⊃ RL , lattice of RL , character
      lattice of TL , 11, 31
X L , character lattice of T L , 31
X + ⊂ X, dominant cone,R10
Xc , local contribution to t0 Tu aω, 32
                       R
XL , contribution to t0 Tu aω supported
      on Ltemp , 36
 h
Xc , local contribution to a → τ (ah)
      at c, 42
          ∨
YL ⊃ RL     , lattice of RL , cocharacter
      lattice of TL , 11
Yhc , symmetrized local contribution to
      a → τ (ah) at c, 43

ZX , length 0 translations in W , 10
Z, the center of H, 15
Z, closure of Z in C, 17
Z an (U ), ring of W0 -invariant holomor-
      phic functions on U ⊂ T , 59
Z, the center of N, 23
  ON THE SPECTRAL DECOMPOSITION OF AFFINE HECKE ALGEBRAS 137

  Korteweg-De Vries Institute for Mathematics, Universiteit van Am-
sterdam, Plantage Muidergracht 24, 1018 TV Amsterdam, The Nether-
lands.
  E-mail address: opdam@science.uva.nl
