arXiv:math/0508003v3 [math.RT] 8 May 2006




                                                        Representations of Shifted Yangians
                                                                       and
                                                                Finite W -algebras

                                                            Jonathan Brundan and Alexander Kleshchev
                                                                         Department of Mathematics
                                                                            University of Oregon
                                                                             Eugene OR 97403
                                                                                    USA


                                                                                   Abstract
                                            We study highest weight representations of shifted Yangians over an algebraically
                                            closed field of characteristic 0. In particular, we classify the finite dimensional irre-
                                            ducible representations and explain how to compute their Gelfand-Tsetlin charac-
                                            ters in terms of known characters of standard modules and certain Kazhdan-Lusztig
                                            polynomials. Our approach exploits the relationship between shifted Yangians and
                                            the finite W -algebras associated to nilpotent orbits in general linear Lie algebras.


                                                                                  Contents
                                                       1. Introduction                                                1
                                                       2. Shifted Yangians                                            9
                                                       3. Finite W -algebras                                         23
                                                       4. Dual canonical bases                                       35
                                                       5. Highest weight theory                                      47
                                                       6. Verma modules                                              53
                                                       7. Standard modules                                           67
                                                       8. Character formulae                                         81
                                                       References                                                   105


                                                                            Acknowledgements
                                            Part of this research was carried out during a stay by the first author at the (ex-)
                                            Institut Girard Desargues, Université Lyon I in Spring 2004. He would like to thank
                                            Meinolf Geck and the other members of the institute for their hospitality during
                                            this time.
                                            This research was supported in part by NSF grant no. DMS-0139019.

                                                                                        i
                                       CHAPTER 1


                                   Introduction

      Following work of Premet, there has been renewed interest recently in the rep-
resentation theory of certain algebras that are associated to nilpotent orbits in
complex semisimple Lie algebras. We refer to these algebras as finite W -algebras.
They should be viewed as analogues of universal enveloping algebras for the Slodowy
slice through the nilpotent orbit in question. Actually, in the special cases consid-
ered in this article, the definition of these algebras first appeared in 1979 in the
Ph.D. thesis of Lynch [Ly], extending the celebrated work of Kostant [Ko2] treat-
ing regular nilpotent orbits. However, despite quite a lot of attention by a number
of authors since then, see e.g. [Ka, M, Ma, BT, VD, GG, P1, P2, DK], there
is still surprisingly little concrete information about the representation theory of
these algebras to be found in the literature. The goal in this article is to undertake
a thorough study of finite dimensional representations of the finite W -algebras as-
sociated to nilpotent orbits in the Lie algebra glN (C). We are able to make progress
in this case thanks largely to the relationship between finite W -algebras and shifted
Yangians first noticed in [RS, BR] and developed in full generality in [BK5].
      Fix for the remainder of the introduction a partition λ = (p1 ≤ · · · ≤ pn ) of
N . We draw the Young diagram of λ in a slightly unconventional way, so that
there are pi boxes in the ith row, numbering rows 1, . . . , n from top to bottom in
order of increasing length. Also number the non-empty columns of this diagram
by 1, . . . , l from left to right, and let qi denote the number of boxes in the ith
column, so λ′ = (q1 ≥ · · · ≥ ql ) is the transpose partition to λ. For example, if
(p1 , p2 , p3 ) = (2, 3, 4) then the Young diagram of λ is
                                         1 4
                                         2 5 7
                                         3 6 8 9
and (q1 , q2 , q3 , q4 ) = (3, 3, 2, 1). We number the boxes of the diagram by 1, 2, . . . , N
down columns from left to right, and let row(i) and col(i) denote the row and
column numbers of the ith box.
     WritingP   ei,j for the ij-matrix unit in the Lie algebra g = glN (C), let e denote
the matrix i,j ei,j summing over all 1 ≤ i, j ≤ N such that row(i) = row(j) and
col(i) = col(j) − 1. This is a nilpotent matrix of Jordan type λ. For instance,   L if λ is
as above, then e = e1,4 +e2,5 +e5,7 +e3,6 +e6,8 +e8,9 . Define a Z-grading g = j∈Z gj
of the Lie algebra g by declaring that each ei,j is of degree (col(j) − col(i)). This
is a good grading for e ∈ g1 in the sense of [KRW] (see also [EK] for the full
classification). However, it is not the usual Dynkin grading arising from an sl2 -
triple unless all the parts of λ are equal. Actually, in the main body of the article,
we work with more general good gradings than the one described here, replacing
the Young diagram of λ with a more general diagram called a pyramid and denoted
                                              1
2                                     1. INTRODUCTION


by the symbol π; see §3.1. When the pyramid π is left-justified, it coincides with the
Young diagram of λ. We have chosen to focus just on this case in the introduction,
since it plays a distinguished role in the theory.
    Now we give a formal definition of the finite
                                               L W -algebra W (λ) associated to this
data. Let p denote the parabolic subalgebra j≥0 gj of g with Levi factor h = g0 ,
                                            L
and let m denote the opposite nilradical       j<0 gj . Taking the trace form with e
defines a one dimensional representation χ : m → C. Let Iχ be the two-sided ideal
of the universal enveloping algebra U (m) generated by ker χ. Let η : U (p) → U (p)
be the automorphism mapping ei,j 7→ ei,j + δi,j (n − qcol(j) − qcol(j)+1 − · · · − ql ) for
each ei,j ∈ p. Then, by our definition, W (λ) is the following subalgebra of U (p):
                W (λ) = {u ∈ U (p) | [x, η(u)] ∈ U (g)Iχ for all x ∈ m};
see §3.2. The twist by the automorphism η here is unconventional but quite conve-
nient later on; it is analogous to “shifting by ρ” in the definition of Harish-Chandra
homomorphism. For examples, if the Young diagram of λ consists of a single col-
umn and e is the zero matrix, W (λ) coincides with the entire universal enveloping
algebra U (g). At the other extreme, if the Young diagram of λ consists of a single
row and e is a regular nilpotent element, the work of Kostant [Ko2] shows that
W (λ) is isomorphic to the center of U (g), in particular it is commutative.
    For u ∈ W (λ), right multiplication by η(u) leaves U (g)Iχ invariant, so induces
a well-defined right action of u on the generalized Gelfand-Graev representation
                         Qχ = U (g)/U (g)Iχ = ∼ U (g) ⊗U(m) Cχ .
This makes Qχ into a (U (g), W (λ))-bimodule. The associated algebra homomor-
phism W (λ) → EndU(g) (Qχ )op is actually an isomorphism, giving an alternate
definition of W (λ) as an endomorphism algebra.
      Another useful construction involves the homomorphism ξ : U (p) → U (h)
induced by the natural projection p ։ h. The restriction of ξ to W (λ) defines an
injective algebra homomorphism W (λ) ֒→ U (h) which we call the Miura transform;
see §3.6. To explain its signigicance, we note that h = glq1 (C)⊕· · ·⊕glql (C), so U (h)
is naturally identified with the tensor product U (glq1 (C)) ⊗ · · · ⊗ U (glql (C)). Given
glqi (C)-modules Mi for each i = 1, . . . , l, the outer tensor product M1 ⊠ · · · ⊠ Ml
is therefore a U (h)-module in the natural way. Hence, via the Miura transform,
M1 ⊠ · · · ⊠ Ml is a W (λ)-module too. This construction plays the role of tensor
product in the representation theory of W (λ).
      Next we want to recall the connection between W (λ) and shifted Yangians. Let
σ be the upper triangular n × n matrix with ij-entry (pj − pi ) for i ≤ j. The shifted
Yangian Yn (σ) associated to σ is the associative algebra over C with generators
   (r)                      (r)                                    (r)
Di (1 ≤ i ≤ n, r > 0), Ei (1 ≤ i < n, r > pi+1 − pi ) and Fi (1 ≤ i < n, r > 0)
subject to certain relations recorded explicitly in §2.1. In the case that σ is the
zero matrix, i.e. all parts of λ are equal, Yn (σ) is precisely the usual Yangian Yn
associated to the Lie algebra gln (C) and the defining relations are a variation on
the Drinfeld presentation of [D]; see [BK4]. In general, the presentation of Yn (σ) is
adapted to its natural triangular decomposition, allowing us to study representations
in terms of highest weight theory. In particular, the subalgebra generated by all
                (r)
the elements Di is a maximal commutative subalgebra which we call the Gelfand-
Tsetlin subalgebra. We often work with the generating functions
                                (1)         (2)
                Di (u) = 1 + Di u−1 + Di u−2 + · · · ∈ Yn (σ)[[u−1 ]].
                                    1. INTRODUCTION                                     3


The main result of [BK5] shows that the finite W -algebra W (λ) is isomorphic to
                                                                    (r)
the quotient of Yn (σ) by the two-sided ideal generated by all D1 (r > p1 ). The
precise identification of W (λ) with this quotient is described in §3.4. Also in §3.6,
we explain how the tensor product construction outlined in the previous paragraph
is induced by the comultiplication of the Hopf algebra Yn .
     We are ready to describe the first results about representation theory. We call a
                                                                                   (r)
vector v in a Yn (σ)-module M a highest weight vector if it is annihilated by all Ei
             (r)
and each Di acts on v by a scalar. A critical point is that if v is a highest weight
vector in a W (λ)-module, viewed as a Yn (σ)-module via the map Yn (σ) ։ W (λ),
                 (r)
then in fact Di v = 0 for all r > pi . This is obvious for i = 1, since the image
     (r)
of D1 in W (λ) is zero by the definition of the map for all r > p1 . For i > 1, it
follows from the following fundamental result proved in §3.7: for any i and r > pi ,
                 (r)
the image of Di in W (λ) is congruent to zero modulo the left ideal generated by
      (s)
all Ej . Hence, if v is a highest weight vector in a W (λ)-module, then there exist
scalars (ai,j )1≤i≤n,1≤j≤pi such that
                            up1 D1 (u)v = (u + a1,1 )(u + a1,2 ) · · · (u + a1,p1 )v,
                 (u − 1)p2 D2 (u − 1)v = (u + a2,1 )(u + a2,2 ) · · · (u + a2,p2 )v,
                                           ..
                                            .
       (u − n + 1)pn Dn (u − n + 1)v = (u + an,1 )(u + an,2 ) · · · (u + an,pn )v.
Let A be the λ-tableau obtained by writing the scalars ai,1 , . . . , ai,pi into the boxes
on the ith row of the Young diagram of λ. In this way, the highest weights that can
arise in W (λ)-modules are parametrized by the set Row(λ) of row symmetrized λ-
tableaux, i.e. tableaux of shape λ with entries from C viewed up to row equivalence.
Conversely, given any row symmetrized λ-tableau A ∈ Row(λ), there exists a (non-
zero) universal highest weight module M (A) generated by such a highest weight
vector; see §6.1. We call M (A) the generalized Verma module of type A. By familiar
arguments, M (A) has a unique irreducible quotient L(A), and then the modules
{L(A) | A ∈ Row(λ)} give all irreducible highest weight modules for W (λ) up to
isomorphism.
     There is a natural abelian category M(λ) which is an analogue of the BGG cat-
egory O for the algebra W (λ); see §7.5. (Actually, M(λ) is more like the category
O∞ obtained by weakening the hypothesis that a Cartan subalgebra acts semisim-
ply in the usual definition of O.) All objects in M(λ) are of finite length, and the
simple objects are precisely the irreducible highest weight modules, hence the iso-
morphism classes {[L(A)]|A ∈ Row(λ)} give a canonical basis for the Grothendieck
group [M(λ)] of the category M(λ). The generalized Verma modules belong to
M(λ) too, and it is natural to consider the composition multiplicities [M (A) : L(B)]
for A, B ∈ Row(λ). We will formulate a precise combinatorial conjecture for these,
in the spirit of the Kazhdan-Lusztig conjecture, later on in the introduction. For
now, we just record the following basic result about the structure of Verma modules;
see §6.3. For the statement, let ≤ denote the Bruhat ordering on row symmetrized
λ-tableaux; see §4.1.
4                                       1. INTRODUCTION


    Theorem A (Linkage principle). For A, B ∈ Row(λ), the composition
multiplicity [M (A) : L(A)] is equal to 1, and [M (A) : L(B)] 6= 0 if and only if
B ≤ A in the Bruhat ordering.
    Hence, {[M (A)] | A ∈ Row(λ)} is another natural basis for the Grothendieck
group [M(λ)]. We want to say a few words about the proof of Theorem A, since it
involves an interesting technique. Modules in the category M(λ) possess Gelfand-
Tsetlin characters; see §5.2. This is a formal notion that keeps track of the di-
mensions of the generalized weight space decomposition of a module with respect
to the Gelfand-Tsetlin subalgebra of Yn (σ), similar in spirit to the q-characters of
Frenkel and Reshetikhin [FR]. The map sending a module to its Gelfand-Tsetlin
character induces an embedding of the Grothendieck group [M(λ)] into a certain
                                                     ±1
completion of the ring of Laurent polynomials Z[yi,a     | i = 1, . . . , n, a ∈ C], for in-
determinates yi,a . The key step in our proof of Theorem A is the computation of
the Gelfand-Tsetlin character of the Verma module M (A) itself; see §6.2 for the
                                                                                       ±1
precise statement. In general, ch M (A) is an infinite sum of monomials in the yi,a       ’s
involving both positive and negative powers, but the highest weight vector of M (A)
contributes just the positive monomial
           y1,a1,1 . . . y1,a1,p1 × y2,a2,1 . . . y2,a2,p2 × · · · × yn,an,1 . . . yn,an,pn ,
where ai,1 , . . . , ai,pi are the entries in the ith row of A as above. The highest weight
vector of any composition factor contributes a similar such positive monomial. So
by analyzing the positive monomials appearing in the formula for ch M (A), we get
information about the possible L(B)’s that can be composition factors of M (A).
The Bruhat ordering on tableaux emerges naturally out of these considerations.
      Another important property of Verma modules has to do with tensor products.
Let A ∈ Row(λ) be a row symmetrized λ-tableau. Pick any representative for it and
let Ai denote the ith column of this representative with entries ai,1 , . . . , ai,qi read
from top to bottom. Let M (Ai ) denote the usual Verma module for the Lie algebra
glqi (C) generated by a highest weight vector v+ annihilated by all strictly upper
triangular matrices and on which ej,j acts as the scalar (ai,j + n− qi + j − 1) for each
j = 1, . . . , qi . Via the Miura transform, the tensor product M (A1 ) ⊠ · · · ⊠ M (Al )
is then naturally a W (λ)-module as explained above, and the vector v+ ⊗ · · · ⊗ v+
is a highest weight vector in this tensor product of type A. In fact, our formula for
the Gelfand-Tsetlin character of M (A) implies that
                             [M (A)] = [M (A1 ) ⊠ · · · ⊠ M (Al )],
equality in the Grothendieck group [M(λ)]. The first part of the next theorem,
proved in §6.4, is a consequence of this equality; the second part is an application
of [FO].
    Theorem B (Structure of center). Identifying W (λ) with the endomor-
phism algebra of Qχ , the natural multiplication map ψ : Z(U (g)) → EndU(g) (Qχ )
defines an algebra isomorphism between the center of U (g) and the center of W (λ).
Moreover, W (λ) is free as a module over its center.
     Now we switch our attention to finite dimensional W (λ)-modules. Let F (λ)
denote the category of all finite dimensional W (λ)-module, viewed as a subcategory
of the category M(λ). The problem of classifying all finite dimensional irreducible
                                    1. INTRODUCTION                                       5


W (λ)-modules reduces to determining precisely which A ∈ Row(λ) have the prop-
erty that L(A) is finite dimensional. To formulate the final result, we need one
more definition. Call a λ-tableau A with entries in C column strict if in every col-
umn the entries belong to the same coset of C modulo Z and are strictly increasing
from bottom to top. Let Col(λ) denote the set of all such column strict λ-tableaux.
There is an obvious map
                               R : Col(λ) → Row(λ)
mapping a λ-tableau to its row equivalence class. Let Dom(λ) denote the image of
this map, the set of all dominant row symmetrized λ-tableaux.
    Theorem C (Finite dimensional irreducible representations).                 For
A ∈ Row(λ), the irreducible highest weight module L(A) is finite dimensional if and
only if A is dominant. Hence, the modules {L(A) | A ∈ Dom(λ)} form a complete
set of pairwise non-isomorphic finite dimensional irreducible W (λ)-modules.
    To prove this, there are two steps: one needs to show first that each L(A) with
A ∈ Dom(λ) is finite dimensional, and second that all other L(A)’s are infinite
dimensional. Let us explain the argument for the first step. Given A ∈ Col(λ),
let Ai be its ith column and define L(Ai ) to be the unique irreducible quotient
of the Verma module M (Ai ) introduced above. Because A is column strict, each
L(Ai ) is a finite dimensional irreducible glqi (C)-module. Hence we obtain a finite
dimensional W (λ)-module
                             V (A) = L(A1 ) ⊠ · · · ⊠ L(Al ),
which we call the standard module corresponding to A ∈ Col(λ). It contains an
obvious highest weight vector of type equal to the row equivalence class of A. This
simple construction is enough to finish the first step of the proof. The second step is
actually much harder, and is an extension of the proof due to Tarasov [T1, T2] and
Drinfeld [D] of the classification of finite dimensional irreducible representations of
the Yangian Yn by Drinfeld polynomials. It is based on the remarkable fact that
when n = 2, i.e. the Young diagram of λ has just two rows, every L(A)(A ∈ Row(λ))
can be expressed as an irreducible tensor product; see §7.1.
     Amongst all the standard modules, there are some special ones which are high-
est weight modules and whose isomorphism classes form a basis for the Grothendieck
group of the category F (λ). Let A ∈ Col(λ) be a column strict λ-tableau with en-
tries ai,1 , . . . , ai,pi in its ith row read from left to right. We say that A is standard
if ai,j ≤ ai,k for every 1 ≤ i ≤ n and 1 ≤ j < k ≤ pi such that ai,j and ai,k belong
to the same coset of C modulo Z. If all entries of A are integers, this is the usual
definition of a standard tableau: entries increase strictly up columns and weakly
along rows. Let Std(λ) denote the set of all standard λ-tableaux A ∈ Col(λ). Our
proof of the next theorem is based on an argument due to Chari [C] in the context
of quantum affine algebras; see §7.3.
    Theorem D (Highest weight standard modules). For A ∈ Std(λ), the
standard module V (A) is a highest weight module of highest weight equal to the row
equivalence class of A.
     Most of the results so far are analogous to well known results in the repre-
sentation theory of Yangians and quantum affine algebras, and do not exploit the
finite W -algebra side of the picture in any significant way. To remedy this, we
need to apply Skryabin’s theorem from [Sk]; see §8.1. This asserts that the functor
6                                 1. INTRODUCTION


Qχ ⊗W (λ) ? gives an equivalence of categories between the category of all W (λ)-
modules and the category W(λ) of all generalized Whittaker modules, namely, all
g-modules on which (x − χ(x)) acts locally nilpotently for all x ∈ m. For any finite
dimensional g-module V , it is obvious that the functor ? ⊗ V maps objects in W(λ)
to objects in W(λ). Transporting through Skryabin’s equivalence of categories, we
obtain a functor ? ⊛ V on W (λ) -mod itself; see §8.2. In this way, one can intro-
duce translation functors on the categories M(λ) and F (λ). Actually, we just need
some special translation functors, peculiar to the type A theory and denoted ei , fi
for i ∈ C, which arise from ⊛’ing with the natural glN (C)-module and its dual.
These functors fit into the axiomatic framework developed recently by Chuang and
Rouquier [CR]; see §8.3.
     Now recall the parabolic subalgebra p of g with Levi factor h. We let O(λ)
denote the corresponding parabolic category O, the category of all finitely generated
g-modules on which p acts locally finitely and h acts semisimply. For A ∈ Col(λ)
with entry ai in its ith box, we let N (A) ∈ O(λ) denote the parabolic Verma module
generated by a highest weight vector v+ that is annihilated by all strictly upper
triangular matrices in g and on which ei,i acts as the scalar (ai + i − 1) for each
i = 1, . . . , N . Let K(A) denote the unique irreducible quotient of N (A). Both of
the sets {[N (A)] | A ∈ Col(λ)} and {[K(A)] | A ∈ Col(λ)} form natural bases for
the Grothendieck group [O(λ)]. There is a remarkable functor
                                  V : O(λ) → F (λ)
introduced originally (in a slightly different form) by Kostant and Lynch. We call it
the Whittaker functor; see §8.5. It is an exact functor preserving central characters
and commuting with translation functors. Moreover, it maps the parabolic Verma
module N (A) to the standard module V (A) for every A ∈ Col(λ). The culmination
of this article is the following theorem.
    Theorem E (Construction of irreducible modules). The Whittaker func-
tor V : O(λ) → F (λ) sends irreducible modules to irreducible modules or zero. More
precisely, take any A ∈ Col(λ) and let B ∈ Row(λ) be its row equivalence class.
Then                             
                                     L(B) if A is standard,
                     V(K(A)) ∼ =
                                     0     otherwise.
Every finite dimensional irreducible W (λ)-module arises in this way.
     There are three main ingredients to the proof of this theorem. First, we need
detailed information about the translation functors ei , fi , much of which is provided
by [CR] as an application of the representation theory of degenerate affine Hecke
algebras. Second, we need to know that the standard modules V (A) have simple
cosocle if A ∈ Std(λ), which follows from Theorem D. Finally, we need to apply
the Kazhdan-Lusztig conjecture for the Lie algebra glN (C) in order to determine
exactly when V(K(A)) is non-zero.
     Let us discuss some of the combinatorial consequences of Theorem E in more
detail. For this, we at last restrict our attention just to modules having integral
central character. Let Row0 (λ), Col0 (λ), Dom0 (λ) and Std0 (λ) denote the subsets
of Row(λ), Col(λ), Dom(λ) and Std(λ) consisting of the tableaux all of whose entries
are integers. The restriction of the map R actually gives a bijection between the sets
Std0 (λ) and Dom0 (λ). Let O0 (λ), F0 (λ) and M0 (λ) denote the full subcategories
of O(λ), F (λ) and M(λ) consiting of objects all of whose composition factors
                                   1. INTRODUCTION                                      7


are of the form {K(A) | A ∈ Col0 (λ)}, {L(A) | A ∈ Dom0 (λ)} and {L(A) | A ∈
Row0 (λ)}, respectively. The isomorphism classes of these three sets of objects give
canonical bases for the Grothendieck groups [O0 (λ)], [F0 (λ)] and [M0 (λ)], as do
the isomorphism classes of the parabolic Verma modules {N (A) | A ∈ Col0 (λ)},
the standard modules {V (A) | A ∈ Std0 (λ)}, and the generalized Verma modules
{M (A) | A ∈ Row0 (λ)}, respectively.
    The functor V above restricts to an exact functor V : O0 (λ) → F0 (λ), and we
also have the natural embedding I of the category F0 (λ) into M0 (λ). At the level
of Grothendieck groups, these functors induce maps
                                      V          I
                            [O0 (λ)] ։ [F0 (λ)] ֒→ [M0 (λ)].
The translation functors ei , fi for i ∈ Z (and more generally their divided pow-
     (r)   (r)
ers ei , fi defined as in [CR]) induce maps also denoted ei , fi on all these
Grothendieck groups. The resulting maps satisfy the relations of the Chevalley
generators (and their divided powers) for the Kostant Z-form UZ of the universal
enveloping algebra of the Lie algebra gl∞ (C), that is, the Lie algebra of matrices
with rows and columns labelled by Z all but finitely many of which are zero. The
maps V and I are then UZ -module homomorphisms with respect to these actions.
    Now the point is that all of this categorifies a well known situation in linear
algebra. Let VZ denote the natural UZ -module, with basis vi (i ∈ Z). We write
Vλ′                                 V                  V
    (VZ ) for the tensor product q1 (VZ ) ⊗ · · · ⊗ ql (VZ ) and S λ (VZ ) for the tensor
product S p1 (VZ ) ⊗ · · · ⊗ S pn (VZ ). These free Z-modules have natural monomial
bases denoted {NA | A ∈ Col0 (λ)} and {MA | A ∈ Row0 (λ)}, respectively; see §4.2.
A well known consequence of the Littlewood-Richardson rule (observed already by
Young long before) implies that the space
                                         Vλ′
                                 HomUZ (     (VZ ), S λ (VZ ))
is a free Z-module of rank one; indeed, there is a canonical UZ -module homomor-
             V ′
phism V : λ (VZ ) → S λ (VZ ) that generates the space of all such maps. The image
of this map is P λ (VZ ), a familiar Z-form for the irreducible polynomial representa-
tion of gl∞ (C) labelled by the partition λ. So by definition P λ (VZ ) is a subspace
of S λ (VZ ); we denote the natural inclusion by I. Recall P λ (VZ ) also possesses a
standard monomial basis {VA |A ∈ Std0 (λ)}, defined from VA = V(NA ). Finally, we
        Vλ′
let i :     (VZ ) → [O0 (λ)], j : P λ (VZ ) → [F0 (λ)] and k : S λ (VZ ) → [M0 (λ)] be the
Z-module homomorphisms sending NA 7→ N (A), VA 7→ [V (A)] and MA 7→ [M (A)]
for A ∈ Col0 (λ), A ∈ Std0 (λ) and A ∈ Row0 (λ), respectively.
    Theorem F (Categorification of polynomial functors). The maps i, j, k
are all isomorphisms of UZ -modules, and the following diagram commutes:
                   Vλ′         V                 I
                       (VZ ) −−−−→ P λ (VZ ) −−−−→ S λ (VZ )
                                                       
                                      j                
                      iy               y                 yk
                      [O0 (λ)] −−−−→ [F0 (λ)] −−−−→ [M0 (λ)].
                                  V                  I
                           −1
Moreover, setting LA = j ([L(A)]) for A ∈ Dom0 (λ), the basis {LA |A ∈ Dom0 (λ)}
coincides with Lusztig’s dual canonical basis/Kashiwara’s upper global crystal basis
for the polynomial representation P λ (VZ ).
8                                1. INTRODUCTION


     Again, the Kazhdan-Lusztig conjecture plays the central role in the proof of
this theorem. Actually, we use the following increasingly well known reformula-
tion of the Kazhdan-Lusztig conjecture in type A: setting KA = i−1 ([K(A)]), the
basis {KA | A ∈ Col0 (λ)} coincides with the dual canonical basis for the space
Vλ′
    (VZ ). In particular, this implies that the decomposition numbers [V (A) : L(B)]
for A ∈ Std0 (λ) and B ∈ Dom0 (λ) can be computed in terms of certain Kazhdan-
Lusztig polynomials associated to the symmetric group SN evaluated at q = 1.
From a special case, one can also recover the analogous result for the Yangian Yn
itself. We mention this, because it is interesting to compare the strategy followed
here with that of Arakawa [A1], who also computes the decomposition matrices of
the Yangian in terms of Kazhdan-Lusztig polynomials starting from the Kazhdan-
Lusztig conjecture for the Lie algebra glN (C), via [AS]. There might also be a
geometric approach to representation theory of shifted Yangians in the spirit of
[V].
     As promised earlier in the introduction, let us now formulate a precise con-
jecture that explains how to compute the decomposition numbers [M (A) : L(B)]
for all A, B ∈ Row0 (λ), also in terms of Kazhdan-Lusztig polynomials associated
to the symmetric group SN . Setting LA = k −1 ([L(A)]) for any A ∈ Row0 (λ), we
conjecture that {LA | A ∈ Row0 (λ)} coincides with the dual canonical basis for the
space S λ (VZ ); see §7.5. This is a purely combinatorial reformulation in type A of
the conjecture of de Vos and van Driel [VD] for arbitrary finite W -algebras, and
is consistent with an idea of Premet that there should be an equivalence of cate-
gories between the category M(λ) here and a certain category N (λ) considered by
Miličíc and Soergel [MS]. Our conjecture is known to be true in the special case
that the Young diagram of λ consists of a single column: in that case it is precisely
the Kazhdan-Lusztig conjecture for the Lie algebra glN (C). It is also true if the
Young diagram of λ has at most two rows, as can be verified by comparing the
explicit construction of the simple highest weight modules in the two row case from
§7.1 with the explicit description of the dual canonical basis in this case from [B,
Theorem 20]. Finally, Theorem E would be an easy consequence of this conjecture.
     In a forthcoming article [BK6], we will study the categories of polynomial and
rational representations of W (π) in more detail. In particular, we will make precise
the relationship between polynomial representations of W (π) and representations
of degenerate cyclotomic Hecke algebras, and we will relate the Whittaker functor
V to work of Soergel [S] and Backelin [Ba]. This should have applications to the
representation theory of affine W -algebras in the spirit of [A2].
                                           CHAPTER 2


                                 Shifted Yangians

     We will work from now on over an algebraically closed field F of characteristic
0. Let ≥ denote the partial order on F defined by x ≥ y if (x − y) ∈ N, where
N denotes {0, 1, 2, . . . } ⊂ F. We write simply gln for the Lie algebra gln (F). In
this preliminary chapter, we collect some basic definitions and results about shifted
Yangians, most of which are taken from [BK5]. By a shift matrix we mean a matrix
σ = (si,j )1≤i,j≤n of non-negative integers such that
(2.1)                                     si,j + sj,k = si,k
whenever |i−j|+|j−k| = |i−k|. Note this means that s1,1 = · · · = sn,n = 0, and the
matrix σ is completely determined by the upper diagonal entries s1,2 , s2,3 , . . . , sn−1,n
and the lower diagonal entries s2,1 , s3,2 , . . . , sn,n−1 . We fix such a matrix σ through-
out the chapter.

                           2.1. Generators and relations
    The shifted Yangian associated to the matrix σ is the algebra Yn (σ) over F
defined by generators
                                    (r)
(2.2)                            {Di      | 1 ≤ i ≤ n, r > 0},
                                    (r)
(2.3)                            {Ei      | 1 ≤ i < n, r > si,i+1 },
                                    (r)
(2.4)                            {Fi      | 1 ≤ i < n, r > si+1,i }
subject to certain relations. In order to write down these relations, let
                                  X (r)
(2.5)                   Di (u) :=     Di u−r ∈ Yn (σ)[[u−1 ]]
                                          r≥0
         (0)                                                        (r)
                                                       e of Yn (σ) from the equation
where   Di     := 1, and then define some new elements D i
                                     X (r)
(2.6)                       e
                            Di (u) =    e
                                        Di u := −Di (u)−1 .
                                             −r

                                          r≥0

With this notation, the relations are as follows.
                           (r)      (s)
(2.7)                   [Di , Dj ] = 0,
                                                   r+s−1
                                                    X
                           (r)  (s)                        e (t) D(r+s−1−t) ,
(2.8)                    [Ei , Fj ]       = δi,j           D i    i+1
                                                    t=0




                                                    9
10                                        2. SHIFTED YANGIANS

                                                                   r−1
                                                                   X
                         (r)    (s)                                        (t)       (r+s−1−t)
(2.9)              [Di , Ej ] = (δi,j − δi,j+1 )                         Di Ej                           ,
                                                                   t=0
                                                                   r−1
                                                                   X
                         (r)    (s)                                        (r+s−1−t)               (t)
(2.10)             [Di , Fj ] = (δi,j+1 − δi,j )                         Fj                    Di ,
                                                                   t=0

                  (r)     (s+1)        (r+1)     (s)                     (r)     (s)           (s)       (r)
(2.11)          [Ei , Ei         ] − [Ei     , Ei ]               = Ei Ei              + Ei Ei ,
                   (r+1)     (s)       (r)    (s+1)                      (r)     (s)           (s)       (r)
(2.12)          [Fi      , Fi ] − [Fi , Fi           ]            = Fi Fi              + Fi Fi ,
                          (r)      (s+1)            (r+1)         (s)                  (r)     (s)
(2.13)               [Ei , Ei+1 ] − [Ei                      , Ei+1 ] = −Ei Ei+1 ,
                           (r+1)         (s)         (r)         (s+1)                 (s)     (r)
(2.14)               [Fi           , Fi+1 ] − [Fi , Fi+1 ] = −Fi+1 Fi ,
                                                           (r)     (s)
(2.15)                                               [Ei , Ej ] = 0                          if |i − j| > 1,
                                                        (r) (s)
(2.16)                                               [Fi , Fj ]          =0                  if |i − j| > 1,
              (r)   (s)  (t)                     (s)   (r)  (t)
(2.17)      [Ei , [Ei , Ej ]]            +     [Ei , [Ei , Ej ]]         =0                  if |i − j| = 1,
               (r)   (s) (t)                      (s)   (r) (t)
(2.18)      [Fi , [Fi , Fj ]]            +     [Fi , [Fi , Fj ]]         =0                  if |i − j| = 1,
for all meaningful r, s, t, i, j. (For example, the relation (2.13) should be understood
to hold for all i = 1, . . . , n − 2, r > si,i+1 and s > si+1,i+2 .)
     It is often helpful to view Yn (σ) as an algebra graded by the root lattice Qn
associated to the Lie algebra gln . Let c be the (abelian) Lie subalgebra of Yn (σ)
                                  (1)       (1)
spanned by the elements D1 , . . . , Dn . Let ε1 , . . . , εn be the basis for c∗ dual to
              (1)       (1)
the basis D1 , . . . , Dn . We refer to elements of c∗ as weights and elements of
                                              Mn
(2.19)                                 Pn :=     Zεi ⊂ c∗
                                                     i=1
as integral weights. The root lattice associated to the Lie algebra gln is then the
Z-submodule Qn of Pn spanned by the simple roots εi − εi+1 for i = 1, . . . , n − 1.
We have the usual dominance ordering on c∗ defined by α ≥ β if (α − β) is a sum
of simple roots. With this notation set up, the relations imply that we can define
a Qn -grading
                                        M
(2.20)                        Yn (σ) =       (Yn (σ))α
                                                     α∈Qn
                                                                                             (r)     (r)            (r)
of the algebra Yn (σ) by declaring that the generators Di , Ei                                                 and Fi     are of
degrees 0, εi − εi+1 and εi+1 − εi , respectively.

                                         2.2. PBW theorem
    For 1 ≤ i < j ≤ n and r > si,j resp. r > sj,i , we inductively define the higher
               (r)         (r)
root elements Ei,j resp. Fi,j of Yn (σ) from the formulae
                   (r)             (r)             (r)            (r−s           )      (s           +1)
(2.21)          Ei,i+1 := Ei ,                   Ei,j := [Ei,j−1j−1,j , Ej−1
                                                                           j−1,j
                                                                                                             ],
                   (r)             (r)             (r)         (sj,j−1 +1)     (r−s     )
(2.22)           Fi,i+1 := Fi ,                  Fi,j :=     [Fj−1         , Fi,j−1j,j−1 ].
                                          2.2. PBW THEOREM                                     11


Introduce the canonical filtration F0 Yn (σ) ⊆ F1 Yn (σ) ⊆ · · · of Yn (σ) by declaring
          (r)  (r)       (r)
that all Di , Ei,j and Fi,j are of degree r, i.e. Fd Yn (σ) is the span of all monomials
in these elements of total degree ≤ d. Then [BK5, Theorem 5.2] shows that the
associated graded algebra gr Yn (σ) is free commutative on generators
                                        (r)
(2.23)                       {grr Di          | 1 ≤ i ≤ n, si,i < r},
                                   (r)
(2.24)                       {grr Ei,j        | 1 ≤ i < j ≤ n, si,j < r},
                                    (r)
(2.25)                       {grr Fi,j        | 1 ≤ i < j ≤ n, sj,i < r}.
It follows immediately that the monomials in the elements
                                    (r)
(2.26)                         {Di        | 1 ≤ i ≤ n, si,i < r},
                                  (r)
(2.27)                          {Ei,j     | 1 ≤ i < j ≤ n, si,j < r},
                                    (r)
(2.28)                          {Fi,j | 1 ≤ i < j ≤ n, sj,i < r}
taken in some fixed order give a basis for the algebra Yn (σ). Moreover, letting Y(1n )
                                                                                      (r)
resp. Y(1+n ) (σ) resp. Y(1−n ) (σ) denote the subalgebra of Yn (σ) generated by the Di ’s
             (r)                    (r)
resp. the Ei ’s resp. the Fi ’s, the monomials just in the elements (2.26) resp.
(2.27) resp. (2.28) taken in some fixed order give bases for these subalgebras; see
[BK5, Theorem 2.3]. These basis theorems imply in particular that multiplication
defines a vector space isomorphism
                                                                  ∼
(2.29)                    Y(1−n ) (σ) ⊗ Y(1n ) ⊗ Y(1+n ) (σ) −→ Yn (σ),
giving us a triangular decomposition of the shifted Yangian. Also define the positive
and negative Borel subalgebras
(2.30)         Y(1♯ n ) (σ) := Y(1n ) Y(1+n ) (σ),       Y(1♭ n ) (σ) := Y(1−n ) (σ)Y(1n ) .
By the relations, these are indeed subalgebras of Yn (σ). Moreover, there are obvious
surjective homomorphisms
(2.31)                    Y(1♯ n ) (σ) ։ Y(1n ) ,        Y(1♭ n ) (σ) ։ Y(1n )
                 ♯              ♭                                       (r)             (r)
with kernels K(1   n ) (σ) and K(1n ) (σ) generated by all Ei,j and all Fi,j , respectively.

     We now introduce a new basis for Yn (σ), which will play a central role in this
article. First, define the power series
                               X (r)                          X (r)
(2.32)          Ei,j (u) :=        Ei,j u−r ,     Fi,j (u) :=     Fi,j u−r
                               r>si,j                                   r>sj,i

for 1 ≤ i < j ≤ n, and set Ei,i (u) = Fi,i (u) := 1 by convention. Recalling (2.5), let
D(u) denote the n × n diagonal matrix with ii-entry Di (u) for 1 ≤ i ≤ n, let E(u)
denote the n × n upper triangular matrix with ij-entry Ei,j (u) for 1 ≤ i ≤ j ≤ n,
and let F (u) denote the n × n lower triangular matrix with ji-entry Fi,j (u) for
1 ≤ i ≤ j ≤ n. Consider the product
(2.33)                               T (u) = F (u)D(u)E(u)
12                                        2. SHIFTED YANGIANS


of matrices with entries in Yn (σ)[[u−1 ]]. The ij-entry of the matrix T (u) defines a
power series
                                                           min(i,j)
                              X           (r)
                                                            X
(2.34)          Ti,j (u) =              Ti,j u−r    :=                Fk,i (u)Dk (u)Ek,j (u)
                              r≥0                           k=1
                               (r)                                              (0)                    (r)
for some new elements Ti,j ∈ Fr Yn (σ). Note that Ti,j = δi,j and Ti,j = 0 for
0 < r ≤ si,j .
    Lemma 2.1. The associated graded algebra gr Yn (σ) is free commutative on
                  (r)
generators {grr Ti,j | 1 ≤ i, j ≤ n, si,j < r}. Hence, the monomials in the elements
     (r)
{Ti,j | 1 ≤ i, j ≤ n, si,j < r} taken in some fixed order form a basis for Yn (σ).
                                   (r)
    Proof. Recall that Ti,j = 0 for 0 < r ≤ si,j . Given this, it is easy to see,
e.g. by solving the equation (2.33) in terms of quasi-determinants as in [BK4,
                                         (r)  (r)       (r)
(5.2)–(5.4)], that each of the elements Di , Ei,j and Fi,j of Yn (σ) can be written
as a linear combination of monomials of total degree r in the elements
                                         (s)
                                   {Ti,j | 1 ≤ i, j ≤ n, si,j < s}.
Since we already know that gr Yn (σ) is free commutative on the generators (2.23)–
                                            (r)
(2.25), it follows that the elements {grr Ti,j | 1 ≤ i, j ≤ n, si,j < r} also generate
gr Yn (σ). Now the lemma follows by dimension considerations.                       

                                  2.3. Some automorphisms
    Let σ̇ = (ṡi,j )1≤i,j≤n be another shift matrix with ṡi,i+1 + ṡi+1,i = si,i+1 +si+1,i
for all i = 1, . . . , n − 1. Then the defining relations imply that there is a unique
algebra isomorphism
(2.35)                                         ι : Yn (σ) → Yn (σ̇)
defined on generators by the equations
                            (r)            (r)
(2.36)                   ι(Di ) = Di ,
                            (r)                                       (r−si,i+1 +ṡi,i+1 )
(2.37)                   ι(Ei ) = (−1)si,i+1 −ṡi,i+1 Ei                                     ,
                             (r)                 si+1,i −ṡi+1,i     (r−si+1,i +ṡi+1,i )
(2.38)                   ι(Fi )    = (−1)                          Fi                     .
This is not quite the same as the definition in [BK5] (because of the extra signs),
but the change causes no difficulties.
    Another useful map is the anti-isomorphism
(2.39)                                     τ : Yn (σ) → Yn (σ t )
where σ t denotes the transpose of the shift matrix σ, defined on the generators by
                   (r)         (r)                   (r)           (r)                (r)        (r)
(2.40)        τ (Di ) = Di ,                    τ (Ei ) = Fi ,                 τ (Fi ) = Ei .
Note that
                   (r)            (r)                (r)            (r)               (r)        (r)
(2.41)         τ (Ei,j ) = Fi,j ,               τ (Fi,j ) = Ei,j ,             τ (Ti,j ) = Tj,i
by (2.21)–(2.22) and (2.34).
                                     2.4. PARABOLIC GENERATORS                                       13


    Finally for any power series f (u) ∈ 1 + u−1 F[[u−1 ]], it is easy to check from the
relations that there is an automorphism
(2.42)                                       µf : Yn (σ) → Yn (σ)
                (r)           (r)
fixing each    Ei     and   Fi      and mapping Di (u) to the product f (u)Di (u), i.e.
                                                  r
                                                  X
                                            (r)           (r−s)
(2.43)                                 µf (Di ) =    as D i
                                                             s=0
             P            −s
if f (u) =       s≥0 as u    .

                                    2.4. Parabolic generators
     In this section, we recall some more complicated parabolic presentations of
Yn (σ) from [BK5]. Actually the parabolic generators defined here will be needed
later on only in §3.7. By a shape we mean a tuple ν = (ν1 , . . . , νm ) of positive inte-
gers summing to n, which we think of as the shape of the standard Levi subalgebra
glν1 ⊕ · · · ⊕ glνm of gln . We say that a shape ν = (ν1 , . . . , νm ) is admissible (for σ)
if si,j = 0 for all ν1 + · · · + νa−1 + 1 ≤ i, j ≤ ν1 + · · · + νa and a = 1, . . . , m, in
which case we define
(2.44)                               sa,b (ν) := sν1 +···+νa ,ν1 +···+νb
for 1 ≤ a, b ≤ m. An important role is played by the minimal admissible shape (for
σ), namely, the admissible shape whose length m is as small as possible.
     Suppose that we are given an admissible shape ν = (ν1 , . . . , νm ). Writing ei,j
for the ij-matrix unit in the space Mr,s of r × s matrices over F, define
         ν
(2.45)       Ta,b (u) :=
                    X
                            ei,j ⊗ Tν1 +···+νa−1 +i,ν1 +···+νb−1 +j (u) ∈ Mνa ,νb ⊗ Yn (σ)[[u−1 ]]
                  1≤i≤νa
                  1≤j≤νb

for each 1 ≤ a, b ≤ m. Let ν T (u) denote the m × m matrix with ab-entry ν Ta,b (u).
Generalizing (2.33) (which is the special case ν = (1n ) of the present definition),
consider the Gauss factorization
                                     ν
(2.46)                                   T (u) = ν F (u)ν D(u)ν E(u)
where ν D(u) is an m×m diagonal matrix with aa-entry denoted ν Da (u) ∈ Mνa ,νa ⊗
Yn (σ)[[u−1 ]], ν E(u) is an m × m upper unitriangular matrix with ab-entry denoted
ν
  Ea,b (u) ∈ Mνa ,νb ⊗ Yn (σ)[[u−1 ]] and ν F (u) is an m × m lower unitriangular matrix
with ba-entry denoted ν Fa,b (u) ∈ Mνb ,νa ⊗ Yn (σ)[[u−1 ]]. So, ν Ea,a (u) and ν Fa,a (u)
are both the identity and
                                             min(a,b)
                                               X
                           ν                            ν
(2.47)                         Ta,b (u) =                   Fc,a (u)ν Dc (u)ν Ec,b (u).
                                               c=1
Also for 1 ≤ a ≤ m let
(2.48)                                   ν   e a (u) := −ν Da (u)−1 ,
                                             D
14                                        2. SHIFTED YANGIANS


inverse computed in the algebra Mνa ,νa ⊗ Yn (σ)[[u−1 ]]. We expand
                         X                          X                (r)
            ν
(2.49)        Da (u) =        ei,j ⊗ ν Da;i,j (u) =        ei,j ⊗ ν Da;i,j u−r ,
                               1≤i,j≤νa                                 1≤i,j≤νa
                                                                          r≥0
                                   X                                      X                      (r)
(2.50)        ν   e a (u) =
                  D                                 e a;i,j (u) =
                                           ei,j ⊗ ν D                                         e
                                                                                     ei,j ⊗ ν D         −r
                                                                                                a;i,j u    ,
                               1≤i,j≤νa                                 1≤i,j≤νa
                                                                          r≥0
                                    X                                         X                        (r)
                  ν
(2.51)                Ea,b (u) =               ei,j ⊗ ν Ea,b;i,j (u) =                   ei,j ⊗ ν Ea,b;i,j u−r ,
                                   1≤i≤νa                                  1≤i≤νa
                                   1≤j≤νb                                  1≤j≤νb
                                                                          r>sa,b (ν)
                                    X                                         X                        (r)
                  ν
(2.52)                Fa,b (u) =               ei,j ⊗ ν Fa,b;i,j (u) =                  ei,j ⊗ ν Fa,b;i,j u−r ,
                                   1≤i≤νb                                  1≤i≤νb
                                   1≤j≤νa                                  1≤j≤νa
                                                                          r>sb,a (ν)

                      e a;i,j (u), ν Ea,b;i,j (u) and ν Fa,b;i,j (u) are power series belonging
where ν Da;i,j (u), ν D
                              (r)     e (r) , ν E (r)          ν (r)
to Yn (σ)[[u ]], and ν Da;i,j , ν D
            −1
                                        a;i,j      a,b;i,j and Fa,b;i,j are elements of Yn (σ).
                                                                        (r)   e (r) , E (r)
We will usually omit the superscript ν, writing simply D                    , D      a;i,j  anda;i,j         a,b;i,j
  (r)                                    (r)               (r)              (r)                (r)
Fa,b;i,j , and also abbreviate Ea,a+1;i,j by Ea;i,j and Fa,a+1;i,j by Fa;i,j . Note finally
that the anti-isomorphism τ from (2.39) satisfies
                        (r)        (r)              (r)           (r)                  (r)             (r)
(2.53)        τ (Da;i,j ) = Da;j,i ,           τ (Ea,b;i,j ) = Fa,b;j,i ,         τ (Fa,b;i,j ) = Ea,b;j,i ,
as follows from (2.47) and (2.41).
     In [BK5, §3], we proved that Yn (σ) is generated by the elements
                  (r)
(2.54)      {Da;i,j | a = 1, . . . , m, 1 ≤ i, j ≤ νa , r > 0},
                  (r)
(2.55)       {Ea;i,j | a = 1, . . . , m − 1, 1 ≤ i ≤ νa , 1 ≤ j ≤ νa+1 , r > sa,a+1 (ν)},
                  (r)
(2.56)       {Fa;i,j | a = 1, . . . , m − 1, 1 ≤ i ≤ νa+1 , 1 ≤ j ≤ νa , r > sa+1,a (ν)}
subject to certain relations recorded explicitly in [BK5, (3.3)–(3.14)]. Moreover,
the monomials in the elements
                         (r)
(2.57)             {Da;i,j | 1 ≤ a ≤ m, 1 ≤ i, j ≤ νa , sa,a (ν) < r},
                        (r)
(2.58)            {Ea,b;i,j | 1 ≤ a < b ≤ m, 1 ≤ i ≤ νa , 1 ≤ j ≤ νb , sa,b (ν) < r},
                        (r)
(2.59)            {Fa,b;i,j | 1 ≤ a < b ≤ m, 1 ≤ i ≤ νb , 1 ≤ j ≤ νa , sb,a (ν) < r}
taken in some fixed order form a basis for Yn (σ). Actually the definition of the
                      (r)          (r)
higher root elements Ea,b;i,j and Fa,b;i,j given here is different from the definition
given in [BK5]. The equivalence of the two definitions is verified by the following
lemma.
    Lemma 2.2. For 1 ≤ a < b − 1 < m, 1 ≤ i ≤ νa , 1 ≤ j ≤ νb and r > sa,b (ν),
we have that
                     (r)        (r−sb−1,b (ν))    (sb−1,b (ν)+1)
                   Ea,b;i,j = [Ea,b−1;i,k      , Eb−1;k,j        ]
                                         2.4. PARABOLIC GENERATORS                                                  15


for any 1 ≤ k ≤ νb−1 . Similarly, for 1 ≤ a < b − 1 < m, 1 ≤ i ≤ νb , 1 ≤ j ≤ νa and
r > sb,a (ν), we have that
                                   (r)         (s
                                              b,b−1       (ν)+1)        (r−s
                                                                           b,b−1   (ν))
                               Fa,b;i,j = [Fb−1;i,k                , Fa,b−1;k,j           ]
for any 1 ≤ k ≤ νb−1 .
     Proof. We just prove the statement about the E’s; the statement about the
F ’s then follows on applying the anti-isomorphism τ . Proceed by downward induc-
tion on the length of the admissible shape ν = (ν1 , . . . , νm ). The base case m = n
is the definition (2.21), so suppose m < n. Pick 1 ≤ p ≤ m and x, y > 0 such
that νp = x + y, then let µ = (ν1 , . . . , νp−1 , x, y, νp+1 , . . . , νm ), an admissible shape
of strictly longer length. A matrix calculation from the definitions shows for each
1 ≤ a < b ≤ m, 1 ≤ i ≤ νa and 1 ≤ j ≤ νb that
                  µ
                 
                    Ea,b;i,j (u)                                                 if b < p;
                  µ
                 
                 
                    Ea,b;i,j (u)                                                 if b = p, j ≤ x;
                  µ
                 
                 
                    Ea,b+1;i,j−x (u)                                             if b = p, j > x;
                  µ
ν                    Ea,b+1;i,j (u)                                               if a < p, b > p;
  Ea,b;i,j (u) =   µ
                 
                    Ea,b+1;i,j
                            P   (u)
                 
                 
                 
                       − yh=1 µ Ea,a+1;i,h (u)µ Ea+1,b+1;h,j (u)                 if a = p, i ≤ x;
                  µ
                 
                 
                    Ea+1,b+1;i−x,j (u)                                           if a = p, i > x;
                  µ
                     Ea+1,b+1;i,j (u)                                             if a > p.
Now suppose that b > a + 1. We need to prove that
                   ν                                               (s      (ν)+1)
                       Ea,b;i,j (u) = [ν Ea,b−1;i,k (u), ν Eb−1;k,j
                                                              b−1,b
                                                                                      ]u−sb−1,b (ν)
for each 1 ≤ k ≤ νb−1 . The strategy is as follows: rewrite both sides of the identity
we are trying to prove in terms of the µ E’s and then use the induction hypothesis,
which asserts that
                   µ                                               (s      (µ)+1)
                       Ea,b;i,j (u) = [µ Ea,b−1;i,k (u), µ Eb−1;k,j
                                                              b−1,b
                                                                                      ]u−sb−1,b (µ)
for each 1 ≤ a < b − 1 ≤ m, 1 ≤ i ≤ µa , 1 ≤ j ≤ µb and 1 ≤ k ≤ µb−1 . Most of the
cases follow at once on doing this; we just discuss the more difficult ones in detail
below.
Case one: b < p. Easy.
Case two: b = p, j ≤ x. Easy.
Case three: b = p, j > x. We have by induction that
               µ                                                     (s        (µ)+1)
                   Ea,b+1;i,j−x (u) = [µ Ea,b;i,h (u), µ Eb;h,j−x
                                                            b,b+1
                                                                                        ]u−sb,b+1 (µ)
                                                                                (1)                 (1)
for 1 ≤ h ≤ x. Noting that sb,b+1 (µ) = 0 and that µ Eb;h,j−x = ν Db;h,j , this shows
                                                    (1)
that ν Ea,b;i,j (u) = [ν Ea,b;i,h (u), ν Db;h,j ]. Using the cases already considered and
the relations, we get that
                             (1)                                    (s         (ν)+1)         (1)
     [ν Ea,b;i,h (u), ν Db;h,j ] = [[ν Ea,b−1;i,k (u), ν Eb−1;k,h
                                                            b−1,b
                                                                                        ], ν Db;h,j ]u−sb−1,b (ν)
                                                                   (s      (ν)+1)
                                     = [ν Ea,b−1;i,k (u), ν Eb−1;k,j
                                                               b−1,b
                                                                                      ]u−sb−1,b (ν)
for any 1 ≤ k ≤ νb−1 .
Case four: a < p, b > p. Easy if b > p + 1 or if b = p + 1 and k > x. Now suppose
that b = p + 1 and k ≤ x. We know already that
              ν                                                     (s         (ν)+1)
                  Ea,b;i,j (u) = [ν Ea,b−1;i,x+1 (u), ν Eb−1;x+1,j
                                                           b−1,b
                                                                                        ]u−sb−1,b (ν) .
16                                               2. SHIFTED YANGIANS

                                                                              (r)
Using the cases already considered to express ν Ea,b−1;i,k as a commutator then using
                                                                            (r)               (s)
the relation [BK5, (3.11)], we have that [ν Ea,b−1;i,k , ν Eb−1;x+1,j ] = 0. Bracketing
         (1)
with ν Db−1;k,x+1 and using the relations one deduces that
                             (r)                  (s)                             (r)               (s)
                         [ν Ea,b−1;i,x+1 , ν Eb−1;x+1,j ] = [ν Ea,b−1;i,k , ν Eb−1;k,j ].
Hence,
                                            (s      (ν)+1)                                              (s    (ν)+1)
         [ν Ea,b−1;i,x+1 (u), ν Eb−1;x+1,j
                                   b−1,b
                                                                  ] = [ν Ea,b−1;i,k (u), ν Eb−1;k,j
                                                                                              b−1,b
                                                                                                                       ].
                                                                                    (sb−1,b (ν)+1) −sb−1,b (ν)
Using this we get that ν Ea,b;i,j (u) =                       [ν Ea,b−1;i,k (u), ν Eb−1;k,j
                                                                                  as              ]u
required.
Case five: a = p, i ≤ x. The left hand side of the identity we are trying to prove is
equal to
                                   y
                                   X
                µ                     µ
                  Ea,b+1;i,j (u) −      Ea,a+1;i,h (u)µ Ea+1,b+1;h,j (u).
                                                  h=1
The right hand side equals
                      y
                      X                                      (sb,b+1 (µ)+1) −sb,b+1 (µ)
    [µ Ea,b;i,k (u) −   µ
                          Ea,a+1;i,h (u)µ Ea+1,b;h,k (u), µ Eb;k,j         ]u           .
                              h=1
Now apply the induction hypothesis together with the fact from the relations that
µ                       (sb,b+1 (µ)+1)
  Ea,a+1;i,h (u) and µ Eb;k,j          commute.
Case six: a = p, i > x. Easy.
Case seven: a > p. Easy.                                                       
     We also introduce here one more family of elements of Yn (σ) needed in §3.7.
Continue with ν = (ν1 , . . . , νm ) being a fixed admissible shape for σ. Recalling that
ν
  Ea,a (u) and ν Fa,a (u) are both the identity, we define
                                                        b−1
                                                        X
                   ν                                                                (s     (ν)+1) −sc,b (ν)−1
(2.60)                 Ēa,b (u) := ν Ea,b (u) −              ν
                                                                  Ea,c (u)ν Ec,bc,b                 u             ,
                                                        c=a
                                                    b−1
                                                    X
                   ν                                                (s      (ν)+1) ν
(2.61)                 F̄a,b (u) := ν Fa,b (u) −              ν
                                                                  Fc,bb,c                Fa,c (u)u−sb,c (ν)−1 ,
                                                    c=a
for 1 ≤ a ≤ b ≤ m. As in (2.51)–(2.52), we expand
                         X                           X                                                          (r)
           ν
(2.62)       Ēa,b (u) =    ei,j ⊗ ν Ēa,b;i,j (u) =                                                ei,j ⊗ ν Ēa,b;i,j u−r ,
                                   1≤i≤νa                                           1≤i≤νa
                                   1≤j≤νb                                           1≤j≤νb
                                                                                  r>sa,b (ν)+1
                                    X                                                    X                     (r)
               ν
(2.63)             F̄a,b (u) =              ei,j ⊗ ν F̄a,b;i,j (u) =                                ei,j ⊗ ν F̄a,b;i,j u−r ,
                                   1≤i≤νb                                           1≤i≤νb
                                   1≤j≤νa                                           1≤j≤νa
                                                                                  r>sb,a (ν)+1
                                                                                                                               (r)
where ν Ēa,b;i,j (u) and ν F̄a,b;i,j (u) are power series in Yn (σ)[[u−1 ]], and ν Ēa,b;i,j
         (r)
and ν F̄a,b;i,j are elements of Yn (σ). We usually drop the superscript ν from this
notation.
                                      2.4. PARABOLIC GENERATORS                                                                  17


    Lemma 2.3. For 1 ≤ a < b − 1 < m, 1 ≤ i ≤ νa , 1 ≤ j ≤ νb and r > sa,b (ν) + 1,
we have that
                        (r)         (r−sb−1,b (ν)−1)    (sb−1,b (ν)+2)
                      Ēa,b;i,j = [Ea,b−1;i,k        , Eb−1;k,j        ]
for any 1 ≤ k ≤ νb−1 . Similarly, for 1 ≤ a < b − 1 < m, 1 ≤ i ≤ νb , 1 ≤ j ≤ νa and
r > sb,a (ν) + 1, we have that
                               (r)           (s
                                             b,b−1     (ν)+2)         (r−s
                                                                        b,b−1       (ν)−1)
                             F̄a,b;i,j = [Fb−1;i,k              , Fa,b−1;k,j                 ]
for any 1 ≤ k ≤ νb−1 .
    Proof. We just prove the statement about the E’s; the statement for the F ’s
then follows on applying the anti-isomorphism τ . We need to prove that
                                                               (s       (ν)+2)
                                                      b−1,b
                  Ēa,b;i,j (u) = [Ea,b−1;i,k (u), Eb−1;k,j                        ]u−sb−1,b (ν)−1 .
Proceed by induction on b = a + 2, . . . , m. For the base case b = a + 2, we have by
the relation [BK5, (3.9)] that
                        (s
                      b−1,b     (ν)+2)                           b−1,b  (s         (ν)+1)
  [Ea,b−1;i,k (u), Eb−1;k,j              ] − [Ea,b−1;i,k (u), Eb−1;k,j                      ]u =
                                                                            νb−1
           (s       (ν)+1)       (s       (ν)+1)
                                                                            X                               (s      (ν)+1)
           a,b−1
     − [Ea,b−1;i,k                b−1,b
                             , Eb−1;k,j            ]u−sa,b−1 (ν) −                                  b−1,b
                                                                                   Ea,b−1;i,h (u)Eb−1;h,j                    .
                                                                            h=1

Multiplying by u−sb−1,b (ν)−1 and using Lemma 2.2, this shows that
                        (s      (ν)+2)
                      b−1,b
  [Ea,b−1;i,k (u), Eb−1;k,j              ]u−sb−1,b (ν)−1 = Ea,b;i,j (u)
                                                      νb−1
                 (sa,b (ν)+1) −sa,b (ν)−1
                                                      X                             (s        (ν)+1) −sb−1,b (ν)−1
                                                                              b−1,b
           −    Ea,b;i,j     u                    −          Ea,b−1;i,h (u)Eb−1;h,j                     u                    .
                                                      h=1

The right hand side is exactly the definition (2.60) of Ēa,b;i,j (u) in this case. Now
assume that b > a + 2 and calculate using Lemma 2.2, relations [BK5, (3.9)] and
[BK5, (3.11)] and the induction hypothesis:
                        (s       (ν)+2)
                      b−1,b
  [Ea,b−1;i,k (u), Eb−1;k,j               ]u−1
                                            (s             (ν)+1)       (s         (ν)+2)
                                       b−2,b−1
                 =[[Ea,b−2;i,1 (u), Eb−2;1,k                              b−1,b
                                                                    ], Eb−1;k,j             ]u−sb−2,b−1 (ν)−1
                                            (s             (ν)+1)      (s          (ν)+2)
                                       b−2,b−1
                 =[Ea,b−2;i,1 (u), [Eb−2;1,k                             b−1,b
                                                                    , Eb−1;k,j              ]]u−sb−2,b−1 (ν)−1
                                            (s             (ν)+2)      (s          (ν)+1)
                                       b−2,b−1
                 =[Ea,b−2;i,1 (u), [Eb−2;1,k                             b−1,b
                                                                    , Eb−1;k,j              ]]u−sb−2,b−1 (ν)−1
                        νb−1
                        X                             (s             (ν)+1)    (s        (ν)+1)
                    −                              b−2,b−1
                               [Ea,b−2;i,1 (u), Eb−2;1,h                         b−1,b
                                                                              Eb−1;h,j             ]u−sb−2,b−1 (ν)−1
                        h=1

                                            (s              (ν)+2)       (s         (ν)+1)
                                        b−2,b−1
                  =[[Ea,b−2;i,1 (u), Eb−2;1,k                              b−1,b
                                                                     ], Eb−1;k,j             ]u−sb−2,b−1 (ν)−1
                        νb−1
                         X                             (s            (ν)+1)        (s       (ν)+1) −sb−2,b−1 (ν)−1
                                                   b−2,b−1                        b−1,b
                    −          [Ea,b−2;i,1 (u), Eb−2;1,h                      ]Eb−1;h,j             u
                         h=1
                                                                      νb−1
                                      (sb−1,b (ν)+1)
                                                                      X                            (s            (ν)+1) −1
                                                                                              b−1,b
                  =[Ēa,b−1;i,k (u), Eb−1;k,j        ]          −            Ea,b−1;i,h (u)Eb−1;h,j                   u      .
                                                                      h=1

Multiplying both sides by u−sb−1,b (ν) and using the definition (2.60) together with
Lemma 2.2 once more gives the conclusion.                                         
18                              2. SHIFTED YANGIANS


                          2.5. Hopf algebra structure
    In the special case that the shift matrix σ is the zero matrix, we denote Yn (σ)
                                                        (r)
simply by Yn . Observe that the parabolic generators D1;i,j of Yn defined from (2.46)
                                                                                          (r)
relative to the admissible shape ν = (n) are simply equal to the elements Ti,j from
(2.34). Hence the parabolic presentation from [BK5, (3.3)–(3.14)] asserts in this
                              (r)
case that the elements {Ti,j | 1 ≤ i, j ≤ n, r > 0} generate Yn subject only to the
relations
                              min(r,s)−1                                   
                (r)   (s)
                                  X         (r+s−1−t) (t)     (t) (r+s−1−t)
(2.64)       [Ti,j , Th,k ] =             Ti,k       Th,j − Ti,k Th,j
                              t=0
                                                            (0)
for every 1 ≤ h, i, j, k ≤ n and r, s > 0, where Ti,j = δi,j . This is precisely the
RTT presentation for the Yangian associated to the Lie algebra gln originating
in the work of Faddeev, Reshetikhin and Takhtadzhyan [FRT]; see also [D] and
[MNO, §1]. It is well known that the Yangian Yn is actually a Hopf algebra with
comultiplication ∆ : Yn → Yn ⊗ Yn and counit ε : Yn → F defined in terms of the
generating function (2.34) by
                                        n
                                        X
(2.65)                    ∆(Ti,j (u)) =   Ti,k (u) ⊗ Tk,j (u),
                                          k=1
(2.66)                   ε(Ti,j (u)) = δi,j .
Note also that the algebra anti-automorphism τ : Yn → Yn from (2.41) is a coalgebra
anti-automorphism, i.e. we have that
(2.67)                        ∆ ◦ τ = P ◦ (τ ⊗ τ ) ◦ ∆
where P denotes the permutation operator x ⊗ y 7→ y ⊗ x.
    It is usually difficult to compute the comultiplication ∆ : Yn → Yn ⊗ Yn in
                            (r)  (r)      (r)
terms of the generators Di , Ei and Fi . At least the case n = 2 can be worked
out explicitly like in [M1, Definition 2.24]: we have that
(2.68)    ∆(D1 (u)) = D1 (u) ⊗ D1 (u) + D1 (u)E1 (u) ⊗ F1 (u)D1 (u),
                                        X
(2.69)    ∆(D2 (u)) = D2 (u) ⊗ D2 (u) +    (−1)k D2 (u)E1 (u)k ⊗ F1 (u)k D2 (u),
                                              k≥1
                                       X
(2.70)    ∆(E1 (u)) = 1 ⊗ E1 (u) +                           e 1 (u)F1 (u)k−1 D2 (u),
                                             (−1)k E1 (u)k ⊗ D
                                       k≥1
                                       X
(2.71)    ∆(F1 (u)) = F1 (u) ⊗ 1 +                               e 1 (u) ⊗ F1 (u)k ,
                                           (−1)k D2 (u)E1 (u)k−1 D
                                       k≥1

as can be checked directly from (2.65) and (2.33). The next lemma gives some
further information about ∆ for n > 2; cf. [CP2, Lemma 2.1]. To formulate the
lemma precisely, recall from (2.20) how Yn is viewed as a Qn -graded algebra; the
            (r)
elements Ti,j are of degree (εi − εj ) for this grading. For any s ≥ 0 and m ≥ 1
with m + s ≤ n there is an algebra embedding
                                 (r)          (r)   (r)           (r)   (r)        (r)
(2.72)      ψs : Ym ֒→ Yn ,   Di       7→ Di+s , Ei       7→ Ei+s , Fi        7→ Fi+s .
                            2.5. HOPF ALGEBRA STRUCTURE                                    19

                                                                           (r)
A different description of this map in terms of the generators Ti,j of Yn is given in
[BK4, (4.2)]. The map ψs is not a Hopf algebra embedding: the maps ∆ ◦ ψs and
(ψs ⊗ ψs ) ◦ ∆ from Ym to Yn ⊗ Yn are definitely different if m < n.
    Lemma 2.4. For any x ∈ Ym such that ψs (x) ∈ (Yn )α for some α ∈ Qn , we
have that
                                          X
           ∆(ψs (x)) − (ψs ⊗ ψs )(∆(x)) ∈      (Yn )β ⊗ (Yn )α−β
                                                     06=β∈Q+
                                                           n
                                                   Pn−1
where Q+
       n here denotes the set of all elements        i=1 ci (εi − εi+1 ) of the root lattice
Qn such that ci ≥ 0 for all i ∈ {1, . . . , s} ∪ {m + s, . . . , n − 1}.
     Proof. It suffices to prove the lemma in the two special cases s = 0 and
m + s = n. Consider first the case that s = 0. Then ψs : Ym ֒→ Yn is just the map
           (r)           (r)
sending Ti,j ∈ Ym to Ti,j ∈ Yn for 1 ≤ i, j ≤ m and r > 0. For these elements
the statement of the lemma is clear from the explicit formula for ∆ from (2.65). It
follows in general since Ym is generated by these elements and Q+ n is closed under
addition.
                                            (r)        (r)
     Instead suppose that m + s = n. Let Tei,j := −S(Ti,j ) where S is the antipode.
                                                           (r)          (r)
Then by [BK4, (4.2)], ψs : Ym ֒→ Yn is the map sending Te ∈ Ym to Te i,j        ∈ Yn
                                                                                 i+s,j+s
for 1 ≤ i, j ≤ m, r > 0. Since (2.65) implies that
                                       Xn X r
                              (r)                (t)   (r−t)
                         ∆(Te ) = −
                               i,j             Te ⊗ Tek,j    , i,k
                                           k=1 t=0
the proof can now be completed as in the previous paragraph.                               
    Now we can formulate a very useful result describing the effect of ∆ on the
                                                      ♯                ♭
generators of Yn in general. Recall from (2.31) that K(1n ) (σ) resp. K(1n ) (σ) denotes

the two-sided ideal of the Borel subalgebra Y(1♯ n ) (σ) resp. Y(1♭ n ) (σ) generated by
      (r)             (r)
the Ei resp. the Fi ; in the case σ is the zero matrix, we denote these simply by
  ♯          ♭
K(1 n ) and K(1n ) . Also define
                                  X (r)
(2.73)                   Hi (u) =  Hi u−r := De i (u)Di+1 (u)
                                     r≥0

                                     e i (u) = −Di (u)−1 , we have that H (0) = −1.
for each i = 1, . . . , n − 1. Since D                                   i

     Theorem 2.5. The comultiplication ∆ : Yn → Yn ⊗ Yn has the following prop-
erties:
               (r)  Pr        (s)    (r−s)          ♯         ♭
       (i) ∆(Di ) ≡ s=0 Di ⊗ Di             (mod K(1   n ) ⊗ K(1n ) );
               (r)        (r)     Pr     (s)    (r−s)               ♯      2     ♭
      (ii) ∆(Ei ) ≡ 1 ⊗ Ei − s=1 Ei ⊗ Hi                 (mod (K(1    n ) ) ⊗ K(1n ) );
               (r)    (r)         Pr     (r−s)     (s)           ♯            ♭      2
     (iii) ∆(Fi ) ≡ Fi ⊗ 1 − s=1 Hi            ⊗ Fi (mod K(1n ) ⊗ (K(1          n ) ) ).


    Proof. This follows from Lemma 2.4, (2.68)–(2.71) and [BK5, Corollary
11.11].                                                                
    Returning to the general case, there is for any shift matrix σ = (si,j )1≤i,j≤n a
                                                               (r)  (r)         (r)
canonical embedding Yn (σ) ֒→ Yn such that the generators Di , Ei and Fi of
Yn (σ) from (2.2)–(2.4) map to the elements of Yn with the same name. However,
20                                  2. SHIFTED YANGIANS

                              (r)            (r)
the higher root elements Ei,j and Fi,j of Yn (σ) do not in general map to the
                                                                                     (r)
elements of Yn with the same name under this embedding, and the elements Ti,j
                                                           (r)
of Yn (σ) do not in general map to the elements Ti,j of Yn . In particular, if σ 6= 0
                                                                    (r)
we do not know a full set of relations for the generators Ti,j of Yn (σ).
    Write σ = σ ′ + σ ′′ where σ ′ is strictly lower triangular and σ ′′ is strictly
upper triangular. Embedding the shifted Yangians Yn (σ), Yn (σ ′ ) and Yn (σ ′′ ) into
Yn in the canonical way, the first part of [BK5, Theorem 11.9] asserts that the
comultiplication ∆ : Yn → Yn ⊗ Yn restricts to a map
(2.74)                      ∆ : Yn (σ) → Yn (σ ′ ) ⊗ Yn (σ ′′ ).
Also the restriction of the counit ε : Yn → F gives us the trivial representation
(2.75)                                 ε : Yn (σ) → F
of the shifted Yangian, with ε(Di (u)) = 1 and ε(Ei (u)) = ε(Fi (u)) = 0.

                             2.6. The center of Yn (σ)
    Let us finally describe the center Z(Yn (σ)) of Yn (σ). Recalling the notation
(2.5), let
                 X
(2.76) Cn (u) =     Cn(r) u−r := D1 (u)D2 (u − 1) · · · Dn (u − n + 1) ∈ Yn (σ)[[u−1 ]].
                 r≥0

In the case of the Yangian Yn itself, there is a well known alternative description of
the power series Cn (u) in terms of quantum determinants due to Drinfeld [D] (see
also [BK4, Theorem 8.6]). To recall this, given an n × n matrix A = (ai,j )1≤i,j≤n
with entries in some (not necessarily commutative) ring, set
                                X
(2.77)               rdet A :=       sgn(w)a1,w1 a2,w2 · · · an,wn ,
                                   w∈Sn
                                    X
(2.78)                 cdet A :=          sgn(w)aw1,1 aw2,2 · · · awn,n ,
                                   w∈Sn

where Sn is the symmetric group. Then, working in Yn [[u−1 ]], we have that
(2.79)
                                                                                
                    T1,1 (u − n + 1) T1,2 (u − n + 1) · · · T1,n (u − n + 1)
                            ..                ..       ..            ..         
                             .                 .          .           .         
    Cn (u) = rdet                                                               
                   Tn−1,1 (u − 1)      Tn−1,2 (u − 1) · · ·   Tn−1,n (u − 1)    
                         Tn,1 (u)          Tn,2 (u)    ···         Tn,n (u)
                                                                           
                     T1,1 (u)     T1,2 (u − 1)    ···  T1,n (u − n + 1)
                         ..            ..        ..            ..          
                          .             .           .           .          
(2.80)     = cdet                                                          .
                   Tn−1,1 (u) Tn−1,2 (u − 1) · · · Tn−1,n (u − n + 1) 
                     Tn,1 (u)     Tn,2 (u − 1)    ···  Tn,n (u − n + 1)
In particular, in view of this alternative description, [MNO, Proposition 2.19]
shows that
(2.81)                       ∆(Cn (u)) = Cn (u) ⊗ Cn (u).
                                          (1)      (2)
    Theorem 2.6. The elements Cn , Cn , . . . are algebraically independent and
generate Z(Yn (σ)).
                              2.6. THE CENTER OF Yn (σ)                               21


    Proof. Exploiting the embedding Yn (σ) ֒→ Yn , it is known by [MNO, Theo-
                               (1)  (2)
rem 2.13] that the elements Cn , Cn , . . . are algebraically independent and gener-
ate Z(Yn ) (see also [BK4, Theorem 7.2] for a slight variation on this argument). So
they certainly belong to Z(Yn (σ)). The fact that Z(Yn (σ)) is no larger than Z(Yn )
may be proved by passing to the associated graded algebra grL Yn (σ) from [BK5,
Theorem 2.1] and following the idea of the proof of [MNO, Theorem 2.13]. We
omit the details since we give an alternative argument in Corollary 6.11 below. 
    Recall the automorphisms µf : Yn (σ) → Yn (σ) from (2.42). Define
(2.82)      SYn (σ) := {x ∈ Yn (σ) | µf (x) = x for all f (u) ∈ 1 + u−1 F[[u−1 ]]}.
Like in [MNO, Proposition 2.16], one can show that multiplication defines an
algebra isomorphism
                                                  ∼
(2.83)                      Z(Yn (σ)) ⊗ SYn (σ) → Yn (σ).
                                                           (r)
Recalling (2.73), ordered monomials in the elements {Hi | i = 1, . . . , n − 1, r > 0},
  (r)                                    (r)
{Ei,j | 1 ≤ i < j ≤ n, r > si,j } and {Fi,j | 1 ≤ i < j ≤ n, r > sj,i } form a basis for
SYn (σ).
                                      CHAPTER 3


                             Finite W -algebras

     In this chapter we review the definition of the finite W -algebras associated to
nilpotent orbits in the Lie algebra glN , then explain their connection to the shifted
Yangians. Again, much of this material is based closely on [BK5], though there
are some important new results too. Throughout the chapter, we assume that π is
a fixed pyramid of level l, that is, a sequence π = (q1 , . . . , ql ) of integers such that
(3.1)                  0 < q1 ≤ · · · ≤ qk ,    qk+1 ≥ · · · ≥ ql > 0
for some fixed integer 0 ≤ k ≤ l. We also choose an integer n greater than or equal
to the height max(q1 , . . . , ql ) of the pyramid π.

                                    3.1. Pyramids
    We visualize the pyramid π by means of a diagram consisting of q1 bricks
stacked in the first column, q2 bricks stacked in the second column, . . . , ql bricks
stacked in the lth column, where columns are numbered 1, 2, . . . , l from left to right.
For example, the diagram of the pyramid π = (1, 2, 4, 3, 1) is
                                           4
                                           5 8
(3.2)                                2     6 9
                                   1 3     7 10 11 .
Also number the rows of the diagram of π by 1, 2, . . . , n from top to bottom, so
that the nth row is the last row containing l bricks, and let pi denote the number
of bricks on the ith row. This defines the tuple (p1 , . . . , pn ) of row lengths, with
(3.3)                            0 ≤ p1 ≤ · · · ≤ pn = l.
As in the above example, we always number the bricks of the diagram 1, 2, . . . , N
down columns starting with the first column. Let row(i) and col(i) denote the
number of the row and column containing the entry i in the diagram. We say that
the pyramid is left-justified if q1 ≥ · · · ≥ ql and right-justified if q1 ≤ · · · ≤ ql .
    Recalling the fixed choice of the integer k from (3.1), we associate a shift matrix
σ = (si,j )1≤i,j≤n to the pyramid π by setting
                       
                         #{c = 1, . . . , k | i > n − qc ≥ j}       if i ≥ j,
(3.4)          si,j :=
                         #{c = k + 1, . . . , l | i ≤ n − qc < j} if i ≤ j.
To make sense of this formula, we just point out that the pyramid π can easily be
recovered given just this shift matrix σ and the level l, since its diagram consists of




                                               23
24                                3. FINITE W -ALGEBRAS


pi = l − sn,i − si,n bricks on the ith row indented sn,i columns from the left edge
and si,n columns from the right edge. Finally, let
(3.5)                             Si,j := si,j + pmin(i,j) .
We stress that almost all of the notation in this section and later on depends
implicitly on the fixed choices of n and k.

                                3.2. Finite W -algebras
    Let g denoteL the Lie algebra glN , equipped with the trace form (., .). Define a
Z-grading g = j∈Z gj defined by declaring that the ij-matrix unit ei,j is of degree
                                                           L                L
(col(j)− col(i)) for each 1 ≤ i, j ≤ N . Let h := g0 , p := j≥0 gj and m := j<0 gj .
Thus p is a standard parabolic subalgebra of g with Levi factor h = glq1 ⊕ · · · ⊕ glql ,
and m is the opposite nilradical. Let e ∈ p denote the nilpotent matrix
                                           X
(3.6)                                 e=       ei,j
                                               i,j

summing over all pairs i j of adjacent entries in the diagram; for example if π is
as inL(3.2) then e = e5,8 + e2,6 + e6,9 + e1,3 + e3,7 + e7,10 + e10,11 . The Z-grading
g = j∈Z gj is then a good grading for e ∈ g1 in the sense of [KRW, EK].
     The map χ : m → F, x 7→ (x, e) is a Lie algebra homomorphism. Let Iχ denote
the kernel of the associated homomorphism U (m) → F. Also let η : U (p) → U (p)
be the algebra automorphism defined by
(3.7)            η(ei,j ) = ei,j + δi,j (n − qcol(j) − qcol(j)+1 − · · · − ql )
for each ei,j ∈ p. Now we define the finite W -algebra corresponding to the pyramid
π to be the subalgebra
(3.8)          W (π) := {u ∈ U (p) | [x, η(u)] ∈ U (g)Iχ for all x ∈ m}
of U (p). Note this is slightly different from the definition used in [BK5, §8]: there
we did not include the shift by the automorphism η at this point.
     The definition of W (π) originates in work of Kostant [Ko2] and Lynch [Ly],
and is a special case of the construction due to Premet [P1] and then Gan and
Ginzburg [GG] of non-commutative filtered deformations of the coordinate algebra
of the Slodowy slice associated to the nilpotent orbit containing e. To make the
last statement precise, we need to introduce the Kazhdan filtration
                                 F0 U (p) ⊆ F1 U (p) ⊆ · · ·
of U (p). This can be defined simply by declaring that each matrix unit ei,j ∈ p is of
filtered degree (col(j) − col(i) + 1), that is, Fd U (p) is the span of all the monomials
ei1 ,j1 · · · eir ,jr in U (p) such that
                  col(j1 ) − col(i1 ) + · · · + col(jr ) − col(ir ) + r ≤ d.
The associated graded algebra gr U (p) is obviously identified with the symmetric
algebra S(p), viewed as a graded algebra via the Kazhdan grading in which each
ei,j is of graded degree (col(j) − col(i) + 1). We get induced a filtration
                                F0 W (π) ⊆ F1 W (π) ⊆ · · ·
of W (π), also called the Kazhdan filtration, by setting Fd W (π) := W (π) ∩ Fd U (p);
so gr W (π) is naturally a graded subalgebra of gr U (p) = S(p). Let cg (e) denote
the centralizer of e in g and p⊥ denote the nilradical of p. Also define elements
                                             3.3. INVARIANTS                                                         25


h ∈ g0 and f ∈ g−1 so that (e, h, f ) is an sl2 -triple in g (taking h = f = 0 in the
degenerate case e = 0). By [BK5, Lemma 8.1(ii)], we have that
(3.9)                                      p = cg (e) ⊕ [p⊥ , f ].
The projection p ։ cg (e) along this direct sum decomposition induces a homo-
morphism S(p) ։ S(cg (e)). Now the precise statement is that the restriction of
                                                          ∼
this homomorphism to gr W (π) is an isomorphism gr W (π) → S(cg (e)) of graded
algebras; see [Ly, Theorem 2.3].

                                            3.3. Invariants
    For 1 ≤ i, j ≤ n, 0 ≤ x ≤ n and r ≥ 1 define
                    X r          X
            (r)
(3.10)    Ti,j;x :=     (−1)r−s      (−1)#{t=1,...,s−1 | row(jt )≤x} ei1 ,j1 · · · eis ,js
                              s=1         i1 ,...,is
                                          j1 ,...,js

where the second sum is over all 1 ≤ i1 , . . . , is , j1 , . . . , js ≤ N such that
     (a) col(j1 ) − col(i1 ) + · · · + col(js ) − col(is ) + s = r;
     (b) col(it ) ≤ col(jt ) for each t = 1, . . . , s;
     (c) if row(jt ) > x then col(jt ) < col(it+1 ) for each t = 1, . . . , s − 1;
     (d) if row(jt ) ≤ x then col(jt ) ≥ col(it+1 ) for each t = 1, . . . , s − 1;
     (e) row(i1 ) = i, row(js ) = j;
      (f) row(jt ) = row(it+1 ) for each t = 1, . . . , s − 1.
Also set
                                        
                                         1       if i = j > x,
                               (0)
(3.11)                       Ti,j;x :=      −1 if i = j ≤ x,
                                        
                                            0     if i 6= j,
and introduce the generating function
                                   X (r)
(3.12)               Ti,j;x (u) :=  Ti,j;x u−r ∈ U (p)[[u−1 ]].
                                             r≥0

These remarkable elements (or rather their images under the automorphism η) were
first introduced in [BK5, (9.6)]. As we will explain in the next section, certain of
the elements (3.10) in fact generate the finite W -algebra W (π).
                                                                 (r)
     Here is a quite different description of the elements Ti,j;0 in the spirit of [BK5,
(12.6)]. If either the ith or the jth row of the diagram is empty then we have simply
that Ti,j;0 (u) = δi,j . Otherwise, let a ∈ {1, . . . , l} be minimal such that i > n − qa
and let b ∈ {2, . . . , l + 1} be maximal such that j > n − qb−1 . Using the shorthand
π(r, c) for the entry (q1 + · · · + qc + r − n) in the rth row and the cth column of the
diagram of π (which makes sense only if r > n − qc ), we have that
(3.13) Ti,j;0 (u) =
                    Si,j                   m
                    X                    X Y                                                                     
            −Si,j
        u                  (−1)Si,j −m                 eπ(rt−1 ,ct−1 ),π(rt ,ct −1) + δrt−1 ,rt δct−1 ,ct −1 u
                    m=1             r0 ,...,rm t=1
                                    c0 ,...,cm

where the second summation is over all rows r0 , . . . , rm and columns c0 , . . . , cm such
that a = c0 < · · · < cm = b, r0 = i and rm = j, and max(n−qct −1 , n−qct ) < rt ≤ n
26                                 3. FINITE W -ALGEBRAS


for each t = 1, . . . , m−1. This identity is proved by multiplying out the parentheses
and comparing with (3.10).

         3.4. Finite W -algebras are quotients of shifted Yangians
   Now we can formulate the main theorem from [BK5] precisely. First, [BK5,
Theorem 10.1] asserts that the elements
                             (r)
(3.14)                   {Ti,i;i−1 | i = 1, . . . , n, r > si,i },
                             (r)
(3.15)                   {Ti,i+1;i | i = 1, . . . , n − 1, r > si,i+1 },
                             (r)
(3.16)                   {Ti+1,i;i | i = 1, . . . , n − 1, r > si+1,1 }
of U (p) from (3.10) generate the subalgebra W (π). Moreover, there is a unique
surjective homomorphism
(3.17)                               κ : Yn (σ) ։ W (π)
under which the generators (2.2)–(2.4) of Yn (σ) map to the corresponding genera-
tors (3.14)–(3.16) of W (π), i.e.
                 (r)      (r)              (r)        (r)            (r)         (r)
            κ(Di ) = Ti,i;i−1 ,      κ(Ei ) = Ti,i+1;i ,         κ(Fi ) = Ti+1,i;i .
                                                                           (r)
The kernel of κ is the two-sided ideal of Yn (σ) generated by {D1 | r > p1 }. Finally,
viewing Yn (σ) as a filtered algebra via the canonical filtration and W (π) as a filtered
algebra via the Kazhdan filtration, we have that κ(Fd Yn (σ)) = Fd W (π).
    From now onwards we will abuse notation by using exactly the same notation
for the elements of Yn (σ) (or Yn (σ)[[u−1 ]]) introduced in chapter 2 as for their
images in W (π) (or W (π)[[u−1 ]]) under the map κ, relying on context to decide
which we mean. So in particular we will denote the invariants (3.14)–(3.16) from
                    (r)   (r)       (r)
now on just by Di , Ei and Fi . Thus, W (π) is generated by these elements
subject only to the relations (2.7)–(2.18) together with the one additional relation
                   (r)
(3.18)           D1 = 0                          for r > p1 .
More generally, given an admissible shape ν = (ν1 , . . . , νm ) for σ, W (π) is generated
by the parabolic generators (2.54)–(2.56) subject only to the relations from [BK5,
(3.3)–(3.14)] together with the one additional relation
                  (r)
(3.19)          D1;i,j = 0                       for 1 ≤ i, j ≤ ν1 and r > p1 .
                                                                                       (r)
These parabolic generators of W (π) are also equal to certain of the Ti,j;x ’s; see
[BK5, Theorem 9.3] for the precise statement here.
    We should also mention the special case that the pyramid π is an n×l rectangle,
when the nilpotent matrix e consists of n Jordan blocks all of the same size l and
the shift matrix σ is the zero matrix. In this case, the relation (3.19) implies that
W (π) is the quotient of the usual Yangian Yn from §2.5 by the two-sided ideal
                 (r)
generated by {Ti,j | 1 ≤ i, j ≤ n, r > l}. Hence in this case W (π) is isomorphic to
the Yangian of level l introduced by Cherednik [C1, C2], as was first noticed by
Ragoucy and Sorba [RS].
                                3.5. MORE AUTOMORPHISMS                                 27


                              3.5. More automorphisms
    Suppose that π̇ is another pyramid with the same row lengths as π, and choose
a shift matrix σ̇ = (ṡi,j )1≤i,j≤n corresponding to π̇ as in §3.1. Then, viewing W (π)
as a quotient of Yn (σ) and W (π̇) as a quotient of Yn (σ̇), the automorphism ι from
(2.35) factors through the quotients to induce an isomorphism
(3.20)                               ι : W (π) → W (π̇).
Hence, the isomorphism type of the algebra W (π) only actually depends on the
conjugacy class of the nilpotent matrix e, i.e. on the row lengths (p1 , . . . , pn ) of π,
not on the pyramid π itself. We remark that there is a more conceptual explanation
of this last statement; see [BGo]. Although we are not going to give any details
here, this is the reason we have modified the definition of ι in (2.35) compared to
[BK5]: the modified ι arises in an invariant way that does not rely on the explicit
generators and relations.
    In a similar fashion, the map τ from (2.39) induces an anti-isomorphism
(3.21)                               τ :W (π) → W (π t ),
where here π t denotes the transpose pyramid (ql , . . . , q1 ) obtained by reversing the
order of the columns of π. There is another way to define this map, as follows.
Let wπ ∈ SN denote the permutation which when applied to the entries of the
diagram π numbered in the standard way down columns from left to right gives the
numbering down columns from right to left. For example, if π is as in (3.2) then
wπ = (1 11)(2 9 3 10 4 5 6 7 8). Let
(3.22)                                τ : U (g) → U (g)
be the algebra antiautomorphism mapping x ∈ g to wπ xt wπ−1 , where xt is the usual
transpose matrix. Letting p′ denote the parabolic subalgebra of g associated to the
pyramid π t , the map τ sends U (p) to U (p′ ). Considering the form of the definition
                                        (r)       (r)
(3.10) explicitly, one checks that τ (Ti,j;x ) = Tj,i;x for all 1 ≤ i, j ≤ n, 0 ≤ x ≤ n and
                               (r)
r ≥ 0, where the element Ti,j;x ∈ U (p) on the left hand side is defined using π and
               (r)
the element Tj,i;x ∈ U (p′ ) on the right hand side is defined using π t . Combining
this with the results of §3.4, it follows that τ maps the subalgebra W (π) of U (p) to
the subalgebra W (π t ) of U (p′ ), and its restriction to W (π) coincides with (3.21).
     This discussion has the following surprising consequence, for which we have
been unable to find a direct proof (i.e. without using the explicit generators).
Recalling (3.7), let η : U (p) → U (p) be the algebra automorphism defined by
(3.23)               η(ei,j ) = ei,j + δi,j (n − q1 − q2 − · · · − qcol(j) )
for each ei,j ∈ p.
    Lemma 3.1. The subalgebra W (π) of U (p) is equal to
                     {u ∈ U (p) | [η(u), x] ∈ Iχ U (g) for all x ∈ m}.
    Proof. This follows by applying the antiautomorphism τ −1 to the definition
(3.8) of W (π t ).                                                            
    There is one more useful automorphism of W (π). For a scalar c ∈ F, let
(3.24)                                ηc : U (g) → U (g)
28                                    3. FINITE W -ALGEBRAS


be the algebra automorphism mapping ei,j 7→ ei,j + δi,j c for each 1 ≤ i, j ≤ N . It is
obvious from the definitions in §3.2 that this leaves the subalgebra W (π) invariant,
hence it restricts to an algebra automorphism
(3.25)                                  ηc : W (π) → W (π)
The following lemma gives a description of ηc in terms of the generators of W (π).
      Lemma 3.2. For any c ∈ F, the following equations hold:
        (i) ηc (upi Di (u)) = (u + c)pi Di (u + c) for 1 ≤ i ≤ n;
       (ii) ηc (usi,j Ei,j (u)) = (u + c)si,j Ei,j (u + c) for 1 ≤ i < j ≤ n;
      (iii) ηc (usj,i Fi,j (u)) = (u + c)sj,i Fi,j (u + c) for 1 ≤ i < j ≤ n;
     ((iv) ηc (uSi,j Ti,j (u)) = (u + c)Si,j Ti,j (u + c) for 1 ≤ i, j ≤ n.
     Proof. It is immediate from (3.13) that
                          ηc (uSi,j Ti,j;0 (u)) = (u + c)Si,j Ti,j;0 (u + c).
We will deduce the lemma from this formula. To do so, let Tb(u) denote the n×n ma-
trix with ij-entry Ti,j;0 (u). Consider the Gauss factorization Tb(u) = Fb (u)D(u)
                                                                                b E(u)b
        b                                           b                −1    b
where D(u) is a diagonal matrix with ii-entry Di (u) ∈ U (p)[[u ]], E(u) is an up-
per unitriangular matrix with ij-entry E    bi,j (u) ∈ U (p)[[u−1 ]] and Fb (u) is a lower
unitriangular matrix with ji-entry Fbi,j (u) ∈ U (p)[[u−1 ]]. Thus,
                                           min(i,j)
                                            X
                            Ti,j;0 (u) =              Fbk,i (u)D
                                                               b k (u)E
                                                                      bk,j (u).
                                            k=1
Since Si,j = si,k + pk + sk,j , it follows that
                 min(i,j)
                    X
ηc (Ti,j;0 (u)) =         (1 + cu−1 )si,k Fbk,i (u)(1 + cu−1 )pk D
                                                                 b k (u)(1 + cu−1 )sk,j E
                                                                                        bk,j (u).
                    k=1
From this equation we can read off immediately the Gauss factorization of the
matrix ηc (Tb(u)), hence the matrices ηc (D(u)),
                                             b          b
                                                   ηc (E(u))   and ηc (Fb(u)), to get that
                                 b i (u)) = (u + c)pi D
                         ηc (upi D                    b i (u + c),
                                      bi,j (u)) = (u + c)si,j E
                            ηc (usi,j E                       bi,j (u + c),

                            ηc (usj,i Fbi,j (u)) = (u + c)sj,i Fbi,j (u + c).
The first of these equations gives (i), since by [BK5, Corollary 9.4] we have that
Db i (u) = Di (u) in U (p)[[u−1 ]]. Similarly, (ii) and (iii) for j = i + 1 follow from
the second and third equations, looking just at the negative powers of u and using
[BK5, Corollary 9.4] again. Then (ii) and (iii) for general j follow using (2.21)–
(2.22). Finally (iv) now follows from (i)–(iii) and the definition (2.34).            

                                    3.6. Miura transform
    Recall from the definition that W (π) is a subalgebra of U (p), where p is the
parabolic subalgebra with Levi factor h = glq1 ⊕· · ·⊕glql . We will often identify U (h)
with U (glq1 ) ⊗ · · · ⊗ U (glql ). Let ξ : U (p) ։ U (h) be the algebra homomorphism
induced by the natural projection p ։ h. We call the restriction
(3.26)                                     ξ : W (π) → U (h)
                                    3.6. MIURA TRANSFORM                                         29


of ξ to W (π) the Miura transform. By [BK5, Theorem 11.4] or [Ly, Corollary
2.3.2], this restriction is an injective algebra homomorphism, allowing us to view
W (π) as a subalgebra of U (h).
    Suppose that l = l′ +l′′ for non-negative integers l′ , l′′ , and let π ′ := (q1 , . . . , ql′ )
and π ′′ := (ql′ +1 , . . . , ql ). We write π = π ′ ⊗ π ′′ whenever a pyramid is cut into
two in this way. Letting h′ := glq1 ⊕ · · · ⊕ glql′ and h′′ := glql′ +1 ⊕ · · · ⊕ glql , the
Miura transform allows us to view the algebras W (π ′ ) and W (π ′′ ) as subalgebras of
U (h′ ) and U (h′′ ), respectively. Moreover, identifying h with h′ ⊕h′′ hence U (h) with
U (h′ ) ⊗ U (h′′ ), it follows from the definition [BK5, (11.2)] and injectivity of the
Miura transforms that the subalgebra W (π) of U (h) is contained in the subalgebra
W (π ′ )⊗W (π ′′ ) of U (h′ )⊗U (h′′ ). We denote the resulting inclusion homomorphism
by
(3.27)                       ∆l′ ,l′′ : W (π) → W (π ′ ) ⊗ W (π ′′ ).
This is the comultiplication from [BK5, §11] (modified slightly since we have shifted
the definition of W (π) by η). It is coassociative in an obvious sense; see [BK5,
Lemma 11.2]. The Miura transform ξ for general π may be recovered by iterating
this comultiplication a total of (l − 1) times to split π into its individual columns.
       Let us explain the relationship between ∆l′ ,l′′ and the comultiplication ∆ from
(2.74). Let π̇ ′ be the right-justified pyramid with the same row lengths as π ′ , and let
π̇ ′′ be the left-justified pyramid with the same row lengths as π ′′ . So π̇ := π̇ ′ ⊗ π̇ ′′ is
a pyramid with the same row lengths as π. Read off a shift matrix σ̇ = (ṡi,j )1≤i,j≤n
from the pyramid π̇ by choosing the integer k in (3.4) to be l′ . Finally define σ̇ ′
resp. σ̇ ′′ to be the strictly lower resp. upper triangular matrices with σ̇ = σ̇ ′ + σ̇ ′′ .
Then W (π̇) is naturally a quotient of the shifted Yangian Yn (σ̇) and similarly
W (π̇ ′ ) ⊗ W (π̇ ′′ ) is a quotient of Yn (σ̇ ′ ) ⊗ Yn (σ̇ ′′ ). Composing these quotient maps
with the isomorphisms
                        ∼                                     ∼
                W (π̇) → W (π),          W (π̇ ′ ) ⊗ W (π̇ ′′ ) → W (π ′ ) ⊗ W (π ′′ )
arising from (3.20), we obtain epimorphisms
               Yn (σ̇) ։ W (π),         Yn (σ̇ ′ ) ⊗ Yn (σ̇ ′′ ) ։ W (π ′ ) ⊗ W (π ′′ ).
Now the second part of [BK5, Theorem 11.9] together with [BK5, Remark 11.10]
asserts that the following diagram commutes:
                                          ∆
                              Yn (σ̇) −−−−→ Yn (σ̇ ′ ) ⊗ Yn (σ̇ ′′ )
                                                      
(3.28)                                                
                                y                      y
                                        ∆l′ ,l′′
                            W (π) −−−−→ W (π ′ ) ⊗ W (π ′′ ).
Using this diagram, the results about ∆ obtained in §2.5 imply analogous state-
ments for the maps ∆l′ ,l′′ : W (π) → W (π ′ )⊗W (π ′′ ) in general. For example, (2.67)
implies that
(3.29)                          ∆l′′ ,l′ ◦ τ = P ◦ τ ⊗ τ ◦ ∆l′ ,l′′ ,
equality of maps from W (π) to W ((π ′′ )t ) ⊗ W ((π ′ )t ). This can also be seen directly
from the alternative description of τ as the restriction of the map (3.22).
    Note finally that the trivial Yn (σ)-module from (2.75) factors through the quo-
                                                                              (r)   (r)
tient map κ to induce a one dimensional W (π)-module on which all Di , Ei and
30                                   3. FINITE W -ALGEBRAS

  (r)
Fi act as zero. We call this the trivial W (π)-module. It is clear from (3.10) that
it is simply the restriction of the trivial U (p)-module to the subalgebra W (π).
                                                                  (r)
                               3.7. Vanishing of higher Ti,j ’s
                                       (r)
      We wish next to show that Ti,j (viewed as an element of W (π)) is zero whenever
                                                                                 (r)
r > Si,j . In order to prove this, we derive a recursive formula for Ti,j as an element
of U (p) which is of independent interest.
    Recall the fixed choice of k from (3.1). Given k ≤ m ≤ l, let πm denote the
pyramid (q1 , . . . , qm ) of level m, i.e. the first m columns of π. Let σm be the shift
matrix for πm defined according to the formula (3.4), using the same choice of k.
Let gm denote the Lie algebra glq1 +···+qm . The usual embedding of gm into the
top left hand corner of g induces an embedding Im : U (gm ) ֒→ U (g) of universal
enveloping algebras. We need now to consider elements both of W (π) ⊆ U (g)
and of W (πm ) ⊆ U (gm ) ⊆ U (g). To avoid any confusion, we will always preceed
the latter by the embedding Im . For instance, recalling the definitions from §2.4,
                         (r)
the notation Il−1 (Ēa,b;i,j ) in the following lemma means the image of the element
  (r)
Ēa,b;i,j of W (πl−1 ) under the embedding Il−1 . We always work relative to the
minimal admissible shape ν = (ν1 , . . . , νm ) for σ.
      Lemma 3.3. Assume that q1 ≥ ql and k ≤ l − 1. Then, for all meaningful
a, b, i, j and r, we have that
                            (r)
               
                 Il−1 (Da;i,j )                                                     if a < m
               
                            (r)
               
                Il−1 (Dm;i,j
               
                              νm
                                  )
        (r)
     Da;i,j =                X           (r−1)
               
                       +        Il−1 (Dm;i,h )eq1 +···+ql−1 +h,q1 +···+ql−1 +j
               
               
               
                           hh=1                                                  i
                                     (r−1)
                        − Il−1 (Dm;i,j ), eq1 +···+ql−1 +j−ql ,q1 +···+ql−1 +j       if a = m,
               
                          (r)
                Il−1 (Ea,b;i,j )
               
               
                                                                                      if b < m
               
                 I    (Ē
                           (r)
                                    )
                l−1 a,m;i,j
               
      (r)                   X νm
   Ea,b;i,j =                            (r−1)
               
                       +        Il−1 (Ea,m;i,h )eq1 +···+ql−1 +h,q1 +···+ql−1 +j
               
               
               
                          hh=1                                                    i
               
                       − I (E
                                      (r−1)
                                            ), e                                      if b = m,
                               l−1   a,m;i,j   q1 +···+ql−1 +j−ql ,q1 +···+ql−1 +j

        (r)              (r)
     Fa,b;i,j = Il−1 (Fa,b;i,j ).
                                                      (r)
    Proof. The first equation involving Da;i,j and the second two equations in
the case b = a + 1 follow immediately from [BK5, Lemma 10.4]. The second two
equations for b > a + 1 may then be deduced in exactly the same way as [BK5,
Lemma 4.2]. In the difficult case when b = m, one needs to use Lemma 2.3 and
also the observation that
             h                                                             i
                     (r−sm−1,m (ν))
              Il−1 (Ea,m−1;i,h      ), eq1 +···+ql−1 +j−ql ,q1 +···+ql−1 +j = 0
for any 1 ≤ h ≤ νm along the way. The latter fact is checked by considering the
              (r−sm−1,m (ν))
expansion of Ea,m−1;i,h      using [BK5, Theorem 9.3] and Lemma 2.2.         
                                                                      (r)
                             3.7. VANISHING OF HIGHER Ti,j ’S                                           31


    Lemma 3.4. Assume that q1 ≥ ql and k ≤ l − 1. Then, for all 1 ≤ i, j ≤ n and
r > 0, we have that
    (r)          (r)
                        X           (r−s )         (s )
  Ti,j = Il−1 (Ti,j ) −     Il−1 (Ti,h h,j )Il−1 (Th,jh,j )
                         1≤h≤n−ql
                           sh,j ≤r
                        X                 (r−1)
                  +               Il−1 (Ti,h      )eq1 +···+ql +h−n,q1 +···+ql +j−n
                      n−ql <h≤n
                                         h                                                i
                                                  (r−1)
                                        − Il−1 (Ti,j ), eq1 +···+ql−1 +j−n,q1 +···+ql +j−n ,
omitting the last three terms on the right hand side if j ≤ n − ql .
    Proof. Take 1 ≤ a, b ≤ m, 1 ≤ i ≤ νa , 1 ≤ j ≤ νb and r > 0. By definition,
                                               min(a,b)   νc
                                                  X       X
    Tν1 +···+νa−1 +i,ν1 +···+νb−1 +j (u) =                        Fc,a;i,s (u)Dc;s,t (u)Ec,b;t,j (u).
                                                  c=1     s,t=1

Now apply Lemma 3.3 to rewrite the terms on the right hand side then simplify
using the definition (2.60).                                               
                                               (r)
    Theorem 3.5. The generators Ti,j of W (π) are zero for all 1 ≤ i, j ≤ n and
r > Si,j .
     Proof. Proceed by induction on the level l. The base case l = 1 is easy to
verify directly from the definitions. For l > 1, we may assume by applying the
antiautomorphism τ if necessary that q1 ≥ ql . Moreover we may assume that
k ≤ l − 1. Noting that Si,j − sh,j = Si,h for i, h ≤ j, the induction hypothesis
implies that all the terms on the right hand side of Lemma 3.4 are zero if r > Si,j .
         (r)
Hence Ti,j = 0.                                                                   
    Finally we describe some PBW bases for the algebra W (π). Recalling the
definition of the Kazhdan filtration on W (π) from §3.2, [BK5, Theorem 6.2] shows
that the associated graded algebra gr W (π) is free commutative on generators
                                (r)
(3.30)                  {grr Di       | 1 ≤ i ≤ n, si,i < r ≤ Si,i },
                                (r)
(3.31)                  {grr Ei,j | 1 ≤ i < j ≤ n, si,j < r ≤ Si,j },
                                (r)
(3.32)                  {grr Fi,j | 1 ≤ i < j ≤ n, sj,i < r ≤ Sj,i }.
Hence, as in [BK5, Corollary 6.3], the monomials in the elements
                             (r)
(3.33)                    {Di      | 1 ≤ i ≤ n, si,i < r ≤ Si,i },
                             (r)
(3.34)                    {Ei,j | 1 ≤ i < j ≤ n, si,j < r ≤ Si,j },
                             (r)
(3.35)                    {Fi,j | 1 ≤ i < j ≤ n, sj,i < r ≤ Sj,i }
taken in some fixed order give a basis for the algebra W (π).
    Lemma 3.6. The associated graded algebra gr W (π) is free commutative on
                  (r)
generators {grr Ti,j | 1 ≤ i, j ≤ n, si,j < r ≤ Si,j }. Hence, the monomials in the
            (r)
elements {Ti,j | 1 ≤ i, j ≤ n, si,j < r ≤ Si,j } taken in some fixed order form a basis
for W (π).
    Proof. Similar to the proof of Lemma 2.1, but using Theorem 3.5 too.                                
32                             3. FINITE W -ALGEBRAS


                    3.8. Harish-Chandra homomorphisms
     Finally in this chapter we review the classical description of the center Z(U (g))
of the universal enveloping algebra of g = glN . Recalling the notation (2.77)–(2.78),
define a monic polynomial
                                     N
                                     X      (r)
(3.36)                    ZN (u) =         ZN uN −r ∈ U (g)[u]
                                     r=0
by setting
                                                                                  
                        e1,1 + u − N + 1 · · ·              e1,N −1       e1,N
                                 ..            . ..           .
                                                               ..           ..     
                                  .                                         .     
(3.37) ZN (u) := rdet                                                             
                              eN −1,1         · · · eN −1,N −1 + u − 1 eN −1,N    
                                eN,1           ···          eN,N −1     eN,N + u
                                                                           
                        e1,1 + u          e1,2       ···           e1,N
                       e2,1         e2,2 + u − 1 · · ·            e2,N     
                                                                           
(3.38)         = cdet      ..             ..         .              .      .
                            .              .           . .          .
                                                                     .      
                          eN,1           eN,2        · · · eN,N + u − N + 1
                       (1)       (N )
Then the coefficients ZN , . . . , ZN of this polynomial are algebraically independent
and generate the center Z(U (g)). For a proof, see [CL, §2.2] where this is deduced
from the classical Capelli identity or [MNO, Remark 2.11] where it is deduced
from (2.79)–(2.80).
    So it is natural to parametrize the central characters of U (g) by monic poly-
nomials in F[u] of degree N , the polynomial f (u) corresponding to the central
character Z(U (g)) → F, ZN (u) 7→ f (u). Let P denote the free abelian group
                                           M
(3.39)                                P =      Zγa .
                                            a∈F

Given a monic f (u) ∈ F[u] of degree N , we associate the element
                                     X
(3.40)                           θ=      ca γa ∈ P
                                        a∈F

whose coefficients {ca | a ∈ F} are defined from the factorization
                                         Y
(3.41)                          f (u) =    (u + a)ca .
                                           a∈F
This defines a bijection between the set of monic polynomials of degree N and the
set of elements θ ∈ P whose coefficients are non-negative integers summing to N .
We will from now on always use this latter set to parametrize central characters.
                                         (1)       (N )
    Let us compute the images of ZN , . . . , ZN under the Harish-Chandra homo-
morphism. Let d denote the standard Cartan subalgebra of g on basis e1,1 , . . . , eN,N
and let δ1 , . . . , δN be the dual basis for d∗ . We often represent an element α ∈ d∗
simply as an N -tuple α = (a1 , . . . , aN ) of elements of the field F, defined from
     PN
α = i=1 ai δi . Also let b be the standard Borel subalgebra consisting of upper tri-
angular matrices. We will parametrize highest weight modules already in “ρ-shifted
notation”: for a weight α ∈ d∗ , let M (α) denote the Verma module of highest weight
(α − ρ), namely, the module
(3.42)                       M (α) := U (g) ⊗U(b) Fα−ρ
                        3.8. HARISH-CHANDRA HOMOMORPHISMS                                 33


induced from the one dimensional b-module of weight (α − ρ), where ρ here means
the weight (0, −1, −2, . . . , 1 − N ). Thus, if α = (a1 , . . . , aN ), the diagonal matrix
ei,i acts on the highest weight space of M (α) by the scalar (ai + i − 1). Viewing
the symmetric algebra S(d) as an algebra of functions on d∗ , with the symmetric
group SN acting by w · ei,i := ewi,wi as usual, the Harish-Chandra homomorphism
                                                 ∼
(3.43)                          ΨN : Z(U (g)) → S(d)SN
may be defined as the map sending z ∈ Z(U (g)) to the unique element of S(d) with
the property that z acts on M (α) by the scalar (ΨN (z))(α) for each α ∈ d∗ . Using
(3.38) it is easy to see directly from this definition that
(3.44)             ΨN (ZN (u)) = (u + e1,1 )(u + e2,2 ) · · · (u + eN,N ).
The coefficients on the right hand side are the elementary symmetric functions.
Define the content θ(α) of the weight α = (a1 , . . . , aN ) ∈ d∗ by setting
(3.45)                        θ(α) := γa1 + · · · + γaN ∈ P.
By (3.44), the central character of the Verma module M (α) is precisely the central
character parametrized by θ(α).
    Now return to the setup of §3.2. Let ψ : U (g) → U (p) be the linear map defined
as the composite first of the projection U (g) → U (p) along the direct sum decom-
position U (g) = U (p) ⊕ U (g)Iχ then the inverse η −1 of the automorphism η from
(3.7). The restriction of ψ to Z(U (g)) gives a well-defined algebra homomorphism
(3.46)                          ψ : Z(U (g)) → Z(W (π))
with image contained in the center of W (π). Applying this to the polynomial
                               (1)           (N )
ZN (u) we obtain elements ψ(ZN ), . . . , ψ(ZN ) of Z(W (π)). The following lemma
                                                                    (1)  (2)
explains the relationship between these elements and the elements Cn , Cn , . . . of
Z(W (π)) defined by the formula (2.76).
    Lemma 3.7. ψ(ZN (u)) = up1 (u − 1)p2 · · · (u − n + 1)pn Cn (u).
     Proof. A calculation using (3.37) shows that the image of ψ(ZN (u)) under
the Miura transform ξ : W (π) → U (glq1 ) ⊗ · · · ⊗ U (glql ) from (3.26) is equal to
Zq1 (u + q1 − n) ⊗ · · · ⊗ Zql (u + ql − n). So, since ξ is injective, we have to check that
ξ(up1 (u−1)p2 · · · (u−n+1)pn Cn (u)) also equals Zq1 (u+q1 −n)⊗· · ·⊗Zql (u+ql −n).
By (2.81) and (3.28), we have that ξ(Cn (u)) = Cn (u) ⊗ · · · ⊗ Cn (u) (l times).
Therefore it just remains to observe in the special case that π consists of a single
column of height m ≤ n, i.e. when W (π) = U (glm ), that
          (u − n + m) · · · (u − n + 2)(u − n + 1)Cn (u) = Zm (u + m − n).
This follows by a direct calculation from (2.80), exactly as in [MNO, Remark 2.11]
(which is the case m = n).                                                      
    We can also consider the Harish-Chandra homomorphism
                                                     ∼
(3.47)                Ψq1 ⊗ · · · ⊗ Ψql : Z(U (h)) → S(d)Sq1 ×···×Sql
for h = glq1 ⊕ · · · ⊕ glql , identifying U (h) with U (glq1 ) ⊗ · · · ⊗ U (glql ). By (3.44)
and the explicit computation of ξ(ψ(ZN (u))) made in the proof of Lemma 3.7, the
34                             3. FINITE W -ALGEBRAS


following diagram commutes:
                                        ∼
                        Z(U (g))    −−−−→         S(d) SN
                                       ΨN
                                                  
                            
                        ξ◦ψ y
                                                   
(3.48)                                             y
                                        ∼
                        Z(U (h)) −−−−−−−−→ S(d)Sq1 ×···×Sql
                                   Ψq1 ⊗···⊗Ψql

where the right hand map is the inclusion arising from the restriction of the auto-
morphism S(d) → S(d), ei,i 7→ ei,i + qcol(i) − n. Hence the Harish-Chandra homo-
morphism ΨN factors through the map ψ, as has been observed in much greater
generality than this by Lynch [Ly, Proposition 2.6] and Premet [P1, 6.2]. In partic-
                                                        (1)             (N )
ular this shows that ψ is injective, so the elements ψ(ZN ), . . . , ψ(ZN ) of Z(W (π))
are actually algebraically independent.
                                    CHAPTER 4


                         Dual canonical bases

      The appropriate setting for the combinatorics underlying the representation
theory of the algebras W (π) is provided by certain dual canonical bases for repre-
sentations of the Lie algebra gl∞ . In this chapter we review these matters following
[B] closely. Throughout, π denotes a fixed pyramid (q1 , . . . , ql ) with row lengths
(p1 , . . . , pn ), and N = p1 + · · · + pn = q1 + · · · + ql .

                                   4.1. Tableaux
       By a π-tableau we mean a filling of the boxes of the diagram of π with arbitrary
elements of the ground field F. Let Tab(π) denote the set of all such π-tableaux.
If π = π ′ ⊗ π ′′ for pyramids π ′ and π ′′ and we are given a π ′ -tableau A′ and a
π ′′ -tableau A′′ , we write A′ ⊗ A′′ for the π-tableau obtained by concatenating A′
and A′′ . For example,
                    1       1         1
                 A= 0 3 2 = 0 3 ⊗ 2 = 0 ⊗ 3 ⊗ 2 .
                    4 3 1   4 3   1   4   3   1
We always number the rows of A ∈ Tab(π) by 1, . . . , n from top to bottom and
the columns by 1, . . . , l from left to right, like for the diagram of π. We let γ(A)
denote the weight α = (a1 , . . . , aN ) ∈ FN obtained from A by column reading the
entries of A down columns starting with the leftmost column. For example, if A
is as above, then γ(A) = (1, 0, 4, 3, 3, 2, 1). Define the content θ(A) of A to be the
content of the
            L weight γ(A) in the sense of (3.45), an element of the free abelian
group P = a∈F Zγa .
     We say that two π-tableaux A and B are row equivalent, written A ∼row B,
if one can be obtained from the other by permuting entries within rows. The
notion ∼col of column equivalence is defined similarly. Let Row(π) denote the set
of all row equivalence classes of π-tableaux. We refer to elements of Row(π) as
row symmetrized π-tableaux. Let Col(π) denote the set of all column strict π-
tableaux, namely, the π-tableaux whose entries are strictly increasing up columns
from bottom to top according to the partial order ≥ on F defined by a ≥ b if
(a − b) ∈ N. We stress the deliberate asymmetry of these definitions: Col(π) is a
subset of Tab(π) but Row(π) is a quotient.
     Let us recall the usual definition of the Bruhat ordering on the set Row(π).
Given π-tableaux A and B, write A ↓ B if B is obtained from A by swapping an
entry x in the ith row of A with an entry y in the jth row of A, and moreover we




                                          35
36                            4. DUAL CANONICAL BASES


have that i < j and x > y. For example,
                            2 5     2 3     2 3
                            7 7   ↓ 7 7   ↓ 7 3   .
                            3 3 5   3 5 5   7 5 5
Now for A, B ∈ Row(π), the notation A ≥ B means that there exists r ≥ 1 and
π-tableaux A1 , . . . , Ar such that
(4.1)                       A ∼row A1 ↓ · · · ↓ Ar ∼row B.
It is obvious that if A ≥ B then θ(A) = θ(B) (where the content θ(A) of a row-
symmetrized π-tableau means the content of any representative for A).
     It just remains to introduce notions of dominant and of standard π-tableaux.
The first of these is easy: call an element A ∈ Row(π) dominant if it has a repre-
sentative belonging to Col(π) and let Dom(π) denote the set of all such dominant
row symmetrized π-tableaux. The notion of a standard π-tableau is more subtle.
Suppose first that π is left-justified, when its diagram is a Young diagram in the
usual sense. In that case, a π-tableau A ∈ Col(π) with entries ai,1 , . . . , ai,pi in its
ith row read from left to right is called standard if ai,j 6> ai,k for all 1 ≤ i ≤ n and
1 ≤ j < k ≤ pi . If A has integer entries (rather than arbitrary elements of F) this is
just saying that the entries of A are strictly increasing up columns from bottom to
top and weakly increasing along rows from left to right, i.e. it is the usual notion
of standard tableau.
    Lemma 4.1. Assume that π is left-justified. Then any element A ∈ Dom(π)
has a representative that is standard.
     Proof. By definition, we can choose a representative for A that is column
strict. Let ai,1 , . . . , ai,pi be the entries on the ith row of this representative read
from left to right, for each i = 1, . . . , n. We need to show that we can permute
entries within rows so that it becomes standard. Proceed by induction on
            #{(i, j, k) | 1 ≤ i ≤ n, 1 ≤ j < k ≤ pi such that ai,j > ai,k }.
If this number is zero then our tableau is already standard. Otherwise we can pick
1 ≤ i ≤ n and 1 ≤ j < k ≤ pi such that ai,j > ai,k , none of ai,j+1 , . . . , ai,k−1 lie
in the same coset of F modulo Z as ai,j , and either i = n or ai+1,j 6> ai+1,k . Then
define 1 ≤ h ≤ i to be minimal so that k ≤ ph and ar,j > ar,k for all h ≤ r ≤ i.
Thus our tableau contains the following entries:
                                  ah−1,j   ≤    ah−1,k
                                   ah,j    >     ah,k
                                  ah+1,j   >    ah+1,k
                                    ..     ..     ..
                                     .      .      .
                                   ai,j    >     ai,k
                                  ai+1,j   ≤    ai+1,k ,
where entries on the (h − 1)th and/or (i + 1)th rows should be omitted if they do
not exist. Now swap the entries ah,j ↔ ah,k , ah+1,j ↔ ah+1,k , . . . ai,j ↔ ai,k and
observe that the resulting tableau is still column strict. Finally by the induction
hypothesis we get that the new tableau is row equivalent to a standard tableau. 
                             4.2. DUAL CANONICAL BASES                                37


     To define what it means for A ∈ Col(π) to be standard for more general pyra-
mids π we need to recall the notion of row insertion; see e.g. [F, §1.1]. Suppose
we are given a weight (a1 , . . . , aN ) ∈ FN . We decide if it is admissible, and if so
construct an element of Row(π), according to the following algorithm. Start from
the diagram of π with all boxes empty. Insert a1 into some box in the bottom (nth)
row. Then if a2 6< a1 insert a2 into the bottom row too; else if a2 < a1 replace the
entry a1 by a2 and insert a1 into the next row up instead. Continue in this way:
at the ith step the pyramid π has (i − 1) boxes filled in and we need to insert the
entry ai into the bottom row. If ai is 6< all of the entries in this row, simply add it
to the row; else find the smallest entry b in the row that is strictly larger than ai ,
replace this entry b with ai , then insert b into the next row up in similar fashion.
If at any stage of this process one gets more than pi entries in the ith row for
some i, the algorithm terminates and the weight (a1 , . . . , aN ) is inadmissible; else,
the weight (a1 , . . . , aN ) is admissible and we have successfully computed a tableau
A ∈ Row(π).
     Now, for any pyramid π, we say that A ∈ Col(π) is standard if the weight
γ(A) obtained from the column reading of A is admissible. Let Std(π) denote the
set of all such standard π-tableaux. For A ∈ Std(π), we define the rectification
R(A) ∈ Row(π) to be the row symmetrized π-tableau computed from the weight
γ(A) by the algorithm described in the previous paragraph. In the special case that
π is left-justified, it is straightforward to check that the new definition of standard
tableau agrees with the one given before Lemma 4.1, and moreover in this case
the map R is simply the map sending a tableau to its row equivalence class. In
general, it is clear from the algorithm that R(A) belongs to Dom(π), i.e. it has a
representative that is column strict, so rectification gives a map
(4.2)                           R : Std(π) → Dom(π).
Define an equivalence relation k on Col(π) by declaring that A k B if B can be
obtained from A by shuffling columns of equal height in such a way that the relative
position of all columns belonging to the same coset of F modulo Z remains the same.
Then the map R : Std(π) → Dom(π) is surjective, and R(A) = R(B) if and only if
A k B, i.e. the fibres of R are precisely the k-equivalence classes. This follows in
the left-justified case using Lemma 4.1, and then in general by a result of Lascoux
and Schützenberger [LS]; see [F, §A.5] and [B, §2].
     We have now introduced all the sets Tab(π), Row(π), Col(π), Dom(π) and Std(π)
of tableaux which will be needed later on to parametrize the various bases/modules
that we will meet. We write Tab0 (π), Row0 (π), Col0 (π), Dom0 (π) and Std0 (π) for
the subsets of Tab(π), Row(π), Col(π), Dom(π) and Std(π) consisting just of the
tableaux all of whose entries are integers. In fact, most of the problems that we will
meet are reduced in a straightforward fashion to this special situation. Finally, we
define the row reading ρ(A) of A ∈ Row0 (π) to be the weight α = (a1 , . . . , aN ) ∈ ZN
obtained by reading the entries in each row of A in weakly increasing order, start-
ing with the top row. For example, if A is the row equivalence class of the tableau
displayed in the first paragraph, then ρ(A) = (1, 0, 2, 3, 1, 3, 4).

                            4.2. Dual canonical bases
    Now let gl∞ denote the Lie algebra of matrices with rows and columns labelled
by Z, all but finitely many entries of which are zero. It is generated by the usual
38                              4. DUAL CANONICAL BASES


Chevalley generators ei , fi , i.e. the matrix units ei,i+1 and ei+1,i , together with
the diagonal matrix units di = ei,i , for each i ∈ Z. The associated integral weight
lattice P∞ is the free abelian group with basis {γi | i ∈ Z} dual to {di | i ∈ Z}, and
the simple roots are γi − γi+1 for i ∈ Z. We will view P∞ as a subgroup of the
group P from (3.39). Let UZ be the Kostant Z-form for the universal enveloping
algebra U (gl∞ ), generated by the divided powers eri /r!, fir /r! and the elements
 di
     di (di −1)···(di −r+1)
  r =            r!          for all i ∈ Z, r ≥ 0. Let VZ be the natural UZ -module, that
is, the Z-submodule of the natural gl∞ -module generated by the standard basis
vectors vi (i ∈ Z).
     Consider to start with the UZ -module arising as the N th tensor power T N (VZ )
of VZ . It is a free Z-module with the monomial basis {Mα | α ∈ ZN } defined from
Mα = va1 ⊗ · · · ⊗ vaN for α = (a1 , . . . , aN ) ∈ ZN . We also need the dual canonical
basis {Lα | α ∈ ZN }. The best way to define this is to first quantize, then define Lα
using a natural bar involution on the q-tensor space, then specialize to q = 1 at the
end. We refer to [B, §4] for the details of this construction (which is due to Lusztig
[L, ch.27]); the only significant difference is that in [B] the Lie algebra gln is used in
place of the Lie algebra gl∞ here. We just content ourselves with writing down an
explicit formula for the expansion of Mα as a linear combination of Lβ ’s in terms of
the usual Kazhdan-Lusztig polynomials Px,y (q) associated to the symmetric group
SN from [KL] evaluated at q = 1. To do this, let SN act on the right on the set ZN
by place permutation in the natural way, and given any α ∈ ZN define d(α) ∈ SN
to be the unique element of minimal length with the property that α · d(α)−1 is a
weakly increasing sequence. Then, by [B, §4], we have that
                                       X
(4.3)                         Mα =         Pd(α)w0 ,d(β)w0 (1)Lβ ,
                                    β∈ZN

writing w0 for the longest element of SN .
    We also need to consider certain tensor products of symmetric and exterior
powers of VZ . Let S N (VZ ) denote the N th symmetric power of VZ , defined as a
                                                 VN
quotient of T N (VZ ) in the usual way. Also let    (VZ ) denote the N th exterior
power of VZ , viewed unusually as the subspace of T N (VZ ) consisting of all skew-
symmetric tensors. Recalling the fixed pyramid π, let
(4.4)                     S π (VZ ) := S p1 (VZ ) ⊗ · · · ⊗ S pn (VZ ),
                          Vπ           Vq                   Vq
(4.5)                         (VZ ) := 1 (VZ ) ⊗ · · · ⊗ l (VZ ).
Identifying T N (VZ ) = T p1 (VZ )⊗· · ·⊗T pn (VZ )V= T q1 (VZ )⊗· · ·⊗T ql (VZ ), we observe
that S π (VZ ) is a quotient of T N (VZ ), while π (VZ ) is a subspace. Following [B,
§5], both of these free Z-modules have two natural bases, a monomial basis and a
dual canonical basis, parametrized by the sets Row0 (π) and Col0 (π), respectively.
     First we define these two bases for the space S π (VZ ). For A ∈ Row0 (π), define
MA to be the image of Mρ(A) and LA to be the image of Lρ(A) under the canonical
quotient map T N (VZ ) ։ S π (VZ ). The monomial basis for S π (VZ ) is then the set
{MA | A ∈ Row0 (π)}, and the dual canonical basis    Vπ is {LA | A ∈ Row0 (π)}.
     Now we define the two bases for the space          (VZ ). For A ∈ Col0 (π), let
                                       X
(4.6)                        NA :=          (−1)ℓ(A,B) Mγ(B) ,
                                      B∼col A
                                4.2. DUAL CANONICAL BASES                               39


where ℓ(A, B) denotes the minimal number of transpositions of adjacent elements
in the same column needed to get from A to B. Also let KA Vdenote the vector
Lγ(A) ∈ T N (VZ ). Then both NA and KA belong to the subspace π (VZ ) of T N (VZ );
see [B, §5]. Moreover, {NA | A ∈ Col0 (π)} and {KA | A ∈ Col0 (π)} are bases for
V π
    (VZ ), giving the monomial basis and the dual canonical basis, respectively.
     The following formulae, derived in [B, §5] as consequences of (4.3), express the
monomial bases in terms of the dual canonical bases and certain Kazhdan-Lusztig
polynomials:
                      X
(4.7)       MA =           Pd(ρ(A))w0 ,d(ρ(B))w0 (1)LB ,
                  B∈Row0 (π)
                                                                              !
                     X            X
                                              ℓ(A,C)
(4.8)      NA =                           (−1)         Pd(γ(C))w0 ,d(γ(B))w0 (1) KB ,
                  B∈Col0 (π)    C∼col A

for A ∈ Row0 (π) and A ∈ Col0 (π), respectively.
     Note that S π (VZ ) is a summand of the commutative algebra S(VZ )⊗· · ·⊗S(VZ ),
that is, the tensor product of n copies of the symmetric algebra S(VZ ). In particular,
if π = π ′ ⊗π ′′ , the multiplication in this algebra defines a UZ -module homomorphism
                                    ′            ′′
(4.9)                        µ : S π (VZ ) ⊗ S π (VZ ) → S π (VZ ).
If we decompose π into its individual columns as π = π1 ⊗ · · · ⊗ πl , and then iterate
the map (4.9) a total of (l − 1) times, we get a multiplication map
                            S π1 (VZ ) ⊗ · · · ⊗ S πl (VZ ) → S π (VZ ).
Identifying S π1 (VZ ) ⊗ · · · ⊗ S πl (VZ ) with T N (VZ ) in the obvious fashion, this map
gives us a surjective homomorphism
(4.10)                              V : T N (VZ ) ։ S π (VZ )
which is different from the canonical quotient map: V maps Mγ(A) to MB , for
A ∈ Tab0V (π) with row equivalence class B. Define P π (VZ ) to be the image of the
            π
subspace      (VZ ) of T N (VZ ) under this map V. Thus, the restriction of V defines a
surjective homomorphism
                                     V
(4.11)                            V : π (VZ ) ։ P π (VZ ).
The UZ -module P π (VZ ) is a well known Z-form for the irreducible polynomial
representation of gl∞ parametrized by the partition λ = (p1 , . . . , pn ). For any
A ∈ Col0 (π), define
(4.12)                                    VA := V(NA ).
                        π
By a classical result, P (VZ ) is a free Z-module with standard monomial basis given
by the vectors {VA | A ∈ Std0 (π)}; see [B, Theorem 26] for a non-classical proof.
Moreover, for A ∈ Col0 (π), we have that
                                    
                                       LR(A) if A ∈ Std0 (π),
(4.13)                  V(KA ) =
                                       0      otherwise,
recalling the rectification map R from (4.2). The vectors {LA | A ∈ Dom0 (π)}
give another basis for the submodule P π (VZ ), which is the dual canonical basis of
40                                 4. DUAL CANONICAL BASES


Lusztig, or Kashiwara’s upper global crystal basis. Finally, by (4.8) and (4.13), we
have for any A ∈ Col0 (π) that
                                                                        !
                   X           X
                                        ℓ(A,C)
(4.14)      VA =                   (−1)        Pd(γ(C))w0 ,d(γ(B))w0 (1) LR(B) .
                      B∈Std0 (π)    C∼col A

                                          4.3. Crystals
     In this section, we introduce the crystals underlying the UZ -modules T N (VZ ),
Vπ
    (VZ ), S π (VZ ) and P π (VZ ). First, we define a crystal (ZN , ẽi , f˜i , εi , ϕi , θ) in the
sense of Kashiwara [K2], as follows. Take α = (a1 , . . . , aN ) ∈ ZN and i ∈ Z. The
i-signature of α is the tuple (σ1 , . . . , σN ) defined from
                                       
                                        + if aj = i,
(4.15)                           σj =      − if aj = i + 1,
                                       
                                           0 otherwise.
From this the reduced i-signature is computed by successively replacing subse-
quences of the form −+ (possibly separated by 0’s) in the signature with 00 until no
− appears to the left of a +. Recall δj denotes the weight (0, . . . , 0, 1, 0, . . . , 0) ∈ FN
where 1 appears in the jth place. Define
                      
                        ∅       if there are no −’s in the reduced i-signature,
(4.16)     ẽi (α) :=
                        α − δj if the leftmost − is in position j;
                      
            ˜           ∅       if there are no +’s in the reduced i-signature,
(4.17)     fi (α) :=
                        α + δj if the rightmost + is in position j;
(4.18)       εi (α) = the total number of −’s in the reduced i-signature;
(4.19)       ϕi (α) = the total number of +’s in the reduced i-signature.
Finally define θ : ZN → P∞ to be the restriction of the map (3.45). This completes
the definition of the crystal (ZN , ẽi , f˜i , εi , ϕi , θ). It is the N -fold tensor product of
the usual crystal associated to the natural module VZ (but for the opposite tensor
product to the one used in [K2]). This crystal carries information about the action
of the Chevalley generators of UZ on the dual canonical basis {Lα | α ∈ ZN } of
T N (VZ ), thanks to the following result of Kashiwara [K1, Proposition 5.3.1]: for
α ∈ ZN , we have that
                                                           X
(4.20)               ei Lα = εi (α)Lẽi (α) +                        xiα,β Lβ
                                                          β∈ZN
                                                     εi (β)<εi (α)−1
                                                           X
                                                                        i
(4.21)                   fi Lα = ϕi (α)Lf˜i (α) +                      yα,β Lβ
                                                               N
                                                          β∈Z
                                                     ϕi (β)<ϕi (α)−1

for xiα,β , yα,β
             i
                 ∈ Z. The right hand side of (4.20) resp. (4.21) should be interpreted
as zero if εi (α) = 0 resp. ϕi (α) = 0.                                      Vπ
    There are also crystals attached to the modules S π (VZ ) and                   (VZ ). To define
them, identify Row0 (π) with a subset of ZN by row reading ρ : Row0 (π) ֒→ ZN ,
and identify Col0 (π) with a subset of ZN by column reading γ : Col0 (π) ֒→ ZN .
In this way, both Row0 (π) and Col0 (π) become identified with subcrystals of
the crystal (ZN , ẽi , f˜i , εi , ϕi , θ). This defines crystals (Row0 (π), ẽi , f˜i , εi , ϕi , θ) and
             4.4. CONSEQUENCES OF THE KAZHDAN-LUSZTIG CONJECTURE                               41


(Col0 (π), ẽi , f˜i , εi , ϕi , θ). These crystals control the action of the Chevalley genera-
tors of UZ on the dual canonical bases {LA | A ∈ Row0 (π)} and {KA | A ∈ Col0 (π)},
just like in (4.20)–(4.21). First, for A ∈ Row0 (π), we have that
                                                       X
(4.22)                  ei LA = εi (A)Lẽi (A) +                xiρ(A),ρ(B) LB ,
                                                B∈Row0 (π)
                                              εi (B)<εi (A)−1
                                                    X
                                                                  i
(4.23)             fi LA = ϕi (A)Lf˜i (A) +                      yρ(A),ρ(B) LB .
                                                B∈Row0 (π)
                                              ϕi (B)<ϕi (A)−1

Second, for A ∈ Col0 (π), we have that
                                                   X
(4.24)            ei KA = εi (A)Kẽi (A) +                      xiγ(A),γ(B) KB ,
                                                 B∈Col0 (π)
                                              εi (B)<εi (A)−1
                                                    X
                                                                  i
(4.25)            fi KA = ϕi (A)Kf˜i (A) +                       yγ(A),γ(B) KB .
                                                 B∈Col0 (π)
                                              ϕi (B)<ϕi (A)−1

     Finally, there is a well known crystal attached to the polynomial representation
P π (VZ ). This has various different realizations, in terms of either the set Dom0 (π)
or the set Std0 (π); the realization as Std0 (π) when π is left-justified is the usual
description from [KN]. In the first case, we note that Dom0 (π) is a subcrystal of
the crystal (Row0 (π), ẽi , f˜i , εi , ϕi , θ), indeed it is the connected component of this
crystal generated by the row equivalence class of the ground-state tableau A0 , that
is, the tableau having all entries on row i equal to (1 − i). In the second case, as
explained in [B, §2], Std0 (π) is a subcrystal of the crystal (Col0 (π), ẽi , f˜i , εi , ϕi , θ),
indeed again it is the connected component of this crystal generated by the ground-
state tableau A0 . In this way, we obtain two new crystals (Dom0 (π), ẽi , f˜i , εi , ϕi , θ)
and (Std0 (π), ẽi , f˜i , εi , ϕi , θ). The rectification map R : Std0 (π) → Dom0 (π) is the
unique isomorphism between these crystals, and it sends the ground-state tableau
A0 to its row equivalence class.

            4.4. Consequences of the Kazhdan-Lusztig conjecture
     In this section, we record a representation
                                              Vπ theoretic interpretation of the dual
canonical basis of the spaces T N (VZ ) and       (VZ ), which is a well known refor-
mulation of the Kazhdan-Lusztig conjecture [BB, BrK] in type A. Later on in
the article we will formulate analogous interpretations for the dual canonical bases
of the spaces S π (VZ ) (conjecturally) and P π (VZ ). Go back to the notation from
§3.8, so g = glN , d is the standard Cartan subalgebra of diagonal matrices and
b is the standard Borel subalgebra of upper triangular matrices. Let O denote
the [BGG3] category of all finitely generated g-modules which are locally finite
over b and semisimple over d. The basic objects in O are the Verma modules
M (α) and their unique irreducible quotients L(α) for α = (a1 , . . . , aN ) ∈ FN , using
the ρ-shifted notation explained by (3.42). Also recall that we have   L parametrized
the central characters of U (g) by the set of elements θ of P =          a∈F Zγa whose
coefficients are non-negative integers summing to N .
     For θ ∈ P , let O(θ) denote the full subcategory of O consisting of the objects
all of whose composition factors are of central character θ, setting O(θ) = 0 by
42                            4. DUAL CANONICAL BASES


convention if the coefficients of θ are not non-negative integers summing to N . The
category O has the following “block” decomposition:
                                          M
(4.26)                               O=       O(θ).
                                          θ∈P

(For non-integral central characters our “blocks” are not necessarily indecompos-
able.) We will write prθ : O → O(θ) for the natural projection functor. To be
absolutely explicit, if the coefficients of θ ∈ P are non-negative integers summing
to N so θ corresponds to the polynomial f (u) = uN + f (1) uN −1 + · · · + f (N ) ∈ F[u]
according to (3.40)–(3.41), we have that
                                                                              
                                  for each r = 1, . . . , N there exists p > 0
(4.27)      prθ (M ) = v ∈ M                   (r)                              .
                                    such that (Z − f (r) )p v = 0
                                                   N
We have already observed in §3.8 that the Verma module M (α) is of central char-
acter θ(α). Hence, for any θ ∈ P , the modules {L(α) | α ∈ FN with θ(α) = θ} form
                                                                       O(θ).
a complete set of pairwise non-isomorphic irreducibles in the category L
    Recall that the integral weight lattice P∞ of gl∞ is the subgroup i∈Z Zγi of
P . Let us restrict our attention from now on to the full subcategory
                                         M
(4.28)                           O0 =         O(θ)
                                         θ∈P∞ ⊂P

of O corresponding just to integral central characters. The Grothendieck group [O0 ]
of this category has the two natural bases {[M (α)] | α ∈ ZN } and {[L(α)] | α ∈ ZN }.
Define a Z-module isomorphism
(4.29)                 j : T N (VZ ) → [O0 ],      Mα 7→ [M (α)].
Note this isomorphism sends the θ-weight space of T N (VZ ) isomorphically onto the
block component [O(θ)] of [O0 ], for each θ ∈ P∞ . The Kazhdan-Lusztig conjecture
[KL], proved in [BB, BrK], can be formulated as follows for the special case of
the Lie algebra glN .
     Theorem 4.2. The map j sends the dual canonical basis element Lα of T N (VZ )
to the class [L(α)] of the irreducible module L(α).
   Proof. In view of (4.3), it suffices to show for α, β ∈ ZN that the composition
multiplicity of L(β) in the Verma module M (α) is given by the formula
                         [M (α) : L(β)] = Pd(α)w0 ,d(β)w0 (1).
This is well known consequence of the Kazhdan-Lusztig conjecture combined with
the translation principle for singular weights, or see [BGS, Theorem 3.11.4]. 
     Using (4.29) we can view the action of UZ on T N (VZ ) instead as an action on the
Grothendieck group [O0 ]. The resulting actions of the Chevalley generators ei , fi
of UZ on [O0 ] are in fact induced by some exact functors ei , fi : O0 → O0 on the
category O0 itself. Like in [BK1], these functors are certain translation functors
arising from tensoring with the natural g-module or its dual then projecting onto
certain blocks. To be precise, let V denote the natural N -dimensional g-module of
            4.4. CONSEQUENCES OF THE KAZHDAN-LUSZTIG CONJECTURE                      43


column vectors and let V ∗ be its dual. Then, for i ∈ Z, we have that
                           M
(4.30)              ei =        prθ+(γi −γi+1 ) ◦ (? ⊗ V ∗ ) ◦ prθ ,
                            θ∈P∞
                              M
(4.31)                 fi =          prθ−(γi −γi+1 ) ◦ (? ⊗ V ) ◦ prθ .
                              θ∈P∞

These exact functors are both left and right adjoint to each other in a canonical
way (induced by the standard adjunctions between ? ⊗ V and ? ⊗ V ∗ ). The next
lemma is a well known consequence of the tensor identity.
    Lemma 4.3. For α ∈ FN , the module M (α) ⊗ V has a filtration with factors
M (β) for all weights β ∈ FN obtained from α by adding 1 to one of its entries.
Similarly, the module M (α) ⊗ V ∗ has a filtration with factors M (β) for all weights
β ∈ FN obtained from α by subtracting 1 from one of its entries.
    Taking blocks and passing to the Grothendieck group, we deduce for α ∈ ZN
and i ∈ Z that
                                          X
(4.32)                       [ei M (α)] =  [M (β)]
                                                  β
                                     N
summing over all weights β ∈ Z           obtained from α by replacing an entry equal to
(i + 1) by an i, and
                                                X
(4.33)                           [fi M (α)] =    [M (β)]
                                                  β

summing over all weights β ∈ ZN obtained from α by replacing an entry equal to i
by an (i + 1). This verifies that the maps on the Grothendieck group [O0 ] induced
by the exact functors ei , fi really do coincide with the action of the Chevalley
generators of UZ from (4.29).
     Here is an alternative definition of the functors ei and fi , explained in detail
                           PN
in [CR, §7.4]. Let Ω = i,j=1 ei,j ⊗ ej,i ∈ U (g) ⊗ U (g). This element centralizes
the image of U (g) under the comultiplication ∆ : U (g) → U (g) ⊗ U (g). For any
M ∈ O0 , fi M is precisely the generalized i-eigenspace of the operator Ω acting on
M ⊗ V , for any M ∈ O0 . Similarly, ei M is the generalized −(N + i)-eigenspace of
Ω acting on M ⊗ V ∗ .
     We need to recall a little more of the setup from [CR]. Define an endomorphism
x of the functor ? ⊗ V by letting xM : M ⊗ V → M ⊗ V be left multiplication by Ω,
for all g-modules M . Also define an endomorphism s of the functor ? ⊗ V ⊗ V by
letting sM : M ⊗ V ⊗ V → M ⊗ V ⊗ V be the permutation m ⊗ v ⊗ v ′ 7→ m ⊗ v ′ ⊗ v.
By [CR, Lemma 7.21], we have that
(4.34)              sM ◦ (xM ⊗ idV ) = xM⊗V ◦ sM − idM⊗V ⊗V
for any g-module M , equality of maps from M ⊗ V ⊗ V to itself. It follows that x
and s restrict to well-defined endomorphisms of the functors fi and fi2 ; we denote
these restrictions by x and s too. Moreover, we have that
(4.35)            (s1fi ) ◦ (1fi s) ◦ (s1fi ) = (1fi s) ◦ (s1fi ) ◦ (1fi s),
(4.36)                                     s2 = 1fi2 ,
(4.37)                           s ◦ (1fi x) = (x1fi ) ◦ s − 1fi2 ,
44                            4. DUAL CANONICAL BASES


equality of endomorphisms of fi3 , fi2 and fi2 , respectively. In the language of [CR,
§5.2.1], this shows that the category O0 equipped with the adjoint pair of func-
tors (fi , ei ) and the endomorphisms x ∈ End(fi ) and s ∈ End(fi2 ) is an sl2 -
categorification for each i ∈ Z. This has a number of important consequences,
explored in detail in [CR]. We just record one more thing here, our proof of which
also depends on Theorem 4.2; see [Ku] for an independent proof. Recall for the
statement the definition of the crystal (ZN , ẽi , f˜i , εi , ϕi , θ) from (4.16)–(4.19).
     Theorem 4.4. Let α ∈ ZN and i ∈ Z.
       (i) If εi (α) = 0 then ei L(α) = 0. Otherwise, ei L(α) is an indecomposable
           module with irreducible socle and cosocle isomorphic to L(ẽi (α)).
      (ii) If ϕi (α) = 0 then fi L(α) = 0. Otherwise, fi L(α) is an indecomposable
           module with irreducible socle and cosocle isomorphic to L(f˜i (α)).
      Proof. (i) For α ∈ ZN , let ε′i (α) be the maximal integer k ≥ 0 such that
(ei ) L(α) 6= 0. If ε′i (α) > 0, then [CR, Proposition 5.23] shows that ei L(α) is an
     k

indecomposable module with irreducible socle and cosocle isomorphic to L(ẽ′i (α))
for some ẽ′i (α) ∈ ZN . Moreover, using [CR, Lemma 4.3] too, ε′i (ẽ′i (α)) = ε′i (α) − 1
and all remaining composition factors of ei L(α) not isomorphic to L(ẽ′i (α)) are of
the form L(β) for β ∈ ZN with ε′i (β) < ε′i (α) − 1.
      Observe from (4.20) that εi (α) is the maximal integer k ≥ 0 such that (ei )k Lα 6=
0, and assuming εi (α) > 0 we know that ei Lα = εi (α)Lẽi (α) plus a linear combi-
nation of Lβ ’s with εi (β) < εi (α) − 1. Applying Theorem 4.2 and comparing with
the preceeding paragraph, it follows immediately that εi (α) = ε′i (α), in which case
ẽi (α) = ẽ′i (α). This completes the proof.
      (ii) Similar, or follows from (i) using adjointness.                              
    It just remains to extend all of this to the parabolic case. Continuing with
the fixed pyramid π = (q1 , . . . , ql ), recall from (3.2) that h denotes the standard
Levi subalgebra glq1 ⊕ · · · ⊕ glql of g and p is the corresponding standard parabolic
subalgebra of g. Let O(π) denote the parabolic category O consisting of all finitely
generated g-modules that are locally finite dimensional over p and semisimple over
h. Note O(π) is a full subcategory of the category O. To define the basic modules
in O(π), let A ∈ Col(π) be a column strict π-tableau and let α = (a1 , . . . , aN ) ∈ FN
denote the weight γ(A) obtained from column reading A as in §4.1. Let V (α) denote
the usual finite dimensional irreducible h-module of highest weight
                        α − ρ = (a1 , a2 + 1, . . . , aN + N − 1).
View V (α) as a p-module through the natural projection p ։ h, then form the
parabolic Verma module
(4.38)                        N (A) := U (g) ⊗U(p) V (α).
The unique irreducible quotient of N (A) is denoted K(A); by comparing highest
weights we have that K(A) ∼     = L(α). In this way, we obtain two natural bases
{[N (A)] | A ∈ Col(π)} and {[K(A)] | A ∈ Col(π)} for the Grothendieck group [O(π)]
of O(π). The vectors {[N (A)] | A ∈ Col0 (π)} and {[K(A)] | A ∈ Col0 (π)} form bases
for the Grothendieck group [O0 (π)] of the full subcategory O0 (π) := O(π) ∩ O0 .
Moreover, the translation functors ei , fi from (4.30)–(4.31) send modules in O0 (π)
to modules in O0 (π), hence the Grothendieck group [O0 (π)] is a UZ -submodule of
[O0 (π)]. Also recall the definition of the crystal structure on Col0 (π) from §4.3.
           4.4. CONSEQUENCES OF THE KAZHDAN-LUSZTIG CONJECTURE                    45

                                                                 Vπ
    Theorem 4.5. There is a unique UZ -module isomorphism i :       (VZ ) → [O0 (π)]
such that i(NA ) = [N (A)] and i(KA ) = [K(A)] for each A ∈ Col0 (π). Moreover,
for A ∈ Col0 (π) and i ∈ Z, the following properties hold:
      (i) If εi (A) = 0 then ei K(A) = 0. Otherwise, ei K(A) is an indecomposable
          module with irreducible socle and cosocle isomorphic to K(ẽi (A)).
     (ii) If ϕi (A) = 0 then fi K(A) = 0. Otherwise, fi K(A) is an indecomposable
          module with irreducible socle and cosocle isomorphic to K(f˜i (A)).
                                                     Vπ
    Proof. Define a Z-module isomorphism i :            (VZ ) → [O0 (π)] by setting
i(NA ) := [N (A)] for each A ∈ Col0 (π). We observe that the following diagram
commutes:
                              Vπ
                                  (VZ ) −−−−→ T N (VZ )
                                                 
                                                 j
(4.39)                           iy               y
                               [O0 (π)] −−−−→ [O0 ]
where the horizontal maps are the natural inclusions. This is checked by comput-
ing the image either way round the diagram of NA : one way round one uses the
definitions (4.6) and (4.29); the other way round uses the Weyl character formula
to express [V (α)] as a linear combination of Verma modules over h, then exact-
ness of the functor U (g)⊗U(p) ? to express [N (A)] as a linear combination of Verma
modules over g. Since we already know that all of the maps apart from i are UZ -
module homomorphisms, it then follows that i is too. To complete the proof of the
first statement of the theorem, it just remains to show that i(KA ) = [K(A)]. This
follows by Theorem 4.2 because K(A) ∼    = L(γ(A)) and KA = Lγ(A) . The remaining
statements (i) and (ii) follow from Theorem 4.4.                                   
                                        CHAPTER 5


                         Highest weight theory

     In this chapter, we set up the usual machinery of highest weight theory for the
shifted Yangian Yn (σ), exploiting its triangular decomposition. Fix throughout a
shift matrix σ = (si,j )1≤i,j≤n .

                             5.1. Admissible modules
    Recall the definition of the Lie subalgebra c of Yn (σ) from §2.1, and the root
decomposition (2.20). Given a c-module M and a weight α ∈ c∗ , the generalized
α-weight space of M is the subspace
                                                                        
                            for each i = 1, . . . , n there exists p > 0
(5.1)      Mα := v ∈ M                   (1)           (1)                .
                              such that (D − α(D ))p v = 0
                                                 i       i
We say that M is admissible if
                                                                           L
      (a) M is the direct sum of its generalized weight spaces, i.e. M = α∈c∗ Mα ;
      (b) each Mα is finite dimensional;
      (c) the set of all α ∈ c∗ such that Mα is non-zero is contained in a finite union
          of sets of the form D(β) := {α ∈ c∗ | α ≤ β} for β ∈ c∗ .
Given a c-module M satisfying (a), we define its restricted dual
                                          M
(5.2)                               M :=     (Mα )∗
                                           α∈c∗
to be the direct sum of the duals of its generalized weight spaces.
     By an admissible Yn (σ)-module, we mean a left Yn (σ)-module which is admis-
sible when viewed as a c-module by restriction. In that case, M is naturally a
right Yn (σ)-module with action (f x)(v) = f (xv) for f ∈ M , v ∈ M and x ∈ Yn (σ).
Hence twisting with the inverse of the anti-isomorphism τ : Yn (σ) → Yn (σ t ) from
(2.39) we can view M instead as a left Yn (σ t )-module, which we denote by M τ .
It is obvious that M τ is also admissible. Indeed, making the obvious definition on
morphisms, ?τ can be viewed as a contravariant equivalence between the categories
of admissible Yn (σ)- and Yn (σ t )-modules.

                         5.2. Gelfand-Tsetlin characters
     Next, let Pn denote the set of all power series A(u) = A1 (u1 )A2 (u2 ) · · · An (un )
in indeterminates u1 , . . . , un such that each Ai (u) belongs to 1 + u−1 F[[u−1 ]]. Note
that Pn is an abelian group under multiplication. For A(u) ∈ Pn , we always write
Ai (u) for the ith power series defined from the equation A(u) = A1 (u1 ) · · · An (un )
       (r)
and Ai for the u−r -coefficient of Ai (u). The associated weight of A(u) ∈ Pn is
defined by
                                  (1)       (1)
(5.3)              wt A(u) := A1 ε1 + A2 ε2 + · · · + A(1)     ∗
                                                       n εn ∈ c .


                                            47
48                           5. HIGHEST WEIGHT THEORY


Now we form the P                       b n ]. The elements of Z[P
                completed group algebra Z[P                    b n ] consist of
formal sums S = A(u)∈Pn mA(u) [A(u)] for integers mA(u) with the property that
      (a) the set {wt A(u) | A(u) ∈ supp S} is contained in a finite union of sets of
          the form D(β) for β ∈ c∗ ;
      (b) for each α ∈ c∗ the set {A(u) ∈ supp S | wt A(u) = α} is finite,
where supp S denotes {A(u) ∈ Pn | mA(u) 6= 0}. There is an obvious multiplication
    b n ] extending the rule [A(u)][B(u)] = [A(u)B(u)].
on Z[P
     Given an admissible Yn (σ)-module M and A(u) ∈ Pn , the corresponding
Gelfand-Tsetlin subspace of M is defined by
                                                                              
                              for each i = 1, . . . , n and r > 0 there exists
(5.4)      MA(u) := v ∈ M                            (r)    (r)                 .
                                p > 0 such that (D − A )p v = 0
                                                      i        i
                                                                           (r)
Since the weight spaces of M are finite dimensional and the operators Di         commute
with each other, we have for each α ∈ c∗ that
                                         M
(5.5)                         Mα =             MA(u) .
                                       A(u)∈Pn
                                       wt A(u)=α

Hence, since M is the direct sum of its generalized
                                              L weight spaces, it is also the direct
sum of its Gelfand-Tsetlin subspaces: M = A(u)∈Pn MA(u) . Now we are ready
to introduce a notion of Gelfand-Tsetlin character of an admissible Yn (σ)-module
M , which is analogous to the characters of Knight [Kn] for Yangians in general
and of Frenkel and Reshetikhin [FR] in the setting of quantum affine algebras: set
                                   X
(5.6)                   ch M :=           (dim MA(u) )[A(u)].
                                  A(u)∈Pn

By the definition of admissibility, ch M belongs to the completed group algebra
b n ]. For example, the Gelfand-Tsetlin character of the trivial Yn (σ)-module is
Z[P
[1].
     For the first lemma, recall the comultiplication ∆ : Yn (σ) → Yn (σ ′ ) ⊗ Yn (σ ′′ )
from (2.74), where σ ′ resp. σ ′′ is the strictly lower resp. upper triangular matrix
such that σ = σ ′ + σ ′′ . This allows us to view the tensor product of a Yn (σ ′ )-
module M ′ and a Yn (σ ′′ )-module M ′′ as a Yn (σ)-module. We will always denote
this “external” tensor product by M ′ ⊠ M ′′ , to avoid confusion with the usual
“internal” tensor product of g-modules which we will also exploit later on. We
                     (1)     (1)              (1)
point out that ∆(DP  i ) = Di ⊗ 1 + 1 ⊗ Di , so the generalized α-weight space of
M ⊠ N is equal to β∈c∗ Mβ ⊗ Mα−β .
   Lemma 5.1. Suppose that M ′ is an admissible Yn (σ ′ )-module and M ′′ is an
admissible Yn (σ ′′ )-module. Then M ′ ⊠ M ′′ is an admissible Yn (σ)-module, and
                          ch(M ′ ⊠ M ′′ ) = (ch M ′ )(ch M ′′ ).
    Proof. The fact that M ′ ⊠ M ′′ is admissible is obvious. To compute its
                                     ′
            P the set of weights of M as α1 , α2 , . . . so that αj > αk ⇒ j < k. Let
character, order
Mj′ denote 1≤k≤j Mα′ k . Then Theorem 2.5(i) implies that the subspace Mj′ ⊗ M ′′
                                                     (r)
of M ′ ⊗ M ′′ is invariant under the action of all Di . Moreover in order to compute
                                  5.3. HIGHEST WEIGHT MODULES                        49


the Gelfand-Tsetlin character of M ′ ⊠ M ′′ , we can replace it by
             M                                   M
                 (Mj′ ⊗ M ′′ )/(Mj−1
                                 ′
                                     ⊗ M ′′ ) =     (Mj′ /Mj−1
                                                           ′
                                                               ) ⊗ M ′′
                 j≥1                                          j≥1

with Di (u) acting as Di (u) ⊗ Di (u).                                               
    The next lemma is concerned with the duality ?τ on admissible modules.
    Lemma 5.2. For an admissible Yn (σ)-module M , we have that ch(M τ ) = ch M .
                   (r)           (r)
    Proof. τ (Di ) = Di .                                                            

                                5.3. Highest weight modules
    For A(u) ∈ Pn , a vector v in a Yn (σ)-module M is called a highest weight
vector of type A(u) if
           (r)
      (a) Ei v = 0 for all i = 1, . . . , n − 1 and r > si,i+1 ;
            (r)     (r)
     (b) Di v = Ai v for all i = 1, . . . , n and r > 0.
We call M a highest weight module of type A(u) if it is generated by such a high-
est weight vector. The following lemma gives an equivalent way to state these
                                           (r)
definitions in terms of the elements Ti,j from (2.34).
    Lemma 5.3. A vector v in a Yn (σ)-module is a highest weight vector of type
                           (r)                                            (r)     (r)
A(u) if and only if Ti,j v = 0 for all 1 ≤ i < j ≤ n and r > si,j , and Ti,i v = Ai v
for all i = 1, . . . , n and r > 0.
    Proof. By the definition (2.34), the left ideal of Yn (σ) generated by
                                   (r)
                                {Ei      | i = 1, . . . , n − 1, r > si,i+1 }
coincides with the left ideal generated by
                                       (r)
                                  {Ti,j | 1 ≤ i < j ≤ n, r > si,j }.
            (r)          (r)
Moreover, Ti,i ≡ Di            modulo this left ideal.                               
    In the next lemma, we write σ = σ ′ + σ ′′ where σ ′ resp. σ ′′ is strictly lower
resp. upper triangular.
    Lemma 5.4. Suppose v is a highest weight vector in a Yn (σ ′ )-module M of type
A(u) and w is a highest weight vector in a Yn (σ ′′ )-module N of type B(u). Then
v ⊗ w is a highest weight vector in the Yn (σ)-module M ⊠ N of type A(u)B(u).
    Proof. Apply Theorem 2.5.                                                        
    To construct the universal highest weight module of type A(u), let FA(u) denote
                                               (r)                     (r)
the one dimensional Y(1n ) -module on which Di acts as the scalar Ai . Inflating
                             ♯
through the epimorphism Y(1n ) (σ) ։ Y(1n ) from (2.31), we can view FA(u) instead
as a Y(1♯ n ) (σ)-module. Now form the induced module
(5.7)                          M (σ, A(u)) := Yn (σ) ⊗Y ♯ n          (σ)   FA(u) .
                                                              (1 )

This is a highest weight module of type A(u), generated by the highest weight
vector v+ := 1 ⊗ 1. Clearly it is the universal such module, i.e. all other highest
weight modules of this type are quotients of M (σ, A(u)). In the next theorem we
record two natural bases for M (σ, A(u)).
50                              5. HIGHEST WEIGHT THEORY


    Theorem 5.5. For any A(u) ∈ Pn , the following sets of vectors give bases for
the module M (σ, A(u)):
      (i) {xv+ | x ∈ X}, where X denotes the collection of all monomials in the
                      (r)
          elements {Fi,j | 1 ≤ i < j ≤ n, sj,i < r} taken in some fixed order;
     (ii) {yv+ | y ∈ Y }, where Y denotes the collection of all monomials in the
                     (r)
          elements {Tj,i | 1 ≤ i < j ≤ n, sj,i < r} taken in some fixed order.
      Proof. Let M := M (σ, A(u)).
      (i) The isomorphism (2.29) implies that Yn (σ) is a free right Y(1♯ n ) (σ)-module
with basis X. Hence M has basis {xv+ | x ∈ X}.
      (ii) Recall the definition of the canonical filtration F0 Yn (σ) ⊆ F1 Yn (σ) ⊆ · · · of
Yn (σ) from §2.2. In view of Lemma 2.1, it may also be defined by declaring that all
  (r)
Ti,j are of degree r. Also introduce a filtration F0 M ⊆ F1 M ⊆ · · · of M by setting
Fd M := Fd Yn (σ)v+ . Let X (d) resp. Y (d) denote the set of all monomials in the
elements X resp. Y of total degree at most d in the canonical filtration.       Applying  	
(i), one deduces at once that the set of all vectors of the form xv+ | x ∈ X (d)
form a basis for	 Fd M . On the other hand using Lemmas 2.1 and 5.3, the vectors

  yv+ | y ∈ YS(d) span Fd M . By dimension they must be linearly independent too.
Since M = d≥0 Fd M , this implies that the vectors {yv+ | y ∈ Y } give a basis for
M itself.                                                                                  
    This implies that the (generalized) wt A(u)-weight space of M (σ, A(u)) is one
dimensional, spanned by the vector v+ , while all other weights are strictly lower
in the dominance ordering. Given this, the usual argument shows that M (σ, A(u))
has a unique maximal submodule denoted rad M (σ, A(u)). Set
(5.8)                  L(σ, A(u)) := M (σ, A(u))/ rad M (σ, A(u)).
This is the unique (up to isomorphism) irreducible highest weight module of type
A(u) for the algebra Yn (σ). We also note that
(5.9)                          dim EndYn (σ) (L(σ, A(u))) = 1
for any A(u) ∈ Pn .

        5.4. Classification of admissible irreducible representations
     A natural question arises at this point: the module M (σ, A(u)) is certainly not
admissible, since all of its generalized weight spaces other than the highest one are
infinite dimensional, but the irreducible quotient L(σ, A(u)) may well be.
   Theorem 5.6. For A(u) ∈ Pn , the irreducible Yn (σ)-module L(σ, A(u)) is
admissible if and only if Ai (u)/Ai+1 (u) is a rational function for all i = 1, . . . , n−1.
     Proof. (⇐). Suppose that each Ai (u)/Ai+1 (u) is a rational function. For
f (u) ∈ 1 + u−1 F[[u−1 ]], the twist of L(σ, A(u)) by the automorphism µf from (2.42)
is isomorphic to L(σ, f (u1 · · · un )A(u)). This allows us to reduce to the case that
each Ai (u) is actually a polynomial in u−1 . Assuming this, we can find l ≥ sn,1 +s1,n
such that, on setting pi := l − sn,i − si,n , upi Ai (u) is a monic polynomial in u of
degree pi for each i = 1, . . . , n. Let π = (q1 , . . . , ql ) be the pyramid associated
to the shift matrix σ and the level l. For each i = 1, . . . , n, factorize upi Ai (u) as
(u + ai,1 ) · · · (u + ai,pi ) for ai,j ∈ F, and write the numbers ai,1 , . . . , ai,pi into the
boxes on the ith row of π from left to right. For each j = 1, . . . , l, let bj,1 , . . . , bj,qj
                            5.5. COMPOSITION MULTIPLICITIES                                 51


denote the entries in the jth column of the resulting π-tableau read from top to
bottom. Let Mj denote the usual Verma module for the Lie algebra glqj of highest
weight (bj,1 , bj,2 , · · · , bj,qj ). The tensor product M1 ⊠ · · · ⊠ Ml is naturally a W (π)-
module, hence a Yn (σ)-module via the quotient map (3.17). Applying Lemmas 5.1
and 5.4, it is an admissible Yn (σ)-module and it contains an obvious highest weight
vector of type A(u).
     (⇒). Assume to start with that the shift matrix σ is the zero matrix, i.e.
Yn (σ) is just the usual Yangian Yn . Suppose that L(σ, A(u)) is admissible for some
A(u) ∈ Pn . In particular, for each i = 1, . . . , n − 1, the (wt A(u) − εi + εi+1 )-weight
space of L(σ, A(u)) is finite dimensional. Given this an argument due originally to
Tarasov [T1, Theorem 1], see e.g. the proof of [M2, Proposition 3.5], shows that
Ai (u)/Ai+1 (u) is a rational function for each i = 1, . . . , n − 1.
     Assume next that σ is lower triangular, and consider the canonical embedding
Yn (σ) ֒→ Yn . Given A(u) ∈ Pn such that L(σ, A(u)) is admissible, the PBW
theorem implies that the induced module Yn ⊗Yn (σ) L(σ, A(u)) is also admissible
and contains a non-zero highest weight vector of type A(u). Hence by the preceeding
paragraph Ai (u)/Ai+1 (u) is a rational function for each i = 1, . . . , n − 1.
     Finally suppose that σ is arbitrary. Recalling the isomorphism ι from (2.35),
the twist of a highest weight module by ι is again a highest weight module of
the same type, and the twist of an admissible module is again admissible. So the
conclusion in general follows from the lower triangular case.                                
    In view of this result, let us define
                                                                          
                                    Ai (u)/Ai+1 (u) is a rational function
(5.10)      Qn := A(u) ∈ Pn                                                 .
                                      for each i = 1, . . . , n − 1
Then Theorem 5.6 implies that the modules {L(σ, A(u)) | A(u) ∈ Qn } give a full
set of pairwise non-isomorphic admissible irreducible Yn (σ)-modules.
   Remark 5.7. The construction explained in the proof of Theorem 5.6 shows
moreover that every admissible irreducible Yn (σ)-module can be obtained from an
admissible irreducible W (π)-module via the homomorphism
(5.11)                           κ ◦ µf : Yn (σ) ։ W (π),
for some pyramid π associated to the shift matrix σ and some f (u) ∈ 1+u−1F[[u−1 ]].

                          5.5. Composition multiplicities
     The final job in this chapter is to make precise the sense in which Gelfand-
Tsetlin characters characterize admissible modules. We need to be a little careful
here since admissible modules need not possess a composition series. Neverthe-
less, given admissible Yn (σ)-modules M and L with L irreducible, we define the
composition multiplicity of L in M by
(5.12)             [M : L] := sup #{i = 1, . . . , r | Mi /Mi−1 ∼
                                                                = L}
where the supremum is over all finite filtrations 0 = M0 ⊂ M1 ⊂ · · · ⊂ Mr = M .
By general principles, this multiplicity is additive on short exact sequences. Now
we repeat some standard arguments from [K, ch. 9].
    Lemma 5.8. Let M be an admissible Yn (σ)-module and α ∈ c∗ be a fixed weight.
There is a filtration 0 = M0 ⊂ M1 ⊂ · · · ⊂ Mr = M and a subset I ⊆ {1, . . . , r}
such that
52                         5. HIGHEST WEIGHT THEORY


      (i) for each i ∈ I, we have that Mi /Mi−1 ∼ = L(σ, A(i) (u)) for A(i) (u) ∈ Qn
                    (i)
          with wt A (u) ≥ α;
     (ii) for each i ∈
                     / I, we have that (Mi /Mi−1 )β = 0 for all β ≥ α.
In particular, given A(u) ∈ Qn with wt A(u) ≥ α, we have that
                  [M : L(σ, A(u))] = #{i ∈ I | A(i) (u) = A(u)}.
     Proof. Adapt the proof of [K, Lemma 9.6].                                    
     Corollary 5.9. For an admissible Yn (σ)-module M , we have that
                          X
                ch M =        [M : L(σ, A(u))] ch L(σ, A(u)).
                          A(u)∈Qn

     Proof. Argue using the lemma exactly as in [K, Proposition 9.7].             
    Theorem 5.10. Let M and N be admissible Yn (σ)-modules such that ch M =
ch N . Then M and N have all the same composition multiplicities.
    Proof. This follows from Corollary 5.9 once we check that the ch L(σ, A(u))’s
are linearly independent in an appropriate sense. To be precise we need to show,
given                      X
                    S=                                 b n]
                                 mA(u) ch L(σ, A(u)) ∈ Z[P
                         A(u)∈Qn
for coefficients mA(u) ∈ Z satisfying the conditions from §5.2(a)–(b), that S = 0
implies each mA(u) = 0. Suppose for a contradiction that mA(u) 6= 0 for some
A(u). Amongst all such A(u)’s, pick one with wt A(u) maximal in the dominance
ordering. But then, since ch L(σ, A(u)) equals [A(u)] plus a (possibly infinite)
linear combination of [B(u)]’s for wt(B(u)) < wt(A(u)), the coefficient of [A(u)] in
P
   A(u)∈Qn mA(u) ch L(σ, A(u)) is non-zero, which is the desired contradiction.   
     Corollary 5.11. For A(u) ∈ Qn , we have that L(σ, A(u))τ ∼
                                                              = L(σ t , A(u)).
    Proof. Using (2.35), it is clear that L(σ, A(u)) and L(σ t , A(u)) have the same
formal characters. Hence by Lemma 5.2 so do L(σ, A(u))τ and L(σ t , A(u)).         
                                          CHAPTER 6


                                   Verma modules

    Now we turn our attention to studying highest weight modules over the algebras
W (π) themselves. Fix throughout the chapter a pyramid π = (q1 , . . . , ql ) of height
≤ n, let (p1 , . . . , pn ) be the tuple of row lengths, and choose a corresponding shift
matrix σ = (si,j )1≤i,j≤n as usual. Notions of weights, highest weight vectors and
so forth are exactly as in the previous chapter, viewing W (π)-modules as Yn (σ)-
modules via the quotient map κ : Yn (σ) ։ W (π) from (3.17).

                        6.1. Parametrization of highest weights
     Our first task is to understand the universal highest weight module of type
A(u) ∈ Pn for the algebra W (π). This module is obviously the unique largest
quotient of the Yn (σ)-module M (σ, A(u)) from (5.7) on which the kernel of the
homomorphism κ : Yn (σ) ։ W (π) from (3.17) acts as zero. In other words, it
is the W (π)-module W (π) ⊗Yn (σ) M (σ, A(u)). We will abuse notation and write
simply v+ instead of 1⊗v+ for the highest weight vector in W (π)⊗Yn (σ) M (σ, A(u)).
    Theorem 6.1. For A(u) ∈ Pn , W (π) ⊗Yn (σ) M (σ, A(u)) is non-zero if and
only if upi Ai (u) ∈ F[u] for each i = 1, . . . , n. In that case, the following sets of
vectors give bases for W (π) ⊗Yn (σ) M (σ, A(u)):
      (i) {xv+ | x ∈ X}, where X denotes the collection of all monomials in the
                       (r)
          elements {Fi,j | 1 ≤ i < j ≤ n, sj,i < r ≤ Sj,i } taken in some fixed order;
     (ii) {yv+ | y ∈ Y }, where Y denotes the collection of all monomials in the
                       (r)
          elements {Tj,i | 1 ≤ i < j ≤ n, sj,i < r ≤ Sj,i } taken in some fixed order.
    Proof. (ii) Let us work with the following reformulation of the definition (5.7):
the module M (σ, A(u)) is the quotient of Yn (σ) by the left ideal J generated by
the elements
         (r)                                            (r)       (r)
      {Ei      | i = 1, . . . , n − 1, r > si,i+1 } ∪ {Di     − Ai      | i = 1, . . . , n, r > 0}.
Equivalently, by Lemma 5.3, J is the left ideal of Yn (σ) generated by the elements
                 (r)                                        (r)   (r)
      P := {Ti,j | 1 ≤ i < j ≤ n, si,j < r} ∪ {Ti,i − Ai                | 1 ≤ i ≤ n, si,i < r}.
                       (r)
Also let Q := {Tj,i | 1 ≤ i < j ≤ n, sj,i < r}. Pick an ordering on P ∪ Q so that
the elements of Q preceed the elements of P . Obviously all ordered monomials
in the elements P ∪ Q containing at least one element of P belong to J. Hence
by Lemma 2.1 and Theorem 5.5(ii), the ordered monomials in the elements P ∪ Q
containing at least one element of P in fact form a basis for J.
    Now it is clear that W (π) ⊗Yn (σ) M (σ, A(u)) is the quotient of W (π) by the
                                                        (r)
image J¯ of J under the map κ : Yn (σ) ։ W (π). If Ai 6= 0 for some 1 ≤ i ≤ n
                   pi                                  (r)     (r)
                           / F[u], then the image of Ti,i − Ai gives us a unit in
and r > pi , i.e. u Ai (u) ∈

                                                 53
54                                  6. VERMA MODULES


J¯ by Theorem 3.5, hence W (π) ⊗Yn (σ) M (σ, A(u)) = 0 in this case. On the other
hand, if all upi Ai (u) belong to F[u], we let
                    (r)
          P̄ := {Ti,j | 1 ≤ i < j ≤ n, si,j < r ≤ Si,j }
                                         (r)     (r)
                                   ∪ {Ti,i − Ai        | 1 ≤ i ≤ n, si,i < r ≤ Si,i },
                    (r)
          Q̄ :=   {Tj,i| 1 ≤ i < j ≤ n, sj,i < r ≤ Sj,i }.
Then Theorem 3.5 implies that J¯ is spanned by all ordered monomials in the ele-
ments P̄ ∪ Q̄ containing at least one element of P̄ . By Lemma 3.6, these monomials
are also linearly independent, hence form a basis for J.   ¯ It follows that the image
of Y gives a basis for W (π)/J, ¯ proving (ii).
    (i) This follows from (ii) by reversing the argument used to deduce (ii) from (i)
in the proof of Theorem 5.5.                                                        
    Now suppose that v+ is a non-zero highest weight vector in some W (π)-module
M . By Theorem 6.1, there exist elements (ai,j )1≤i≤n,1≤j≤pi of F such that
(6.1)                          up1 D1 (u)v+ = (u + a1,1 )(u + a1,2 ) · · · (u + a1,p1 )v+ ,
                          p2
(6.2)              (u − 1) D2 (u − 1)v+ = (u + a2,1 )(u + a2,2 ) · · · (u + a2,p2 )v+ ,
                                         ..
                                          .
(6.3)   (u − n + 1)pn Dn (u − n + 1)v+ = (u + an,1 )(u + an,2 ) · · · (u + an,pn )v+ .
In this way, the highest weight vector v+ defines a row symmetrized π-tableau A in
the sense of §4.1, namely, the unique element of Row(π) with entries ai,1 , . . . , ai,pi
on its ith row. From now on, we will say simply that the highest weight vector v+
is of type A if these equations hold.
     Conversely, suppose that we are given A ∈ Row(π) with entries ai,1 , . . . , ai,pi
on its ith row. Define the corresponding generalized Verma module M (A) to be the
universal highest weight module of type A, i.e.
(6.4)                     M (A) := W (π) ⊗Yn (σ) M (σ, A(u))
where A(u) = A1 (u1 ) · · · An (un ) is defined from
           (u − i + 1)pi Ai (u − i + 1) = (u + ai,1 )(u + ai,2 ) · · · (u + ai,pi )
for each i = 1, . . . , n. Theorem 6.1 then shows that the vector v+ ∈ M (A) is a
non-zero highest weight vector of type A. Moreover, M (A) is admissible and, as in
§5.3, it has a unique maximal submodule denoted rad M (A). The quotient
(6.5)           L(A) := M (A)/ rad M (A) = ∼ W (π) ⊗Y (σ) L(σ, A(u))
                                                               n

is the unique (up to isomorphism) irreducible highest weight module of type A.
The modules {L(A) | A ∈ Row(π)} give a complete set of pairwise non-isomorphic
irreducible admissible representations of the algebra W (π).
     Let us describe in detail the situation when the pyramid π consists of a single
column of height m ≤ n. In this case we have simply that W (π) = U (glm ) according
to the definition (3.8). Let A be a π-tableau with entries a1 , . . . , am ∈ F read from
top to bottom. A highest weight vector for W (π) of type A means a vector v+ with
the properties
      (a) ei,j v+ = 0 for all 1 ≤ i < j ≤ n;
      (b) ei,i v+ = (ai + n − m + i − 1)v+ for all i = 1, . . . , n.
                           6.2. CHARACTERS OF VERMA MODULES                                      55


Hence the module M (A) here coincides with the Verma module M (α) from (3.42)
with α = (a1 + n − m, . . . , am + n − m).
    For another example, the trivial W (π)-module, which we defined earlier to be
the restriction of the trivial U (p)-module, is isomorphic to the module L(A0 ) where
A0 is the ground-state tableau from §4.3, i.e. the tableau having all entries on its
ith row equal to (1 − i).

                         6.2. Characters of Verma modules
    By the character ch M of an admissible W (π)-module M , we mean its Gelfand-
Tsetlin character when viewed as a Yn (σ)-module via κ : Yn (σ) ։ W (π). Thus
ch M is an element of the completed group algebra Z[P  b n ] from §5.2.
    Given a decomposition π = π ⊗ π with π of level l′ and π ′′ of level l′′ ,
                                      ′    ′′        ′

the comultiplication ∆l′ ,l′′ from (3.27) allows us to view the tensor product of a
W (π ′ )-module M ′ and a W (π ′′ )-module M ′′ as a W (π)-module, denoted M ′ ⊠ M ′′ .
Assuming M ′ and M ′′ are both admissible, Lemma 5.1 and (3.28) imply that
M ′ ⊠ M ′′ is also admissible and
(6.6)                         ch(M ′ ⊠ M ′′ ) = (ch M ′ )(ch M ′′ ).
Lemma 5.4 also carries over in an obvious way to this setting.
    Introduce the following shorthand for some special elements of the completed
              b n ]:
group algebra Z[P
(6.7)                          xi,a := [1 + (ui + a + i − 1)−1 ],
(6.8)                          yi,a := [1 + (a + i − 1)u−1
                                                        i ],
for 1 ≤ i ≤ n and a ∈ F. We note that
(6.9)                       yi,a /yi,a−k = xi,a−1 xi,a−2 · · · xi,a−k
for any k ∈ N. The following theorem implies in particular that the character of
any admissible W (π)-module actually belongs to the completion of the subalgebra
   b n ] generated just by the elements {y ±1 | i = 1, . . . , n, a ∈ F}.
of Z[P                                    i,a

    Theorem 6.2. For A ∈ Row(π) with entries ai,1 , . . . , ai,pi on its ith row for
each i = 1, . . . , n, we have that
                       n Ypi
                             (                                  n
                                                                                                   )
                XY                                              Y yk,ai,j −(ci,j,k+1 +···+ci,j,n )
  ch M (A) =                   yi,ai,j −(ci,j,i+1 +···+ci,j,n )
                   c i=1 j=1
                                                                   yk,ai,j −(ci,j,k +···+ci,j,n )
                                                           k=i+1

where the sum is over all tuples c = (ci,j,k )1≤i<k≤n,1≤j≤pi of natural numbers.
    The proof of this is more technical than conceptual, so we postpone it to §6.5,
preferring to illustrate its importance with some applications first.
    Corollary 6.3. Let A1 , . . . , Al be the columns of any representative of the
row-symmetrized π-tableau A ∈ Row(π), so that A ∼row A1 ⊗ · · · ⊗ Al . Then
        ch M (A) = (ch M (A1 )) × · · · × (ch M (Al )) = ch(M (A1 ) ⊠ · · · ⊠ M (Al )).
    Proof. This follows from the theorem on interchanging the first two products
on the right hand side.                                                       
56                                  6. VERMA MODULES


        In order to derive the next corollary we need to explain an alternative way
of managing the combinatorics in Theorem 6.2. Continue with A ∈ Row(π) with
entries ai,1 , . . . , ai,pi on its ith row as in the statement of the theorem. By a tabloid
we mean an array t = (ti,j,a )1≤i≤n,1≤j≤pi ,a<ai,j of integers from the set {1, . . . , n}
such that
         (a) · · · ≤ ti,j,ai,j −3 ≤ ti,j,ai,j −2 ≤ ti,j,ai,j −1 ;
         (b) ti,j,a = i for a ≪ ai,j ;
for each 1 ≤ i ≤ n, 1 ≤ j ≤ pi . Draw a diagram with rows parametrized by pairs
(i, j) for 1 ≤ i ≤ n, 1 ≤ j ≤ pi such that the (i, j)th row consists of a strip of
infinitely many boxes, one in each of the columns parametrized by the numbers
. . . , ai,j − 3, ai,j − 2, ai,j − 1. Then the tabloid t can be recorded on the diagram by
writing the number ti,j,a into the box in the ath column of the (i, j)th row. In this
way tabloids can be thought of as fillings of the boxes of the diagram by integers
from the set {1, . . . , n} so that the entries on each row are weakly increasing and
all but finitely many entries on row (i, j) are equal to i.
        Given a tabloid t = (ti,j,a )1≤i≤n,1≤j≤pi ,a<ai,j , define c = (ci,j,k )1≤i<k≤n,1≤j≤pi
by declaring that ci,j,k = #{a < ai,j | ti,j,a = k}, i.e. ci,j,k counts the number
of entries equal to k appearing in the (i, j)th row of the tabloid t. In this way we
obtain a bijection t 7→ c from the set of all tabloids to the set of all tuples of natural
numbers as in the statement of Theorem 6.2. Moreover, for t corresponding to c
via this bijection, the identity (6.9) implies that
       n Y pi
              (                                   n
                                                                                       )
     Y                                            Y   yk,ai,j −(ci,j,k+1 +···+ci,j,n )
                 yi,ai,j −(ci,j,i+1 +···+ci,j,n )
     i=1 j=1
                                                       yk,ai,j −(ci,j,k +···+ci,j,n )
                                       k=i+1
                                                                        pi Y
                                                                      n Y
                                                                      Y
                                                                  =                  xti,j,a ,a ,
                                                                      i=1 j=1 a<ai

where the infinite product on the right hand side is interpreted using the convention
that xi,a−1 xi,a−2 · · · = yi,a for any i = 1, . . . , n and a ∈ F. Now we can restate
Theorem 6.2:
                                        XY  n Y pi Y
(6.10)                      ch M (A) =                    xti,j,a ,a
                                          t   i=1 j=1 a<ai

where the first summation is over all tabloids t = (ti,j,a )1≤i≤n,1≤j≤pi ,a<ai,j .
    Corollary 6.4. For any A ∈ Row(π), all Gelfand-Tsetlin subspaces of M (A)
are of dimension less than or equal to p1 !(p1 + p2 )! · · · (p1 + p2 + · · · + pn−1 )!.
     Proof. Two different tabloids t and t′ contribute the same monomial to the
right hand side of (6.10) if and only if they have the same number of entries equal
to i appearing in column a for each i = 1, . . . , n and a ∈ F. So, given non-negative
integers ki,a for each i = 1, . . . , n and a ∈ F, we need to show by (6.10) that there
are at most p1 !(p1 + p2 )! · · · (p1 + · · · + pn−1 )! different tabloids with ki,a entries
equal to i in column a for each i = 1, . . . , n and a ∈ F. Given such a tabloid,
all entries in the rows parametrized by (n, 1), . . . , (n, pn ) must equal to n, while
in every other row there are only finitely many entries equal to n and all these
entries must form a connected strip at the end of the row. So on removing all
the boxes containing the entry n we obtain a smaller diagram with rows indexed
by pairs (i, j) for i = 1, . . . , n − 1, j = 1, . . . , pi . By induction there are at most
                                 6.3. THE LINKAGE PRINCIPLE                                       57


p1 !(p1 + p2 )! · · · (p1 + · · · + pn−2 )! admissible ways of filling the boxes of this smaller
diagram with ki,a entries equal to i in column a for each i = 1, . . . , n − 1 and a ∈ F.
Therefore we just need to show that there are at most (p1 + · · · + pn−1 )! admissible
ways of inserting kn,a entries equal to n into column a for each a ∈ F. This follows
from the following claim:
Suppose we are given a1 , . . . , aN ∈ F and non-negative integers ka for each a ∈ F, all
but finitely many of which are zero. Draw a diagram with rows numbered 1, . . . , N
such that the ith row consists of an infinite strip of boxes, one in each of the columns
parametrized by . . . , ai − 3, ai − 2, ai − 1. Then there are at most N ! different ways
of deleting boxes from the ends of each row in such a way that a total of ka boxes
are removed from column a for each a ∈ F.
This may be proved by reducing first to the case that all ai belong to the same coset
of F modulo Z, then to the case that all ai are equal. After these reductions it follows
from the obvious fact that there are at most N ! different N -part compositions with
prescribed transpose partition.                                                       
     Remark 6.5. On analyzing the proof of the corollary more carefully, one sees
that this upper bound p1 !(p1 + p2 )! · · · (p1 + · · · + pn−1 )! for the dimensions of the
Gelfand-Tsetlin subspaces of M (A) is attained if and only if all entries in the first
(n − 1) rows of the tableau A belong to the same coset of F modulo Z. At the other
extreme, all Gelfand-Tsetlin subspaces of M (A) are one dimensional if and only if
all entries in the first (n − 1) rows of the tableau A belong to different cosets of F
modulo Z.

                                6.3. The linkage principle
    Our next application of Theorem 6.2 is to prove a “linkage principle” showing
that the row ordering from (4.1) controls the types of composition factors that can
occur in a generalized Verma module. In the special case that π consists of a single
column of height n, i.e. W (π) = U (gln ), this result is [BGG2, Theorem A1]; even
in this case the proof given here is quite different.
    Lemma 6.6. Suppose A ↓ B. Then ch M (A) = ch M (B) + (∗) where (∗) is the
character of some admissible W (π)-module.
    Proof. In view of Corollary 6.3, it suffices prove this in the special case that
π consists of a single column, i.e. W (π) = U (glm ) for some m. But in that case it
is well known that A ↓ B implies that there is an embedding M (B) ֒→ M (A); see
[BGG1] or [Di, Lemma 7.6.13].                                                     
    Theorem 6.7. Let A, B ∈ Row(π) with entries ai,1 , . . . , ai,pi and bi,1 , . . . , bi,pi
on their ith rows, respectively. The following are equivalent:
       (i) A ≥ B;
      (ii) [M (A) : L(B)] 6= 0;
    (iii) there exists a tuple c = (ci,j,k )1≤i<k≤n,1≤j≤pi of natural numbers such that
  n   pi             n Y pi
                            (                                  n
                                                                                                  )
 YY                 Y                                          Y yk,ai,j −(ci,j,k+1 +···+ci,j,n )
          yi,bi,j =           yi,ai,j −(ci,j,i+1 +···+ci,j,n )                                      .
 i=1 j=1            i=1 j=1
                                                                  yk,ai,j −(ci,j,k +···+ci,j,n )
                                                           k=i+1
58                                             6. VERMA MODULES


     Proof. (i)⇒(ii). If A ≥ B then Lemma 6.6 implies that
                                        ch M (A) = ch M (B) + (∗),
where (∗) is the character of some admissible W (π)-module. Hence we get that
[M (A) : L(B)] ≥ [M (B) : L(B)] = 1.
    (ii)⇒(iii). Suppose       Qpi[M (A) : L(B)] 6= 0. The highest weight vector v+
                        Qn that
of L(B) contributes i=1 j=1           yi,bi,j to the formal character ch L(B). Hence, by
                                                              Q  Q i
Corollary 5.9, we see that ch M (A) also involves ni=1 pj=1              yi,bi,j with non-zero
coefficient. In view of Theorem 6.2 this implies (iii).
    (iii)⇒(i). Suppose that
   n Y pi            n Y pi
                            (                                 n
                                                                                                 )
  Y                 Y                                         Y yk,ai,j −(ci,j,k+1 +···+ci,j,n )
          yi,bi,j =          yi,ai,j −(ci,j,i+1 +···+ci,j,n )
  i=1 j=1           i=1 j=1
                                                                 yk,ai,j −(ci,j,k +···+ci,j,n )
                                                                         k=i+1

for some
    P tuple c = (ci,j,k )1≤i<k≤n,1≤j≤p
                                  P         i of natural numbers. We show by induction
on     ci,j,k that A ≥ B. If         ci,j,k = 0 this is trivial since then A ∼row B.
Otherwise, let i2 be maximal such that ci,j,i2 6= 0 for some 1 ≤ i < i2 and 1 ≤ j ≤ pi .
Considering the yi2 ,? ’s on either side of our equation gives that
                        pi2                   pi2                   iY    pi
                                                                     2 −1 Y
                        Y                     Y                                    yi2 ,ai,j
                              yi2 ,bi2 ,j =         yi2 ,ai2 ,j ×                                   .
                       j=1                    j=1                   i=1 j=1
                                                                               yi2 ,ai,j −ci,j,i2
Hence there exist 1 ≤ i1 < i2 , 1 ≤ j1 ≤ pi1 and 1 ≤ j2 ≤ pi2 such that ai2 ,j2 =
ai1 ,j1 − ci1 ,j1 ,i2 6= ai1 ,j1 . Let Ā = (āi,j )1≤i≤n,1≤j≤pi be the π-tableau obtained from
A by swapping the entries ai1 ,j1 and ai2 ,j2 . Define a new tuple (c̄i,j,k )1≤i<j≤n,1≤j≤pi
from                                       
                                               ci,j,k if (i, j, k) 6= (i1 , j1 , i2 ),
                                c̄i,j,k =
                                               0         if (i, j, k) = (i1 , j1 , i2 ).
Now using the maximality of the choice of i2 , one checks that
     n Y  pi
              (                                        n
                                                                                                )
   Y                                                  Y     yk,āi,j −(c̄i,j,k+1 +···+c̄i,j,n )
                 yi,āi,j −(c̄i,j,i+1 +···+c̄i,j,n )                                              =
   i=1 j=1
                                                              yk,āi,j −(c̄i,j,k +···+c̄i,j,n )
                                                     k=i+1
  n Y  pi
           (                                         n
                                                                                              )    n Y pi
 Y                                                  Y     yk,ai,j −(ci,j,k+1 +···+ci,j,n )        Y
              yi,ai,j −(ci,j,i+1 +···+ci,j,n )                                                  =         yi,bi,j .
 i=1 j=1
                                                           yk,ai,j −(ci,j,k +···+ci,j,n )         i=1 j=1
                                                 k=i+1
         P                P
Since        c̄i,j,k <        ci,j,k we deduce by induction that Ā ≥ B. Since A ↓ Ā this
completes the proof.                                                                                                
     Corollary 6.8. For A ∈ Row(π) with entries ai,1 , . . . , ai,pi on its ith row, the
following are equivalent:
       (i) M (A) is irreducible;
      (ii) A is minimal with respect to the ordering ≥;
     (iii) ai1 ,j1 6> ai2 ,j2 for every 1 ≤ i1 < i2 ≤ n, 1 ≤ j1 ≤ pi1 and 1 ≤ j2 ≤ pi2 .
Moreover, assuming (i)–(iii) hold, let A1 , . . . , Al be the columns of any represen-
tative of A read from left to right, so that A ∼row A1 ⊗ · · · ⊗ Al . Then we have
that
                                M (A) ∼= M (A1 ) ⊠ · · · ⊠ M (Al ).
                                  6.4. THE CENTER OF W (π)                                      59


    Proof. The equivalence of (i) and (ii) follows from Theorem 6.7. The equiv-
alence of (ii) and (iii) is clear from the definition of the Bruhat ordering. The final
statement follows from Corollary 6.3 and Theorem 5.10.                               

                                 6.4. The center of W (π)
      Our final application of Theorem 6.2 is to prove that the center Z(W (π)) is a
                                               (1)            (N )
polynomial algebra on generators ψ(ZN ), . . . , ψ(ZN ), notation as in §3.8. In the
case that π is an n × l rectangle, when W (π) is the Yangian of level l, this result
is due to Cherednik [C1, C2]; see also [M3, Corollary 4.1]. For the first lemma,
we point out that the usual Verma modules for the Lie algebra h are precisely the
outer tensor product modules M (A1 ) ⊠ · · · ⊠ M (Al ) for A ∈ Tab(π) with columns
A1 , . . . , Al . Moreover, if γ(A) = (a1 , . . . , aN ) then M (A1 ) ⊠ · · · ⊠ M (Al ) is of usual
highest weight (a1 +row(1)−1, . . . , aN +row(N )−1) ∈ d∗ . Recall also the definition
of the Miura transform ξ from (3.26).
    Lemma 6.9. ξ(Z(W (π))) ⊆ Z(U (h)).
    Proof. Take z ∈ Z(W (π)) and u ∈ U (h). We need to show that [ξ(z), u] = 0.
This follows by [Di, Theorem 8.4.4] as soon as we check that [ξ(z), u] annihilates
M (A1 )⊠· · ·⊠M (Al ) for generic A ∈ Tab(π) with columns A1 , . . . , Al , Corollary 6.8
shows that M (A1 ) ⊠ · · · ⊠ M (Al ) is generically irreducible when viewed as a W (π)-
module via ξ. Hence ξ(z) acts on it as a scalar by (5.9). So certainly [ξ(z), u] acts
as zero.                                                                               
    Theorem 6.10. The map ψ : Z(U (glN )) → Z(W (π)) from (3.46) is an iso-
                                  (1)            (N )
morphism. Hence, the elements ψ(ZN ), . . . , ψ(ZN ) are algebraically independent
and generate the center Z(W (π)).
    Proof. In view of Lemma 6.9 and the commutativity of the diagram (3.48),
we just need to show that the image of z ∈ Z(W (π)) under (Ψq1 ⊗ · · · ⊗ Ψql ) ◦ ξ is a
symmetric polynomial in e1,1 + qcol(1) − n, . . . , eN,N + qcol(N ) − n. Equivalently, by
the definition of the Harish-Chandra homomorphism, we need to show, whenever
A, B are π-tableaux with the same content, that the element z acts on the modules
M (A1 ) ⊠ · · · ⊠ M (Al ) and M (B1 ) ⊠ · · · ⊠ M (Bl ) by the same scalar, where Ai resp.
Bi denotes the ith column of A resp. B. If B is obtained from A by permuting
entries within columns, this is immediate from Lemma 6.9. If B is obtained from A
by permuting enties within rows, it follows from Theorem 5.10 and Corollary 6.3.
The general case follows from these two special situations.                             
     We remark that there is now a quite different proof of this theorem, valid for
finite W -algebras associated to arbitrary finite dimensional semisimple Lie algebras,
due to Ginzburg. For a sketch of the argument, see the footnote to [P2, Question
5.1].
                                               (1)    (2)
    Corollary 6.11. The elements Cn , Cn , . . . of Yn (σ) are algebraically in-
dependent and generate the center Z(Yn (σ)). Moreover, κ : Yn (σ) ։ W (π) maps
Z(Yn (σ)) surjectively onto Z(W (π)).
    Proof. This is immediate from the theorem on recalling that Yn (σ) is a filtered
inverse limit of W (π)’s as explained in [BK5, Remark 6.4].                        
60                                  6. VERMA MODULES


    We are grateful to one of the referees of [BK5] for pointing out that we are
already in a position to apply [FO] to obtain the following generalization of a
theorem of Kostant from [Ko1]. In the case W (π) is the Yangian of level l this
result is [FO, Theorem 2].
     Theorem 6.12. The algebra W (π) is free as a module over its center.
    Proof. Recall that the associated graded algebra gr W (π) is free commutative
on generators (3.30)–(3.32), in particular W (π) is a special filtered algebra in the
sense of [FO]. Let A be the quotient of gr W (π) by the ideal generated by the
                             (r)       (r)                           (r)              (r)
elements (3.31)–(3.32). Let di resp. cn denote the image of grr Di resp. grr Cn
                                                    (r)
in A. Thus, A is the free polynomial algebra F[di | i = 1, . . . , n, r = 1, . . . , pi ].
                                                        (r)
Moreover by Theorem 3.5 and (2.34) we have that di = 0 for r > pi . It follows
from this and (2.76) that if we set
                                             pi
                                             X      (r)
                                  di (u) =         di upi −r ,
                                             r=0
                                             N
                                             X
                                  cn (u) =         c(r)
                                                    n u
                                                        N −r

                                             r=0
then cn (u) = d1 (u)d2 (u) · · · dn (u). Now applying [FO, Theorem 1] as in the proof
                                                   (1) (2)          (N )
of [FO, Theorem 2], it suffices to show that cn , cn , . . . , cn is a regular sequence
                                 (r)           (1)           (r−1)
in A, i.e. that the image of cn in A/(Acn + · · ·+ Acn             ) is not invertible and not
a zero divisor for each r = 1, . . . , N . For this, by [FO, Proposition 1(5)], we just
                                             (1)     (N )
need to check that the variety Z = V (cn , . . . , cn ) is equidimensional of dimension
                                                                       (r)
0. Consider the morphism ϕ : FN → FN mapping a point (xi )1≤i≤n,1≤r≤pi to the
coefficients of the following monic polynomial:
                           Y n
                                         (1)                  (p )
                                 (upi + di upi −1 + · · · + di i ).
                            i=1

Obviously Z = ϕ−1 (0). Since F[u] is a unique factorization domain, uN = up1 · · · upn
is the unique decomposition of uN as a product of monic polynomials of degrees
p1 , . . . , pn . Hence Z = {0}.                                                    
     In view of Theorem 6.10, the center of W (π) is canonically isomorphic to the
center of U (g). So we can parametrize the central characters of L       W (π) in exactly
the same way as we did for U (g) in §3.8, by the set of θ ∈ P = a∈F Zγa whose
coefficients are non-negative integers summing to N . Given such an element θ,
define f (u) = uN + f (1) uN −1 + · · · + f (N ) ∈ F[u] according to (3.40)–(3.41). Then,
for an admissible W (π)-module M , define
                                                                               
                                  for each r = 1, . . . , N there exists p > 0
(6.11)       prθ (M ) := v ∈ M                      (r)                           .
                                      such that ψ(Z − f (r) )p v = 0
                                                          N
Equivalently, by (2.76) and Lemma 3.7, we have that
                                         M
(6.12)                        prθ (M ) =   MA(u)
                                               A(u)

where the direct sum is over all A(u) ∈ Pn such that
      up1 (u − 1)p2 · · · (u − n + 1)pn A1 (u)A2 (u − 1) · · · An (u − n + 1) = f (u).
                                 6.5. PROOF OF THEOREM 6.2                                      61


Since the admissible W (π)-module M is the direct sum of its Gelfand-Tsetlin sub-
spaces, it follows that
                                   M
(6.13)                         M=       prθ (M ),
                                             θ∈P

with the convention that prθ (M ) = 0 if the coefficients of θ are not non-negative
integers summing to N . This is clearly a decomposition of M as a W (π)-module.
    Lemma 6.13. All highest weight W (π)-modules of type A ∈ Row(π) are of
central character θ(A).
    Proof. Suppose that the entries on the ith row of A are ai,1 , . . . , ai,pi . By
(2.76), Lemma 3.7 and the definition Q
                                     (6.1)–(6.3), ψ(ZN (u)) acts on any highest
                                       n Qpi
weight module of type A as the scalar i=1 j=1   (u + ai,j ).                        

                               6.5. Proof of Theorem 6.2
     Let π̄ denote the pyramid obtained from π by removing the bottom row. The
tuple of row lengths corresponding to the pyramid π̄ is (p1 , . . . , pn−1 ) and the
submatrix σ̄ = (si,j )1≤i,j≤n−1 of the shift matrix σ = (si,j )1≤i,j≤n chosen for π
gives a shift matrix for π̄. By the relations, there is a homomorphism W (π̄) → W (π)
                                (r)                                (r)
mapping the generators Di (i = 1, . . . , n − 1, r > 0), Ei (i = 1, . . . , n − 2, r >
               (r)
si,i+1 ) and Fi (i = 1, . . . , n − 2, r > si+1,i ) of W (π̄) to the elements with the same
names in W (π). By the PBW theorem this map is in fact injective, allowing us to
view W (π̄) as a subalgebra of W (π). We will in fact prove the following branching
theorem for generalized Verma modules.
     Theorem 6.14. Let A ∈ Row(π) with entries ai,1 , . . . , ai,pi on its ith row
for each i = 1, . . . , n. There   S       is a filtration 0 = M0 ⊂ M1 ⊂ · · · of M (A)
as a W (π̄)-module with i≥0 Mi = M (A) and subquotients isomorphic to the
generalized Verma modules M (B) for B ∈ Row(π̄) such that B has the entries
(ai,1 − ci,1 ), . . . , (ai,pi − ci,pi ) on its ith row for each i = 1, . . . , n − 1, one for each
tuple (ci,j )1≤i≤n−1,1≤j≤pi of natural numbers.
    Let us first explain how to deduce Theorem 6.2 from this. Proceed by induction
on n, the case n = 1 being trivial. For the induction step, we have by Theorem 6.14
                                                                W (π)
and the induction hypothesis that the character of resW (π̄) M (A) equals
                 pi
                    (                                                                     )
       X n−1
           YY                                          n−1
                                                       Y yk,ai,j −(ci,j,k+1 +···+ci,j,n )
                      yi,ai,j −(ci,j,i+1 +···+ci,j,n )                                      ,
        c
                                                           yk,ai,j −(ci,j,k +···+ci,j,n )
            i=1 j=1                                k=i+1

where the first sum is over all tuples c = (ci,j,k )1≤i<k≤n−1,1≤j≤pi of natural num-
bers. But just like in the proof of Lemma 6.13,
          up1 (u − 1)p2 · · · (u − n + 1)pn D1 (u)D2 (u − 1) · · · Dn (u − n + 1)
                                Qn Qpi
acts on M (A) as the scalar i=1 j=1        (u + ai,j ). Hence recalling (6.8), each mono-
                                                                    Q     Q i
mial appearing in the expansion of ch M (A) must simplify to ni=1 pj=1         (u+ai,j ) on
replacing yi,a by (u + a) everywhere. In this way we can recover ch M (A) uniquely
from the above expression to complete the proof of Theorem 6.2.
    To prove Theorem 6.14, we will assume from now on that the shift matrix σ
is upper triangular; the result in general then follows easily by twisting with the
62                                           6. VERMA MODULES


isomorphism ι from (2.35). Exploiting this assumption, the following lemma can be
checked using the formulae in [BK4, §5] and some elementary inductive arguments.
       Lemma 6.15. The following relations hold in W (π).
         (i) For all i < j, [Fi,j (u)Di (u), Fi,j (v)Di (v)] = 0.
        (ii) For all i < j < k, (u − v)[Fj,k (u), Fi,j (v)] equals
             X              X
                (−1)r                Fir ,ir+1 (u) · · · Fi1 ,i2 (u)(Fi,i1 (v) − Fi,i1 (u)).
              r≥0          i<i1 <···<ir ≤j
                              ir+1 =k

        (iii) For all i < j and k < i or k > j, [Dk (u), Fi,j (v)] = 0.
        (iv) For all i < j, (u − v)[Di (u), Fi,j (v)] = (Fi,j (u) − Fi,j (v))Di (u).
         (v) For all i < j, (u − v)[Dj (u), Fi,j (v)] equals
           X             X
              (−1)r              Fir ,ir+1 (u) · · · Fi1 ,i2 (u)(Fi,i1 (v) − Fi,i1 (u))Dj (u).
            r≥0        i<i1 <···<ir <j
                          ir+1 =j

      (vi) For all i < j < k, (u − v)[Dj (u), Fi,k (v)] equals
     X             X
       (−1)r                Fir ,ir+1 (u) · · · Fi1 ,i2 (u)(Fi,i1 (v) − Fi,i1 (u))Fj,k (u)Dj (u).
     r≥0          i<i1 <···<ir+1 =j

      (vii) For all i < j < k, (u − v)[Fj,k (u)Dj (u), Fi,k (v)] equals
      X             X
        (−1)r               Fir ,ir+1 (u) · · · Fi1 ,i2 (u)(Fi,i1 (v) − Fi,i1 (u))Fj,k (u)Dj (u).
      r≥0          i<i1 <···<ir <j
                      ir+1 =k

    Recalling Theorem 3.5, introduce the shorthand
                          pi
                          X    (r)
(6.14)           Li (u) =    Li upi −r := upi Tn,i (u) ∈ W (π)[u]
                                      r=0
for each 1 ≤ i < n. Also for h ≥ 0 set
                                       1 dh
(6.15)                                   Li,h (u) :=
                                              Li (u).
                                       h! duh
We will apply the following simple observation repeatedly from now on: given a
vector m of generalized weight α in a W (π)-module M with the property that
α + εj − εi is not a weight of M for any 1 ≤ j < i, we have by (2.34) that
Li (u)m = upi Fi,n (u)Di (u)m.
    Lemma 6.16. Suppose we are given 1 ≤ i < n and a vector m of generalized
weight α in a W (π)-module M such that
      (i) α − d(εi − εn ) + εj − εi is not a weight of M for any 1 ≤ j < i and d ≥ 0;
     (ii) upi Di (u)m ≡ (u+a1 ) · · · (u+api )m (mod M ′ [u]) for some a1 , . . . , api ∈ F
          and some subspace M ′ of M .
For j = 1, . . . , pi , define mj := Li,h(j) (−aj )m where
                                h(j) = #{k = 1, . . . , j − 1 | ak = aj }.
                                  6.5. PROOF OF THEOREM 6.2                                              63


Then we have that
  upi Di (u)mj ≡ (u + a1 ) · · · (u + aj−1 )(u + aj − 1)(u + aj+1 ) · · · (u + api )mj
                               X                                                    pi
                                                                                    X
                                          (u + a1 ) · · · (u + api )                       (r)
                        −                                            mk     (mod          Li M ′ [u]).
                                           (u + aj )h(j)−h(k)+1                     r=1
                            k=1,...,j−1
                              ak =aj

Moreover, the subspace of M spanned by the vectors m1 , . . . , mpi coincides with the
                                 (1)           (p )
subspace spanned by the vectors Li m, . . . , Li i m.
    Proof. By Lemma 6.15(iv) and the assumptions (i)–(ii), we have that
  (u − v)[upi Di (u), Li (v)]m ≡ (v + a1 ) · · · (v + api )Li (u)m
                                                                                 pi
                                                                                 X      (r)
                             − (u + a1 ) · · · (u + api )Li (v)m          (mod         Li M ′ [u, v]).
                                                                                 r=1
Hence,
                                                                    (u + a1 ) · · · (u + api )Li (v)
  upi Di (u)Li (v)m ≡ (u + a1 ) · · · (u + api )Li (v)m −                                            m
                                                                                  u−v
                                                                   (v + a1 ) · · · (v + api )Li (u)
                                                                 +                                  m.
                                                                                u−v
                         1    dh(j)
Apply the operator     h(j)! dv h(j)   to both sides using the Leibniz rule then set v := −aj
to deduce that
  upi Di (u)Li,h(j) (−aj )m ≡ (u + a1 ) · · · (u + api )Li,h(j) (−aj )m
                                                        h(j)
                                                        X (u + a1 ) · · · (u + ap )
                                                                                 i
                                                    −                  h(j)−k+1
                                                                                    Li,k (−aj )m.
                                                        k=0
                                                            (u + a j )
The left hand side equals upi Di (u)mj by definition. The right hand side simplifies
to give
                                                        h(j)−1
                                                         X (u + a1 ) · · · (u + ap )
                                                                                  i
 (u + a1 ) · · · (u + aj − 1) · · · (u + api )mj −                      h(j)−k+1
                                                                                     Li,k (−aj )m
                                                         k=0
                                                             (u + a j )
which is exactly what we need to prove the first part of the lemma.
     For the second part, we observe that the transition matrix between the vectors
                                   (1)           (p )
Li (u1 )m, · · · , Li (upi )m and Li m, · · · , Li i m is a Vandermonde matrix with de-
             Q                                   1    dh(j)
terminant 1≤j<k≤pi (uj − uk ). Apply h(j)!              h(j) for j = 1, . . . , pi to deduce that
                                                         duj
the determinant of the transition matrix between Li,h(1) (u1 )m, · · · , Li,h(pi ) (upi )m
      (1)          (p )
and Li m, · · · , Li i m is
                        1               dh(1)         dh(pi )  Y
                                          h(1)
                                               · · ·    h(p  )
                                                                   (uj − uk ).
              h(1)!h(2)! · · · h(pi )! du                  i
                                                     dupi 1≤j<k≤pi
                                          1

Evaluate this expression at uj = −aj for each j = 1, . . . , pi to get
                                         Y
                     (−1)h(1)+···+h(pi )       (ak − aj ) 6= 0.
                                                 1≤j<k≤pi
                                                   aj 6=ak
64                                   6. VERMA MODULES

                                                                               (1)                   (pi )
Hence the transition matrix between the vectors m1 , . . . , mpi and Li m, · · · , Li                        m
is invertible, so they span the same space.                                                                  
    Lemma 6.17. Under the same assumptions as Lemma 6.16, let Cd denote the
set of all pi -tuples c = (c1 , . . . , cpi ) of natural numbers summing to d. Put a total
order on Cd so that c′ < c if c′ is lexicographically greater than c. For c ∈ Cd let
                                     cj
                                  pi Y
                                  Y
                          mc :=             Li,hc (j,k) (−aj + k − 1)m
                                  j=1 k=1

where hc (j, k) = #{l = 1, . . . , j − 1 | al − cl = aj − k + 1}. Then
           upi Di (u)mc ≡ (u + a1 − c1 ) · · · (u + api − cpi )mc        (mod Mc′ [u])
where Mc′ is the subspace of M spanned by all the vectors mc′ for c′ < c and
  (r )      (r )
Li 1 · · · Li d M ′ for 1 ≤ r1 , . . . , rd ≤ pi . Moreover, the vectors {mc | c ∈ Cd } span
                                                   (r )   (r )
the same subspace of M as the vectors Li 1 · · · Li d m for all 1 ≤ r1 , . . . , rd ≤ pi .
    Proof. Note first that the definition of the vectors mc does not depend on the
order taken in the products, thanks to Lemma 6.15(i). Now proceed by induction
on d, the case d = 1 being precisely the result of the previous lemma. For d > 1,
define vectors m1 , . . . , mpi according to the preceeding lemma. For r = 1, . . . , pi ,
                                                            (s)
let Mr′ be the subspace spanned by m1 , . . . , mr−1 and Li M ′ for all s = 1, . . . , pi .
Then the preceeding lemma shows that
        upi Di (u)mr ≡ (u + a1 ) · · · (u + ar − 1) · · · (u + api )mr       (mod Mr′ [u])
                                                                       (1)              (pi )
and that m1 , . . . , mpi span the same space as the vectors Li m, . . . , Li                   m.
    For c ∈ Cd−1 and r = 1, . . . , pi , let
                                 cj
                              pi Y
                              Y
                    mr,c :=             Li,hr,c (j,k) (−aj + δj,r + k − 1)mr
                              j=1 k=1
                                                                                        ′
where hr,c (j, k) := #{l = 1, . . . , j − 1 | al − δr,l − cl = aj − δr,j − k + 1}. Let Mr,c be
                                                                               (r1 )            (rd−1 )
the subspace of M spanned by all mr,c′ for c′ < c together with Li                     · · · Li           Mr′
for all 1 ≤ r1 , . . . , rd−1 ≤ pi . Then by the induction hypothesis,
upi Di (u)mr,c ≡ (u+a1 −c1 ) · · · (u+ar −1−cr ) · · · (u+api −cpi )mr,c                ′
                                                                                  (mod Mr,c [u]).
Moreover the vectors {mr,c | c ∈ Cd−1 } span the same subspace of M as the vectors
  (r )          (r    )
Li 1 · · · Li d−1 mr for all 1 ≤ r1 , . . . , rd−1 ≤ pi . Now observe that if c ∈ Cd−1
satisfies c1 = · · · = cr−1 = 0, then mr,c = mc+δr where c + δr ∈ Cd is the tuple
(c1 , . . . , cr−1 , cr + 1, cr+1 , . . . , cpi ); otherwise, mr,c lies in the subspace spanned by
the ms,c′ for s < r, c′ ∈ Cd−1 . The lemma follows.                                              
     At last we can complete the proof of Theorem 6.14. Let C denotePthe set of all
                                                                                        pi
tuples c = (ci,j )1≤i≤n−1,1≤j≤pi of natural numbers. Writing |c|i for j=1                  ci,j and
                                                                                     ′
|c| for |c|1 + |c|2 + · · · + |c|n−1 , we put a total order on C so that c ≤ c if any of
the following hold:
      (a) |c′ | < |c|;
      (b) |c′ | = |c| but |c′ |n−1 = |c|n−1 ,|c′ |n−2 = |c|n−2 ,. . . , |c′ |i+1 = |c|i+1 and
           |c′ |i > |c|i for some i ∈ {1, . . . , n − 1};
      (c) |c′ |i = |c|i but the tuple (c′i,1 , . . . , c′i,pi ) is lexicographically greater than
           or equal to the tuple (ci,1 , . . . , ci,pi ) for every i = 1, . . . , n − 1.
                                  6.5. PROOF OF THEOREM 6.2                                       65


Now let M := M (A) for short. For each c ∈ C, define a vector mc ∈ M by
                                                                
                               ci,j
                     Y Y
                     n−1    pi Y                                 
              mc :=                 Li,hc (i,j,k) (−ai,j + k − 1) v+
                                                                
                            i=1    j=1 k=1

where hc (i, j, k) = #{l = 1, . . . , j − 1 | ai,l − ci,l = ai,j − k + 1} and the first
product is taken in order of increasing i from left to right. The second part of
Lemma 6.17 and Theorem 6.1(ii) imply that the vectors {ymc | y ∈ Y, c ∈ C}
form a basis for M , where Y here denotes the set of all monomials in the elements
   (r)
{Tj,i | 1 ≤ i < j ≤ n − 1, r = 1, . . . , pi }. For each c ∈ C, let Mc resp. Mc′ denote the
                                                   ′                               ′
       S of M spanned by {ymc |y ∈ Y, c ≤ c} resp. {ymc |y ∈ Y, c < c}. Clearly
subspace                               ′                                ′

M = c∈C Mc . Now we complete the proof of Theorem 6.14 by showing that each
Mc is actually a W (π̄)-submodule of M with Mc /Mc′ ∼             = M (B) for B ∈ Row(π̄) such
that B has entries (ai,1 −ci,1 ), . . . , (ai,pi −ci,pi ) on its ith row for each i = 1, . . . , n−1.
     Proceeding by induction on the total ordering on C, the induction hypothesis
allows us to assume that Mc′ is a W (π̄)-submodule of M . Then the vectors
                                  {ymc′ + Mc′ | y ∈ Y, c′ ≥ c}
form a basis for the W (π̄)-module M/Mc′ . Hence the vector mc := mc + Mc′ is a
                                                                 (r)
vector of maximal weight in M/Mc′ , so it is annihilated by all Ei for i = 1, . . . , n−2
and r > si,i+1 . Moreover, using Lemma 6.15(iii),(vi) and (vii), Lemma 6.17 and
the PBW theorem for Y(1♭ n ) (σ), one checks that
                 upi Di (u)mc = (u + ai,1 − ci,1 ) · · · (u + ai,pi − ci,pi )mc .
Hence, mc ∈ M/Mc′ is a highest weight vector of type B as claimed. Now it
follows easily using Theorem 6.1(ii) and the universal property of generalized Verma
modules that Mc is a W (π̄)-submodule of M and Mc /Mc′ ∼    = M (B).
                                            CHAPTER 7


                                Standard modules

    In this chapter, we begin by classifying the finite dimensional irreducible repre-
sentations of W (π) and of Yn (σ), following the argument in the case of the Yangian
Yn itself due to Tarasov [T2] and Drinfeld [D]. Then we define and study another
family of finite dimensional W (π)-modules which we call standard modules.

                                           7.1. Two rows
    In this section we assume that n = 2 and let π be any pyramid with just two
rows of lengths p1 ≤ p2 . We will represent the π-tableau with entries a1 , . . . , ap1
                                                           a1 ···ap
on its first row and b1 , . . . , bp2 on its second row by b1 ···bp21 . The first lemma is well
known; see e.g. [CP1]. We reproduce here the detailed argument following [M2,
Proposition 3.6] since we need to slightly weaken the hypotheses later on.
     Lemma 7.1. Assume p1 = p2 = l and a1 , . . . , al , b1 , . . . , bl , a, b ∈ F.
       (i) If ai > b implies that ai ≥ a > b for each i = 1, . . . , l, then all highest
           weight vectors in L(ab11 ···a          a
                                    ···bl ) ⊠ L( b ) are scalar multiples of v+ ⊗ v+ .
                                        l


      (ii) If a > bi implies that a > b ≥ bi for each i = 1, . . . , l, then all highest
           weight vectors in L(ab) ⊠ L(ab11 ···a
                                              ···bl ) are scalar multiples of v+ ⊗ v+ .
                                                  l



      Proof. (i) Abbreviate e := e1,2 , d2 := e2,2 and f := e2,1 in the Lie algebra
gl2 . Let f (r) denote f r /r!. Recall that the irreducible gl2 -module L(ab) of highest
weight (a, b + 1) has basis v+ , f v+ , f (2) v+ , . . . if a 6> b or v+ , f v+ , . . . , f (a−b−1) v+
if a > b. Also ef (r+1) v+ = (a − b − r − 1)f (r) v+ .
      Suppose that L(ab11 ···a        a
                          ···bl ) ⊠ L( b ) contains a highest weight vector v that is not a
                              l


scalar multiple of v+ ⊗ v+ . We can write
                                            k
                                            X
                                     v=           mi ⊗ f (k−i) v+
                                            i=0
for vectors m0 6= 0, m1 , . . . , mk and k ≥ 0 with k < a − b in case a > b. The element
  (r+1)                                    (r+1)      (r)         (r)
T1,2 acts on the tensor product as T1,2 ⊗1+T1,2 ⊗d2 +T1,1 ⊗e ∈ W (π)⊗U (gl2 ).
               (r+1)
    Apply T1,2         to the vector v and compute the ? ⊗ y (k) v+ -coefficient to deduce
that
                               (r+1)                         (r)
                              T1,2     m0 + (b + k + 1)T1,2 m0 = 0
                                     (r)
for all r ≥ 0. It follows that T1,2 m0 = 0 for all r > 0, hence m0 is a scalar multiple
of the canonical highest weight vector v+ of L(ab11 ···a
                                                      ···bl ). Moreover we must in fact
                                                           l


have that k ≥ 1 since v is not a multiple of v+ ⊗ v+ .
                                                         (r+1)
     Next compute the ? ⊗ f (k−1) v+ -coefficient of T1,2 v to get that
                    (r+1)                    (r)                      (r)
                  T1,2      m1 + (b + k)T1,2 m1 + (a − b − k)T1,1 m0 = 0.

                                                    67
68                                      7. STANDARD MODULES


Multiply by (−(b + k))l−r and sum over r = 0, 1, . . . , l to deduce that
                                                  l
                                                  X
                       (l+1)                                       (r)
                      T1,2     m1 + (a − b − k)     (−(b + k))l−r T1,1 m0 = 0.
                                                  r=0
       (l+1)
But   T1,2     = 0 in W (π) by a trivial special case of Theorem 3.5. Moreover, by the
                                  Pl       l−r (r)
definition (6.1), we have that       r=0 u    T1,1 m0 = (u + a1 ) · · · (u + al )m0 . So we
have shown that
                  (a − b − k)(a1 − b − k)(a2 − b − k) · · · (al − b − k) = 0.
Since k ≥ 1 and k < a − b in case a > b, we have that (a − b − k) 6= 0. Hence we
must have that ai = b + k for some i = 1, . . . , l, i.e. ai > b and either a 6> b or
ai < a. This is a contradiction.
    (ii) Similar.                                                                  
      Corollary 7.2. Assume p1 = p2 = l and a1 , . . . , al , b1 , . . . , bl , a, b ∈ F.
        (i) If b < ai implies that b < a ≤ ai for each i = 1, . . . , l, then L(ab) ⊠ L(ab11 ···a
                                                                                               ···bl )
                                                                                                   l


            is a highest weight module generated by the highest weight vector v+ ⊗ v+ .
       (ii) If bi < a implies that bi ≤ b < a for each i = 1, . . . , l, then L(ab11 ···a          a
                                                                                     ···bl ) ⊠ L( b )
                                                                                         l


            is a highest weight module generated by the highest weight vector v+ ⊗ v+ .
    Proof. (i) By Lemma 7.1(i), L(ab11 ···a              a
                                             ···bl ) ⊠ L( b ) has simple socle generated by
                                                 l


the highest weight vector v+ ⊗ v+ . Now apply the duality ?τ using Corollary 5.11
and (3.29) to deduce that
                                        a τ ∼
                      (L(ab1 ···al
                                    1   l
                                                      a        a1 ···al
                             ···b ) ⊠ L( b )) = L( b ) ⊠ L( b ···b )1   l

has a unique maximal submodule and that the highest weight vector v+ ⊗ v+ does
not belong to this submodule. Hence it is a highest weight module generated by
the vector v+ ⊗ v+ .
    (ii) Similar.                                                            
     Remark 7.3. The module L(ab11 ···a      ···bl ) in the statement of Corollary 7.2 can
                                                 l


in fact be replaced by any non-zero quotient of the generalized Verma module
M (ab11 ···a                                                     a1 ···al
        ···bl ). This follows because the only property of L( b1 ···bl ) needed for the proof
            l


of Lemma 7.1 is that all its highest weight vectors are scalar multiples of v+ ; any
non-zero submodule of M (ab11 ···a    l τ
                                  ···bl ) also has this property.

      Lemma 7.4. Assume p1 ≤ p2 and a1 , . . . , ap1 , b1 , . . . , bp2 , b ∈ F.
       (i) If ai > b implies that ai > bi ≥ b for each i = 1, . . . , p1 then all highest
                               a1 ···ap
           weight vectors in L( b1 ···bp21 ) ⊠ L( b ) are scalar multiples of v+ ⊗ v+ .
                                                                            a1 ···ap
       (ii) All highest weight vectors in the module L( b ) ⊠ L( b1 ···bp21 ) are scalar mul-
            tiples of v+ ⊗ v+ .
    Proof. Let σ = (si,j )1≤i,j≤2 be a shift matrix corresponding to the pyramid
π. Also note (since n = 2) that L( b ) is the one dimensional gl1 -module with basis
v+ such that e1,1 v+ = (b + 1)v+ .
                                                                      a1 ···ap
    (i) Suppose that m⊗ v+ is a non-zero highest weight vector in L( b1 ···bp21 )⊠ L( b ).
                         (r+1)
So we have that E1               (m ⊗ v+ ) = 0 for all r > s1,2 and
                 p1
               u D1 (u)(m ⊗ v+ ) = (u + c1 )(u + c2 ) · · · (u + cp1 )(m ⊗ v+ )
for some scalars c1 , . . . , cp1 ∈ F.
                                           7.1. TWO ROWS                                                 69


    Applying the Miura transform to Lemma 3.3 (or see [BK5, Lemma 11.3] and
                                                (r+1)      (r+1)          (r)
[BK5, Theorem 4.1(i)]), we have that ∆p2 ,1 (E1       ) = E1     ⊗ 1 + E1 ⊗ e1,1
                          (r+1)             (r)
for all r > s1,2 . Hence E1     m + (b + 1)E1 m = 0 for all r > s1,2 . On setting
         (s +1)                      (s +r+1)
m′ := E1 1,2 m, we deduce that E1 1,2         m = (−(b + 1))r m′ for all r ≥ 0, i.e.
                                                                                     u−s1,2 −1
 E1 (u)m = (1 − (b + 1)u−1 + (b + 1)2 u−2 − · · · )u−s1,2 −1 m′ =                                m′ .
                                                                                  1 + (b + 1)u−1
                                     (r)
If m′ = 0 then we have that E1 m = 0 for all r > s1,2 , hence m is a scalar multiple
of v+ as required. So assume from now on that m′ 6= 0 and aim for a contradiction.
                   (r)    (r)
    Since ∆p2 ,1 (D1 ) = D1 ⊗ 1 for all r > 0 we have that
                  D1 (u)m = (1 + c1 u−1 )(1 + c2 u−1 ) · · · (1 + cp1 u−1 )m.
                                                                 (s1,2 +1)
The last two equations and the identity [D1 (u), E1                          ] = us1,2 D1 (u)E1 (u) in
W (π)[[u−1 ]] show that
                             (1 + c1 u−1 ) · · · (1 + cp1 u−1 )(1 + (b + 1)u−1 ) ′
                D1 (u)m′ =                                                      m.
                                                    1 + bu−1
          (r)
Since D1 = 0 for r > p1 it follows from this that b = ci for some 1 ≤ i ≤ p1 .
Without loss of generality we may as well assume that b = c1 . Then we have shown
that
           D1 (u)m′ = (1 + (c1 + 1)u−1 )(1 + c2 u−1 ) · · · (1 + cp1 u−1 )m′ .
                                                                             a1 ···ap
    Now we claim that if we have any non-zero vector in L( b1 ···bp21 ) on which D1 (u)
acts as the scalar (1 + d1 u−1 ) · · · (1 + dp1 u−1 ) then there exists a permutation
w ∈ Sp1 such that ai ≥ dwi and moreover if ai > bi then dwi > bi , for each
                                                               a1 ···ap
i = 1, . . . , p1 . To prove this, we may replace the module L( b1 ···bp21 ) with the tensor
                              ap                                                              a1 ···ap
product L(ab11 ) ⊠ · · · ⊠ L( bp11 ) ⊠ L(bp1 +1 ) ⊠ · · · ⊠ L(bp2 ), since that contains L( b1 ···bp21 )
(possibly twisted by the isomorphism ι) as a subquotient. Now the claim follows
from Lemma 5.1 and the familiar fact that if we have a non-zero vector in the
irreducible gl2 -module L(ab) on which D1 (u) acts as the scalar (1 + du−1 ) then
a ≥ d and moreover if a > b then d > b.
                                                                                a1 ···ap
     Applying the claim to the non-zero vectors m and m′ of L( b1 ···bp21 ), we deduce
(after reordering if necessary) that there exists a permutation w ∈ Sp1 such that
      (a) a1 ≥ c1 +1 and moreover if a1 > b1 then c1 +1 > b1 ; a2 ≥ c2 and moreover
          if a2 > b2 then c2 > b2 ; . . . ; ap1 ≥ cp1 and moreover if ap1 > bp1 then
          cp1 > bp1 ;
      (b) a1 ≥ cw1 and moreover if a1 > b1 then cw1 > b1 ; a2 ≥ cw2 and moreover
          if a2 > b2 then cw2 > b2 ; . . . ; ap1 ≥ cwp1 and moreover if ap1 > bp1 then
          cwp1 > bp1 .
From this we can derive the required contradiction, as follows. Suppose that we
know that ci > b for some i. Then ai ≥ ci > b, hence by the hypothesis from the
statement of the lemma ai ≥ cwi > bi ≥ b. Hence cwi > b. Now we do know that
c1 = b. Hence a1 ≥ c1 + 1 > b, so a1 ≥ cw1 > b1 ≥ b. Hence cw1 > b. Combining
this with the preceeding observation we deduce that cwk 1 > b for all k ≥ 1, hence
in particular c1 > b.
70                                  7. STANDARD MODULES

                                    (r)                    (r)
    (ii) We have that ∆1,p2 (E1 ) = 1 ⊗ E1 for all r > s1,2 . So if v+ ⊗ m is a
                                    a1 ···ap            (r)
highest weight vector in L( b ) ⊠ L( b1 ···bp21 ) then E1 m = 0 for all r > s1,2 . Hence
m is a scalar multiple of v+ as required.                                             
     Corollary 7.5. Assume p1 ≤ p2 and a1 , . . . , ap1 , b1 , . . . , bp2 , b ∈ F.
       (i) If b < ai implies that b ≤ bi < ai for each i = 1, . . . , p1 then the module
                    a1 ···ap
           L( b )⊠L( b1 ···bp21 ) is a highest weight module generated by the highest weight
           vector v+ ⊗ v+ .
                               a1 ···ap
      (ii) The module L( b1 ···bp21 ) ⊠ L( b ) is a highest weight module generated by the
           highest weight vector v+ ⊗ v+ .
     Proof. Argue using the duality ?τ exactly as in the proof of Corollary 7.2. 
                                                                     a1 ···ap
   Remark 7.6. As in Remark 7.3, the module L( b1 ···bp21 ) in the statement of
Corollary 7.5(ii) can be replaced by any non-zero quotient of the generalized Verma
            a1 ···ap
module M ( b1 ···bp21 ). We cannot quite say the same thing for Corollary 7.5(i), but
                                                   a1 ···ap
by the proof we can at least replace L( b1 ···bp21 ) by any non-zero quotient M of the
                                     a1 ···ap
generalized Verma module M ( b1 ···bp21 ) with the property that all of its Gelfand-
Tsetlin weights, i.e. the A(u) ∈ P2 such that MA(u) 6= 0, are also Gelfand-Tsetlin
                                           ap
weights of the module L(ab11 ) ⊠ · · · ⊠ L( bp11 ) ⊠ L(bp1 +1 ) ⊠ · · · ⊠ L(bp2 ).
     Now we can prove the main theorem of the section. This is new only if p1 6= p2 .
    Theorem 7.7. Assume p1 ≤ p2 and a1 , . . . , ap1 , b1 , . . . , bp2 ∈ F are scalars such
that the following property holds for each i = 1, . . . , p1 :
          If the set {aj − bk | i ≤ j ≤ p1 , i ≤ k ≤ p2 such that aj > bk } is
          non-empty then (ai − bi ) is its smallest element.
                                                a1 ···ap
Then the irreducible W (π)-module L( b1 ···bp21 ) is isomorphic to the tensor product of
the modules
                                           ap
                       L(ab11 ), . . . , L( bp11 ), L(bp1 +1 ), . . . , L(bp2 )
taken in any order that matches the shape of the pyramid π.
    Proof. Assume to start with that the pyramid π is left-justified. First we
show for p1 > 0 that
                        a1 ···ap                     a2 ···ap
                      L( b1 ···bp11 ) ∼   a
                                      = L( b11 ) ⊠ L( b2 ···bp11 ).
Since a1 > bi implies that a1 > b1 ≥ bi for all i = 2, . . . , p1 , Lemma 7.1(ii) implies
that v+ ⊗ v+ is the unique (up to scalars) highest weight vector in the module on
the right hand side. Since b1 < ai implies b1 < a1 ≤ ai , Corollary 7.2(i) shows that
this vector generates the whole module. Hence it is irreducible, so isomorphic to
  a1 ···ap
L( b1 ···bp11 ) by Lemma 5.4. Next we show for p2 > p1 that
                             a1 ···ap          a1 ···ap
                           L( b1 ···bp21 ) ∼
                                           = L( b1 ···bp 1−1 ) ⊠ L(bp2 ).
                                                            2

Since ai > bp2 implies ai > bi ≥ bp2 Lemma 7.4(i) implies that v+ ⊗v+ is the unique
(up to scalars) highest weight vector in the module on the right hand side. But
by Corollary 7.5(ii) this vector generates the whole module, hence it is irreducible.
Using these two facts, it follows by induction on p2 that
               a1 ···ap
                          ∼ L(ab 1 ) ⊠ · · · ⊠ L(ab p1 ) ⊠ L(bp +1 ) ⊠ · · · ⊠ L(bp ).
            L( b ···b 1 ) =
                 1   p2         1                     p1         1              2
   7.2. CLASSIFICATION OF FINITE DIMENSIONAL IRREDUCIBLE REPRESENTATIONS 71


This proves the theorem for one particular ordering of the tensor product and for
one particular choice of the pyramid π with row lengths (p1 , p2 ). The theorem for
all other orderings and pyramids follows from this by character considerations. 
       Suppose finally that we are given an arbitrary two row tableau A with entries
a1 , . . . , ap1 on row one and b1 , . . . , bp2 on row two. We can always reindex the entries
in the rows so that the hypothesis of Theorem 7.7 is satisfied: first reindex to ensure
if possible that a1 −b1 is the minimal positive integer difference amongst all the dffer-
ences ai − bj , then inductively reindex the remaining entries a2 , . . . , ap1 , b2 , . . . , bp2 .
Hence Theorem 7.7 shows that every irreducible admissible W (π)-module can be
realized as a tensor product of irreducible gl2 - and gl1 -modules. This remarkable
observation was first made by Tarasov [T2] in the case p1 = p2 .
                                                            a1 ···ap
    Corollary 7.8. If the irreducible module L( b1 ···bp21 ) is finite dimensional for
scalars a1 , . . . , ap1 , b1 , . . . , bp2 ∈ F then there exists a permutation w ∈ Sp2 such that
a1 > bw1 , a2 > bw2 , . . . , ap1 > bwp1 .
    Proof. Reindexing if necessary, we may assume that the hypothesis of Theo-
rem 7.7 is satisfied. Then by the theorem we must have that L(abii ) is finite dimen-
sional for each i = 1, . . . , p1 , i.e ai > bi for each such i.                   

   7.2. Classification of finite dimensional irreducible representations
      Now assume that π = (q1 , . . . , ql ) is an arbitrary pyramid with row lengths
(p1 , . . . , pn ). Let σ = (si,j )1≤i,j≤n be a shift matrix corresponding to π, so that
W (π) is canonically a quotient of the shifted Yangian Yn (σ). Recall the definitions
of the sets Row(π) of row symmetrized π-tableaux, Col(π) of column strict π-
tableaux and Dom(π) of dominant row symmetrized π-tableaux from §4.1.
    Theorem 7.9. For A ∈ Row(π), the irreducible W (π)-module L(A) is finite
dimensional if and only if A is dominant, i.e. it has a representative belonging to
Col(π).
     Proof. Suppose first that L(A) is finite dimensional. For each i = 1, . . . , n−1,
let σi denote the 2 × 2 submatrix
                                                 
                                  si,i    si,i+1
                                  si+1,i si+1,i+1
of the matrix σ. Also let ai,1 , . . . , ai,pi be the entries in the ith row of A for each
i = 1, . . . , n. The map ψi−1 from (2.72) obviously induces an embedding of the
shifted Yangian Y2 (σi ) into Yn (σ). The highest weight vector v+ ∈ L(A) is also
a highest weight vector in the restriction of L(A) to Y2 (σi ) using this embedding.
Hence by Corollary 7.8 there exists w ∈ Spi+1 such that
                  ai,1 > ai+1,w1 , ai,2 > ai+1,w2 , . . . , ai,pi > ai+1,wpi ,
for each i = 1, . . . , n − 1. Hence A has a representative belonging to Col(π).
      Conversely, suppose that A has a representative belonging to Col(π). Let
A1 , . . . , Al be the columns of this representative, so that A ∼row A1 ⊗ · · · ⊗ Al .
Since Ai is column strict, the irreducible module L(Ai ) is finite dimensional. By
Lemma 5.4 the tensor product L(A1 ) ⊠ · · · ⊠ L(Al ) is then a finite dimensional
W (π)-module containing a highest weight vector of type A. Hence L(A) is finite
dimensional.                                                                        
72                                   7. STANDARD MODULES


    Hence, the modules {L(A) | A ∈ Dom(π)} give a full set of pairwise non-
isomorphic finite dimensional irreducible W (π)-modules. As a corollary, we have
the following result classifying the finite dimensional irreducible representations of
the shifted Yangians Yn (σ) themselves. Since every finite dimensional Yn (σ)-module
is admissible, it is enough for this to determine which of the irreducible modules
L(σ, A(u)) from (5.8) is finite dimensional.
     Corollary 7.10. For A(u) ∈ Pn , the irreducible Yn (σ)-module L(σ, A(u)) is
finite dimensional if and only if there exist (necessarily unique) monic polynomials
P1 (u), . . . , Pn−1 (u), Q1 (u), . . . , Qn−1 (u) ∈ F[u] such that (Pi (u), Qi (u)) = 1, Qi (u)
is of degree di := si,i+1 + si+1,i , and
                                  Ai (u)      Pi (u)    udi
                                          =           ×
                                 Ai+1 (u)   Pi (u − 1) Qi (u)
for each i = 1, . . . , n − 1.
    Proof. Recall from Remark 5.7 that every admissible irreducible Yn (σ)-module
may be obtained by inflating an admissible irreducible W (π)-module through the
map (5.11), for some pyramid π with shift matrix σ and some f (u) ∈ 1+u−1 F[[u−1 ]].
Given this and Theorem 7.9, we see that L(σ, A(u)) is finite dimensional if and
only if there exist l ≥ sn,1 + s1,n , f (u) ∈ 1 + u−1 F[[u−1 ]] and scalars ai,j ∈ F for
1 ≤ i ≤ n, 1 ≤ j ≤ pi := l − sn,i − si,n such that
      (a) Ai (u) = f (u)(1 + ai,1 u−1 ) · · · (1 + ai,pi u−1 ) for each i = 1, . . . , n;
     (b) ai,j ≥ ai+1,j for each i = 1, . . . , n − 1 and j = 1, . . . , pi .
Following the proof of [M2, Theorem 2.8], these conditions are equivalent to the
existence of monic polynomials P1 (u), . . . , Pn−1 (u), Q1 (u), . . . , Qn−1 (u) ∈ F[u] such
that Qi (u) is of degree di and
                                  Ai (u)      Pi (u)    udi
                                          =           ×
                                 Ai+1 (u)   Pi (u − 1) Qi (u)
for each i = 1, . . . , n − 1. Finally to get uniqueness of the Pi (u)’s and Qi (u)’s we
have to insist in addition that (Pi (u), Qi (u)) = 1.                                  
     Remark 7.11. From Corollary 7.10 and (2.83), it also follows that the isomor-
phism classes of irreducible SYn (σ)-modules are parametrized in the same fashion
by monic polynomials P1 (u), . . . , Pn−1 (u), Q1 (u), . . . , Qn−1 (u) ∈ F[u] such that
Qi (u) is of degree di and (Pi (u), Qi (u)) = 1 for each i = 1, . . . , n − 1. In the case σ
is the zero matrix, each Qi (u) is of course just equal to 1, so we recover the classi-
fication from [D] of finite dimensional irreducible representations of the Yangian of
sln by their Drinfeld polynomials P1 (u), . . . , Pn−1 (u); see also [M2, §2] once more.

                                    7.3. Tensor products
    Continuing with the notation from the previous section, we set m := ql for
short. For A ∈ Col(π) with columns A1 , . . . , Al from left to right, let
(7.1)                            V (A) := L(A1 ) ⊠ · · · ⊠ L(Al ).
We will refer to the modules {V (A) | A ∈ Col(π)} as standard modules. As we
observed already in the proof of Theorem 7.9, each V (A) is a finite dimensional
W (π)-module, and the vector v+ ⊗ · · · ⊗ v+ ∈ V (A) is a highest weight vector of
type equal to the row equivalence class of A. We wish to give a sufficient condition
                                     7.3. TENSOR PRODUCTS                                           73


for V (A) to be a highest weight module generated by this highest weight vector,
following an argument due to Chari [C] in the context of quantum affine algebras.
The key step is provided by the following lemma; in its statement we work with
the usual action of the symmetric group Sm on finite dimensional irreducible glm -
modules, and s1 , . . . , sm−1 ∈ Sm denote the basic transpositions.
    Lemma 7.12. Suppose that we are given a π-tableau A with columns A1 , . . . , Al
from left to right, together with 1 ≤ t < m = ql and w ∈ Sm such that
                                     t ≥ w−1 t < w−1 (t + 1).
Letting a1 , . . . , ap resp. c1 , . . . , cq , b1 , . . . , bp denote the entries in the (n − m + t)th
resp. the (n − m + t + 1)th row of A read from left to right, assume that
       (i) ai > bi for each i = 1, . . . , p;
      (ii) ai 6> aj for each 1 ≤ i < j ≤ p;
     (iii) either ci 6< aj or ci ≤ bj for each i = 1, . . . , q and j = 1, . . . , p;
     (iv) none of the elements c1 , . . . , cq lie in the same coset of F modulo Z as ap ;
      (v) Al is column strict.
Then the vector v+ ⊗ · · · ⊗ v+ ⊗ st wv+ is an element of the W (π)-submodule of
L(A1 ) ⊠ · · · ⊠ L(Al−1 ) ⊠ L(Al ) generated by the vector v+ ⊗ · · · ⊗ v+ ⊗ wv+ .
    Since this is technical, let us postpone the proof until the end of the section
and explain the applications. For the first one, recall from §4.1 the definition of the
set Std(π) of standard π-tableaux in the case that π is left-justified.
    Theorem 7.13. Assume that the pyramid π is left-justified and let A ∈ Std(π).
Then the W (π)-module V (A) is a highest weight module generated by the highest
weight vector v+ ⊗ · · · ⊗ v+ .
    Proof. Let A1 , . . . , Al denote the columns of A from left to right, and set
M := L(A1 ) ⊠ · · · ⊠ L(Al−1 ), L := L(Al ) for short. By induction on l, M is
a highest weight module generated by the vector v+ ⊗ · · · ⊗ v+ . Fix the reduced
expression w0 = sih · · · si1 for the longest element of the symmetric group Sm where
         (i1 , . . . , ih ) = (m − 1; m − 2, m − 1; . . . ; 2, . . . , m − 1; 1, . . . , m − 1).
For r = 0, . . . , h let vr := sir · · · si1 v+ ∈ L. Note by the choice of reduced expression
that ir+1 ≥ si1 · · · sir (ir+1 ) < si1 · · · sir (ir+1 + 1). So, taking w = sir · · · si1 and
t = ir+1 for some r = 0, . . . , h−1, the hypotheses of Lemma 7.12 are satisfied. Hence
the lemma implies that the vector v+ ⊗· · ·⊗v+ ⊗vr+1 lies in the W (π)-submodule of
M ⊠L generated by the vector v+ ⊗· · ·⊗v+ ⊗vr . This is true for all r = 0, . . . , h−1,
and vh = w0 v+ . So this shows that the vector v+ ⊗ · · · ⊗ v+ ⊗ w0 v+ lies in the
W (π)-submodule of M ⊠L generated by the highest weight vector v+ ⊗· · ·⊗v+ ⊗v+ .
     Now to complete the proof we show that M ⊠ L is generated as a W (π)-module
by the vector v+ ⊗· · ·⊗v+ ⊗w0 v+ . Let Md denote the span of all generalized weight
spaces of M of weight λ − (εj1 − εj1 +1 ) − · · · − (εjd − εjd +1 ) for 1 ≤ j1 , . . . , jd < n,
where λ ∈ c∗ is the weight of the highest weight vector v+ ⊗ · · · ⊗ v+ of M . We will
prove by induction on d ≥ 0 that Md ⊗ L is contained in the W (π)-submodule of
M ⊠ L generated by the vector (v+ ⊗ · · · ⊗ v+ ) ⊗ w0 v+ . Note to start with for any
vector y ∈ L and 1 ≤ i < m that
                (1)
              En−m+i ((v+ ⊗ · · · ⊗ v+ ) ⊗ y) = (v+ ⊗ · · · ⊗ v+ ) ⊗ (ei,i+1 y).
74                                   7. STANDARD MODULES


Since L is generated as a glm -module by the lowest weight vector w0 v+ this is
enough to verify the base case. Now for the induction step we know already that
M is a highest weight module, hence it suffices to show that every vector of the form
   (r)
(Fi x) ⊗ y for 1 ≤ i < n, r > 0, x ∈ Md−1 and y ∈ L lies in the W (π)-submodule
of M ⊠ L generated by Md−1 ⊗ L. But for this we have that
                         (r)                (r)
                       Fi (x ⊗ y) ≡ (Fi x) ⊗ y            (mod Md−1 ⊗ L)
by Theorem 2.5(iii).                                                                                
    For the second application, we return to an arbitrary pyramid π = (q1 , . . . , ql ).
The following theorem reduces the problem of computing the characters of all finite
dimensional irreducible W (π)-modules to that of computing the characters just
of the modules L(A) where all entries of A lie in the same coset of F modulo Z.
Twisting moreover with the automorphism ηc from (3.25) using Lemma 3.2 one
can reduce further to the case that all entries of A actually lie in Z itself, i.e.
A ∈ Dom0 (π).
     Theorem 7.14. Suppose that π = π ′ ⊗ π ′′ for pyramids π ′ and π ′′ , and we are
given A′ ∈ Dom(π ′ ) and A′′ ∈ Dom(π ′′ ) such that no entry of A′ lies in the same
coset of F modulo Z as an entry of A′′ . Then the W (π)-module L(A′ ) ⊠ L(A′′ ) is
irreducible with highest weight vector v+ ⊗ v+ .
      Proof. By character considerations, we may assume for the proof that the
pyramid π ′ is right-justified of level l′ and the pyramid π ′′ is left-justified of level
l′′ . Pick a standard π ′′ -tableau representing A′′ and let Al′ +1 , Al′ +2 , . . . , Al be its
columns read from left to right. We claim that L(A′ ) ⊠ L(Al′ +1 ) ⊠ · · · ⊠ L(Al ) is a
highest weight module generated by the highest weight vector v+ ⊗v+ ⊗· · ·⊗v+ . The
theorem follows from this claim as follows. By Theorem 7.13, L(A′′ ) is a quotient
of L(Al′ +1 ) ⊠ · · · ⊠ L(Al ). Hence we get from the claim that L(A′ ) ⊠ L(A′′ ) is a
highest weight module generated by the highest weight vector v+ ⊗ v+ . Similarly
so is L(A′′ )τ ⊠ L(A′ )τ , hence v+ ⊗ v+ is actually the unique (up to scalars) highest
weight vector in L(A′ ) ⊠ L(A′′ ). Thus L(A′ ) ⊠ L(A′′ ) is irreducible.
      To prove the claim, fix the same reduced expression w0 = sih · · · si1 for the
longest element of Sm as in the proof of Theorem 7.13. Let vr := sir · · · si1 v+ ∈
L(Al ). We are actually going to show that vr+1 lies in the W (π)-submodule of
L(A′ ) ⊠ L(Al′ +1 ) ⊠ · · · ⊠ L(Al ) generated by the vector v+ ⊗ v+ ⊗ · · · ⊗ v+ ⊗ vr for
each r = 0, . . . , h − 1. Given this, it follows that v+ ⊗ v+ ⊗ · · · ⊗ v+ ⊗ w0 v+ lies
in the W (π)-submodule generated by the highest weight vector. Since we already
know by induction that L(A′ ) ⊠ L(Al′ +1 ) ⊠ · · · ⊠ L(Al−1 ) is highest weight, the
argument can then be completed in the same way as in last paragraph of the proof
of Theorem 7.13.
      So finally fix a choice of r = 0, . . . , h− 1. Let w := sir · · · si1 and t := ir+1 . Pick
a representative for A′ so that, letting a1 , . . . , ap resp. c1 , . . . , cq , b1 , . . . , bp denote
the entries in its (n − m + t)th resp. (n − m + t + 1)th row read from left to right,
we have that
       (a) ai > bi for each i = 1, . . . , p;
       (b) ai 6> aj for each 1 ≤ i < j ≤ p;
       (c) either ci 6< aj or ci ≤ bj for each i = 1, . . . , q and j = 1, . . . , p.
To see that this is possible, it is easy to arrange things so that (a) and (b) are
satisfied. If p > 0 we rearrange the (n−m+i+1)th row so that ap −bp is the smallest
                                    7.3. TENSOR PRODUCTS                                        75


positive integer in the set {ap − b1 , . . . , ap − bp , ap − c1 , . . . , ap − cq }. The condition
(c) is then automatic for j = p, and the remaining entries c1 , . . . , cq , b1 , . . . , bp−1
can then be rearranged inductively to get (c) in general. Let A1 , . . . , Al′ denote the
columns of this representative from left to right. It then follows by Lemma 7.12 that
v+ ⊗ · · · ⊗ v+ ⊗ vr+1 lies in the W (π)-submodule of L(A1 ) ⊠ · · · ⊠ L(Al−1 ) ⊠ L(Al )
generated by the vector v+ ⊗· · ·⊗v+ ⊗vr . Since L(A′ ) is a quotient of the submodule
of L(A1 ) ⊠ · · · ⊠ L(Al′ ) generated by the highest weight vector v+ ⊗ · · · ⊗ v+ , this
completes the proof.                                                                              
      We still need to explain the proof of Lemma 7.12. Let the notation be as in
the statement of the lemma and abbreviate n − m + t by i. Let π ′ be the pyramid
consisting just of the ith and (i + 1)th rows of π. The 2 × 2 submatrix σ ′ consisting
just of the ith and (i + 1)th rows and columns of σ gives a choice of shift matrix for
π ′ . As in the proof of Theorem 7.9, the map ψi−1 from (2.72) induces an embedding
ϕ : Y2 (σ ′ ) ֒→ Yn (σ). For j = 1, . . . , l, let
                                         
                                          2 if n − qj < i,
                                qj′ :=        1 if n − qj = i,
                                         
                                              0 if n − qj > i.
So, numbering the columns of the pyramid π ′ by 1, . . . , l in the same way as in
the pyramid π, its columns are of heights q1′ , q2′ , . . . , ql′ from left to right (including
possibly some empty columns at the left hand edge). Recall the quotient map
κ : Yn (σ) ։ W (π) and the Miura transform ξ : W (π) ֒→ U (glq1 ) ⊗ · · · ⊗ U (glql )
from (3.17) and (3.26). Similarly we have the quotient map κ′ : Y2 (σ ′ ) ։ W (π ′ )
and the Miura transform ξ ′ : W (π ′ ) ֒→ U (glq1′ )⊗· · ·⊗U (glql′ ). For each j = 1, . . . , l,
define an algebra embedding ϕj : U (glqj′ ) ֒→ U (glqj ) so that if qj′ = 2 then
            e1,1 →
                 7 eqj −n+i,qj −n+i ,                 e1,2 7→ eqj −n+i,qj −n+i+1 ,
            e2,1 →7 eqj −n+i+1,qj −n+i ,              e2,2 7→ eqj −n+i+1,qj −n+i+1 ,
and if qj′ = 1 then e1,1 7→ e1,1 . We have now defined all the maps in the following
diagram:
                             κ′                 ξ′
                 Y2 (σ ′ ) −−−−→ W (π ′ ) −−−−→ U (glq1′ ) ⊗ · · · ⊗ U (glql′ )
                                                             
(7.2)             ϕy
                                                             ϕ ⊗···⊗ϕ
                                                              y 1         l


                             κ                  ξ
                 Yn (σ) −−−−→ W (π) −−−−→ U (glq1 ) ⊗ · · · ⊗ U (glql )
This diagram definitely does not commute. So the two actions of Y2 (σ ′ ) on the
U (glq1 )⊗ · · ·⊗ U (glql )-module L(A1 )⊠ · · ·⊠ L(Al ) defined using the homomorphism
ξ ◦ κ ◦ ϕ or using the homomorphism ϕ1 ⊗ · · · ⊗ ϕl ◦ ξ ′ ◦ κ′ are in general different.
In the proof of the following lemma we will see that in fact the two actions coincide
on special vectors.
    Lemma 7.15. The following subspaces of L(A1 ) ⊠ · · · ⊠ L(Al−1 ) ⊠ L(Al ) are
equal:
                 (ξ ◦ κ ◦ ϕ)(Y2 (σ ′ ))(v+ ⊗ · · · ⊗ v+ ⊗ wv+ ),
                 (ϕ1 ⊗ · · · ⊗ ϕl ◦ ξ ′ ◦ κ′ )(Y2 (σ ′ ))(v+ ⊗ · · · ⊗ v+ ⊗ wv+ ).
76                                   7. STANDARD MODULES


     Proof. For j = 1, . . . , l − 1, let vj be an element of L(Aj ) whose weight is
equal to the weight of the highest weight vector v+ of L(Aj ) minus some multiple
of the ith simple root εi − εi+1 ∈ c∗ . Also let vl be any element of L(Al ). We claim
for any element x of Y2 (σ ′ ) that
       (ξ ◦ κ ◦ ϕ)(x)(v1 ⊗ · · · ⊗ vl ) = (ϕ1 ⊗ · · · ⊗ ϕl ◦ ξ ′ ◦ κ′ )(x)(v1 ⊗ · · · ⊗ vl ).
Clearly the lemma follows from this claim. The advantage of the claim is that it
suffices to prove it for x running over a set of generators for the algebra Y2 (σ ′ ), since
the vector on the right hand side of the equation can obviously be expressed as a
linear combination of vectors of the form v1′ ⊗ · · ·⊗ vl′ where again the weight of vj′ is
equal to the weight of v+ minus some multiple of εi − εi+1 for each j = 1, . . . , l − 1,
                                                                (r)   (r)    (r)            (r)
     So now we proceed to prove the claim just for x = D1 , D2 , E1 and F1 and
all meaningful r. For each of these choices for x, explicit formulae for κ′ (x) ∈ W (π ′ )
and κ ◦ ϕ(x) ∈ W (π) are given by (3.10). On applying the Miura transforms one
obtains explicit formulae for (ξ ◦κ◦ϕ)(x) and (ϕ1 ⊗· · ·⊗ϕl ◦ξ ′ ◦κ′ )(x) as elements of
U (glq1 ) ⊗ · · · ⊗ U (glql ). By considering these formulae directly, one observes finally
that (ξ ◦ κ ◦ ϕ)(x) − (ϕ1 ⊗ · · · ⊗ ϕl ◦ ξ ′ ◦ κ′ )(x) is a linear combination of terms of
the form x1 ⊗ · · · ⊗ xl such that some xj (j = 1, . . . , l − 1) annihilates vj by weight
considerations, which proves the claim. Let us explain this last step in detail just
                       (r)
in the case x = D2 , all the other cases being entirely similar. In this case, we have
that
                                            X
(ξ ◦κ◦ϕ−ϕ1 ⊗· · ·⊗ϕl ◦ξ ′ ◦κ′ )(x) =            (−1)#{s=1,...,r−1 | row(js )≤i} ei1 ,j1 · · · eir ,jr ,
                                            i1 ,...,ir
                                            j1 ,...,jr

where we are identifying U (glq1 ) ⊗ · · · ⊗ U (glql ) with U (h) as usual, and the sum is
over 1 ≤ i1 , . . . , ir , j1 , . . . , jr ≤ n with
      (a) row(i1 ) = row(jr ) = i + 1;
      (b) col(is ) = col(js ) for all s = 1, . . . , r;
      (c) row(js ) = row(is+1 ) for all s = 1, . . . , r − 1;
      (d) if row(js ) ≥ i + 1 then col(js ) < col(is+1 ) for all s = 1, . . . , r − 1;
      (e) if row(js ) ≤ i then col(js ) ≥ col(is+1 ) for all s = 1, . . . , r − 1;
      (f) row(js ) ∈    / {i, i + 1} for at least one s = 1, . . . , r − 1.
Take such a monomial ei1 ,j1 · · · eir ,jr ∈ U (glq1 ) ⊗ · · · ⊗ U (glql ). Let c be minimal
such that there exists js with col(js ) = c and row(js ) ∈            / {i, i + 1}, then take the
maximal such s. Consider the component of ei1 ,j1 · · · eir ,jr in the cth tensor position
U (glqc ). If row(js ) > i + 1, then by the choices of c and s, this component is of
the form ueis ,js u′ where row(is ) ≤ i + 1 < row(js ) and the weight of u′ is some
multiple of εi − εi+1 . Similarly if row(js ) < i then this component is of the form
ueis+1 ,js+1 u′ where row(js+1 ) ≥ i > row(is+1 ) and the weight of u′ is some multiple
of εi − εi+1 . In either case, this component annihilates the vector vc ∈ L(Ac ) by
weight considerations.                                                                         
    Now let Lj be the irreducible U (glqj′ )-submodule of L(Aj ) generated by the
highest weight vector v+ for each j = 1, . . . , l − 1, embedding U (glqj′ ) into U (glqj )
via ϕj . Similarly, let Ll be the U (glql′ )-submodule of L(Al ) generated by the vector
wv+ . Recall by the hypotheses in Lemma 7.12 that the tableau Al is column strict
and t ≥ w−1 (t) < w−1 (t + 1). It follows that the vector wv+ ∈ Ll is a highest
weight vector for the action of U (glql′ ) with e1,1 acting as (a + i − 1) and e2,2 acting
                       7.4. CHARACTERS OF STANDARD MODULES                                   77


as (b + i), for some b < a ≥ ap . In particular Ll is also irreducible. So in our usual
notation the W (π ′ )-module L1 ⊠ · · · ⊠ Ll is isomorphic to the tensor product
                                                                 a    +i−1
      L(c1 +i−1) ⊠ · · · ⊠ L(cq +i−1) ⊠ L(ab11+i−1
                                              +i−1
                                                   ) ⊠ · · · ⊠ L( bp−1
                                                                   p−1            a+i−1
                                                                       +i−1 ) ⊠ L( b+i−1 )

for some b < a ≥ ap . Using the remaining hypotheses (i)–(iv) from Lemma 7.12, we
apply Corollaries 7.2(i) and 7.5(i), or rather the slightly stronger versions of these
corollaries described in Remarks 7.3 and 7.6, repeatedly to this tensor product
working from right to left to deduce that L1 ⊠ · · · ⊠ Ll is actually a highest weight
W (π ′ )-module generated by the highest weight vector v+ ⊗ · · · ⊗ v+ ⊗ wv+ . Hence
in particular, since st wv+ ∈ Ll , we get that
                  v+ ⊗ · · · ⊗ v+ ⊗ st wv+ ∈ W (π ′ )(v+ ⊗ · · · ⊗ wv+ ).
In view of Lemma 7.15, this completes the proof of Lemma 7.12.

                       7.4. Characters of standard modules
    We wish to explain how to compute the Gelfand-Tsetlin characters of the stan-
dard modules {V (A) | A ∈ Col(π)} from (7.1). In view of (6.6) it suffices just to
consider the special case that π consists of a single column of height m ≤ n, when
W (π) = U (glm ). Take A ∈ Col(π) with entries a1 > · · · > am read from top to
bottom. Choose an arbitrary scalar c ∈ F so that am + m − 1 ≥ c. Then
               (b1 , . . . , bm ) := (a1 − c, a2 + 1 − c, . . . , am + m − 1 − c)
is a partition. Draw its Young diagram in the usual English way and define the
residue of the box in the ith row and jth column to be (j − i). For example, if
(b1 , b2 , b3 ) = (5, 3, 2) then the Young diagram with boxes labelled by their residues
is as follows
                                         0 1 2 3 4
                                         -1 0 1
                                         -2 -1
Given a filling t of the boxes of this diagram with the integers {1, . . . , m} we asso-
ciate the monomial
                               Ym Y bi
(7.3)                  x(t) :=                            b n]
                                       xn−m+ti,j ,c+j−i ∈ Z[P
                                 i=1 j=1

where ti,j denotes the entry of t in the ith row and jth column and xi,a and yi,a
are as in (6.7)–(6.8). Then we have that
                                                               X
(7.4)          ch V (A) = yn−m+1,c yn−m+2,c−1 · · · yn,c−m+1 ×   x(t)
                                                                         t
summing over all fillings t of the boxes of the diagram with integers {1, . . . , m}
such that the entries are weakly increasing along rows from left to right and strictly
increasing down columns from top to bottom. The proof of this formula is based like
the proof of Theorem 6.1 on branching V (A) from glm to glm−1 . This time however
the restriction is completely understood by the classical branching theorem for finite
dimensional representations of glm , so everything is easy. The closest reference that
we could find in the literature is [NT, Lemma 2.1]; see also [GT, C1] and [FM,
Lemma 4.7] (the last of these references greatly influenced our choice of notation
here).
78                                7. STANDARD MODULES


     For example, suppose that m = n and that the entries of A are 1, −1, −2, . . . , 1−
n from top to bottom. Then V (A) is the n-dimensional natural representation of
gln . Taking c = 0, the possible fillings of the Young diagram are 1 , 2 ,. . . , n .
Hence
(7.5)                      ch V (A) = x1,0 + x2,0 + · · · + xn,0 .
Let us make a few further comments, still assuming           that m = n. By (6.9), we have
that
                       
                        xi,−i+1 xi,−i+2 · · · xi,a−1        if a > 1 − i,
(7.6)           yi,a =    1                                  if a = 1 − i,
                        −1 −1
                          xi,a xi,a+1 · · · x−1
                                             i,−i            if a < 1 − i
for each i = 1, . . . , n. Hence if the scalar c in (7.4) is an integer, i.e. if the
representation V (A) is a rational representation of gln , then ch V (A) belongs to
the subalgebra Z[x±1                                  b
                    i,a | i = 1, . . . , n, a ∈ Z] of Z[Pn ]. Moreover, the character of a
rational representation of gln in the usual sense can be deduced from its Gelfand-
Tsetlin character by applying the algebra homomorphism
(7.7)     Z[x±1                                  ±1
             i,a | i = 1, . . . , n, a ∈ Z] → Z[xi | i = 1, . . . , n],   xi,a 7→ xi .
Finally, if one can choose the scalar c in (7.4) to be 0, i.e. if the representation V (A)
is actually a polynomial representation of gln , then the formula (7.4) is especially
simple since the leading monomial y1,c y2,c−1 · · · yn,c−n+1 is equal to 1. So the
Gelfand-Tsetlin character of any polynomial representation of gln belongs to the
                                                b n ].
subalgebra Z[xi,a | i = 1, . . . , n, a ∈ Z] of Z[P

                              7.5. Grothendieck groups
    Let us at long last introduce some categories of W (π)-modules. First, let M(π)
denote the category of all finitely generated, admissible W (π)-modules. Obviously
M(π) is an abelian category closed under taking finite direct sums. Note that the
duality ?τ defines a contravariant equivalence M(π) → M(π t ). Also, for any other
pyramid π̇ with the same row lengths as π, the isomorphism ι from (3.20) induces
an isomorphism M(π) → M(π̇).
     Lemma 7.16. Every module in the category M(π) has a composition series.
     Proof. Copying the standard proof that modules in the usual category O have
composition series, it suffices to prove the lemma for the generalized Verma module
M (A), A ∈ Row(π). In that case it follows because all the weight spaces of M (A)
are finite dimensional, and moreover there are only finitely many irreducibles L(B)
with the same central character as M (A) by Lemma 6.13.                           
    Hence, the Grothendieck group [M(π)] of the category M(π) is the free abelian
group with basis {[L(A)] | A ∈ Row(π)}. By Theorem 6.7, we have that [M (A)] =
[L(A)] plus an N-linear combination of [L(B)]’s for B < A. It follows that the
generalized Verma modules {[M (A)] | A ∈ Row(π)} also form a basis for [M(π)].
By Theorem 5.10, the character map ch defines an injective map
(7.8)                                        b n ].
                              ch : [M(π)] ֒→ Z[P
Now suppose π = π ′ ⊗π ′′ for pyramids π ′ and π ′′ . We claim that the tensor product
⊠ induces a multiplication
(7.9)                      µ : [M(π ′ )] ⊗ [M(π ′′ )] → [M(π)].
                                7.5. GROTHENDIECK GROUPS                               79


To see that this makes sense, we need to check that the tensor product M ′ ⊠ M ′′
of M ′ ∈ M(π ′ ) and M ′′ ∈ M(π ′′ ) belongs to M(π). In view of Lemma 7.16, it
suffices to check this for generalized Verma modules. So take A′ ∈ Row(π ′ ) and
A′′ ∈ Row(π ′′ ). Then, by Corollary 6.3, we have that
                           ch(M (A′ ) ⊠ M (A′′ )) = ch M (A)
where A ∼row A′ ⊗ A′′ . In view of Theorem 5.10 and Lemma 7.16, this shows that
M (A′ ) ⊠ M (A′′ ) has a composition series with factors belonging to M(π), hence it
belongs to M(π) itself. Moreover,
(7.10)                    µ([M (A′ )] ⊗ [M (A′′ )]) = [M (A)].
Recalling the decomposition (6.13), the category M(π) has the following “block”
decomposition
                                       M
(7.11)                       M(π) =        M(π, θ)
                                             θ∈P

where M(π, θ) is the full subcategory of M(π) consisting of objects all of whose
composition factors are of central character θ; by convention, we set M(π, θ) = 0
if the coefficients of θ are not non-negative integers summing to N . Like in (4.28),
we now restrict our attention just to modules with integral central characters: let
                                          M
(7.12)                        M0 (π) :=          M(π, θ).
                                            θ∈P∞ ⊂P

The Grothendieck group [M0 (π)] has the two natural bases {[M (A)]|A ∈ Row0 (π)}
and {[L(A)] | A ∈ Row0 (π)}.
    Next recall the definition of the UZ -module S π (VZ ) from (4.4). This is also a free
abelian group, with two natural bases {MA |A ∈ Row0 (π)} and {LA |A ∈ Row0 (π)}.
Define an isomorphism of abelian groups
(7.13)               k : S π (VZ ) → [M0 (π)],        MA 7→ [M (A)]
for each A ∈ Row0 (π). Under this isomorphism, the θ-weight space of S π (VZ ) corre-
sponds to the block component [M(π, θ)] of [M0 (π)], for each θ ∈ P∞ . Moreover,
the isomorphism is compatible with the multiplications µ arising from (4.9) and
(7.9) in the sense that for every decomposition π = π ′ ⊗ π ′′ the following diagram
commutes:
                            ′          ′′             µ
                         S π (VZ ) ⊗ S π (VZ )     −−−−→ S π (VZ )
                                                            
                                                            
(7.14)                         k⊗ky                          yk
                       [M0 (π ′ )] ⊗ [M0 (π ′′ )] −−−−→ [M0 (π)]
                                                      µ

Now we can formulate the following conjecture, which may be viewed as a more
precise formulation in type A of [VD]. Note this conjecture is true if π consists of a
single column; see Theorem 4.2. It is also true if π has just two rows, by comparing
Theorem 7.7 and [B, Theorem 20].
                                                                             ∼
   Conjecture 7.17. For each A ∈ Row0 (π), the map k : S π (VZ ) → [M0 (π)]
maps the dual canonical basis element LA to the class [L(A)] of the irreducible
module L(A). In other words, for every A, B ∈ Row0 (π), we have that
                       [M (A) : L(B)] = Pd(ρ(A))w0 ,d(ρ(B))w0 (1),
80                               7. STANDARD MODULES


notation as in (4.7).
    Let us turn our attention to finite dimensional W (π)-modules. Let F (π) de-
note the category of all finite dimensional W (π)-modules, a full subcategory of the
category M(π). Let F0 (π) = F (π) ∩ M0 (π). Like in (7.11)–(7.12), we have the
block decompositions
                                        M
(7.15)                          F (π) =    F (π, θ),
                                           θ∈P
                                             M
(7.16)                          F0 (π) =             F (π, θ).
                                           θ∈P∞ ⊂P

By Theorem 7.9, the Grothendieck group [F (π)] has basis {[L(A)] | A ∈ Dom(π)}
coming from the simple modules. Hence [F0 (π)] has basis {[L(A)] | A ∈ Dom0 (π)};
we refer to these L(A) ∈ F0 (π) as the rational irreducible representations of W (π).
    Recall the subspace P π (VZ ) of S π (VZ ) from §4.2. Comparing (4.12) and (7.1)
and using (7.14), it follows that the map k : S π (VZ ) → [M0 (π)] maps VA to [V (A)].
Hence there is a well-defined map j : P π (VZ ) → [F0 (π)] such that VA 7→ [V (A)] for
each A ∈ Col0 (π). Moreover, the following diagram commutes:
                                P π (VZ ) −−−−→ S π (VZ )
                                                   
                                                   
(7.17)                            jy                yk
                            [F0 (π)] −−−−→ [M0 (π)]
where the horizontal maps are the natural inclusions.
    Lemma 7.18. The map j : P π (VZ ) → [F0 (π)], VA 7→ [V (A)] is an isomorphism
of abelian groups.
     Proof. Arguing with the isomorphism ι, it suffices to prove this in the spe-
cial case that π is left-justified. In this case, recall from (4.2) that R(A) de-
notes the row equivalence class of A ∈ Std0 (π). By Theorem 7.13, for each
A ∈ Std0 (π) the standard module V (A) is a quotient of M (R(A)), hence we
have that V (A) = L(R(A)) plus an N-linear combination of L(B)’s for B < A.
It follows that {[V (A)] | A ∈ Std0 (π)} is a basis for [F0 (π)]. Since the map
j : P π (VZ ) → [F0 (π)] maps the basis {VA | A ∈ Std0 (π)} of P π (VZ ) onto this
basis of [F0 (π)], it follows that j is indeed an isomorphism.                  
     This lemma implies that {[V (A)] | A ∈ Std0 (π)} is a basis for the Grothendieck
group [F0 (π)]. Hence, the Gelfand-Tsetlin character of any module in F0 (π) belongs
to the subalgebra Z[x±1                                   b
                        i,a | i = 1, . . . , n, a ∈ Z] of Z[Pn ], since we know already that
this is true for the standard modules. In the next lemma we extend this “standard
basis” from [F0 (π)] to all of the Grothendieck group [F (π)]. Recall for the statement
the definition of the relation k on Std(π) from the paragraph after (4.2).
    Lemma 7.19. For A, B ∈ Std(π) we have that [V (A)] = [V (B)] if and only if
A k B. The elements of the set {[V (A)] | A ∈ Std(π)} form a basis for [F (π)]. In
particular, the elements {[V (A)] | A ∈ Std0 (π)} form a basis for [F0 (π)].
    Proof. If A k B, it is obvious from (6.6) that [V (A)] = [V (B)]. We have
already proved the last statement about F0 (π), and we know that [V (A)] 6= [V (B)]
for distinct A, B ∈ Std0 (π) The remaining parts of the lemma are consequences of
these two statements and Theorem 7.14.                                           
                                     CHAPTER 8


                           Character formulae

     Throughout the chapter, we fix a pyramid π = (q1 , . . . , ql ) with associated shift
matrix σ = (si,j )1≤i,j≤n as usual. Conjecture 7.17 immediately implies that the
isomorphism j : P π (VZ ) → [F0 (π)] from (7.17) maps the dual canonical basis of the
polynomial representation P π (VZ ) to the basis of the Grothendieck group [F0 (π)]
arising from irreducible modules. In this chapter, we will give an independent
proof of this statement. Hence we can in principle compute the Gelfand-Tsetlin
characters of all finite dimensional irreducible W (π)-modules.

                             8.1. Skryabin’s theorem
    We begin by recalling the relationship between the algebra W (π) and the rep-
resentation theory of g. Let Fχ denote the one dimensional m-module defined by
the character χ. Also recall the definitions (3.7)–(3.8). Introduce the generalized
Gelfand-Graev representation
(8.1)                 Qχ := U (g)/U (g)Iχ ∼= U (g) ⊗U(m) Fχ .
We write 1χ for the coset of 1 ∈ U (g) in Qχ . Often we work with the dot action
of u ∈ U (p) on Qχ defined by u · u′ 1χ := η(u)u′ 1χ for all u′ ∈ U (g). By the
definition of W (π), right multiplication by η(w) leaves U (g)Iχ invariant for each
w ∈ W (π). Hence, there is a well-defined right W (π)-module structure on Qχ such
that (u · 1χ )w = uw · 1χ for u ∈ U (p) and w ∈ W (π). This makes the g-module
Qχ into a (U (g), W (π))-bimodule. As explained in the introduction of [BK5], the
associated representation W (π) → EndU(g) (Qχ )op is actually an isomorphism.
     Let W(π) denote the category of generalized Whittaker modules of type π, that
is, the category of all g-modules on which (x − χ(x)) acts locally nilpotently for all
x ∈ m. For any g-module M , let
(8.2)              Wh(M ) := {v ∈ M | xv = χ(x)v for all x ∈ m}.
Given w ∈ W (π) and v ∈ Wh(M ), the vector w · v := η(w)v again belongs to
Wh(M ), so Wh(M ) is a left W (π)-module via the dot action. In this way, we
obtain a functor Wh from W(π) to the category of all left W (π)-modules. In the
other direction, Qχ ⊗W (π) ? is a functor from W (π) -mod to W(π). The functor
Wh is isomorphic in an obvious way to the functor HomU(g) (Qχ , ?), so adjoint-
ness of tensor and hom gives rise to a canonical adjunction between the functors
Qχ ⊗W (π) ? and Wh. The unit and the counit of this canonical adjunction are de-
fined by M 7→ Wh(Qχ ⊗W (π) M ), v 7→ 1χ ⊗ v for M ∈ W (π) -mod and v ∈ M ,
and by Qχ ⊗W (π) Wh(M ) → M, u1χ ⊗ v 7→ uv for M ∈ W(π), u ∈ U (g) and
v ∈ Wh(M ), respectively. Skryabin’s theorem [Sk] asserts that these maps are
actually isomorphisms, so that the functors Wh and Qχ ⊗W (π) ? are quasi-inverse
equivalences between the categories W(π) and W (π) -mod.

                                           81
82                                  8. CHARACTER FORMULAE


       Skryabin also proved that Qχ is a free right W (π)-module and explained how to
write down an explicit basis, as we briefly recall. Let b1 , . . . , bh be a homogeneous
basis for m such that each bi of degree −di . The elements [b1 , e], . . . , [bh , e] are again
linearly independent, and [bi , e] is of degree (1 − di ). Hence there exist elements
a1 , . . . , ah ∈ p such that each ai is of degree (di − 1) and
(8.3)                           ([ai , bj ], e) = (ai , [bj , e]) = δi,j .
Now it follows from [Sk] that the elements {ai11 · · · aihh · 1χ | i1 , . . . , ih ≥ 0} form a
basis for Qχ as a free right W (π)-module. Hence, there is a unique right W (π)-
module homomorphism p : Qχ ։ W (π) defined by
(8.4)                           p(ai11 · · · aihh · 1χ ) = δi1 ,0 · · · δih ,0
for all i1 , . . . , ih ≥ 0. In particular, p(1χ ) = 1.

                                     8.2. Tensor identities
    Throughout the section, we let V be a finite dimensional g-module with fixed
basis v1 , . . . , vr . Define the coefficient functions ci,j ∈ U (g)∗ from the equation
                                                   r
                                                   X
(8.5)                                    uvj =           ci,j (u)vi
                                                   i=1
for all u ∈ U (g). Given any M ∈ W(π), it is clear that M ⊗ V (the usual tensor
product of g-modules) also belongs to the category W(π). Thus ? ⊗ V gives an
exact functor from W(π) to W(π). Using Skryabin’s equivalence of categories, we
can transport this functor directly to the category W (π) -mod: for a W (π)-module
M , let
(8.6)                      M ⊛ V := Wh((Qχ ⊗W (π) M ) ⊗ V ).
This defines an exact functor ? ⊛ V : W (π) -mod → W (π) -mod. The following
lemma is a reformulation of [Ly, Theorem 4.2]. For the statement, fix a right
W (π)-module homomorphism p : Qχ ։ W (π) with p(1χ ) = 1; such maps exist by
(8.4).
    Theorem 8.1. For any left W (π)-module M and any V as above, the restric-
tion of the map (Qχ ⊗W (π) M ) ⊗ V → M ⊗ V, (u1χ ⊗ m) ⊗ v 7→ p(u1χ )m ⊗ v defines
a natural vector space isomorphism
                                                           ∼
                                  χM,V : M ⊛ V −→ M ⊗ V.
                                                 Pr
The inverse isomorphism maps m⊗vj to i=1 (xi,j ·1χ ⊗m)⊗vi , where (xi,j )1≤i,j≤r
is the (necessarily invertible) matrix with entries in U (p) determined uniquely by
the properties
       (i) p(xi,j · 1χ ) = δi,j ;
                           r
                           X
      (ii) [x, η(xi,j )] +     ci,s (x)η(xs,j ) ∈ U (g)Iχ for all x ∈ m.
                          s=1
Finally, if (x′i,j )1≤i,j≤r is another matrix with entries in U (p) satisfying (ii) (primed),
              P
then x′i,j = rk=1 xi,k wk,j where (wi,j )1≤i,j≤r is the matrix with entries in W (π)
defined from the equation p(x′i,j · 1χ ) = wi,j .
                                8.2. TENSOR IDENTITIES                                83


    Proof. For any vector space M , let EM denote the space of all linear maps
f : U (m) → M which annihilate (Iχ )p for p ≫ 0, viewed as an m-module with
action defined by (xf )(u) = f (ux) for x ∈ m, u ∈ U (m). In the case M = F, we
denote EM simply by E. Skryabin proved the following fact in the course of [Sk]:
for M ∈ W (π) -mod there is a natural m-module isomorphism
                               ϕM : Qχ ⊗W (π) M → EM
defined by ϕM (u 1χ ⊗ m)(u) = p(uu′ 1χ )m for u ∈ U (m), u′ ∈ U (g) and m ∈ M .
                  ′

Using the fact that m is nilpotent and V is finite dimensional, one checks that
evaluation at 1 defines a natural isomorphism
                                           Xr            r
                                                         X
                                 ∼
               ξV : Wh(E ⊗ V ) −→ V,          fi ⊗ vi 7→   fi (1)vi .
                                                    i=1              i=1
Finally, there is an obvious natural isomorphism ψM : M ⊗ E → EM mapping
m ⊗ f ∈ M ⊗ E to the function u 7→ f (u)m. Combining these things, we obtain
the following natural isomorphisms:
                                             ϕM ⊗idV
M ⊛ V = Wh((Qχ ⊗W (π) M ) ⊗ V ) −−−−−−→                   Wh(EM ⊗ V )
                                              −1
                                             ψM  ⊗idV                      idM ⊗ξV
                                       −−−−−−→ M ⊗ Wh(E ⊗ V ) −−−−−−→ M ⊗ V.
Let χM,V : M ⊛ V → M ⊗ V denote the composite isomorphism.
    Assume in this paragraph that M = W (π), the regular W (π)-module. In this
Pr the inverse image of 1 ⊗ vj under the isomorphism χM,V can be written as
case,
  i=1 (xi,j · 1χ ⊗ 1) ⊗ vi for unique elements xi,j ∈ U (p). Now compute to see that
                                       r
                                       X
                        ξV−1 (vj ) =         fi,j ⊗ vi ∈ Wh(E ⊗ V )
                                       i=1
for elements fi,j ∈ E with fi,j (u) = ci,j (u∗ ) for u ∈ U (m). Here, ∗ : U (m) → U (m)
is the antiautomorphism with x∗ = χ(x) − x for each x ∈ m. So,
                                                          X r
                  (ψM ⊗ idV ) ◦ (idM ⊗ξV−1 )(1 ⊗ vj ) =       fˆi,j ⊗ vi ,
                                                               i=1

where fˆi,j ∈ EM satisfies fˆi,j (u) = ci,j (u )1. On the other hand,
                                                ∗

                              X   r                      X r
                (ϕM ⊗ idV )          (xi,j · 1χ ⊗ 1) ⊗ vi =     gi,j ⊗ vi
                                i=1                              i=1
where gi,j (u) = p(uη(xi,j )1χ ). So each xi,j is determined by the property that
(8.7)                           p(uη(xi,j )1χ ) = ci,j (u∗ )
for all u ∈ U (m).
                PrTaking u = 1 in (8.7), we see that p(xi,j ·1χ ) = δi,j , as in property
(i). Moreover, i=1 (xi,j · 1χ ⊗ 1) ⊗ vi is a Whittaker vector, which is equivalent to
property (ii). Conversely, one checks that properties (i) and (ii) imply (8.7), hence
they also determine the xi,j ’s uniquely.                    Pr
     Now return to general M . Property (ii) implies that i=1 (xi,j · 1χ ⊗ m) ⊗ vi
belongs to M ⊛ V for any m ∈ M . By functoriality, the image of this element
under the isomorphism χM,V constructed in the first paragraph of the proof must
equal m ⊗ vj . By property (i) this is also its image under the restriction of the map
(Qχ ⊗W (π) M ) ⊗ V → M ⊗ V, (u1χ ⊗ m) ⊗ v 7→ p(u1χ )m ⊗ v. This shows that the
84                               8. CHARACTER FORMULAE


isomorphism χM,V constructed in the proof coincides with the map χM,V from the
statement of the theorem.
     To see that the matrix (xi,j )1≤i,j≤r is invertible, we may assume without loss
of generality that the basis v1 , . . . , vr has the property that xvi ∈ Fv1 + · · · + Fvi−1
for each i = 1, . . . , r and x ∈ m, i.e. ci,j (x) = 0 for i ≥ j. But then, if one replaces
xi,j by δi,j for all i ≥ j, the new elements still satisfy (8.7). Hence by uniqueness
we must already have that xi,j = δi,j for i ≥ j, i.e. the matrix (xi,j )1≤i,j≤r is
unitriangular, so it is invertible.
     Finally suppose (x′i,j )1≤i,j≤r is another matrix satisfying (ii) (primed). Taking
                            Pr
M = W (π) once more, i=1 (x′i,j · 1χ ⊗ 1) ⊗ vi belongs to Wh((Qχ ⊗W (π) M ) ⊗ V ).
Hence, by what we have proved already, there exist elements wi,j ∈ W (π) such that
                 r
                 X                               r
                                                 X
                       (x′i,j · 1χ ⊗ 1) ⊗ vi =           (xi,k · 1χ ⊗ wk,j ) ⊗ vi .
                 i=1                             i,k=1
                                        Pr
Equating coefficients gives that x′i,j = k=1 xi,k wk,j . With a final application of
the right W (π)-module homomorphism p using (i), we get that wi,j = p(x′i,j · 1χ ),
which completes the proof.                                                        
     Now we can prove the following important “tensor identity”.
    Corollary 8.2. For any p-module M and any V as above, the restriction of
the map (Qχ ⊗W (π) M ) ⊗ V → M ⊗ V sending (u · 1χ ⊗ m) ⊗ v 7→ um ⊗ v for each
u ∈ U (p), m ∈ M, v ∈ V defines a natural isomorphism
                                                     ∼
                                µM,V : M ⊛ V −→ M ⊗ V
of W (π)-modules. Here, we are viewing the U (p)-modules M and M ⊗ V on the
left and right
            Prhand sides as W (π)-modules by restriction. The inverse map sends
m ⊗ vk to i,j=1 (xi,j · 1χ ⊗ yj,k m) ⊗ vi , where (xi,j )1≤i,j≤r is the matrix defined
in Theorem 8.1 and (yi,j )1≤i,j≤r is the inverse matrix.
    Proof. Letting U (p) act on Qχ ⊗W (π) M via the dot action, the given map
(Qχ ⊗W (π) M ) ⊗ V → M ⊗ V is a p-module homomorphism. Hence its restriction
µM,V is a W (π)-module homomorphism. To prove that µM,V is an isomorphism,
note by Theorem 8.1 that there is a well-defined map
                                           X r
           M ⊗ V → M ⊛ V, m ⊗ vk 7→            (xi,j · 1χ ⊗ yj,k m) ⊗ vi .
                                                    i,j=1

This is a two-sided inverse to χM,V .                                                    
    Let us make some comments about associativity of ⊛. Suppose that we are
given another finite dimensional g-module V ′ . For any W (π)-module M , Skryabin’s
equivalence gives an isomorphism
                                                             ∼
     (Qχ ⊗W (π) Wh((Qχ ⊗W (π) M ) ⊗ V )) ⊗ V ′ −→ ((Qχ ⊗W (π) M ) ⊗ V ) ⊗ V ′ ,
                                      u′ 1χ ⊗ x ⊗ v ′ 7→ u′ x ⊗ v ′
for u′ ∈ U (g), x ∈ Wh((Qχ ⊗W (π) M ) ⊗ V ) and v ′ ∈ V ′ . So, in view of the natural
associativity isomorphism at the level of g-modules, we conclude that the restriction
                               8.3. TRANSLATION FUNCTORS                                      85


of the linear map
         (Qχ ⊗W (π) ((Qχ ⊗W (π) M ) ⊗ V )) ⊗ V ′ → (Qχ ⊗W (π) M ) ⊗ V ⊗ V ′ ,
                   (u′ 1χ ⊗ ((u1χ ⊗ m) ⊗ v)) ⊗ v ′ 7→ (u′ ((u1χ ⊗ m) ⊗ v)) ⊗ v ′
defines a natural isomorphism
(8.8)                   aM,V,V ′ : (M ⊛ V ) ⊛ V ′ → M ⊛ (V ⊗ V ′ )
of W (π)-modules. If M is actually a p-module, it is straightforward to check that
the following diagram commutes:
                                             aM,V,V ′
                        (M ⊛ V ) ⊛ V ′ −−−−−→ M ⊛ (V ⊗ V ′ )
                                                  
                                 
                     µM,V ⊛idV ′ y
                                                   µM,V ⊗V ′
(8.9)                                              y
                         (M ⊗ V ) ⊛ V ′ −−−−−−→ M ⊗ V ⊗ V ′ .
                                             µM ⊗V,V ′

Also, given a third finite dimensional module V ′′′ , the following diagram commutes:
                                           aM ⊛V,V ′ ,V ′′
              ((M ⊛ V ) ⊛ V ′ ) ⊛ V ′′ −−−−−−−−→ (M ⊛ V ) ⊛ (V ′ ⊗ V ′′ )
                                                         
                             
            aM,V,V ′ ⊛idV ′′ y
                                                          aM,V,V ′ ⊗V ′′
(8.10)                                                    y
              (M ⊛ (V ⊗ V ′ )) ⊛ V ′′ −−−−−−−−→ M ⊛ (V ⊗ V ′ ⊗ V ′′ ).
                                           aM,V ⊗V ′ ,V ′′

Writing F for the trivial g-module, there is for each W (π)-module M a natural
isomorphism iM : M ⊛ F → M mapping (1χ ⊗ m) ⊗ 1 7→ m for each m ∈ M . There
are also some commutative triangles arising from the compatibility of i with a and
with µ, but they are quite obvious so we omit them.
    Finally, we translate the canonical adjunction between the functors ? ⊗ V and
? ⊗ V ∗ into an adjunction between ? ⊛ V and ? ⊛ V ∗ , where V ∗ here denotes the
usual dual g-module. Let v 1 , . . . , v r be the basis for V ∗ dual to the basis v1 , . . . , vr
for V . Then the unit of the canonical adjunction is the map ι : Id → (? ⊛ V ) ⊛ V ∗
defined on a W (π)-module M to be the composite
                  i−1                                          a−1
                                                                M,V,V ∗
(8.11)         M
           M −−−−→ M ⊛ F −−−−→ M ⊛ (V ⊗ V ∗ ) −−−−−→ (M ⊛ V ) ⊛ V ∗ ,
                                         Pr
where the second map is (1χ ⊗ m) ⊗ 1 7→ i=1 (1χ ⊗ m) ⊗ vi ⊗ v i . The counit of the
canonical adjunction is the map ε : (? ⊛ V ∗ ) ⊛ V → Id defined on a W (π)-module
M to be the composite
                               aM,V ∗ ,V                                         i
(8.12)     (M ⊛ V ∗ ) ⊛ V −−−−−−→ M ⊛ (V ∗ ⊗ V ) −−−−→ M ⊛ F −−−
                                                               M
                                                                −→ M,
where the second map is the restriction of (u1χ ⊗ m) ⊗ f ⊗ v 7→ (u1χ ⊗ m) ⊗ f (v).

                               8.3. Translation functors
    In this section we extend the definition of the translation functors ei , fi from
§4.4 to the category M0 (π) from §7.5. Throughout the section, we let V denote the
natural N -dimensional g-module of column vectors, with standard basis v1 , . . . , vN .
We first define an endomorphism
(8.13)                                 x :? ⊛ V →? ⊛ V
86                            8. CHARACTER FORMULAE


of the functor ? ⊛ V : W (π) -mod → W (π) -mod. On a W (π)-module M , xM is the
endomorphism of M ⊛ V = Wh((Qχ ⊗W (π) M ) ⊗ V ) defined by left multiplication
          PN
by Ω =      i,j=1 ei,j ⊗ ej,i ∈ U (g) ⊗ U (g). Here, we are treating the g-module
Qχ ⊗W (π) M as the first tensor position and V as the second, so Ω((u1χ ⊗ m) ⊗ v)
        PN
means i,j=1 (ei,j u1χ ⊗ m) ⊗ ej,i v. Next, we define an endomorphism
(8.14)                     s : (? ⊛ V ) ⊛ V → (? ⊛ V ) ⊛ V
of the functor (? ⊛ V ) ⊛ V : W (π) -mod → W (π) -mod. Recalling (8.8), we take
sM : (M ⊛ V ) ⊛ V → (M ⊛ V ) ⊛ V to be the composite a−1    M,V,V ◦ s
                                                                    bM ◦ aM,V,V , where
sbM is the endomorphism of M ⊛ (V ⊗ V ) = Wh((Qχ ⊗W (π) M ) ⊗ V ⊗ V ) defined by
left multiplication by Ω[2,3] , i.e. Ω acting on the second and third tensor positions
                                        PN
so Ω[2,3] ((u1χ ⊗ m) ⊗ v ⊗ v ′ ) means i,j=1 (u1χ ⊗ m) ⊗ ei,j v ⊗ ej,i v ′ (which equals
(u1χ ⊗ m) ⊗ v ′ ⊗ v). Actually these definitions are just the natural translations
through Skryabin’s equivalence of categories of the endomorphisms x and s from
§4.4 of the functors ? ⊗ V and ? ⊗ V ⊗ V .
     More generally, suppose that we are given d ≥ 1, and introduce the following
endomorphisms of the dth power (? ⊛ V )d : for 1 ≤ i ≤ d and 1 ≤ j < d, let
(8.15)       xi := (1?⊛V )d−i x(1?⊛V )i−1 ,          sj := (1?⊛V )d−j−1 s(1?⊛V )j−1 .
There is an easier description of these endomorphisms. To formulate this, we exploit
the natural isomorphism
                                                ∼
(8.16)                        ad : (? ⊛ V )d −→? ⊛ V ⊗d
obtained by iterating the associativity isomorphism from (8.8). For 1 ≤ i ≤ d and
               bi and sbj denote the endomorphisms of the functor ? ⊛ V ⊗d defined
1 ≤ j < d, let x
                                         P
by left multiplication by the elements ih=1 Ω[h,i+1] and Ω[j+1,j+2] , respectively,
notation as above. Then we have that
(8.17)                xi = a−1
                            d ◦x
                               bi ◦ ad ,         sj = a−1
                                                       d ◦s
                                                          bj ◦ ad .
Using this alternate description, the following identities are straightforward to
check:
(8.18)                     xi xj = xj xi ,
(8.19)                      si xi = xi+1 si − 1,
(8.20)                     si xj = xj si              if j 6= i, i + 1,
(8.21)                        s2i   = 1,
(8.22)                      si sj = sj si             if |i − j| > 1,
(8.23)                 si si+1 si = si+1 si si+1 .
These are the defining relations of the degenerate affine Hecke algebra Hd .
    Let us next bring the adjoint functor ? ⊛ V ∗ into the picture, where V ∗ is the
dual g-module.
  Lemma 8.3. The functors ? ⊛ V and ? ⊛ V ∗ map objects in M(π) to objects in
M(π). Moreover, for A ∈ Row(π), we have that
                          P
    (i) ch(M (A) ⊛ V ) = N  i=1 ch M (Bi ) where Bi is the row equivalence class of
        the tableau obtained by adding 1 to the ith entry of a fixed representative
        for A;
                              8.3. TRANSLATION FUNCTORS                               87

                              PN
     (ii) ch(M (A) ⊛ V ∗ ) = i=1 ch M (Bi ) where Bi is the row equivalence class
          of the tableau obtained by subtracting 1 from the ith entry of a fixed rep-
          resentative for A.
     Proof. We just prove the statements about ? ⊛ V , since the ones for ? ⊛ V ∗
are similar. Recall from Corollary 6.3 and Theorem 5.10 that M (A) has all the
same composition factors as M (A1 ) ⊠ · · · ⊠ M (Al ), where A1 ⊗ · · · ⊗ Al is some
representative for A. To prove that ?⊛V sends objects in M(π) to objects in M(π),
it suffices by exactness of the functor to check that (M (A1 ) ⊠ · · · ⊠ M (Al )) ⊛ V
belongs to M(π). Since M (A1 ) ⊠ · · · ⊠ M (Al ) is the restriction of a p-module M ,
Corollary 8.2 implies that M ⊛ V ∼      = M ⊗ V as W (π)-modules. Now observe that V
has a filtration as a p-module with factors V1 , . . . , Vl being the natural modules of
the components glq1 , . . . , qlql of h, respectively. Hence M ⊗ V has a filtration with
factors M ⊗ Vi . Now apply Lemma 4.3 to each of these factors in turn, to deduce
that M ⊛ V has a filtration with factors isomorphic to
           M (A1 ) ⊠ · · · ⊠ M (Ai−1 ) ⊠ M (Bi ) ⊠ M (Ai+1 ) ⊠ · · · ⊠ M (Al ),
one for each i = 1, . . . , l and each Bi obtained from the column tableau Ai by
adding 1 to one of its entries. Hence it belongs to M(π). Taking Gelfand-Tsetlin
characters gives (i) as well.                                                  
     For θ ∈ P∞ , let prθ : M0 (π) → M(π, θ) be the projection functor along the
decomposition (7.12). Explicitly, for a module M ∈ M0 (π), we have that prθ (M )
is the summand of M defined by (6.11), or prθ (M ) = 0 if the coefficients of θ are
not non-negative integers summing to N . In view of Lemma 8.3, it makes sense to
define exact functors ei , fi : M0 (π) → M0 (π) by setting
                               M
(8.24)                ei :=        prθ+(εi −εi+1 ) ◦ (? ⊛ V ∗ ) ◦ prθ ,
                              θ∈P∞
                              M
(8.25)                fi :=          prθ−(εi −εi+1 ) ◦ (? ⊛ V ) ◦ prθ .
                              θ∈P∞

Note ei is right adjoint to fi , indeed, the canonical adjunction between ? ⊛ V
and ? ⊛ V ∗ from (8.11)–(8.12) induces a canonical adjunction between fi and ei .
Similarly, ei is also left adjoint to fi . Moreover, applying Lemma 8.3 and taking
blocks, we see for A ∈ Row0 (π) and i ∈ Z that
                                             X
(8.26)                          [ei M (A)] =    [M (B)]
                                                  B
summing over all B obtained from A by replacing an entry equal to (i + 1) by an
i, and
                                         X
(8.27)                      [fi M (A)] =   [M (B)]
                                                  B
summing over all B obtained from A by replacing an entry equal to i by an (i +
1); cf. (4.32)–(4.33). Hence if we identify the Grothendieck group [M0 (π)] with
the UZ -module S π (VZ ) via the isomorphism (7.13), the maps on the Grothendieck
group induced by the exact functors ei , fi coincide with the action of ei , fi ∈ UZ .
Moreover, for any M ∈ M0 (π), we have that
                             M                           M
(8.28)            M ⊛V =         fi M,        M ⊛V∗ =        ei M.
                              i∈Z                                 i∈Z
88                                  8. CHARACTER FORMULAE


    Lemma 8.4. For M ∈ M0 (π), fi M coincides with the generalized i-eigenspace
of xM ∈ EndW (π) (M ⊛ V ).
    Proof. It suffices to check this on a generalized Verma module M (A) for
A ∈ Row0 (π). Say the entries of A in some order are a1 , . . . , aN and let B be
obtained from A by replacing the entry at by at + 1, for some 1 ≤ t ≤ N . Recall
the elements
                       XN
                 (1)
               ZN =       (ei,i − N + i),
                              i=1
                    (2)
                              X
                   ZN     =         ((ei,i − N + i)(ej,j − N + j) − ei,j ej,i )
                              i<j

of Z(U (g)) from (3.36). For any g-module M , the operator Ω acts on M ⊗ V in the
               (2)        (1)          (2)                            (1)
same way as ZN ⊗ 1 + ZN ⊗ 1 − ∆(ZN ). Also by Lemma 6.13, ψ(ZN ) acts on
          PN                (2)       P
M (A) as r=1 ar and ψ(ZN ) acts as r<s ar as . It follows that xM(A) stabilizes
any W (π)-submodule of M (A) ⊛ V , and it acts on any irreducible subquotient
having the same central character as L(B) by scalar multiplication by
                          X               N
                                          X            X
                   at =         ar as +         ar −         (ar + δr,t )(as + δs,t ).
                          r<s             r=1          r<s
                   L
Since M (A) ⊛ V = i∈Z fi M (A) and all irreducible subquotients of fi M (A) have
the same central character as L(B) for some B obtained from A by replacing an
entry i by an (i + 1), this identifies fi M (A) as the generalized i-eigenspace of
xM(A) .                                                                         
    As in [CR, §7.4], this lemma together with the relations (8.18)–(8.23) imply
that the endomorphisms x and s restrict to well-defined endomorphisms also de-
noted x and s of the functors fi and fi2 , respectively. Moreover, the identities (4.35)–
(4.37) also hold in this setting. This means that the category M0 (π) equipped
with the adjoint pair of functors (fi , ei ) and the endomorphisms x ∈ End(fi ) and
s ∈ End(fi2 ) is an sl2 -categorification in the sense of [CR], for all i ∈ Z. So we
can appeal to all the general results developed in [CR] in our study of the category
M0 (π).
     Theorem 8.5. Let A ∈ Row0 (π) and i ∈ Z.
       (i) Define ε′i (A) to be the maximal integer k ≥ 0 such that (ei )k L(A) 6= 0.
           Assuming ε′i (A) > 0, ei L(A) has irreducible socle and cosocle isomorphic
           to L(ẽ′i (A)) for some ẽ′i (A) ∈ Row0 (π) with ε′i (ẽ′i (A)) = ε′i (A) − 1. The
           multiplicity of L(ẽ′i (A)) as a composition factor of ei L(A) is equal to ε′i (A),
           and all other composition factors are of the form L(B) for B ∈ Row0 (π)
           with ε′i (B) < ε′i (A) − 1.
      (ii) Define ϕ′i (A) to be the maximal integer k ≥ 0 such that (fi )k L(A) 6= 0. As-
           suming ϕ′i (A) > 0, fi L(A) has irreducible socle and cosocle isomorphic to
           L(f˜i′ (A)) for some f˜i′ (A) ∈ Row0 (π) with ϕ′i (f˜i′ (A)) = ϕ′i (A)−1. The mul-
           tiplicity of L(f˜i′ (A)) as a composition factor of fi L(A) is equal to ϕ′i (A),
           and all other composition factors are of the form L(B) for B ∈ Row0 (π)
           with ϕ′i (B) < ϕ′i (A) − 1.
                      8.4. TRANSLATION COMMUTES WITH DUALITY                                 89


    Proof. This follows from [CR, Lemma 4.3] and [CR, Proposition 5.23], as in
the first paragraph of the proof of Theorem 4.4.                            
     Remark 8.6. This theorem gives a representation theoretic definition of a
crystal structure (Row0 (π), ẽ′i , f˜i′ , ε′i , ϕ′i , θ) on the set Row0 (π). In §4.3, we gave
a combinatorial definition of another crystal structure (Row0 (π), ẽi , f˜i , εi , ϕi , θ) on
the same underlying set. If Conjecture 7.17 is true, then it follows by (4.22)–(4.23)
(as in the proof of Theorem 4.4) that these two crystal structures are in fact equal,
that is, ε′i (A) = εi (A), ϕ′i (A) = ϕi (A), ẽ′i (A) = ẽi (A) and f˜i′ (A) = f˜i (A) for all
A ∈ Row0 (π).
     Remark 8.7. Even without Conjecture 7.17, one can show using [CR, Lemma
4.3] and [BeK, Theorem 5.37] that the two crystals (Row0 (π), ẽ′i , f˜i′ , ε′i , ϕ′i , θ) and
(Row0 (π), ẽi , f˜i , εi , ϕi , θ) are at least isomorphic. However, there is an identification
problem here: without invoking Conjecture 7.17 we do not know how to prove that
the identity map on the underlying set Row0 (π) is an isomorphism between the two
crystals. An analogous identification problem arises in a number of other situations;
compare for example [BK2] and [BK3].

                     8.4. Translation commutes with duality
    There is a right module analogue of Skryabin’s theorem. To formulate it quickly,
recall Lemma 3.1 and the automorphism η from (3.23). Let
(8.29)                              Qχ := U (g)/Iχ U (g).
We write 1χ for the coset of 1 in Qχ , and define the dot action of u ∈ U (p) on Qχ by
1χ u′ ·u := 1χ u′ η(u). Make the right U (g)-module Qχ into a (W (π), U (g))-bimodule
so that w1χ · u = 1χ · wu for each w ∈ W (π) and u ∈ U (p). Let W(π) denote the
category of all right U (g)-modules on which (x − χ(x)) acts locally nilpotently for
all x ∈ m. For M ∈ W(π), let
(8.30)              Wh(M ) := {v ∈ M | vx = χ(x)v for all x ∈ m},
naturally a right W (π)-module with dot action v · w := vη(w) for v ∈ Wh(M ) and
w ∈ W (π). This defines an equivalence of categories Wh : W(π) → mod-W (π) with
quasi-inverse ? ⊗W (π) Qχ : mod-W (π) → W(π). The quickest way to see this is to
use the antiautomorphism τ from (3.22) to identify the category W(π) with W(π t )
and the category mod-W (π) with W (π t )-mod. When that is done, the functor
Wh : W(π) → mod-W (π) becomes identified with Skryabin’s original equivalence
of categories Wh : W(π t ) → W (π t )-mod from §8.1.
    Given a finite dimensional g-module V as in §8.2, there is also a right module
analogue ? ⊛ V of the functor ? ⊛ V . Here, V denotes the dual vector space V ∗
viewed as a right U (g)-module via (f x)(v) = f (xv) for f ∈ V , v ∈ V and x ∈ g.
Then, by definition, ? ⊛ V : mod-W (π) → mod-W (π) is the functor defined on
objects by
(8.31)                    M ⊛ V := Wh((M ⊗W (π) Qχ ) ⊗ V ).
Moreover, given another finite dimensional g-module V ′ and any right W (π)-module
M , there is an associativity isomorphism
                                                  ′   ∼                ′
(8.32)                aM,V ,V ′ : (M ⊛ V ) ⊛ V −→ M ⊛ (V ⊗ V )
90                                   8. CHARACTER FORMULAE


defined in an analogous way to (8.8). Another way to think about the functor
? ⊛ V is to first identify right W (π)-modules with left W (π t )-modules using the
antiautomorphism τ , then ? ⊛ V : mod-W (π) → mod-W (π) is naturally isomorphic
to the functor ? ⊛ V : W (π t )-mod → W (π t )-mod defined as in §8.1. For an
admissible left W (π)-module M , recall the restricted dual M from (5.2). Assuming
π is left-justified, we are going to prove that ⊛ commutes with duality in the sense
that M ⊛V ∼   = M ⊛ V ; equivalently, M τ ⊛V ∼       = (M ⊛V )τ . Although not proved here,
this is true even without the assumption that π is left-justified; see Remark 8.14.
     For the proof, we say that a (necessarily finite dimensional) g-module V is
dualizable if there is a basis v1 , . . . , vr for V and a pair of mutually inverse matrices
(xi,j )1≤i,j≤r and (yi,j )1≤i,j≤r with entries in U (p) such that
                           r
                           X
       (a) [x, η(xi,j )] +    ci,s (x)η(xs,j ) ∈ U (g)Iχ for all 1 ≤ i, j ≤ r and x ∈ m;
                            s=1
                            r
                            X
      (b) [η(yi,j ), x] +         η(yi,s )cs,j (x) ∈ Iχ U (g) for all 1 ≤ i, j ≤ r and x ∈ m.
                            s=1
Here, ci,j ∈ U (g)∗ is the coefficient function defined by (8.5).
    Lemma 8.8. Suppose that V is dualizable. Let v1 , . . . , vr be any basis for V
and (xi,j )1≤i,j≤r be any invertible matrix with entries in U (p) satisfying property
(a) above. Then the inverse matrix (yi,j )1≤i,j≤r satisfies property (b) above.
    Proof. Since V is dualizable there exists some basis v1′ , . . . , vr′ for V and some
pair of mutually inverse matrices (x′i,j )1≤i,j≤r and (yi,j     ′
                                                                    )1≤i,j≤r satisfying properties
(a) and (b) (primed). Conjugating by an invertible scalar matrix if necessary, we
can assume that v1′ = v1 , . . . , vr′ = vr . The last part of Theorem 8.1 implies that
there
Pr is′ an invertible matrix (wi,j )1≤i,j≤r with entries in W (π) such                 Prthat xi,j′ =
  k=1  xi,k w k,j . Let (vi,j )1≤i,j≤r   be the inverse  matrix.      Then   y i,j =    k=1 vi,k yk,j .
                                                              ′
Using Lemma 3.1 together with property (b) for yk,j               , we get for x ∈ m that
                     r                       r                           r
                                                                                                !
                    X                       X                          X
                                                          ′                         ′
   [η(yi,j ), x] +      η(yi,s )cs,j (x) =       [η(vi,k yk,j ), x] +      η(vi,k yk,s )cs,j (x)
                   s=1                       k=1                          s=1
                                              r                                   r
                                                                                                       !
                                             X                                    X
                                                                  ′                        ′
                                         ≡         η(vi,k )   [η(yk,j ), x]   +         η(yk,s )cs,j (x)
                                             k=1                                  s=1
                                         ≡ 0 (mod Iχ U (g)).
Hence (yi,j )1≤i,j≤r satisfies property (b).                                                               
    Lemma 8.9. For any right W (π)-module M and any dualizable g-module V ,
there is a natural vector space isomorphism
                                     χM,V : M ⊛ V → M ⊗ V
determined uniquely by the following property. Let v1 , . . . , vr be any basis for V ,
let v 1 , . . . , v r be the dual basis for V , let (xi,j )1≤i,j≤r be the matrix P
                                                                                 defined in
                                                                                   r
Theorem 8.1 and let (yi,j )1≤i,j≤r be the inverse matrix. Then χM,V maps j=1 (m⊗
1χ · yi,j ) ⊗ v j to m ⊗ v i , for each m ∈ M and 1 ≤ i ≤ r.
     Proof. By Lemma 8.8, the elements yi,j satisfy property (b). Therefore, twist-
ing the conclusion of Theorem
                            P8.1 (with π replaced by π t ) by the antiautomorphism
                              r
τ , we deduce that the map j=1 (m ⊗ 1χ · yi,j ) ⊗ v j 7→ m ⊗ v i is a vector space
                      8.4. TRANSLATION COMMUTES WITH DUALITY                                         91


isomorphism χM,V : M ⊛ V → M ⊗ V . Moreover, this definition is independent
of the initial choice of basis. It remains to check naturality. Clearly it is natural
in M . To see that it is natural in V , let V ′ be another dualizable g-module and
                                                        ′
f : V → V ′ be a g-module homomorphism. Let f ∗ : V → V be the dual map. We
need to show that the following diagram commutes:
                                               ′   χM,V ′               ′
                                    M ⊛V           −−−−→ M ⊗ V
                                                          
                                                          
                                idM ⊛f ∗ y                 yidM ⊗f ∗
                                    M ⊛ V −−−−→ M ⊗ V .
                                                   χM,V
                                                                                                ′
Pick a basis      ′          ′        ′
           Ps v1 , . . . ′, vs for ∗V ′ and Plet v ′1 , . . . , v ′s be the dual basis for V . Say
                                                r                          ′
f (vj ) =     i=1 ai,j vi , so f (v i ) =       j=1 ai,j v j . Let (xi,j )1≤i,j≤s be the matrix
defined by applying Theorem 8.1 to the chosen basis of V ′ , and let (yi,j             ′
                                                                                         )      be
                                                                                   Ps 1≤i,j≤s
the inverse matrix. By the naturality in Theorem 8.1, we have that k=1 x′i,k ak,j =
Pr                             Pr                    Ps             ′
   k=1 ai,k xk,j . Hence,         k=1 ai,k yk,j =         k=1 yi,k ak,j . This is exactly what is
needed.                                                                                         
    Theorem 8.10. For any admissible left W (π)-module M and any dualizable
g-module V , there is a natural isomorphism ωM,V : M ⊛ V → M ⊛ V of right
W (π)-modules such that the following diagram commutes
                                                   ωM,V
                                   M ⊛ V −−−−→ M ⊛ V
                                                x
                                  χM ,V 
                                        y
                                                 χ∗
                                                  M,V
                              M ⊗ V −−−−→ M ⊗ V .
Here, the left hand map is the isomorphism from Lemma 8.9, the right hand map
is the dual of the isomorphism from Theorem 8.1, and the bottom map sends f ⊗ g
to the function m ⊗ v 7→ f (m)g(v). Moreover, given another dualizable g-module
V ′ , the following diagram commutes:
                            ′   ωM,V ⊛id   ′                   ′   ωM ⊛V,V ′
          (M ⊛ V ) ⊛ V          −−−−−−−V→ M ⊛ V ⊛ V                −−−−−−→ (M ⊛ V ) ⊛ V ′
                                                                               x
         aM ,V ,V ′ 
                    y
                                                                                a∗
                                                                                 M,V,V ′
                        ′                                      ′
         M ⊛ (V ⊗ V )                          M ⊛V ⊗V             −−−−−−→ M ⊛ (V ⊗ V ′ )
                                                                   ωM,V ⊗V ′

where aM,V ,V ′ is the map from (8.32) and                  a∗M,V,V ′       is the dual of the map from
(8.8).
      Proof. Define ωM,V : M ⊛ V → M ⊛ V so that the given diagram commutes.
The resulting map is natural in both M and V , since the other three maps in the
diagram are. We need to check that it is a right W (π)-module homomorphism. Fix
a basis v1 , . . . , vr for V and define a matrix (xi,j )1≤i,j≤r as in Theorem 8.1. Let
(yi,j )1≤i,j≤r be the inverse matrix. Let
(8.33)                             δ : U (p) → U (p) ⊗ EndF (V )
be the composite (idU(p) ⊗ρ) ◦ ∆ where ∆ : U (p) → U (p) ⊗ U (p) is the comultipli-
cation and ρ : U (p) → EndF (V ) is the representation of p on V . Take w ∈ W (π)
92                             8. CHARACTER FORMULAE

               P       ′
and let δ(w) = i,j wi,j   ⊗ ei,j . For any left W (π)-module M and any m ∈ M , we
have that
            r
                                    !      r
           X                             X
                                                ′
      w·      (xi,j · 1χ ⊗ m) ⊗ vi =          (wi,k xk,j · 1χ ⊗ m) ⊗ vi ∈ M ⊛ V.
            i=1                           i,k=1
                                                           Pr
In the special case M = W (π) and m = 1, this must equal i,k=1 xi,k ·1χ ⊗wk,j ⊗vi
                                    Pr             Pr         ′
for elements wk,j ∈ W (π), with k=1 xi,k wk,j = h,k=1 wi,k       xk,j . Hence in the
general case too, we have that
                   r
                                         !  r
                 X                          X
           w·        (xi,j · 1χ ⊗ m) ⊗ vi =    (xi,k · 1χ ⊗ wk,j m) ⊗ vi .
                  i=1                             i,k=1

Using this formula we can now lift the dot action of W (π) on M ⊛ V directly to
the vector space M ⊗ V via the isomorphism χM,V , to make M ⊗ V itself into a
left W (π)-module with action defined by
                                        Xr
(8.34)                     w(m ⊗ vj ) =    wi,j m ⊗ vi
                                             i=1
                                                                     Pr
where the elements wi,j ∈ W (π) are defined from δ(w) = h,k=1 xi,h wh,j yh,j ⊗ ei,j .
Instead, let v 1 , . . . , v r be the dual basis for V . By a similar argument to the above,
we lift the dot action of W (π) on M ⊛ V to the vector space M ⊗ V via the
isomorphism χM,V . This makes M ⊗ V into a right W (π)-module with action
defined by
                                                  Xr
(8.35)                              (f ⊗ v i )w =     f wi,j ⊗ v j .
                                             j=1

Under these identifications, the statement that ωM,V is a module homomorphism
is equivalent to saying that the natural map M ⊗ V → M ⊗ V is a module homo-
morphism, which is easily checked given (8.34)–(8.35).
     The commutativity of the final diagram is checked by a direct calculation which
we leave as an exercise; the matrices (8.36)–(8.37) from the proof of Lemma 8.11
below are useful in doing this.                                                   
     We do not yet have any examples of dualizable g-modules.
    Lemma 8.11. Finite direct sums, direct summands, tensor products and duals
of dualizable modules are dualizable.
       Proof. It is obvious that direct sums of dualizable modules are dualizable.
       Consider direct summands. Let V be dualizable and suppose that V = V ′ ⊕ V ′′
as a g-module. Let v1 , . . . , vs be a basis for V ′ and vs+1 , . . . , vr be a basis for
V ′′ . Let (xi,j )1≤i,j≤r be the matrix obtained by applying Theorem 8.1 to the basis
v1 , . . . , vr for V . By Lemma 8.8 and the assumption that V is dualizable, the inverse
matrix (yi,j )1≤i,j≤r satisfies property (b) above. Note also that ci,j = cj,i = 0 if
1 ≤ i ≤ s < j ≤ r. Using this and the uniqueness in Theorem 8.1, we deduce that
xi,j = xj,i = 0 if 1 ≤ i ≤ s < j ≤ r too. Hence, (yi,j )1≤i,j≤s is the inverse of
the matrix (xi,j )1≤i,j≤s . Since the matrices (xi,j )1≤i,j≤r and (yi,j )1≤i,j≤r satisfy
properties (a) and (b), the submatrices (xi,j )1≤i,j≤s and (yi,j )1≤i,j≤s do to. Hence
V ′ is dualizable.
                        8.4. TRANSLATION COMMUTES WITH DUALITY                                          93


      Next consider tensor products. Let V and V ′ be dualizable, with bases v1 , . . . , vr
and v1′ , . . . , vs′ , respectively. Let v 1 , . . . , v r and v ′1 , . . . , v ′s be the dual bases for V
        ′
and V , respectively. Write ei,j for the ij-matrix unit in EndF (V ) = EndF (V )op and
                                                                    ′                    Pr
e′p,q for the pq-matrix unit in EndF (V ′ ) = EndF (V )op . Let x = i,j=1 xi,j ⊗ ei,j ∈
U (p) ⊗ EndF (V ) be the P          matrix obtained by applying Theorem 8.1 to the given
basis for V and let y = ri,j=1 yi,j ⊗ ei,j be the inverse matrix. Similarly, define
       Ps
x′ = p,q=1 x′p,q ⊗ e′p,q by applying Theorem 8.1 to the given basis for V ′ and let
        Ps
y ′ = p,q=1 yp,q       ′
                           ⊗ e′p,q be the inverse. Let δ : U (p) → U (p) ⊗ EndF (V ) be the
map (8.33) from the proof of Theorem 8.10. Consider the following elements of
U (p) ⊗ EndF (V ) ⊗ EndF (V ′ ):
                      X  r  Xs
(8.36)                            xi,p;j,q ⊗ ei,j ⊗ e′p,q := ((δ ⊗ idEndF (V ′ ) )(x′ ))(x ⊗ 1),
                 i,j=1 p,q=1
                   Xr   X s
(8.37)                          yi,p;j,q ⊗ ei,j ⊗ e′p,q := (y ⊗ 1)((δ ⊗ idEndF (V ′ ) )(y ′ )).
                  i,j=1 p,q=1

Clearly these are mutual inverses. Now let M be any left W (π)-module. Recall the
isomorphisms χM,V and χM⊛V,V ′ from Theorem 8.1 and the associativity isomor-
phism aM,V,V ′ : (M ⊛ V ) ⊛ V ′ → M ⊛ (V ⊗ V ′ ) from (8.8). The image of m ⊗ vj ⊗ vq′
under the composite map
         aM,V,V ′ ◦ χ−1          −1                         ′
                     M⊛V,V ′ ◦ (χM,V ⊗ idV ′ ) : M ⊗ V ⊗ V → M ⊛ (V ⊗ V )
                                                                                  ′

            Pr Ps
is equal to i=1 p=1 xi,p;j,q · 1χ ⊗ m ⊗ vi ⊗ vp′ . As in the proof of Theorem 8.1, the
fact that this is a Whittaker vector implies that the matrix (xi,p;j,q )1≤i,j≤r,1≤p,q≤s
satisfies property (a) with respect to the basis {vi ⊗ vp′ | i = 1, . . . , r, p = 1, . . . , s}
for V ⊗ V ′ . Instead, take any right W (π)-module M . Recalling (8.32) and the
isomorphisms χM,V and χM⊛V ,V ′ from Lemma 8.9, the image of m ⊗ v i ⊗ v ′p under
the map
                                                                         ′                     ′
        aM,V ,V ′ ◦ χ−1
                     M⊛V ,V
                            ′ ◦ (χ
                                   −1
                                   M,V
                                       ⊗ idV ′ ) : M ⊗ V ⊗ V → M ⊛ (V ⊗ V )
            Pr Ps
is equal to j=1 q=1 m ⊗ 1χ · yi,p;j,q ⊗ v j ⊗ v ′q . The fact that this is a Whittaker
vector implies that the matrix (yi,p;j,q )1≤i,j≤r,1≤p,q≤s satisfies property (b). Hence
V ⊗ V ′ is dualizable.
                                                    ∗
     Finally we consider the dual g-module
                                       Vr−1 V , assuming that V is dualizable of
                             ∗ ∼
dimension r. Note that V = D ⊗               (V ) where D is a one-dimensional repre-
                                                                               Vr−1
sentation. Since V ⊗(r−1) is dualizable by the preceeding paragraph, and            (V )
                                       Vr−1
is a summand of it, it follows that          (V ) is dualizable. It is obvious that any
one dimensional representation is dualizable. Hence V ∗ is too.                       
     Lemma 8.12. If π is left-justified, the natural g-module V is dualizable.
     Proof. Let v1 , . . . , vN be the standard basis for V . We are going to write
down mutually inverse matrices (xi,j )1≤i,j≤N and (yi,j )1≤i,j≤N and verify that they
satisfy properties (a) and (b) by brute force. Since π is left-justified, we can take
k = 0 in (3.1). All other notation throughout the proof is as in §3.7.
     For 1 ≤ i, j ≤ N , define
                                                                 (col(i)−col(j))
(8.38)                 xi,j := (−1)col(i)−col(j) Icol(i)−1 (Trow(j),row(i) ),
94                                     8. CHARACTER FORMULAE


interpreted as δi,j if col(i) ≤ col(j). We claim for all 1 ≤ i, j, r, s ≤ N with
col(s) = col(r) − 1 that
       (i) [er,s , η(xi,j )] + δi,r η(xs,j ) ∈ U (g)Iχ ;
      (ii) [er,s , η(xi,j )] + δi,r η(xs,j ) ∈ Iχ U (g).
We just explain the argument to check (i), since (ii) is entirely similar given
Lemma 3.1. We may as well assume that col(i) > col(j), since it is trivial oth-
erwise. If col(i) < col(r) then [er,s , η(xi,j )] = 0 obviously, while if col(i) > col(r)
then [er,s , η(xi,j )] ∈ U (g)Iχ , as xi,j belongs to W (πcol(i)−1 ). So assume that
col(j) < col(i) = col(r). In that case, we expand η(xi,j ) using Lemma 3.4 (with
l = col(i) − 1) then commute with er,s . Almost all the resulting terms are zero.
The only term that possibly contributes comes from the third term on the right
hand side of Lemma 3.4 when q1 + · · · + qcol(i)−1 + h − n = s, from which we get
exactly −δi,r η(xs,j ) modulo U (g)Iχ , as required.
     Since m is generated by the elements er,s with col(s) = col(r) − 1, formula (i)
is all that is needed to verify that the matrix (xi,j )1≤i,j≤N satisfies property (a).
The inverse matrix (yi,j )1≤i,j≤N is given explicitly by
                               col(i)−col(j)
                                    X            X
(8.39)               yi,j =                                 (−1)t xi0 ,i1 xi1 ,i2 · · · xit−1 ,it ,
                                    t=0        i0 ,...,it

where the summation is over all 1 ≤ i0 , . . . , it ≤ N such that i0 = i, it = j and
col(i0 ) > · · · > col(it ). It just remains to check that this matrix satisfies property
(b). For this, it is enough to show that [η(yi,j ), er,s ] + η(yi,r )δs,j ∈ Iχ U (g) when
col(s) = col(r) − 1. Using formula (ii), we get for i0 , . . . , it as in (8.39) that
         [η(xi0 ,i1 xi1 ,i2 · · · xit−1 ,it ), er,s ] ≡ η(xi0 ,i1 · · · xih−1 ,r xs,ih+1 · · · xit−1 ,it )
modulo Iχ U (g) if ih = r for some h = 0, . . . , t−1, and it is congruent to 0 otherwise.
Now a calculation using this and (8.39) completes the proof.                            
     Theorem 8.13. If π is left-justified, every finite dimensional g-module is du-
alizable.
    Proof. It is easy to see that any finite dimensional g-module on which g′ = slN
acts trivially is dualizable. Every finite dimensional g-module is a direct sum of
summands of tensor products of such modules and copies of the natural module.
Hence every finite dimensional g-module is dualizable by Lemmas 8.11 and 8.12. 
    Remark 8.14. In fact Theorem 8.13 is true for an arbitrary pyramid. The only
way we have found to see this is by reducing the general case to the left-justified
case treated above. In order to do this, the key point is that the functor arising
from twisting with ι commutes with the bifunctor ?⊛?. This can be proved by an
argument in the spirit of [GG, BGo], using the invariant definition of ι mentioned
briefly in §3.5.
    Finally, we return to the natural g-module V and check one more technical
fact which will allow us to descend from the functor ? ⊛ V to the translation
functors ei , fi as defined §8.3. To formulate this, we need the endomorphism x
of the functor ? ⊛ V that is the right module analogue of (8.13). So, for a right
W (π)-module M , xM : M ⊛ V → M ⊛ V is the map induced by right multiplication
        PN
by Ω = i,j=1 ei,j ⊗ ej,i .
                                   8.5. WHITTAKER FUNCTOR                                                    95


     Lemma 8.15. Assume that the natural g-module V is dualizable (which is true
e.g. if π is left-justified). Then, for any admissible left W (π)-module M , the
following diagram commutes:
                                                ωM,V
                                   M ⊛ V −−−−→ M ⊛ V
                                                
                                   xM 
                                      y
                                                  x∗
                                                 y M
                                   M ⊛ V −−−−→ M ⊛ V ,
                                                ωM,V

where ωM,V is as in Theorem 8.10 and x∗M denotes the dual map to xM .
    Proof. Letting (xi,j )1≤i,j≤N be the matrix from Theorem 8.1 and (yi,j )1≤i,j≤N
be its inverse as usual, we have for any m ∈ M that
      N
                             !    N
     X                           X
Ω        (xi,j · 1χ ⊗ m) ⊗ vi =      (ei,k η(xi,j )1χ ⊗ m) ⊗ vk
    i=1                                i,k=1
                                           X
                                   =                   (ei,k η(xi,j )1χ ⊗ m) ⊗ vk
                                       col(i)≤col(k)
                                                 X
                                         +                   ((η(xi,j )ei,k − η(xk,j ))1χ ⊗ m) ⊗ vk .
                                             col(i)>col(k)

Considering the special case M = W (π) first then using naturality, this must equal
PN
  i,k=1 xk,i · 1χ ⊗ wj,i m ⊗ vk for some elements wj,i ∈ W (π). Equating coefficients,
we get that
                    X                                                  N
                                                                       X
(8.40) wj,i =                   (−1)col(k)−col(h) yi,k eh,k xh,j +           (qcol(k) − n)yi,k xk,j
                col(h)≤col(k)                                          k=1
                                                                                  X
                                                                        +                      yi,h xk,j .
                                                                             row(h)=row(k)
                                                                            col(h)=col(k)−1

Now we can lift the endomorphism of M ⊛V to an endomorphism of the vector space
M ⊗ V through the isomorphism χM,V . We obtain the endomorphism of M ⊗ V
                                          PN
defined simply by left multiplication by     i,j=1 wj,i ⊗ ei,j ∈ W (π) ⊗ EndF (V ).
With an entirely similar calculation, we lift the endomorphism of M ⊛ V to an
endomorphism of the vector space M ⊗ V through the isomorphism χM ,V . We
obtain the endomorphism of M ⊗ V defined by right multiplication by the same
         PN                                      op
element    i,j=1 wj,i ⊗ ei,j ∈ W (π) ⊗ EndF (V ) . Using these descriptions, the
desired commutativity of the diagram is now easy to check.                       

                                  8.5. Whittaker functor
                                                                                         (1)            (1)
    Recall that c denotes the Lie subalgebra of W (π) spanned by D1 , . . . , Dn .
We point out that as elements of U (g), we have simply that
                                 (1)
                                         X
(8.41)                         Di =           ej,j
                                                  1≤j≤N
                                                 row(j)=i

for each i = 1, . . . , n. Hence, c is a subalgebra of the standard Cartan subalgebra d
of g, indeed, c is the centralizer of e in d.
96                            8. CHARACTER FORMULAE


     Let MLbe a g-module which is the direct sum of its generalized c-weight spaces,
i.e. M = α∈c∗ Mα . We do not assume that each Mα is finite dimensional. Set
(8.42)                            V(M ) := Wh(M ),
                                       L
where M denotes the restricted dual α∈c∗ Mα∗ as in (5.2) viewed as a right U (g)-
module with action (f u)(v) := f (uv), Wh(M ) denotes the right W (π)-module
obtained by applying the functor Wh from (8.30), and finally Wh(M ) denotes the
left W (π)-module obtained by taking the restricted dual one more time. There is an
obvious definition on morphisms, making V into a (covariant) right exact functor.
     For the first lemma, recall the automorphism η : U (p) → U (p) from (3.23).
                                                          L
     Lemma 8.16. Let M be a p-module such that M = α∈c∗ Mα and each Mα
is finite dimensional. Then there is a natural W (π)-module isomorphism between
V(U (g) ⊗U(p) M ) and the W (π)-module equal to M as a vector space with action
defined by u ◦ v := η(u)v for u ∈ W (π), v ∈ M .
   Proof. Let I := U (g) ⊗U(p) M . Note that I = U (m) ⊗ M as a left U (m)-
module. So for α ∈ c∗ , the generalized α-weight space of I is
                                  M
                             Iα =      U (m)β ⊗ Mα−β ,
                                   β∈c∗

where U (m)β is the β-weight space of U (m) with respect to the adjoint action of c.
By definition,
     Wh(I) = {f ∈ Homm (I, Fχ ) | f (Iα ) = 0 for all but finitely many α ∈ c∗ }.
                                                              ∼
The restriction of the obvious isomorphism Homm (I, Fχ ) → M ∗ to the subspace
Wh(I) gives an injective linear map ϕ : Wh(I) ֒→ M . We claim that ϕ is also
surjective, hence an isomorphism. To see this, take any f ∈ M . Its inverse image
in Homm (I, Fχ ) is the map fˆ sending u ⊗ m 7→ χ(u)f (m) for each u ∈ U (m) and
m ∈ M . Since χ(u) = 0 if u ∈   / U (m)0 , we get that fˆ vanishes on Iα for all but
finitely many α. Hence fˆ ∈ Wh(I), proving the claim. The dual map to ϕ now
                                                   ∼
gives a natural vector space isomorphism ϕ : M → V(I). It just remains to check
that the W (π)-module structure on V(I) corresponds under this isomorphism to
the circle action of W (π) on M                                                   
     Recall the category O of g-modules from §4.4, and the Verma modules M (α)
for each α ∈ FN from (3.42).
    Lemma 8.17. Take any weight α ∈ FN . Let A be the π-tableau with γ(A) = α.
Let Ai denote the ith column of A. Then
                        V(M (α)) ∼
                                 = M (A1 ) ⊠ · · · ⊠ M (Al ).
Moreover, V maps short exact sequences of g-modules with finite Verma flags to
short exact sequences of W (π)-modules. Hence, V maps objects in O to objects in
M(π).
    Proof. The first statement follows by Lemma 8.16 since M (α) ∼    = U (g)⊗U(p) M
where M is the p-module whose pull-back through the automorphism η is isomor-
phic to M (A1 ) ⊠ · · · ⊠ M (Al ). The second statement follows because all short exact
sequences of g-modules with finite Verma flags are split when viewed as short exact
sequences of m-modules. For the final statement, take any M ∈ O and let P ։ M
                               8.5. WHITTAKER FUNCTOR                                97


be its projective cover in O. Since V is right exact, it suffices to show that V(P )
belongs to M(π). This follows because P has a finite Verma flag, so V(P ) has a
finite filtration with factors of the form M (A1 ) ⊠ · · · ⊠ M (Al ) for A ∈ Tab(π). We
have already observed several times that the latter modules belong to M(π) thanks
to Corollary 6.3.                                                                     
    In view of the lemma, the functor V restricts to a well-defined right exact
functor
(8.43)                             V : O → M(π).
Moreover, V preserves central characters, so it also sends the subcategory O0 of O
consisting of all modules with integral central character to the subcategory M0 (π)
of M(π). For the next lemma, recall from Remark 8.14 that every finite dimensional
g-module is dualizable (though we have only proved that here if π is left-justified).
    Lemma 8.18. For any M ∈ O and any dualizable V , there is a natural isomor-
phism
                                        ∼
                      νM,V : V(M ⊗ V ) −→ V(M ) ⊛ V
of W (π)-modules. Moreover, given another dualizable module V ′ , the following
diagram commutes:
                                         νM ⊗V,V ′
                 V(M ⊗ V ⊗ V ′ )        −−−−−−→          V(M ⊗ V ) ⊛ V ′
                                                             
                 νM,V ⊗V ′ 
                           y
                                                              ν ⊛id ′
                                                              y M,V V
                V(M ) ⊛ (V ⊗ V ′ ) ←−−−−−−−−− (V(M ) ⊛ V ) ⊛ V ′ .
                                        aV(M ),V,V ′
                  ∗
Finally, letting V denote the dual g-module (which is dualizable by Lemma 8.11)
the following diagram commutes:
                                            νM,V ∗
                 V(M ⊗ V ∗ )        −−−−−−−−−−→                V(M ) ⊛ V ∗
                                                                  x
             ιV(M ⊗V ∗ ) 
                         y
                                                                   V(ε )⊛id ∗
                                                                    M      V


          (V(M ⊗ V ∗ ) ⊛ V ) ⊛ V ∗ −−−−−−−−−−→ V(M ⊗ V ∗ ⊗ V ) ⊛ V ∗
                                      −1
                                     νM ⊗V ∗ ,V
                                                ⊛idV ∗

where ι is the unit of the adjunction between ? ⊛ V and ⊛V ∗ from (8.11), and ε is
the counit of the canonical adjunction between ? ⊗ V and ? ⊗ V ∗ .
   Proof. Take a module M ∈ O and a dualizable g-module V . Set N :=
V(M ) = Wh(M ). Theorem 8.10 gives us a natural isomorphism
                                                  ∼
                               ωN,V : N ⊛ V → N ⊛ V .
By definition, N ⊛ V = Wh((Wh(M ) ⊗W (π) Qχ ) ⊗ V ), so from the canonical
                                 ∼                                      ∼
isomorphism Wh(M ) ⊗W (π) Qχ → M we get induced an isomorphism N ⊛ V →
                                                              ∼
Wh(M ⊗V ). Finally, there is an obvious isomorphism Wh(M ⊗V ) → Wh(M ⊗ V ).
Composing these maps, we have constructed a natural isomorphism
                       −1
                      ωN,V          ∼                      ∼
V(M ) ⊛ V = N ⊛ V −→ N ⊛ V −→ Wh(M ⊗ V ) −→ Wh(M ⊗ V ) = V(M ⊗ V ).
Let νM,V : V(M ⊗ V ) → V(M ) ⊛ V be the dual map. This is a natural isomorphism
of W (π)-modules.
98                                  8. CHARACTER FORMULAE


    Now we consider the commutativity of the two diagrams. The first one is
checked using the commutative diagram from Theorem 8.10. For the second, con-
sider
                     νM ⊗V ∗ ,V                        V(id    ⊗e)        V(i   )
     V(M ⊗ V ∗ ) ⊛ V ←−−−−−−− V(M ⊗ V ∗ ⊗ V ) −−−−M
                                                  −−−→ V(M ⊗ F) − M
                                                                −−−−→ V(M )
                                                                     
          ν                                                          
          y M,V ∗ ⊛idV             yνM,V ∗ ⊗V             yνM,F         

 (V(M ) ⊛ V ∗ ) ⊛ V −−−−−−→ V(M ) ⊛ (V ∗ ⊗ V ) −−−−−−→ V(M ) ⊛ F −
                                                                 −−−−→ V(M ).
                    aV(M ),V ∗ ,V                      idV(M ) ⊛e         iV(M )

             ∗
 Here, e : V ⊗ V → F is evaluation f ⊗ v 7→ f (v), iM : M ⊗ F → M is the multi-
plication m ⊗ c 7→ cm, and iV(M) is as in (8.12). This diagram commutes: the left
hand square commutes thanks to the first diagram just checked, the middle square
commutes by naturality of ν, and the right hand square is easy. The composite
V(M ⊗ V ∗ ⊗ V ) → V(M ) along the top of the diagram is precisely the map V(εM ),
while the composite εV(M) : (V(M ) ⊛ V ∗ ) ⊛ V → V(M ) along the bottom is the
definition of counit of the adjunction from (8.12). Hence, we have shown that the
following diagram commutes:
                                          νM ⊗V ∗ ,V
                   V(M ⊗ V ∗ ⊗ V ) −−−−−−→ V(M ⊗ V ∗ ) ⊛ V
                                                
                           
                     V(εM )y
                                                 ν ∗ ⊛id
                                                 y M,V     V



                          V(M )          ←−−−−−− (V(M ) ⊛ V ∗ ) ⊛ V.
                                            εV(M )

This implies the commutativity of the second diagram; see [CR, Lemma 5.3].              
    Recall the translation functors ei , fi : O0 → O0 from §4.4, and their counter-
parts on the category M0 (π) from §8.3.
      Lemma 8.19. Assume that the natural g-module V is dualizable (which is true
e.g. if π is left-justified). Then the functor V : O0 → M0 (π) commutes with
the translation functors fi , ei for all i ∈ Z, i.e. there are natural isomorphisms
             ∼                         ∼
ν + : V ◦ fi → fi ◦ V and ν − : V ◦ ei → ei ◦ V. In fact, (V, ν + , ν − ) is a morphism of
sl2 -categorifications in the sense of [CR, 5.2.1].
     Proof. Recall the endomorphism x of the functor ?⊗V and the endomorphism
s of the functor (? ⊗ V ) ◦ (? ⊗ V ) from §4.4, and the analogous endomorphisms of
? ⊛ V and (? ⊛ V ) ◦ (? ⊛ V ) from §8.4. We claim that the following diagrams
commute for all M ∈ O:
                                             νM,V
                              V(M ⊗ V ) −−−−→ V(M ) ⊛ V
                                                
                                   
                             V(xM )y
                                                 xV(M )
(8.44)                                           y
                              V(M ⊗ V ) −−−−→ V(M ) ⊛ V,
                                             νM,V

                              νM ⊗V,V                         νM,V ⊛idV
          V(M ⊗ V ⊗ V ) −−−−−→ V(M ⊗ V ) ⊛ V −−−−−−−→ (V(M ) ⊛ V ) ⊛ V
                                                            
                 
           V(sM )y
                                                             sV(M )
(8.45)                                                       y
          V(M ⊗ V ⊗ V ) −−−−−→ V(M ⊗ V ) ⊛ V −−−−−−−→ (V(M ) ⊛ V ) ⊛ V.
                              νM ⊗V,V                         νM,V ⊛idV

The commutativity of the first of these is checked using the definition of νM,V
from the proof of Lemma 8.18, together with Lemma 8.15. The commutativity of
                               8.5. WHITTAKER FUNCTOR                                  99


the second diagram follows immediately from the naturality of the isomorphism
νM,V ⊗V , the commutative diagram from Lemma 8.18 and the definitions of the
maps sM and sV(M) .
     Now let us prove the lemma. Recalling the definitions (8.24)–(8.25), the isomor-
phisms νM,V : V(M ⊗V ) → V(M )⊛V and νM,V ∗ : V(M ⊗V ∗ ) → V(M )⊛V ∗ restrict
                                   +                               −
to give natural isomorphisms νM      : V(fi M ) → fi V(M ) and νM    : V(ei M ) → ei V(M )
for each M ∈ O0 . This defines the natural isomorphisms ν ± . The fact that the
triple (V, ν + , ν − ) is a morphism of sl2 -categorifications follows from (8.44)–(8.45)
together with the final commutative diagram from Lemma 8.18.                            
    In the generality of (8.43), the right exact functor V is usually not exact.
However, by a result of Lynch [Ly, Lemma 4.6] (which Lynch attributes originally
to N. Wallach) V is exact on short exact sequences of g-modules that are finitely
generated over m; see the next lemma. For this reason, we are going to restrict our
attention from now on to the parabolic category O(π) from §4.4 and the category
F (π) of finite dimensional W (π)-modules from §7.5.
    Lemma 8.20. The restriction of the functor V to O(π) defines an exact functor
                                   V : O(π) → F (π).
Moreover, V maps the parabolic Verma module N (A) from (4.38) to the standard
module V (A) from (7.1), for any A ∈ Col(π).
    Proof. The second statement is immediate from Lemma 8.16. For the first
statement, take any M ∈ O(π). Note to start with that M is finitely generated
as a U (m)-module. This follows because the parabolic Verma modules are finitely
generated as U (m)-modules. By definition,
   Wh(M ) = {f ∈ Homm (M, Fχ ) | f (Mα ) = 0 for all but finitely many α ∈ c∗ }.
It is already clear from this that V(M ) is finite dimensional, i.e. it lies in F (π),
because Homm (M, Fχ ) certainly is by the finite generation. We claim that in fact
                              Wh(M ) = Homm (M, Fχ ).
To see this, it suffices to show that any f ∈ Homm (M, Fχ ) vanishes on Mα for all
but finitely many α ∈ c∗ . Pick weights α1 , . . . , αr ∈ c∗ such that M is generated
as a U (m)-module by Mα1 ⊕ · · · ⊕ Mαr . For any α ∈ c∗ , the weight space Mα
is spanned by terms of the form ui mi for ui ∈ U (m)α−αi and mi ∈ Mαi . But
f (ui mi ) = χ(ui )f (mi ) and χ(ui ) = 0 unless α = αi , so we deduce that f (Mα ) = 0
unless α ∈ {α1 , . . . , αr }.
     To complete the proof of the lemma, we now show that Homm (?, Fχ ) is an
exact functor on the category of g-modules that are finitely generated over m. Let
E denote the space of linear maps f : U (m) → F which annihilate (Iχ )p for p ≫ 0,
viewed as an m-module by (xf )(u) = f (ux) for f ∈ E, x ∈ m and u ∈ U (m). By
[Sk, Assertion 2], E is an injective m-module, so the functor Homm (?, E) is exact.
For any g-module M , Homm (M, E) is naturally a right U (g)-module with action
(f u)(v) = f (uv) for f ∈ Homm (M, E), u ∈ U (g) and v ∈ M . Moreover, if M is
finitely generated as a U (m)-module, then Homm (M, E) belongs to the category
W(π). It remains to observe that the m-module Wh(E) can be identified with Fχ ,
so that for any g-module M
             Homm (M, Fχ ) = Homm (M, Wh(E)) = Wh(Homm (M, E)).
100                             8. CHARACTER FORMULAE


Hence, on the category of g-modules that are finitely generated over m, the func-
tor Homm (?, Fχ ) factors as the composite of the exact functor Homm (?, E) and
Skryabin’s equivalence of categories Wh : W(π) → W (π)-mod, so it is exact.    
   For a while now, we will restrict our attention to integral central characters.
By Lemma 8.20, the restriction of V to O0 (π) gives an exact functor
(8.46)                             V : O0 (π) → F0 (π).
Also let I : F0 (π) → M0 (π) be the natural inclusion functor. We use the same
notation V and I for the induced  V maps at the level of Grothendieck groups. Re-
call also the isomorphism i : π (VZ ) → [O0 (π)], NA 7→ [N (A)] from the proof
of Theorem 4.5, and the isomorphisms j : P π (VZ ) → [F0 (π)], VA 7→ [V (A)] and
k : S π (VZ ) → [M0 (π)], MA 7→ [M (A)] from (7.17). We observe that the following
diagram commutes:
                     Vπ           V                I
                          (VZ ) −−−−→ P π (VZ ) −−−−→ S π (VZ )
                                                        
                                        j               
(8.47)                  iy               y                yk
                       [O0 (π)] −−−−→ [F0 (π)] −−−−→ [M0 (π)],
                                    V                  I
where the top V is the map from (4.11) and the top I is the natural inclusion. To
see this, we already checked in (7.17) that the right hand square commutes, and
the fact that V(N (A)) ∼= V (A) from Lemma 8.20 is exactly what is needed to check
that the left hand square does too. Now we are ready to invoke Theorem 4.5, or
rather, to invoke the Kazhdan-Lusztig conjecture, since Theorem 4.5 was a direct
consequence of it. For the statement of the following theorem, recall the definition
of the bijection R : Std0 (π) → Dom0 (π) from (4.2); in the case that π is left-justified
the rectification R(A) of a standard π-tableau A simply means its row equivalence
class.
      Theorem 8.21. For A ∈ Col0 (π), we have that
                             
                                L(R(A)) if A is standard,
                  V(K(A)) ∼=
                                0          otherwise.
     Proof. Note that it suffices to prove the theorem in the special case that π is
left-justified.
    V           Indeed, in view of Theorem 4.5, the properties of the homomorphism
V : π (VZ ) → P π (VZ ) and the commutativity of the left hand square in (8.47), the
theorem follows if we can show that j(LA ) = [L(A)] for every A ∈ Dom0 (π). This
last statement is independent of the particular choice of π, thanks to the existence
of the isomorphism ι. So assume from now on that π is left-justified.
     Using Theorem 4.5 and the commutativity of the left hand square in (8.47)
again, we know already for A ∈ Col0 (π) that V(K(A)) 6= 0 if and only if A ∈
Std0 (π). Let A0 ∈ Col0 (π) be the ground-state tableau, with all entries on row i
equal to (1 − i). Since the crystal (Std0 (π), ẽi , f˜i , εi , ϕi , θ) is connected, it makes
sense to define the height of A ∈ Std0 (π) to be the minimal number of applications
of the operators f˜i , ẽi (i ∈ Z) needed to map A to A0 . We proceed to prove that
V(K(A)) ∼   = L(R(A)) for A ∈ Std0 (π) by induction on height. For the base case,
observe that no other elements of Col0 (π) have the same content as A0 , hence
N (A0 ) = K(A0 ). Similarly, V (R(A0 )) = L(R(A0 )). Hence by Lemma 8.20, we
have that V(K(A0 )) ∼   = L(R(A0 )).
                               8.5. WHITTAKER FUNCTOR                                 101


     Now for the induction step, take B ∈ Std0 (π) of height > 0. We can write B
as either f˜i (A) or as ẽi (A), where A ∈ Std0 (π) is of strictly smaller height. We will
assume that the first case holds, i.e. that B = f˜i (A), since the argument in the
second case is entirely similar. By the induction hypothesis, we know already that
V(K(A)) ∼  = L(R(A)). We need to show that V(K(B)) ∼          = L(R(B)).
     Note by Lemma 8.20 that V(N (B)) ∼      = V (B), and by exactness of the functor
V, we know that V(K(B)) is a non-zero quotient of V (B). Since B ∈ Std0 (π),
Theorem 7.13 shows that V (B) is a highest weight module of type R(B). Hence
V(K(B)) is a highest weight module of type R(B) too. Also K(B) is both a quotient
and a submodule of fi K(A) by Theorem 4.5. Hence by Lemma 8.19, V(K(B))
is both a quotient and a submodule of V(fi K(A)) ∼          = fi L(R(A)). In particular,
L(R(B)) is a quotient of fi L(R(A)) and V(K(B)) is a non-zero submodule of it.
     Finally, we know by Theorem 8.5 that the socle and cosocle of fi L(R(A)) are
irreducible and isomorphic to each other. Since we know already that L(R(B))
is a quotient of fi L(R(A)), it follows that the socle of fi L(R(A)) is isomorphic
to L(R(B)). Since V(K(B)) embeds into fi L(R(A)), this means that V(K(B))
has irreducible socle isomorphic to L(R(B)) too. But V(K(B)) is a highest weight
module of type R(B). These too statements together imply that V(K(B)) is indeed
irreducible.                                                                           
    Corollary 8.22. The isomorphism j : P π (VZ ) → [F0 (π)] maps LA to [L(A)]
for each A ∈ Dom0 (π). Hence, for A ∈ Col0 (π) and B ∈ Std0 (π)
                                X
           [V (A) : L(R(B))] =      (−1)ℓ(A,C) Pd(γ(C))w0 ,d(γ(B))w0 (1),
                                  C∼col A

notation as in (4.14).
    Proof. The first statement follows from the theorem and the commutativity
of the diagram (8.47). The second two statement then follows by (4.14).    
    Corollary 8.23. For A ∈ Dom0 (π) and i ∈ Z, the following properties hold.
      (i) If εi (A) = 0 then ei L(A) = 0. Otherwise, ei L(A) is an indecomposable
          module with irreducible socle and cosocle isomorphic to L(ẽi (A)).
     (ii) If ϕi (A) = 0 then fi L(A) = 0. Otherwise, fi L(A) is an indecomposable
          module with irreducible socle and cosocle isomorphic to L(f˜i (A)).
    Proof. Argue using (4.22)–(4.23), Theorem 8.5 and Corollary 8.22, like in the
proof of Theorem 4.4.                                                          
     Since the Gelfand-Tsetlin characters of standard modules are known, one can
now in principle compute the characters of the finite dimensional irreducible W (π)-
modules with integral central character, by inverting the unitriangular square sub-
matrix ([V (A) : L(R(B))])A,B∈Std0 (π) of the decomposition matrix from Corol-
lary 8.22. Using Theorem 7.14 too, one can deduce from this the characters of
arbitrary finite dimensional irreducible W (π)-modules. All the other combinatorial
results just formulated can also be extended to arbitrary central characters in sim-
ilar fashion. We just record here the extension of Theorem 8.21 itself to arbitrary
central characters.
    Corollary 8.24. For A ∈ Col(π), we have that
                           
                         ∼   L(R(A)) if A is standard,
                V(K(A)) =
                             0          otherwise.
102                             8. CHARACTER FORMULAE


Thus, the functor V : O(π) → F (π) sends irreducible modules to irreducible modules
or to zero. Every finite dimensional irreducible W (π)-module arises in this way.
    Proof. This is a consequence of Corollary 8.22, Lemma 8.20, Theorem 7.14
and [BG, Proposition 5.12].                                               
    The final result gives a criterion for the irreducibility of the standard module
V (A), in the spirit of [LNT]. Note as a special case of this corollary, we recover the
main result of [M4] concerning Yangians. Following [LZ, Lemma 3.8], we say that
two sets A = {a1 , . . . , ar } and B = {b1 , . . . , bs } of numbers from F are separated if
     (a) r < s and there do not exist a, c ∈ A − B and b ∈ B − A such that
          a < b < c;
     (b) r = s and there do not exist a, c ∈ A − B and b, d ∈ B − A such that
          a < b < c < d or a > b > c > d;
     (c) r > s and there do not exist c ∈ A − B and b, d ∈ B − A such that
          b > c > d.
Say that a π-tableau A ∈ Col(π) is separated if the sets Ai and Aj of entries in the
ith and jth columns of A, respectively, are separated for each 1 ≤ i < j ≤ l.
     Theorem 8.25. For A ∈ Col(π), the standard module V (A) is irreducible if and
only if A is separated, in which case it is isomorphic to L(B) where B ∈ Dom(π)
is the row equivalence class of A.
     Proof. Using Theorem 7.14, the proof reduces to the special case that A
belongs to Col0 (π). In that case, we apply [LZ, Theorem 1.1] and the main result
of Leclerc, Nazarov and Thibon [LNT, Theorem 31]; see also [Ca]. These references
imply that VA is equal to LB for some B ∈ Dom0 (π) if and only if A is separated.
Actually, the references cited only prove the q-analog of this statement, but it
follows at q = 1 too by the positivity of the structure constants from [B, Remark
24]; see the argument from the proof of [LNT, Proposition 15]. By Theorem 8.21,
this shows that V (A) is irreducible if and only if A is separated. Finally, when this
happens, we must have that V (A) ∼  = L(B) where B is the row equivalence class of
A, since V (A) always contains a highest weight vector of that type.                
                                     Notation

k                        Equivalence relation on Col(π)                                   37
≤
Vπ                       Bruhat
                         Vq1       order onV  Row(π)                                      35
                                               q
       (VZ )                  (VZ ) ⊗ · · · ⊗ l (VZ )                                     38
b                        Upper triangular matrices in g                                   32
                                                        (1)         (1)
c                        Lie algebra spanned by D1 , . . . , Dn                           10
d L                      Diagonal matrices in g                                           32
g = j∈Z gj               Lie algebra glN ; ei,j has degree (col(j) − col(i))              24
h                        Levi subalgebra g0 ∼    =Lglq1 ⊕ · · · ⊕ glql                    24
m                        Nilpotent subalgebra j<0 gj                                      24
                                                   L
p                        Parabolic subalgebra j≥0 gj                                      24
γ(A)                     Column reading of a tableau                                      35
γa , γi                  Standard bases for P, P∞                                      32,38
∆, ∆l′ ,l′′              Comultiplications                                             18,29
δi                       Standard basis for d∗                                            32
εi                       Standard basis for c∗                                            10
η                        ei,j 7→ ei,j + δi,j (n − qcol(j) − qcol(j)+1 − · · · − ql )      24
η                        ei,j 7→ ei,j + δi,j (n − q1 − q2 − · · · − qcol(j) )             27
θ(α), θ(A)               Content of a weight, tableau                                  33,35
ι, τ, µf , ηc            Automorphisms of Yn (σ)/W (π)                                 12,27
κ                        Canonical surjection of Yn (σ) onto W (π)                        26
µ                        Multiplication on Grothendieck group                          39,78
µM,V                     Isomorphism from tensor identity                                 84
νM,V                     Isomorphism between V(M ⊗ V ), V(M ) ⊛ V                         97
ξ                        Miura transform embedding W (π) into U (h)                       28
π = (q1 , . . . , ql )   Pyramid of level l with row lengths (p1 , . . . , pn )           23
ρ(A)                     Row reading of a tableau                                         37
σ = (si,j )1≤i,j≤n       Shift matrix                                                      9
χM,V                     Isomorphism between M ⊛ V and M ⊗ V                              82
ΨN                       Harish-Chandra homomorphism                                      33
ψ                        Isomorphism between Z(U (g)) and Z(W (π))                        33
ωM,V                     Isomorphism between M ⊛ V , M ⊛ V                                91
aM,V,V ′                 Associativity isomorphism                                        85
col(i), row(i)           Column, row numbers of i in π                                    23
ei , fi                  Generators of UZ , translation functors                       37,43
ẽi , f˜i                Crystal operators                                                40
sM                       Endomorphisms of (M ⊗ V ) ⊗ V , (M ⊛ V ) ⊛ V                  43,86
xM                       Endomorphisms of M ⊗ V , M ⊛ V                                43,85
xi,a , yi,a              Elements of Z[P  b n]                                            55

                                            103
104                                    NOTATION


      A0                  Ground-state tableau                                    41
      Col(π)              Column strict π-tableaux                                35
        (r)
      Cn                  Central elements of Yn (σ)/W (π)                        20
      Dom(π)              Dominant row symmetrized π-tableaux                     36
        (r)     (r) (r)
      Di , Ei , Fi        Generators of Yn (σ)/W (π)                               9
        (r)    (r)
      Ei,j , Fi,j         Higher root elements                                    11
      F (π)               Finite dimensional representations of W (π)             80
      F                   Algebraically closed field of characteristic 0           9
         ♯/♭
      K(1n ) (σ)          Ideals of positive/negative Borel subalgebras           11
                                                               Vπ
      KA                  Dual canonical basis element of          (VZ )          38
      K(A)                Irreducible highest weight module in O(π)               44
      Lα , LA             Dual canonical bases of T N (VZ ), S π (VZ )            38
      L(A)                Irreducible highest weight module in M(π)               54
      M (α)               Verma module of highest weight (α − ρ)                  32
      Mα , MA             Monomial bases of T N (VZ ), S π (VZ )                  38
      M (A)               Generalized Verma module                                54
      M(π)                Analogue of category O for V    W (π)                   78
                                                           π
      NA                  Monomial basis element of          (VZ )                38
      N (A)               Parabolic Verma module                                  44
      O, O(π)             Category O, parabolic category O                        41
      P π (VZ )           Polynomial representation of UZ                         39
      P, P∞               Free Z-modules on bases {γa | a ∈ F}, {γi | i ∈ Z}      37
      Pn , Qn             Weight lattice, root lattice in c∗                      10
      Pn , Qn             Gelfand-Tsetlin weights, rational weights            47,51
      Qχ                  Generalized Gelfand-Graev representation                81
      R(A)                Rectification of a standard π-tableau                   37
      Row(π)              Row symmetrized π-tableaux                              35
      Std(π)              Standard π-tableaux                                     37
      Si,j                Si,j = si,j + pmin(i,j)                                 24
      SYn (σ)             Special shifted Yangian                                 21
      S π (VZ )           S p1 (VZ ) ⊗ · · · ⊗ S pn (VZ )                         38
      T N (VZ )           Tensor space                                            38
        (r)
      Ti,j                Alternate generators of Yn (σ)/W (π)                    12
        (r)
      Ti,j;x              Invariants in U (p)                                     25
      UZ                  Kostant Z-form for gl∞                                  38
      VZ                  Z-form Vπfor naturalπ UZ -module                        38
      V                   Map        (VZ ) → S (VZ ), Whittaker functor        39,96
      V                   Natural g-module of column vectors                      43
      VA                  Standard monomial basis element of P π (VZ )            39
      V (A)               Standard module                                         72
      Wh, Wh              Left, right Whittaker vectors                        81,89
      W (π)               Finite W -algebra                                       24
      Yn (σ)              Shifted Yangian                                          9
        ♯/♭
      Y(1n ) (σ)          Positive/negative Borel subalgebras of Yn (σ)           11
       (r)
      ZN                  Generators of Z(U (glN ))                              32
                                   Bibliography

[A1]     T. Arakawa, Drinfeld functor and finite-dimensional representations of Yangian, Comm.
         Math. Phys. 205 (1999), 1–18; math.QA/9807144.
[A2]     T. Arakawa, Representation theory of W -algebras, preprint; math.QA/0506056.
[AS]     T. Arakawa and T. Suzuki, Duality between sln (C) and the degenerate affine Hecke
         algebra, J. Algebra 209 (1998), 288–304; q-alg/9710037.
[Ba]     E. Backelin, Representation theory of the category O in Whittaker categories, Internat.
         Math. Res. Notices 4 (1997), 153–172.
[BB]     A. Beilinson and J. Bernstein, Localisation de g-modules, C. R. Acad. Sci. Paris Ser. I
         Math. 292 (1981), 15–18.
[BGS]    A. Beilinson, V. Ginzburg and W. Soergel, Koszul duality patterns in representation
         theory, J. Amer. Math. Soc. 9 (1996), 473–527.
[BeK]    A. Berenstein and D. Kazhdan, Geometric and unipotent crystals II: From unipotent
         bicrystals to crystal bases; math.QA/0601391.
[BG]     J. Bernstein and I. M. Gelfand, Tensor products of finite and infinite dimensional rep-
         resentations of semisimple Lie algebras, Compositio Math. 41 (1980), 245–285.
[BGG1]   J. Bernstein, I. M. Gelfand and S. I. Gelfand, Structure of representations generated by
         vectors of highest weight, Func. Anal. Appl. 5 (1971), 1–9.
[BGG2]   J. Bernstein, I. M. Gelfand and S. I. Gelfand, Differential operators on the base affine
         space and a study of g-modules, in: “Lie groups and their representations”, pp. 21–64,
         Halsted, 1975.
[BGG3]   J. Bernstein, I. M. Gelfand and S. I. Gelfand, A category of g-modules, Func. Anal.
         Appl. 10 (1976), 87–92.
[BT]     J. de Boer and T. Tjin, Quantization and representation theory of finite W -algebras,
         Comm. Math. Phys. 158 (1993), 485–516; hep-th/9211109.
[BR]     C. Briot and E. Ragoucy, RTT presentation of finite W -algebras, J. Phys. A 34 (2001),
         7287-7310; math.QA/0005111.
[B]      J. Brundan, Dual canonical bases and Kazhdan-Lusztig polynomials, to appear in J.
         Algebra; math.QA/0509700.
[BGo]    J. Brundan and S. Goodwin, Good grading polytopes, to appear in Proc. London Math.
         Soc.; math.QA/0510205.
[BK1]    J. Brundan and A. Kleshchev, Translation functors for general linear and symmetric
         groups, Proc. London Math. Soc. 80 (2000), 75–106.
                                                                                          (2)
[BK2]    J. Brundan and A. Kleshchev, Hecke-Clifford superalgebras, crystals of type A2ℓ and
                                       b
         modular branching rules for Sn , Represent. Theory 5 (2001), 317-403; math.RT/0103060.
[BK3]    J. Brundan and A. Kleshchev, Projective representations of symmetric groups via
         Sergeev duality, Math. Z. 239 (2002), 27–68.
[BK4]    J. Brundan and A. Kleshchev, Parabolic presentations of the Yangian Y (gln ), Comm.
         Math. Phys. 254 (2005), 191–220; math.QA/0407011.
[BK5]    J. Brundan and A. Kleshchev, Shifted Yangians and finite W -algebras, Adv. Math. 200
         (2006), 136–195; math.QA/0407012.
[BK6]    J. Brundan and A. Kleshchev, Schur-Weyl duality for higher levels; math.RT/0605217.
[BrK]    J.-L. Brylinksi and M. Kashiwara, Kazhdan-Lusztig conjecture and holonomic systems,
         Invent. Math. 64 (1981), 387–410.
[Ca]     P. Caldero, A multiplicative property of quantum flag minors, Represent. Theory 7
         (2003), 164–176; math.RT/0112205.



                                              105
106                                   BIBLIOGRAPHY


[CL]    R. W. Carter and G. Lusztig, On the modular representations of the general linear and
        symmetric groups, Math. Z. 136 (1974), 193–242.
[C]     V. Chari, Braid group actions and tensor products, Internat. Math. Res. Notices 7
        (2002), 357–382; math.QA/0106241.
[CP1]   V. Chari and A. Pressley, Yangians and R-matrices, Enseign. Math. 36 (1990), 267–302.
[CP2]   V. Chari and A. Pressley, Minimal affinizations of representations of quantum groups:
        the simply laced case, J. Algebra 184 (1996), 1–30.
[C1]    I. Cherednik, A new interpretation of Gelfand-Tzetlin bases, Duke Math. J. 54 (1987),
        563–577.
[C2]    I. Cherednik, Quantum groups as hidden symmetries of classic representation theory,
        in: “Differential geometric methods in theoretical physics”, pp. 47–54, World Sci. Pub-
        lishing, 1989.
[CR]    J. Chuang and R. Rouquier, Derived equivalences for symmetric groups and sl2 -
        categorification, to appear in Annals of Math.; math.RT/0407205.
[DK]    A. De Sole and V. Kac, Finite vs affine W -algebras; math-ph/0511055.
[Di]    J. Dixmier, Enveloping algebras, Graduate Studies in Math. 11, Amer. Math. Soc., 1996.
[D]     V. Drinfeld, A new realization of Yangians and quantized affine algebras, Soviet Math.
        Dokl. 36 (1988), 212–216.
[EK]    P. Elashvili and V. Kac, Classification of good gradings of simple Lie algebras, in: “Lie
        groups and invariant theory” (E. B. Vinberg ed.), pp. 85–104, Amer. Math. Soc. Transl.
        213, AMS, 2005; math-ph/0312030.
[FRT]   L. Faddeev, N. Yu Reshetikhin and L. Takhtadzhyan, Quantization of Lie groups and
        Lie algebras, Leningrad Math. J. 1 (1990), 193–225.
[FM]    E. Frenkel and E. Mukhin, The Hopf algebra Rep Uq gl  b , Selecta Math. 8 (2002), 537–
                                                                ∞
        635; math.QA/0103126.
[FR]    E. Frenkel and N. Yu Reshetikhin, The q-characters of representations of quantum
        affine algebras and deformations of W-algebras, Contemp. Math. 248 (1999), 163–205;
        math.QA/9810055.
[F]     W. Fulton, Young tableaux, LMS, 1997.
[FO]    V. Futorny and S. Ovsienko, Kostant theorem for special filtered algebras, Bull. London
        Math. Soc. 37 (2005), 187–199; math.RA/0303372.
[GG]    W. L. Gan and V. Ginzburg, Quantization of Slodowy slices, Internat. Math. Res.
        Notices 5 (2002), 243–255; math.RT/0105225.
[GT]    I. Gelfand and M. Tsetlin, Finite-dimensional representations of the unimodular group,
        Dokl. Acad. Nauk USSR 71 (1950), 825–828.
[K]     V. Kac, Infinite dimensional Lie algebras, third edition, CUP, 1995.
[KRW]   V. Kac, S. Roan and M. Wakimoto, Quantum reduction for affine superalgebras, Comm.
        Math. Phys. 241 (2003), 307–342; math-ph/0302015.
[K1]    M. Kashiwara, Global crystal bases of quantum groups, Duke Math. J. 69 (1993), 455–
        485.
[K2]    M. Kashiwara, On crystal bases, Proc. Canadian Math. Soc. 16 (1995), 155–196.
[KN]    M. Kashiwara and T. Nakashima, Crystal graphs for representations of the q-analogue
        of classical Lie algebras, J. Algebra 165 (1994), 295–345.
[Ka]    N. Kawanaka, Generalized Gelfand-Graev representations and Ennola duality, in: “Al-
        gebraic groups and related topics”, Adv. Studies in Pure Math. 6 (1985), 175–206.
[KL]    D. Kazhdan and G. Lusztig, Representations of Coxeter groups and Hecke algebras,
        Invent. Math. 53 (1979), 165–184.
[Kn]    H. Knight, Spectra of tensor products of finite dimensional representations of Yangians,
        J. Algebra 174 (1995), 187–196.
[Ko1]   B. Kostant, Lie group representations on polynomial rings, Amer. J. Math. 85 (1963),
        327–404.
[Ko2]   B. Kostant, On Whittaker modules and representation theory, Invent. Math. 48 (1978),
        101–184.
[Ku]    J. Kujawa, Crystal structures arising from representations of GL(m|n), to appear in
        Represent. Theory; math.RT/0311251.
[LS]    A. Lascoux and M.-P. Schützenberger, Keys and standard bases, in: “Invariant theory
        and tableaux”, D. Stanton ed., Springer, 1990.
                                      BIBLIOGRAPHY                                          107


[LNT]   B. Leclerc, M. Nazarov and J.-Y. Thibon, Induced representations of affine Hecke alge-
        bras and canonical bases of quantum groups, in: “Studies in memory of Issai Schur”,
        pp. 115–153, Progr. Math. 210, Birkhäuser, 2003; math.QA/0011074.
[LZ]    B. Leclerc and A. Zelevinsky, Quasicommuting families of quantum Plücker coordinates,
        Amer. Math. Soc. Transl. 181 (1998), 85–108.
[L]     G. Lusztig, Introduction to quantum groups, Progress in Math. 110, Birkhauser, 1993.
[Ly]    T. E. Lynch, Generalized Whittaker vectors and representation theory, PhD thesis,
        M.I.T., 1979.
[Ma]    H. Matumoto, Whittaker modules associated with highest weight modules, Duke Math.
        J. 60 (1990), 59–113.
[MS]    D. Miličíc and W. Soergel, The composition series of modules induced from Whittaker
        modules, Comment. Math. Helv. 72 (1997), 503–520.
[M]     C. Moeglin, Modèles de Whittaker et idéaux primitifs complètement premier dans les
        algèbres enveloppantes I, C. R. Acad. Sci. Paris 303 (1986), 845–848; II, Math. Scand.
        63 (1988), 5–35.
[M1]    A. Molev, Yangians and their applications, Handbook of Algebra 3 (2003), 907–959;
        math.QA/0211288.
[M2]    A. Molev, Finite dimensional irreducible representations of twisted Yangians, J. Math.
        Phys. 39 (1998), 5559–5600; q-alg/9711022.
[M3]    A. Molev, Casimir elements for certain polynomial current Lie algebras, in: “Physi-
        cal applications and mathematical aspects of geometry, groups and algebras” (H.-D.
        Doebner, W. Scherer and P. Nattermann eds.), pp. 172–176, World Scientific, 1997.
[M4]    A. Molev, Irreducibility criterion for tensor products of Yangian evaluation modules,
        Duke Math. J. 112 (2002), 307–341; math.QA/0009183.
[MNO]   A. Molev, M. Nazarov and G. Olshanskii, Yangians and classical Lie algebras, Russian
        Math. Surveys 51 (1996), 205–282.
[NT]    M. Nazarov and V. Tarasov, Representations of Yangians with Gelfand-Zetlin bases, J.
        reine angew. Math. 496 (1998), 181–212; q-alg/9502008.
[P1]    A. Premet, Special transverse slices and their enveloping algebras, Advances in Math.
        170 (2002), 1–55.
[P2]    A. Premet, Enveloping algebras of Slodowy slices and the Joseph ideal, preprint;
        math.RT/0504343.
[RS]    E. Ragoucy and P. Sorba, Yangian realisations from finite W -algebras, Comm. Math.
        Phys. 203 (1999), 551–572; hep-th/9803243.
[Sk]    S. Skryabin, A category equivalence, appendix to [P1].
[S]     W. Soergel, Kategorie O, perverse Garben und Moduln über den Koinvarianten zur
        Weyl-gruppe, J. Amer. Math. Soc. 3 (1990), 421–445.
[T1]    V. Tarasov, Structure of quantum L operators for the R-matrix of the XXZ model,
        Theoret. Math. Phys. 61 (1984), 1065–1072.
[T2]    V. Tarasov, Irreducible monodromy matrices for the R-matrix of the XXZ model, and
        lattice local quantum Hamiltonians, Theoret. Math. Phys. 63 (1985), 440–454.
[V]     M. Varagnolo, Quiver varieties and Yangians, Letters in Math. Physics 53 (2000), 273–
        283; math.QA/0005277.
[VD]    K. de Vos and P. van Driel, The Kazhdan-Lusztig conjecture for finite W -algebras, Lett.
        Math. Phys. 35 (1995), 333–344; hep-th/9508020.
