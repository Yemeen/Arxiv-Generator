                                                HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS OF
                                                          REDUCTIVE P-ADIC GROUPS

                                                                                       RALF MEYER


                                                       Abstrat. Let G be a redutive group over a non-Arhimedean loal eld.
arXiv:math/0501548v2 [math.RT] 2 Jun 2005




                                                       Then the anonial funtor from the derived ategory of smooth tempered
                                                       representations of G to the derived ategory of all smooth representations of G
                                                       is fully faithful. Here we onsider representations on bornologial vetor spaes.
                                                       As a onsequene, if G is semi-simple, V and W are tempered irreduible
                                                       representations of G, and V or W is square-integrable, then Extn               ∼
                                                                                                                            G (V, W ) = 0
                                                       for all n ≥ 1. We use this to prove in full generality a formula for the formal
                                                       dimension of square-integrable representations due to Shneider and Stuhler.




                                                                                    1. Introdution

                                                Let   G   be a linear algebrai group over a non-Arhimedean loal eld whose
                                            onneted omponent of the identity element is redutive; we briey all suh groups
                                            redutive p-adi groups.       For the purposes of exposition, we assume throughout the
                                            introdution that the onneted entre of               G   is trivial, although we treat groups
                                            with arbitrary entre in the main body of this artile.
                                                We are going to ompare homologial and ohomologial omputations for the
                                            Heke algebra      H(G)    and the Harish-Chandra Shwartz algebra                S(G).   Our main
                                            result asserts that the derived ategory of            S(G)   is a full subategory of the derived
                                            ategory of    H(G).    These derived ategories inorporate a ertain amount of fun-
                                            tional analysis beause       S(G)   is more than just an algebra. Before we disuss this,
                                            we sketh two purely algebrai appliations of our main theorem.
                                                Let   Modalg (G)   be the ategory of smooth representations of             G   on omplex ve-
                                            tor spaes. We ompute some extension spaes in this Abelian ategory. If both
                                            V   and   W are irreduible tempered representations and one of them is square-
                                            integrable, then  ExtnG (V, W ) = 0 for n ≥ 1. If the loal eld underlying G has
                                            harateristi 0, this is proven by very dierent means in [20℄. We get a more
                                            transparent proof that also works in prime harateristi.
                                                                   n
                                               The vanishing of ExtG (V, W ) is almost trivial if V or W is superuspidal beause
                                            then V or W is both projetive and injetive in Modalg (G). This is related to
                                            the fat that superuspidal representations are isolated points in the admissible
                                            dual. Square-integrable representations are isolated points in the tempered dual.
                                                                                                                                          
                                            Hene they are projetive and injetive in an appropriate ategory
                                                                                                                              Mod S(G) of
                                            tempered smooth representations of           G. Both        Mod S(G)      and   Modalg (G) are full
                                            subategories in a larger ategory         Mod(G). That        is, we have fully faithful funtors
                                                                                
                                                                        Mod S(G) → Mod(G) ← Modalg (G).
                                            We will show that the indued funtors between the derived ategories,
                                                                                  
                                                                          Der S(G) → Der(G) ← Deralg (G),
                                            are still fully faithful. This ontains the vanishing result for            Ext   as a speial ase.

                                              2000 Mathematis Subjet Classiation. 20G05, 18E30.
                                              This researh was supported by the EU-Network Quantum Spaes and Nonommutative Ge-
                                            ometry (Contrat HPRN-CT-2002-00280) and the Deutshe Forshungsgemeinshaft (SFB 478).
                                                                                               1
2                                             RALF MEYER


    Another appliation involves Euler harateristis for square-integrable repre-
sentations.       Let   V   be an irreduible square-integrable representation of        G.    By a
theorem of Joseph Bernstein, any nitely generated smooth representation of                      G,
suh as      V,   has a nite type projetive resolution        P• → V .   Its Euler harateristi
is dened as
                                            X                        
                                 χ(V ) :=       (−1)n [Pn ] ∈ K0 H(G) .

Sine   V   is square-integrable, it is a projetive S(G)-module and therefore denes
                                                                          
a lass   [V ] ∈ K0 S(G) . We show that the map K0 H(G) → K0 S(G) indued
by the    embedding H(G) → S(G) maps χ(V ) to [V ]. This is useful beause in [20℄
Peter Shneider and Ulrih Stuhler onstrut very expliit nite type projetive
                                                                              
resolutions, so that we get a nie formula for                 [V ] ∈ K0 S(G) . This implies     an
expliit formula for the formal dimension of                  V , whih is proven in [20℄ if V    is
superuspidal or if         G   has harateristi   0.   One onsequene of this formula is that
the formal dimensions are quantised, that is, they are all multiples of some                  α > 0.
This allows to estimate the number of irreduible square-integrable representations
that ontain a given representation of a ompat open subgroup of                  G.
    Although these appliations an be stated purely algebraially, their proofs re-
quire funtional analysis. We may view
                                          S(G) just as an algebra and onsider the
ategory  Modalg S(G) of modules
                                    over S(G) in the algebrai sense as in [21℄. How-
ever, the funtor Der alg S(G) → Deralg (G) fails to be fully faithful. This problem
already ours for G = Z. The issue is that the tensor produt of S(G) with itself
                                                
plays a ruial role. If we work in Modalg S(G) , we have to deal with S(G)⊗S(G),
                                                
whih appears quite intratable. In Mod S(G) we meet instead the muh simpler
ompletion S(G × G) of this spae.
    Now it is time to explain briey how we do analysis.                     I am an advoate of
bornologies as opposed to topologies. This means working with bounded subsets
and bounded maps instead of open subsets and ontinuous maps. General bornolog-
ial vetor spaes behave better than general topologial vetor spaes for purposes
of representation theory and homologial algebra (see [15, 17℄). The spaes that we
shall use here arry both a bornology and a topology, and both strutures deter-
mine eah other. Therefore, readers who are familiar with topologial vetor spaes
may be able to follow this artile without learning muh about bornologies. We
explain some notions of bornologial analysis along the way beause they may be
unfamiliar to many readers.
    We let    Mod(G)        be the ategory of smooth representations of G on bornologial
vetor spaes as in [15℄. The algebras          H(G) and S(G) are bornologial algebras in
a natural way. A smooth             representation π : G → Aut(V ) on a bornologial vetor
spae    V   is alled tempered if its integrated form extends to a bounded algebra
homomorphism            S(G) → End(V ).        We may identify      Mod(G)   with the ategory of
essential (or non-degenerate) bornologial left modules over               H(G)
                                                                                ([15℄). As our
notation suggests, this identies the subategory                  Mod S(G) with the ategory 
of essential bornologial modules over               S(G).    We   turn Mod(G) and Mod S(G)
into exat ategories using the lass of extensions with a bounded linear setion.
The exat ategory struture allows us to form the derived ategories Der(G) and
         
Der S(G) as in [11℄. Atually, the passage to derived ategories is rather easy in
both ases beause our ategories have enough projetive and injetive objets.
    Equipping a vetor spae with the nest possible bornology, we identify the
ategory of vetor spaes with a full subategory of the ategory of bornologial
vetor spaes. Thus          Modalg (G)     beomes a full subategory of     Mod(G).   Moreover,
this embedding maps projetive objets again to projetive objets. Therefore, the
indued funtor         Deralg (G) → Der(G) is still fully faithful.    Our main theorem asserts
                      HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                   3
                                           
that the anonial funtor         Der S(G) → Der(G)          is fully faithful as well. The basi
tehnology for its proof is already ontained in [16, 17℄.
                             Mod(A) of essential modules and its derived ategory
  In [17℄, I dene the ategory
Der(A)                                          A and extend some homologial
           for a quasi-unital bornologial algebra
mahinery to this setting. A morphism A → B is alled isoohomologial if the
indued funtor Der(B) → Der(A) is fully faithful. [17℄ gives several equivalent
haraterisations of isoohomologial morphisms. The riterion that is most easy
to verify is the following: let      P• → A     be a projetive A-bimodule resolution of A;
then    A→B       is isoohomologial if and only if       ˆ A P• ⊗
                                                          B⊗      ˆ A B is a resolution of B
(in both ases, resolution means that there is a bounded ontrating homotopy).
  The artile [16℄ deals with the speial ase of the embedding                     C[G] → S1 (G)
for a nitely generated disrete group           G    and a ertain Shwartz algebra      S1 (G),
whih is dened by        ℓ1 -estimates.   The hain omplex whose ontratibility deides
whether this embedding is isoohomologial turns out to be a                     oarse geometri
invariant of     G.   That is, it depends only on the quasi-isometry lass of a word-length
funtion      on G.   If the group   G   admits a suiently nie ombing, then I onstrut
an expliit ontrating homotopy of this hain omplex.                   Thus   C[G] → S1 (G)   is
isoohomologial for suh groups.
  The argument for Shwartz algebras of redutive                p-adi   groups follows the same
pattern. Let      H ⊆G       be some ompat open subgroup and let               X := G/H .   This
is a disrete spae whih inherits a anonial oarse geometri struture from                   G.
Sine     G   is redutive, it ats properly and oompatly on a Eulidean building,
namely, its ane Bruhat-Tits building.                Suh buildings are CAT(0) spaes and
hene ombable. Sine         X   is oarsely equivalent to the building, it is ombable as
well. Thus the geometri ondition of [16℄ is easily fullled for all redutive             p-adi
groups. However, we also have to hek that the onstrutions in [16℄ are ompatible
with uniform smoothness of funtions beause              G   is no longer disrete. This fores
us to look more arefully at the geometry of the building.




                                  2. Bornologial analysis

  Algebras like the Shwartz algebra            S(G)    of a redutive     p-adi   group arry an
additional struture that allows to do analysis in them. The homologial algebra
for modules over suh algebras            simplies   if we take this additional struture into
aount.  One reason is that the omplete tensor produt                         ˆ S(G)
                                                                            S(G) ⊗         an be
                  2
identied with S(G ) (Lemma 2).
  It is ustomary to desribe this additional struture using a loally onvex topol-
ogy. We prefer to use bornologies instead. This means that we work with bounded
subsets and bounded operators instead of open subsets and ontinuous operators. A
basi referene on bornologies is [9℄. We use bornologies beause of their advantages
in onnetion with homologial algebra (see [17℄).
  We mainly need bornologial vetor spaes that are omplete and onvex. There-
fore, we drop these adjetives and taitly require all bornologies to be omplete and
onvex. When we use inomplete bornologies, we expliitly say so.
  We need two lasses of examples: ne bornologies and von Neumann bornologies.
Let   V                       C. The ne bornology Fine(V ) is the nest possible
          be a vetor spae over
bornology on      V.        T ⊆ V is bounded in Fine(V ) if and only if there is a
                        A subset
nite-dimensional subspae VT ⊆ V suh that T is a bounded subset of VT ∼    = Rn
in the usual sense. We also write Fine(V ) for V equipped with the ne bornology.
   Any linear map Fine(V ) → W is bounded. This means that Fine is a fully faithful
funtor from the ategory of vetor spaes to the ategory of bornologial vetor
spaes that is left-adjoint to the forgetful funtor in the opposite diretion.
4                                             RALF MEYER


     Let   V    be a (quasi)omplete loally onvex topologial vetor spae. A subset
T ⊆ V          is alled   von Neumann bounded         if it is absorbed by all neighbourhoods
of zero. These subsets form a bornology on            V alled the von Neumann bornology
(following [9℄). We write          vN(V ) for V equipped with this bornology.
     This denes a funtor         vN from topologial to bornologial vetor spaes. Its re-
strition to the full subategory of Fréhet spaes or, more generally, of LF-spaes,
is fully faithful. That is, a linear map between suh spaes is bounded if and only
if it is ontinuous.        A ruial advantage of bornologies is that joint boundedness
is muh weaker than joint ontinuity for multilinear maps:                         if   V1 , . . . , Vn , W   are
(quasi)omplete loally onvex topologial vetor spaes, then any separately on-
tinuous        n-linear   map   V1 × · · · × Vn → W    is (jointly) bounded. The onverse also
holds under mild hypotheses.
     Let   G be a redutive p-adi group.       We arefully explain how the Shwartz algebra
S(G)      looks like as a bornologial algebra. The most onvenient denition for our
purposes is due to Marie-Frane Vignéras ([25℄). Let                    σ : G → N be        the usual sale
on   G.    It an be dened using a representation of                  G. Let L2 (G)        be the Hilbert
spae of square-integrable funtions with respet to some Haar measure on                              G.     Let


                     Lσ2 (G) := {f : G → C | f · σ k ∈ L2 (G)          for all   k ∈ N}.

A subset  T ⊆ Lσ2 (G) is bounded if for all k ∈ N there exists a onstant Ck ∈ R+
               k
suh that kf ·σ kL2 (G) ≤ Ck for all f ∈ T . This is the von Neumann bornology with
                                       σ
respet to the Fréhet topology on L2 (G) dened by the sequene of semi-norms


                                        kf kk2 := kf · σ k kL2 (G) .

   Let CO(G) be the set of ompat open subgroups of G, ordered by inlusion. For
U ∈ CO(G), let S(GU ) = Lσ2 (GU ) be the subspae of U -bi-invariant funtions
    σ
in L2 (G). We give S(GU ) the subspae bornology, that is, a subset is bounded if
                              σ
and only if it is bounded in L2 (G). Finally, we let


                                        S(G) := lim S(GU ),
                                                −→
where      U         CO(G). We equip S(G) with the diret-limit bornology. That
               runs through
             S(G) is bounded if and only if it is a bounded subset of S(GU ) for
is, a subset of
some U ∈ CO(G). We may also haraterise this bornology as the von Neumann
bornology with respet to the diret-limit topology on S(G), using the well-known
desription of bounded subsets in LF-spaes (see [24, Proposition 14.6℄).


Lemma 1 ([25℄). The denition of the Shwartz algebra above agrees with the one
of Harish-Chandra in [22, 26℄.
Proof.                                         double osets GU as opposed to
           The rst ruial point is that the spae of
the group  G itselfhas polynomial growth with respet to the sale σ . It sues to
hek this for a good maximal ompat subgroup K beause the map GU → GK
is nite-to-one. By the Iwasawa deomposition, the double osets in GK an be
parametrised by points in a maximal split torus. The sale on G restrits to a
standard word-length funtion on this torus, so that we get the desired polynomial
                                                  P
                                d > 0 suh that x∈GU σ −d (x) is bounded.
growth. As a result, there exists
   Moreover, we need the following relationship between the growth of the double
osets U xU and the             Harish-Chandra spherial funtion            Ξ:    there are onstants
C, r > 0 suh that

                vol(U xU ) ≤ Cσ(x)r · Ξ(x)−2 ,           Ξ(x)−2 ≤ Cσ(x)r · vol(U xU ).
                       HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                              5


This follows from Equation I.1.(5) and Lemma II.1.1 in [26℄. Hene
  Z                                    X
          |f (x)|2 σ(x)s dx =                 |f (U xU )|2 σ(x)s vol(U xU )
      G                              x∈GU
                                          X
                                     ≤           |f (U xU )|2 Ξ(x)−2 Cσ(x)r+s
                                         x∈GU
                                                                                      X
                                                 ≤ max |f (x)|2 Ξ(x)−2 σ(x)r+s+d                 Cσ −d (y).
                                                    x∈G
                                                                                     y∈GU

A similar omputation shows
                       Z
                               |f (x)|2 σ(x)s dx ≥ max |f (x)|2 Ξ(x)−2 C −1 σ(x)s−r .
                           G                         x∈G

Therefore, the sequenes of semi-norms                       kf σ s k2 and kf Ξ−1 σ s k∞   for   s ∈ N    are
equivalent and dene the same funtion                      spae S(GU ).                                    
  Convolution denes a ontinuous bilinear map                        S(GU ) × S(GU ) → S(GU )
for any      U ∈ CO(G)             by [26, Lemme III.6.1℄.         Sine S(GU ) is a Fréhet spae,
boundedness and ontinuity of the onvolution are equivalent. Sine any bounded
subset of       S(G)   is already ontained in             S(GU ) for some U , the onvolution is a
bounded bilinear map on                  S(G),   so that   S(G) is a bornologial algebra. In ontrast,
the onvolution on              S(G)   is only separately ontinuous.
  Now we return to the general theory and dene the     Hom funtor and the tensor
produt.       Hom(V, W ) be the vetor spae of bounded linear maps V → W .
                Let
A subset T of Hom(V, W ) is bounded if and only if it is equibounded, that is,
{f (v) | f ∈ T, v ∈ S} is bounded for any bounded subset S ⊆ V . This bornology
is automatially omplete if W is.
   The omplete projetive bornologial tensor produt ⊗  ˆ is dened in [8℄ by the
expeted universal property: it is a bornologial vetor spae V ⊗ˆ W together with
a bounded bilinear map b : V ×W → V ⊗W  ˆ   suh that l 7→ l◦b is a bijetion between
bounded linear maps V ⊗  ˆ W → X and bounded bilinear maps V × W → X . This
tensor produt enjoys many useful properties. It is ommutative, assoiative, and
ommutes with diret limits. It satises the adjoint assoiativity relation
                                                                 
(1)                                    ˆ W, X) ∼
                                 Hom(V ⊗       = Hom V, Hom(W, X) .
Therefore, a bornologial module over a bornologial algebra                  A an be dened in
three equivalent ways, using a bounded linear map                  A → End(V ), a bounded bilinear
map   A × V → V , or a bounded linear map                       ˆ V →V.
                                                               A⊗
  Let  ⊗ be the usual tensor produt of vetor                     spaes. The ne bornology funtor
is ompatible with tensor produts; that is, the obvious map                               ˆW
                                                                                   V ⊗W →V ⊗                  is
a bornologial isomorphism

(2)                                  Fine(V ⊗ W ) ∼          ˆ Fine(W )
                                                  = Fine(V ) ⊗
for any two vetor spaes                 V   and   W.       W is any bornologial
                                                           More generally, if
vetor spae, then the underlying vetor spae of              ˆ W is equal to the
                                                      Fine(V ) ⊗
purely algebrai tensor produt V ⊗ W . A subset T ⊆ V ⊗ W is bounded if and
only if there is a nite-dimensional subspae VT ⊆ V suh that T is ontained
in and bounded in VT ⊗ W ∼   = Rn ⊗ W ∼   = W n . Here W n arries the diret-sum
bornology. The reason for this is that ⊗ˆ ommutes with diret limits.
   If V1 and V2 are Fréhet-Montel spaes, then we have a natural isomorphism

(3)                            ˆ π V2 ) ∼
                         vN(V1 ⊗                  ˆ vN(V2 ),
                                        = vN(V1 ) ⊗
where      ˆπ
           ⊗    denotes the         omplete projetive topologial tensor produt           (see [7, 24℄).
This isomorphism is proven in [13, Appendix A.1.4℄, based on results of Alexander
6                                         RALF MEYER


Grothendiek. The Montel ondition means that all von Neumann bounded subsets
are preompat (equivalently, relatively ompat).

Lemma 2. Let G be a redutive p-adi group. Then S(G) ⊗ˆ S(G) ∼
                                                              = S(G × G).
Proof.    It is shown in [25℄ that   S(GU ) is a nulear Fréhet spae for all U ∈ CO(G);
                                                                          2
in fat, this follows easily from the proof of Lemma 1.          Equip G with the sale
σ(a, b) := σ(a)σ(b) for all a, b ∈ G. By denition, S(G2 )      ∼
                                                                = lim                    ˆ
                                                                      S(G2 U 2 ). Sine ⊗
                                                                   −→
ommutes with diret limits,

                                ˆ S(G) ∼
                           S(G) ⊗      = lim         ˆ S(GU )
                                             S(GU ) ⊗
                                          −→
                                          ˆ ∼
as well. It remains      to prove S(GU )
                                         ⊗2
                                             = S(G2 U 2 ). Sine                 these Fréhet spaes
are nulear, they are Montel spaes. Hene (3) allows us to replae                     ˆ
                                                                                        ⊗   by   ˆ π.
                                                                                                 ⊗      Now
we merely have to reall the denition of nulearity (see [7, 24℄).
    Let   V   and   W   be Fréhet spaes.         The natural map           V ⊗ W → Hom(V ′ , W )
denes another topology on           V ⊗ W,        whih may be weaker than the projetive
tensor produt topology.        A Fréhet spae is nulear if and only if this topology
oinides with the projetive tensor produt topology. Equivalently, there is only
one topology on   V ⊗ W for whih the anonial maps V × W → V ⊗ W and
V ⊗ W → Hom(V ′ , W ) are ontinuous. It is lear that the subspae topology from
S(G2 U 2 ) on S(GU )⊗S(GU ) has these two properties. Hene it agrees with the
                                                                                ⊗2
projetive tensor produt topology. Now the assertion follows beause S(GU )
                2   2
is dense in S(G U ).                                                           

              3. Basi homologial algebra over the Heke algebra

    Throughout this setion,    G denotes a totally disonneted, loally ompat
group,  H denotes a xed ompat open subgroup of G, and X := G/H .
   Let V be a bornologial vetor spae and let π : G → Aut(V ) be a representation
of G by bounded linear operators. The representation π is alled smooth if for any
bounded subset T ⊆ V there exists an open subgroup U ⊆ G suh that π(g, v) = v
for all g ∈ U , v ∈ T (see [15℄). For example, the left and right regular representa-
tions of G on S(G) are smooth. If V arries the ne bornology, the denition above
is equivalent to the usual notion of a smooth representation on a vetor spae.
    Let   Mod(G)      be the ategory of smooth representations of                  G   on bornologial
vetor spaes; its morphisms are the               G-equivariant      bounded linear maps.              Let
Modalg (G)      be the ategory of smooth representations of                  G   onC-vetor spaes.
The ne bornology funtor identies           Modalg (G) with a full         subategory of Mod(G).
    Let   H(G)      be the Heke algebra of     G; its elements are               the loally onstant,
ompatly supported funtions on          G.   The onvolution is dened by
                                               Z
                              f1 ∗ f2 (g) =            f1 (x)f2 (x−1 g) dx
                                                   G

for some left-invariant Haar measure           dx;               vol(H) = 1. We
                                                        we normalise it so that
equip     H(G)                               H(G) ∈ Modalg (G) ⊆ Mod(G). More
                 with the ne bornology, so that
generally, given any bornologial vetor spae V , we let H(G, V ) := H(G) ⊗  ˆ V.
The underlying vetor spae of H(G, V ) is just H(G) ⊗ V beause H(G) arries
the ne bornology. Hene H(G, V ) is the spae of loally onstant, ompatly
supported funtions G → V . The left regular representation λ and the right regular
representation ρ of G on H(G, V ) are dened by
                          λg f (x) := f (g −1 x),           ρg f (x) := f (xg)
as usual. They are both smooth.
                          HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                               7


     Any ontinuous representation               π : G → Aut(V ) on a bornologial vetor spae V
an be integrated to a bounded algebra homomorphism                     H(G) → End(V ), whih
we again denote by            π.   By adjoint assoiativity, this orresponds to a map
                                                                               Z
                                                                                              
                                          ˆ V → V,
                     π∗ : H(G, V ) = H(G) ⊗                             f 7→        π g, f (g) dg.
                                                                                G

The map        G-equivariant if G ats on H(G, V ) by λ. By [15, Proposition 4.7℄,
                π∗   is
the representation π is smooth if and only if π∗ is a bornologial quotient map,
that is, any bounded subset of V is of the form π∗ (T ) for some bounded subset
T ⊆ H(G, V ). Even more, if π is smooth, then π∗ has a bounded linear setion.
Namely, we an use

(4)                        σH : V → H(G, V ),              σH v(g) = π(g −1 , v)1H (g),
where      1H    denotes the harateristi funtion of
                                                                H . Thus the ategory Mod(G)
beomes isomorphi to the ategory                     Mod H(G) of essential modules over H(G)
(see [15, Theorem 4.8℄).              The term essential is a synonym for non-degenerate
that is not as widely used for other purposes.
     Let   Ext   be the lass of all extensions in                Mod(G)        that have a bounded linear
setion. This turns           Mod(G)      into an exat ategory in the sense of Daniel Quillen.
Hene the usual mahinery of homologial algebra applies to                               Mod(G):    we an form
a derived ategory            Der(G)    and derived funtors (see [11, 17℄). The exat ategory
Mod(G)       has enough projetive and injetive objets, so that the usual reipes for
omputing derived funtors apply. We shall use the following standard projetive
resolution in        Mod(G),       whih already ours in [16℄.
     The homogeneous spae              X := G/H          is disrete beause         H   is open in   G.   Let

(5)                   Xn := {(x0 , . . . , xn ) ∈ X n+1 | x0 6= x1 , . . . , xn−1 6= xn }.
We equip        C[Xn ]     with the ne bornology. We let               G at   diagonally on      Xn   and equip
C[Xn ]     with the indued representation

                               g · f (x0 , . . . , xn ) := f (g −1 x0 , . . . , g −1 xn ).
The stabilisers of points
                                                                  n
                                                                  \
                                      Stab(x0 , . . . , xn ) =          xj Hx−1
                                                                             j
                                                                  j=0

are ompat open subgroups of                  G   for eah     (x0 , . . . , xn ) ∈ Xn .    Let   Xn′ ⊆ Xn   be a
subset that ontains exatly one representative from eah orbit. We get
                              a                                           M
(6)                  Xn =           G/ Stab(ξ),            C[Xn ] =                C[G/ Stab(ξ)].
                             ξ∈Xn
                                ′                                        ξ∈Xn
                                                                            ′


If   U ∈ CO(G),           then we have a natural isomorphism
                                                     ∼
                                                     =
                           HomG (C[G/U ], V ) → Fix(U, V ),                     f 7→ f (1U ).
Sine    U   is ompat, this is an exat funtor of                    V,   so that   C[G/U ]     is a projetive
objet of    Mod(G).         Therefore,    C[Xn ]     is projetive by (6).
   In the following, we view               Xn as
                                            a subset of C[Xn ] in the usual way. We let
(x0 , . . . , xn ) = 0 if xj = xj+1 for some j ∈ {0, . . . , n−1}. Thus (x0 , . . . , xn ) ∈ C[Xn ]
                                         n+1
is dened for all (x0 , . . . , xn ) ∈ X     .
   We dene the boundary map δ = δn : C[Xn+1 ] → C[Xn ] for n ∈ N by

                                                n+1
                                                X
                                            
                      δ (x0 , . . . , xn+1 ) :=    (−1)j · (x0 , . . . , xbj , . . . , xn+1 ),
                                                    j=0
8                                                 RALF MEYER


where     xbj   means that       xj   is omitted. In terms of funtions, we an write
                                          n+1
                                          X             X
(7)              δφ(x0 , . . . , xn ) =         (−1)j         φ(x0 , . . . , xj−1 , y, xj , . . . , xn ).
                                          j=0           y∈X

The operators         δn   G-equivariant for all n ∈ N. We dene the augmentation map
                           are
α : C[X0 ] → C        byα(x) = 1 for all x ∈ X0 = X . It is G-equivariant with respet to
                                                                   2
the trivial      representation of G on C. It is easy to see that δ = 0 and α ◦ δ0 = 0.
Hene we get a hain omplex

                                          C• (X) := (C[Xn ], δn )n∈N
over C. We also form the redued omplex C̃• (X), whih has C[Xn ] in degree n ≥ 1
and  ker(α : C[X] → C) in degree 0. The omplex C̃• (X) is exat. Thus C• (X) → C
is a projetive resolution of C in Modalg (G).
   Next we dene bivariant o-invariant spaes. For V, W ∈ Mod(G), let V ⊗   ˆG W
be the quotient of V ⊗ ˆ W by the losed linear span of v ⊗ w − gv ⊗ gw for v ∈ V ,
w ∈ W , g ∈ G. Thus V ⊗    ˆ G W is again a omplete bornologial vetor spae. By
denition, we have

                                   ˆG W ∼
                                 V ⊗      ˆG V ∼
                                        =W⊗         ˆ W) ⊗
                                               = (V ⊗    ˆ G C,
where we equip     V ⊗ˆ W with the diagonal representation and C with the trivial
representation of  G. If X is another bornologial vetor spae, then we may identify
Hom(V ⊗  ˆ G W, X) with the spae of bounded bilinear maps f : V × W → X that
satisfy f (gv, gw) = f (v, w) for all g ∈ G, v ∈ V , w ∈ W . This universal property
haraterises V ⊗ ˆ G W uniquely. It follows from the dening property of ⊗ˆ.
   There is an alternative desription of V ⊗ ˆ G W in terms of H(G)-modules. Turn
V into a right and W into a left bornologial H(G)-module by
                          Z                              Z
                                    −1
                 v ∗ f :=    f (g) g v dg,      f ∗ w :=    f (g) gw dg
                                      G                                         G
for allf ∈ H(G), v ∈ V , w ∈ W . Let V ⊗ ˆ H(G) W be the quotient of V ⊗
                                                                       ˆW                                   by the
losed linear span of v ∗ f ⊗ w − v ⊗ f ∗ w for v ∈ V , f ∈ H(G), w ∈ W .

Lemma 3.       ˆG W = V ⊗
             V ⊗            ˆ H(G) W , that is, the elements gv ⊗ gw − v ⊗ w                                  and
v ∗ f ⊗ w − v ⊗ f ∗ w generate the same losed linear subspae.
Proof.    We have to show  Hom(V ⊗    ˆ G W, X) = Hom(V ⊗    ˆ H(G) W, X) for all borno-
logial vetor spaes X . By denition, Hom(V ⊗     ˆ G W, X) is the spae of bounded
                                                    −1
bilinear maps l : V × W → X that satisfy l(g           v, w) = l(v, gw) for all v ∈ V ,
w ∈ W , g ∈ G. This implies l(v ∗ f, w) = l(v, f ∗ w) for all v ∈ V , w ∈ W ,
f ∈ H(G). Conversely, suppose l(v ∗ f, w) = l(v, f ∗ w). Then
                    
   l gv, g · (f ∗ w) = l(gv, (δg ∗ f ) ∗ w)
                                                                         
                            = l(gv ∗ (δg ∗ f ), w) = l (g −1 · gv) ∗ f, w = l(v, f ∗ w)
for allv ∈ V , w ∈ W , g ∈ G, f ∈ H(G). This implies l(gv, gw) = l(v, w) for
allv ∈ V , w ∈ W , g ∈ G beause any w ∈ W is xed by some U ∈ CO(G) and
therefore of the form µU ∗ w, where µU is the normalised Haar measure of U . 
      Sine     ˆG
                ⊗    is funtorial in both variables, we an apply it to hain omplexes.
Espeially, we get a hain omplex of bornologial vetor spaes                              ˆ G C• (X).
                                                                                             V⊗              Sine
C• (X)  is a projetive resolution of the trivial representation, we denote the hain

homotopy type of V ⊗  ˆ G C• (X) by V ⊗  ˆ LG C. The homology vetor spaes of V ⊗
                                                                                 ˆ LG C
                      G               H(G)
may be denoted Torn (V, C) or Torn           (V, C). However, this passage to homology
forgets an important part of the struture, namely, the bornology. Therefore, it is

better to work with V ⊗  ˆ LG C instead.
                         HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                        9


     If   V    and   W    are just vetor spaes, we an identify           V ⊗ˆ G W with a purely
algebrai onstrution. Let            V ⊗G W be the quotient of           V ⊗ W by the linear span
of   v ⊗ w − gv ⊗ gw           forv ∈ V , w ∈ W , g ∈ G. Then
                                 Fine(V ⊗G W ) ∼          ˆ G Fine(W ).
                                               = Fine(V ) ⊗
This follows from (2) and the fat that any linear subspae of a ne bornologial
                                                                                                 
vetor spae is losed. Therefore, Fine(V ) ⊗ ˆ G C• (X) ∼
                                                         = Fine V ⊗G C• (X) , and
   G
Tor∗ (V, C) is the homology of the hain omplex V ⊗G C• (X). In this ase, passage
to homology is harmless beause V ⊗   ˆ LG C arries the ne bornology; this implies
that it is quasi-isomorphi to its homology viewed as a omplex with vanishing
boundary map.
     Our next goal is to desribe                ˆ G C• (X)
                                               V ⊗             (Proposition 6). This requires some
geometri preparations.

Denition 4.             Given a nite subset         F ⊆ X,   we dene the relation   ∼F   on   X   by
                                                [
(8)               x ∼F y ⇐⇒ (x, y) ∈                  g · ({H} × F ) ⇐⇒ x−1 y ∈ HF H.
                                                g∈G
                         −1
Here we view       x y ∈ GH and HF H ⊆ GH .
     A subset   S ⊆ Xn is ontrolled by F if xi ∼F xj for all (x0 , . . . , xn ) ∈ S and all
i, j ∈ {0, . . . , n}. We all S ⊆ Xn ontrolled if it is ontrolled by some nite F .
Roughly speaking, this means that all entries of S are uniformly lose.

     A subset     S ⊆ Xn is ontrolled if and only if S is G-nite, that is, there is a nite
subset        F ⊆ Xn suh that S ⊆ G · F . This alternative haraterisation will be used
frequently. Denition 4 emphasises a ruial link between the ontrolled support
ondition and geometri group theory.
     A    oarse (geometri) struture on a loally ompat spae suh as X                 is a family
of relations on          X    satisfying some natural axioms due to John Roe (see also [6℄).
The subrelations of the relations              ∼F   above dene a oarse geometri struture on           X
in this sense. Sine it is generated by                 G-invariant   relations, it renders the ation
of    G   on    X    isometri.       This property already haraterises the oarse struture
uniquely: whenever a loally ompat group ats properly and oompatly on a
loally ompat spae, there is a unique oarse struture for whih this ation is
isometri (see [6, Example 6℄). Moreover, with this oarse struture, the spae                           X
is oarsely equivalent to             G.
     By denition, the notion of a ontrolled subset of               Xn   depends only on the oarse
geometri struture of               X.   Thus the spae of funtions on    Xn   of ontrolled support
only depends on the large sale geometry of                    X.
     Although our main examples, redutive groups, are unimodular, we want to treat
groups with non-trivial modular funtion as well. Therefore, we have to deorate
several formulas with modular funtions. We dene the modular homomorphism
∆G : G → R>0 by ∆G (g)d(g −1 ) = dg and d(gh) = ∆G (h) dg for all h ∈ G.
Denition 5.             Let   C(Xn , V )∆     be the spae of all maps       φ : Xn → V    that have
ontrolled support and satisfy the ovariane ondition
                                                                     
(9)                                        φ(gξ) = ∆G (g)−1 π g, φ(ξ)
      ξ ∈ Xn , g ∈ G. A subset T ⊆ C(Xn , V )∆ is bounded if {φ(ξ) | φ ∈ T } is
for all
bounded in V for all ξ ∈ Xn and the supports of all φ ∈ T are ontrolled by the
same nite subset F ⊆ X .

Proposition 6. For any V                   ∈ Mod(G),    there is a natural bornologial isomorphism
                                             ˆ G C[Xn ] ∼
                                           V ⊗          = C(Xn , V )∆ .
10                                                  RALF MEYER


The indued boundary map on V ⊗
                              ˆ G C[Xn ] orresponds to the boundary map
                                     δ = δn : C(Xn+1 , V )∆ → C(Xn , V )∆
dened by      (7).
     We denote the resulting hain omplex                 (C(Xn , V )∆ , δn )n∈N      by   C(X• , V )∆ .
Proof.   The bifuntor             ˆG
                                   ⊗    ommutes with diret limits and in partiular with diret
sums. Hene (6) yields
                                          M                      M
(10)             ˆ G C[Xn ] ∼
               V ⊗          =                      ˆ G C[Gξ] ∼
                                                 V ⊗         =            ˆ G C[G/ Stab(ξ)].
                                                                        V ⊗
                                          ξ∈Xn
                                             ′                   ξ∈Xn
                                                                    ′


Fix    ξ ∈ Xn′   and let          Map(G · ξ, V )∆    be the spae of all maps from G · ξ to V that
                                                                               ∆
satisfy the ovariane ondition (9).                 We equip Map(G · ξ, V )    with the produt
bornology as in Denition 5. We laim that the map
                                                                          Z
            ˆ C[Gξ] → Map(Gξ, V ),
       I: V ⊗                                           v ⊗ φ 7→ [η 7→         π(h−1 , v) · φ(hη) dh],
                                                                           G
yields a bornologial isomorphism

                                          ˆ G C[Gξ] ∼
                                        V ⊗         = MapG (Gξ, V )∆ .
We hek that         I   desends to         ˆ G C[Gξ]
                                            V ⊗           and maps into        Map(Gξ, V )∆ :
                              Z                                Z
     I(gv ⊗ gφ)(η) =                π(h−1 , gv) · gφ(hη) dh =     π(h−1 g, v) · φ(g −1 hη) dh
                                  G                             G
                                                             Z
                                                          =      π(h−1 , v) · φ(hη) dh = I(v ⊗ φ),
                                                                 G
                              Z
     I(v ⊗ φ)(gη) =                π(h−1 , v) · φ(hgη) dh
                               G
                                     Z
                                                                                              
                                   =   π(gh−1 , v)φ(hη) d(hg −1 ) = ∆G (g −1 )π g, I(v ⊗ φ)(η) .
                                      G

Thus we get a well-dened map       V ⊗ ˆ G C[Gξ] → Map(Gξ, V )∆ . Evaluation at ξ
                                                    ∆ ∼
denes a bornologial isomorphism Map(Gξ, V )          = Fix(Stab(ξ), V ). We laim
that the latter is isomorphi to V ⊗ ˆ G C[G/ Stab(ξ)]. Sine Stab(ξ) is ompat and
open, the Haar measure µStab(ξ) of Stab(ξ) is an element of H(G). Convolution on
the right with µStab(ξ) is an idempotent left module homomorphism on H(G), whose
range is C[G/ Stab(ξ)]. Sine V ⊗   ˆ G H(G) ∼ = V for all V , additivity implies that
V⊗ˆ G C[G/ Stab(ξ)] is equal to the range of µStab(ξ) on V , that is, to Fix(Stab(ξ), V ).
Thus we obtain an isomorphism V ⊗      ˆ G C[Gξ] ∼
                                                 = MapG (Gξ, V )∆ , whih an easily
be identied with the map I .
   Reall that a subset of Xn is ontrolled if and only if it meets only nitely many
                                                                  L
G-orbits. Therefore, we get the ounterpart C(Xn , V )∆ ∼      =      ξ∈X ′ Map(Gξ, V )
                                                                                        ∆
                                                                                             n
to (10). We an piee our isomorphisms on orbits together to an isomorphism
                                                                           Z
             ˆ G C[Xn ] → C(Xn , V )∆ ,
        I: V ⊗                                           v ⊗ φ 7→ [ξ 7→           π(g −1 , v)φ(gξ) dg].
                                                                              G
A straightforward omputation yields                     δ ◦ I(v ⊗ φ) = I(v ⊗ δφ) for             all   v ∈ V,
φ ∈ C[Xn ]     with       δ   as in (7). Therefore,                      ˆ G δ and δ .
                                                        I intertwines id ⊗                                  
                                ˆ , equipped with the diagonal representation of G.
           C• (X, V ) := C• (X) ⊗V
     Now let
Sine C• (X) arries the ne bornology, the underlying vetor spae of C[Xn ] ⊗ˆV
may be identied with the spae of funtions Xn → V with nite support.

Lemma 7. The hain omplex C• (X, V ) is a projetive resolution of V in Mod(G).
                      HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                              11


Proof.      The omplex      C• (X, V )           ˆ is exat on extensions with a
                                                  ⊗
                                          is exat beause
bounded linear setion. We have HomG (C[G/U ] ⊗   ˆ V, W ) ∼
                                                           = HomU (V, W ) for any
U ∈ CO(G) and any smooth representation W . Sine this is an exat funtor of W ,
        ˆ V is projetive. Equation (6) shows that C[Xn ] ⊗
C[G/U ] ⊗                                                   ˆ V is a diret sum of
suh representations and therefore projetive as well.                          
   We view        H(G)     as a bimodule over itself in the usual way, by onvolution on
the left and right. Sine right onvolution ommutes with the left regular repre-
                                         
sentation, the omplex         C• X, H(G)       is a omplex of   H(G)-bimodules. The same
reasoning as in the proof of Lemma 7 shows that it is a projetive          H(G)-bimodule
resolution of H(G).
   For V, W ∈ Mod(G), we let HomG (V, W ) be the spae of bounded G-equivariant
linear maps V → W , equipped with the equibounded bornology. It agrees with the
spae HomH(G) (V, W ) of bounded linear H(G)-module homomorphisms. We also
apply the bifuntor HomG to hain omplexes. In partiular, we an plug in the
projetive resolution C• (X, V ) of Lemma 7. The homotopy type of the resulting
ohain omplex of bornologial vetor spaes HomG (C• (X, V ), W ) is denoted by
                                                                            ˆ LG C,
R HomG (V, W ). Its nth ohomology vetor spae is ExtnG (V, W ). As with V ⊗
it is preferable to retain the ohain omplex itself.
   If   V   and   W                               C• (X, V ) = C• (X) ⊗ V with the
                      arry the ne bornology, then
ne bornology. Therefore,   R HomG (V, W ) is equal to the spae of all G-equivariant
linear maps C• (X) ⊗ V → W . Hene the Ext spaes above agree with the purely
algebrai Ext spaes. In more fany language, the embedding Modalg (G) → Mod(G)
indues a fully faithful funtor between the derived ategories Deralg (G) → Der(G).
This allows us to apply results proven using analysis in a purely algebrai ontext.


               4. Isoohomologial smooth onvolution algebras

   We introdue a lass of onvolution algebras on totally disonneted, loally
ompat groups        G.   These have the tehnial properties that allow us to formulate
the problem. Then we examine the notion of an isoohomologial embedding and
formulate a neessary and suient ondition for             H(G) → T (G)      to be isoohomo-
logial. This riterion involves the ontratibility of a ertain bornologial hain
omplex, whih is quite lose to the one that arises in [16℄.

4.1.    Unonditional smooth onvolution algebras with rapid deay.                      Let G
be a totally disonneted, loally ompat group. Let            σ : G → R≥1 be a sale with
the following properties:        σ(ab) ≤ σ(a)σ(b)    and   σ(a) = σ(a−1 ); σ is U -bi-invariant
for some     U ∈ CO(G);      the map  σ is proper,   that is, the subsets

(11)                              BR (G) := {g ∈ G | σ(g) ≤ R}
are ompat for all        R ≥ 1.   The usual sale on a redutive    p-adi   groups has these
properties. If the group       G    is nitely generated and disrete, then     σ = 1 + ℓ or 2ℓ
for a word-length funtion    ℓ are good, inequivalent hoies.
   Let    U ∈ CO(G). Given sets S, S ′ of funtions GU → C we say that S ′ domi-
nates    S if for any φ ∈ S there exists φ′ ∈ S ′ with |φ′ (g)| ≥ |φ(g)| for all g ∈ G.
Denition 8. Let T (G) be a bornologial vetor spae of funtions φ : G → C. We
all T (G) an unonditional smooth onvolution algebra of rapid deay if it satises
the following onditions:

8.1.    T (G) ontains H(G);
8.2.    H(G) is dense in T (G);
8.3. the onvolution extends to a bounded bilinear map      T (G) × T (G) → T (G);
8.4.    T (G) = lim T (GU ) as bornologial vetor spaes, where U runs through
                −→
        CO(G) and T (GU ) is the spae of U -bi-invariant funtions in T (G);
12                                            RALF MEYER


8.5. if a set of funtions       GU → C      is dominated by a bounded subset of             T (GU ),
       then it is itself a bounded subset of        T (GU );
8.6.   Mσ     is a bounded linear operator       on T (G).

The rst four onditions dene a             smooth onvolution algebra, the fth ondition
means that the onvolution algebra is          unonditional, the last one means that it has
rapid deay.
      An example of suh a onvolution algebra is the Shwartz algebra of a redutive
p-adi      group.
      Let   T (G)    be an unonditional smooth onvolution algebra of rapid deay.                  A
representation           π : G → Aut(V )   T (G)-tempered if its integrated form ex-
                                           is alled
tends to a bounded algebra homomorphism T (G) → End(V ) or, equivalently, to a
bounded bilinear map T (G) × V → V . The density of H(G) in T (G) implies that
this extension is unique one it exists. Furthermore, G-equivariant maps are T (G)-
module homomorphisms. Sine the subalgebras T (GU ) are unital, the algebra
                                                                                
T (G) is quasi-unital in the notation of [17℄, so that the ategory Mod T (G) of
essential bornologial left T (G)-modules is dened. This ategory is naturally iso-
morphi to the ategory of T (G)-tempered smooth representations of G (see [17℄).
                  
Thus Mod T (G) is a full subategory of Mod(G).
   The following lemmas prove some tehnial properties of T (G) that are obvious
in most examples, anyway. Dene PR : T (G) → H(G) by PR φ(x) = φ(x) for
x ∈ BR (G) and PR φ(x) = 0 otherwise, with BR (G) as in (11).
Lemma 9. limR→∞ PR (φ) = φ uniformly for φ in a bounded subset of T (G).
Proof. If T ⊆ T (G) is bounded, then T ⊆ T (GU ) for some U ∈ CO(G). Shrink-
ing U further, we ahieve that the sale σ is U -bi-invariant. We may further assume
that φ′ ∈ T whenever φ′ : GU → C is dominated by some φ ∈ T beause T (G) is
unonditional. Sine Mσ is bounded, the subset Mσ (T ) ⊆ T (GU ) is bounded as
                                             −1
well. For any φ ∈ T , we have |φ−PR φ| ≤ R      |Mσ φ|, so that φ−PR φ ∈ R−1 Mσ (T ).
This implies uniform onvergene PR (φ) → φ for φ ∈ T .                            
      In the following, we briey write

                                      T (G2 ) := T (G) ⊗
                                                       ˆ T (G).
Lemma 2 justies this notation for Shwartz algebras of redutive groups. In gen-
eral, onsider the bilinear maps

                           T (G) × T (G) → C,          (φ1 , φ2 ) 7→ φ1 (x)φ2 (y)
                     2
  (x, y) ∈ G
for                      . They extend to bounded linear funtionals on             T (G2 )   and hene
         2                                               2
map T (G ) to            a spae of smooth funtions on G .

Lemma 10. This representation of T (G2 ) by funtions on G2 is faithful, that is,
φ ∈ T (G2 ) vanishes one φ(x, y) = 0 for all x, y ∈ G.
Proof. The laim follows easily from Lemma 9 (this is a well-known argument
in onnetion with Grothendiek's Approximation Property).       If φ(x, y) = 0 for
allx, y ∈ G, then also (PR ⊗ ˆ PR )φ(x, y) = 0 for all R ∈ N, x, y ∈ G. Sine
   ˆ PR (φ) ∈ H(G2 ), this implies PR ⊗
PR ⊗                                  ˆ PR (φ) = 0 for all R ∈ N. Lemma 9 implies
        ˆ PR onverges towards the identity operator on T (G) ⊗
that PR ⊗                                                      ˆ T (G). This yields
φ = 0 as desired.                                                                
                            2                               2
   Hene we may view T (G ) as a spae of funtions on G . It is easy to see
         2                                            2         2
that T (G ) is again a smooth onvolution algebra on G . Equip G with the sale
σ2 (a, b) := σ(a)σ(b) for a, b ∈ G. Then the operator Mσ2 = Mσ ⊗ˆ Mσ is bounded,
              2                                                       2
that is, T (G ) also satises the rapid deay ondition. However, T (G ) need not
                      HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                13


be unonditional. We           assume T (G2 ) to be unonditional    in the following. This is
needed for the proof of our main theorem.
     Let   Tc (G)   be     H(G)
                      equipped with the subspae bornology from T (G). This
                                                           2        2
bornology is inomplete, of ourse. Similarly, we let Tc (G ) be H(G ) equipped
                                      2
with the subspae bornology from T (G ).


Lemma 11. The ompletions of               Tc (G)    and Tc (G2 ) are naturally isomorphi to
T (G) and T (G2 ).

Proof.     It sues to prove this for     Tc (G).    We verify by hand that    T (G)    satises
the universal property that denes the ompletion of               Tc (G).   Alternatively, we
ould use general haraterisations of ompletions in [14, Setion 4℄. We must show
that any bounded linear map            f : Tc (G) → W    into a omplete bornologial vetor
spae      W                                             T (G). By Lemma 9, the
               extends uniquely to a bounded linear map on
sequene of operators PR : T (G) → Tc (G) onverges uniformly on bounded subsets
towards the identity map on T (G). Hene any bounded extension f¯ of f satises
f¯(φ) = limR→∞ f ◦ PR (φ) for all φ ∈ T (G). Conversely, this presription denes a
bounded linear extension of f .                                                  

4.2.   Isoohomologial onvolution algebras.         Let A be a quasi-unital algebra
suh as        H(G)  T (G). In [17℄ I dene the exat ategory Mod(A) of essential
                      or
bornologial left A-modules and its derived ategory Der(A). A bounded algebra
homomorphism f : A → B between two quasi-unital bornologial algebras indues
            ∗                              ∗
funtors f : Mod(B) → Mod(A) and f : Der(B) → Der(A). Trivially, if f has
dense range then f : Mod(B) → Mod(A) is fully faithful. We all f isoohomo-
                      ∗

logial if f ∗ : Der(B) → Der(A) is fully faithful as well ([17℄). We are interested in
the embedding H(G) → T (G). If it is isoohomologial, we briey say that T (G)
is   isoohomologial.       The following onditions are proven in [17, Theorem 35℄ to be
equivalent to       T (G)   being isoohomologial:
                                                               
        • V⊗ ˆ LT (G) W ∼=V⊗ ˆ LG W for all V, W ∈ Der T (G) (reall that ⊗ˆ LH(G) ∼
                                                                                   =⊗ˆ LG );
                                                                            
        • R HomT (G) (V, W ) ∼   = R Hom G (V, W ) for all V, W ∈ Der T (G) ;
        • the funtor f ∗ : Der T (G) → Der(G) is fully faithful;
                                                       
        • T (G) ⊗  ˆ LG V ∼
                          = V for all V ∈ Mod T (G) ;
        • T (G) ⊗  ˆ L T (G) ∼
                      G      = T (G).
The last ondition tends to be the easiest one to verify in pratie. We will formulate
it more onretely below. The signs  ∼
                                      = in these statements mean isomorphism in
the homotopy ategory of hain omplexes of bornologial vetor spaes. This is
stronger than an isomorphism of homology groups.                 As a onsequene, we have
TorG       ) ∼
   n (V, W  = TorTn (G) (V, W ) and ExtnG (V, W ) ∼
                                                   = ExtnT (G) (V, W )         for all   V, W ∈
Mod T (G) if T (G) is isoohomologial.
     Notions equivalent to that of an isoohomologial embedding have been dened
independently by several authors, as kindly pointed out to me by A. Yu. Pirkovskii
(see [18℄ and the referenes given there). We warn the reader that in ategories of
topologial algebras some of the onditions above are no longer equivalent. Namely,
the ohomologial onditions in terms of the derived ategory and            R Hom are weaker
than the homologial onditions involving ⊗ ˆ L.
                                  V⊗
     We have seen in Setion 3 that  ˆG W ∼= (V ⊗ ˆ W)⊗ˆ G C for all V, W ∈ Mod(G),
          ˆ
where V ⊗ W is equipped with the diagonal representation of G. Sine V ⊗     ˆ W is
projetive if V or W is projetive, this implies an isomorphism


                                      ˆ LG W ∼
                                    V ⊗                ˆ LG C
                                                  ˆ W) ⊗
                                             = (V ⊗
14                                         RALF MEYER


for all   V, W ∈ Der(G).    Thus T (G) is isoohomologial if and only                      if
                                      L
                             ˆ T (G) ⊗
                       T (G) ⊗                        ˆ LG C ∼
                                      ˆ G C = T (G2 ) ⊗      = T (G).
Here we equip    T (G2 )   with the diagonal representation of                 G,   whih is given by
                                                                     −1
                              g · f (x, y) := ∆G (g)f (xg, g              y)
                               2
for all   g ∈ G, f ∈ T (G ), x, y ∈ G                 beause the left and right                 H(G)-module
strutures on  T (G) are the integrated               forms of the left regular representation             λ
and the    twisted   right regular representation         ρ · ∆G .   The onvolution map
                                    2                          ∗
                                         ˆ T (G) → T (G)
                          T (G ) = T (G) ⊗
                                         2 ˆ
desends to a bounded linear map T (G ) ⊗     G C → T (G). The latter map is a
bornologial isomorphism beause A ⊗  ˆA A ∼ = A for any quasi-unital bornologial
                                                                   2
algebra by [17, Proposition 16℄. Moreover, the onvolution map T (G ) → T (G) has
                                                                       2
a bounded linear setion, namely, the map T (G) → H G, T (G) ⊆ T (G ) dened
in (4).
                                                                      2 ˆL
  We may use the projetive resolution C• (X) → C to ompute T (G ) ⊗     G C.
                            2 ˆ                           2 ∆
Proposition 6 identies T (G ) ⊗ G C• (X) with C(X• , T (G )) . We augment this
hain omplex by the map

                                            id⊗G αˆ            ∗
(12)                 α : T (G2 ) ⊗
                                 ˆ G C[X0 ] −−−−→ T (G2 ) ⊗
                                                          ˆG C −
                                                               → T (G)
                                                               ∼               =

We let    ˜ • , T (G2 ))∆ be the subomplex of C(X• , T (G2 ))∆
          C(X                                                                            that we get if we
replae                       ˜ 0 , T (G2 ))∆ := ker α.
          C(X0 , T (G2 ))∆ by C(X
Proposition 12. T (G) is isoohomologial if and only if C(X
                                                           ˜ • , T (G2 ))∆ has a
bounded ontrating homotopy.
Proof. Our disussion of the onvolution map implies that the augmentation map
in (12) is a surjetion with a bounded linear setion. Hene it is a hain homo-
                       2 ˆL                                      ˜          2 ∆
topy equivalene T (G ) ⊗  G C → T (G) if and only if its kernel C(X0 , T (G )) is
ontratible.                                                                   
     To give the reader an idea why the various haraterisations of isoohomolog-
ial embeddings listed above are equivalent, we explain how the ontratibility
    ˜ • , T (G2 ))∆ yields isomorphisms R HomT (G) (V, W ) ∼
of C(X                                                       = R HomG (V, W ) for
                    
V, W ∈ Mod T (G) . Almost the same argument yields V ⊗       ˆ LT (G) W ∼  ˆ LG W .
                                                                        =V ⊗
The extension to objets of the derived ategories is a mere formality.
                   2
   The spae T (G ) arries a T (G)-bimodule struture via f1 ∗ (f2 ⊗ f3 ) ∗ f4 =
(f1 ∗ f2 ) ⊗ (f3 ∗ f4 ). This struture ommutes with the inner onjugation ation,
                       2 ˆ
so that P• := T (G ) ⊗     G C• (X) beomes a hain omplex of bornologial T (G)-
bimodules over T (G). As above, we an ompute these spaes expliitly:
                                           M                    
                              ˆ G C[Xn ] ∼
                      T (G2 ) ⊗          =   Fix Stab ξ, T (G2 ) .
                                               ξ∈Xn
                                                  ′


                                 2                                       2
                                                                                                  
It is not hard to see that T (G ) is a projetive objet of Mod T (G ) . That is,
     2                                                            2 ˆ
T (G ) is a projetive bimodule. Sine the summands of T (G ) ⊗G C[Xn ] are all
                2                        2 ˆ
retrats of T (G ), we onlude that T (G ) ⊗G C[Xn ] is a projetive T (G)-bimodule.
                                                                                  2
   Suppose now that P• is a resolution of T (G). Then it is a projetive T (G )-
bimodule resolution. Sine         T (G)   is projetive as a right module, the ontrating
homotopy of     P•   an be improved to onsist of bounded right                        T (G)-module   homo-
morphisms. Therefore,          ˆ T (G) V
                            P• ⊗            is again a resolution of               V.   Expliitly,
                                           M
                           ˆ T (G) V ∼
                        Pn ⊗         =                               ˆ V)
                                                  Fix(Stab(ξ), T (G) ⊗
                                           ξ∈Xn
                                              ′
                     HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                                        15


beause           ˆ T (G) V ∼
            T (G) ⊗         = V . The summands are retrats of the projetive left T (G)-
module            ˆ V . Hene P• ⊗
            T (G) ⊗                ˆ T (G) V is a projetive left T (G)-module resolution
of   V.   We use it to ompute

                                                         ˆ T (G) V, W ).
                       R HomT (G) (V, W ) = HomT (G) (P• ⊗
LetU ∈ CO(G) at on T (G) ⊗ˆ V by ∆G |U · ρ ⊗ π = ρ ⊗ π . If f : V → W is bounded
andU -equivariant, then φ ⊗ v 7→ φ ∗ f (v) denes a bounded G-equivariant linear
                 ˆ V ) → W . One an show that this establishes a bornologial
map Fix(U, T (G) ⊗
isomorphism

                                             ˆ V ), W ) ∼
                      HomT (G) (Fix(U, T (G) ⊗          = HomU (V, W ).
This yields a natural isomorphism
                                                               M
                                 ˆ T (G) V, W ) ∼
                    HomT (G) (Pn ⊗              =                    HomStab(ξ) (V, W ).
                                                           ξ∈Xn
                                                              ′


The right hand side no longer depends on    T (G)! Thus HomG (C• (X, V ), W ) is iso-
morphi to the same omplex, and    R HomT (G) (V, W ) ∼
                                                       = R HomG (V, W ) as asserted.
                                                   2 ∆                      2 ∆
   Next we simplify the hain omplex C(X• , T (G )) . To φ ∈ C(Xn , T (G ))      we
assoiate a funtion φ∗ : G×G×Xn → C by φ∗ (g, h, ξ) := φ(ξ)(g, h). This identies
C(Xn , T (G2 ))∆ with a spae of funtions on G2 ×Xn by Lemma 10. More preisely,
                                    2
we get the spae of funtions φ : G × Xn → C with the following properties:

          • supp φ ⊆ G2 × S for some ontrolled subset S ⊆ Xn ;
          • the funtion (a, b) 7→ φ(a, b, ξ) belongs to T (G2 ) for all ξ ∈ Xn ;
          • φ(ag, g −1 b, g −1 ξ) = φ(a, b, ξ) for all ξ ∈ Xn , g, a, b ∈ G (the two                      modular
            funtions anel).

The last ondition means that             φ   is determined by its restrition to {1} × G × Xn
by φ(a, b, ξ) = φ(1, ab, aξ).           Thus we identify   C(Xn , T (G2 ))∆ with the following
funtion spae on G × Xn :

Denition 13.         Let   C(G × Xn , T )       be the spae of all funtions               φ : G × Xn → C
with the following properties:

13.1.   supp φ ⊆ G × S for some ontrolled subset S ⊆ Xn ;
13.2. the funtion   (a, b) 7→ φ(ab, aξ) belongs to T (G2 ) for all ξ ∈ Xn .
A subset T ⊆ C(G × Xn , T ) is bounded if there is a ontrolled subset S ⊆ G suh
that supp φ ⊆ G × S for all φ ∈ T and if for any ξ ∈ Xn , the set of funtions
(a, b) 7→ φ(ab, aξ) for φ ∈ T is bounded in T (G2 ).
     The boundary map         δ   on   C(Xn , T (G2 ))∆    orresponds to the boundary map


     δ : C(G × Xn+1 , T ) → C(G × Xn , T ),
                                                 n+1
                                                 X             X
                     δφ(g, x0 , . . . , xn ) =         (−1)j         φ(g, x0 , . . . , xj−1 , y, xj , . . . , xn ).
                                                 j=0           y∈X

The augmentation map              C(X, T (G2 ))∆ → T (G)         orresponds to
                                                                              X
(13)                 α : C(G × X, T ) → T (G),                  αφ(g) =             φ(g, x).
                                                                             x∈X

The proofs are easy omputations, whih we omit. Let    ˜
                                                       C(G×X    0 , T ) ⊆ C(G×X0 , T )
                           ˜
be the kernel of α and let C(G × X• , T ) be the bornologial hain omplex that we
                                    ˜ × X0 , T ). Thus
get if we replae C(G × X0 , T ) by C(G

                                  ˜ × X• , T ) ∼
                                  C(G            ˜ • , T (G2 ))∆ .
                                               = C(X
16                                          RALF MEYER


     Smooth funtions of ompat support automatially satisfy both onditions in
Denition 13, so that       H(G) ⊗ C[Xn ] ⊆ C(G × Xn , T ).          These embeddings are om-
patible with the boundary and augmentation maps. Thus     H(G) ⊗ C̃• (X) beomes
a subomplex of   ˜ × X• , T ). We write C(G
                  C(G                     ˜ × X• , Tc ) and C(G × X• , Tc ) for the
hain omplexes H(G) ⊗ C̃• (X) and H(G) ⊗ C• (X) equipped with the inomplete
                                                       ˜
subspae bornologies from C(G× X• , T ). The omplex C(G×   X• , Tc ) is ontratible
beause C̃• (X) is. However, the obvious ontrating homotopy is unbounded.

Lemma 14. Suppose that there is a ontrating homotopy D for C̃• (X) suh that
idH(G) ⊗ D is bounded on C(G
                         ˜ × X• , Tc ). Then T (G) is isoohomologial.

Proof.We laim that C(G  ˜ × X• , T ) is            the ompletion of       ˜ × X• , Tc ).
                                                                            C(G                     Then
˜              ∼ ˜
C(G × X• , T ) = C(X• , T (G2 ))∆ inherits         a bounded ontrating homotopy beause
ompletion is funtorial. Proposition 12 yields that               T (G)   is isoohomologial. It
remains to prove the laim. We do this by reduing the assertion to Lemma 11.
Sine ˜ × X• , T ) is a diret summand in C(G × X• , T ), it sues to prove that
     C(G
C(G × X• , T ) is the ompletion of C(G × X• , Tc ). Reall that X•′ denotes a subset
of X• ontaining one point from eah G-orbit. The deomposition of X• into
G-orbits yields a diret-sum deomposition
                                        M                      
(14)                  C(G × X• , Tc ) ∼
                                      =   Fix Stab ξ, Tc (G2 ) ,
                                               ξ∈X•′

and a similar deomposition for          C(G × X• , T ).    Here diret sums are equipped with
the anonial bornology: a subset is bounded if it is ontained in and bounded in a
nite sub-sum. The reason for (14) is that a subset of              Xn   is ontrolled if and only if
it meets only nitely many        G-orbits.    Sine ompletion ommutes with diret sums,
the assertion now follows from Lemma 11.                                                              

           5. Contrating homotopies onstruted from ombings

     In order to apply Lemma 14, we have to onstrut ontrating homotopies of
C̃• (X).   For this we use the geometri reipes of [16℄.                The only ingredient is a
sequene of maps       pk : X → X       with ertain properties. We rst explain how suh
a sequene of maps gives rise to a ontrating homotopy                    D   of   C̃• (X).   Then we
formulate onditions on        (pk )   and prove that they imply boundedness of                D.

5.1. A reipe for ontrating homotopies. The onstrution of C• (X) and
C̃• (X) is natural:   a map f : X → X indues a hain map f∗ : C• (X) → C• (X) by
f∗ (x0 , . . . , xn ) := (f (x0 ), . . . , f (xn ) or, equivalently,
                                                       X
(15)                     f∗ φ(x0 , . . . , xn ) =             φ(y0 , . . . , yn ).
                                                yj : f (yj )=xj

   Sine α ◦ f∗ = α, this restrits to a hain map on C̃• (X). We have id∗ = id and
(f g)∗ = f∗ g∗ . Let p0 be be the onstant map x 7→ H for all x ∈ X . We laim
that (p0 )∗ = 0 on C̃• (X). On C[Xn ] for n ≥ 1 this is due to our onvention that
(x0 , . . . , xn ) = 0 if xi = xi+1 for some i. For φ ∈ C[X0 ], we get (p0 )∗ φ = α(φ) · (H),
where (H) ∈ C[X] is the harateristi funtion of H ∈ X . This implies the laim.
                           ′                                                      ′
   Given maps f, f : X → X , we dene operators Dj (f, f ) : C[Xn ] → C[Xn+1 ] for
j ∈ {0, . . . , n} by
                                                                                                       
(16)           Dj (f, f ′ ) (x0 , . . . , xn ) := f (x0 ), . . . , f (xj ), f ′ (xj ), . . . , f ′ (xn )
                    ′
                            Pn              j      ′
and let D(f, f ) :=           j=0 (−1) Dj (f, f ). It is heked in [16℄ that

                   [δ, D(f, f ′ )] := δ ◦ D(f, f ′ ) + D(f, f ′ ) ◦ δ = f∗′ − f∗ .
                        HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                                        17


Thus the hain maps              f∗   on    C̃• (X)    for   f : X → X are            all hain homotopi.               In
partiular,      D(id, p0 )    is a ontrating homotopy of          C̃• (X)          beause       (p0 )∗ = 0.
   However, this trivial ontrating homotopy does not work for Lemma 14. Instead,
we use a sequene of maps              (pk )k∈N with p0 as above and limk→∞ pk = id,                            that is,
for eah     x∈X        there is   k0 ∈ N suh that pk (x) = x for all k ≥ k0 . We let
                             Dk := D(pk , pk+1 ),             Djk := Dj (pk , pk+1 ).
Observe that       Djk vanishes on the basis vetor (x0 , . . . , xn ) unless pk (xj ) 6= pk+1 (xj ).
Therefore, all but nitely many summands of
                                                             ∞
                                                             X
                                                  D :=             Dk
                                                             k=0

vanish on any given basis vetor. Thus                    D   is a well-dened operator on                C• (X).
   The operator          D   is a ontrating homotopy of                C̃• (X)     beause

                 ∞
                 X                              ∞
                                                X
  [D, δ] =             [D(pk , pk+1 ), δ] =            (pk+1 )∗ − (pk )∗ = lim (pk )∗ − (p0 )∗ = id.
                                                                                     k→∞
                 k=0                            k=0
To verify this omputation, plug in a basis vetor and use that all but nitely many
terms vanish. This is the operator we want to use in Lemma 14.

5.2.    Suient onditions for boundedness.                               Construt           D   as above and let
D′ := idH(G) ⊗ D.              We want this to be a bounded operator on                               C(G × X• , Tc ).
For this, we impose three further onditions on                         (pk ).   First,   (pk )    should be a    omb-
ing.  This notion omes from geometri group theory and is already used in [16℄.
                                        ′
It allows us to ontrol the support of D φ for φ with ontrolled support. Seondly,
the ombing   (pk ) should be smooth. This allows us to ontrol the smoothness of
the funtions  (a, b) 7→ D′ φ(ab, aξ) on G2 for ξ ∈ Xn . Only the third ondition
involves the onvolution algebra T (G). It asks for a ertain sequene of operators
Tc (G) → Tc (G2 ) to be equibounded.
   The smoothness ondition is vauous for disrete groups. The third ondition is
almost vauous for           ℓ1 -Shwartz      algebras of disrete groups. Hene these two on-
ditions are not needed in [16℄. In our appliation to redutive groups, we onstrut
the operators       (pk )    using the retration of the ane Bruhat-Tits building of the
group along geodesi paths.                 This is a ombing beause Eulidean buildings are
CAT(0) spaes. Its smoothness amounts to the existene of ongruene subgroups.
The third ondition follows easily from Lemma 2.
   We now formulate the above onditions on                             (pk ) in detail and state the main
result. We use the relation ∼F for a nite subset                         F ⊆ X = G/H dened in (8) by
x ∼F y ⇐⇒ x−1 y ∈ HF H .
Denition 15.            A sequene of maps             (pk )k∈N    as above is alled a            ombing     of   X   if
it has the following additional two properties:

15.1. there is a nite subset               F ⊆ X       suh that        pk (x) ∼F pk+1 (x)           for all   k ∈ N,
        x ∈ X;
15.2. for any nite subset            F ⊆ X there is a nite subset F̄ ⊆ X                     suh that   pk (x) ∼F̄
        pk (y)   for all   k∈N        andx, y ∈ X with x ∼F y .
We say that the ombing has                 polynomial growth           (with respet to the sale           σ)   if the
least   k0   suh that     pk (gH) = gH        for all   k ≥ k0     grows at most polynomially in                    σ(g).
(This denition of growth diers slightly from the one in [16℄.)
                                                    
   We may view the sequene                   pk (x)    as a path from           H   to   x.   The onditions on a
ombing mean that these paths do not jump too far in eah step and that nearby
                                                  
elements have nearby paths                  pk (x) .
18                                                RALF MEYER


Denition 16.         A ombing            (pk )k∈G   of   G/H   is alled   smooth   if it has the following
two properties:

16.1. all maps    pk are H̃ -equivariant for some open subgroup H̃ ⊆ H ;
16.2. for any    U ∈ CO(G), there exists V ∈ CO(G) suh that aV b ⊆ U abU                               for all
         a, b ∈ G with pk (abH) = aH .
Denition 17.         Let      (pk )   be a smooth ombing of polynomial growth. Dene
                                                                   (
                                       2                               φ(ab)   ifpk (abH) = aH;
           Rk : Tc (G) → Tc (G ),                Rk φ(a, b) :=
                                                                       0       otherwise.


We say that       (pk )   is    ompatible with T (G)            if the sequene of operators          (Rk )   is
equibounded.

Theorem 18. Let G be a totally disonneted, loally ompat group and let T (G)
be an unonditional smooth onvolution algebra of rapid deay on G. Suppose also
that the funtion spae T (G2 ) on G2 is unonditional. If G/H for some ompat
open subgroup H ⊆ G admits a smooth ombing of polynomial growth that is om-
patible with T (G), then T (G) is isoohomologial.
5.3.   Proof of Theorem 18.
Lemma 19. Suppose that (pk ) is a ombing. Then for any ontrolled subset S ⊆ Xn
there is a ontrolled subset S̄ ⊆ Xn+1 suh that supp φ ⊆ S implies supp D(φ) ⊆ S̄
for all φ ∈ C[Xn ].
Proof.   Sine S is ontrolled, there is a nite subset F ⊆ X suh that xi ∼F xj for
all i, j ∈ {0, . . . , n}, (xi ) ∈ S . Sine (pk ) is a ombing, we an nd a nite subset
F̄ ⊆ X suh that pk (xi ) ∼F̄ pk+1 (xi ) and pk (xi ) ∼F̄ pk (xj ) for all k ∈ N and all
(xj ) ∈ S . Let F ′ := H F̄ H F̄ H ⊆ G/H . If x ∼F̄ y ∼F̄ z , then x ∼F ′ z . Hene
 pk (x0 ), . . . , pk (xj ), pk+1 (xj ), . . . , pk+1 (xn ) is ontrolled by F ′ for all (xi ) ∈ S .
                                                                                    ′
This means that all summands in D(x0 , . . . , xn ) are ontrolled by F .                        

      Hene   D′ := idH(G) ⊗ D          preserves ontrolled supports in            C(G × X• , Tc ).   We have
seen in (14) that
                                                       M                          
                            C(G × X• , Tc ) ∼
                                            =                 Fix Stab ξ, Tc (G2 ) .
                                                      ξ∈X•′

The isomorphism sends        φ : G × Xn → C to the family of funtions (φξ )ξ∈Xn′ dened
by    φξ (a, b) := φ(ab, aξ).Thus we may desribe any operator on C(G × X• , Tc ) by a
                                           ′     ′
blok matrix.      In partiular, we get D = (Dξη )ξ,η∈X ′ with ertain operators
                                                        •
                                                                     
                       ′
                     Dξη : Fix Stab η, Tc (G2 ) → Fix Stab ξ, Tc (G2 ) .
                   ′
The fat that D preserves ontrolled supports means that for xed η we have
Dξη = 0 for all but nitely many ξ . Thus the whole operator D′ is bounded if and
  ′
                                 ′
only if all its matrix entries Dξη are bounded.
                                             n+2
    For j, n ∈ N, n ≥ j , dene pjk : Xn → X     by
                                                                                               
            pjk (x0 , . . . , xn ) := pk (x0 ), . . . , pk (xj ), pk+1 (xj ), . . . , pk+1 (xn ) .
Then the operator         Djk : C[Xn ] → C[Xn+1 ] is given by
                                                 X
                                  Djk φ(ξ) =             φ(η).
                                                           η ∈ p−1
                                                                jk (ξ)
                      HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                              19

       ′                            ′                               ′
Let   Djk = idH(G) ⊗ Djk         Djk,ξη be the matrix entries of Djk with respet to
                                   and let
                                  ′
                                        P      Pn        j ′
the deomposition (14). Thus Dξη =        k∈N    j=0 (−1) Djk,ξη . Writing φξ (a, b) =
                       −1
φ(ab, aξ) and φη (ag, g b) = φ(ab, agη), we get
                                      X
         ′
(17) Djk,ξη ψ(a, b) =                                     ψ(ag, g −1 b)
                        {g ∈ G/ Stab(η) | pjk (agη) = aξ}
                                          Z
                                       −1
                          = vol(Stab η)                               ψ(ag, g −1 b) dg
                                           {g ∈ G | pjk (agη) = aξ}
                          2
                            
for ψ ∈ Fix Stab η, Tc (G ) . The right hand side of (17) makes sense for arbitrary
ψ ∈ Tc (G2 ) and extends Djk,ξη
                              ′                            2
                                  to an operator on Tc (G ). Now we x ξ, η until
further notie and sometimes omit them from our notation.
     Let   U ⊆ Stab(η)      be an open subgroup and              φ ∈ Tc (GU ). Let µU ∈ H(G) be
the normalised Haar measure of               U,   that is,   supp µU = U and µU (g) = vol(U )−1 for
g ∈ U.     Equation (17) yields

                 ′
     vol(Stab η)Djk,ξη (φ ⊗ µU )(a, b)
                  Z                                     (
                                                          φ(ab)                      if   pjk (abη) = aξ ;
      = vol(U )−1                            φ(ag) dg =
                   {g ∈ bU | pjk (agη) = aξ}              0                          otherwise.

Let   χj,ξη (a, b)   be the number of        k∈N      with    pjk (abη) = aξ   and let
                                                         n
                                                         X
                            χ(a, b) = χξη (a, b) :=            (−1)j χj,ξη (a, b).
                                                         j=0

These numbers are nite for any              a, b ∈ G    for the same reason that guarantees that
the sum dening         D   is nite on eah basis vetor. Dene

                 A = Aξη : Tc (G) → Tc (G2 ),                 Aφ(a, b) = χ(a, b) · φ(ab).
                                                   ′
Our omputation shows that             Aφ =       Dξη (φ⊗µU )·vol(Stab η) if    U    is an open subgroup
of   Stab η   and    φ ∈ Tc (GU ).
Lemma 20. The operator Dξη ′
                               is bounded if and only if Aξη is bounded.
Proof. The boundedness of Dξη′
                                implies that A is bounded on Tc (GU ) for                             su-
iently small      U and hene on all of Tc (G). Suppose onversely that A                     is bounded.
We turn       Tc (G2 ) into an (inomplete) bornologial right Tc (G)-module                   by

                                    (f1 ⊗ f2 ) ∗ f3 := f1 ⊗ (f2 ∗ f3 ).
This bilinear mapTc (G ) × Tc (G) → Tc (G2 ) is bounded beause the onvolution in
                               2
                                   ′                   ′
T (G) is bounded. The operators Djk,ξη   and hene Dξη are Tc (G)-module homo-
morphisms by (17). Let U ⊆ Stab(η) be open and φ1 , φ2 ∈ Tc (GU ). Then
                ′                ′
               Dξη (φ1 ⊗ φ2 ) = Dξη (φ1 ⊗ µU ) ∗ φ2 = vol(Stab η)−1 A(φ1 ) ∗ φ2 .
                                   ′
This implies the boundedness of Dξη beause                    U   is arbitrarily small and      A   and the
                 2
onvolution Tc (G ) → Tc (G) are bounded.                                                                    
Lemma 21. If the ombing is smooth, then for any U ∈ CO(G) there is V ∈ CO(G)
suh that A maps Tc (GU ) into Tc (G2 V 2 ).
Proof. Let a, b ∈ G. Clearly, χ(a, by) = χ(a, b) for y ∈ Stab(η). Sine pk is
H̃ -equivariant, so is pjk . Hene χ(ha, b) = χ(a, b) for h ∈ H̃ . Therefore, Aφ(ua, b) =
Aφ(a, b) = Aφ(a, bu) for φ ∈ Tc (GU ) provided U ⊆ H̃ ∩ Stab(η). Moreover, we
have Aφ(a, xb) = Aφ(ax, b) if x ∈ Stab(ξ).
    We may assume that the zeroth omponents η0 and ξ0 are H : any G-orbit
on Xn has suh a representative. Then pjk (abη) = aξ implies pk (abH) = aH . By
20                                           RALF MEYER


the denition of a smooth ombing, there is   V ∈ CO(G) suh that aV b ⊆ U abU
whenever        pjk (abη) = aξ    k ∈ N. Hene φ(avb) = φ(ab) for (a, b) ∈ supp χ
                                 for some
and v ∈ V . We may shrink V suh that V ⊆ Stab(ξ)∩U . Then χ(a, vb) = χ(a, b) =
χ(av, b) as well, so that A maps Tc (GU ) to Tc (G2 V 2 ).                   
     Denition 17 requires the following sequene of operators to be equibounded:
                                                             (
                                   2                             φ(ab)    if   pk (abH) = aH ;
            Rk : Tc (G) → Tc (G ),           Rk φ(a, b) :=
                                                                 0        otherwise.
                  P              −2
Hene      R :=       k∈N (k + 1)   Rk is bounded. We have         Rφ(a, b) = φ(ab)χ′ (a, b), where
                                                  X
                          χ′ (a, b) =                          (k + 1)−2 .
                                        {k ∈ N | pk (abH) = aH}
Now let     S ⊆ Tc (G)      be bounded. ThenS ⊆ Tc (GU ) for some U ∈ CO(G). We
have already found         V ∈ CO(G)           Aφ ∈ Tc (G2 V 2 ) for all φ ∈ Tc (GU ).
                                           suh that
Sine pointwise multipliation by the sale σ is bounded on Tc (GV ), it follows
                                 N      N                            2     2
that the set of funtions σ(a) σ(b) R(S) is bounded in Tc (G V ). We laim
           N     N                                                                   2
that σ(a) σ(b) R(S) dominates A(S) for suiently large N . Sine T (G ) is
unonditional, this implies the boundedness of A.
                                                                          ′ N
    Sine A and R are multipliation operators, the laim follows if χ σ        dominates
χj,ξη for any xed j, ξ, η . This is what we are going to prove. Let k0 (ab) be the
least k0 suh that pk (abηj ) = abηj for all k ≥ k0 . The polynomial growth of
                                                                 N
the ombing implies that k0 (ab) is dominated by Cσ(ab)             ≤ Cσ(a)N σ(b)N for
suiently large C, N . Sine ξj 6= ξj+1 , we have pjk (abη) ∈  / Gξ for k ≥ k0 . Hene,
                                                                              ′
if pjk (abη) = aξ , then k < k0 . We hoose the set of representatives X• suh that
                       ′
ξ0 = H for all ξ ∈ X• . Then pjk (abη) = aξ implies pk (abH) = aH . Therefore, for
                                                               2       2     ′
eah summand 1 in χj,ξη (a, b) there is a summand 1/(k+1) ≥ 1/k0 in χ (a, b). This
                                                    2 ′           2    2N
yields the desired estimate χj,ξη (a, b) ≤ k0 (a, b) χ (a, b) ≤ C σ(a)    σ(b)2N χ′ (a, b).
                                                                                         ′
Thus the operators Aξη are bounded for all ξ, η . This implies boundedness of Dξη
                                                      ′
by Lemma 20. By Lemma 19, it follows that D is bounded. Finally, Lemma 14
yields that T (G) is isoohomologial. This nishes the proof of Theorem 18.


                  6. A smooth ombing for redutive                      p-adi   groups

     The following theorem is the main goal of this setion. In addition, we prove a
variant (Theorem 28) that deals with the subategories of                       χ-homogeneous        repre-
sentations for a harater        χ : C(G) → U(1)      of the onneted entre of       G.
Theorem 22. The Shwartz algebra S(G) of a redutive p-adi group G is isoo-
homologial.
Proof. We are going to apply Theorem 18. Let σ be the standard sale as in the
denition of the Shwartz algebra and let  T (G) := S(G). The spae T (G2 ) is
                 ˆ
dened as T (G) ⊗ T (G). This notation is permitted beause of Lemma 2, whih
               ˆ S(G) with the Shwartz algebra of G2 (whih is again a redutive
identies S(G) ⊗
p-adi group). Clearly, the Shwartz algebras S(G) and S(G2 ) are unonditional
smooth onvolution algebras of rapid deay.
     We let     BT = BT (G)       be the    ane Bruhat-Tits building             of   G,   as dened in
[5, 23℄. This is a Eulidean building on whih               G   ats isometrially, properly, and
oompatly. Let         C(G) be   the onneted entre of        G,   so that the quotient
                                                                                                  G/C(G)
is semi-simple. In Setion 7, we will also use the variant               BT G/C(G)            of   BT (G),
whih we all the        semi-simple ane Bruhat-Tits            building of G.
     Let   G◦   be the onneted omponent of      G as an algebrai group. Thus G◦ is a
redutive group and        G is a nite extension of G◦ . Inspetion of the denition in [23℄
                    HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                                21


shows that the buildings for          G   and   G◦ are equal. We remark that it is not hard to
redue the ase of general redutive             p-adi groups to the speial ase of onneted
semi-simple groups, or even onneted simple groups. At rst I followed this route
myself. Eventually, it turned out that this intermediate step is unneessary beause
all arguments work diretly in the generality we need.
   Let   ξ0 ∈ BT , H := Stab(ξ0 ),         and X := G/H . We have H ∈ CO(G), and X may
be identied with the disrete subset            Gξ0 ⊆ BT . We need a ombing of X . As
a preparation, we onstrut a             ombing of BT , using that Eulidean buildings are
CAT(0) spaes, that is, have non-positive urvature (see [4, 5℄). In partiular, any
two points in     BT   are joined by a unique geodesi. For                ξ ∈ BT ,   let

                            p(ξ) : [0, d(ξ, ξ0 )] → BT ,             t 7→ pt (ξ),
be the unit speed geodesi segment from                   ξ0   to   ξ;   extend this by    pt (ξ) := ξ      for
t > d(ξ, ξ0 ).   Restriting to      t ∈ N,   we get a sequene of maps             pk : BT → BT .
Lemma 23. The maps pk for k ∈ N form a ombing of linear growth of BT .
                                                                            
   This means     d pk (ξ), pk (η) ≤ R · d(ξ, η) + R and d pk (ξ), pk+1 (ξ) ≤ R for all
ξ, η ∈ BT , k ∈ N, for some R > 0. Linear growth means that the least k0 suh that
pk (ξ) is onstant for k ≥ k0 grows at most linearly in d(ξ, ξ0 ).
                                          
Proof. By onstrution, d ps (ξ), pt (ξ) ≤ |t − s| for all s, t ∈ R+ , ξ ∈ BT , and ps (ξ)
is onstant for s ≥ d(ξ, ξ0 ). The lemma follows if we prove the following laim:
                
d pt (ξ), pt (η) ≤ d(ξ, η) for all ξ, η ∈ BT , t ∈ R+ .
    Fix ξ, η ∈ BT and t ∈ R+ . We may assume d(ξ, ξ0 ) ≥ d(η, ξ0 ) (otherwise
                                                                                     ∗
exhange ξ and η ) and d(ξ, ξ0 ) ≥ t (otherwise pt (ξ) = ξ and pt (η) = η ). Let d be
                                         2        ∗     ∗                  2
the usual at Eulidean metri on R . Let ξ and η be points in R with

         d∗ (ξ ∗ , 0) = d(ξ, ξ0 ),        d∗ (η ∗ , 0) = d(η, ξ0 ),         d∗ (ξ ∗ , η ∗ ) = d(ξ, η).
The CAT(0) ondition means that distanes between points on the boundary of the
geodesi triangle (ξ, η, ξ0 ) are dominated by the distanes between the orrespond-
                                           ∗ ∗
ing points in the omparison triangle (ξ , η , 0). Here the point pt (ξ) orresponds
                   ∗           ∗
to the point pt (ξ) on [0, ξ ] of distane t from the origin. The point pt (η) or-
                               ∗
responds to the point pt (η) of distane min{t, d(η, ξ0 )} from the origin. An easy

                                                      η∗
                                                  ✑❏
                                        ∗ ✑
                                              ✑ ❅      ❇
                                 pt (η) ❇                ❇❏❅
                                      ✑                   ❇ ❏❅
                                     ✑        ❇
                                ✑ ❇                        ❇ ❏❅
                             ✑        ❇         ❇
                            ✑❇                    ❇         ❇ ❏ ❅
                        ✑      ❇        ❇                    ❇ ❏ ❅
                       ✑❇                ❇         ❇
                     ✑           ❇                   ❇        ❇   ❏ ❅
                    ✑❇    ❇                ❇                   ❇   ❏  ❅
                                  ❇                    ❇
                  0✑ ❇     ❇       ❇        ❇
                                                  ∗
                                                                ❇   ❏  ❅ ξ∗
                                          pt (ξ)
                               Figure 1. A omparison triangle


omputation or a glane at Figure 1 shows                 d∗ (pt (ξ)∗ , pt (η)∗ ) ≤ d∗ (ξ ∗ , η ∗ ).    By the
CAT(0) ondition, this implies            d pt (ξ), pt (η) ≤ d(ξ, η).                                        
   We identify G/H with the orbit Gξ0 ⊆ BT . Sine the group ation is oompat,
                                                            ′                ′
there is some R > 0 suh that for any ξ ∈ BT there exists ξ ∈ Gξ0 with d(ξ, ξ ) < R.
          ′                                         ′
                                                                
We let pk (ξ) for ξ ∈ BT be a point in Gξ0 with d pk (ξ), pk (ξ) < R. We laim that
any suh hoie denes a ombing of G/H .
                                                                ′
   If we equip Gξ0 with the metri d from BT , the maps pk on Gξ0 still form a
ombing in the metri sense beause they are lose to the ombing                              (pk ).    The
22                                             RALF MEYER


subspae metri from          BT   and the relations     ∼F   in Denition 15 generate the same
oarse geometri struture on             X.         R > 0 there is a nite subset
                                               That is, for any
F ⊆ X       suh thatd(x, y) ≤ R implies x ∼F y , and for any nite subset F ⊆ X
there is    R > 0 suh that x ∼F y implies d(x, y) ≤ R. This is easy to verify by
hand. Alternatively, it follows from the uniqueness of oarse strutures mentioned
                              ′
after Denition 15. Hene (pk ) is a ombing of G/H in the sense we need.
   We also need the ombing to be smooth. To get this, we must hoose the base
                                   ′
point ξ0 and the approximations pk (ξ) more arefully. This requires some geometri
fats about the apartments in the building. Let                K    be the non-Arhimedean loal
eld over whih        G   is dened. Let      S ⊆G     be a maximal      K -split   torus of   G.   We
do not distinguish in our notation between the algebrai groups S and G and their
                                                    ∗
loally ompat groups of K -rational points. Let X (S) and X∗ (S) be the groups
of algebrai haraters and oharaters of S , respetively. The R-vetor spae
A := X∗ (S) ⊗ R is the basi apartment of (G, S).
              ∗
   Let Φ ⊆ X (S) be the set of roots of G relative to S . Choose a simple system
of roots ∆ ⊆ Φ and let A+ ⊆ A be the orresponding losed Weyl hamber:

                             A+ := {x ∈ A | α(x) ≥ 0        for all   α ∈ ∆}.
Let    W   be the   Weyl group                  Φ. It is the Coxeter group generated
                                   of the root system
by orthogonal reetions in the hyperplanes      α(x) = 0 for α ∈ ∆. The positive
one A+ is a fundamental domain for this ation, that is, W (A+ ) = A (see [10℄).
   Let Z ⊆ G be the entraliser of S . There is a anonial homomorphism ν : Z → A
(see [23, (1.2)℄). Its kernel is ompat and its range is a lattie Λ ⊆ A; that is, Λ
is a disrete and oompat subgroup of A. Moreover, let Λ+ := Λ ∩ A+ . Sine Λ
is free Abelian, we an lift it to a subgroup of Z and view Λ ⊆ Z ⊆ G. Let Φaf
be the set of ane roots as in [23, (1.6)℄. These are ane funtions α : A → R of
the form α(x) = α0 (x) + γ with α0 ∈ Φ and ertain γ ∈ R. Reall that Φ ⊆ Φaf
and that Φaf is invariant under translation by Λ. The subsets of A of the form
{x ∈ A | α(x) = 0} and {x ∈ A | α(x) ≥ 0} for α ∈ Φaf are alled walls and
half-apartments, respetively.
   We dene the losure cl(Ω) ⊆ A of a non-empty subset Ω ⊆ A as the intersetion
of all losed half-apartments ontaining            Ω   (see [5, (7.1.2)℄). We laim that

(18)                                 cl({0, ξ}) = A+ ∩ (ξ − A+ )
for allξ ∈ Λ+ . Let B := A+ ∩ (ξ − A+ ). This is an intersetion of half-apartments
ontaining  0 and ξ beause Φ ∪ (ξ − Φ) ⊆ Φaf . Hene cl({0, ξ}) ⊆ B . It remains
to show that any half-apartment C ontaining 0 and ξ also ontains B . Let C be
dened by the equation α ≥ 0 for some ane root α with linear part α0 ∈ Φ. We
distinguish the ases α0 > 0 and α0 < 0. If α0 > 0, then α(x) = α0 (x) + α(0) ≥
α0 (x) is non-negative on A+ ; if α0 < 0, then α(ξ − x) = −α0 (x) + α(ξ) ≥ −α0 (x)
is non-negative on A+ , so that α is non-negative on ξ − A+ . Thus B ⊆ C in either
ase. This nishes the proof that cl({0, ξ}) = B .

Lemma 24. There is R > 0 suh that for all ξ ∈ Λ+ and all η ∈ cl({0, ξ}), there
is η′ ∈ Λ ∩ cl({0, ξ}) with d(η, η′ ) ≤ R.
Proof.     Let   ∆ = {α1 , . . . , αs }   be the system of simple roots that determines              A+ .
If   G   is semi-simple, these roots form a basis of           A.     In general, they are linearly
independent, so that we an extend them to a basis by ertain αj for s < j ≤ r.
                                               r
Dene a vetor spae isomorphism γ : A → R by γ(η)j = αj (η) for j = 1, . . . , r.
                                           r
This identies A+ with the set of (xj ) ∈ R with xj ≥ 0 for 1 ≤ j ≤ s. Equation (18)
identies    B := cl({0, ξ})     with

                      γ(B) = {(xj ) ∈ Rr | 0 ≤ xj ≤ γ(ξ)j , j = 1, . . . , s}.
                  HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                    23

                                                          r
  We may assume αj ∈ X∗ (S) ⊗ Q ⊆ A, so that γ(Λ) ⊆ Q . Replaing γ by
 −1               ∗                  r
n γ for some n ∈ N , we an ahieve Z ⊆ γ(Λ). Hene if (xj ) ∈ γ(B), then the
trunated vetor    ⌊(xj )⌋ := (⌊xj ⌋) belongs to γ(B ∩ Λ).      It satises   |xj − ⌊xj ⌋| < 1
for all  j . Sine the norm kγ(η)k∞ is equivalent to the         Eulidean norm on       A, we
have   d(γ −1 ⌊γ(η)⌋, η) < R for all η ∈ B for some R > 0.                                   

   The building   BT   an be dened as the quotient of     G×A by a ertain equivalene
relation. We may view     gA for g ∈ G as a subspae of BT ; these are the apartments
of BT . We now hoose ξ0 to be the origin in A ⊆ BT . Reall that H ⊆ G denotes
the stabiliser of ξ0 . We have the Cartan deomposition G = HΛ+ H by [23, (3.3.3)℄,
so that Gξ0 = HΛ+ ξ0 . Let G◦ ⊆ G be the onneted omponent of the identity (as
an algebrai variety) and let H◦ := H ∩ G◦ . These are open normal subgroups of
nite index in G and H , respetively, and BT (G) is isomorphi to BT (G◦ ) equipped
with a anonial ation of G.
              ′
   Choose Λ+ ⊆ Λ+ to ontain one representative for eah H -orbit in Gξ0 . Fix
      ′
ξ ∈ Λ+ and k ∈ N. We further deompose Hξ as a disjoint union of nitely many
H◦ -orbits H◦ hj ξ = hj H◦ ξ for suitable h1 , . . . , hN ∈ H . We let p′k (ξ) be some point
in Λ ∩ cl({0, ξ}) ⊆ A ⊆ BT that has minimal distane from pk (ξ).

Proposition 25. Let Ω ⊆ A ⊆, Ω 6= ∅. If g ∈ G◦ satises gx = x for all x ∈ Ω,
then gx = x for all x ∈ cl(Ω). (This may fail if we allow g ∈ G.)
Proof. The proof requires some fats about stabilisers of points in BT , whih are
onveniently summarised in [20, Setion I.1℄. The subgroups          PΩ ⊆ G◦     dened there
manifestly satisfy   PΩ = Pcl(Ω) .   This implies our laim beause

                            PΩ = {g ∈ G◦ | gx = x ∀x ∈ Ω}.                                     
                                         ′                  ′
   Proposition 25 allows us to dene pk (hj h◦ ξ) := hj h◦ pk (ξ) for all h◦ ∈ H◦ . Let-
ting  ξ, j vary, we get a map p′k : Gξ0 → Gξ0 . It is H◦ -equivariant beause H◦
is normal in H . Sine pk (ξ) ∈ cl({0, ξ}), Lemma 24 yields R > 0 suh that
                 
d pk (ξ), p′k (ξ) ≤ R for all k ∈ N, ξ ∈ Λ′+ . The same holds for ξ ∈ Gξ0 be-
                                                                              ′
ause pk is H -equivariant and G ats isometrially on BT . Moreover, p0 (ξ) = ξ0
       ′                                  ′
and pk (ξ) = ξ for k ≥ d(ξ, ξ0 ). Thus (pk ) is a ombing of G/H of linear growth.

Lemma 26. The ombing (p′k ) is smooth.
Proof. There is a dereasing sequene (Un )n∈N         in CO(G) suh          that eah   Un   is
normal in   H   and an be written as    Un+ · Un− = Un− · Un+ with
(19)                         λUn+ ⊆ Un+ λ,        Un− λ ⊆ λUn−
for all λ ∈ Λ+ (see [20, Setion I.2℄). Let a, b ∈ G satisfy p′k (abH) = aH . Write
ab = h1 λh2 with h1 , h2 ∈ H , λ ∈ Λ′+ , and h1 hosen as arefully as above if G is
                                ′
disonneted. Then a = h1 pk (λ)h3 with the same h1 and some h3 ∈ H . Hene
       −1 ′
b = h3 pk (λ) λh2 . Sine pk (λ) ∈ cl({0, λ}), equation (18) yields p′k (λ) ∈ Λ+ and
               −1             ′

p′k (λ)−1 λ ∈ Λ+ . Using (19) and that Un is normal in H , we get

  aUn b = h1 p′k (λ)Un+ Un− p′k (λ)−1 λh2 ⊆ h1 Un+ p′k (λ)p′k (λ)−1 λUn− h2
                                             ⊆ h1 Un λUn h2 = Un h1 λh2 Un = Un abUn .
                   ′
Thus the ombing (pk ) is smooth in the sense of Denition 16.                                 

   Finally, the ompatibility ondition of Denition 17 is easy to hek using the
expliit desription ofS(G2 ) in Lemma 2. In order to over also the Shwartz
algebras for disrete groups, whih are dened by        ℓ1 -estimates,   we dene spaes

                     Lσp (G) := {f : G → C | f · σ k ∈ Lp (G) ∀k ∈ N}
24                                        RALF MEYER


for all1 ≤ p < ∞, and equip them with the evident bornology: a subset T ⊆ Lσp (G)
                                                                    k
is bounded if and only if for any k ∈ N there is Ck suh that kf · σ kLp (G) ≤ Ck for
                 σ                                                          σ
all f ∈ T . Let Lp (GU ) be the subspae of U -bi-invariant funtions in Lp (G).
   For p = 2, this agrees with the previous denition, so that Lemma 2 yields

                S(G) = lim Lσ2 (GU ),      S(G2 ) = lim Lσ2 (G2 U 2 ).
                         −→                           −→
Lemma 27. Let (pk ) be a ombing of polynomial growth on G/H . Then the se-
quene of operators (Rk ) used in Denition 17 is uniformly bounded as operators
Lσp (G) → Lσp (G2 ). Here we use the sale σ(a, b) := σ(a)σ(b) on G2 .
Proof.               W φ(x, y) := φ(x, x−1 y) is an isometry of Lp (G2 ). It is also
          The operator
                                             2
suiently ompatible with the sale on G for W and its inverse to be bounded
                     σ   2
linear operators on Lp (G ). We have Rk φ(a, b) = φ(ab)1pk (abH) (a), where 1pk (abH)
denotes the harateristi funtion of pk (abH) ⊆ G. Hene

                                W Rk φ(x, y) = φ(y) · 1pk (yH) (x).
                                                                 
Sine the ombing      (pk )   has polynomial growth,   σ pk (yH)        is ontrolled by a poly-
nomial in    σ(y).   The boundedness of       W ◦ Rk   is now immediate beause all osets
xH     have volume   1.   This implies the boundedness of       Rk .                              
                        ′
   Sine the ombing (pk ) is smooth, for any U ∈ CO(G) there exists V ∈ CO(G)
                                        2   2
suh that Rk maps Tc (GU ) into Tc (G V ). Together with Lemma 27 for p = 2,
                                ′
this yields that the ombing (pk ) is ompatible with S(G) in the sense of Deni-
tion 17. We have now veried all the hypotheses of Theorem 18. Thus S(G) is
isoohomologial.                                                                                 
6.1.   Deomposition with respet to the entre of G.       As before, we let G
be a redutive  p-adi group. Let C(G) ⊆ G be the onneted entre of G and
let χ : C(G) → U(1) be a unitary harater on C(G). Let Modχ (G) be the full
subategory of Mod(G) whose objets are the representations π : G → Aut(V ) that
satisfy π(z) = χ(z)idV for all z ∈ C(G). Let
                                             
                     Modχ S(G) := Mod S(G) ∩ Modχ (G)
be the subategory of tempered representations in  Modχ (G). The lass
                                                                     of exten-
sions with a bounded linear setion turns  Modχ (G) and Modχ S(G) into exat  
ategories, so that we an form the derived ategories Derχ (G) and Der χ S(G) .
Let Gss := G/C(G), this is again a redutive p-adi group. If χ = 1, then
                                                        
Modχ (G) = Mod(Gss ) and Modχ S(G) = Mod S(Gss ) . In general, there are
quasi-unital bornologial algebras Hχ (G) and Sχ (G) suh that
                                                                  
            Modχ (G) ∼
                     = Mod Hχ (G) ,       Modχ S(G) ∼   = Mod Sχ (G) .
We briey reall their well-known denitions.           A C(G)-invariant subset of G is
alled    C(G)-ompat      if its image in Gss is ompat. Let Hχ (G) be the spae
of loally onstant funtions f : G → C with C(G)-ompat support suh that
f (z −1 g) = χ(z)f (g) for all g ∈ G, z ∈ C(G). If f1 , f2 ∈ Hχ (G), then the funtion
h 7→ f1 (h)f2 (h−1 g) is C(G)-invariant, so that
                                          Z
                           f1 ∗ f2 (g) :=      f1 (h)f2 (h−1 g) dh
                                              Gss

makes sense; here     dh   denotes the Haar measure on         Gss .   This turns   Hχ (G)   into an
algebra, whih we equip with the ne bornology.
        σ
   Let L2 (G)χ be the spae of funtions f : G → C that satisfy             f (z −1 g) = χ(z)f (g)
for all   g ∈ G, z ∈ C(G),     and suh that   zg 7→ |f (g)|   is an element of   Lσ2 (Gss ). Let
                                    Sχ (G) := lim Lσ2 (GU )χ
                                              −→
                   HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                              25


where    U   runs through the set of ompat open subgroups with           U ∩ C(G) ⊆ ker χ.
The same estimates as for        S(Gss ) show   that the onvolution on    Hχ (G) extends to
a bounded multipliation        on Sχ (G).
  Consider the map
                                                          Z
                  ρ : H(G) → Hχ (G),          ρf (g) :=          χ(z)f (zg) dz.
                                                          C(G)

For appropriately normalised Haar measures, this is a surjetive, bounded algebra
homomorphism; that is,   Hχ (G) is a quotient algebra of H(G). Using ρ, we an pull
bak   Hχ (G)-modules     H(G)-modules. This onstrution maps essential modules
                           to
again to essential modules (ρ is a proper morphism in the notation of [17℄). Thus
                        ∗
                                                                             ∗
we have got a funtor ρ : Mod Hχ (G) → Mod H(G) . Sine ρ is surjetive, ρ is
                                
fully faithful. Thus Mod Hχ (G) beomes a full subategory of Mod(G). It is easy
to identify this subategory with Modχ (G). If (V, π) ∈ Modχ (G), then V beomes
an essential Hχ (G)-module by
                                      Z
                             π(f ) :=      f (g)π(g) dg.
                                             Gss

                        f (gz)π(gz) = f (g)π(g) for all g ∈ G, z ∈ C(G).
This is well-dened beause
                                                            S
  We an extend ρ to a bounded algebra homomorphism ρ : S(G) → Sχ (G).
         S
The map ρ has a bounded linear setion and its kernel is the losure of ker ρ ⊆
H(G).    Therefore, bounded algebra homomorphisms        Sχ (G) → End(V ) orrespond
to bounded algebra homomorphisms            S(G) → End(V ) whose restrition to H(G)
vanishes on     ker ρ.    Equivalently,   Mod Sχ (G) ∼
                                                     = Mod S(G) ∩ Modχ (G). Thus
Hχ (G)   and   Sχ (G)    have the required properties.

Theorem 28. The embedding Hχ (G) → Sχ (G) is isoohomologial.
Proof.   Let   Hχ (G)op                         Hχ (G), so that Mod(Hχ (G)op ) is
                           be the opposite algebra of
the ategory of right Hχ (G)-modules. Sine Hχ (G)
                                                      op ∼
                                                         = Hχ−1 (G), we have an
                                       op ∼
isomorphism of ategories Mod(Hχ (G) ) = Modχ−1 (G).
                            op
                                                 
   Equip X ∈ Mod(Hχ (G) ), V ∈ Mod Hχ (G) with the assoiated representa-
tions of G. We equip X ⊗   ˆ V with the diagonal representation. Sine χ and χ−1
                                 ˆ V . Thus we obtain a bifuntor
anel, C(G) ats trivially on X ⊗
                                        
(20)      Mod(Hχ (G)op ) × Mod Hχ (G) → Mod(Gss ),                      ˆ V.
                                                           (X, V ) 7→ X ⊗
This funtor is evidently exat for extensions with a bounded linear setion. More-
over, we laim that       ˆV
                         X⊗is projetive if X or V are projetive. It sues to treat
the ase where   X is projetive. We may even assume that X is a free essential
module X0 ⊗  ˆ Hχ (G). The diagonal representation on X0 ⊗    ˆ Hχ (G) ⊗ ˆ Y is isomor-
                                                          ˆ      ˆ
phi to the regular representation ρg ⊗ 1 ⊗ 1 on H(Gss ) ⊗ X0 ⊗ Y . The intertwining
operator is given by Φ(x ⊗ f ⊗ y)(g) := f (g)x ⊗ gy for all g ∈ G; this funtion only
depends on the lass of g in Gss .
                                               
                        op
  Let X ∈ Mod(Hχ (G) ), V ∈ Mod Hχ (G) . Then X ⊗           ˆ Hχ (G) V is dened as the
quotient of X ⊗ ˆ V by the losed linear span of x ∗ f ⊗ v − x ⊗ f ∗ v for x ∈ X ,
f ∈ Hχ (G), v ∈ V . Sine ρ : H(G) → Hχ (G) is surjetive, this is the same as
X⊗ ˆ H(G) V , whih we have identied with X ⊗   ˆ G V in Setion 3. Thus
                                 ˆ Hχ (G) V ∼
                                X⊗             ˆ Gss (X ⊗
                                            = C⊗        ˆ V ).

The same assertion holds for the total derived funtors beause the bifuntor in (20)
is exat and preserves projetives. Espeially, we get
                                                                  
                           ˆ LH (G) Sχ (G) ∼
                    Sχ (G) ⊗                  ˆ LG Sχ (G) ⊗
                                           = C⊗           ˆ Sχ (G) .
                               χ                  ss
26                                      RALF MEYER


Here          ˆ Sχ (G) is equipped with the inner onjugation ation of Gss . We
       Sχ (G) ⊗
                ˆ Sχ (G) ∼
identify Sχ (G) ⊗        = Sχ×χ (G × G) as in Lemma 2. By [17, Theorem 35.2℄, the
embedding Hχ (G) → Sχ (G) is isoohomologial if and only if Sχ (G) ⊗ ˆ LH (G) Sχ (G)
                                                                          χ
is a resolution of Sχ (G). Thus the assertion that we have to prove is equivalent to

                               ˆ LG Sχ×χ (G × G) ∼
                              C⊗                 = Sχ (G).
                                   ss


We already know C⊗ˆ LGss S(Gss × Gss ) ∼
                                       = S(Gss ) beause S(Gss ) is isoohomologial
(Theorem 22) and this ondition is equivalent to S(Gss ) being isoohomologial.
  Now we hoose a ontinuous setion s : Gss → G; this is possible beause G is
totally disonneted. It yields bornologial isomorphisms

       Ψ′ : Sχ (G) → S(Gss ),                     Ψ′ f (g) := f ◦ s(g),
                                                                                  
        Ψ : Sχ×χ (G × G) → S(Gss × Gss ),        Ψf (g, h) := f s(g), s(g)−1 s(gh) .
The isomorphism      Ψ intertwines the inner onjugation ations of Gss on Sχ×χ (G×G)
and    S(Gss × Gss ). Thus we get isomorphisms
                 L                       L
(21)          ˆ G Sχ×χ (G × G) ∼
             C⊗                   ˆ G S(Gss × Gss ) ∼
                               = C⊗                 = S(Gss ) ∼
                                                              = Sχ (G).
                 ss                  ss

It is easy to see that the omposite isomorphism is indued by the onvolution map
in   Sχ (G).                                                                           

                     7. Appliations to representation theory

     Let   G be a redutive p-adi group, let C(G) be its entre, and let Gss := G/C(G).
So far we have used very large projetive        H(G)-module resolutions, whih oer
great exibility for writing down ontrating homotopies. Now we onsider muh
smaller projetive resolutions, whih are useful for expliit alulations. We write
Mod(χ) (G)     if it makes no dierene whether we work in      Mod(G) or Modχ (G) for
some harater       χ : C(G) → U(1).   Similarly, we write   H(χ) (G) and S(χ) (G). The
atual appliations of our main theorem are ontained in Setions 7.1, 7.7 and 7.8.
The other subsetions ontain small variations on known results. Our presentation
diers somewhat from the aounts in [20, 25℄ beause we want to exhibit onne-
tions with     K-theory   and assembly maps.


7.1. Cohomologial dimension. Let rk G = dim BT (G) be the rank of G.
Theorem 29. The ohomologial dimensions of the exat ategories Mod(G) and
Mod S(G) are (at most) rk G; that is, any objet has a projetive resolution of
length rk G. Similarly, the ohomologial dimensions of Modχ (G) and Modχ S(G)
for a harater χ : C(G) → U(1) are at most rk Gss .
Proof. The assertions are well-known for Mod(G) and Modχ (G). For the proof,
equip BT = BT (G) with a CW-omplex struture for whih G ats by ellular maps.
Then the ellular hain omplex     C• (BT ) is a projetive H(G)-module resolution
of the trivial representation of length rk G. The hain omplex C• (BT ) ⊗ˆ V with
the diagonal representation of G is a projetive H(G)-module resolution of V for
arbitrary V ∈ Mod(G). If V ∈ Modχ (G), we use the building BT (Gss ) instead;
             
C• BT (Gss ) ⊗  ˆ V is a projetive resolution of V in Modχ (G).
                                                                                 
   What is new is that we get the same assertions for Mod S(G) and Mod Sχ (G) .
Sine the argument is the same in both ases, we only write it down for S(G). Let
                 
V ∈ Mod S(G) and let P• → V be a projetive resolution in Mod(G) of length
rk G. Then S(G) ⊗  ˆ G P• has the homotopy type of

(22)                              ˆ LG V ∼
                             S(G) ⊗             ˆ LS(G) V ∼
                                         = S(G) ⊗         =V
                     HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                                     27


beause    S(G)     is isoohomologial (Theorem 22); here we use one of the equiva-
lent haraterisations of isoohomologial embeddings listed in Setion 4.2. Equa-
tion (22) means that              ˆ G P•
                             S(G) ⊗             is a resolution of       V.    This resolution is projetive
and has length       rk G.                                                                                         
                                               rk G
   Conversely, there is V ∈ Mod(G) with ExtG (V, V ) 6= 0. Hene the ohomo-
logial dimension of Mod(G) is equal to rk G. We an even take V tempered and
                        rk G
irreduible. Hene ExtS(G) (V, V ) 6= 0 as well beause S(G) is isoohomologial.
                 
Thus     Mod S(G)       also has ohomologial dimension equal to
                                                                                            rk G.    Similarly, the
ohomologial dimension of           Modχ (G)         and    Modχ S(G)             is equal to       rk Gss .
7.2.   Finite projetive resolutions.        We use a result of Joseph Bernstein to attah
                                                    
an Euler harateristi       Eul(V ) in K0 H(χ) (G) to a nitely generated representation
V ∈ Mod(χ) (G).
Denition 30.         A smooth representation              V   is alled     nitely generated          if there exist
nitely many elements         v1 , . . . , vn   suh that the map
                                                                             n
                                                                             X
                         H(G)n → V,                  (f1 , . . . , fn ) 7→         fj ∗ vj
                                                                             j=1

is a bornologial quotient map.

     An admissible representation is nitely generated if and only if it has                            nite length,
that is, it has a Jordan-Hölder series of nite length.
                n
   Sine H(G) arries the ne bornology, the same is true for its quotients. Hene a
nitely generated representation neessarily belongs to      Modalg (G). In the situation
of Denition 30, there exists         U ∈ CO(G) xing vj for all j ∈ {1, . . . , n}. Thus we
                                                n                                 n
get a bornologial quotient          map H(G/U ) ։ V . Conversely, H(G/U ) is nitely
generated and projetive. Thus a smooth representation is nitely generated if and
                                   n
only if it is a quotient of H(G/U ) for some U ∈ CO(G). If V ∈ Modχ (G), then we
                        n            n
may replae H(G/U ) by Hχ (G/U ) for some U ∈ CO(G) with χ|U∩C(G) = 1.

Denition 31.         An objet of      Mod(χ) (G)        has type      (FP) if it admits a resolution of
nite length by nitely generated projetive objets of                      Mod(χ) (G).        Suh a resolution
is alled a  nite projetive resolution.
Theorem 32 (Joseph Bernstein). An objet of Mod(χ) (G) has type (FP) if and
only if it is nitely generated.
Proof. It is trivial that representations of type (FP) are nitely generated. Con-
versely, if   V   is nitely generated, then  V is a quotient of a nitely generated proje-
tive representation, say,      ∂0 : H(χ) (G/U )n ։ V . By [3, Remark 3.12℄, subrepresenta-
tions of nitely generated representations are again nitely generated. Espeially,
ker ∂0   is nitely generated.         By indution, we get a resolution                       (Pn , ∂n ) of V by
nitely generated projetive objets. By Theorem 29, the kernel of                               ∂n : Pn → Pn−1
is projetive for suiently large              n.   Hene

                               0 → ker ∂n → Pn → . . . → P0 → V
is a nite projetive resolution.                                                 
                                         
     The algebrai K-theory K0 H(χ) (G) is the Grothendiek group of the monoid
of   nitely generated projetive H(χ) (G)-modules. This is so beause H(χ) (G) is a
union of unital subalgebras.

Denition 33.   Let V ∈ Mod(χ) (G) be nitely generated. Then V is of type (FP)
by Bernstein's Theorem 32. Choose a nite projetive resolution

                                  0 → Pn → . . . → P0 → V → 0.
28                                                RALF MEYER


The      Euler harateristi      of   V   is dened by
                                              n
                                              X                              
                               Eul(V ) :=           (−1)j [Pj ] ∈ K0 H(χ) (G) .
                                              j=0

     We hek that this does not depend on the resolution (see also [19, Setion 1.7℄).
Dene the Euler harateristi Eul(P• ) for nite projetive omplexes in the obvious
fashion. Let  P• and P•′ be two nite projetive resolutions of V . The identity map
                                                       ′
on V lifts to a hain homotopy equivalene f : P• → P• . Hene the mapping one Cf
of   f    is ontratible. The Euler harateristi vanishes for ontratible omplexes.
Hene       Eul(Cf ) = 0. This is equivalent to Eul(P• ) = Eul(P•′ ).
Denition 34.            Let
                                     
                         HH0 H(χ) (G) := H(χ) (G)/[H(χ) (G), H(χ) (G)].
The      universal trae       is a map
                                                         
                      truniv : K0 H(χ) (G) → HH0 H(χ) (G) .
                       
If (pij ) ∈ Mn H(χ) (G) is an idempotent with H(χ) (G) · (pij ) ∼
                                                      n
              P                                               = V,                        then we have
truniv [V ] =   pii .
     The above denitions are inspired by onstrutions of Hyman Bass in [2℄, where
truniv Eul(V )     is onstruted for modules of type (FP) over unital algebras.

7.3.     Traes from admissible representations.                          Let   W ∈ Mod(χ) (G)   be an ad-
missible representation. Its integrated form is an algebra homomorphism    ρ from
H(χ) (G) to the algebra Endfin (W ) := W̃ ⊗W of smooth nite rank operators on W .
Here W̃ denotes the ontragradient representation and Endfin (W ) arries the ne
bornology. Composing ρ with the standard trae on Endfin (W ), we get a trae
                    
trW : HH0 H(χ) (G) → C and a funtional
                                              
                              τW : K0 H(χ) (G) → Z.
The following omputation of                τW    is a variant of [2, Proposition 4.2℄.

Proposition 35. Let V, W ∈ Mod(χ) (G), let V be nitely generated projetive
and let W be admissible. Then τW [V ] = dim HomG (V, W ) and HomG (V, W ) is
nite-dimensional.
Proof. The funtoriality of K0 for the homomorphism H(χ) (G) → Endfin (W ) maps
[V ]     to the lass of the nitely generated projetive module

                                   ˆ H(χ) (G) V ∼
                V ′ := Endfin (W ) ⊗            = W ⊗ (W̃ ⊗G V ) ∼
                                                                 = W dim W̃ ⊗G V
over      Endfin (W ).   Thus    τW [V ] = dim W̃ ⊗G V .        By adjoint assoiativity,
                                                                  ˜
                                 = HomG V, Hom(W̃ , C) ∼
                 Hom(W̃ ⊗G V, C) ∼                      = HomG V, W̃ .
              W ∼  ˜
We have         = W̃      beause   W       is admissible. Thus      τW [V ] = dim HomG (V, W ).          
     Let    V, W ∈ Mod(χ) (G),       let    W    be admissible and let       V   be nitely generated. By
Bernstein's Theorem 32, there is a nite projetive resolution         P• → V in Mod(χ) (G).
By Proposition 35,         HomG (P• , W ) is a hain omplex of nite-dimensional vetor
                                       n
spaes. Hene its        homology ExtH           (V, W ) is nite-dimensional as well and
                                         (χ) (G)

            ∞
            X                                             ∞
                                                          X
(23)            (−1)n dim ExtnH(χ) (G) (V, W ) =              (−1)n dim HomG (Pn , W )
           n=0                                            n=0
                                                                    ∞
                                                                    X                                
                                                                =         (−1)n τW [Pn ] = τW Eul(V ) .
                                                                    n=0
                   HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                           29


We all this the    Euler-Poinaré harateristi EP(χ) (V, W ) of V               and    W   (ompare
[20, page 135℄).

7.4.   Formal dimensions.        Evaluation at
                                     
                                                       1∈G    is a trae on      H(χ) (G),    that is, a
linear funtional   τ1 : HH0 H(χ) (G) → C.             The funtional
                                                          
                          dim := τ1 ◦ truniv : K0 H(χ) (G) → C
omputes the    formal dimension          for nitely generated projetive  H(χ) (G)-modules.
Reall that an irreduible representation in            Modχ (G) is projetive if and only if it
is superuspidal. Unless        C(G)      is   ompat, Mod(G) has no irreduible projetive
objets.
   We an also dene the formal dimension for representations that are square-
integrable (see [22℄).    Let   (V, π) ∈ Modχ (G)         be irreduible and square-integrable
(or, more preisely, square-integrable             modulo the entre C(G)).        Sine irreduible
representations are admissible,           V    arries the ne bornology.        Moreover, square-
integrable representations are tempered.               Thus the integrated form of            π   extends
to a bounded homomorphism             π : Sχ (G) → Endfin (V ).      Sine   V   is irreduible, this
homomorphism is surjetive. The ruial property of irreduible square-integrable
representation is that there is an ideal            I ⊆ Sχ (G)   suh that    I ⊕ ker π ∼
                                                                                        = Sχ (G).
Thus   π|I : I → Endfin (V ) is an algebra isomorphism. It is neessarily a bornologial
isomorphism beause it is bounded and        Endfin (V ) arries the ne bornology.
Proposition 36. Let V ∈ Modχ (G) be irreduible and square-integrable.
                                                                             Then V
is both projetive and injetive as an objet of Modχ S(G) .
Proof. The diret-sum deomposition Sχ (G) ∼    = ker π ⊕ Endfin (V ) gives rise to an
equivalene of exat ategories
                                                             
                     Modχ S(G) ∼= Mod(ker π) × Mod Endfin (V ) .
The representation    V                                        Endfin (V ) is anon-
                          belongs to the seond fator. The algebra
                                                                 
ially Morita equivalent to      C,   so that     Mod Endfin (V )
                                                             Mod(C) are equivalent
                                                                     and
exat ategories. The easiest way to get this Morita equivalene uses a basis in V
                           S∞
to identify Endfin (V ) ∼
                        = n=1 Mn (C). Sine any extension in Mod(C) splits, any
objet of Mod(C) is both injetive and projetive.                                
                                                
   We an also dene K0 S(χ) (G) , HH0 S(χ) (G) , and
                                                          
                        truniv : K0 S(χ) (G) → HH0 S(χ) (G) .
It is irrelevant for the following whether we divide by the linear or losed lin-
                                                                                   
ear span of the ommutators in the denition of HH0 S(χ) (G) . The trae τ1
                            S
                                            
extends to a bounded trae τ1 : HH0 S(χ) (G) → C. This indues a funtional
                  
dimS : K0 S(χ) (G) → Z. An irreduible square-integrable representation V de-
                                      
nes a lass [V ] ∈ K0 S(χ) (G)           by Proposition 36; we dene its         formal dimension
       S           S
by dim V := dim [V ].
   The embedding      H(χ) (G) → S(χ) (G) indues natural maps
                                        
         ι : K0 H(χ) (G) → K0 S(χ) (G) ,                             ˆ H(χ) (G) V ],
                                                  [V ] 7→ [S(χ) (V ) ⊗
                                           
         ι : HH0 H(χ) (G) → HH0 S(χ) (G) .         [f ] 7→ [f ].
These maps are ompatible with the universal traes and satisfy                        τ1S ◦ ι = τ1   and
dimS ◦ ι = dim.
   It is shown in [25℄ that S(χ) (G) is losed under holomorphi funtional alulus
in the  C ∗ -algebra Cred,(χ)
                      ∗
                              (G). Hene
                                                          
                             K0 S(χ) (G) ∼      ∗
                                          = K0 Cred,(χ) (G) .
30                                             RALF MEYER


It follows also that any nitely generated projetive module
                                                                          V   over   S(χ) (G)   is the
range of a    self-adjoint
                        idempotent element in Mn S(χ) (G) for some n ∈ N. Sine
           S                        S
the trae τ1 is positive, we get dim V > 0 unless V = 0.
   Yet another notion of formal dimension omes from the theory of von Neumann
algebras. The       (χ-twisted) group von Neumann algebra of G is the losure N(χ) (G) of
H(χ) (G) or S(χ) (G) in the weak operator topology on L2 (G)(χ) . We may extend τ1S
                                  N
to a positive unbounded trae τ1 on N(χ) (G). Any normal ∗-representation ρ of
N(χ) (G) on a separable Hilbert spae is isomorphi to the left regular representation
                                          
on the Hilbert spae L2 (G)(χ) ⊗  ¯ ℓ2 (N) · pρ for some projetion pρ ∈ N(χ) (G) ⊗  ¯
B(ℓ2 N) where ⊗¯ denotes spatial tensor produts of Hilbert spaes and von Neumann
algebras, respetively; the projetion pρ is unique up to unitary equivalene. We
dene the formal dimension dim (ρ) to be τ1 (pρ ) ∈ [0, ∞]; this does not depend
                                  N             N

on the hoie of pρ .
                                                                            
   By denition, we have dim (L2 (G)(χ) ·e) = dim [e] if e ∈ Mn S(χ) (G) is a self-
                              N         n            S

adjoint idempotent. Sine S(χ) (G) is losed under holomorphi funtional alulus
                         ∗          ∗
in the redued group C -algebra Cred,(χ) (G), any idempotent element of S(χ) (G) is

similar to a self-adjoint idempotent. Hene              dimN (L2 (G)n(χ) · e) = dimS [e]   holds for
                                          
any idempotent        e ∈ Mn      S(χ) (G) .   We have

                                  ˆ S(χ) (G) S(χ) (G)n · e ∼
                        L2 (G)(χ) ⊗                        = L2 (G)n(χ) · e.
Therefore, if  V is a nitely generated projetive left S(χ) (G)-module V , then we
may view             ˆ S(χ) (G) V as a Hilbert spae equipped with a faithful normal
           L2 (G)(χ) ⊗
∗-representation of N(χ) (G); the resulting representation is uniquely determined
up to unitary equivalene beause any two self-adjoint idempotents realising V are
unitarily equivalent in S(χ) (G). The formal dimensions from the Shwartz algebra
and the von Neumann algebra are ompatible in the following sense:

                                           ˆ S(χ) (G) V ) ∼
                           dimN (L2 (G)(χ) ⊗              = dimS (V ).

Thus   dimS V   only depends on the unitary equivalene lass of the assoiated unitary
representation                ˆ S(χ) (G) V .
                    L2 (G)(χ) ⊗

7.5.   Compatly indued representations.             Equip U ∈ CO(G) with the restri-
tion of the Haar measure from                G.        iG
                                                        U : H(U ) → H(G) that extends
                                                  The map
funtions by    0   outside   U   is an algebra homomorphism. Hene it indues a map
                                           
       (iG              ∼
         U )! : Rep(U ) = K0 H(U ) → K0 H(G) ,                     [V ] 7→ [H(G) ⊗H(U) V ].

This is the standard funtoriality of             K-theory.   We denote it by   (iG
                                                                                  U )! beause this
notation is used in [17℄.          We all representations of the form           U )! (V ) ompatly
                                                                               (iG
indued   beause H(G) ⊗H(U) V ∼ = -IndGU (V ) (see [15℄).
                                             −1
   Let U, V ∈ CO(G) and suppose that gU g        ⊆ V for some g ∈ G. Then we have
 G     −1    G   V
iU = γg ◦ iV ◦ igUg−1 ◦ γg , where γg denotes onjugation by g . One heks that γg
                                       G                         G
ats trivially on K0 H(G) . Hene (iU )! is the omposite of (iV )! and the map
          ∼
          =
Rep(U ) → Rep(gU g −1 ) → Rep(V ) that is assoiated to the group homomorphism
U → V , x 7→ gxg −1 . Let Sub(G) be the ategory whose objets are the ompat
open subgroups of G and whose morphisms are these speial group homomorphisms.
We have exhibited that U 7→ Rep(U ) is a module over this ategory. The various
       G
maps (iU )! ombine to a natural map
                                                     
                            lim Rep(U ) → K0 H(G) .
                            −→
                                    Sub(G)
                  HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                  31
                                                             
We all this map the         assembly map       for   K0 H(G)    beause it is a variant of the
Farrell-Jones assembly map for disrete groups (see [12, Conjeture 3.3℄), whih is
in turn losely related to the Baum-Connes assembly map.
  The above
                                      Hχ (G) in a straightforward fashion. Let
                denitions arry over to
CO G; C(G)                 C(G)-ompat open
                be the set of
                                              subgroups of G ontaining C(G).
The projetion to Gss identies CO G; C(G) with CO(Gss ). As above, we get
                         G
                                                                     
algebra homomorphisms iU : Hχ (U ) → Hχ (G) for U ∈ CO G; C(G) . There is an
analogue of the Peter-Weyl theorem for Hχ (U ); that is, Hχ (U ) is a diret sum of
matrix algebras. Therefore, nitely generated projetive modules over Hχ (U ) are
the same as nite-dimensional representations in Modχ (U ). This justies dening
                       
Repχ (U ) := K0 Hχ (U ) . As above, we an fator (iG                   G
                                                        U )! through (iV )! if U is
subonjugate to V . The relevant ategory organising these subonjugations is the
                                                          
ategory Sub G; C(G) whose set of objets is CO G; C(G) and whose morphisms
                                                               −1
are the group homomorphisms U → V of the form x 7→ gxg            for some g ∈ G.
Thus we get an assembly map
                                                                   
(24)                            lim           Repχ (U ) → K0 Hχ (G) .
                                −→        
                             Sub G;C(G)

  Let   Γ(Gss , dg) ⊆ R be the subgroup generated by vol(U )−1 for U ∈ CO(Gss ).
                                                                                  −1
Sine vol(U )/ vol(V ) ∈ N for V ⊆ U , this group is already generated by vol(U )
for maximal ompat subgroups U ⊆ Gss . We have Γ(Gss , dg) = αZ for some
α > 0 beause there are only nitely many maximal ompat subgroups and
vol(U )/ vol(V ) ∈ Q for all U, V ∈ CO(Gss ). The number α depends         on the
hoie of the Haar measure, of ourse. We let size(U ) := α vol U/C(G) , so that
                                       
size(U )−1 ∈ N for all U ∈ CO G; C(G) .
                                   
Lemma 37. Let U ∈ CO G; C(G) , and let W ∈ Modχ (U ) be nite-dimensional.      
Let cW : U → C be the harater of W . Then truniv (iG    U )! [W ] ∈ HH0 Hχ (G) is
represented by the funtion
                                      (
                                          α size(U )−1 cW (g)    for g ∈ U ,
(25)                 cG
                      U,W (g)    :=
                                          0                      for g ∈/ U .
Moreover, dim(iG U )! [W ] = α size(U )
                                       −1
                                          dim(W ). Thus dim x ∈ αZ for all x in the
range of the assembly map (24).
  A similar result holds for ompatly indued projetive objets of             Mod(G).

Proof.                                                                K0 andHH0 ,
         Sine the universal trae is ompatible with the funtoriality of
the rst assertion follows if truniv [W ] = vol(U/C(G))−1 cW (g) in HH0
                                                                      Hχ (U ) . We
briey reall how this well-known identity is proved. We may assume that W is
irreduible. Hene there is an idempotent pW ∈ Hχ (U ) with W ∼      = Hχ (U )pW .
Thus truniv [W ] = [pW ]. We an ompute cW (g) for g ∈ G as the trae of the nite
rank operator f 7→ λ(g)f ∗ pW on Hχ (U ). This operator has the integral kernel
(x, y) 7→ pW (y −1 g −1 x), so that
                                         Z
                                    −1
                      cW (g) = cW (g ) =        pW (x−1 gx) dx.
                                                      U/C(G)
                         R                         
This implies   [cW ] =       [W ] dx = vol U/C(G) [W ] beause onjugation does
                         U/C(G)      
not hange the lass in HH0 Hχ (U ) . We get the formula for formal dimensions
beause dim x = truniv (x)(1) and cW (1) = dim W . This lies in αZ by onstrution
of α. By additivity, we get dim x ∈ αZ for all x in the range of the assembly
map (24).                                                                        
32                                             RALF MEYER


7.6.   Expliit nite projetive resolutions.                   Let   V ∈ Modχ (G)    be of nite
length. Peter Shneider and Ulrih Stuhler onstrut an expliit nite projetive res-
olution for suh   V   in [20℄. We only sketh the onstrution very briey. Let         BT (Gss )
be the ane Bruhat-Tits building of              Gss .   One denes a oeient system   γe (V ) on
BT (Gss ),  whih depends on an auxiliary parameter e ∈ N (see [20, Setion II.2℄);
                                                                            e
its value on a faet F of BT (Gss ) is thenite-dimensionalspae Fix(UF , V ) for
           e
                                                                       
ertain UF ∈ CO(G). The ellular hain omplex C• BT (Gss ), γe (V ) with values
in γe (V ) is a resolution of V for suiently large e ([20, Theorem II.3.1℄). It is a
nite projetive resolution of
                                    V    in   Modχ (G) beause the    stabilisers of faets belong
to   CO G; C(G)     and the set of faets is        Gss -nite.
Proposition 38. If V ∈ Modχ (G) has nite length,    then Eul(V ) belongs to the
range of the assembly map (24). Hene dim Eul(V ) ∈ αZ.
   Dene the Euler-Poinaré funtion fEP   V
                                             ∈ Hχ (G) of V as in [20, page 135℄.
Then [fEP ] = truniv Eul(V ) ∈ HH0 Hχ (G) . Thus dim Eul(V ) = fEP (1) and
        V
                    V
EPχ (V, W ) = trW (fEP ) for all admissible W ∈ Modχ (G).
     See also [20, Proposition III.4.22℄ and [20, Proposition III.4.1℄.
                                                              
Proof.   The nite projetive resolution C• BT (Gss ), γe (V ) is expliitly built out
of ompatly indued representations. Hene Eul(V ) belongs to the range of the
                                                 
assembly map. Lemma 37 yields dim Eul(V ) ∈ αZ and allows us to ompute
                                                        V
truniv Eul(V ). Inspetion shows that this is exatly [fEP ].                       
     Proposition 38 yields    dim V = dim Eul(V ) ∈ αZ if V           is irreduible superuspidal.
This rationality result is due to Marie-Frane Vignéras ([25℄).

7.7. Euler harateristis and formal dimensions for square-integrable
representations.
Theorem 39. Let V ∈ Modχ (G) be irreduible and square-integrable. Let
                                                        
                                ι : K0 Hχ (G) → K0 Sχ (G)
                                                                              
be indued by the embedding Hχ (G) → Sχ (G). Then ι Eul(V ) = [V ]. Hene [V ]
lies in the range of the assembly map
                                                                    
                        lim         Repχ (U ) → K0 Hχ (G) → K0 Sχ (G)
                        −→      
                   Sub G;C(G)
                                
and fEP
      V
        (1) = dim Eul(V ) = dimS (V ). This number belongs to α · N≥1 with α as
in Lemma 37.
                                                                
Proof. Choose e ∈ N large enough suh that C• BT (Gss ), γe (V ) is a projetive
Hχ (G)-module      resolution of     V.   Then
                              ∞
                              X                                               
               ι Eul(V ) =        (−1)n [Sχ (G) ⊗
                                                ˆ Hχ (G) Cn BT (Gss ), γe (V ) ].
                              n=0

Sine  Sχ (G) is isoohomologial (Theorem 28), Sχ (G) ⊗       ˆ LH (G) V ∼
                                                                          = V . There-
                                                                  χ
             ˆ Hχ (G) C• BT (Gss ), γe (V ) is still a projetive Sχ (G)-module resolu-
fore, Sχ (G) ⊗
tion of V . Sine V is projetive as well (Proposition 36), this resolution splits
by bounded Sχ (G)-module homomorphisms. This implies [V ] = ι Eul(V ). The
                                                                     S
remaining assertions now follow from Proposition 38 and dim (V ) > 0.                
                                        
Theorem 40. Let U ∈ CO G; C(G) and let W ∈ Modχ (U ) be nite-dimensional.
Then there are at most dim(W ) · size(U )−1 dierent irreduible square-integrable
representations whose restrition to U ontains the representation W .
                       HOMOLOGICAL ALGEBRA FOR SCHWARTZ ALGEBRAS                                           33


Proof.    Let   V1 , . . . , VN   be pairwise non-isomorphi irreduible square-integrable rep-
resentations whose restrition to               U   ontains    W.   Let               ˆ Hχ (U) W .
                                                                           X := Sχ (G) ⊗               There
are natural adjoint assoiativity isomorphisms

                                  HomHχ (U) (W, Vj ) ∼
                                                     = HomSχ (G) (X, Vj )
for all   j   (see [17℄).         Thus we get non-zero maps            X → Vj .       They are surjetive
and admit bounded linear setions beause the representations                            Vj   are irreduible
and arry the ne bornology; sine the representations                        Vj   are projetive (Proposi-
tion 36), they even admit G-equivariant bounded linear setions.
                                                            L Thus V1 , . . . , VN
are diret summands of   X . Sine they are not isomorphi,   Vj is a diret sum-
                                 PN       S            S
mand of X as well. Therefore,      j=1 dim (Vj ) ≤ dim X . Lemma 37 and The-
                 S                         −1         S
orem 39 yield dim X = α dim(W ) size(U )      and dim (Vj ) ≥ α for all j . Hene
N ≤ dim(W ) size(U )−1 .                                                         
   An irreduible square-integrable representation that is not superuspidal is a
subquotient of a representation that we get by Jaquet indution from a proper
Levi subgroup. It is desirable in this situation to ompute the formal dimension
(and other invariants) of              V   from its uspidal data. This gives rise to some rather
intriate omputations; these are arried out in [1℄ for representations of                          Glm (D)
for a division algebra            D.

7.8.Some vanishing results.
Theorem 41. Let V, W ∈ Modχ (G) be irreduible and tempered. If                                  V   or W is
square-integrable, then ExtnG (V, W ) = 0 for all n ≥ 1 and
                                                        (
                                                            1   if V ∼
                                                                     = W;
                                       EPχ (V, W ) =
                                                            0   otherwise.
Proof.    Sine    V   and   W     are tempered and      Sχ (G)      is isoohomologial, we have

                                   ExtnHχ (G)   (V, W ) ∼
                                                        = Extn   Sχ (G) (V, W ).

The latter vanishes for             n≥1      by Proposition 36. For           n=0     we are dealing with
HomG (V, W ),       whih is omputed by Shur's Lemma.                                                    
Theorem 42. If     V is irreduible                 and tempered but not square-integrable, then
 V
fEP (1) = dim Eul(V ) = 0.
Proof.    This follows from the abstrat Planherel Theorem and Theorem 41 as
in the proof of [20, Corollary III.4.7℄.  We merely outline the proof. The ab-
                                                  ∗           ∗
strat Planherel theorem applied to the type I C -algebra Cred,χ (G) yields that
  V                                                          V
fEP (1) is the integral of its Fourier transform W 7→ trW (fEP ) with respet to
some measure µ, whih is alled the Planherel measure. Here W runs through
the tempered irreduible representations in Modχ (G). Proposition 38 asserts that
       V
trW (fEP ) = EPχ (V, W ).
                 n
   We have ExtH (G) (V, W ) = 0 for all n ∈ N and hene EPχ (V, W ) = 0 unless
                   χ
V and W have the same innitesimal harater. Sine the innitesimal harater
is nite-to-one, the support of the funtion W 7→ EPχ (V, W ) is nite. Hene only
atoms of the Planherel measure µ ontribute to the integral
                                    Z
                           V
                          fEP (1) = EPχ (V, W ) dµ(W ).

These atoms are exatly the square-integrable representations. Now Theorem 41
        V
yieldsfEP (1) = 0 unless V is square-integrable. In addition, this omputation
            V           S
shows that fEP (1) = dim (V ) if V is square-integrable (ompare Theorem 39). 
34                                        RALF MEYER


                                         Referenes

 [1℄ Anne-Marie Aubert and Roger Plymen,       Planherel measure for   GL(n, F )   and   GL(m, D):
      expliit formulas and Bernstein deomposition ,   J. Number Theory 112 (2005), 2666.
     MR2131140
 [2℄ Hyman Bass, Euler harateristis and haraters of disrete groups , Invent. Math. 35
     (1976), 155196. MR0432781 (55 #5764)
 [3℄ J. N. Bernstein, Le entre de Bernstein , 132, Edited by P. Deligne. MR771671 (86e:22028)
 [4℄ Martin R. Bridson and André Haeiger, Metri spaes of non-positive urvature , Grundlehren
     der Mathematishen Wissenshaften, vol. 319, Springer-Verlag, Berlin, 1999, ISBN 3-540-
     64324-9. MR1744486 (2000k:53038)
 [5℄ F. Bruhat and J. Tits, Groupes rédutifs sur un orps loal , Inst. Hautes Études Si. Publ.
     Math. (1972), 5251. MR0327923 (48 #6265) (Frenh)
 [6℄ Heath Emerson and Ralf Meyer, Dualizing the oarse assembly map , J. Inst. Math. Jussieu
     (2004), http://arxiv.org/math.OA/0401227 (to appear).
 [7℄ Alexander Grothendiek, Produits tensoriels topologiques et espaes nuléaires , Mem. Amer.
     Math. So., vol. 16, 1955. MR0075539 (17,763) (Frenh)
 [8℄ Henri Hogbe-Nlend, Complétion, tenseurs et nuléarité en bornologie , J. Math. Pures Appl.
     (9) 49 (1970), 193288. MR0279557 (43 #5279) (Frenh)
 [9℄          , Bornologies and funtional analysis , North-Holland Mathematis Studies, vol. 26,
     North-Holland Publishing Co., Amsterdam, 1977, ISBN 0-7204-0712-5. MR0500064 (58
     #17774)
[10℄ James E. Humphreys, Reetion groups and Coxeter groups , Cambridge Studies in Advaned
     Mathematis, vol. 29, Cambridge University Press, Cambridge, 1990, ISBN 0-521-37510-X.
     MR1066460 (92h:20002)
[11℄ Bernhard Keller, Derived ategories and their uses , 1996, pp. 671701. MR1421815
     (98h:18013)
[12℄ Wolfgang Lük and Holger Reih, The Baum-Connes and the Farrell-Jones Conjetures in
     K- and L-theory , Preprintreihe SFB 478 324 (2004), Universität Münster.
[13℄ Ralf Meyer, Analyti yli ohomology , Ph.D. Thesis, Westfälishe Wilhelms-Universität
     Münster, 1999.
[14℄          , Bornologial versus topologial analysis in metrizable spaes , 249278. MR2097966
[15℄          , Smooth group representations on bornologial vetor spaes , Bull. Si. Math. 128
     (2004), 127166. MR2039113 (2005:22013) (English, with English and Frenh summaries)
[16℄          , Combable groups have group ohomology of polynomial growth (2004),
     http://arxiv.org/math.KT/0410597 (to appear in Q. J. Math.)
[17℄          , Embeddings of derived ategories of bornologial modules                    (2004),
     http://arxiv.org/math.FA/0410596 (eprint).
[18℄ A. Yu. Pirkovskii, Stably at ompletions of universal enveloping algebras (2003),
     http://arxiv.org/math.FA/0311492 (eprint).
[19℄ Jonathan Rosenberg, Algebrai K-theory and its appliations , Graduate Texts in Mathemat-
     is, vol. 147, Springer-Verlag, New York, 1994, ISBN 0-387-94248-3. MR1282290 (95e:19001)
[20℄ Peter Shneider and Ulrih Stuhler, Representation theory and sheaves on the Bruhat-Tits
     building , Inst. Hautes Études Si. Publ. Math. (1997), 97191. MR1471867 (98m:22023)
[21℄ P. Shneider and E.-W. Zink, K -types for the tempered omponents of a p-adi general linear
     group , J. Reine Angew. Math. 517 (1999), 161208, With an appendix by P. Shneider and
     U. Stuhler. MR1728541 (2001f:22029)
[22℄ Allan J. Silberger, Introdution to harmoni analysis on redutive p-adi groups , Mathe-
     matial Notes, vol. 23, Prineton University Press, Prineton, N.J., 1979, ISBN 0-691-08246-
     4, Based on letures by Harish-Chandra at the Institute for Advaned Study, 19711973.
     MR544991 (81m:22025)
[23℄ J. Tits, Redutive groups over loal elds , 2969. MR546588 (80h:20064)
[24℄ François Trèves, Topologial vetor spaes, distributions and kernels , Aademi Press, New
     York, 1967. MR0225131 (37 #726)
[25℄ Marie-Frane Vignéras, On formal dimensions for redutive p-adi groups , 225266.
     MR1159104 (93:22034)
[26℄ J.-L. Waldspurger, La formule de Planherel pour les groupes p-adiques (d'après Harish-
     Chandra) , J. Inst. Math. Jussieu 2 (2003), 235333. MR1989693 (2004d:22009) (Frenh)
    E-mail address : rameyermath.uni-muenster.de

     Mathematishes Institut, Westfälishe Wilhelms-Universität Münster, Einstein-
str. 62, 48149 Münster, Germany
