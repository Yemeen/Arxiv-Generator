                                                          Lusztig’s conjecture for finite special linear groups


                                                                                     Toshiaki Shoji

                                                                        Graduate School of Mathematics
arXiv:math/0502180v1 [math.RT] 9 Feb 2005




                                                                               Nagoya University
                                                                       Chikusa-ku, Nagoya 464-8602, Japan




                                                   Abstract. In this paper, we prove Lusztig’s conjecture for GF = SLn (Fq ), i.e., we
                                                   show that characteristic functions of character sheaves of GF coincide with almost
                                                   characters of GF up to scalar constants, assuming that ch Fq is not too small. We
                                                   determine these scalars explicitly. Our result gives a method of computing irreducible
                                                   characters of GF .



                                                                                  0. Introduction
                                                Let G = SLn defined over a finite field Fq with the standard Frobenius map F , and
                                            GF = SLn (Fq ) the finite special linear group. In [S2], a parametrization of irreducible
                                            characters of GF was given by making use of modified generalized Gelfand-Graev
                                            characters. Also the almost characters of GF was defined, and it was shown that the
                                                                                             m
                                            Shintani descent of irreducible characters of GF , for sufficiently divisible m, coincides
                                            with almost characters up to scalar. However as explained in the remark of the last
                                            part of [S2], the relationship of our parametrization of irreducible characters and the
                                            parametrization in terms of the Harish-Chandra induction was not so clear. Now
                                            Lusztig’s conjecture is formulated in the form that almost characters coincide with the
                                            characteristic functions of character sheaves of G under a suitable parametrization.
                                                In this paper we prove that Lusztig’s conjecture holds for GF , assuming that
                                            ch Fq is not too small so that Lusztig’s results ([L7]) for generalized Gelfand-Graev
                                            characters are applicable. In the course of the proof, it is shown that almost characters
                                            of GF are parametrized in terms of the twisted induction, which is compatible with
                                                                                                            m
                                            the parametrization of F -stable irreducible characters of GF in terms of the Harish-
                                            Chandra induction for sufficiently divisible m. Thus giving the relationship between
                                                                                                             m
                                            two parametrizations of F -stable irreducible characters of GF is equivalent to giving
                                            the relationship between two parametrizations of almost characters of GF .
                                                We give a complete description of the relationship between those two parametriza-
                                            tions of almost characters, by computing the inner products of the characteristic func-
                                            tions of characters sheaves with various modified generalized Gelfand-Graev characters.
                                            Note that the inner product of characteristic functions with generalized Gelfand-Graev
                                            characters can be computed by using Lusztig’s formula without difficulty. However
                                            the computation in the case of modified generalized Gelfand-Graev characters is much
                                            more complicated since it involves non-uni potent supports. Through this computa-
                                            tion, we can describe the scalar constants appearing in Lusztig’s conjecture. Although
                                            the expression of such scalars are not so simple, they are explicitly computable. (Here
                                                                                             1
2

we need a result of Digne-Lehrer-Michel [DLM1] that the fourth root of unity occurring
in the Lusztig’s theory in [L7] is explicitly determined in the case of SLn ).
    The computation of irreducible characters of GF is reduced to the computation
of characteristic functions of character sheaves. In turn, the computation of those
characteristic functions is reduced to the computation of generalized Green functions.
Lusztig’s algorithm of computing generalized Green functions contains certain un-
known constants. In the case of SLn , we can determine such scalars, which will be
discussed in [S3]. Thus our result makes it possible to compute the character table of
SLn (Fq ).

Some notations. For a finite group Γ , we denote by Irr Γ or Γ ∧ the set of irreducible
characters of Γ over Q̄l . If F : Γ → Γ is an automorphism on Γ , we denote by Γ/∼F
the set of F -twisted conjugacy classes in Γ , where x, y ∈ Γ is F -twisted conjugate if
there exists z ∈ Γ such that y = z −1 xF (z). In the case where Γ is abelian, Γ/∼F is
naturally identified with the largest quotient of Γ on which F acts trivially, which we
denote by ΓF .
                                                                                  0
    For a reductive group H, we denote by ZH the center of H, and denote by ZH      the
identity component of ZH .


    Contents
    1.   Parametrization of irreducible characters
    2.   Generalized Gelfand-Graev characters
    3.   Character formula for generalized Gelfand-Graev characters
    4.   Shintani descent and almost characters
    5.   Unipotently supported functions
    6.   Character sheaves
    7.   Lusztig’s conjecture
    8.   Parametrization of almost characters
    9.   Proof of Theorem 8.6


                 1. Parametrization of irreducible characters

     1.1. Let k be an algebraic closure of a finite field Fq with ch k = p. In this and
next section, we review the parametrization of irreducible characters of SLn (Fq ) (or
more generally, its Levi subgroups) following [S2]. we assume that p is large enough so
that the Dynkin-Kostant theory on Lie algebras can be applied. For example, p ≥ 2n
is enough for G = SLn (See the remark in 2.1).
                                                                                      P
     Let G  e = GLn1 × · · · × GLnr . We regard G e as a subgroup of GLn (k) with n = ni
in a natural way, and put G = G       e ∩ SLn . Thus G is a Levi subgroup of a parabolic
subgroup of SLn . We consider a Frobenius map F on G             e of the form F = φF0 ,
where F0 is the split Frobenius map on G     e with respect to the Fq -structure, and φ is a
permutation of the factors in G.    e
     Put Gi = GLni . We choose an F0 -split maximal torus Tei in G
             e                                                             ei so that Te =
Te1 × · · · × Ter is an F -stable maximal torus in G,
                                                    e which is maximally split with respect
                                                                                            3

to F . Let W = NG̃ (Te)/Te be the Weyl group of G.     e Then W ≃ W1 × · · · × Wr where
Wi = NGe i (Tei )/Tei is the Weyl group of G  ei .
    Let Ge∗ ≃ G   e∗ × · · · × Ge∗ be the dual group of G e over Fq , and G∗ the dual group
                    1            r
of G. We denote also by F the corresponding Frobenius actions on G          e∗ and G∗ . The
natural inclusion map G ֒→ G         e induces a map π : Ge∗ → G∗ , which is identified with
the projection G    e∗ → G  e∗ /Z1 , where Z1 is the center of GLn under the identification
   e∗ with the subgroup of GL∗ = GLn . Then Z e ∗ and ZG∗ are connected, and
of G                                     n                  G
ZG∗ = ZGe ∗ /Z1. We have natural inclusions and projections

                              e ←֓ G ←֓ Gder = G
                              G                eder ,
                             e∗ → G∗ → G∗ /ZG∗ = G
                             G                      e∗ /Z e ∗ ,
                                                                 G

                                    eder ) is identified with G∗ /ZG∗ (resp. G
where the dual group of Gder (resp. G                                        e∗ /Z e ∗ ).
                                                                                  G
   We note that, for a connected reductive group H defined over Fq with Frobenius
map F , there exists an isomorphism of abelian groups
                                      0 F ∼    F  F ∧
(1.1.1)                         f : (ZH ∗)
                                           → (H /Hder ) ,
                                           −

where Hder F
               means (Hder )F . Returning to the original setting, let S = Te ∩ G
                                                                                eder be an F -
stable maximal torus of G    eder . We have G
                                            e = Z eGe     e                     e
                                                                            e ∩ Gder = ZGe ∩S
                                                  G der , T = ZGe S, and ZG
                               e F eF       eF   F
is finite. It follows that G /Gder ≃ T /S and we have a natural inclusion map
ZGFe S F /S F ֒→ TeF /S F , which induces a surjective map (G  e F /G
                                                                    eF )∧ → (Z F S F /S F )∧ .
                                                                      der         e
                                                                                  G
Then we have the following lemma.
Lemma 1.2. Assume that n1 = · · · = nr = d, and put (ZGe ∗ )d = {z ∈ ZGe ∗ | z d = 1}.
Then there exists an isomorphism f0 : ZGFe ∗ /(ZGe ∗ )Fd → (ZeF S F /S F )∧ which makes the
following diagram commutative.

                                 ZGFe ∗           e F /G
                                            −−−→ (G    e F )∧
                                                         der
                                              f
                                                      
                                                      
(1.2.1)                           y                    y
                            ZGFe ∗ /(ZGe ∗ )Fd −−−→ (ZGFe S F /S F )∧ ,
                                               f0


where the vertical maps are natural surjections.
Proof. By the isomorphism f , the subgroup (ZGe ∗ )Fd of ZGFe ∗ is mapped onto the sub-
group A = {θ ∈ (TeF /S F )∧ | θd = 1} of (TeF /S F )∧ . We want to show that

(1.2.2)                   A = {θ ∈ (TeF /S F )∧ | θ|Z Fe S F /S F = 1}.
                                                         G



Let B be the right hand side      of (1.2.2). Note that Te = ZGe S, and ZGe ∩ S consists
of elements z such that z d =     1 since Geder ≃ SLd × · · · × SLd . It follows that for
zv ∈ (ZGe S)F with z ∈ ZGe , v    ∈ S, we have z d ∈ ZGFe , v d ∈ S F . Hence for θ ∈ B,
we have θd (zv) = θ(z d v d ) =   1. This implies that θ ∈ A, and we have B ⊆ A.
4

Here |A| = |(ZGe ∗ )Fd |. On the other hand, |B| = |TeF |/|ZGFe S F | = |ZGFe ∩ S F | since
|TeF | = |ZGFe ||S F | (cf. [C, Prop. 3.3.7]). Under the identification ZGFe ∗ ≃ ZGFe , we have
(ZGe ∗ )Fd ≃ ZGFe ∩ S F . It follows that A = B, and (1.2.2) follows.
     Now we have natural isomorphisms

             ZGFe ∗ /(ZGe ∗ )Fd ≃ (TeF /S F )∧ /A ≃ (TeF /S F )∧ /B ≃ (ZGFe S F /S F )∧ ,

which makes the diagram (1.2.1) commutative. This proves the lemma.                          



                                                  e∗ . Then the Weyl group N ∗ (Te∗ )/Te∗
    1.3. We fix a dual torus Te∗ of Te over Fq in G                         G̃
may be identified with W . For any semisimple element ṡ ∈ Te∗ such that the conjugacy
                    e∗ is F -stable, put
class {ṡ} of ṡ in G

                                 Wṡ = {w ∈ W | w(ṡ) = ṡ}
                                 Zṡ = {w ∈ W | F w(ṡ) = ṡ}.

We fix an F -stable Borel subgroup B e of G
                                          e containing Te. Let Σ (resp. Σ + ) be a root
system (resp. positive root system) with respect to the pair (B, e Te). Then Zṡ may
be written as Zṡ = w1 Wṡ for some w1 ∈ W . The element w1 is determined uniquely
by the condition that w1 maps Σṡ+ into Σ + , where Σṡ is the subroot system of Σ
corresponding to ṡ.
    Put T = Te ∩ G and B = B   e ∩ G. Then T is the maximally split maximal torus of
G, and B is an F -stable Borel subgroup of G containing T . We identify W with the
Weyl group NG (T )/T of G.

     1.4.     The element w1 induces an automorphism γ : Wṡ → Wṡ by γ(w) =
          −1
F (w1 ww1 ). Let Wṡ hγi be the semidirect product of Wṡ with the cyclic group hγi
generated by γ. We denote by (Wṡ∧ )γ the set of γ-stable irreducible characters of
Wṡ . Each E ∈ (Wṡ∧)γ is extendable to an irreducible character of Wṡ hγi. We fix the
preferred extension E   e of E (see [L3, 17.2]).
     Let Tew be an F -stable maximal torus of G  e obtained from Te by twisting by w ∈ W .
Then to any w ∈ Zṡ , one can attach an irreducible character θw of TeF w ≃ TewF (see e.g.,
                 e                                            e F associated to θw ∈ (TeF )∧ .
[S2, 2]). Let RTGe (θw ) be the Deligne-Lusztig character of G                          w
                  w
           e        ∧ γ
For each E ∈ (W ) , put
                  ṡ
                                                  X
                   ρeṡ,E = (−1)l(w1 ) |Wṡ |−1                   e Gee (θw w ).
                                                          Tr (γw, E)RTw w  1
                                                                       1
                                                  w∈Wṡ


Then ρeṡ,E gives rise to an irreducible character of GeF . The set Irr G
                                                                        eF is decomposed
as
                                           a
                                     eF =
                                 Irr G        E(GeF , {ṡ}),
                                                  {ṡ}
                                                                                               5

where {ṡ} runs over all the F -stable semisimple classes in G   e∗ . The Lusztig series
  e F , {ṡ}) associated to the F -stable class {ṡ} is given as
E(G

                              e F , {ṡ}) = {e
                            E(G              ρṡ,E | E ∈ (Wṡ∧ )γ }.



    1.5.     We now describe the irreducible characters of GF following [S2]. Let
π : Ge → G∗ be as in 1.1. Let T ∗ = π(Te∗ ) be the maximal torus of G∗ . Then
       ∗

                                                                                     eF , the
W = NGe ∗ (Te∗ )/Te∗ is naturally identified with NG∗ (T ∗ )/T ∗ . As in the case of G
set Irr GF is partitioned as
                                            a
                                  Irr GF =     E(GF , {s}),
                                             {s}


where {s} runs over all the F -stable semisimple classes in G∗ . We fix s ∈ T ∗ for a
given F -stable class {s} ⊂ G∗ . There exists ṡ ∈ Te∗ such that π(ṡ) = s and that the
class {ṡ} is F -stable. One can find w1 ∈ Zṡ and an isomorphism γ = F w1 : Wṡ → Wṡ
as in 1.4.
       Put Ws = {w ∈ W | w(s) = s}. Then Wṡ is naturally regarded as a sub-
group of Ws , and we have Ws ≃ Wṡ ⋊ Ωs , where Ωs is a cyclic group isomorphic
to ZG∗ (s)/ZG0 ∗ (s). Wṡ is characterized as the largest reflection subgroup of Ws , and
sometimes we denote it by Ws0 . Let F ′ = F ẇ1 , where ẇ1 is the representative of w1
in NGe ∗ (Te∗ ). Then π is F ′ -equivariant, and s ∈ (T ∗ )F . So F ′ acts naturally on Ws ,
                                                             ′


leaving Wṡ and Ωs invariant. We consider the set Ωs /∼F ′ of F ′ -twisted classes in Ωs .
Since Ωs is abelian, Ωs /∼F ′ is identified with (Ωs )F ′ , the largest quotient on which F ′
acts trivially. For each x ∈ (Ωs )F ′ , one can choose ṡx ∈ (Te∗ )xF such that π(ṡx ) = s,
                                                                       ′


and obtain an isomorphism γx = xF ′ : Wṡ → Wṡ . To each γx -stable irreducible char-
acter E of Wṡ , one can attach the irreducible character ρeṡx ,E of G   eF as before. We
denote by Tṡx ,E the set of irreducible characters of GF occurring in the restriction of
ρeṡx ,E on GF . Then by [L5], we can decompose E(GF , {s}) as
                                                   a
(1.5.1)                          E(GF , {s}) =             Tṡx ,E ,
                                                   (x,E)

                                                                          ′                ′
where the pair (x, E) runs over all x ∈ (Ωs )F ′ and E ∈ (Wṡ∧)γx /ΩFs (the set of ΩFs -
orbits in (Wṡ∧)γx ).


     1.6. Following [S2], we shall modify the partition in (1.5.1). For E ∈ Wṡ∧ , let
Ωs,E be the stabilizer of E in Ωs . (In [S2], the notation Ωs (E) is used instead of Ωs,E ).
If the Ωs -orbit of E in Wṡ∧ is F ′ -stable, then Ωs,E is F ′ -stable, and one can consider
the largest quotient (Ωs,E )F ′ as before. If we put Ω   e s,E = {x ∈ Ωs | xF ′ E = E}, then
e s,E 6= ∅, and one can write it as Ω
Ω                                       e s,E = Ωs,E aE for some aE ∈ Ωs . It follows that
e s,E /∼F ′ can be identified with the set (Ωs,E /∼F ′ )aE and with (Ωs,E )F ′ aE . We denote
Ω
6

             e s,E )F ′ . By (4.4.2) in [S2], we have the following natural bijection
this set by (Ω
                             a                               a                       ′
(1.6.1)                                     e s,E )F ′ ≃
                                           (Ω                           (Wṡ∧)γx /ΩFs ,
                        E∈(Wṡ∧ /Ωs )F ′                   x∈(Ωs )F ′

                   ′
where (Wṡ∧ /Ωs )F denotes the set of F ′ -stable Ωs -orbits in Wṡ∧ . (In [S2], Ωs,E is used
instead of Ωe s,E . This is justified since we have a bijection Ω  e s,E ≃ Ωs,E . However this
bijection depends on the choice of aE , and so the form as in (1.6.1) is more convenient
for our later purpose.)
                          ′
                                                                                      e s,E )F ′ ,
    Let E ∈ (Wṡ∧/Ωs )F , i.e., the Ωs -orbit of E is F ′ -stable. Then for each y ∈ (Ω
                                                                                  ′
one can associate the pair (x, E ′ ), where x ∈ (Ωs )F ′ and E ′ ∈ (Wṡ∧ )γx /ΩFs , by (1.6.1).
We denote by Ts,E the union of various Tṡx ,E ′ where (x, E ′ ) runs over all the pairs in
the image of (Ωs,E )F ′ under the bijection in (1.6.1). Thus we can rewrite (1.5.1) as
                                                             a
(1.6.2)                         E(GF , {s}) =                             Ts,E .
                                                      E∈(Wṡ∧ /Ωs )F ′

                                                ′
For a pair (s, E) with E ∈ (Wṡ∧/Ωs )F , put

(1.6.3)
                                                     ′
                                                      e s,E )F ′ ,
                                  Ms,E = (ΩFs,E )∧ × (Ω
          ′
where ΩFs,E is the F ′ -fixed subgroup of Ωs,E .
                                                                        ′ ∧      F′ ∧
    It is known by [L5] that Tṡx ,E is in bijection with the set (ΩxF
                                                                     s,E ) = (Ωs,E ) . Hence
                                                           ′
by (1.5.1), E(GF , {s}) is parametrized by various (ΩFs,E )∧ . However, this parametriza-
tion of Tṡx ,E is not canonical. It depends on the choice of an irreducible character
ρ0 ∈ Irr GF occurring in the decomposition of ρeṡx ,E . In [S2], a bijective correspondence
Ts,E ↔ Ms,E was constructed by making use of generalized Gelfand-Graev characters.
This bijection is determined uniquely once we fix a representative u ∈ C F for each
F -stable unipotent class C in G. Thus we have a parametrization of E(GF , {s}) as
                                                            a
(1.6.4)                        E(GF , {s}) =                             Ms,E .
                                                     E∈(Wṡ∧ /Ωs )F ′


In the next section, we shall explain this parametrization in details.


                   2. Generalized Gelfand-Graev characters

    2.1. In order to explain the bijection Ts,E ↔ Ms,E , we shall review results on
generalized Gelfand-Graev characters following [S2]. (Although no restriction on p was
assumed in [S2], this must be changed. In fact Kawanaka’s construction of generalized
Gelfand-Graev characters of GLn or SLn requires no assumption on p. However, our
construction ([S2, 2.3]) relies on the Dynkin-Kostant theory, which requires that p is
not too small). We also prove a character formula for modified generalized Gelfand-
Graev characters, which will play an essential role in later sections.
                                                                                            7

     Let g be the Lie algebra of G with Frobenius map F = φF0 . Let Guni (resp. gnil ) be
the set of unipotent elements in G (resp. nilpotent elements in g). We have a bijection
log : Guni → gnil , v 7→ v − 1. Let O be an F -stable nilpotent orbit in g, and choose
a representative N ∈ gF . Correspondingly, we consider an F -stable unipotent class
C containing u = log−1 N ∈ C F . By Dynkin-Kostant theory, there exists a natural
grading g = ⊕i∈Z gi associated to N. Let ui = ⊕j≥i gj for j ≥ 1. Then ui is a nilpotent
subalgebra of g, and there exists a connected unipotent subgroup Ui of G defined over
Fq such that log(Ui ) = ui . Also one can find a parabolic subgroup P = PN and its
Levi subgroup L = LN such that P = LU1 , where L is an F -stable Levi subgroup of
P with Lie(L) = g0 and U1 is the unipotent radical of P . Moreover, we have N ∈ g2 .
     Let N ∗ ∈ gF−2 be the element such that {N, N ∗ , H} gives a TDS triple for some
semisimple element H ∈ g0 . We define a linear map λ : u1 → k by λ(x) = hN ∗ , xi ,
whereh , i is a fixed G-invariant non-degenerate bilinear form on g. It is known that the
map (x, y) 7→ λ([x, y]) defines a symplectic form on g1 , and according to [S2, 2.3] one
can find an F -stable Lagrangian subspace s of g1 satisfying the following properties.
Put u = s + u2 (u = u1.5 in the notation in [S2]). Then u is a subalgebra of u1 , and
we obtain an F -stable closed subgroup U of U1 such that log(U) = u. U is a normal
subgroup of U1 . Moreover, U is stable by the conjugation action of L. (Note that the
last property does not hold for a general Lagrangian subspace (see [S2, 2.6]).) Now the
map λ ◦ log : U → k turns out to be an F -stable homomorphism from U to k. Thus
we obtain a linear character ΛN on U F by ΛN = ψ ◦ λ ◦ log, where ψ : Fq → Q̄∗l is
a fixed non-trivial additive character of Fq . The generalized Gelfand-Graev character
                                                       F
ΓN on GF associated to N is defined as ΓN = IndG     U F ΛN .
     Following [K3], we construct modified generalized Gelfand-Graev characters. Let
Aλ = ZL (λ)/ZL0 (λ) for λ : u → k. Then by [S2, 2.7] we have

(2.1.1)                      Aλ ≃ AG (N) = ZG (N)/ZG0 (N).

Since the latter group is abelian, Aλ is an abelian group. Moreover, we have a surjective
map ZG → Aλ . Put

(2.1.2)                           M = (Aλ )F × (AFλ )∧ .

For each (c, ξ) ∈ M, one can construct a character Γc,ξ on GF as follows; for c ∈ Aλ ,
we choose a representative ċ ∈ ZL (λ). Then we find αc ∈ L such that αc−1 F (αc ) = ċ.
Let us define a linear map λc : u → k by λc = λ ◦ Ad αc−1 , where Ad is the adjoint
action of L on u. We define a linear character Λc on U F by Λc = ψ ◦ λc ◦ log. If we
notice that ZL (λc )F coincides with ZLF (Λc ), the linear character Λc can be extended
to the character of ZL (λc )F U F so that it is trivial on ZL (λc )F , which we denote by the
same symbol Λc . On the other hand, by the isomorphism

                  ZL (λc )F /ZL0 (λc )F ≃ ZL (λ)ċF /ZL0 (λ)ċF ≃ AċF  F
                                                                   λ = Aλ ,

the linear character ξ ∈ (AFλ )∧ determines a linear character ξ ♮ on ZL (λc )F which is
trivial on ZL0 (λc )F .
8

    Let Pe and Le be the parabolic subgroup of G e and its Levi subgroup associated to
N ∈e          e Then we have P = Pe ∩ G and L = L
     g = Lie G.                                     e ∩ G, and so ZL (λ) ⊂ Z e (λ). Let
                                                                             L
                                      F
us take a linear character θ of ZL (λ) of the following type.
(2.1.3) θ is the restriction to ZL (λ)F of a linear character of ZLe (λ)F which is trivial
on (ZLe (λ)der )F .
     Since ċ ∈ ZL (λ), we have (ZLe (λ)/ZLe (λ)der )F ≃ (ZLe (λ)/ZLe (λ)der )ċF . It follows that
θ is regarded as a linear character of ZL (λ)ċF , and it determines a linear character of
ZL (λc )F via the isomorphism ad α−1 : ZL (λc )F ≃ ZL (λ)ċF , which we denote also by θ.
Then θξ ♮ gives rise to a character on ZL (λc )F U F under the surjective homomorphism
ZL (λc )F U F → ZL (λc )F , which we denote also by θξ ♮ . Under this setting, we define a
modified generalized Gelfand-Graev character Γc,ξ,θ by
                                             F                  
(2.1.4)                        Γc,ξ,θ = IndG               ♮
                                           ZL (λc )F U F θξ ⊗ Λc .


In the case where θ = 1, we simply write Γc,ξ,θ as Γc,ξ .
    For later use, we also define a generalized Gelfand-Graev character Γc associated
                          F
to c ∈ Aλ by Γc = IndG  U F Λc . Under the isomorphism Aλ ≃ AG (N) (2.1.1), one can
construct a nilpotent element Nc ∈ gF2 twisted by c. Γc is nothing but the generalized
Gelfand-Graev character ΓNc associated to Nc . We remark that Γc,ξ occurs as a direct
summand of Γc .
     2.2. We choose m large enough so that F m acts trivially on Aλ . Replacing F by
                                                               (m)       m
F m , we have a modified generalized Gelfand-Graev character Γc,ξ,θ on GF . Now the
parameter set M is replaced by Aλ × A∧λ . We denote by M the subset of Aλ × A∧λ
defined by
                                  M = AFλ × (A∧λ )F ,
where (A∧λ )F is the set of F -stable irreducible characters of Aλ . We now construct, for
                                          m
a certain linear character θ of ZL (λc )F , and for each (c, ξ) ∈ M, an F -stable modified
                                             (m)                          m
generalized Gelfand-Graev character Γc,ξ,θ , and its extension to GF hσi, where σ =
F |GF m . The case where θ = 1 is discussed in [S2, 1.8]. For c ∈ AFλ , we choose ċ ∈ LF .
                                         (m)      m
We construct the linear character Λc of U F as in 2.1, i.e., we choose βc ∈ L such
                                                                        (m)
that βc−1 F m (βc ) = ċ, and define λc by λc = λ ◦ Ad βc−1 , and put Λc = ψm ◦ λc ◦ log,
                                                            m          (m)
where ψm = ψ ◦ Tr Fqm /Fq . Put ĉ = βc F (βc−1 ) ∈ LF . Then Λc turns out to be
ĉF -stable. (Note that it is possible to choose ċ ∈ T F . Then we can choose βc ∈ T .)
     On the other hand, it can be checked that ĉF acts on ZL (λc ) commuting with F m ,
and that under the isomorphism
                                    m           m            m            m
                ad βc−1 : ZL (λc )F /ZL0 (λc )F ≃ ZL (λ)ċF /ZL0 (λ)ċF       ≃ Aλ ,
                                m
the action of ĉF on ZL (λc )F is transferred to the action of F on Aλ . Hence if we take
                                                                         m
ξ ∈ (A∧λ )F , it produces a ĉF -stable linear character ξ ♮ on ZL (λc )F .
                                                              m
    Furthermore, we take a linear character θ of ZL (λ)F of the following type.
                                           m                                                  m
(2.2.1) θ is the restriction to ZL (λ)F        of an F -stable linear character of ZLe (λ)F       as
in (2.1.3) by replacing F by F m .
                                                                                               9
                                                                               m
     Then θ is regarded as an F -stable linear character of ZL (λ)ċF . It follows, under
                                   m            m
the isomorphsim ad βc−1 : ZL (λc )F ≃ ZL (λ)ċF , that θ determines a ĉF -stable linear
                       m                                             (m)
character of ZL (λc )F , which we denote also by θ. Thus θξ ♮ ⊗ Λc is ĉF -stable for
                                     (m)
(c, ξ) ∈ M, and we conclude that Γc,ξ,θ is F -stable.
                          m
     Put ĉ0 = (ĉσ)m ∈ LF . Then we have

                                    ĉ0 = βc F m (βc−1 ) = ċ−1
                                                                           m        (m)   m
since βc and F m (βc ) commutes. We note that ĉ0 ∈ ZL (λc )F = ZL (Λc )F . In
               (m)                                                                    m
fact, since Λc is ĉF -stable, it is stable by (ĉσ)m = ĉ0 . Put Mc = ZL (λc )F and
                 m                                 m            m                         m
Mc0 = ZL0 (λc )F . We consider a subgroup Mc U F hĉσi of GF hσi generated by Mc U F
and ĉσ. Since θξ ♮ ∈ Mc∧ is ĉσ-stable, and (ĉσ)m = ĉ0 ∈ Mc , θξ ♮ may be extended to a
linear character θξe ♮ of Mc hĉσi in m distinct way. The extension θξ e ♮ is determined by
          e ♮ (ĉσ) = µc,θξ , where µc,θξ is any m-th root of θξ ♮ (ċ−1 ) = θ(ċ−1 )ξ(c−1).
the value θξ
    We fix an extension θξ    e ♮ of θξ ♮ to Mc hĉσi. Since Mc U F m hĉσi is the semidirect
                               m
product of Mc hĉσi with U F , θξ  e ♮ may be regarded as a character of Mc U F m hĉσi. On
                          (m)                                                                 (m)
the other hand, since Λc is ĉσ-stable, it can be extended to a linear character Λec
                      (m)
on Mc U F hĉσi by Λec (ĉσ) = 1. Thus we have a character θξ
         m
                                                                   e ♮ ⊗ Λec(m) of Mc U F m hĉσi
                                    (m)              m
which is an extension of θξ ♮ ⊗ Λc        on Mc U F . We put
                                              m
                               (m)        GF hσi          e ♮ ⊗ Λe(m) ).
                             Γec,ξ,θ = IndMc U F m hĉσi (θξ      c

        (m)                                        (m)                                 (m)
Then Γec,ξ,θ gives rise to an extension of Γc,ξ,θ to GF hσi. Note that µ−1   e
                                                                m
                                                                        c,θξ Γc,ξ,θ |GF σ
                                                                                       m

depends only on the choice of (c, ξ) and θ.


     2.3. In [L1], Lusztig defined, for a connected reductive group H with connected
center, a map from the set of irreducible characters of H F to the set of F -stable
unipotent classes in H. It is shown in [L7] that this map coincides with the map
defined by Kawanaka [K1, K2, K3] in terms of generalized Gelfand-Graev characters.
We denote by Cρ (resp. Oρ ) the unipotent class in H (resp. the nilpotent orbit in
Lie H) corresponding to ρ ∈ Irr H under this map. We call Cρ the unipotent class
associated to ρ (the wave front set associated to ρ in the sense of Kawanaka).
                    e this map is given as follows. Let ρe = ρeṡ,E ∈ E(G
     In the case of G,                                                        e F , {ṡ}). Put
  ′                                                      W   ′
E = E ⊗ ε for the sign character ε of Wṡ . Then IndWṡ E contains a unique irreducible
character E b of W such that bE ′ = b b . Cρe is defined as the unipotent class in G         e
                                         E
corresponding to E b under the Springer correspondence. More precisely, we have the
following. Assume that G  e = GLn . Then Wṡ is a product of various symmetric groups.
                      ∧
Accordingly, E ∈ Wṡ is parametrized by a multipartition β = (β1 , . . . , βk ) of n. By
mixing and rearranging the parts in β1 , . . . , βk , we regard β as a partition of n which
we denote by β̄. Let β̄ ∗ be the dual partition of β̄. Then Cρe is the unipotent class in G  e
corresponding to β̄ ∗ through Jordan’s normal form. For general G,     e the description of
Cρe is reduced to the case of GLn through the decomposition G      e = GLn1 × · · · × GLnr .
10

    2.4. Let e             e For a nilpotent element N ∈ e
                  g = Lie G.                                         gF , we denote by ON the
nilpotent orbit in e g containing N. Let P = LU1 be as in 2.1, and let L          e ⊂ Pe be as
                                               ′         F
before. For each irreducible character θ of ZLe (λ) , the modified generalized Gelfand-
                                                     eF
Grave character ΓeN,θ′ is defined as ΓeN,θ′ = IndG   ZL
                                                                  ′
                                                           F F (θ ⊗ ΛN ).
                                                      e (λ) U

    Let ρe = ρeṡ,E be an irreducible character of G    eF , such that Oρe = ON . Then it is
known by [S2, Prop. 2.14] that there exists a unique linear character ϕ of ZLe (λ)F such
that                                             (
                                                   1     if θ′ = ϕ,
                             hΓeN,θ′ , ρeiGe F =
                                                   0     if θ′ 6= ϕ.
We denote by ∆(e
               ρ) the linear character ϕ determined as above. We note that
          ρ) is a linear character of ZLe (λ)F which is trivial on (ZLe (λ)der )F .
(2.4.1) ∆(e
In fact, by [S2, 2.13], ϕ = ∆(e     ρ) is determined in the following way. There exists
                                 f
an F -stable Levi subgroup M of a parabolic subgroup of G          e such that Z e (λ) ⊂ M f
                                                                                  L
and that ṡ ∈ ZM                f∗     e∗                        f
                  f∗ , where M ⊂ G is the dual group of M . We choose an integer
                            F m                                               m
m > 0 such that ṡ ∈ ZM     f∗ , and let ϕb be a linear character of ZLe (λ)F obtained by
restricting the linear character of M  fF m corresponding to ṡ. Then ϕ   b is F -stable, and
the Shintani descent ShF m /F (ϕ)  b coincides with ∆(e  ρ). Since the linear character of
f
M  Fm
       corresponding to ṡ has a trivial restriction on M fF m , we see that ϕb has a trivial
                                                            der
                            Fm                                     F
restriction on (ZLe (λ)der ) , and so ϕ is trivial on (ZLe (λ)der ) . This shows (2.4.1).
     In view of (2.4.1), the restriction θ of ∆(e   ρ) to ZL (λ)F satisfies the property in
(2.1.3). Hnece we can consider Γc,ξ,θ as in 2.1, which tursn out to be a direct summand
of ΓeN,θ′ |GF .
     2.5.      Let (s, E) be as in 1.6. Then ṡ ∈ G       e∗ = GLn1 × · · · × GLnr is written
as ṡ = (ṡ1 , . . . , ṡr ) with ṡi ∈ GLni , and we have Wṡ = W1,ṡ1 × · · · × Wr,ṡr . We now
consider the following special setting for the pair (s, E).
(2.5.1) Let t be a common divisor of n1 , . . . , nr which is prime to p. We have Ωs ≃ hw0 i,
where w0 ∈ Ws is an element of order t permuting the factors of Wi,ṡi transitively, and
                                                                                            ′
Wi,ṡi is isomorphic to Sbi × · · · × Sbi (t times) with bi = ni /t. Moreover, E ∈ (Wṡ∧ )F
is of the form

        E = E1 ⊠ · · · ⊠ Er     where Ei ≃ Ei′ ⊠ · · · ⊠ Ei′ ∈ Wi,∧ṡi with Ei′ ∈ S∧bi .

    Assume that the pair (s, E) satisfies the condition (2.5.1). Then E is Ωs -stable,
                                                                                               ′
and in particular, γx -stable for x ∈ Ωs . Since E is Ωs -stable, we have E ∈ (Wṡ∧ /Ωs )F
and (Ωe s,E )F ′ = (Ωs )F ′ with aE = 1. Hence the bijection in (1.6.1) leaves the pair
(x, E) invariant for x ∈ (Ωs )F ′ . It follows that the set Ts,E coincides with the disjoint
union of Tṡx ,E for x ∈ (Ωs )F ′ .
    Let ρe = ρeṡ,E . It is known that ρe|GF is multiplicity free. Let Tρe = Tṡ,E be as in 1.5.
                                                                    ′       ′
Then Tρe consists of t′ elements, where t′ is the order of ΩFs,E = ΩFs . It follows from
[S2] that (Aλ )F acts transitively on the set Tρe. Thus there exists a quotient (Aλ )′F of
(Aλ )F such that (Aλ )′F is in bijection with Tρe. (Aλ )′F can be written also as (Āλ )F
with some quotient Āλ of Aλ , where Āλ is a cyclic group of order t (see [S2, 2.19]). It
                                                                                             11

can be checked from the proof in [S2, 2.21] that the map AFλ → ĀFλ is surjective. Let
us define a set Ms,N by

(2.5.2)                          Ms,N = (Āλ )F × (ĀFλ )∧ .

The set (ĀFλ )∧ is regarded as a subset of (AFλ )∧ through the map AFλ → ĀFλ . Also
we have a surjective map (Aλ )F → (Āλ )F . We define a subset M0 of M by M0 =
(Aλ )F × (ĀFλ )∧ . Thus we have a natural surjective map f : M0 → Ms,N . The
following result, which gives a parametrization of Ts,E in terms of generalized Gelfand-
Graev characters, is a generalization of the results 2.16 and 2.21 in [S2]. The proof is
done in a similar way as in [S2].

Theorem 2.6. Assume that the pair (s, E) satisfies (2.5.1). Let ρe = ρeṡ,E ∈ Irr G  eF .
                                 g containing N. Let θ be a linear character of ZL (λ)F
Let ON be the nilpotent orbit in e
as in (2.1.3), and θ0 the restriction of θ to ZL0 (λ)F . Then for each pair (c, ξ) ∈ M,
the following holds.
    (i) hΓc,ξ,θ , ρe|GF iGF = 0 unless ON ⊆ O ρe.
   (ii) Assume that Oρe = ON , and let ∆(e           ρ) be as in 2.4.
         (a) If ∆(e   ρ)|ZL0 (λ)F 6= θ0 , then hΓc,ξ,θ , ρe|GF iGF = 0.
         (b) If ∆(e    ρ)|ZL0 (λ)F = θ0 , then there exists a bijection Ts,E ↔ Ms,N satisfying
              the following; Let ρc,ξ ∈ Ts,E be the character corresponding to (c, ξ) ∈
              Ms,E . For each pair (c′ , ξ ′ ) ∈ M0 we have
                                                 (
                                                  1         if f ((c′ , ξ ′)) = (c, ξ),
                         hΓc′ ,ξ′,θ , ρc,ξ iGF =
                                                  0         if f ((c′ , ξ ′)) 6= (c, ξ).

             We have hΓc′ ,ξ′ ,θ , ρ1 iGF = 0 for any ρ1 ∈ Ts,E , if the pair (c′ , ξ ′ ) ∈ M is
             not contained in M0 .
             Furthermore, ∆(e      ρ)|ZL(λ)F is expressed as θξ1♮ for a character ξ1 of AFλ .
             Then ξ1 is contained in (ĀFλ )∧ , and we have
                                                   X
                                    ρe|GF =               ρc,ξ1 .
                                              c∈(Āλ )F




   2.7.     The above parametrization of Ts,E is also interpreted in terms of (not
modified) generalized Gelfand-Graev characters of GF as follows.

(2.7.1) For each x ∈ (Ωs )F ′ and c ∈ (Aλ )F , we have hΓc , ρeṡx ,E |GF iGF = 1, i.e., there
exists a unique irreducible character of GF which occurs both in the decomposition of
ρeṡx ,E |GF and of Γc . Under the parametrization in Theorem 2.6, this character is given
by ρc,ξx for some ξx ∈ (ĀFλ )∧ . In particular, we have
                                                     X
                                  ρeṡx ,E |GF =               ρc,ξx .
                                                   c∈(Āλ )F
12

    By using (2.7.1) we can identify Ms,N with Ms,E in (1.6.3). Note that in this
                                            ′
case, Ms,E is nothing but the set (ΩFs )∧ × (Ωs )F ′ . Also note that the map x 7→ ξx
gives a bijection h : (Ωs )F ′ → (ĀFλ )∧ , where ξx is given by ∆(e     ρṡx ,E )|ZL (λ)F = θξx . By
the discussion in 2.4, we can choose θ such that ∆(e     ρṡ,E )|ZL (λ)F = θ. Then ξ1 (the case
where x = 1) is the trivial character of ĀFλ . Let us write ṡx = ṡzx with zx ∈ ZGe ∗ .
Since ṡx is xF ′ -stable, we have

(2.7.2)                             ṡ−1 ẋṡẋ−1 = zx F (zx )−1 ,
                                                                                                   m
where ẋ ∈ NG∗ (T ∗ ) is a representative of x ∈ (Ωs )F ′ . We may assume that zx ∈ ZGFe ∗
for a large m. Let ψbx′ be the linear character of G            e∗F m corresponding to zx . Since
ṡx , ṡ ∈ Te∗ , and ṡx is xF ′ -stable, ṡ is F ′ -stable, we see that ψbx′ is also F ′ -stable. As
explained in [S2, 2.13], there exists an F -stable Levi subgroup M            f of G e containing Te
such that M    f contains Z e (λ) and that ṡ is contained in the center of the dual group of
                             L
M . This implies that the restriction ψbx of ψbx′ on ZLe (λ)F is F -stable (cf. [S2, Prop.
f                                                                     m


2.14]). We define a linear character ψx of ZLe (λ)F by ψx = ShF m /F (ψbx ). Since ξ1 = 1,
we see that ξx is obtained from the restriction of ψx to ZL (λ)F .
                                                                                ′
       Next, we shall describe the bijection between (Āλ )F and (ΩFs )∧ . There exists a
surjective homomorphism f1 : G          eF /GF → (Āλ )F defined as follows (cf. [S2, 2.19]).
For g ∈ G    eF , we can write g = g1 z, with g1 ∈ G, z ∈ Z e . Then g −1 F (g1 ) ∈ ZG , and
                                                                    G           1
it determines an element in Aλ = ZL (λ)/ZL0 (λ), and so an element in Āλ , which is
unique up to F -conjugacy. On the other hand, we construct f2 : G              eF /GF → (ΩF ′ )∧ as
                                                                                               s
follows. From (2.7.2), we have ṡ−1 ẋṡẋ−1 ∈ ZGFe ∗ (we may choose ẋ ∈ NG∗ (T ∗ )F ), and
                                                                         ′
this defines a well-defined injective homomorphism f2∗ : ΩFs → ZGFe ∗ , x 7→ ṡ−1 ẋṡẋ−1 .
Since Z F ≃ (G      eF /GF )∧ , we have a surjective map f2 as the transpose of f ∗ . Then
          e∗
          G                                                                               2
                                                                         ′
Ker f1 = Ker f2 , and these maps induce the bijection f :            (ΩFs )∧
                                                                      → (Āλ )F .
     Now the parametrization is given as follows. There exists a unique ρ0 ∈ Irr GF such
that ρ0 occurs in ρeṡx ,E |GF and in ΓN . In our parametrization, then ρ0 = ρ1,ξx = ρ1,x
((1, ξx ) ∈ Ms,N , (1, x) ∈ Ms,E ). Then any ρ contained in ρeṡx ,E |GF is obtained as g ρ0
with g ∈ G  eF /GF . We then have ρ = ρc,ξx = ρη,x with c = f1 (g) and η = f2 (g).
     By summing up the above argument, we obtain a bijection
                      ′
                 (ΩFs )∧ × (Ωs )F ′ → (Āλ )F × (ĀFλ )∧      (η, x) 7→ (f (η), ξx).

This gives the required bijection Ms,E ≃ Ms,N .

    2.8. Slightly modifying the arguments in [S2, 4.5], (see the remark below), we
establish a parametrization of E(GF , {s}) as in (1.6.4). We give a bijection Ts,E ↔
                                                    ′
Ms,E for each pair (s, E) such that E ∈ (Wṡ∧ /Ωs )F .

    (a) First we consider the case where the pair (s, E) satisfies the property (2.5.1).
If we put θ = ∆(e ρṡ,E )|ZL (λ)F , then θ satisfies the property (2.1.3). Hence we have a
natural bijection Ts,E ↔ Ms,N ↔ Ms,E by Theorem 2.6 (ii), (b) together with the
argument in 2.7.
                                                                                               13

    (b) Next we consider the case where Ws satisfies the same assumption as in
(2.5.1), but E is not of the form there. So we assume that Ωs (E) 6= Ωs , and put
t′ = |Ωs (E)|. Replacing (s, E) by a certain NW (Wṡ )-conjugate, we may assume that
E can be written as E ≃ E1 ⊠ · · · ⊠ Er , (Ei ∈ Wi,∧ṡ ) with

                       Ei = (Ei1 ⊠ · · · ⊠ Ei1 ) ⊠ · · · ⊠ (Eik ⊠ · · · ⊠ Eik ),

where Ei1 , . . . , Eik are distinct irreducible characters of Sbi with k = t/t′ , and Eij
appears t′ times in the components of Ei . Moreover, Ωs (E) acts transitively on the
                                         ′                                                 ′′
factors Eij . Since E ∈ (Wṡ∧ /Ωs )F , there exists aE ∈ Ωs such that E ∈ (Wṡ∧ )F with
F ′′ = aE F ′ . Let L  e = L e1 × · · · × Ler be an F -stable Levi subgroup of G     e according
                                           e    e            e          e
to the decomposition of E, where Li = Li1 × · · · × Lik with Lij ≃ GLbi t′ . Then Wṡ
coincides with WLe ∗ ,ṡ , the stabilizer of s in WLe ∗ , and F ′′ can be written as F ′′ = F w2
with w2 ∈ WLe ∗ . Moreover, we have Ωs (E) = Ωs,L , a similar group as Ωs for L = L         e ∩ G,
and the pair (s, E) satisfies the condition in (2.5.1) with respect to L. Hence by (a),
          L                                L
the set Ts,E   is parametrized by Ms,E (the super script L denotes the corresponding
object in L). Let Pe be the standard parabolic subgroup of G           e containing L e and put
                                                                           F
P = Pe ∩ G. Then by Lemma 4.2 in [S2], the map ρ0 7→ IndG                P F ρ0 gives a bijection
            L
between Ts,E and Ts,E . Since
                   L            ′′                       ′
                Ms,E = (ΩFs,L )∧ × (Ωs,L )F ′′ = (ΩFs,E )∧ × (Ωs,E )F ′ = Ms,E ,

this gives a bijection Ts,E ↔ Ms,E .

    (c) We consider the general case. Let Wṡ = W1,ṡ1 × · · · × Wr,ṡr , and Ws = Wṡ Ωs .
Here we assume that there exists i such that Ωs acts non-transitively on Wi,ṡi . In this
case, there exists a proper Levi subgroup L∗ of G∗ such that Ws is contained in WL∗
and that L∗ is both F -stable and F ′ -stable. Then ZG∗ (s) is contained in L∗ . Under
this condition, it is known that the twisted induction RLG (ẇ1 ) (see, e.g., [S2, 3.1])
                                  ′
induces a bijection between E(LF , {s}) and E(GF , {s}). By induction hypothesis, we
                                             L       L                              L
may assume that there exists a bijection Ts,E  ↔ Ms,E . Since Ωs (E) = Ωs,L , Ms,E is
identified with Ms,E . Hence we have a bijection Ts,E ↔ Ms,E as asserted.


Remark 2.9. In [S2], 4.5, the parametrization is done through three steps as above.
However, in the step (a), only the pair (s, E) such that ∆(e   ρṡ,E ) = 1 is treated, and it is
stated that other cases are reduced to this the case by considering the linear character
θ of GF corresponding to the central element ż ∈ ZGF ∗ . But this is not true in general.
In fact, if the F -stable class {ṡ′ } in G∗ satisfies the property in (2.5.1), then ṡ′ can
be written as ṡ′ = ż ṡ for an F -stable class {ṡ} such that ∆(e  ρṡ,E ) = 1 with ż ∈ ZG∗ .
                                     F
However, it occurs that ż ∈   / ZG∗ even if the classes {ṡ} and {ż ṡ} are F -stable. In
that case one cannot find a linear character θ of GF corresponding to ż. Hence the
step (a) in [S2] does not cover all the cases, and one needs to consider the cases where
∆(eρṡ,E ) 6= 1 discussed as in 2.8.
14

     3. Character formula for generalized Gelfand-Graev characters

    3.1. For later use, we shall prove a character formula for Γc,ξ , which is a variant of
the formula given in [K3]. Note that Γc,ξ is constructed by using a specific Lagrangian
subspace s of u1 . Following [S2, 2.3], we recall the construction of s. Assume, for
simplicity, that G = SLn . The weighted Dynkin diagram of N is given as follows. Let
Π ⊂ Σ + be the set of simple roots and the set of positive roots of G, which is written
in the form Σ + = {εi − εj | 1 ≤ i < j ≤ n} for certain basis vectors ε1 , . . . , εn of
Rn , and Π = {α1 , . . . , αn−1 } with αi = εi − εi+1 . Assume that N corresponds to a
partition µ = (µ1 ≥ µ2 ≥ · · · ≥ µr > 0) of n via Jordan’s normal form. For each µi ,
put
                             Yi = {µi − 1, µi − 3, . . . , −µi + 1}
                                         `
consisting of µi integers. Then Y = i Yi is a set of n integers (with multiplicities),
and we arrange its elements in a decreasing order,

(3.1.1)                         Y = {ν1 ≥ ν2 ≥ · · · ≥ νn }.

The weighted Dynkin diagram h : Π → Z is given by h(αi ) = νi −νi+1 for 1 ≤ i ≤ n−1.
Let Π1 (resp. LΣ1 ) be the set of α ∈ Π (resp. α ∈ Σ + ) such that h(α) = 1. Clearly
we have g1 = α∈Σ1 gα . The set Σ1 is described as follows. For a given αi ∈ Π1 , let
j be the smallest integer such that j > i and that h(αj ) > 0, and let k be the largest
integer such that k < i and that h(αk ) > 0. We define a subset Ψi of Σ + by

                      Ψi = {εp − εq | k + 1 ≤ p ≤ i, i + 1 ≤ q ≤ j}.

(If j or k does not exist, we put k = 0 or j = n.) Then it is easy to see that Ψi are
mutually disjoint and that
                                          a
                                    Σ1 =      Ψi .
                                             αi ∈Π1

For αi , αj ∈ Π1 such that i < j, we say that Ψi and Ψj are adjacent if αk ∈        / Π1 for
i < k < j. There exists a subset Ψ of Σ1 satisfying the following`properties; Ψ is a
union of the Ψi which are not adjacent each other, and Σ1 = Ψ σ(Ψ), where σ is
the permutation of Σ + induced from the graph automorphism  L          of Π. Note that Ψ is
uniquely determined up to the action of σ. Put s = α∈Ψ gα . Then it was shown in
[S2, 2.3] that s is a Lagrangian subspace in g1 , stable by the action of L.
    In the discussion below, we follow the notation in 2.1. Let V be an n-dimensional
vector space over k on which G acts naturally. We can find a basis {N j vi | 1 ≤
i ≤ r, 0 ≤ j < µi } of V such that N µi vi = 0 and that H acts on N j vi by a scalar
multiplication −µi + 1 + 2j.
    Put M = ZL (λ). Take t ∈ M such that t stabilizes each basis vector N j vi up
to scalar. It follows that t ∈ T1 , where T1 is a maximal torus in L related to the
weighted Dynkin diagram of N. Since G is simply connected, ZG (t) is connected. Put
                                                 ∗                   ∗
zt = Lie ZG (t). Since M = ZG (N)  L ∩ ZG (N ), zt contains N, N , and so it contains H.
If we put (zt )j = gj ∩ zt , zt =     j (zt )j gives the grading of zt associated to N ∈ zt .
             L
Put (ut )j = j ′≥j (zt )j ′ . Then we have (ut )j = uj ∩ zt . In particular, Pt = P ∩ ZG (t)
(resp. Lt = L ∩ ZG (t)) is the parabolic subgroup of ZG (t) (resp. its Levi subgroup)
                                                                                             15

associated to N. Moreover, the restriction of λ : u1 → k to (ut )1 coincides with the
corresponding linear map λt with respect to N. We have the following lemma.
Lemma 3.2. st = s ∩ zt is a Lagrangian subspace of (zt )1 , which is stable by Lt .
Proof. From the above discussion, the symplectic form on (zt )1 is obtained as the
restriction to (zt )1 of the symplectic form on g1 . Hence s∩zt is an anisotropic subspace
of (zt )1 . Also it is clear that s ∩ zt is stable by Lt . Note that T1 is a maximal torus
on which the root system Σ is defined. Then the subroot system Σt of Σ associated
to the group ZG (t) consists of roots εp − εq ∈ Σ such that the corresponding basis
                         ′
vectors N k vl and N k vl′ in V have the eigenvalue 0 for t. (We identify the basis {εi }
and {N j vi } via the total order ν1 , . . . , νn in (3.1.1)). Since t ∈ M, N j vi have the
same eigenvalue for all 1 ≤ j ≤ µi − 1 (i is fixed). It follows that the subroot system
Σt is invariant under the action of σ. Hence      ` Σ1 ∩ Σt is also σ-invariant. If we put
Ψt = Ψ ∩ Σt , then L   we  have  Σ 1 ∩ Σt =  Ψ  t   σ(Ψt ). In particular, |Ψt | = |Σ1 ∩ Σt |/2.
Since s ∩ zt =        α∈Ψt gα , we see that s ∩ zt is a Lagrangian subspace of (zt )1 . The
lemma is proved.                                                                              

     3.3. For c ∈ Aλ , we choose ċ ∈ ZL ⊂ T1 , and take αc ∈ T1 such that αc−1 F (αc ) =
ċ. We consider the c-twisted version of the previous results. In the following, we denote
by Xc the object obtained from X related to G or g by the conjugation or adjoint
action by αc . Then Mc = αc Mαc−1 coincides with ZL (λc ), and we have Mc = ZG (Nc ) ∩
ZG (Nc∗ ), where Nc , Nc∗ , Hc are F -stable TDS-triple. Since αc ∈ L, we have sc = s and
u2,c = u2 . It follows that uc = u for u = s + u2 , and so Uc = U. Let t be a semisimple
element in McF . Put zt = Lie ZG (t), etc., as before. If we put t′ = αc−1 tαc ∈ M, t′
is conjugate to an element in T1 under M 0 ⊂ L (since Mc = Mc0 ZG ). It follows that
s ∩ zt′ is a Lagrangian subspace of (zt′ )1 , and so s ∩ zt = αc (s ∩ (zt′ )1 ) is a Lagrangian
subspace of (zt )1 , which is stable by F . We put st = s ∩ zt . Let ut = st + (ut )2 . Then
we have an F -stable subgroup Ut of ZG (t) such that Lie Ut = ut , which is stable by Lt .
Moreover, ut = u ∩ zt . It follows from this that

(3.3.1)                                 U ∩ ZG (t) = Ut .

     Now λc : u1 → k is the linear map defined as λ, by using Nc instead of N. Then
λc,t = λc |(ut )1 is the linear map on (ut )1 defined by Nc ∈ zt . It follows that the
restriction of Λc : U F → Q̄∗l on UtF coincides with the linear character of UtF defined
in terms of Nc , which we denote by Λc,t .
      3.4. Take a semisimple element s ∈ GF , and assume that there exists g ∈ GF
such that g −1 sg ∈ McF . (Do not confuse s with an element in the dual group G∗ ).
By fixing s, we put Pg = gP g −1 ∩ ZG (s) and Lg = gLg −1 ∩ ZG (s). We apply the
previous argument for t = g −1sg. Then Ng = g Nc is an F -stable nilpotent element in
Lie ZG (s), and Ug = gUt g −1 is the unipotent subgroup of ZG (s) associated to Ng . We
have Pg = gPt g −1 and Lg = gLt g −1 . Moreover λg = Ad g ◦ λc,t is the linear map of
g
  (ut )1 = (us )1 , and Λg = ad g ◦ Λc,t coincides with the linear character of UgF associated
                                                                            Z (s)
to Ng . We define a modified generalized Gelfand-Grave character ΓNgG,1 of ZG (s) by

                                Z (s)        Z (s)F
(3.4.1)                       ΓNgG,1 = IndZGL         F F (1   ⊗ Λg )
                                               g (λg ) Ug
16

associated to Ng ∈ Lie ZG (s).
    The following result gives a description of modified generalized Gelfand-Graev
characters in terms of various modified generalized Gelfand-Graev characters of smaller
groups, which is an extended version of the formula stated in [K3, Lemma 2.3.5].

Proposition 3.5. Assume that s, v ∈ GF such that sv = vs, where s is semisimple
and v is unipotent. Then we have

                               1              X             |ZLg (λg )F | ♮ −1     Z (s)
           Γc,ξ,θ (sv) =                                                 θξ (g sg)ΓNgG,1 (v).
                           |ZG (s)F |                                 F
                                                             |ZL (λc ) |
                                              g∈GF
                                        g −1 sg∈ZL (λc )F


Proof. By definition,
                                     F             
(3.5.1)          Γc,ξ,θ (sv) = IndG           ♮
                                    McF U F θξ ⊗ Λc (sv)
                                                X
                             = |McF U F |−1            (θξ ♮ ⊗ Λc )(g −1 svg).
                                                        g∈GF
                                                  g −1 svg∈McF U F


Here the condition g −1 svg ∈ McF U F in the sum is equivalent to the condition that
g −1vg ∈ McF U F and g −1 sg ∈ McF U F . We note that

                                                                           S
(3.5.2) Any semisimple element in McF U F is contained in                      x∈U F   xMcF x−1 .


     In fact, let T1 be an F -stable maximal torus in L as in 3.1. Then T2 = T1 ∩ M
is a maximal torus in M. Since we can choose ċ ∈ T1 , T2 is also contained in Mc .
Thus T2 is a maximal torus in Mc U. We have NMc U (T2 ) ≃ NMc (T2 )ZU (T2 ). Since U
is a product of one parameter subgroups Uα associated to roots α with respect to T1 ,
ZU (T2 ) is a product of Uα such that α|T2 = Id. It follows that ZU (T2 ) is connected,
and NMc U (T2 )0 = T2 ZU (T2 ). We see that NMc U (T2 )/NMc U (T2 )0 ≃ NMc (T2 )/T2 . This
implies that any F -stable maximal torus in Mc U is taken from Mc up to U F -conjugate.
Since any semisimple element in McF U F is contained in an F -stable maximal torus,
we obtain (3.5.2).


    It follows from (3.5.2) that g −1 sg ∈ xMcF x−1 for some x ∈ U F , i.e., (gx)−1 s(gx) ∈
McF .  It is easy to see that the set {x1 ∈ U F | (gx1 )−1 s(gx1 ) ∈ McF } is given by
xZU ((gx)−1 s(gx))F for some x ∈ U F such that (gx)−1 s(gx) ∈ McF . Hence the last
formula in (3.5.1) implies that
                                 X
     Γc,ξ,θ (sv) = |McF U F |−1            |ZU ((gx)−1s(gx))F |−1 (θξ ♮ ⊗ Λc )(g −1svg).
                                   g∈GF ,x∈U F
                                 g −1 vg∈McF U F
                                g −1 sg∈xMcF x−1
                                                                                                            17

By replacing gx by g, we have
                             X
      Γc,ξ,θ (sv) = |McF |−1                    |ZUF (g −1 sg)|−1θξ ♮ (g −1 sg)(θξ ♮ ⊗ Λc )(g −1 vg)
                                   g∈GF
                             g −1 vg∈McF U F
                               g −1 sg∈McF
                             X           X
                = |McF |−1                             |ZUF (t)|−1 θξ ♮ (t)(θξ ♮ ⊗ Λc )(y −1 v1 y),
                              t       y∈ZG (t)F
                                   y −1 v1 y∈McF U F


where in the first sum in the last formula, t runs over all the semisimple element in McF
such that t = g −1sg for some g ∈ GF . We fix such g for each t, and put v1 = g −1 vg.
    Hence we have v1 ∈ ZG (t)F . Since t normalizes McF and U F , we have

                ZG (t)F ∩ McF U F = (ZG (t)F ∩ ZL (λc )F )(ZG (t)F ∩ U F )
                                        = ZMc (t)F UtF

by (3.3.1). Also we have ZU (t) = Ut by (3.3.1). It follows that we have
                         X |ZM (t)F |
           Γc,ξ,θ (sv) =      c
                                F
                                      θξ ♮ (t)×
                          F
                             |Mc |
                         t∈Mc
                       g −1 sg=t
(3.5.3)                                                            X                                  
                                         F −1
                       × |ZMc (t) |              |UtF |−1                               ♮       −1
                                                                                     (θξ ⊗ Λc )(y v1 y) .
                                                                  y∈ZG (t)F
                                                            y −1 v1 y∈ZMc (t)F UtF


Here we note that y −1v1 y is unipotent. Hence the component of y −1v1 y in ZMc (t)F is
unipotent. Since ξ ♮ is a character of McF which is trivial on Mc0F , it is trivial on the
set of unipotent elements in McF . Also by (2.1.3) θ is trivial on the set of unipotent
elements in McF . It follows that

                        (θξ ♮ ⊗ Λc )(y −1v1 y) = (1 ⊗ Λc )(y −1v1 y).

Then the expression in the parenthesis in (3.5.3) coincides with

                             G Z (t)F                                   Z (s)
                         IndZM        F F (1      ⊗ Λc )(v1 ) = ΓNgG,1 (v)
                                 c (t) Ut


under the conjugation by g ∈ GF . Substituting this into (3.5.3) we obtain the propo-
sition.                                                                            


                 4. Shintani descent and almost characters

                                            m                                                          m
    4.1. We consider the group GF for a positive integer m. We denote by GF /∼F
                                               m
the set of F -twisted conjugacy classes in GF . (In the case where m = 1, the set of
F -twisted classes coincides with the set of conjugacy classes, which we denote simply
18

by GF /∼.) A norm map
                                             m
                            NF m /F : GF /∼F → GF /∼
                                                                               m
is defined by attaching x = F m (α)α−1 to x̂ = α−1 F (α) where x ∈ GF , x̂ ∈ GF and
                   m
α ∈ G. Let C(GF /∼F ) (resp. C(GF /∼)) be the space of F -twisted class functions
       m
on GF (resp. class functions on GF ). A Shintani descent map
                                             m
                            ShF m /F : C(GF /∼F ) → C(GF /∼)

is given by ShF m /F = (NF∗ m /F )−1 , which is a linear isomorphism of vector spaces.
                                                                    m          m
     Let σ = F |GF m . We consider the semidirect product GF hσi of GF with the
                                                                  m
cyclic grouphσi of order m generated by σ. Then the coset GF σ is invariant under the
                           m                   m                                 m
conjugation action of GF , and the set GF σ/∼ is identified with the set GF /∼F via
                                                                      m
the map xσ ↔ x. Now each F -stable irreducible character ρ of GF can be extended to
                                   m
an irreducible character ρe of GF hσi (in m-distinct way), and the restriction ρe|GF m σ to
              m                                      m
the coset GF σ determines an element in C(GF /∼F ) under the above bijection. The
function ρe|GF m σ does not depend on the choice of the extension up to a scalar multiple,
                                                       m                        m
and the collection of those ρe|GF m σ for ρ ∈ (Irr GF )F gives a basis of C(GF /∼F ). In
                                                        m                          m
what follows, we often regard a character f of GF hσi as an element in C(GF /∼F )
                                        m
by considering its restriction to GF σ, if there is no fear of confusion.
      4.2. We shall describe the Shintani descent of the modified generalized Gelfand-
Graev characters. We follow the setting in 2.2. Recall the set M in (2.1.2) and M in
                                                                        m
2.2. Let θ be as in (2.2.1). Hence it is the restriction to ZL (λ)F of an F -stable linear
                            m
character θ′ of ZLe (λ)F . We denote by θ0 the linear character of ZL (λ)F obtained by
restricting the linear character ShF m /F (θ′ ) of ZLe (λ)F . Hence θ0 satisfies the condition
                                                                                        (m)
in (2.1.3). We consider the modified generalized Gelfand-Graev characters Γc,ξ,θ and
Γc1 ,ξ1 ,θ0 for (c, ξ) ∈ M and (c1 , ξ1 ) ∈ M.
                                           (m)
      Let us consider an extension Γec,ξ,θ as in 2.2, which is determined by the choice of
an extension θξ    e ♮ of θξ ♮ to Mc hĉσi. Since c ∈ AF , we may choose ċ ∈ ZL (λ)F . Note
                                                      m
                                                        λ           m
that, under the isomorphism ad βc−1 : ZL (λc )F ≃ ZL (λ)ċF , the linear character θξ ♮
                                                      m
corresponds to a linear character θξ of ZL (λ)ċF , and θξ     e ♮ corresponds to its extension
 e to ZL (λ)ċF m hσi. Take c1 ∈ (Aλ )F . As Aλ = AF m , we may choose an element
θξ
                  m
                                                             λ
ċ1 ∈ ZL (λ)F whose image on Aλ gives a representative of c1 ∈ (Aλ )F . Now the
                                                                  (m)
following proposition describes the Shintani descent of Γec,ξ,θ in terms of Γc1 ,ξ1 ,θ0 . The
proof is done in a similar way as in [S2]. In fact, Theorem 1.10 in [S2] can be extended
to our setting, and the proposition is the direct consequence of the theorem (cf. [S2,
4.11]).
Proposition 4.3. Let the notations be as above. Assume that m is sufficiently divis-
ible. Then we have
                                                   X
             ShF m /F (µ−1   e(m)         F −1 e
                        c,θξ Γc,ξ,θ ) = |Aλ | ξ(σ)   ξ(c1)ξ1 (c)Γc1 ,ξ1 ,θ0 .
                                                   (c1 ,ξ1 )∈M


                                                                                     m
    4.4. We shall describe the set of F -stable irreducible characters of GF in the
case where m is sufficiently divisible. Let {s} be an F -stable class in G∗ , and we
                                                                                            19

assume that s ∈ T ∗ . As in the case of GF , one can find ṡ ∈ Te∗ such that π(ṡ) = s
and that the class {s} is F -stable. Hence F ′ (ṡ) = ṡ for F ′ = F w1 . We choose m
large enough so that ṡ ∈ Te∗F and that F m acts trivially on Ωs . For each E ∈ Wṡ∧ ,
                               m

                (m)        (m)
we denote by Ms,E and Ts,E the set Ms,E and Ts,E as given in 1.4, but replacing F ′
                    m                                        (m)
by F m . Then E(GF , {s}) is a disjoint union of various Ts,E , and the latter set is in
                   (m)                                                    (m)
bijection with Ms,E . By our assumption on m, we have Ms,E = Ω∧s,E × Ωs,E . Let us
                              (m)                          ′          ′          ′
define a subset Ms,E of Ms,E by Ms,E = (Ω∧s,E )F × ΩFs,E , where (Ω∧s,E )F means the
                                                                                      (m)
set of F ′ -stable irreducible characters of Ωs,E . Then by [S2, (4.6.1)], the set (Ts,E )F of
                                       (m)                                           m
F -stable irreducible characters in Ts,E is parametrized by Ms,E , and so E(GF , {s})F
can be described as
                                   m
                                                    a
(4.4.1)                      E(GF , {s})F =                Ms,E .
                                                E∈(Wṡ∧ /Ωs )F ′


    In the case where (s, E) is of the form 2.8 (a), the set Ts,E is also parametrized in
                                             (m)                          (m)
terms of Ms,N . Since m is large enough, Ts,E is parametrized by Ms,N = Āλ × Ā∧λ .
                                       (m)
Then under this parametrization, (Ts,E )F is parametrized by ĀFλ × (Ā∧λ )F .




   4.5. We define a pairing { , } : Ms,E × Ms,E → Q̄∗l as follows. For x = (η, z) ∈
Ms,E and y = (η ′ , z ′ ) ∈ Ms,E ,
                                                ′
(4.5.1)                         {x, y} = |ΩFs,E |−1 η(z ′ )η ′ (z).
                         ′
(Note that η ∈ (Ω∧s,E )F can be viewed as a character of the group (Ωs,E )F ′ .)
   We define a function Rx ∈ C(GF /∼) for each x ∈ Ms,E by
                                             X
(4.5.2)                             Rx =            {x, y}ρy .
                                           y∈Ms,E


    In the case where (s, E) satisfies the property in 2.8 (a), the set Ts,E is also
parametrized by Ms,N = (Āλ )F × (ĀFλ )∧ , and we have a bijection between Ms,E
                                                                 (m)
and Ms,N by 2.7. Put Ms,N = ĀFλ × (Ā∧λ )F . Then the set (Ts,E )F is parametrized by
                                                                                   m
Ms,N . By modifying the argument in 2.7 appropriately to the situation in GF , we
have a bijection between Ms,E and Ms,N . Let θ0 be the linear character of ZL (λ)F
                                                                                 m
obtained by restricting ∆(eρṡ,E ) to ZL (λ)F . The linear character θ of ZL (λ)F is also
defined by using the Shintani descent of ZLe (λ) (cf. 4.2). We say that θ (resp. θ0 ) is
the linear character associated to Ms,N (resp. Ms,N ).
    We define a pairing { , } : Ms,N × Ms,N → Q̄∗l for x = (c, ξ) ∈ Ms,N and
y = (c′ , ξ ′ ) ∈ Ms,N ,

(4.5.3)                          {x, y} = |ĀFλ |−1 ξ(c′ )ξ ′(c).
20

Then the bijections Ms,E ≃ Ms,N , etc., are compatible with those pairings. This
property was used in [S2, 4.11] to connect almost characters defined in terms of Ms,N
to that of Ms,E (in the case where θ = 1, but the proof was omitted there). We give
a proof of this property.


Lemma 4.6. Assume that (s, E) is as in 2.8 (a). Then under the bijections Ms,E ≃
Ms,N , (η, z) ↔ (c, ξ) and Ms,E ≃ Ms,N , (η ′ , z ′ ) ↔ (c′ , ξ ′), we have
                                 ′
                            |ΩFs,E |−1 η(z ′ )η ′ (z) = |ĀFλ |−1 ξ(c′)ξ ′ (c).
                                                 ′           ′
Proof. By our assumption, we have ΩFs,E = ΩFs . It follows from the parametrization
                                           ′
of Irr GF in 1.6 and 2.7, we see that |ΩFs | = |ĀFλ |, which coincides with the number of
irreducible components in ρeṡ,E |GF . Thus, in order to prove the lemma, it is enough to
show that

(4.6.1)                          η(z ′ ) = ξ ′ (c),       η ′ (z) = ξ(c′).
                                                                                           ′
We recall the bijection Ms,E ≃ Ms,N given by h : (Ωs )F ′ → (ĀFλ )∧ and f : (ΩFs )∧ →
(Āλ )F in 2.7. A similar construction gives bijections
                                                                     ′
                          h′ : Ωs → Ā∧λ ,            h′′ : (Ωs )F → (Ā∧λ )F ,
                                                                         ′
                          f ′ : Ω∧s → Āλ ,           f ′′ : (Ω∧s )F → ĀFλ ,
                      ′      ′
and h′′ × f ′′ : (Ω∧s )F × ΩFs → ĀFλ × (Ā∧λ )F gives the bijection Ms,E → Ms,N . We have
                    ′                ′
inclusions (Ωs )F ֒→ Ωs , (Ω∧s )F ֒→ Ω∧s and natural surjections Ωs → (Ωs )F ′ , Ω∧s →
     ′
(ΩFs )∧ . Also we have inclusions (Ā∧λ )F ֒→ Ā∧λ , ĀFλ ֒→ Āλ , and natural surjections
(Āλ )∧ → (ĀFλ )∧ , Āλ → (Āλ )F .
     We want to show that the maps h, h′ , h′′ and f, f ′ , f ′′ are compatible with various
inclusions and surjections given above. First we note that the map h : (Ωs )F ′ → (ĀFλ )∧
is compatible with the extension of the filed, i.e., the following diagram commutes.
                                                      h
                                      (Ωs )F ′ −−−→ (ĀFλ )∧
                                        x              x
                                                      
(4.6.2)                                               
                                                     h0          k
                                     (Ωs )F k −−−→ (ĀFλ )∧ ,

where F k is the map such that F k (ṡ) = ṡ and that F k acts trivially on Ωs , and on Āλ .
h0 is a similar map as h defined by replacing F ′ by F k .
      We show (4.6.2). We choose m large enough so that m is divisible by k. Let
ψx , ψbx , ψbx′ , be the maps given in 2.7 with respect to F ′ . Let y ∈ (Ωs )F k such that its
canonical image in (Ωs )F ′ coincides with x. We may assume that ẋ = ẏ ∈ NG∗ (T ).
We denote by ψy , ψby , ψby′ similar maps constructed by using F k instead of F ′ . In
particular, ψby′ is the linear character of G       e F m corresponding to zy ∈ Z F m such that
                                                                                     e∗
                                                                                     G
ṡ−1 ẋṡẋ−1 = zy F k (zy −1 ). Since zy F k (zy −1 ) = zx F (zx−1 ), one can choose zx and zy so
                                                                                             21

that they satisfy the relation

                                   zx = zy F (zy ) · · · F k−1 (zy ).

It follows that
                                ψbx = ψby F −1 (ψby ) · · · F −k+1(ψby ).
Put ψx′ = ShF m /F k (ψbx ). Since ψy = ShF m /F k (ψby ), we have

                                ψx′ = ψy F −1 (ψy ) · · · F −k+1(ψy ),

and ψx = ShF k /F (ψx′ ). We shall compute the value ψx (t) for t ∈ T F . Take α ∈ T such
                                                           k
that t = F k (α)α−1 , and put t̂ = α−1 F (α). Then t̂ ∈ T F , and we have

             ψx (t) = ψx′ (t̂) = ψy (t̂F (t̂) · · · F k−1(t̂)) = ψy (α−1 F k (α)) = ψy (t)

since α−1 F k (α) = F k (α)α−1 = t. It follows that

(4.6.3)                                   ψx |T F = ψy |T F .

Now for c ∈ ĀFλ , one can choose a representative ċ ∈ ZL (λ)F of c so that ċ ∈ T F . Then
by (4.6.3), we have
                           h(x)(c) = ψx (ċ) = ψy (ċ) = h0 (y)(c).
This proves the commutativity of (4.6.2).
    Next we show that the map f : (Ωs )F ′ → (Āλ )F is compatible with the extension
of the field, i.e., the following diagram commutes.
                                          ′           f
                                     (ΩFs )∧ −−−→ (Āλ )F
                                       x             x
                                                    
(4.6.4)                                             
                                          k           f0
                                     (ΩFs )∧ −−−→ (Āλ )F k ,

where f 0 is a similar map as f defined by replacing F ′ by F k .
   In fact, we consider the following diagram

                             eF /GF        1  π    2        π
                            G            −−−→ ZF −−−→ (Āλ )F
                                  x           x          x
(4.6.5)                   NF k /F 
                                  
                                              
                                              
                                                         
                                                         
                                                  0             0
                            eF k /GF k −−π−
                            G             1         π2
                                           → ZF k −−− → (Āλ )F k ,

where π2 ◦ π1 = f2 , π20 ◦ π10 = f20 , and the second and the third vertical maps are
natural surjections. This diagram turns out to be commutative. In order to show
this, it is enough to see the commutativity of the left square. Take g ∈ G      eF and write
it as g = g1 z with g1 ∈ G, z ∈ ZGe . Then one can find β ∈ G, γ ∈ ZGe such that
g1 = F k (β)β −1, z = F k (γ)γ −1 . Put ĝ1 = β −1 F (β), ẑ = γ −1 F (γ). Since γ ∈ ZGe , we
see that ĝ = ĝ1 ẑ satisfies the condition that NF k /F (ĝ) = g. Hence we have π1 (g) =
22

g1−1F (g1 ) = zF (z −1 ) and π10 (ĝ) = ẑF k (ẑ −1 ). But by using ẑ = γ −1 F (γ), we see easily
that zF (z −1 ) = ẑF k (ẑ −1 ). This shows that the diagram (4.6.5) is commutative.
                                                        ′
      On the other hand, since the map f2∗ : ΩFs → ZGFe ∗ is compatible with the inclusions
    ′       k                k
ΩFs ֒→ ΩFs , ZGFe ∗ ֒→ ZGFe , we have the commutative diagram

                                   GeF /GF      −−−→ (ΩFs )∧
                                                              ′

                                         x             x
(4.6.6)                          NF k /F 
                                         
                                                       
                                                       
                                   eF k /GF k −−−→ (ΩF k )∧ .
                                   G                 s

The commutativity of the diagram (4.6.4) follows from (4.6.5) and (4.6.6).
                                                                                         ′
     Finally, it is easy to check that the maps h′ , h′′ are compatible with (Ωs )F ֒→ Ωs
and (Ā∧λ )F ֒→ Ā∧λ , and the corresponding results hold also for f ′ , f ′′ .
     Now by using the commutativity of h, h′ , h′′ and f, f ′ , f ′′ , one can check that (4.6.1)
is reduced to showing that
(4.6.7) Assume that F (s) = s, and that F acts trivially on Ωs and on Aλ . Then, for
(η, z) ∈ Ω∧s × Ωs and (c, ξ) ∈ Āλ × Ā∧λ , we have η(z) = ξ(c).
    But (4.6.7) is proved in a similar way as the proof of Lemma 3.16 in [ShS], where
                         (m) 2
a similar problem for (Ts,E )F is discussed. Thus Lemma 4.6 is proved.             
                                                                                    m
    The following result gives a description of the Shintani descent of GF in the case
                                                                       (m)
where m is sufficiently divisible. In the following, we denote by ρx the F -stable
                           m                          (m)
irreducible character of GF belonging to the set (Ts,E )F corresponding to x ∈ Ms,E .
Theorem 4.7 ([S2, Theorem 4.7]). Assume that m is sufficiently divisible. For each
 (m)        m                                                              (m)   (m)
ρx ∈ (Irr GF )F corresponding to x = (η, z) ∈ Ms,E , we fix an extension ρ̃x of ρx
     m
to GF hσi. Then we have

                                 ShF m /F (ρ̃x(m) |GF m σ ) = µx Rx ,

where µx is a certain rot of unity. In the case where (s, E) is in (a) of 2.8, µx is given
by an m-th root of unity of θ(ċ−1 )ξ(c−1) under the correspondence (η, z) ↔ (c, ξ) (see
2.2 and 4.5 for the notation).

Remark 4.8.        µx is not given explicitly in [S2]. But the determination of µx is
                                                                                (m)
reduced to the case where (s, E) is in (a) of 2.8. In this case the extension ρ̃x of
 (m)                                    (m)       (m)
ρx is determined by the extension Γec,ξ,θ of Γc,ξ,θ for x = (c, ξ) ∈ Ms,N , which is
determined by the choice of µc,θξ as in 2.2. Then the argument in 4.11 in [S2] gives
the description of µx = µc,θξ .
    4.9. Let L be a Levi subgroup of a standard parabolic subgroup P of G containing
                                                            m
T . Let δ = δ (m) be an irreducible cuspidal character of LF . Let W = NG (L)/L, and
put

                                  Wδ = {w ∈ W | w δ = δ},
                                   Zδ = {w ∈ W | F w δ = δ}.
                                                                                              23

Wδ is naturally regarded as a subgroup of W , and according to Howlett and Lehrer
[HL], Wδ can be decomposed as Wδ = Wδ0 Ωδ , where Wδ0 is a normal subgroup of Wδ
which is a reflection group with a set of simple reflections associated to some root
system Γ ⊂ Σ, and Ωδ is given by

                              Ωδ = {w ∈ Wδ | w(Γ + ) ⊂ Γ + },

where Γ + = Γ ∩ Σ + is the set of positive roots of Γ + . Assume that Zδ 6= ∅. Then Zδ
can be written as Zδ = wδ Wδ for some wδ ∈ W. We choose wδ so that F wδ (Γ + ) ⊂ Γ + ,
and let ẇδ ∈ NG (L) be a representative of wδ . Note that this condition determines
wδ only up to the coset of Ωδ . Let γδ : Wδ → Wδ be the automorphism induced by
the map F wδ . Then γδ stabilizes Wδ0 . Let W       fδ = Wδ hγδ i be the semidirect product of
Wδ with the cyclic group generated by γδ . We denote by (Wδ∧ )γδ the set of γδ -stable
irreducible characters m
                         of Wδ .
                    GF
     Let Pδ = IndP F m δ be the Harish-Chandra induction of δ. We review the results
                                                                m
from [S2, 3.5, 3.6]. The irreducible characters of GF appearing in the decomposition
                                                                   (m)
of Pδ are parametrized by Wδ∧ . We denote by ρE = ρE the irreducible character of
    m
GF corresponding to E ∈ Wδ∧ . Let M be the subgroup of NG (L) generated by L and
w ∈ Wδ . Then it is known ([G], [Le]) that δ can be extended to a representation δe
       m                       m                                             m
of M F . F ẇδ stabilizes M F , and the restriction of F ẇδ on M F is written as σ ẇδ .
                 e and one can extend δe to a representation of M F m hσ ẇδ i. We fix such
F ẇδ stabilizes δ,
an extension of δ, e and denote it also by δ.    e
     Now we have an action of F on Pδ . ρE is F -stable if and only if E ∈ (Wδ∧ )γδ . The
choice of an extension E  e of E to W
                                    fδ -module (and of δ)        e determines an extension of ρE
      Fm
to G hσi, which we denote by ρeEe . We consider the Shintani descent of ρeEe . Then by
Theorem 3.4, one can write ShF m /F (e      ρEe |GF m σ ) = µEe RE , where RE is a certain almost
                 F
character of G , and µEe is a root of unity depending on the choice of E.           e Similarly,
for each y ∈ Wδ , δe is a character of LF hσ ẇδ ẏi. Hence the Shintani descent of δe can
                                               m


be written as
                                              e LF m σẇ ẏ ) = µe Rδ,y
                             ShF m /F ẇδ ẏ (δ|         δ       δ,y
where Rδ,y is the almost character of LF ẇδ ẏ , and µδ,ye is a root of unity depending on

the choice of δe and on y.
                                  G              F ẇ
     Now the twisted induction RL(  ẇ) : C(L         /∼) → C(GF /∼) is defined as in [S2,
3.1]. By using the specialization argument of the Shintani descent identity (see [S2,
Remark 4.13]), we obtain the following.
Proposition 4.10. For each w = wδ y ∈ Zδ , we have
                                       X
                    G
                  RL(                                 e e RE .
                      ẇ) (µδ,y
                            e Rδ,y ) =      Tr (γδ y, E)µ E
                                           E∈(Wδ∧ )γδ


Remark 4.11. The formula in [S2, Remark 4.13] contains a linear character ε :
Wδ → {±1}, y 7→ εy which is trivial on Ωδ . However, we have ε = 1 in our case. In
fact, since ε is a character of Wδ0 , ε is determined by the corresponding formula for
  e
  G
RL(w)
  e    with y ∈ Wδ0 . In that case, the formula is nothing but the decomposition of the
24

                              e
Deligne-Lusztig character RTGe (θ) into irreducible characters for some θ ∈ (TexF )∧ , and
                               x
the assertion is verified by using the explicit description in 1.4.

                       5. Unipotently supported functions

    5.1. Let Guni be the unipotent variety of G. Let IG be the set of all pairs (C, E)
where C is a unipotent class in G and E is an irreducible G-equivariant local system
on C. If we fix u ∈ C, the set of G-equivariant local systems on C is in bijection with
AG (u)∧ . Thus the pair (C, E) is represented by the pair (u, τ ) for τ ∈ AG (u)∧ . Let
MG be the set of triples (L, C0 , E0), up to G-conjugacy, where L is a Levi subgroup
of some parabolic subgroup P of G, and E0 is a cuspidal local system on a unipotent
class C0 in L. It is known by Lusztig [L2, 6.5] that there exists a natural bijection
                                       a
(5.1.1)                     IG ≃              (NG (L)/L)∧ ,
                                    (L,C0 ,E0 )∈MG


which is called the generalized Springer correspondence between unipotent classes in
G and irreducible characters of various Coxeter groups. (Note that NG (L)/L is a
Coxeter group for any (L, C0 , E0 ) ∈ MG .) The set MG gives a partition of IG . A
subset of IG corresponding to some triple (L, C0 , E0 ) ∈ MG is called a block. The
correspondence in (5.1.1) is given more precisely as follows. For each triple (L, C0 , E0 ),
one can associate a semisimple perverse sheaf K on G such that End K ≃ Q̄l [W] with
W = NG (L)/L. Let KE be the simple component of K corresponding to E ∈ W.
Then

(5.1.2)                   KE |Guni = IC(C, E)[dim C + dim ZL0 ]

for some pair (C, E) ∈ IG . The correspondence (C, E) ↔ E gives the required bijection.
     Now F acts naturally on IG and MG by (C, E) 7→ (F −1 (C), F ∗ E), (L, C0, E0 ) 7→
(F (L), F −1 (C0 ), F ∗ E0 ). Let (L, C0 , E0) ∈ MFG and I0 the block corresponding to it.
   −1

Then one can choose L an F -stable Levi subgroup of an F -stable parabolic subgroup
P of G. In that case, C0 is an F -stable unipotent class and E0 is an F -stable local
system. Then F acts on W, and we consider the semidirect product W           f = Whci ,
where c is the automorphism on W induced by F . For each ι = (C, E) ∈ I0 , we put
Kι = KE if ι = (C, E) corresponds to E ∈ W ∧ under (5.1.1). Then Kι is F -stable if
and only if E is F -stable. We choose an isomorphism φ0 : F ∗ E0 −  ∼ E0 so that it induces
                                                                    →
                                                       F
a map of finite order at the stalk of each point in C0 . Then it induces an isomorphism
F ∗K −∼ K, and by choosing a preferred extension of E to W,    f induces an isomorphism
      →
       ∗
φ E : F KE −∼ KE . Since H 0 (KE )|C = E with a0 = − dim C − dim ZL0 , φE induces
            →
                                a

an isomorphism F ∗ E −  ∼ E. We define ψι : F ∗ E −
                        →                           →∼ E by the condition that q (a0 +r)/2 ψι
coincides with the map φE : F ∗ Ha0 (KE ) −    ∼ Ha0 (KE ), where r = dim supp KE . Note
                                               →
that we have
                     a0 + r = (dim G − dim C) − (dim L − dim C0 ).
Then by [L3, 24.2], ψι induces a map of finite order at the stalk of each point in C F .
    5.2. Let VG = C(GF /∼) be the space of GF -invariant functions on GF , and Vuni
the subspace of VG consisting of functions whose supports lie in GFuni . For each pair
                                                                                         25

                                   F
ι = (C, E) ∈ IG , we define Yι ∈ Vuni  by
                                   (
                                     Tr (ψι , Ev )         if v ∈ C F
                          Yι (v) =
                                     0                     otherwise,

where Ev is the stalk of E at v. Then {Yι | ι ∈ IG } gives rise to a basis of Vuni . We
have a natural decomposition
                                          M
(5.2.1)                            Vuni =     VI 0 ,
                                                  I0


where I0 runs over all the F -sable blocks, and VI0 is the subspace of Vuni spanned by
Yι for ι ∈ I0 .
    Let I0 be an F -stable block associated to the triple (L, C0 , E0 ). We assume that L
is an F -stable Levi subgroup of an F -stable parabolic subgroup of G. We denote by Lw
an F -stable Levi subgroup twisted by w ∈ W = NG (L)/L. For a pair ι = (C, E) ∈ IG ,
we put supp (ι) = C. For each ι, ι′ ∈ I0F , put
                                                       ′            0
                     ωι,ι′ =|W|−1 q −(codim C+codim C )/2+dim ZL
(5.2.2)                              X
                             × |GF |      |ZL0Fw |−1 Tr (w, Eι ) Tr (w, Eι′ ),
                                     w∈W


where C = supp (ι), C ′ = supp (ι′ ), and Eι , Eι′ ∈ W ∧ are the ones corresponding to
ι, ι′ via the generalized Springer correspondence. If ι, ι′ ∈ IGF are not in the same
block, we put ωι,ι′ = 0.
      For Kι = KE , put φι = φE . We define Xι ∈ Vuni by
                       X
              Xι (g) =    (−1)a+a0 Tr (φι , Hga (Kι ))q −(a0 +r)/2 (g ∈ GFuni ).
                        a

     We define an equivalence relation ∼ in IG by ι ∼ ι′ if supp ι = supp ι′ . Also we
define a partial order on IG by ι ≤ ι′ if supp ι ⊆ supp ι′ . Assume that ι ∈ I0F . Then
it is known that Xι can be written as
                                          X
(5.2.3)                            Xι =      Pι′ ,ι Yι′ ,
                                             ι′ ∈I0


where Pι′ ,ι ∈ Z. Actually there exists a polynomial Pι′ ,ι (t) ∈ Z[t] such that Pι′ ,ι =
Pι′ ,ι (q). Moreover, Pι′ ,ι = 0 if ι′ 6≤ ι or if ι′ ∼ ι, ι′ 6= ι. Pι,ι = 1. In particular,
{Xι | ι ∈ I0F } gives rise to a basis of VI0 . Moreover, we have

(5.2.4)                           hXι , Xι′ iGF = |GF |−1 ωι,ι′ .


    5.3. Take (L, C0 , E0 ) ∈ MF . In our case (i.e., G is given as in 1.1), C0 is the
regular unipotent class in L0 . We choose u0 ∈ C0F as Jordan’s normal form, and define
             ∼ E0 by the condition that it induces the identity map on the stalk at u0 .
φ0 : F ∗ E 0 −
             →
26

Let I0 be the block corresponding to (L, C0 , E0 ). For ι = (C, E) ∈ I0F , we fix u1 ∈ C F
in Jordan’s normal form. AG (u1 ) is abelian, on which F acts naturally. The set of
GF -conjugacy classes in C F is in bijective correspondence with the group AG (u1 )F . We
denote by ua a representative of the GF -class in C F corresponding to a ∈ AG (u1 )F .
Assume that E corresponds to an F -stable irreducible character τ ∈ AG (u1 )∧ . We
define a function χu1 ,τ ∈ Vuni by
                                        (
                                         τ (ua )    if g ∼GF ua ,
                           χu1 ,τ (g) =
                                         0               / CF .
                                                    if g ∈

     The following result determines the function Yι explicitly.
Proposition 5.4 ([S3]). Assume that ι = (C, E) is represented by (u1 , τ ) as above.
Then we have Yι = χu1 ,τ .

    5.5. By making use of the map log : Guni → gnil (see 2.1), we identify Vuni the
space of GF -invariant functions gFnil . Then the function Yι can be regarded as a function
on OF , where O is the nilpotent orbit corresponding to C such that C = supp (ι).
For each F -stable nilpotent orbit O, we choose a representative N ∈ OF via Jordan’s
normal form corresponding to u1 ∈ C F . Let {N, N ∗ , H} be the TDS-triple. Then
the associated parabolic subgroup PN and its Levi subgroup LN are defined, and we
have the group Aλ = ZLN (λ)/ZL0 N (λ) as in 2.1. For c ∈ (Aλ )F , we consider the
twisted element Nc . Then the generalized Gelfand-Graev character Γc associated to
Nc is defined as in 2.1, which gives an element of Vuni . Now Lusztig gave a formula
expressing Γc in terms of the linear combination of Xι as follows.
Theorem 5.6 ([L7, Theorem 7.3]). Let I0 be an F -stable block corresponding to
(L, C0 , E0 ). Let (Γc )I0 be the projection of Γc onto the subspace VI0 in (5.2.1). Then
                                 X                                   X
                   (Γc )I0 =               q f (ι,ι1 ) ζI−1
                                                          0
                                                            |W| −1
                                                                          Tr (w, Eι ) Tr (w, Eι1 ⊗ ε)
(5.6.1)                      ι,ι ′ ,ι ∈I
                                     1   0                          w∈W

                                                             × |ZL0Fw |Pι′ ,ι (q −1 )Yι′ (−Nc∗ )Xι1 ,

where
                        f (ι, ι1 ) = − dim supp (ι1 )/2 + dim supp (ι)/2
                                   − dim ON /2 + dim(G/ZL0 )/2,

and ζI0 is a fourth root of unity attached to the block I0 . ε is the sign representation
of W (cf. [L7, 5.5]).

Remark 5.7. The restriction of the Fourier transform of Xι (ι ∈ I0 ) on gnil coincides
with Xι up to scalar. The fourth root of unity ζI0 occurs in the description of this scalar
([L7, Proposition 7.2]). ζI0 depends only on the pair (C0 , E0) and does not depend on
G. In our case, I0 is always a regular block, i.e., C0 is the regular unipotent class in
L. In such a case, Digne, Lehrer and Michel [DLM1, Proposition 2.8] determined the
value ζI0 explicitly.
                                                                                          27

    5.8. In order to apply the formula (5.6.1), we need to describe −Nc∗ for a nilpotent
element N ∈ gF . Since −N ∗ ∈ gF is G-conjugate to N, one can write −N ∗ = Nc0
for some c0 ∈ (Aλ )F , i.e., Nc0 = Ad(αc0 )N with αc−1
                                                     0
                                                       F (αc0 ) = ċ0 . We consider Nc for
                                          −1
c ∈ (Aλ )F . Then Nc = Ad(αc )N with αc F (αc ) = ċ. Since ZG → Aλ is surjective, we
may choose ċ ∈ ZG . Now −Nc∗ is obtained as −Nc∗ = Ad(αc )(−N ∗ ). Hence −Nc∗ is
GF -conjugate to Ad(αc αc0 )N. But since ċ ∈ ZG , we have

                        (αc αc0 )−1 F (αc αc0 ) = αc−1
                                                     0
                                                       ċF (αc0 ) = ċċ0 ,

It follows that −Nc∗ is GF -conjugate to Ncc0 .

     5.9. Following [L2, LS], we describe the generalized Springer correspondence
for G explicitly. Let n′ be the largest common divisor of n1 , . . . , nr which is prime to
p. Then ZG is the cyclic group of order n′ . Let u = uµ be a unipotent element in
G corresponding to µ = (µ1 , . . . , µr ), where µi = (µi1 ≥ µi2 ≥ · · · ) is a partition of
ni . Put n′µ be the greatest common divisor of n′ and {µij }. Then AG (u) is a cyclic
group of order n′µ . For each τ ∈ AG (u)∧ , ZG /ZG0 acts on the representation space Vτ
of τ via the homomorphism ZG /ZG0 → AG (u). For each η ∈ (ZG /ZG0 )∧ , we denote by
AG (u)∧η the set of irreducible characters τ ∈ AG (u)∧ such that ZG /ZG0 acts on Vτ via
the character η. We have
                                            (
                                             1      if d|n′µ ,
(5.9.1)                      |AG (u)∧η | =
                                             0      otherwise,

where d is the order of η. Now the generalized Springer correspondence in (5.1.1) is
described as follows: We have a partition
                                         a
                               IG =           (IG )η ,
                                                  0 )∧
                                          η∈(ZG /ZG


where (IG )η is the set of pairs (u, τ ) with τ ∈ AG (u)∧η . Note that τ is uniquely
determined by u if (u, τ ) ∈ (IG )η by (5.9.1), which we denote by τ (u). For each
η ∈ (ZG /ZG0 )∧ of order d, there exists a unique Levi subgroup up to conjugacy such
that the type of L is Ad−1 + · · · + Ad−1 , and a unique cuspidal pair (L, C0 , E0 ). Here
C0 is regular unipotent in L and for u0 ∈ C0 , AL (u0 ) ≃ ZL /ZL0 . E0 is the unique
local system on C0 corresponding to η0 ∈ (ZL /ZL0 )∧ such that η0 ◦ f = η for a natural
homomorphism f : ZG /ZG0 → ZL /ZL0 . Then NG (L)/L ≃ Sn1 /d × · · · × Snr /d , and the
map Eµ 7→ (udµ , τ (udµ )) (dµ = (dµij ) for µ = (µij )) gives the generalized Springer
correspondence

(5.9.2)                            (NG (L)/L)∧ ≃ (IG )η .


     5.10. Assume that G    e=G  e1 × · · · × G
                                              er with n1 = · · · = nr = t. In this case, n′
is the largest divisor of t which is prime to p. From the description of the generalized
Springer correspondence, the partition of IG into blocks is nothing but the partition
of IG into (IG )η . Assume that I0 = (IG )η with η ∈ (ZG /ZG0 )∧ of order d. We shall
28

make the formula (5.6.1) more explicit in the case where N is regular nilpotent, i.e.,
where Γc is the modified Gelfand-Graev characters.

Lemma 5.11. Let G be as before. Assume that N is regular nilpotent. Then for any
ι ∈ I0 = (IG )η ,
                              (         0
                                q (dim ZL −codim supp (ι))/2 ζI−1 η(cc0 )−1 if Eι = ε,
          h(Γc )I0 , Xι iGF =                                   0

                                0                                           otherwise.

Proof. We apply the formula (5.6.1). Since −Nc∗ is regular nilpotent, the non-zero
contribution of Yι′ (−Nc∗ ) occurs only when supp (ι′ ) = ON , the regular nilpotent
orbit. By 5.8, −Nc∗ is GF -conjugate to Ncc0 . Since AG (N) ≃ ZG /ZG0 , we see that
ι′ = (N, η) under the identification η ∈ AG (N)∧ . This implies that Yι′ (−Nc∗ ) = η(cc0 )
by Proposition 5.4. On the other hand, since supp (ι′ ) = ON , Pι′ ,ι = 0 unless ι = ι′ ,
and we have Pι′ ,ι′ = 1 by the property in 5.2. Moreover, under the generalized Springer
correspondence, Eι′ is the identity character of W. Thus (5.6.1) can be written as
                                   X           ′
                                                                     X
            (Γc )I0 = η(cc0 )−1            q f (ι ,ι1 ) ζI−1
                                                           0
                                                             |W|−1          |ZL0Fw | Tr (w, Eι1 ⊗ ε)Xι1 .
                                  ι1 ∈I0                             w∈W


Now by (5.2.2) and (5.2.4), we have
                                                       X                0
      h(Γc )I0 , Xι iGF = ζI−1
                             0
                               η(cc0 )−1 |W|−2                  q (dim ZL −codim supp (ι))/2
                                                       ι1 ∈I0
                             X
                       ×             |ZL0Fw ||ZL0Fw′ |−1 ε(w) Tr (w, Eι1 ) Tr (w ′, Eι1 ) Tr (w ′ , Eι )
                           w,w ′∈W
                                     0
                                                                                      X
                        = q (dim ZL −codim supp (ι))/2 ζI−1
                                                          0
                                                            η(cc0 )−1 |W|−1                    ε(w) Tr (w, Eι ).
                                                                                      w∈W

The lemma follows from this.                                                                                       

     For later applications, we also consider the general case where N is arbitrary.

Lemma 5.12. Assume that N is an arbitrary nilpotent element.
     (i) For any ι ∈ I0F , we have
                                                   ′
                           hΓc , Xι iGF = q g(ι ,ι) ζI−1
                                                       0
                                                         Pι′′ ,ι′ (q −1 )Yι′′ (−Nc∗ ),

         where

         g(ι′ , ι) = (− codimG supp (ι′ ) + dim ZL )/2 + (dim supp (ι) − dim ON )/2

          and ι′ ∈ I0 is such that Eι = Eι′ ⊗ ε, ι′′ is the unique element in I0 such that
          supp (ι′′ ) = ON .
                       ′             ′′
     (ii) t(dim supp (ι )−dim supp (ι ))/2 Pι′′ ,ι′ (t−1 ) is a polynomial in t. It is divisible by t if
          ι′′ 6= ι′ .
                                                                                                                   29

  (iii) There exists the ring of integers A of some fixed cyclotomic field independent
        of the field Fq such that

                               hΓc , Xι iGF ∈ q (dim ZL −codimG supp (ι))/2 A.

Proof. First we show (i). By applying Theorem 5.6, we have
                                      X       ′
  hΓc , Xι iGF = h (Γc )I0 , Xι iGF =   q f (ι ,ι1 ) ζI−1
                                                        0
                                                          |W|−1 ×
                                             ι′ ,ι′′ ,ι1
                  X
              ×         Tr (w, Eι′ ) Tr (w, Eι1 )ε(w)|ZL0Fw |Pι′′ ,ι′ (q −1 )Yι′′ (−Nc∗ )hXι1 , Xι iGF .
                  w∈W


Substituting (5.2.4) into hXι1 , Xι iGF , we have
                          X ′
         hΓc , Xι iGF =    q g(ι ,ι) ζI−1
                                        0
                                          |W|−2
                          ι′ ,ι′′
                                         X                               X                                    
                                    ×              |ZL0Fw ||ZL0Fw′ |−1                               ′
                                                                                  Tr (w, Eι1 ) Tr (w , Eι1 )
                                        w,w ′ ∈W                             ι1

                         × ε(w) Tr (w, Eι′ ) Tr (w , Eι )Pι′′ ,ι′ (q −1 )Yι′′ (−Nc∗ )
                                                                         ′

                       X ′                 X                                    
                          g(ι ,ι) −1     −1
                     =  q        ζI0 |W|        Tr (w, Eι′ ⊗ ε) Tr (w, Eι )
                          ι′ ,ι′′                              w∈W

                                    × Pι′′ ,ι′ (q −1 )Yι′′ (−Nc∗ )

with g(ι′ , ι) as in (i). Hence in the sum, the only ι′ such that Eι = Eι′ ⊗ ε gives the
contribution. On the other hand, the condition Yι′′ (−Nc∗ ) 6= 0 implies that supp (ι′′ ) =
ON . It follows that
                                                           ′
                          hΓc , Xι iGF = q g(ι ,ι) ζI−1
                                                      0
                                                        Pι′′ ,ι′ (q −1 )Yι′′ (−Nc∗ ),

where ι′′ is the unique elements in (I0 )F such that supp (ι′′ ) = ON . This proves the
first statement.
     Next we show (ii). We may assume that G = SLn . By the generalized Springer
correspondence (IG )η ↔ Sn/d , we have supp (ι′ ) = Oλ and supp (ι′′ ) = Oµ , where
λ, µ are partitions of n such that each part is divisible by d. Put ι′ = ιλ , ι′′ = ιµ .
We denote by λ/d, µ/d the partitions of n/d obtained from λ, µ by dividing each part
by d. We consider the group GLn/d and nilpotent orbits Oλ/d , Oµ/d of gln/d . We
have a polynomial Pιµ/d ,ιλ/d associated to GLn/d , defined in a similar way as Pιµ ,ιλ ,
where ιµ/d , ιλ/d are elements in IGLn/d corresponding to Oλ/d , Oµ/d under the Springer
correspondence. Then it is known by [DLM2, Theorem 8.1] that

               t(dim Oµ −dim Oλ )/2 Pιµ ,ιλ (t) = t(dim Oµ/d −dim Oλ/d )/2 Pιµ/d ,ιλ/d (t).
30

It follows that

            t(dim Oλ −dim Oµ )/2 Pιµ ,ιλ (t−1 ) = t(dim Oλ/d −dim Oµ/d )/2 Pιµ/d ,ιλ/d (t−1 ).

But the right hand side of this formula coincides with the Kostka polynomial Kλ/d,µ/d (t)
associated to partitions λ/d, µ/d of n/d (cf. [M, III]), hence it is a polynomial in t.
Then the second assertion of the lemma follows from the well-known properties of
Kostka polynomials.
     Finally we show (iii). We may assume that ζI0 ∈ A and Yι′′ (−Nc∗ ) ∈ A. Thus (iii)
follows from (i) and (ii). The lemma is proved.                                        



                                    6. Character sheaves

    6.1. Following [L3, IV], we review the classification of character sheaves in the
                                                        b the set of character sheaves
case of type A. So let G be as before, and we denote by G
on G. Let S(T ) be the set of local systems of rank 1 on T such that L⊗m ≃ Q̄l for
some m prime to p. Then for each L ∈ S(T ), the subset G  bL of Gb is defined, and we
have                                      a
                                    b=
                                    G          bL .
                                               G
                                                 L∈S(T )

     For each L ∈ S(T ), we put WL = {w ∈ W | w ∗L ≃ L}. Then there exists a
subroot system ΣL of Σ, and WL can be written as WL = ΩL ⋉ WL0 , where WL0 is the
reflection group associated to the root system ΣL , and ΩL = {w ∈ WL | w(ΣL+ ) =
ΣL+ }. If L ∈ S(T ) is F m -stable for some integer m > 0, we fix an isomorphism
              ∼ L so that it induces an identity map on L1 (the stalk at 1 ∈ T F m ). Then
φ : (F m )∗ L →
              −                                                    m
the characteristic function χL,φ gives rise to a character θ ∈ (T F )∧ , which induces an
                                m          m                         m           m
isomorphism between S(T )F and (T F )∧ . Thus we have S(T )F ≃ (T ∗ )F . Since
this isomorphism is compatible with the extension of the filed Fqm , we can identify
S(T ) with T ∗ in this way. Now assume that L ∈ S(T ) corresponds to s ∈ T ∗ . Then
we have WL = Ws , WL0 = Ws0 and ΩL = Ωs in the notation of Section 1.
     In [L3, 17], families in (WL0 )∧ and in WL∧ were introduced. In our case, WL0 is
a product of symmetric groups and a family F in (WL0 )∧ is of the form F = {E}
with E ∈ (WL0 )∧ . Let ΩL,E be the stabilizer of E in ΩL . Then E can be extended
to a character E    e on ΩL,E W 0 . (We choose a canonical extension so that for each
                                L
σ ∈ ΩL,E , E  e gives the preferred extension of E to hσi W 0 ). For each θ ∈ Ω∧ , put
                                                             L                    L,E
 e         ΩL WL0        e          e                                 ′
Eθ = Ind ΩL,E WL  0 (θ ⊗ E). Then Eθ is irreducible, and the family F in WL associated

                  eθ | θ ∈ Ω∧ }. Put
to F consists of {E         L,E


                                      ML,E = ΩL,E × Ω∧L,E .

                                    eθ →
We have an embedding F ′ ֒→ ML,E by E  7 (1, θ).
    6.2. For each L ∈ S(T ) and w ∈ WL , we choose a representative ẇ ∈ NG (T ). By
                                                   bL is defined as the set of character
[L3, 2.4], a complex KẇL ∈ DG is defined. The set G
                                                                                       31

sheaves A such that A is a consistuent of p H i (KẇL ) for some w ∈ WL and some i ∈ Z.
                    eθ ∈ W ∧ be as in 6.1. We define
Let E ∈ (WL0 )∧ and E       L
                               X                       X
                L
                e = |WL |
               RE         −1                    eθ )
                                      Tr (y −1, E          (−1)i+dim G pH i (KyL ),
                   θ
                               y∈WL                    i


which is an element of the subgroup of the Grothendieck group of the perverse sheaves
on G spanned by the character sheaves of G.
     By [L3, Corollary 16.7], a natural map from G   bL to the set of two sided cells of
WL was constructed. We denote by G    bL,F ′ the set of character sheaves A ∈ G  bL such
that the corresponding two sided cell coincides with F . In our case, the family F ′ is
                                                          ′

determined by the choice of E ∈ (WL0 )∧ . Thus we write G             bL,E . We have the
                                                            bL,F ′ as G
                       bL .
following partition of G                  a
                                GbL =             GbL,E .
                                          E∈(WL0 )∧ /ΩL

                                                b
The following result gives a parametrization of G.
                                                                   b L,E ↔ ML,E , A ↔
Proposition 6.3 ([L3, Proposition 18.5]). There exists a bijection G
                                                           ∧
(xA , θA ) satisfying the following property: for any θ ∈ ΩL,E ,
                                  L            −1        −1
                                  e ) = |ΩL,E | εA θ(xA ) ,
                            (A : RE
                                      θ



where εA = (−1)l(xA ) . (l is the restriction of the length function of W to ΩL,E ).

    6.4. Let G  b0 be the set of cuspidal character sheaves on G. We shall describe the
set Gb0 explicitly. By Lemma 18.4 and by the proof of Proposition 18.5 in [L3], G      bL
                                                       0
contains a cuspidal character sheaf if and only if WL = {1} and ΩL = WL is a cyclic
group generated by a Coxeter element in W , which is isomorphic to ZG /ZG0 . They
are indexed by the pair (x, z) where x is a generator of ΩL and z is a representative
                            e is of the form G
of ZG /ZG0 . In particular, G                 e=G  e1 × · · · × G
                                                                er , where G
                                                                           ei ≃ GLt with
t = n/r. Also we note that the character sheaf Ax,z corresponding to the pair (x, z)
has its support in zZG0 × Guni . Under the parametrization in Proposition 6.3, this is
also given in the following form.
(6.4.1) Let G  e be as above. Assume that W 0 = {1} and that ΩL is a cyclic group
                                                L
generated by a Coxeter element, which is isomorphic to ZG /ZG0 . Hence ML,E =
ΩL × Ω∧L . Let (GbL )0 be the set of cuspidal character sheaves in G bL . Then we have

                            bL )0 = {Ax,θ | x ∈ ΩL,0 , θ ∈ Ω∧ },
                           (G                               L

where ΩL,0 is the set of x ∈ ΩL such that x is a generator of ΩL .
    6.5. The set (G   bL )0 is also given in terms of intersection cohomology complexes
as follows. Let C be the regular unipotent class in G, and we choose a representative
u1 ∈ GF . For each z ∈ ZG /ZG0 , we choose a representative ż ∈ ZG . Then żC is a
conjugacy class of G containing żu1 and the component group AG (żu1) coincides with
AG (u1 ) ≃ ZG /ZG0 . We denote by Eη the irreducible local system on żC corresponding
32

to η ∈ AG (żu1 )∧ . Put Σ = zZG0 C = ZG0 × żC, and consider a local system Q̄l ⊠ Eη on
Σ associated to (z, η) ∈ ZG /ZG0 × AG (żu1 )∧ . We define a perverse sheaf Az,η on Σ by

(6.5.1)       Az,η = IC(Σ, Q̄l ⊠ Eη )[dim Σ] = Q̄l ⊠ IC(żC, Eη )[dim ZG0 + dim C].

Then Az,η ∈ G. b Let E be a local system of G of rank 1 obtained as the inverse image
under the map G → G/Gder of a local system E ′ ∈ S(G/Gder ). We have E ⊗ Az,η ∈ G.       b
              ∧                            ∧
Let AG (żu1 )0 be the subset of AG (żu1 ) consisting of faithful characters of AG (żu1 ).
Then we have

(6.5.2)          b0 = {E ⊗ Az,η | z ∈ ZG /Z 0 , η ∈ AG (żu1 )∧ , E ′ ∈ S(G/Gder )}.
                 G                         G                  0


    We now consider the Fq -structure of G, and let G   b F (resp. G
                                                                   bF ) be the set of F -
                                                                     0
stable character sheaves (resp. F -stable cuspidal character sheaves ) of G. The regular
unipotent class C is F -stable, and we choose u1 ∈ C F such that u1 is given by Jordan’s
normal form. Also we can choose a representative ż ∈ ZGF . Then G  bF is given as
                                                                       0


(6.5.3)      bF = {E ⊗ Az,η | z ∈ (ZG /Z 0 )F , η ∈ (AG (żu1)∧ )F , E|żZ 0 :F -stable}.
             G 0                        G                     0           G


Put y = (z, η), and assume that Ay = Az,η is F -stable. We have F ∗ Eη ≃ Eη , and
choose an isomorphism ϕ0 : F ∗ Eη −     →∼ Eη by the requirement that ϕ0 induces an iden-
tity map on the stalk at żu1 ∈ (żC)F . ϕ0 induces an isomorphism ϕ         e0 : F ∗ Ay ≃ Ay .
               −d                                              0
Note that H (Ay )|zZG0 C = Q̄l ⊠ Eη , where d = dim ZG + dim C. Then we define
                                                                                      0
φy : F ∗ Ay −∼ Ay by the condition that φy = q (dim G−d)/2 ϕ
             →                                                  e0 = q (codim C−dim ZG )/2 ϕ
                                                                                           e0 on
Hg−d (Ay ) (g ∈ (zZG0 C)F ). We denote by χy the characteristic function χAy ,φy associated
to Ay and φy . Now, for each ż ∈ ZGF , the left multiplication ż : C → żC induces, un-
der the identification AG (żu1 ) ≃ AG (u1 ), the isomorphism ż ∗ IC(żC, Eη ) → ∼ IC(C, Eη )
                                                                                  −
compatible with the Fq -structure. Recall that for the cuspidal pair ι0 = (C, Eη ) ∈ IG ,
one can attach the function Xι0 ∈ Vuni as in 5.2. Then we see easily that
                   (                  0                                                    F
                      q (codim C−dim ZG )/2 Xι0 (v)  if g = żz1 v with z1 ∈ ZG0F , v ∈ C ,
(6.5.4) χy (g) =
                      0                              otherwise.

     More generally, we consider E ⊗ Ay with E ′ ∈ S(G/Gder ) such that E|żZG0 is F -
stable. Put E1 = E|żZG0 . The isomorphism ϕ1 : F ∗ E1 −      ∼ E1 is described as follows.
                                                              →
Put E2 = E|T . There exists an integer m > 0 such that E2 is F m -stable. We choose
                ∼ E2 so that it induces the identity map on the stalk at 1 ∈ T F m . Then
ϕ2 : (F m )∗ E2 −
                →                                                                  m
the characteristic function χE2 ,ϕ2 coincides with a linear character ψ ∈ (T F )∧ . Let V
                           m                                                          Fm
be a one dimensional T F -module affording ψ. We consider the quotient T ×T V of
               m
T × V by T F under the action t1 : (t, v) 7→ (tt−11 , t1 v). Then  E2 is realized as the local
                                                               m
                                                            TF                       m
system associated to the locally trivial fibration f : T ×       V → T , (t, v) 7→ tq −1 . For
                                               m
ż ∈ T F , one can choose α ∈ T such that αq −1 = ż. Now f −1 (żZG0 ) can be identified
                0F m                                                            0F m
with αZG0 ×ZG V , and E1 is the local system associated to f1 : αZG0 ×ZG V → żZG0
                                                                                            33
                                                                                     m
with f1 = f |f −1 (żZG0 ) . Since E|żZG0 is F -stable, the restriction of ψ on żZG0F is F -
stable. Since ż ∈ ZGF , ψ|ZG0F m is also F -stable. Hence we may assume that V satisfies
                                                  m
the property that F (t)v = tv for t ∈ Z 0F , v ∈ V . Moreover, since ż ∈ T F , we have
                          m
ẑ = α−1 F (α) ∈ T F . It follows that we have a well-defined automorphism F on
        0F m
αZG0 ×ZG V given by

(6.5.5)                    F (αt, v) = (F (αt), v) = (αF (t), ẑv)
                        0F m
for (αt, v) ∈ αZG0 ×ZG V . The map f1 is compatible with the actions of F on
          0F m
αZG0 ×ZG V and on żZG0 (the natural action). Hence F defines an isomorphism
             ∼ E1 .
ϕ1 : F ∗ E 1 −
             →
    We define a character θ0 ∈ (ZG0F )∧ by θ0 = ShF m /F (ψ|ZG0F m ). Then the previous
argument implies, in view of (6.5.5), that

(6.5.6)                   χE1 ,φ1 (żz1 ) = ψ(ẑ)θ0 (z1 ) (z1 ∈ ZG0F ).

We now define an isomorphism φ0 : F ∗ (E1 ⊗ Ay ) →  ∼ E1 ⊗ Ay by φ0 = ϕ1 ⊗ φy , which is
                                                    −
                                 ∗
regarded as an isomorphism F (E ⊗Ay ) −    ∼ E ⊗Ay . We denote by χE,y the characteristic
                                           →
function χE⊗Ay ,φ0 . It follows from (6.5.6) that we have
                                                                          F
(6.5.7)          χE,y (z1 g) = ψ(ẑ)θ0 (z1 )χy (g)     (z1 ∈ ZG0F , g ∈ żC ).

     6.6.     We consider the map f : ZG0 ֒→ G → G/Gder . Then f (ZG0 ) can be
identified with ZG0 /ZG0 ∩ Gder , and ZG0 → ZG0 /ZG0 ∩ Gder is a finite étale covering. It
follows that we have an isomorphism S(ZG0 ) ≃ S(ZG0 /ZG0 ∩ Gder ) and a surjective map
S(G/Gder ) → S(ZG0 /ZG0 ∩ Gder ). This implies that all the tame local systems (resp.
F -stable tame local systems) on ZG0 are obtained as the pull back from tame local
systems on G/Gder (resp. tame local systems on G/Gder such that its restriction on
ZG0 is F -stable) by the map f .
     This fact can be explained in the following way from a view point of Shintani
                                       m        m        m     m
descent. We consider a map f : ZG0F ֒→ GF → GF /GFder for sufficiently divisible
                                                  m    m
integer m. Let θ′ be a linear character of GF /GFder . Then θ1 = θ′ ◦ f is a linear
                  m                         m       m
character of ZG0F whose restriction to ZG0F ∩GFder is trivial, and all such characters of
     m                                                                    m     m
ZG0F are obtained by the pull back by f from a linear character of GF /GFder . We now
                                        m
consider the norm map NF m /F : ZG0F → ZG0F , which is a surjective homomorphism
                            m
with kernel K = {z ∈ Z 0F | zF (z) · · · F m−1 (z) = 1}. Now the Shintani descent gives
a bijection between the set of irreducible characters of ZG0F and the set of irreducible
                    m
characters of ZG0F whose restriction on K is trivial. Since ZG0 ∩ Gder is an F -stable
finite set, we see that ZG0 ∩ Gder ⊂ K if m is chosen large enough. In particular, any
irreducible character θ0 of ZG0F can be obtained as ShF m /F (θ1 ) with θ1 = θ′ ◦ f , where
                               m     m
θ′ is a linear character of GF /GFder such that θ1 is F -stable.
    6.7.    Let L e be a Levi subgroup of the standard parabolic subgroup Pe of G      e
containing T , and put L = G ∩ L.e Assume that L contains a cuspidal character sheaf.
Then by 6.4, L e is of the form L
                                e=Le1 × · · · × L
                                                er , where L
                                                           ei ≃ GLd × · · · × GLd (ni /d-
times) for a fixed d. Under the notation of 6.5 applied to L, let A0 = E ⊗ Az,η be the
34

cuspidal character sheaf on L, where z ∈ ZL /ZL0 and η ∈ AL (żu1 )∧ with u1 ∈ C (C is
the regular unipotent class in L), and E ′ ∈ S(L/Lder ). Let K = indG
                                                                    P A0 be the induced
complex of G. Then K is a semisimple perverse sheaf whose simple components are
character sheaves on G. All the characters sheaves on G are obtained in this way
by decomposing a suitable K. Let E1 be the tame local system on zZL0 obtained by
restricting E on zZL0 . Let WL be the Weyl subgroup of W corresponding to L, and
put
                        WE1 = {w ∈ NW (WL ) | w ∗ E1 ≃ E1 }/WL .
Let End K be the endomorphism algebra of K in MG, and Q̄l [WE1 ] be the group
algebra of WE1 over Q̄l . We note that

(6.7.1)                           End K ≃ Q̄l [WE1 ].

In fact it is known by [L3, 10.2] that End K is isomorphic to the twisted group algebra
of WE1 . By a general principle, we have only to show that K contains a character
sheaf with multiplicity one. Let A1 = E ⊗ A1,η be the cuspidal character sheaf in the
case where z = 1, and put K1 = indG                                                     0
                                       P A1 . We may choose a representative ż of ZL /ZL
so that ż ∈ ZG . Then we have ż ∗ K ≃ K1 , and it is enough to consider the case where
z = 1, i.e., K = K1 . But in this case, it is known by [L4, 2.4] that End K ≃ Q̄l [WE1 ].
This shows (6.7.1).
    In view of the discussion in 6.6, (6.7.1) is interpreted also in the following form.
Take m large enough so that E ′ is F m -stable. Let θ′ be the linear character of
            m                                                         m
(L/Lder )F corresponding to E ′, and θ the linear character of LF obtained by the
                                                        m
pull back of θ′ . Let θ1 be the restriction of θ on ZL0F and put

                        Wθ1 = {w ∈ NW (WL ) | w θ1 = θ1 }/WL .

Then we have

(6.7.2)                               WE1 ≃ Wθ1 .

    6.8. We keep the notation in 6.7. We denote by AE the character sheaf occurring
as the simple component in K corresponding to E ∈ End K. For each AE ∈ G    bF , we
                             ∼ AE . Assume that Az,η is F -stable, and put
shall determine φAE : F ∗ AE −
                             →
                      ZE1 = {w ∈ NW (WL ) | (F w)∗E1 ≃ E1 }/WL .

By [L3, II, 10.2], we see that

                     ZE1 ≃ {w ∈ NW (WL ) | (F w)∗A0 ≃ A0 }/WL .

    Now any w ∈ ZE1 can be written as w = wE1 y with y ∈ WE1 . F wE1 induces
an automorphism γE1 : WE1 → WE1 . For each w ∈ ZE1 , let Lw ⊂ P w be the F -
stable Levi, and parabolic subgroup of G obtained from L ⊂ P by twisting w, so that
(Lw )F ≃ LF ẇ , etc. (Note that this definition of Lw etc. is not the same as Lw given
                                                            ′
in [L3, II, 10.6]. Lw defined there coincides with our Lw with w ′ = F −1 (w −1). The
formulas below are derived from [L3, II] under a suitable modification.) We denote by
                                                                                                          35

Aw     w                                                    w
  0 , K the corresponding cuspidal character sheaf on L and the induced complex on
G. Then we have K w = indG      w
                           P w A0 . By applying the arguments in 6.5 to the F w-stable
                                                                ∗ w ∼
subgroups L ⊂ P , one can construct ϕw
             w     w                                 w
                                             0 = ϕ1 ⊗ ϕ  ew0 : F A0 −
                                                                    →  Aw             w
                                                                         0 , where ϕ1 , ϕew
                                                                                          0
are constructed from ϕ1 : (F w)∗E1 −∼
                                    → E 1 , ϕ
                                            e 0 : (F w)F ∗
                                                           Ay ∼
                                                              →
                                                              − Ay as in 6.5  (replacing  F
by F w). Put φw      b0 w
               0 = q ϕ0 , where

                                   b0 = (codimL C0 − dim ZL0 )/2
                                                      ∗ w ∼
with the regular unpotent class C0 in L. Now ϕw 0 : F A0 −
                                                              w
                                                          → A0 induces an isomorphism
  w     ∗ w ∼    w
ϕ :F K −    →K .
    We look at the special case where w = wE1 . Then AE occurring in K w is F -stable
if and only if E ∈ WE1 is γE1 -stable. We fix a preferred extension E e of E for each
          ∧ ωE1          w     ∗ w ∼    w                                    ∗  ∼ AE
E ∈ (WE1 ) . Then ϕ : F K −        → K induces an isomorphism ϕAE : F AE −      →
satisfying the following formula (cf. [L3, 10.4, 10.6]). For each w = wE1 y ∈ ZE1 , we
have
                                     X
(6.8.1)                χK w ,ϕw =                      e A ,ϕ ,
                                            Tr (γE1 y, E)χ E AE
                                                    γE
                                         E∈(WE∧ )     1
                                                1



   We define a normalized isomorphism φAE : F ∗ AE −     ∼ AE by φAE = q b0 ϕAE . In
                                                         →
general, for an F -stable character sheaf A = AE , we put φA = φAE , and we denote by
χA the characteristic function χA,φA for A ∈ GbF .


                                    7. Lusztig’s conjecture

     7.1. We give a description of cuspidal irreducible characters of GF . Assume that
Ms,E contains a cuspidal character. Then there exists ṡx ∈ Te such that π(ṡx ) = s,
ṡx is a regular semisimple element such that Zṡx consists of a Coxeter element in W .
                                                       eF , where E is the trivial character
Wṡx = {1}, and ρeṡx ,E gives a cuspidal character of G
                0
of Wṡx = Ws . We assume further that the pair (s, E) = (s, 1) is of the form as in
(2.5.1). Then Ws = Ωs , and Ωs is a cyclic group generated by w0 . G           e is of the form
Ge=G   e1 ×· · ·× Ger , where Gei = GLt with t = n/r for an integer t prime to p. Moreover,
w0 = (wc , . . . , wc ) with a cyclic permutation wc = (1, 2, . . . , t) ∈ St . Then {s} is an
F -stable regular semisimple class in G∗ such that Ωs ≃ Z/tZ, which is unique modulo
ZG∗ . We make the following specific choice of s.
(7.1.1) Let ṡ = (ṡ1 , . . . , ṡr ) ∈ Te∗ = Te1∗ × · · · × Ter∗ such that ṡi = Diag(1, ζ, . . . , ζ t−1 ),
where ζ is a primitive t-th root of unity in Fq . Put s = π(ṡ).
     Let s′ be a regular semisimple element such that {s′ } is F -stable and that Ωs′ ≃
Z/tZ. Since they are unique modulo ZG∗ , s′ can be written as s′ = zs with z ∈ ZG∗ . If
z ∈ ZGF ∗ , then z determines a linear character θ of GF under the natural isomorphism
ZGF ∗ ≃ (GF /GFder )∧ . The parameter set Ms,E and Msz,E are then naturally identified,
and we have a bijection Ts,E ≃ Tsz,E via ρy ↔ θ ⊗ ρy with y ∈ Ms,E .
     Assume that ṡ is as in (7.1.1). We assume further that F acts trivially on ZG /ZG0 .
Since ZG /ZG0 ≃ Z/tZ, F stabilizes ζ. Hence F (ṡ) = ṡ and so F ′ = F . Moreover, F ′
36

acts trivially on Ωs , and we have

                                      Ms,E = Ω∧s × Ωs .

By 2.8 (a), Ms,E is in bijection with Ms,N . Since ṡ is regular semisimple, Oρe for
ρe = ρeṡ,E is the regular nilpotent orbit. So we assume that N is regular nilpotent.
In this case, PeN = B  e and LeN = Te, and Aλ ≃ ZG /Z 0 . Since AF ≃ Z/tZ, we have
                                                       G           λ
Aλ = Aλ , and so Ms,N = Aλ × A∧λ . Let (Aλ )∧0 be the set of faithful characters of Aλ .
We show
Lemma 7.2. Let ṡ and s = π(ṡ) be as in (7.1.1). Assume that F acts trivially on
ZG /ZG0 .
    (i) For each x ∈ Ωs , we have ∆(e   ρṡx ,E )|ZG0F = 1.
   (ii) Assume further that q ≡ 1 (mod 4) if t = 2. Then for each (c, ξ) ∈ Ms,N ,
         ρc,ξ ∈ Ts,E is cuspidal if and only if ξ ∈ (Aλ )∧0 .
                                                               eF . ∆(e
Proof. For each x ∈ (Ωs )F ′ = Ωs , we consider ρeṡx ,E ∈ Irr G      ρṡx ,E ) is determined
from ṡx as in 2.4 by using an F -stable Levi subgroup M      f of an F -stable parabolic
               e
subgroup of G. Assume that ṡx ∈ T      e ∗xF
                                              for x ∈ Ωs . In the case where N is regular
nilpotent, M coincides with T . We now choose m ≥ 1 such that ṡx ∈ Te∗F and
            f                    e                                                      m


that (xF )m = F m . Then by the duality of the torus, there exists an xF -stable linear
character Θ of TeF corresponding to ṡx . The Shintani descent ShF m /xF (Θ) = Θ0
                        m


gives rise to a linear character of TexF . The restriction of Θ0 on ZGxF = ZGF gives the
character ∆(e ρṡx ,E ).
    Following the arguments in [S2, Corollary 2.21], we give a more precise description
                                                                             m         m
of Θ and Θ0 . Since π(ṡx ) = π(ṡ) = s, there exists zx ∈ (ker π)F ⊂ ZGFe ∗ such
that ṡx = ṡzx . Hence there exists an F -stable linear character Θ       b of TeF m and a
linear character ωx of G   eF such that Θ = Θω
                             m
                                                  b x . Now there exists a decomposition
Te = Te1+ × · · · × Tet+ such that Tei+ are all F -stable, and x permutes the factors Tei+ .
According to this decomposition of Te, ωx can be written as

                                  ωx |TeF m = ωx1 ⊠ · · · ⊠ ωx1 ,
                                         m          m
where ωx1 is a linear character of Tei+F ≃ Te1+F . Here ωx1 is expressed as ωx1 (y1 ) =
                            m
ω x (det y1 ) for y1 ∈ Te1+F , where ω x is a homomorphism F∗qm → Q̄∗l . Under the
decomposition of Te into Tei+ , ZG0 can be identified with the set of y = (y1 , y1, . . . , y1 )
(t-times) such that det y1 = 1. It follows that ωx |ZG0F m = 1. On the other hand, our
choice of ṡ implies that Θb is written on TeF m as

                                   b = 1 ⊠ a ⊠ · · · ⊠ at−1
                                   Θ

with at = 1. We may assume that the generator w0 ∈ Ωs permutes the factors Tei+
by w0 (Tei+ ) = Tei+1
                   +
                      for i ∈ Z/tZ. Put x = w0 . Since Θ       b is F -stable and Θωb x is xF -
                                                                           b Z 0F m = 1. Hence
stable, we see that a = (ωx1 )−1 F (ωx1 ) = (ωx1 )q−1 . This implies that Θ|   G
Θ|ZG0F m = 1, and we see that Θ0 |ZG0F = 1. This proves the first assertion.
                                                                                              37

     By the previous argument, the restriction of Θ0 on ZGF gives rise to a character
ξx ∈ A∧λ . We know that ρeṡx ,E is cuspidal if and only if x is a generator of Ωs , and that all
the cuspidal irreducible characters in Ts,E are obtained as the irreducible components
ρc,ξx in ρeṡx ,E |GF . Hence in order to prove the second assertion, we have only to show
that ξx ∈ (Aλ )∧0 if x is a generator of Ωs . First we show the following.

(7.2.1) Assume that x = w0 . Then ξx is a faithful character.

    It is easy to see that ωx |Z Fe m is F -stable. Put ω0 = ShF m /F (ωx |Z Fe m ). Let us
                                   G                                              G
choose y ∈ ZGF such that the image of y in ZG /ZG0 = Aλ is a generator of Aλ . Then
y = (y1 , . . . , y1 ) ∈ ZGF with det y1 a primitive t-th root of unity. By a similar argument
as in [S2, p.208 - p.209], we see that ω0 (y) is a primitive t-th root of unity. On the
other hand, put Θ1 = ShF m /F (Θ|        b F m ). Any element z ∈ Z F m can be written as
                                           Ze                            e
                                                                         G
                                            G
                                 e +F m
z = (z1 , . . . , z1 ) with z1 ∈ T
                               1        and

                        b
                        Θ(z) = at(t−1)/2 (z1 ) = (ωx1 )t(t−1)(q−1)/2 (z1 ).

Since at = 1, we have (ωx1 )t(q−1) = 1. It follows that Θ   b 2 |Z F m = 1 and so Θ 2 = 1.
                                                                   e               1
                                                                  G
Since Θ0 |Z Fe = Θ1 ω0 , we see that ξx is a faithful character if t > 2. So assume that
           G
t = 2. Let y = (y1, y1 ) ∈ ZGFe be such that det y1 = −1. We have only to show that
                                      m
Θ1 (y) = 1. Take z = (z1 , z1 ) ∈ ZGFe such that NF m /F (z) = y. Then it is easy to see
that NF m /F (det z1 ) = det y1 = −1. Then we have

                                b
                       Θ1 (y) = Θ(z) = (ωx1 )q−1 (z1 ) = ω xq−1 (det z1 ).

Since (ωx1 )2(q−1) = 1, we may assume that (ωx1 )q−1 is a character of order 2. Hence
(ω x )q−1 is the unique character of order 2 of F∗qm , and one can write as (ω x )q−1 =
θ ◦ NF m /F , where θ is the unique character of order 2 of F∗q , i.e., θ(x) = x(q−1)/2 for
x ∈ F∗q . It follows that

                          ω xq−1 (det z1 ) = θ(−1) = (−1)(q−1)/2 = 1

since q ≡ 1 (mod 4) by our assumption. Hence we have Θ1 (y) = 1, and ξx is faithful
in this case also. Thus (7.2.1) is proved.
    If we replace x by xj for some j, then we have ShF m /F (ωxj |Z Fe m ) = ω0j and the
                                                                              G
previous argument shows that ShF m /xj F (Θ|Z Fe m ) = Θ1 ω0j . Since ω0j (y i ) are all distinct
                                                   G
for i = 1, . . . , t if j is prime to t, we see that ξxj is faithful if j is a generator of Ωs .
This proves the second assertion, and the lemma follows.                                       


    7.3. We preserve the setting in 7.1. Removing the assumption on F , we consider
the sets Ms,N = (Aλ )F × (AFλ )∧ and Ms,N = AFλ × (A∧λ )F , which are in bijection with
Ms,E and Ms,E . Since Aλ = Āλ , we have M0 = Ms,N . Applying Lemma 7.2 to the
               m
situation in GF , we have the following corollary.
38

Corollary 7.4. Assume that m is sufficiently divisible so that F m satisfies the as-
sumption in Lemma 7.2 with respect to F . Let s′ be a regular semisimple element in
                                                                               m
G∗ such that Ms′,E contains an F -stable cuspidal irreducible character of GF . Then
                                                            e ≃G
    (i) The pair (s′ , E) is of the from as in 2.8 (a), and G    e1 × · · · × G
                                                                              er , where
        ei ≃ GLt with t = n/r, and {s′ } is the unique regular semisimple class modulo
        G
                                                                     (m)
          ZG∗ such that Ws′ = Ωs′ ≃ Z/tZ. In particular, (Ts′ ,E )F is parametrized by
          Ms′ ,N , where N is a regular nilpotent element in gF .
     (ii) Let (A∧λ )F0 be the set of F -stable, faithful characters of Aλ = ZG /ZG0 . Then
                                           (m)                (m)
          under the parametrization (Ts′ ,E )F ↔ Ms′ ,N , ρc,ξ is cuspidal if and only if
          ξ ∈ (A∧λ )F0 .
Proof. Since s′ is regular semisimple, the pair (s′ , E) is of type (a) or (c) in 2.8. But it
is easy to see that in case (c), Ms,E does not contain a cuspidal irreducible character.
(Note that by the Shintani descent theory, Lusztig induction RLG (ẇ1 ) corresponds to
                                           m     m
the Harish-Chandra induction from LF to GF ). Hence (s′ , E) is of type (a), and (i)
follows from 7.1. Now by 7.1, s′ can be written as s′ = zs, where s is as in (7.1.1) and
                                           m
z ∈ ZG∗ . We may assume that z ∈ ZGF ∗ by choosing m large enough. Thus we have
                       (m)      (m)                                     (m)        (m)
a natural bijection Ts′ ,E ≃ Ts,E by 7.1 under the identification Ms′ ,N = Ms,N . Since
F m acts trivially on Aλ , (ii) follows from Lemma 7.2.                                    
     We note the following lemma.
Lemma 7.5. Let s′ be as in 7.1 and θ = ∆(e       ρṡ′ ,E )|ZGF the linear character of ZGF . Let
Rz,η be the almost character of GF for (z, η) ∈ Ms′,N under the bijection Ms′ ,N ≃
Ms′ ,E . Let Γc,ξ,τ ′ be the modified generalized Gelfand-Graev character associated to
(c, ξ) ∈ M0 = Ms′ ,N and to a linear character θ′ of ZGF . Then we have
                                 (
                                  η(c)ξ(z)|(ZG /ZG0 )F |−1        if θ′ |ZG0F = θ|ZG0F ,
           hΓc,ξ,θ′ , Rz,η iGF =
                                  0                               if θ′ |ZG0F 6= θ|ZG0F .

Proof. In our case, Aλ = Aλ = ZG /ZG0 . Thus by applying (4.5.2) and (4.5.3), one can
write as                                      X
                      Rz,η = |(ZG /ZG0 )F |−1   η(c1 )ξ1 (z)ρc1 ,ξ1 .
                                                (c1 ,ξ1 )

Then by Theorem 2.6, (ii)-(b), we have

                         hΓc,ξ,θ , Rz,η iGF = |(ZG /ZG0 )F |−1 η(c)ξ(z)

if θ′ |ZG0F = θ|ZG0F . This proves the first formula. The second formula also follows from
Theorem 2.6, (ii)-(a) together with (4.5.2).                                             

    7.6. We preserve the notations Ms,N , etc. as in 7.1 for regular nilpotent element
N. Recall that E ⊗ Az,η is an F -stable cuspidal character sheaf on G as given in (6.5.3)
for z ∈ (ZG /ZG0 )F , η ∈ (AG (żu1 )∧0 )F and E|żZG0 : F -stable. Under the identification
AG (żu1 ) = AG (u1 ) ≃ Aλ , we regard η as an element in (A∧λ )F . Hence (z, η) is regarded
as an element in Ms,N . Let χE,y = χE,z,η be the characteristic function of E ⊗ Az,η
                                                                                                          39

defined in 6.5. Also recall the linear character θ0 of ZG0F associated to E ′ in 6.5. Let
Γc,ξ,θ′ be as in Lemma 7.5. We shall compute the inner product of Γc,ξ,θ′ with χE,z,η .
Lemma 7.7. Under the setting in 7.6, we have

          hΓc,ξ,θ′ ,χE,z,η iGF
                       (
                          ζI−1 ξ(z)η(cc0 )−1 ψ(ẑ −1 )θ′ (ż)|(ZG /ZG0 )F |−1       if θ′ |ZG0F = θ0 ,
                    =        0

                          0                                                         if θ′ |ZG0F 6= θ0 .

where ζI0 is the fourth root of unity associated to the block I0 = {ι0 } for the cuspidal
pair ι0 = (C, Eη ). ż ∈ ZGF is a representative of z, and ẑ is as in 6.5.
Proof. We follow the notation in 2.1. Since N is regular nilpotent, U is the maximal
unipotent subgroup of G and ZL (λc ) = ZG . ξ ♮ is a linear character of ZGF which
is trivial on ZG0F , hence it is naturally identified with ξ ∈ (AFλ )∧ . Γc,ξ,θ′ is given as
               F
Γc,ξ,θ′ = IndG        ′ ♮                                                             F F
              F U F (θ ξ ⊗ Λc ). It is easy to see that Γc,ξ,θ ′ has the support in ZG Guni ,
             ZG
and that

(7.7.1)             Γc,ξ,θ′ (z ′ v) = θ′ ξ(z ′ )|ZGF |−1 Γc (v)   (z ′ ∈ ZGF , v ∈ GFuni ).

Then by (6.5.4) and (6.5.7), we have
                                        (
                                         AhΓc , Xι0 iGF                 if θ′ |ZG0F = θ0 ,
(7.7.2)         hΓc,ξ,θ′ , χE,z,η iGF =
                                         0                              if θ′ |ZG0F 6= θ0

with
                                               0
                   A = q (codim C−dim ZG )/2 ψ(ẑ −1 )θ′ (ż)ξ(z)|(ZG /ZG0 )F |−1 .
Hence we have only to compute hΓc , Xι0 iGF . We compute it by making use of Lusztig’s
formula (Theorem 5.6). By (5.2.4), Xι0 is orthogonal to any function in VI1 such that
I1 6= I0 . It follows that hΓc , Xι0 iGF = h (Γc )I0 , Xι0 iGF . But since I0 = {ι0 }, we have
L = G, W = {1} and supp (ι0 ) = C. Hence by Lemma 5.11, we have
                                                                  0
                        h (Γc )I0 , Xι0 iGF = q (− codim C+dim ZG )/2 ζI−1
                                                                         0
                                                                           η(cc0 )−1 .

Substituting this into (7.7.2), we obtain the lemma.                                                      

    7.8. Returning to the original setting  m
                                                   in 1.1, we consider an F wδ -stable cuspidal
                   Fm                    GF
character δ of L , and Pδ = IndP F m δ as in 4.9. We shall describe H(δ) = End Pδ
more precisely. By Corollary 7.4, (L, δ) is given as follows; L = L       e ∩ G, where L e is a
Levi subgroup of G  e such that L   e=L  e1 ×· · ·× L
                                                    er with Lei ≃ GLt ×· · ·×GLt (ni /t-times)
for a fixed integer t. There exists a (unique) cuspidal character δe of L    eF m belonging to
E(LeF m , {ṡ}), where ṡ is as in (7.1.1) (by replacing G by L). Then the restriction of δe is
                                        m
a sum of cuspidal characters of LF , and δ is obtained in the form δ = θ′ ⊗δ0 , where δ0
is an irreducible consistent of δ|  e LF m and θ′ is a linear character of LF m corresponding
             m
to z ∈ ZLF∗ . By Lehrer [Le, Theorem 10], Wδ ≃ Wδ0 ⋊ Ωδ , where Ωδ ≃ Z/t1 Z for some
                                         m
integer t1 > 0, and Wδ acts on LF as a permutation of factors in the direct product.
40

Moreover, Wδ0 is isomorphic to the ramification group Wδe of δe in LeF m . In our case, it
is easy to see that Wδe is isomorphic to W.
                                           e LF m . Then δ ∈ E(LF m , {s}). Moreover we
     Now assume that δ is a constituent of δ|
                                                                                    m
have Wδ = W since Wδ is a subgroup of W. Let θ be a linear character of LF as
                                                              m
above. Then θ ⊗ δ is a cuspidal character belonging to E(LF , {zs}).
     We can now prove Lusztig’s conjecture for GF .
Theorem 7.9. Lusztig’s conjecture holds for GF . More precisely, there exists a bijec-
tion between the set of F -stable character sheaves and the set of almost characters of
GF satisfying the following:
    (i) For each almost character Rx of GF , we denote by Ax the corresponding char-
                                                           ∼ Ax as given in 6.8. Then
        acter sheaf of G, and by φx the isomorphism F ∗ Ax −
                                                           →
                                           χAx ,φx = νx Rx

          for a certain constant νx ∈ Q̄∗l . Here νx is a root of unity contained in a fixed
          cyclotomic field independent of q.
     (ii) Let χE,z,η be the characteristic function of the F -stable cuspidal character sheaf
          E ⊗ Az,η as given in (6.5.3). Let z1 ∈ ZG∗ be the element corresponding to
          E ′ ∈ S(G/Gder ). Let s be as in (7.1.1), and put s′ = z1 s. Let Rz,η−1 be the
          almost character of GF corresponding to (z, η −1 ) ∈ Ms′,N . Then we have

                                 χE,z,η = ζI−1
                                             0
                                               η(c0 )−1 Rz,η−1 .

Proof. Let L be the F -stable Levi subgroup containing T of a proper standard para-
bolic subgroup P of G. By induction on dim G, we may assume that Lusztig’s con-
                          ′
jecture holds for any LF , where F ′ = F ẇ1 for some ẇ1 ∈ NG (L). Assume that A0 is
an F ′ -stable cuspidal character sheaf on L. Then A0 can be written as A0 = E ⊗ Az,η ,
                       ′         ′
where z ∈ (ZL /ZL0 )F , u1 ∈ C0F (C0 is the regular unipotent class in L), η ∈ AL (żu1 )∧F ′
and E is a local system on L such that E|żZL0 is F ′ -stable. By (ii), there exists an
                                      m
F ′ -stable cuspidal character δ of LF associated to (z, η, E) such that the correspond-
                              ′
ing almost character of LF is given by Rz,η−1 . This holds for any F ′ = F w for
w ∈ NW (WL ) such that (F w)∗A0 ≃ A0 .
      On the other hand, let E1 be the tame local system on ZL0 obtained by restricting
E to ZL0 , and let ZE1 be as in 6.8. The above discussion then shows that ZE1 = Zδ .
Since Zδ is a coset of Wδ and ZE1 is a coset of WE1 , we see that

(7.9.1)                                     Wδ = WE1 .

    Now wE1 given in 6.8 coincides with wδ given in 4.9, and so γE1 = γδ . Let K w , ϕw
etc. be as in 6.8. Then by (6.8.1), we have
                                              X
(7.9.2)                 χK w ,ϕw = q −b0                          e A ,φ ,
                                                        Tr (γδ y, E)χ E AE
                                           E∈(Wδ∧ )γδ


where AE is the simple component of K w corresponding to E ∈ WE∧1 . On the other
hand, under the isomorphism (Lw )F ≃ LF ẇ , χAw0 ,φw0 ∈ C((Lw )F /∼) is regarded as an
                                                                                              41

element in C(LF ẇ /∼). Then it is known by [L6, Prop. 9.2] that
                                                      0
(7.9.3)                χK w ,ϕw = (−1)dim C0 +dim ZL RL(w)
                                                      G
                                                           (q −b0 χAw0 ,φw0 ).

(Note that χE ♯ in [loc. cit.] coincides with χAw0 ,ϕw0 = q −b0 χAw0 , φw
                                                                        0 . Also we note that
(7.9.3) holds only under some restriction that q > q0 for some constant q0 (see [loc.
cit.]). However, this restriction on q can be removed by using a similar method as in
[S1] based on the Shintani descent identity of character sheaves. Since this argument
will appear in the proof of Proposition 9.12 in a more extended form, we omit the
details here.)
     Since χAw0 ,φw0 coincides with the almost character Rz,η−1 up to scalar, we see by
Proposition 4.10 together with (7.9.2) and (7.9.3), that

(7.9.4) χAE ,φAE coincides with RE up to scalar.

    The above argument implies that χA,φA is identified with some almost character
of GF up to scalar unless A is cuspidal. So we assume that G         bF0 6= ∅. Let V0 be the
subspace of VG spanned by χA,φA ∈ G    bF0 . Then in view of the previous discussion, V0
coincides with the subspace of VG spanned by almost characters of GF obtained from
                                                m
F -stable cuspidal irreducible characters of GF by Shintani descent. Now by Lemma
7.5, Rz,η is characterized as the unique function in V0 satisfying the property of inner
product with various Γc,ξ,θ for (c, ξ) ∈ Ms′ ,N with θ = ∆(e   ρṡ′ ,E )|ZGF . By Lemma 7.7,
χE,z,η is also characterized by the inner product with Γc,ξ,θ . Hence by comparing the
formulas in Lemma 7.5 and Lemma 7.7, we see that

                            χE,z,η = ζI−1
                                        0
                                          η(c0 )−1 ψ(ẑ −1 )θ(ż)Rz,η−1 .

Here we claim that ψ(ẑ) = θ(ż). In fact, let z0 be an element in ZG∗ corresponding to
E ′ ∈ S(G/Gder ), and ż0 ∈ ZGe ∗ a representative of z0 . Let ψe′ be the linear character of
eF m corresponding to ż0 for a large m. The restriction of ψe′ on T F m gives the character
G
ψ. But it follows from the discussion on ∆(e   ρṡ′ ,E ) (see 2.4) that the restriction ψe of ψe′
       m
on ZGFe is also F -stable, and the restriction of ShF m /F (ψ)   e on Z F gives the character
                                                                         G
                             e
θ. This shows that ψ(ẑ) = ψ(ẑ) = θ(ż), and the claim follows. Thus we have proved

(7.9.5)                           χE,z,η = ζI−1
                                              0
                                                η(c0 )−1 Rz,η−1 ,

and the assertion (ii) follows.
     In order to complete the proof, we have only to show the assertion on the scalars
νx . The assertion is certainly true for the case of cuspidal character sheaves by (ii). In
                                                                          −1
the general case, this scalar νx is given by Proposition 4.10 as νx = ν0 µδ,y
                                                                           e µE
                                                                              e under the
notation of Proposition 4.10, where χAw0 δ y = ν0 Rδ,y , and χAx = νx Rx (here Rx = RE ).
Note that µδ,y
             e and µE e are determined as in Theorem 4.7, by the choice a representative
       F         F
ċ ∈ T of c ∈ Aλ (for a fixed F ) and of an extension field Fqm ; m is chosen sufficiently
divisible so that the Shintani descent gives the almost characters. But the argument in
[S2] shows that the requirement for m only comes from the Shintani descent of modified
generalized Gelfand-Graev characters, and so we can choose m independent of the base
42

field Fq . Hence µδ,y
                  e and µE e are root of unities contained in a fixed cyclotomic field
(cf. Theorem 4.7). This proves the assertion (i), and the theorem follows.          


                    8. Parametrization of almost characters

    8.1.    Theorem 7.9 is based on the parametrization in terms of the induction
from cuspidal character sheaves, and its counter part for almost characters. However,
in order to decompose almost characters into irreducible characters, one needs the
parametrization of almost characters given in 4.5. In this section, we discuss the
relationship between these two parametrizations. In the remainder of this paper, we
assume that G e = GLn and G = SLn , for simplicity. The general case is dealt with
similarly.
    We consider the following semisimple element ṡ in G  e∗ , which is a more general
type than (7.1.1).
(8.1.1) Let t be a divisor of n prime to p. Take ṡ ∈ Te∗ such that

                       ṡ = Diag(1, . . . , 1, ζ, . . . , ζ , . . . , ζ t−1, . . . , ζ t−1 ),
                                 | {z } | {z }                        |       {z         }
                                      n/t-times    n/t-times               n/t-times


where ζ is a primitive t-th root of unity in k. Put s = π(ṡ).
     Then Wṡ ≃ Sn/t ×· · ·×Sn/t (t-times), and Ωs is a cyclic group of order t generated
by w0 ∈ W which permutes the factors of Wṡ cyclicly. Hence Ws is of the form as
given in (2.5.1). We note that the class {s} is the unique class in G∗ satisfying (2.5.1)
for a fixed t. We now assume that F m acts trivially on ZG . Since F m (ζ) = ζ, we
have F m (ṡ) = ṡ. Then for x = w0i ∈ Ωs , ṡx ∈ Te∗xF is defined as ṡx = ṡzx with
                                                                 m

                         m
zx ∈ ZGe ∗ such that zxq −1 = ṡ−1 x−1 ṡx = Diag(ζ −i , . . . , ζ −i ) ∈ ZGe ∗ . Let d be a divisor
of t, and consider the Levi subgroup L      e in G
                                                 e such that L     e ≃ GLd × · · · × GLd (n/d-
                                                             e ∗
times). Let ṡL be a regular semisimple element in L defined as follows; under the
isomorphism L   e∗ ≃ GLd × · · · × GLd , ṡL is a product of Diag(1, ζ0, . . . , ζ0d−1 ), where
ζ0 = ζ t/d . Put sL = π(ṡL ) under the natural map π : L       e∗ → L∗ . Then one sees easily
that there exists żL ∈ ZLe ∗ such that ṡL żL is W -conjugate to ṡ. Here ΩsL is a cyclic
group of order d generated by w0,L ∈ WL , and there exists an injective homomorphism
                                                                  t/d
ΩsL → Ωs such that the image of w0,L coincides with w0 . For any y ∈ ΩsL , one can
                      ′            ′
define (ṡL )y = ṡL zy for some zy ∈ ZGe ∗ as in the case of G. It follows that (ṡL )y zL
                                                         m
is W -conjugate to ṡzy′ . If y = (w0,L )i , then (zy′ )q −1 = Diag(ζ0i , . . . , ζ0i ), and we may
choose zy′ = zyt/d . Summing up the above argument, we have
                                                                  e∗ gives rise to a class {ṡx }
(8.1.2) For each generator y of ΩsL , the class {(ṡL )y żL } in G
for some x ∈ Ωs such that the order of x is d. The correspondence {(ṡL )y } → {ṡx }
gives a bijection between the classes in Le∗ associated to y ∈ Ωs of order d, and the
                                                                        L
           e∗ associated to x ∈ Ωs of order d.
classes in G
     8.2. We write ṡL żL in a more explicit way. żL ∈ ZLe ∗ can be written as

                   żL = (a, . . . , a)     with a = (1, ζ, . . . , ζ t/d−1 ) ∈ (k ∗ )t/d
                                                                                                         43

under the isomorphism ZLe ∗ ≃ (k ∗ )t/d × · · · × (k ∗ )t/d (n/t-times). Then we have

                  ṡL żL = (a1 , . . . , at/d−1 , a1 , . . . , at/d−1 , . . . , a1 , . . . , at/d−1 )

with

               aj = Diag(ζ j−1, ζ t/d+j−1 , ζ 2t/d+j−1, . . . , ζ (d−1)t/d+j−1 ) ∈ GLd .

From this, we see easily that there exists wL ∈ NW (WL ) such that F wL (ṡL żL ) = ṡL żL .
Then żL is also F wL -stable modulo (ZLe ∗ )d , where (ZLe ∗ )d = {z ∈ ZLe ∗ | z d = 1}. We
choose wL in a standard way. Hence wL gives the permutation of factors in each block
a1 , . . . , at/d−1 . We put F ′′ = F wL . Take m large enough so that żL ∈ ZLeF∗ . Let θe be
                                                                                  m



the linear character of L    eF m corresponding to żL ∈ Z F m , and θ the restriction of θe to
                                                                           e∗
                                                                           L
  m
                        e F m is F ′′ -stable, and so θ1 = θ| 0F m is also F ′′ -stable.
LF . Then by Lemma 1.2, θ| Ze                                ZL
                            L

We put θe1 = θ|
             e Fm .
                 Ze
                   L

     Let us denote by zL ∈ L∗ the image of żL under the natural map L                   e∗ → L∗ .
We consider the parameter set MLsLzL ,N0 (a similar set as Ms,N in 4.5, defined by
replacing G, F by L, F ′′ ) with respect to the F ′′ -stable regular semisimple class {sL zL }
in L∗ , where N0 is a regular nilpotent element in Lie L. Let δz,η (= ρz,η ) be a cuspidal
                                     m
irreducible character of LF , stable by F ′′ corresponding to (z, η) ∈ MLsLzL ,N0 . Then
there exists a cuspidal irreducible character δe = ρe(ṡL )y żL ,1 of L   eF m such that δz,η is an
irreducible constituent of the restriction of δe to LF . Note that δe can be written as
                                                                 m


δe = θe ⊗ δe′ for δe′ = ρe(ṡL )y ,1 . The class {sL } is F ′′ -stable, and there exists a cuspidal
                             ′
irreducible character δz,η          parametrized by (z, η) ∈ MLsL,N0 , which is a constituent
of δe′ |LF m , such that δz,η = θ ⊗ δz,η  ′
                                             . We consider the Harish-Chandra induction Ie =
         m
     e F
            e and its restriction I on GF m . By (8.1.1), irreducible components of I belong
IndGe F m (δ)
   P      m
to E(GF , {s}).
    By (6.7.2) and (7.9.1) we have Wδ ≃ Wθ1 . Since Wδe ≃ Wδ0 , we see that Wδe ≃ Wθ01 .
We have Wθ1 ≃ Wθ01 ⋊ Ωθ1 , where Wθ01 is given as in

(8.2.1)                       Wθ01 ≃ Sn/t × · · · × Sn/t               (t/d-times).

and Ωθ1 is the cyclic group of order t/d generated by an element y0 ∈ W permuting
the factors Sn/t cyclicly. Now Ie is decomposed as
                                                   X
(8.2.2)                                 Ie =                          ρE1 ,
                                                             (dim E1 )e
                                               E1 ∈(Wθ0 )∧
                                                        1



where ρeE1 is the irreducible characters of G                                         e F m , {ṡx }),
                                             e F m . But since ρeE1 is contained in E(G
they are expressed as ρeṡx ,E1′ with E1′ ∈ Wṡ . The relationship of these two parametriza-
tions are given as follows. We have Wṡx ≃ (Sn/t )t , and there exists a natural embed-
ding Wθ01 → Wṡx via the diagonal embedding

                       (Sn/t )t/d ֒→ (Sn/t )t ≃ (Sn/t )t/d × · · · × (Sn/t )t/d .
44

Then one can define a map f : (Wθ01 )∧ → Wṡ∧ through E1 7→ E1 ⊠ · · · ⊠ E1 . We note
that
(8.2.3) ρeE1 = ρeṡx ,E1′ with E1′ = f (E1 ) ∈ Wṡ∧x .

     In fact, let w1 be the Coxeter element in WL , and ψ0 a regular character of TewF1 ≃
TeF w1 obtained by the Shintani descent ShF m /F w1 (θ|TeF m ). The cuspidal character δe
                            e                                   e    e
can be expressend as ±RTLe (ψ0 ). Thus Ie coincides with ±RLG       L
                                                                e (RTe (ψ0 )), and
                                    w1                                                  w1


                       e    e                     e
                                                              X
(8.2.4)              RLG   L             G
                       e (RTew (ψ0 )) = RTew (ψ0 ) =                    Tr (w1 , E1′ )e
                                                                                      ρE1′ .
                                1                     1
                                                            E1′ ∈Wṡ∧


Then we have Tr (w1 , E1′ ) = dim E1 if E1′ = E1 ⊠ · · · ⊠ E1 for some E1 ∈ (Wθ01 )∧ , and
Tr (w1 , E1′ ) = 0 otherwise. Comparing (8.2.2) with (8.2.4), we see that ρeE1 = ρeE1′ for
E1 ∈ (Wθ01 )∧ . This proves (8.2.3).
                                                            ′′
    Put δ = δz,η . Then Wδ ≃ Wθ1 . Take E ∈ (Wδ∧ )F , and put E1 = E|Wδ0 . We
assume that E1 is of the form that

(8.2.5)                                  E1 = E2 ⊠ · · · ⊠ E2 ∈ (Wθ01 )∧

with E2 ∈ (Sn/t )∧ . Then E1′ = f (E1 ) ∈ Wṡ∧ satisfies the condition in (2.5.1). Let ρE
                                              Fm
be the irreducible component of IndG                                          ∧ F
                                            P F m δ corresponding to E ∈ (Wδ ) . We denote
                                        F
by RE the almost character of G corresponding to ρE through the Shintani descent.
Let Oρe be the nilpotent orbit in g associated to ρe = ρeṡx ,E1′ . We choose a nilpotent
element N such that Oρe = ON . Let PeN and L          eN be the associated parabolic subgroup
and its Levi subgroup in G.       e We put M   f= L   eN and M = M  f ∩ G. We consider the
                                                                F
modified generalized Gelfand-Graev characters Γc,ξ of G associated to (c, ξ) ∈ Ms,N .
A similar formula as in Lemma 7.5 holds also for the general Ms,N , which implies
the following lemma. (Note that we don’t need to consider Γc,ξ,θ since ∆(e        ρ)|ZM (λ)F is
trivial for any ρe = ρeṡx ,E1′ in the case of G = SLn by [S2, Lemma 2.18].)
Lemma 8.3. The almost character RE is written as Rz ′ ,η′ with (z ′ , η ′ ) ∈ Ms,N . The
correspondence E ↔ (z ′ , η ′ ) is determined by computing the inner product hΓc,ξ , RE i
for various Γc,ξ .

    8.4. Let C0 be the regular unipotent class in L, and E the local system of L
                                             m
corresponding to the linear character θ of LF in 8.2. Let A0 = AE,z,η be the F ′′ -stable
cuspidal character sheaf on L associated to (z, η) ∈ MLsLzL ,N0 and E, defined as in 6.5,
by replacing G by L. Put K = indG  P A0 . Then End K ≃ Q̄l [WE1 ] with WE1 ≃ Wθ1 . We
denote by AE the character sheaf of G which is a direct summand of K corresponding
to E ∈ Wθ∧1 . Put Zθ1 = {w ∈ W | F w θ1 = θ1 }. Then Zθ1 = wL Wθ1 , and F ′′ = F wL
acts on Wθ1 . For each w ∈ Zθ1 , we denote by θ0w the linear character of ZL0F w given by
θ0w = ShF m /F w (θ1 ).
    Let E ∈ Wθ∧1 and ON be as in 8.2. By Theorem 7.9 (see (7.9.4)), χAE coincides
with RE up to scalar. Then we see that N = Nµ ∈ g is of the form such that
µ = (µ1 ≥ µ2 ≥ · · · ≥ µr ) with µj divisible by t. We choose Nµ in Jordan’s normal
                                                                                                                  45

                                                                    0
form corresponding to the partition µ. Then Aλ = ZM (λ)/ZM            (λ) is a cyclic group of
       ′          ′
order t , where t is the largest common divisor of µ1 , . . . , µk , coprime to p. Note that
ZM (λ) is F -stable. By our choice of ṡzL and of wL , wL acts on ZM (λ), and so we have
an action of F ′′ = F wL on ZM (λ).
    There exists an F ′′ -stable subgroup ZM   1
                                                 (λ) of ZM (λ) such that Āλ = ZM (λ)/ZM 1
                                                                                           (λ)
is a cyclic group of order t (see [S2, 2.19]), which is given as follows; if we write the
partition µ as µ = (1m1 , 2m2 , . . . ). then we have
                                                       Y                 Y
                 1
                ZM (λ) ≃ {(. . . , xi , . . . ) ∈             GLmi |      (det xi )i/t = 1}.
                                                      mi >0               i


(Note that mi = 0 if i is not divisible by t.) We may choose T ⊂ M ∩ L. Then we
have

                                   1                       1
                     Āλ ≃ ZM (λ)/ZM (λ) ≃ (ZM (λ) ∩ T )/(ZM (λ) ∩ T ).

By our choice of N, we have ZM (λ) ∩ T ⊂ ZL . On the other hand, the above de-
              1                   1
scription of ZM (λ) implies that ZM (λ) ∩ T ⊂ ZL0 . It follows that we have a natural
homomorphism

(8.4.1)                                         Āλ → ZL /ZL0

compatible with the action of F . Note that η is an F -stable linear character of ZL /ZL0 .
Thus one can define an F -stable linear character η1 ∈ (Ā∧λ )F as the pull back of η
under the above homomorphism..
    Since T ⊂ M, we have ZL ⊂ M. One can write
                                                               Y
(8.4.2)              ZL0 = {(a1 , . . . , an/d ) ∈ (k ∗ )n/d |   ai = 1}
                                                                              i

under the identification
                                                                         Y
                          ZL ≃ {(a1 , . . . , an/d ) ∈ (k ∗ )n/d |                    adi = 1}.
                                                                          i


Let zZL0 be a coset in ZL /ZL0 . We may take a representative z in ZG . Then we have
ZM (λ) ∩ zZL0 = z(ZM (λ) ∩ ZL0 ), and

(8.4.3)       ZM (λ) ∩ ZL0 = {(b1 , . . . , b1 , b2 , . . . , b2 , . . . , br , . . . , br ) ∈ ZL0 | bi ∈ k ∗ }
                               | {z } | {z }                               | {z }
                                       µ1 /d-times    µ2 /d-times             µr /d-times
                                                                    Y     µ /d
                                ≃ {(b1 , . . . , br ) ∈ (k ∗ )r |        bi i          = 1},
                                                                     i

and
                                                                              Y         µ /t
                      1
                     ZM (λ) ∩ ZL0 ≃ {(b1 , . . . , br ) ∈ (k ∗ )r |                    bi i = 1}.
                                                                                  i
46

        1
Now ZM    (λ) ∩ ZL0 acts on z(ZM (λ) ∩ ZL0 ) by a left multiplication. Put XM = (ZM (λ) ∩
zZL0 )/(ZM1
            (λ) ∩ ZL0 ). It follows from the above argument that there exists a bijection

(8.4.4)                                        XM ≃ Z/(t/d)Z.

If zZL0 is F ′′ -stable, then F ′′ acts naturally on XM , which is compatible with the
natural action of F on Z/(t/d)Z ≃ hζ d i.
     Assume that the coset zZL0 is F w-stable for w ∈ W. Then we choose a rep-
resentative żw ∈ ZLF w of zZL0 . Since żw ∈ T F w , there exists αw ∈ T such that
                                                                       m
F m (αw )αw−1 = żw . We put ẑw = αw−1 F w α. Then we have ẑw ∈ T F . Let ψ be a
                          m                                m
linear character of T F obtained by restricting θ to T F . The value ψ(ẑw ) does not
depend on the choice of αw ∈ T .
     We show the following lemma.

Lemma 8.5. Let the notations be as before.

     (i) Let t1 ∈ ZG ∩ zZL0 . There exists a linear character Ψt1 of Wθ1 satisfying the
         following properties; Ψt1 is trivial on Wθ01 , and is regarded as a character of Ωθ1 .
                         ′′
         If t1 ∈ (zZL0 )F , then Ψt1 is F ′′ -stable, and in that case, we have t1 ∈ (zZL0 )F w
         for w = wL y with y ∈ Wθ1 , and

                          ψ(ẑw )θ0w (t1 żw−1 ) = ψ(ẑwL )θ0wL (t1 żw−1L )Ψt1 (y).

     (ii) Ψt1 depends only on the coset in XM to which t1 belongs, and we have
                                                  F        ′′            ′′
                                     {Ψt1 | t1 ∈ XM } = (Ω∧θ1 )F .

Proof. Put w = wL y for y ∈ Wθ1 . For t1 ∈ ZG ∩ zZL0 , choose α ∈ ZLe such that
                                                                           ′
t1 = F m (α)α−1. We choose m′ , a multiple of m, such that α is F m -stable. One can
                                    m′
find a linear character θe1′ on ZLeF , which is an extension of θe1 on ZLeF (see 8.2), stable
                                                                           m



by F ′′ , such that W 0 ⊆ W e′ . We put Ψt (y) = θe′ (α−1y α) (for a fixed α and θe′ ). We
                         θ1        θ1                  1         1                       1

have   θe1′ (α−1y α) = θe1′ (α−1 )θe1′ (y α)
                                      = 1 for y ∈               Wθ01 ,
                                                          and so Ψt1 is trivial on Wθ01 . It
follows that Ψt1 (y) = Ψt1 (y2 ) if y = y1 y2 with y1 ∈ Wθ01 , y2 ∈ Ωθ1 . Hence in order to
show that Ψt1 is a homomorphism Wθ1 → Q̄∗l , it is enough to see that (*) Ψt1 is a
homomorphism on Ωθ1 . This will be shown soon later.
                                         ′′
     Now assume that t1 ∈ (zZL0 )F . Since z ∈ ZG , we have t1 ∈ (zZL0 )F w =
żw ZL0F w . Choose βw ∈ ZL0 such that F m (βw )βw−1 = t1 żw−1 ∈ ZL0F w . Then θ0w (t1 żw−1 ) =
θ1 (βw−1 F w βw ). Since t1 = F m (α)α−1, we may assume that αw = αβw−1. In particular,
                            m
we have α−1F w α ∈ T F and ψ(ẑw )θ0w (t1 żw−1 ) = ψ(α−1F w α). A similar formula also
                                                                                     m
holds for wL . Since α−1F w α = α−1F wL α · F wL (α−1y α), we see that α−1y α ∈ T F . Since
θe1 and ψ coincides with each other on T F ∩ ZLeF , we have
                                              m      m




                        ψ(ẑw )θ0w (t1 żw−1 ) = ψ(α−1F w α)
                                                = ψ(α−1F wL α)ψ(F wL (α−1y α))
                                                = ψ(ẑwL )θ0wL (t1 żw−1L )Ψt1 (y).
                                                                                                        47

Hence the formula in (i) holds. In particular, Ψt1 (y) does not depend on the choice
of α ∈ ZLe . Put α′ = F ′′ (α). We have t1 = F m (α)α−1 = F m (α′ )(α′ )−1 since t1 is
F ′′ -stable, and one can replace α by α′ in defining Ψt1 . Since θe1′ is F ′′ -stable, we have
                                                      −1 ′′
                    Ψt1 (y) = θe1′ (α−1y α) = θe1′ (α′ F (y) α′ ) = Ψt1 (F ′′ (y)).

This shows that Ψt1 is F ′′ -stable. Thus the assertion in (i) was proved modulo (*).
    Next we show (ii). Take t1 ∈ ZG ∩ (ZM (λ) ∩ zZL0 ). Then as in (8.4.2) t1 can be
                                                                                 Q µ /d
written as t1 = zb with b ∈ ZM (λ) ∩ ZL0 . Hence b = (b1 , . . . , br ) such that i bi i = 1
with bi ∈ k ∗ . One can choose α ∈ T such that F m (α)α−1 = t1 as follows; α = βγ with
β ∈ ZL0 and γ ∈ ZGe such that F m (γ)γ −1 = z, F m (β)β −1 = b. More precisely, we can
choose β as

(8.5.1)             β = (ν(t1 )−1 β1 , β1 , . . . , β1 , β2 , . . . , β2 , . . . , βr , . . . , βr ),
                                       | {z } | {z }                               | {z }
                                            µ1 /d−1-times     µ2 /d-times            µr /d-times

          m                                         Q         µ /d
where βiq −1 = bi for i = 1, . . . , r and ν(t1 ) = ri=1 βi i ∈ F∗qm . Let y0 be the
generator of Ωθ as in 8.2. Since y0 is a cyclic permutation of order t/d of consecutive
factors, it makes no change except the part ν(t1 )−1 β1 , β1 , . . . β1 . Hence we see that
                             j                                                                  m
(8.5.2)               β −1y0 β = (ν(t1 ), 1, . . . , 1, ν(t1 )−1 , 1, . . . , 1) ∈ ZL0F

for 1 ≤ j ≤ t/d − 1, where ν(t1 )−1 occurs in the (j + 1)th factors. Moreover, since
γ ∈ ZGe , we have y0 γ = γ. It follows that
                                                      j              j
                                                α−1y0 α = β −1y0 β.

On the other hand, θ is the restriction of the linear character θe of (L/  e L
                                                                             eder )F m such
that θe = (1 ⊠ Θe ⊠ ··· ⊠ Θe t/d−1 )⊠n/t , where Θ
                                                 e is a linear character of GLF m of order
                                                                              d
          e L
t. Since L/  eder ≃ Z e /(Z e ∩ Leder ), and Leder = Lder = SLd × · · · × SLd , the linear
                       L    L
character θe1 on ZLeF can be written as
                     m




(8.5.3)                            θe1 = (1 ⊠ Θ ⊠ · · · ⊠ Θ t/d−1 )⊠n/t ,
                                       F          m                  F                  m
where Θ is a linear character of ZGL     d
                                           which is trivial on ZSL      d
                                                                          . Hence Θ is identified
with a linear character of Fqm of order t/d. If we replace m by m′ , Θ can be extended
                             ∗

to a linear character Θ ′ of F∗qm′ , and (1 ⊠ Θ ′ ⊠ · · · ⊠ Θ ′ t/d−1 )⊠n/t gives rise to a linear
                m′
character of Z F , which gives θe′ . It follows that
                e
                L                           1

                                                        j
(8.5.4)                          Ψt1 (y0j ) = θe1′ (α−1y0 α) = Θ(ν(t1 ))−j .

This proves (*) since if t1 ∈ ZG ∩ zZL0 , then t1 ∈ ZG ∩ (ZM (λ) ∩ zZL0 ).
                              1
                                                 Q µ /t                       m
     Now assume that t1 ∈ ZM    (λ) ∩ ZL0 . Since i bi i = 1, we have ν(t1 )(q −1)d/t = 1.
                                                           t/d
It follows that there exists ν1 ∈ Fqm such that ν(t1 ) = ν1 , and we have Ψt1 (y0j ) = 1.
48

This implies that Ψt1 depends only on t1 ∈ XM . Now XM is in bijection with a cyclic
group of order t/d, and we can choose a representative x0 of a generator of XM as
x0 = zc0 with c0 = (c, . . . , c) ∈ ZG ∩ ZL0 such that cn/t is a primitive t/d-th root of
unity in k. Put ν0 = ν(x0 ). Then ν0 is a generator of the cyclic group F∗qm , and we
have ν(xi ) = ν0i for xi = zci0 . It follows from (8.5.1) that we have Ψxi (y0 ) = Θ(ν0 )−i
for i = 0, . . . , t/d −1. Since ν0 is a generator of F∗qm , Θ(ν0 ) is of order t/d in Q̄∗l . Hence
Ψx (y0 ) are all distinct for x ∈ XM . Since Ωθ1 is a cyclic group of order t/d, we see that
there exists a bijection between {Ψx | x ∈ XM } and Ω∧θ1 . We note that Ψx is F ′′ -stable
            F ′′                                                                    F ′′
for x ∈ XM       . In fact, take a representative t1 ∈ ZM (λ) ∩ zZL0 of x ∈ XM           . Then we
         ′′                         1          0
have F (t1 ) = t1 t2 with t2 ∈ ZM (λ) ∩ zZL . It follows that ΨF ′′ (t1 ) = Ψt1 t2 = Ψt1 . Now
take α ∈ ZLe such that F m (α)α−1 = t1 , and put α′ = F ′′ (α). Since θe1′ is F ′′ -stable, we
have
                                                                −1 ′′
                              Ψt1 (y) = θe1′ (α−1y α) = θe1′ (α′ F (y) α′ ).

But since F ′′ (t1 ) = F m (α′ )α′ −1 , we have
                      −1 ′′
              θe1′ (α′ F (y) α′ ) = ΨF ′′ (t1 ) (F ′′ (y)) = Ψt1 t2 (F ′′ (y)) = Ψt1 (F ′′ (y)).

This implies that Ψt1 (y) = Ψt1 (F ′′ (y)), and so Ψx is F ′′ -invariant. Actually this
                                                                     F ′′
argument shows that Ψx is F ′′ -invariant if and only if x ∈ XM           . Thus we have
            F ′′             ′′
{Ψx | x ∈ XM     } = (Ω∧θ1 )F , and (ii) is proved.                                   

Theorem 8.6. Let G, s and L, sL , zL be as in 8.1, 8.2. In particular, L is a Levi
subgroup of G such that L/ZL is a product of P GLd with d|t. Let θ be the linear
                m                             m
character of LF corresponding to zL ∈ ZLF∗ , and let θ1 = θ|ZL0F m be the F ′′ -stable
linear character. Let E be the local system on L corresponding to θ.
     (i) Let AE,z,η = E ⊗ Az,η be an F ′′ -stable cuspidal character sheaf of L as in 7.6
         for (z, η) ∈ MLzL sL ,N0 , and AE be the character sheaf corresponding to E ∈
                 ′′
         (Wθ∧1 )F , where E1 = E|Wθ0 satisfies the condition in (8.2.5). Then there
                                        1
         exists zE ∈ ĀFλ satisfying the following.

(8.6.1)                                    χAE = νE RzE ,η1−1 ,

          where (zE , η1−1 ) ∈ Ms,N is given as follows; η1 is the F -stable character of
          Āλ defined as the pull back of η in 8.4. zE is determined uniquely by the
          following condition; let ι be the unique element of I0 such that supp (ι) = ON ,
          and let Eι ∈ W ∧ the corresponding character under the generalized Springer
                                                                     F ′′
          correspondence. Then there exists a unique class xE ∈ XM        such that
                                                 (
                                                   1    if t ∈ xE ,
                            hE ⊗ Ψt−1 , Eι iWθ =
                                              1    0    otherwise.

                                                         F             ′′
          zE is the image of xE under the natural map XM   → ĀFλ . νE is a root of unity,
          which is determined explicitly (see (9.10.6)).
                                                                                             49

          All the almost characters Rz ′ ,η′ associated to (z ′ η ′ ) ∈ Ms,N such that η ′ is of
        order d is obtained in this way from some AE .
                                  ′        (m)
   (ii) Let δ = δz,η = θ ⊗ δz,η       ∈ TsL zL ,N0 be the cuspidal irreducible character of
           m                                                                     m
        LF as in     m
                       8.2. Let ρE be the F -stable irreducible character of GF contained
                   F
        in IndG                                      ∧
                 P F m δ corresponding to E ∈ Wδ . Then we have ρE = ρzE ,η1−1 with
        (zE , η1−1 ) ∈ Ms,N . In particular, we have RE = RzE ,η1−1 .

Remark 8.7. Theorem 8.6 gives an identification of two parametrizations of al-
most characters of GF , one given by the parameter set Ms,N and the other by the
Harish-Chandra induction, in the case where (s, E) satisfies the property (2.5.1). The
parametrizations of irreducible characters, and of almost characters, are described in
2.8, (a) - (c). The above result covers the case (a). The case (b) is obtained by apply-
ing the Harish-Chandra induction for the case (a). Thus the above parametrization
can be extended also for this case. The case (c) is obtained by applying the twisted
induction for the cases (a) or (b). Since the twisted induction of almost characters
corresponds to the induction of character sheaves, our result gives an enough infor-
mation for decomposing the characteristic functions of character sheaves in terms of
irreducible characters of GF based on our parametrization Ms,E .
    8.8. The proof of the theorem will be done in the next section. Here we prove
some preliminary results. As discussed in 5.5, we identify the set IG with the set of
pairs (O, E), where O is a nilpotent orbit in g and E is a simple G-equivariant local
system on O. For ι ∈ IG belonging to (L, C0 , E0) ∈ MG , we define two integers b(ι)
and b0 as follows (cf. 5.1 and 6.8).

(8.8.1)          b(ι) = (a0 + r)/2 = (codimG supp (ι) − codimL C0 )/2,
                   b0 = (dim G − dim supp Kι )/2 = (codimL C0 − dim ZL )/2.

    Suppose that ι belongs to the triple (L, C0 , E0 ) ∈ MFG . Let z ∈ (ZL /ZL0 )F , and we
choose a representative ż ∈ ZLF . By the translation C0 −    →∼ żC0 , we may regard E0 the
                                             0            0
F -stable local system on żC0 . Let Σ = zZL ×C0 = ZL × żC0 , and we follow the setting
in 6.7 and 6.8. In particular, A0 = E ⊗ Az,η is the cuspidal character on L associated
to E0 = Eη , and to the local system E on L which is the pull back of E ′ ∈ S(L/Lder ).
                                                                                           m
We put E1 = E|zZL0 as before, and consider the corresponding character θ1 of ZL0F ,
etc. We identify WE1 with Wθ1 and with Wδ , and similarly for ZE1 with Zθ1 , Zδ . We
write the automorphism γE1 on WE1 as γδ . Let K = IndG          P A0 be the induced complex
on G, and we consider ϕw : (F w)∗K w −    ∼
                                          → K  w
                                                 for w  ∈ Z  E1 . Then by (7.9.2), we have

                                          X
(8.8.2)               χAE = q b0 |Wθ1 |−1                     e K w ,ϕw
                                               Tr ((γδ y)−1 , E)χ
                                          y∈Wδ


with w = wδ y.
    Let E0′ = Q̄l ⊠ E0 be the local system on Σ = ZL0 × C0 . Let F = E ⊗ E0′ be the
local system on Σ. Then A0 coincides with IC(Σ, F )[dim Σ]. For each w ∈ ZE1 , take
α ∈ G such that α−1 F (α) = ẇ, where ẇ is a representative of w in NG (L). Then Aw   0
is constricted from the twisted data (Lw , Σ w , F w ), where Lw = αLα−1 , Σ w = αΣα−1
and F w = ad(α−1 )∗ F . By applying the argument in 6.5 (see also 6.8), we can construct
50

an isomorphism F ∗ F w −    ∼ F w which induces ϕw
                            →
                                                             ∗ w ∼
                                                       0 : F A0 −
                                                                     w
                                                                 → A0 . We denote this map
also by ϕw                  w          −1                0
           0 . We put C0 = αC0 α . The set zZL is F w-stable for w ∈ ZE1 and one
can choose a representative żw ∈ ZL of the coset zZL0 . We have an F -stable set
                                           Fw

Σ w = ż w ZL0 w × C0w with ż w = αżw α−1 ∈ ZLFw . For each w ∈ Zθ1 , let θ0w = ShF m /F w (θ1 )
be the linear character of ZL0F w . Under the isomorphism ZL0F w ≃ ZL0Fw , we regard θ0w
as the character of ZL0Fw , which we denote by θ̄0w .
    Now take t ∈ GF and fix it. Let x ∈ GF be an element such that x−1 tx ∈ ż w ZL0 w .
Then Lw  x = xL x
                   w −1
                          is a Levi subgroup of some parabolic subgroup of ZG (t). Let
Cx = xC0 x be the unipotent class in Lw
  w         w −1                                                           w
                                                    x . We denote by Fx the local system
on Cxw obtained by the pull back of E0w = ad(α−1 )∗ E0 by ad x−1 : Cxw → C0w . By
                                                         ∗ w ∼
the map β : Cxw → Σ w , v 7→ x−1 tvx, ϕw         0 : F F −    → F w induces an isomorphism
                    ∗ w ∼                      ∗ w ∼
ϕ′x = β ∗ ϕw 0 : F Fx −
                                w
                         → Fx . Let ϕx : F Fx −
                                                           w
                                                      → Fx be the isomorphism defined by
             −1 ∗ w
ϕx = (ad x ) ϕ0 . Then we have

                               ϕ′x = θ̄0w (x−1 tx(ż w )−1 )ψ(ẑw )ϕx
                                                   m
by (6.5.6), where ψ is a character of T F as given in (6.5.6), and ẑw is as in 8.4.
Assume that t, v ∈ GF such that tv = vt, where t is semisimple and v is unipotent.
Then by the character formula [L3, II, Theorem 8.5] for the function χK w ,ϕw , we have
                                            X               Z (t)
(8.8.3) χK w ,ϕw (tv) = |ZG (t)F |−1                      QLGwx ,Cxw ,Fxw ,ϕx (v)θ̄0w (x−1 tx(ż w )−1 )ψ(ẑw ),
                                            x∈GF
                                       x−1 tx∈ż w ZL
                                                    0
                                                      w


          Z (t)
where QLGwx ,Cxw ,Fxw ,ϕx is the generalized Green function of ZG (t)F (note that ZG (t) is
connected).



   8.9. Recall that Xι is the function on GFuni associated to ι given in 5.2. It is
known by [L3, V, (24.2.8)] that Xι is expressed as
                                            X
(8.9.1)               Xι = |W|−1 q −b(ι)          Tr (w −1, Eι )QG
                                                                 Lw ,C0w ,E0w ,ϕw
                                                                                0
                                                                                  ,
                                           w∈W

               ∗ w ∼ w                                                   ∼ E0 . For each
where ϕw 0 : F E0 −
                                       w         −1 ∗
                   → E0 is given by ϕ0 = ad(α ) ϕ0 from ϕ0 : F E0 −
                                                                     ∗
                                                                         →
                        0F                  w                  w
linear character θ of ZLw , we denote by Kθ the complex K given in 8.8 (subject to
the condition that z = 1, i.e., Σ = ZL0 × C0 ) such that θ0w = θ, and denote by χKθw the
characteristic function χK w ,ϕw Then by the character formula (8.8.3), we see that
                                                                 X
(8.9.2)                     QG
                             Lw ,C0w ,E0w ,ϕw
                                            0
                                              = |ZL0Fw |−1                χKθw ,
                                                                  0F )∧
                                                              θ∈(ZLw



where we regard the left hand side as the class function on GF by extending by 0 outside
of GFuni . Under the isomorphism ZL0Fw ≃ ZL0F w , θ determines an F w-stable character
           m
θ1 ∈ (ZL0F )∧ such that ShF m /F w (θ1 ) = θ. Put Zθ1 = {w ′ ∈ W | F w ′ (θ1 ) = θ1 }. Then
there exists a w1 ∈ W such that Zθ1 = w1 Wθ1 , and we define γ1 : Wθ1 → Wθ1 by
                                                                                                         51

γ1 = ad w1 . Hence, as in the case of K w , one can decompose Kθw by
                                              X
(8.9.3)                   χKθw = q −b0                              e ′ )χA ′ ,
                                                          Tr (γ1 y, E      E ,θ
                                          E ′ ∈(Wθ∧ )γ1
                                                    1



for y ∈ Wθ1 such that w = w1 y, where χAE ′ ,θ is the (normalized) characteristic function
of the character sheaf AE ′,θ .
                                                                                              F
   8.10. For each irreducible character η of ZM (λc )F , put Γc,η = IndG
                                                                       ZM (λc )F (η ⊗ Λc ).
Then we have                        X
                               Γc =     (deg η)Γc,η ,
                                                η

where η runs over all the irreducible characters in ZM (λc )F . We denote by Γc′ the
sum of Γc,η , where η runs over all the linear characters of ZM (λc )F , and by Γc′′ the
complement of Γc′ in Γc so that Γc = Γc′ + Γc′′ . Then we have the following lemma.
Lemma 8.11. The inner product hΓc′′ , QG
                                       Lw ,C0w ,E0w ,ϕw i F can be expressed as
                                                      0 G



                       hΓc′′ , QG
                                Lw ,C0w ,E0w ,ϕw i F = q −b0 +1 |ZL0Fw |−1 n−1
                                               0 G                          0 β,


where β is an algebraic integer contained in a fixed cyclotomic field A independent of
q, and n0 is an integer independent of q.
Proof. By (8.9.2) and (8.9.3), we have
                                                          X           X
(8.11.1)        QG
                 Lw ,C0w ,E0w ,φw = |ZL0Fw |−1 q −b0                                        e ′)χA ′ ,
                                                                                  Tr (γ1 y, E
                                0                                                                 E ,θ
                                                            0F )∧ E ′ ∈(W ∧ )γ1
                                                        θ∈(ZLw           θ1



where AE ′ ,θ is the character sheaf which is a direct summand of Kθw . Here we may
assume that Tr (γ1 y, E e ′) ∈ A. Moreover, by Theorem 7.9, χA ′ coincides with the
                                                                       E ,θ
almost character Rx up to a scalar νx , and we may assume that νx is a unit in A. On
the other hand, it is known that deg η is a polynomial in q, and that deg η is divisible
by q if η is not a linear character. It follows that hΓc′′ , ρiGF ∈ n−1                    F
                                                                     1 qZ for any ρ ∈ Irr G .
In particular we havehΓc′′ , Rx iGF ∈ n−1                                     F
                                        2 qA for any almost character of G , where n1 , n2
are integers independent of q. Then the lemma follows from (8.11.1).                       


                                 9. Proof of Theorem 8.6

     9.1. In this section, we prove Theorem 8.6. First we note that (ii) follows from
(i). In fact, since ρE and AE have the same parametrizaition via the decomposition of
      Fm
IndG                  G
    P F m δ and of indP AE,z,η , we see that RE coincides with χAE up to scalar. Hence
RE coincides with RzzE ,η1−1 by Theorem 8.6 (i). This also shows that ρE = ρzzE ,η1−1 ,
and (ii) follows.
     In order to prove (i), first we show the following.
Proposition 9.2. Suppose that q is large enough (but we don’t assume that q is suf-
ficiently divisible). Then the statement of (i) in Theorem 8.6 holds.
52

     9.3. The proof of the proposition will be done through 9.3 to 9.10. We shall
prove it by computing the inner product hΓc,ξ , χAE i under the assumption that q is
large enough. By Lemma 8.3, we have only to compare the inner products of Rz ′ ,η′ and
of χAE with various Γc,ξ associated to the nilpotent element N such that N ∈ Oρeṡx ,E ′ .
     First we shall compute the inner product hΓc,ξ , χK w ,ϕw iGF . By (8.8.3) and Propo-
sition 3.5, we have

                                     1   X         1                          X              |ZM (λc )F ∩ ZG (g −1 t′ g)F |
     hΓc,ξ ,χK w ,ϕw iGF =
                                   |G | ′ ′ F |ZG (t′ )F |2
                                      F                                                              |ZM (λc )F |
                                          t ,v ∈G                              g∈GF
                                                                       g −1 t′ g∈ZM (λc )F
                       X                                                                 Z (t′ )                Z (t′ )
            ×                       ξ ♮ (g −1 t′ g)θ̄0w (x−1 t′ x(ż w )−1 )ψ(ẑw )ΓNgG,1 (v ′ )QLGwx ,Cxw ,Exw ,ϕx (v ′ ),
                     x∈GF
                x−1 t′ x∈ż w ZL
                               0F
                                w



where in the first sum, t′ , v ′ ∈ GF runs over semisimple elements t′ , unipotent elements
v ′ such that t′ v ′ = v ′ t′ . Then the right hand side of the above expression can be written
as

  1       X               1                 X               |ZM (λc )F ∩ ZG (g
                                                                                     −1 x
                                                                                             t)F |            −1 x
                                                                                                     ξ ♮ (g          t)θ̄0w (t−1 ż w )ψ(ẑw−1 )
|GF |           0F
                      |ZG (t)F |2                                  |ZM (λc )F |
        t∈ż w ZLw                         g,x∈GF
                                   g −1 xtx−1 g∈ZM (λc )F
        X             Z (xtx−1 )                Z (xtx−1 )
×                  ΓNgG,1          (xvx−1 )QLwxG,Cxw ,Exw ,ϕx (xvx−1 ).
     v∈ZG (t)F
             uni


                     Z (xtx−1 )                     Z (t)
Note that ΓNgG,1                  (xvx−1 ) = ΓN G−1 ,1 (v) and that
                                                     x     g


                                       Z (xtx−1 )                            Z (t)
                                     QLwxG,Cxw ,Exw ,ϕx (xvx−1 ) = QLGw ,C0w ,E0w ,ϕw0 (v).

Hence by replacing x−1 g by g in the previous expression, we have
                                                 X               X             |ZM (λc )F ∩ ZG (g t)F |
                                                                                                                 −1

(9.3.1)         hΓc,ξ , χK w ,ϕw iGF =                                                                  ×
                                                      0F
                                                                                 |ZG (t)F ||ZM (λc )F |
                                              t∈ż w ZLw        g∈GF
                                                           g −1 tg∈Z     F
                                                                  M (λc )

                                                                                        Z (t)           Z (t)
                                              × ξg♮ (t)θ̄0w (t−1 ż w )ψ(ẑw−1 )hΓNgG,1 , QLGw ,C0w ,E0w ,ϕw0 iZG (t)F ,

where ξg♮ (t) = ξ ♮ (g −1tg).




     9.4. Returning to the original setting, we consider AE as in the theorem, i.e., AE
is a direct summand of Kθw , where θ ∈ (ZL0Fw )∧ corresponds to θ0w under the isomorphism
ZL0Fw ≃ ZL0F w . Hence Wθ1 , Zθ1 , etc. are nothing but the objects discussed in 8.2. So
we write wδ = wL and γδ = γ. We continue the computation of hΓc,ξ , χAE i under this
                                                                                                                      53

setting. By (8.8.2) and (9.3.1), we have

                                    X                              X               X                             −1
                                                                                           |ZM (λc )F ∩ ZG (g t)F |
hΓc,ξ , χAE i = |Wθ1 |−1 q b0                         e
                                          Tr ((γy)−1, E)
                                y∈Wθ1                                 0F
                                                                                             |ZG (t)F ||ZM (λc )F |
                                                              t∈ż w ZLw          g∈GF
                                                                           g −1 tg∈ZM (λc )F
                                                    Z (t)      Z (t)
             × ξg♮ (t)θ̄0w (t−1 ż w )ψ(ẑw−1 )hΓNgG,1 , QLGw ,C0w ,E0w ,ϕw0 iZG (t)F .

Let H be an F -stable reductive subgroup of G containing L. Put WH = NH (L)/L ⊂
                            m
W. Recall that θ1 ∈ (ZL0F )∧ , and Zθ1 = {w ∈ W | F w θ1 = θ1 } = wL Wθ1 . Then
WH ∩ Zθ1 = wL′ WH,θ1 , where wL′ = wL wH ∈ WH with wH ∈ Wθ1 and WH,θ1 is the
                                           ′
stabilizer of θ1 in WH . Then H contains LwL y for any y ∈ WH,θ1 . Put
                      (g)
                                                 X
(9.4.1)            ∆H = |Wθ1 |−1 q b0                                    e ×
                                                         Tr ((γwH y)−1 , E)
                                               y∈WH,θ1
                                X
                            ×        ξg♮ (t)θ̄0w (t−1 ż w )ψ(ẑw−1 )hΓNHg ,1 , QH
                                                                                 Lw ,C0w ,E0w ,ϕw i F,
                                                                                                0 H
                                t


where in the second sum, t runs over all the elements in ż w ZL0Fw with w = wL′ y = wL wH y
such that ZG (t) = H and that g −1tg ∈ ZM (λc ) for g ∈ GF . Then we have
                                                              XX             (g)
(9.4.2)                                   hΓc,ξ , χAE i =                  ∆H ,
                                                               H       g


where in the first sum, H runs over all the F -stable reductive subgroups of G containing
L such that H = ZG (t) for a fixed t ∈ ZL , and in the second sum g runs over all the
elements in the double cosets H F \GF /ZM (λc )F such that g −1 tg ∈ ZM (λc )F . Here we
note the following lemma, which is a stronger version of Lemma 8.11.

Lemma 9.5. Assume that q is large enough. Let Γc′′ be as in 8.10. Then we have

                                    hΓc′′ , QG
                                             Lw ,C0w ,E0w ,ϕw i F = q −b0 +1 n−1
                                                            0 G               0 β,


where β ∈ A, and n0 is an integer independent of q.

Proof. First we note that

(9.5.1)                             hΓc,1 , QG
                                             Lw ,C0w ,E0w ,ϕw i F = q −b0 n−1
                                                            0 G
                                                                              ′
                                                                           1 β ,


where β ′ is an algebraic integer contained in a fixed cyclotomic field A independent
of q, and n1 is an integer independent of q. We show (9.5.1). We apply (9.3.1) to the
situation that ξ = 1 and θ1 = 1, i.e, Wθ1 = W. Then by a similar argument as in the
proof of (9.4.2), we have
                                                                                               XX          (g)
(9.5.2)             hΓc,1 , χK w ,ϕw iGF = |ZGF |hΓc,1 , QG
                                                          Lw ,C0w ,E0w ,ϕw i F+
                                                                         0 G
                                                                                                          ΞH ,
                                                                                               H6=G   g
54

           (g)      P   H        H
where ΞH =          t hΓNg ,1 , QLw ,C0w ,E0w ,ϕw i F . By induction on the rank of G, we may
                                                0 H
                (g)                                   (g)
assume that ΞH can be expressed as ΞH = q −b0 n−1                   ′              ′
                                                                H βH , where nH , βH are similar
                   ′
elements as n1 , β in (9.5.1). (Note that b0 has common value for all H containing L.)
On the other hand, by Theorem 7.9, χAE coincides with an almost character Rx of GF
up to a scalar νx which is a root of unity in A. It follows, by (7.9.2), that

                                      hΓc,ξ , χK w ,ϕw iGF ∈ q −b0 n−1
                                                                    2 A

with some n2 ∈ Z independent of q. (9.5.1) now follows from (9.5.2).
    Next we note that

(9.5.3)                              hΓc , QG
                                            Lw ,C0w ,E0w ,ϕw i F ∈ q −b0 A.
                                                           0 G


In fact, by Lemma 5.12 (iii), we have

                                         hΓc , Xι iGF ∈ q −b0 −b(ι) A.

Since
                                                       X
                                 QG
                                  Lw ,C0w ,E0w ,ϕw
                                                 0
                                                   =           Tr (w, Eι )q b(ι) Xι
                                                       ι∈I0F


by (8.9.1), we obtain (9.5.3).
    Now we have

          hΓc′′ , QG
                   Lw ,C0w ,E0w ,ϕw i F = hΓc , QG
                                  0 G            Lw ,C0w ,E0w ,ϕw i F −fNc hΓc,1 , QG
                                                                0 G                 Lw ,C0w ,E0w ,ϕw i F,
                                                                                                   0 G


where fNc is the number of linear characters of ZM (λc )F . Hence by (9.5.1) and (9.5.3),
we have

(9.5.4)                            hΓc′′ , QG
                                            Lw ,C0w ,E0w ,ϕw i F = q −b0 n−1
                                                           0 G            1 β
                                                                              ′



with n1 ∈ Z independent of q, and β ′ ∈ A.
    On the other hand, by Lemma 8.11, we have

(9.5.5)                     hΓc′′ , QG
                                     Lw ,C0w ,E0w ,ϕw i F = q −b0 +1 |ZL0Fw |−1 n−1
                                                    0 G                          2 β
                                                                                     ′′



with β ′′ ∈ A. We may assume that hΓc′′ , QG
                                           Lw ,C0w ,E0w ,ϕw i F 6= 0. Then by (9.5.4) and
                                                          0 G
(9.5.5), we see that
                                        n2 β ′ = q|ZL0Fw |−1 n1 β ′′ ∈ A.

Since q and |ZL0Fw | are prime to each other, n1 β ′′ is divisible by |ZL0Fw |. Hence β ′ can be
written as β ′ = qn−12 β with β ∈ A, and we have


                              hΓc′′ , QG
                                       Lw ,C0w ,E0w ,ϕw i F = q −b0 +1 (n1 n2 )−1 β.
                                                      0 G


This proves the lemma.                                                                                      
                                                                                             55

    9.6. We continue the computation in 9.4. By (8.9.1) applied to the reductive
group H, we have
                                     X
                   QH w  w   w   w
                     L ,C0 ,E0 ,φ0 =    Tr (w, Eι )q bH (ι) XιH
                                            ι∈(I0′ )F


for any w ∈ WH , where bH (ι) is given as in (8.8.1) by replacing G by H, and (IH )0 is a
block in IH corresponding to (L, C0 , E0 ). Substituting this into the previous formula,
we see that
                  (g)
                            X        X
(9.6.1)         ∆H = q b0                  aι,H (t)ξg♮ (t)q bH (ι) hΓNHg ,1 , XιH i,
                              ι∈(IH )F       0F
                                     0 t∈z1 ZL1
                                       ZG (t)=H

                 ′                ′
where L1 = LwL and z1 = ż wL . Here aι,H is given as follows; take α ∈ H such that
α−1 F (α) = ẇL′ ∈ NH (L). Then we have L1 = αLα−1 and z1 = αżwL′ α−1 . By putting
                         ′
t1 = α−1 tα ∈ (żZL0 )F wL we have
                                 X
                                                                   −1 e
(9.6.2)     aι,H (t) = |Wθ1 |−1    θ0w (t−1         −1
                                         1 żw )ψ(ẑw ) Tr ((γwH y) , E) Tr (w, Eι )
                                 y∈WH,θ1


with w = wL′ y = wL wH y.
    In the formula (9.6.1), we shall replace the inner producthΓNHg ,1 , XιH i byhΓNHg , XιH i,
which is easier to handle with. Now it is easy to see, by making use of Lemma 9.5,
that
                               hΓc′′ , Xι iGF = q −b0 −b(ι)+1 n−1
                                                               0 βι

for an appropriate integer n0 and βι ∈ A. We also note the relation

                        hΓc , Xι iGF = fNc hΓc,1 , Xι iGF +hΓc′′ , Xι iGF .

Applying these formulas to the case of H, we have
             (g)
                   X       X                                                           	
(9.6.3)    ∆H =                 aι,H (t)ξg♮ (t)fN−1g q bH (ι)+b0 hΓNHg , XιH i +qn−1
                                                                                  H βH,ι ,
                     ι∈(IH )F       0F
                            0 t∈z1 ZL1
                              ZG (t)=H


where Ng = ad(g)Nc is a nilpotent element in Lie H, nH is an integer independent of
q, and βH,ι ∈ A. Moreover, fNg is the number of linear characters of Zg M ∩H (g λ)F .
     Next we shall computehΓNHg , XιH i. Recall that ZG (g −1 tg) ⊃ L, and Ng = Ad(g)Nc ∈
Lie H. It follows that Ad(g)N ∈ Lie H. Since g ∈ GF , we may replace N by
                                                               F
N1 = Ad(g)N in parameterizing the nilpotent orbits ON             in g. Then we can iden-
                         0
tify AH,λ = ZH (N1 )/ZH (N1 ) as a subgroup of AG (N). As in 5.8, there exists c0 ∈ Aλ
such that −Nc∗ is GF -conjugate to Ncc0 . Then Ng = Ad(g)Nc is H F -conjugate to
(N1 )c , and so −Ng∗ = Ad(g)(−Nc∗ ) is H F -conjugate to (N1 )cc0 , with c, c0 ∈ AH,λ . In
particular, for ι′′ ∈ IH such that supp ι′′ = ONg , we see that Yι′′ (−Ng∗ ) = η(cc0 ), which
is independent from H. Let O1 be the nilpotent orbit in Lie H such that supp ι′ = O1
56

with Eι′ = Eι ⊗ ε. Then we have
                                               (
                       bH (ι)+b0   H      H     ζI−1  η(cc0 )−1                     if ONg = O1 ,
(9.6.4)              q           hΓNg , Xι i =     0
                                                    ′
                                                qβH,ι                               if ONg 6= O1 ,

           ′
for some βH,ι  ∈ A.
    In fact, by Lemma 5.12 (i) applying to H, we have
                                                          ′                   ′′ ))/2
          q bH (ι)+b0 hΓNHg , XιH i = ζI−1
                                         0
                                           q (dim supp (ι )−dim supp (ι                 Pι′′ ,ι′ (q −1 )Yι′′ (−Ng∗ ).

(Note that ζ(IH )0 for IH coincides with ζI0 for IG since both of them correspond to
(L, C0 , E0 ).) If supp (ι′ ) = supp (ι′′ ), then we have ι′ = ι′′ and Pι′′ ,ι′ = 1. This implies
the first equality. Now assume that ι′ 6= ι′′ . By Lemma 5.12 (ii), we have
                                          ′                 ′′ ))/2
                             q (dim supp (ι )−dim supp (ι             Pι′′ ,ι′ (q −1 ) ∈ qZ.

Since we may assume that ζI−1
                            0
                              , Yι′′ (−Ng∗ ) ∈ A, we obtain the second equality.

    9.7. We consider the sum of aι,H (t)ξg♮ (t)fN−1g in (9.6.3) for a fixed ι. Recall that
L1 = αLα−1 and that t is an element of z1 ZL0F1 such that ZG (t) = H and that g −1 tg ∈
ZM (λc ). Put MH = gMg −1 ∩H. Then MH is the Levi subgroup in H associated to the
                                                                                −1
nilpotent element Ng , and t ∈ (ZMH (Ng )∩z1 ZL0 1 )F . Put MH′ = α−1 MH α = α g M ∩H,
which is stable by FH′′ = F wL′ , and put

                       XMH = (ZMH′ (Nα−1 g ) ∩ żZL0 )/(ZM
                                                         1                0
                                                           ′ (Nα−1 g ) ∩ ZL ).
                                                           H


Then

(9.7.1)                   (ZMH (Ng ) ∩ z1 ZL0 1 )/(ZM
                                                    1
                                                      H
                                                        (Ng ) ∩ ZL0 1 ) ≃ XMH

and the action of F on the left hand side corresponds to the action of F wL′ on XMH .
   We apply Lemma 8.5 (i) to H. Then one can write, for w = wL′ y,
                                                     w′
                         θ0w (t−1         −1      L  −1          −1
                                                          ′ )ψ(ẑ ′ )Ψ −1 (y),
                               1 żw )ψ(ẑw ) = θ0 (t1 żwL      w    t1           L


where Ψt−1
        1
           is a linear character of WH,θ1 . Then (9.6.2) can be rewritten as

                               |WH,θ1 | wL′ −1                e ⊗ Ψ −1 , Eι i ′
(9.7.2)          aι,H (t) =            θ (t żwL′ )ψ(ẑw−1′ )hE              wL WH,θ1 ,
                                |Wθ1 | 0 1               L
                                                                   t1


where h , iw′ WH,θ is the inner product on the WH,θ1 -invariant functions on wL′ WH,θ1 .
            L     1
Put Y = ZMH (Ng )∩z1 ZL0 1 and Y1 = ZM1
                                        H
                                          (Ng )∩ZL0 1 . Then by Lemma 8.5 (ii), together
with the isomorphism in (9.7.1), Ψt1 depends only on t mod Y1F .
    On the other hand, we have an isomorphism

                 Y /Y1 ≃ (ZM ∩g−1 H (λc ) ∩ żZg0−1 L1 )/(ZM
                                                           1
                                                             ∩g−1 H
                                                                    (λc ) ∩ Zg0−1 L1 )
                                                                                                                       57

and a natural map

     (ZM ∩g−1 H (λc ) ∩ żZg0−1 L1 )/(ZM
                                       1
                                         ∩g−1 H
                                                (λc ) ∩ Zg0−1 L1 ) → ZM (λc )/ZM
                                                                               1
                                                                                 (λc ) ≃ Āλ .

Hence we have a map

(9.7.3)                                    Y F /Y1F → (Y /Y1)F → ĀFλ

satisfying the property that ξ ♮ (g −1 tg) = ξ(a), where a ∈ ĀFλ is the image of t ∈ Y F
under this map. In particular, we see that ξg♮ (t) also depends only on t mod Y1F .
    Put t̄ = t mod Y1F ∈ Y F /Y1F . It follows from the above argument, together with
(9.7.2), that
               X
(9.7.4)           aι,H (t)ξg♮ (t)
                   t∈t̄
                               |WH,θ1 | ♮                                        X w′
                          =                    e ⊗ Ψt̄−1 , Eι i ′
                                       ξg (t̄)hE                        ψ(ẑ   )  θ0 L (t−1
                                                               wL WH,θ1
                                                                             ′
                                                                            wL               ′ ),
                                                                                         1 zwL
                                |Wθ1 |
                                                                                           t∈t̄

                                                                                                      w′
where Ψt̄−1 (resp. ξg♮ (t̄)) denotes Ψt−1
                                       1
                                          (resp. ξg♮ (t)) for t ∈ t̄. Since θ0 L is a linear
                       ′
                   0F wL
character on ZL               , we have
                                                 (
                       X                                  w′                          w′
                                ′
                               wL     −1          |Y1F |θ̄0 L (t̄−1 z1 )          if θ̄0 L |Y1F is trivial,
(9.7.5)                       θ0    (t1 zwL′ ) =
                       t∈t̄
                                                  0                               otherwise,

          w′                                                        w′
where θ̄0 L (t̄−1 z1 ) denotes a common value of θ0 L (t−1  ′ ) for t ∈ t̄.
                                                        1 zwL
    By definition, fNg is the number of linear characters of ZMH (Ng )F , which coincides
with the order of ZMH (Ng )F /(ZMH (Ng )F )der . Hence one can write fNg as

                                                   fNg = fH |Z10F |,

where Z1 = Z(ZMH (Ng )) is the center of ZMH (Ng ), and fH is contained in a finite
subset of Q independent of q. On the other hand, the description of Y1 in 8.4 (applied
to the case MH ) implies that Z10 ⊆ Y1 . Thus Y1F is divisible by Z10F and |Y1F |/|Z10F | is
a polynomial in q (in fact, it is the order of the group of F -fixed points of the group
Y1 /Z10 whose connected component is a torus). Let gH be the constant term of the
polynomial |Y1F |/|Z10F |.
    Note that we may assume that θ0w (t) ∈ A for any w ∈ W since θ0w comes from a
                                     m
linear character θ1 of (L/Lder )F , and L/Lder is a finite group. Thus summing up the
above argument, we have the following formula.
          X
              aι,H (t)ξg♮ (t)fN−1g = n−1
                                      1 qβ
           t∈Y F
(9.7.6)                |WH,θ1 | −1                      X             ′
                                                                     w                      e ⊗ Ψt̄−1 , Eι i ′
                   +           fH gH ψ(ẑw−1′ )                    θ̄0 L (t̄−1 z1 )ξg♮ (t̄)hE               w WH,θ ,
                        |Wθ1 |             L                                                                  L   1
                                                     t̄∈Y F /Y1F
58

                                                                                    w′
where n1 ∈ Z is independent of q, and β ∈ A. (We understand that θ̄0 L (t̄−1 z1 ) = 0 if
  w′
θ̄0 L |Y1F is non-trivial).
    9.8. We return to the setup in 9.6. In view of (9.6.4) and (9.7.6), one can rewrite
the equation (9.6.3) in the form

                   (g)              |WH,θ1 | −1
                 ∆H = n−1
                       1 qβ +               f gH ζI−1     η(cc0 )−1 ψ(ẑw−1′ )×
                                     |Wθ1 | H           0                 L
(9.8.1)                               X       w ′
                                  ×                                  e ⊗ Ψt̄−1 , Eι i ′
                                            θ̄0 L (t̄−1 z1 )ξg♮ (t̄)hE
                                                                                    Lw WH,θ ,
                                                                                          1
                                       t̄∈Y F /Y1F


where n1 ∈ Z is independent of q and β ∈ A, and ι is the unique element in (IH )0
such that supp (ι′ ) = ONg with Eι′ = Eι ⊗ ε.
     We now compute the inner product hE        e ⊗ Ψt̄−1 , Eι i ′
                                                                wL WH,θ1 in the right hand side
of (9.8.1). Note that E ∈ Wθ∧1 is an extension of the Ωθ1 -stable character E1 of Wθ01
to Wθ1 ⋊ Ωθ1 , where E1 ∈ (Wθ01 )∧ is of the form E1 = E µ ⊠ · · · ⊠ E µ (t/d-times) with
E µ ∈ S∧n/t corresponding to a partition µ of n/t. Let µ∗ be the partition dual to µ.
Then N = Nλ with λ = tµ∗ by 8.2. (In general, for a partition ρ = (ρ1 , . . . , ρk ) and
a ∈ Z>0 , we put aρ = (aρ1 , . . . , aρk )). By our assumption, supp (ι′ ) = ONg . Then WH
is of the form

(9.8.2)                                WH ≃ Sν1 × · · · × Sνk ,

where ν = (ν1 , . . . , νk ) is a partition of n/d such that (t/d)µ∗ is a refinement of ν, i.e.,
νi is a sum of parts of (t/d)µ∗. Moreover WH,θ1 is given as
                                                 0
(9.8.3)                                 WH,θ1 ≃ WH,θ 1
                                                       ⋊ Ωθ1

with
                             0
                            WH,θ 1
                                   ≃ Sν ′ × · · · × Sν ′    (t/d-times),
where ν ′ is a partition of n/t such that (t/d)ν ′ = ν. Since ν ′ = (ν1′ , . . . , νk′ ) is a
partition of n/t whose parts are sums of parts of µ∗ , µ∗ determines a partition (µ(i) )∗
of νi′ for i = 1, . . . , k. We denote by µ(i) its dual partition. Hence µ = µ(1) + · · · + µ(k) .
We define an irreducible character E 0 of WH,θ     0
                                                     1
                                                       by E 0 = E10 ⊠ · · · ⊠ E10 with E10 ∈ S∧ν ′
such that
                                              (1)           (k)
                                    E10 = E µ ⊠ · · · ⊠ E µ .
We remark that
(9.8.4) hE, Eι iW 0       = 1, and E 0 is the unique irreducible character of WH,θ
                                                                               0
                                                                                   1
                                                                                     which
                   H,θ1
                                  0
appears in the restrictions to WH,θ 1
                                      of both of E and Eι .
                                             P
   In fact, one can write E|WH,θ0    = E 0 + E ′ with a(E ′ ) > a(E 0 ). On the other
                                         1
                                ρ(1)                 (k)      (i)
hand, Eι is given as Eι = E    ⊠ · · · ⊠ E ρ with E ρ ∈ S∧νi , where ρ(i) is a partition
of νi such that (ρ ) = (t/d)(µ(i) )∗ . It follows that ρ(i) = µ(i) ∪ · · · ∪ µ(i) (t/d-times).
                  (i) ∗

(For a partition λ and µ, we denote by λ ∪ µ the partition obtained by rearranging the
                                                                                                   59
                                                                                              P
parts of λ and µ in decreasing order.) Then one can write as Eι |WH,θ           0      = E 0 + E ′′
                                                                                     1
with a(E ′′ ) < a(E 0 ). Hence (9.8.4) holds.
    Since E 0 is Ωθ1 -stable, (9.8.4) implies that there exists a unique extension E          e 0 of
  0
E to WH,θ1 which appears in the decomposition of Eι |WH,θ1 with multiplicity one. On
the other hand, again by (9.8.4), the restriction of E to WH,θ1 also contains a certain
extesnion (E  e0 )′ of E 0 with multiplicity one. Hence we can write (E        e 0 )′ = E
                                                                                        e0 ⊗ ω with
                                            F ′′
some ω ∈ Ω∧θ1 . Since (IH )F0 = (IH )0 H , Eι is stable by FH′′ . Since E is also FH′′ -stable,
we see that E  e 0 and (E e0 )′ are F ′′ -stable. It follows that ω is F ′′ -stable.
                                     H                                  H
    Now by applying Lemma 8.5 (ii) to the group H, we see that

                                                            F ′′
(9.8.5) There exists a unique class xH ∈ XMHH satisfying the following.
                                                             (
                                                                   1    if t ∈ xH ,
                              hE ⊗ Ψt−1 , Eι iWH,θ =
                                                        1          0    otherwise.


    We pass to the extension E. e Then the above arguments show that the restrictions
   e ⊗ Ψt and Eι to hw i WH,θ1 contain a unique irreducible character which is an
of E       −1               ′
                            L
extension of Ee0 to hw ′ i WH,θ1 for t ∈ xH .
                       L
                                                                           F ′′
    Under the notation in 9.7, Y F /Y1F is regarded as a subset of MHH . If xH is
contained in Y F /Y1F , xH determines an element in ĀFλ by (9.7.3), which we denote by
zH ∈ ĀFλ . Then summing up the above arguments, we have
                       X            w′
                                                           e ⊗ Ψt̄−1 , Eι i ′
                                  θ̄0 L (t̄−1 z1 )ξg♮ (t̄)hE
                                                                          Lw WH,θ
                                                                                1
                    t̄∈Y F /Y1F
(9.8.6)                             ( ′
                                       w
                                     θ̄0 L (x−1
                                             H z1 )ξ(zH )αH              if xH ∈ Y F /Y1F ,
                                  =
                                     0                                   otherwise,

                                                        e which is independent of
where αH is a root of unity determined by the extension E,
q. Substituting this into (9.8.1), we have

              (g)         |WH,θ1 | −1                              w′
(9.8.7)     ∆H ∈ δH               fH gH ζI−1 η(cc0 )−1 ψ(ẑw−1′ )θ̄0 L (x−1                −1
                                                                         H z1 )ξ(zH )αH + n1 qA,
                           |Wθ1 |          0                 L



                                                  w′
where δH = 1 if xH ∈ Y F /Y1F and θ̄0 L |Y1F is trivial, and δH = 0 otherwise.

    9.9. We shall compare xH for various H appearing in 9.8. Since

                           ZMH′ (Nα−1 g ) ∩ żZL0 = Zα−1 g M (Nα−1 g ) ∩ żZL0
                   1                 0
and similarly for ZM ′ (Nz −1 g ) ∩ ZL , a similar argument as in 8.4 implies that
                          H


                                          XMH ≃ Z/(t/d)Z ≃ XM .
60

We have a natural isomorphism f : XMH → XM which is compatible with the action
of FH′′ and of F ′′ (the both coincide with the action of F on Z/(t/d)Z). Assume that
H satisfies the property (9.8.2). Then it is easy to check that wL ∈ WH , and so we
have

(9.9.1)                                    wL = wL′ .

We note that

(9.9.2)                                   f (xH ) = xG .
                       ∧
In fact, let Eι ∈ WH      , E 0 ∈ (WH,θ
                                     0
                                        1
                                          )∧ be as in 9.8 for H, and EιG ∈ W ∧ , EG0 ∈ (Wθ01 )∧
the corresponding objects for G. Here ι (resp. ιG ) is the unique element in (IH )0
(resp. I0 ) such that supp ι′ = ONg (resp. supp ι′G = ON ). Then Eι is contained
in EιG |WH with multiplicity one. On the other hand, we have E|Wθ0 = EG0 , and the
                                                                              1
restriction of EG0 on WH,θ   0
                                1
                                  contains  E 0
                                                with multiplicity  one by the  property (9.8.4).
      e 0                           0
Let E be the extension of E to WH,θ1 appearing in Eι |WH,θ1 , and let E            e 0 a similar
                                                                                    G
object as E  e 0 for E 0 . Then the above fact shows that E     e 0 occurs in the restriction of
                      G
Ee 0 with multiplicity one. This implies that E coincides with E        e0 ⊗ ω, where ω ∈ Ω∧
  G                                                                      G                    θ1
is given as in 9.8 for H. Thus (9.9.2) is proved.
     It follows from (9.9.2) that xH in (9.8.5) depends only on E, and does not depend
on the choice of H, which we denote by xE . We also denote by zE the element zH ∈ ĀFλ
determined from xH (see (9.8.6)). A similar argument as above shows that the root
of unity αH in (9.8.6) also depends only on E, and not on H, which we denote by αE .
     Summing up the above argument, (9.8.7) can be written as

              (g)     |WH,θ1 | −1
(9.9.3)    ∆H ∈ δH            fH gH ζI−1 η(cc0 )−1 ψ(ẑw−1′ )θ̄0wL (x−1                 −1
                                                                     E z1 )ξ(zE )αE + qnH A,
                       |Wθ1 |          0                 L



where δH = 1 if xE ∈ Y F /Y1F and θ̄0wL is trivial on Y1F , and δH = 0 otherwise, and nH
is an integer independent of q.


    9.10 We are now ready to prove Proposition 9.2, by completing the computation
of hΓc,ξ , χAE i. We now look at the formula (9.4.2). Take H such that H = ZG (t)
for t ∈ ZL0F1 . Then the set of g in the second sum in (9.4.2) corresponds to the set
of semisimple conjugacy classes in ZM (λc )F which are conjugate to a fixed t in GF .
Let eH be the number of g occurring in the second sum in (9.4.2). Then the above
observation implies that eH is bounded by a positive integer independent of q.
    Now by substituting (9.9.3) into (9.4.2), together with the above remark, we have

(9.10.1)                hΓc,ξ , χAE iGF = Qξ(zE )η(cc0 )−1 + qm−1 β

with some integer m independent of q and β ∈ A. Here
                                                             X
                                  −1 wL
(9.10.2)         Q = αE ζI−1
                           0
                             ψ(ẑw ′ ) θ̄0 (x−1
                                             E 1z )|Wθ1 | −1
                                                               |WH,θ1 |eH fH−1 gH ,
                                      L
                                                              H
                                                                                            61

where H runs over the subgroups such that δH = 1. Q is independent of c, ξ, and also
is contained in a finite subset of A independent of q.
     By Theorem 7.9, χAE coincides with νE Rx for a certain x = (c′ , ξ ′ ) ∈ ĀFλ × (Ā∧λ )F ,
where νE ∈ Q̄∗l is a certain root of unity. By (4.5.1) and (4.5.2), together with Theorem
2.6, we see that

(9.10.3)                   hΓc,ξ , νx Rx iGF = νE |ĀFλ |−1 ξ(c′ )ξ ′ (c).

On the other hand, suppose that β 6= 0 in (9.10.1). Then the absolute value of qm−1 β
turns out to be very large if we choose q large enough since β is contained in the ring
A of algebraic integers of the fixed cyclotomic field. This implies that the absolute
value of hΓc,ξ , χAE iGF becomes very large since Qξ(zE )η(cc0 )−1 is contained in a finite
subset of A independent of q. This contradicts the formula (9.10.3), and we conclude
that β = 0, and we have

(9.10.4)                     hΓc,ξ , χAE iGF = Qξ(zE )η(cc0 )−1 .

Comparing (9.10.3) and (9.10.4), we see that

                        c′ = zE ,    ξ ′ = η −1 ,   νE = Qη(c0 )−1 |ĀFλ |.

Note that the last equality implies that
                               X
(9.10.5)              |Wθ1 |−1     |WH,θ1 |eH fH−1 gH = ±|ĀFλ |−1 ,
                                    H

where H runs over the F -stable reductive subgroups of G containing L such that
δH = 1, which is of the form H = ZG (t) for t ∈ ZL0 satisfying the property that there
exists g ∈ GF such that g −1tg ∈ ZM (λc )F . Then we have

(9.10.6)                  νE = ±ζI−1
                                   0
                                     η(c0 )−1 αE ψ(ẑw−1′ )θ̄0wL (x−1
                                                                   E ),
                                                            L


and the signature ±1 is determined by (9.10.5). Thus Proposition 9.2 is proved.

     9.11. Returning to the setting in Theorem 8.6, we shall show that the statement
(i) in Theorem 8.6 holds without the restriction on q. The argument is divided into two
steps. First we show that Lusztig’s conjecture holds without restriction on q, and that
the scalar constants are determined explicitly, by applying the specialization argument
based on the Shintani descent identities of character sheaves in [S1, Corollary 2.12].
In the second step, we show that the parametrization of almost characters as given in
Theorem 8.6 holds without the restriction on q.

      9.12. For a positive integer c, we put Pc = {r ∈ Z≥1 | r ≡ 1 (mod c)}. Let
s ∈ G∗ be as in (8.1.1). We choose a positive integer c such that F c acts trivially on Aλ ,
                                                             (r)    (r)                  r
and that F c stabilizes ṡ and zL . Then for any r ∈ Pc , Ms,N , Ms,N (objects for GF )
                                                                                  (r)
are naturally identified with Ms,N , Ms,N (objects for GF ). We denote by ρx (resp.
  (r)                                                                  r
Ry the irreducible character (resp. the almost character) of GF corresponding to
62

           (r)                     (r)                                            mr       r
x ∈ Ms,N (resp. y ∈ Ms,N ). In particular, the set E(GF , {s})F is naturally
                                 m
identified with the set E(GF , {s})F for a sufficiently divisible m.
                           L,(r)            r
     Similarly, the set MsL,N0 (for LF ) is identified with the set MLsL ,N0 (for LF ). Let
           (mr)                                               mr
δ (mr) = δz,η be a cuspidal irreducible character of LF corresponding to (z, η) ∈
MLsL,N0 . Then Wδ(mr) and Zδ(mr) are independent of r, which we denote by Wδ , Zδ .
                                                                        ′′
By (6.7.2) and (7.9.1), we have Wδ = Wθ1 . For each E ∈ (Wθ∧1 )F , we consider the
                                                          (r)
character sheaf AE , and its characteristic function χAE with respect to F r . We also
                                   (r)        r
consider the almost character RE of GF . It follows from the proof of Theorem 7.9 (see
                (r)                    (r)
(7.9.4)) that χAE coincides with RE up to scalar. Then by Proposition 9.2 that there
                                                    (r)
exists a positive integer r0 such that this scalar νE is described by (9.10.6) and (9.10.5)
                                                                         (r)
if r > r0 . We put Pc′ = {r ∈ Pc | r > r0 }. One can check that νE is independent
of the choice of r ∈ Pc′ , by replacing c by its appropriate multiple, if necessary. We
                                        (r)
denote by νE this common value νE . We have the following proposition.


Proposition 9.13. Let the notations be as in 9.12. Assume that q is arbitrary. Then
                     ′′
for each E ∈ (Wθ∧1 )F , we have



                                             χAE = νE RE .


Proof. By Theorem 4.7, we have

(9.13.1)                     ShF mr /F r w (δ̃ (mr) |LF mr σr w ) = µ0 (Rz,η
                                                                         Lw (r)
                                                                             )

                      Lw (r)                                          r
for w ∈ Zδ , where (Rz,η ) is the almost character of LFw corresponding to (z, η). Note
that by Theorem 4.7, µ0 is independent of the choice of r ∈ Pc under the appropriate
choice of the extension δe(mr) of δ (mr) .
    Let A0 = E ⊗ Az,η be the cuspidal character sheaf on L as in Theorem 7.9. We
have WE1 = Wδ and ZE1 = Zδ . Then A0 gives rise to an F r -stable character sheaf Aw  0
                                      (r)                             Fr
of Lw for w ∈ Zδ . We denote by χAw0 the characteristic function on Lw induced from
                                w ∼
the isomorphism φw        r ∗
                    0 : (F ) (A0 ) −
                                           w
                                   → A0 . Then by Theorem 7.9, we have
                                           (r)       Lw       (r)
(9.13.2)                                 χAw0 = ν0 (Rz,η −1 )     ,

where ν0 = ζI−1 0
                  η(c0 )−1 is independent of the choice of r ∈ Pc .
                                   r                mr
    Now the map aF r w : C(LF /∼F r w ) → C(GF /∼F r ) is defined as in [S2, 3.3]. By
[S2, (3.6.3)], for w = wδ y ∈ Zδ , we have

            aF r w (δe(mr) |LF mr σr w )
                               X                                                   (mr)
                        =                                                 e mr ))(e
                                         qy−mr/2 q −l̃(w)mr/2 Tr (Tγδ y , E(q     ρE |GF mr σr ),
                         E∈(Wδ∧ )F r
                                                                                                 63

where qy is a power of q. (For the notation, see [S2, 3.5]). By applying the Shintani
descent operator to the above equality, and by using Theorem 4.7, we have

                   ShF mr /F r ◦aF r w (δe(mr) |LF mr σr w )
                                    X
(9.13.3)                     =                                                e mr ))µE R(r) ,
                                             qy−mr/2 q −l̃(w)mr/2 Tr (Tγδ y , E(q        E
                                      E∈(Wδ∧ )F r


where µE is also independent of the choice of r ∈ Pc .
   On the other hand, by the Shintani descent identity for character sheaves ([S1,
Corollary 2.12]), the following formula holds for each r ∈ Pc ;

                                                       (r)
                                                               X X       
                                                                            (r)
                 dw                      ∗                              r
            (−1) ShF mr /F r ◦ aF r w ◦ NF mr /F r w (χAw0 ) =      ci ξi χA ,
                                                                       A   i∈IA


where A runs over all the elements in G    bF , and {ξi | i ∈ IA } and {ci | i ∈ IA } are
certain finite subsets of Q̄l associated to A. Then combining (9.13.1), (9.13.2) and
(9.13.3), we see that
                              X
              (−1)dw ν0 µ−1
                         0
                                                                      e mr ))µE R(r)
                                     qy−mr/2 q −l̃(w)mr/2 Tr (Tγδ y , E(q        E
                                     E∈(Wδ∧ )F r
               X X                  
                                       (r)
           =                ci ξir    χA .
               A     i∈IA


By using the orthogonality relations for Hecke algebras (see [S2, (3.6.4)]), we can
deduce a formula

                                    (r)
                                         X X           
                                                          (r)
                            mr                        r
(9.13.4)              PWδ (q )µE RE =             di ζi χA
                                                           A    ı∈IA


for certain subsets {di | i ∈ IA } {ζi | i ∈ IA } of Q̄l (depending on E), where PWδ (t) is
a polynomial in t (a generalization of Poincaré polynomial).
    As discussed in 9.12 we have
                                                     (r)       (r)
(9.13.5)                                            χAE = νE RE

for r ∈ Pc′ . Substituting (9.13.5) into (9.13.4), we see that
                                    (
                       X             µE νE−1 PWδ (q mr )  if A = AE ,
(9.13.6)                   di ζir =
                       i∈I
                                     0                    otherwise
                            A



for any r ∈ Pc′ . By applying a variant of Dedekind’s theorem ([S1, (3.7.6)]), we see that
(9.13.6) holds for any r ∈ Pc . In particular, substituting (9.13.6) into (9.13.4), we see
that (9.13.5) holds for any r ∈ Pc . By putting r = 1, we obtain the proposition.       

    Next we show that
64
                                                   ′′
Lemma 9.14. For each E ∈ (Wθ∧1 )F , we have

                                                 RE = RzE ,µ−1
                                                            1
                                                               .

Proof. Let Pc′ be as in the proof of Proposition 9.13. We choose r ∈ Pc′ and take
m large enough so that F mr is a sufficiently divisible extension of F r . Then F mr is
also sufficiently divisible for F . Let δ = δ (mr) be a cuspidal irreducible character of
   mr                                    (r)                   (1)
LF . Then by the definition of Pc′ , Zδ is identified with Zδ . It follows that for any
             ′′
E ∈ (Wδ∧ )F , we have
                                                   (mr)                    (r)   (r)
                                      ShF mr /F r (e
                                                   ρE      |GF mr σr ) = µE RE ,
                                                        (mr)               (1)   (1)
                                        ShF mr /F (e
                                                   ρE          |GF mr σ ) = µE RE

                                (r)     (1)                                                          (r)
with some constants µE , µE . But by Proposition 9.2, we know that for r ∈ Pc′ , RE
                (r)                                                (mr)
coincides with Rz ,η−1 with (zE , η1−1 ) ∈ Ms,N . It follows that ρE coincides with
                        E   1
 (mr)                                 (1)
ρz    −1 ,   and so we have RE = RzE ,η1−1 . This proves the lemma.                                  
  E ,η1



   9.15. Combining Proposition 9.13 and Lemma 9.14, we see that (8.6.1) holds for
any q. This completes the proof of Theorem 8.6.


                                                 References
[C]          R. Carter, Finite groups of Lie type: Conjugacy classes and complex characters, A Wiley-
             Interscience Publication, 1985.
[DLM1]       F. Digne, G.I. Lehrer and J. Michel, On Gel’fand-Graev characters of reductive groups with
             disconnected centre, J. Reine angew. Math. 491 (1997), 131–147.
[DLM2]       F.Digne, G.I. Lehrer and J. Michel, The space of unipotently supported class functions on
             a finie reductive group, J. Alg.
[G]          M. Geck, A note on Harish-Chandra induction, Manuscripta Math. 80 (1993), 393–401.
[HL]         R. Howlett and G. I. Lehrer, Induced cuspidal representations and generalized Hecke rings,
             Invent. Math. 58 (1980), 37–64.
[K1]         N. Kawanaka, Generalized Gelfand-Graev representations and Ennola duality, in “Algebraic
             groups and related topics,” Advanced Studies in Pure Math., Vol 6, Kinokuniya, Tokyo
             and North Holland, Amsterdam, 1985, 179–206.
[K2]         N. Kawanaka, Generalized Gelfand-Graev representations of exceptional simple algebraic
             groups over a finite field, I, Invent. Math. 84 (1986), 575–616.
[K3]         N. Kawanaka, Shintani lifting and Gelfand-Graev representations, in “The Arcata confer-
             ence on representations of finite groups,” Proceedings of Symposia in Pure Math., Vol.47–1,
             Amer. Math. Soc., Providence, RI, 1987, 147–163
[Le]         G. I. Lehrer, The characters of the finite special linear groups, J. of Algebra. 26 (1973),
             564–583.
[L1]         G. Lusztig, “Characters of reductive groups over a finite field”, Ann. of Math. Studies,
             Vol.107, Princeton Univ Press, Princeton , 1984.
[L2]         G. Lusztig, Intersection cohomology complexes on a reductive group, Invent. Math. 75
             (1984), 205–272.
[L3]         G. Lusztig, Character sheaves, I Adv. in Math. 56 (1985), 193–237, II Adv. in Math. 57
             (1985), 226–265, III, Adv. in Math. 57 (1985), 266–315, IV, Adv. in Math. 59 (1986), 1–63,
             V, Adv. in Math. 61 (1986), 103–155.
                                                                                                  65

[L4]    G. Lusztig, On the character values of finite Chevalley groups at unipotent elements, J. of
        Algebra, 104 (1986), 146–194.
[L5]    G. Lusztig, On the representations of reductive groups with disconnected centre, Astérisque
        168 (1988), 157–166.
[L6]    G. Lusztig, Green functions and character sheaves, Annals of Mathematics, 131 (1990),
        355–408.
[L7]    G. Lusztig, A unipotent support for irreducible representations , Adv. in Math., 94 (1992),
        139–179.
[LS]    G. Lusztig and N. Spaltenstein, On the generalized Springer correspondence for classical
        groups, Advanced Studies in Pure Math. 6 (1985), pp.289–316.
[M]     I.G. Macdonald, “Symmetric functions and Hall polynomials”, second edition. Clarendon
        Press. Oxford 1995.
[S1]    T. Shoji, Character sheaves and almost characters of reductive groups, II, Adv. in Math.
        111 (1995), 314–354.
[S2]    T. Shoji, Shintani descent for special linear groups, J. Algebra 199 (1998), 175–228.
[S3]    T. Shoji, Generalized Green functions and unipotent classes for finite reductive groups, in
        preparation.
[ShS]   T. Shoji and K. Sorlin, Subfield symmetric spaces for finite special linear groups, to appear
        in Rep. Theory.
[SpS]   T.A. Springer and R. Steinberg, Conjugacy classes, in “Seminar on Algebraic groups and
        related topics”, Lecture Note in Math., Vol. 131, Part E, Springer-Verlag, 1970.
