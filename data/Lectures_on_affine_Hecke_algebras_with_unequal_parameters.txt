                                                                LECTURES ON HECKE ALGEBRAS
                                                                  WITH UNEQUAL PARAMETERS
arXiv:math/0108172v1 [math.RT] 24 Aug 2001




                                                                                   G. Lusztig



                                                These are notes for lectures given at MIT during the Fall of 1999.

                                                                              1. Coxeter groups
                                             1.1. Let S be a ﬁnite set and let M = (ms,s′ )(s,s′ )∈S×S be a matrix with entries
                                             in N ∪ {∞} such that ms,s = 1 for all s and ms,s′ = ms′ ,s ≥ 2 for all s 6= s′ . (A
                                             ”Coxeter matrix”.) Let W be the group deﬁned by the generators s(s ∈ S) and
                                             relations
                                                 (ss′ )ms,s′ = 1
                                             for any s, s′ in S such that ms,s′ < ∞. (A ”Coxeter group”.) In W we have s2 = 1
                                             for all s.
                                                 Clearly, there is a unique homomorphism sgn : W −         → {1, −1} such that sgn(s) =
                                             −1 for all s. (”Sign representation”.)
                                                 For w ∈ W let l(w) be the smallest integer q ≥ 0 such that w = s1 s2 . . . sq with
                                             s1 , s2 , . . . , sq in S. (We then say that w = s1 s2 . . . sq is a reduced expression and
                                             l(w) is the length of w.) Note that l(1) = 0, l(s) = 1 for s ∈ S. (Indeed, s 6= 1 in
                                             W since sgn(s) = −1, sgn(1) = 1.)
                                             Lemma 1.2. Let w ∈ W, s ∈ S.
                                               (a) We have either l(sw) = l(w) + 1 or l(sw) = l(w) − 1.
                                               (b) We have either l(ws) = l(w) + 1 or l(ws) = l(w) − 1.

                                                Clearly, sgn(w) = (−1)l(w) . Since sgn(sw) = −sgn(w), we have (−1)l(sw) =
                                             −(−1)l(w) . Hence l(sw) 6= l(w). This, together with the obvious inequalities
                                             l(w) − 1 ≤ l(sw) ≤ l(w) + 1 gives (a). The proof of (b) is similar.
                                             Proposition 1.3. Let E be an R-vector space with basis (es )s∈S . For s ∈ S let
                                             σs : E −→ E be the linear map defined by
                                                σs (es′ ) = es′ + 2 cos mπ ′ es for all s′ ∈ S.
                                                                        s,s

                                                (a) There is a unique homomorphism σ : W −
                                                                                         → GL(E) such that σ(s) = σs for
                                             all s ∈ S.
                                                                                                                  Typeset by AMS-TEX
                                                                                         1
2                                                  G. LUSZTIG

    (b) If s 6= s′ in S, then ss′ has order ms,s′ in W . In particular, s 6= s′ in W .
   We have σs (es ) = −es and σ induces the identity map on E/Res . It follows
that σs2 = 1. Now let s 6= s′ in S. Let m = ms,s′ and let Φ = σs σs′ . We have
                     π                 π
   Φ(es ) = (4 cos2 m   − 1)es + 2 cos m es′ ,
                      π
   Φ(es′ ) = −2 cos m es − es′ .
Hence Φ restricts to an endomorphism φ of Res ⊕ Res′ whose characteristic poly-
nomial is                             √                  √
   X 2 − 2 cos 2π
               m X + 1 = (X − e
                                    2π −1/m
                                               )(X − e−2π −1/m ).
It follows that, if 2 < m < ∞, then 1 + φ + φ2 + · · · + φm−1 = 0. The same is true
if m = 2 (in this case we see directly that φ = −1). Since Φ induces the identity
map on E/(Res ⊕ Res′ ), it follows that Φ : E −      → E has order m (if m < ∞). If
                                         2
m = ∞, we have φ 6= 1 and (φ − 1) = 0, hence φ has inﬁnite order and Φ has
also inﬁnite order. Now both (a), (b) follow.
Corollary 1.4. Let s1 6= s2 in S. Let hs1 , s2 i be the subgroup of W generated by
s1 , s2 . For k ≥ 0 let 1k = s1 s2 s1 . . . (k factors), 2k = s2 s1 s2 . . . (k factors).
    (a) Assume that m = ms1 ,s2 < ∞. Then hs1 , s2 i consists of the elements
1k , 2k (k = 0, 1, . . . , m); these elements are distinct except for the equalities 10 =
20 , 1m = 2m . For k ∈ [0, m] we have l(1k ) = l(2k ) = k.
    (b) Assume that ms1 ,s2 = ∞. Then hs1 , s2 i consists of the elements 1k , 2k
(k = 0, 1, . . . ); these elements are distinct except for the equality 10 = 20 . For all
k ≥ 0 we have l(1k ) = l(2k ) = k.

    This follows immediately from 1.3(b).
    We identify S with a subset of W (see 1.3(b)). Let T = ∪w∈W wSw−1 ⊂ W .

Proposition 1.5. Let R = {1, −1} × T . For s ∈ S let Us : R −      → R be the map
defined by Us (ǫ, t) = (ǫ(−1)δs,t , sts) where δ is the Kronecker symbol. There is
a unique homomorphism U of W into the group of permutations of R such that
U (s) = Us for all s ∈ S.

   We have Us2 (ǫ, t) = (ǫ(−1)δs,t +δs,sts , t) = (ǫ, t) since the conditions s = t, s = sts
are equivalent. Thus, Us2 = 1. For s 6= s′ in S with m = ms,s′ < ∞ we have
   Us Us′ (ǫ, t) = (ǫ(−1)δs′ ,t +δs,s′ ts′ , ss′ ts′ s)
hence

     (Us Us′ )m (ǫ, t) = (ǫ(−1)δs′ ,t +δs,s′ ts′ +δs′ ,ss′ ts′ s +δs,s′ ss′ ts′ ss′ +... , (ss′ )m t(s′ s)m )
      = (ǫ(−1)δs′ ,t +δs′ ss′ ,t +δs′ ss′ ss′ ,t +... , t)

(both sums have exactly 2m terms). It is enough to show that δs′ ,t + δs′ ss′ ,t +
δs′ ss′ ss′ ,t + . . . is even, or that t appears an even number of times in the 2m-term
sequence s′ , s′ ss′ , s′ ss′ ss′ , . . . . This follows from the fact that in this sequence the
k-th terms is equal to the (k + m)-th term for k = 1, 2, . . . , m.
          LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                               3

Proposition 1.6. Let w ∈ W .
   (a) If w = s1 s2 . . . sq is a reduced expression, then the elements
   s 1 , s 1 s 2 s 1 , s 1 s 2 s 3 s 2 s 1 , . . . , s1 s 2 . . . sq . . . s2 s 1
are distinct.
   (b) These elements form a subset of T that depends only on w, not on the choice
of reduced expression for it.
  Assume that s1 s2 . . . si . . . s2 s1 = s1 s2 . . . sj . . . s2 s1 for some 1 ≤ i < j ≤ q.
Then si = si+1 si+2 . . . sj . . . si+2 si+1 hence

      s1 s2 . . . sq = s1 s2 . . . si−1 (si+1 si+2 . . . sj . . . si+2 si+1 )si+1 . . . sj sj+1 . . . sq
                     = s1 s2 . . . si−1 si+1 si+2 . . . sj−1 sj+1 . . . sq ,

which shows that l(w) ≤ q − 2, contradiction. This proves (a).
  For (ǫ, t) ∈ R we have (see 1.5) U (w−1 )(ǫ, t) = (ǫη(w, t), w−1 tw) where η(w, t) =
±1 depends only on w, t. On the other hand,

          U (w−1 )(ǫ, t) = Usq . . . Us1 (ǫ, t)
                            = (ǫ(−1)δs1 ,t +δs2 ,s1 ts1 +···+δsq ,sq−1 ...s1 ts1 ...sq−1 , w−1 tw)
                            = (ǫ(−1)δs1 ,t +δs1 s2 s1 ,t +···+δs1 ...sq ...s1 ,t , w−1 tw).

Thus, η(w, t) = (−1)δs1 ,t +δs1 s2 s1 ,t +···+δs1 ...sq ...s1 ,t . Using (a), we see that for t ∈ T ,
the sum δs1 ,t + δs1 s2 s1 ,t + · · · + δs1 ...sq ...s1 ,t is 1 if t belongs to the subset in (b)
and is 0, otherwise. Hence the subset in (b) is just {t ∈ T |η(w, t) = −1}. This
completes the proof.
Proposition 1.7. Let w ∈ W, s ∈ S be such that l(sw) = l(w) − 1. Let w =
s1 s2 . . . sq be a reduced expression. Then there exists j ∈ [1, q] such that
    ss1 s2 . . . sj−1 = s1 s2 . . . sj .
    Let w′ = sw. Let w′ = s′1 s′2 . . . s′q−1 be a reduced expression. Then w =
ss′1 s′2 . . . s′q−1 is another reduced expression. By 1.6(b), the q-term sequences
    s1 , s1 s2 s1 , s1 s2 s3 s2 s1 , . . . and s, ss′1 s, ss′1 s′2 s′1 s, . . .
coincide up to rearranging terms. In particular, s = s1 s2 . . . sj . . . s2 s1 for some
j ∈ [1, q]. The proposition follows.
1.8. Let X be the set of all sequences (s1 , s2 , . . . , sq ) in W such that s1 s2 . . . sq
is a reduced expression in W . We regard X as the vertices of a graph in which
(s1 , s2 , . . . , sq ), (s′1 , s′2 , . . . , s′q ′ ) are joined if one is obtained from the other by re-
placing m consecutive entries of form s, s′ , s, s′ , . . . by the m entries s′ , s, s′ , s, . . . ;
here s 6= s′ in S are such that m = ms,s′ < ∞. We use the notation
   (s1 , s2 , . . . , sq ) ∼ (s′1 , s′2 , . . . , s′q ′ )
for ”(s1 , s2 , . . . , sq ), (s′1 , s′2 , . . . , s′q ′ ) are in the same connected component of X”.
(When this holds we have necessarily q = q ′ and s1 s2 . . . sq = s′1 s′2 . . . s′q in W .)
4                                            G. LUSZTIG

Theorem 1.9. Let (s1 , s2 , . . . , sq ), (s′1 , s′2 , . . . , s′q ) in X be such that s1 s2 . . . sq =
s′1 s′2 . . . s′q = w ∈ W . Then (s1 , s2 , . . . , sq ) ∼ (s′1 , s′2 , . . . , s′q ).

   We shall use the following notation.
   Let s = (s1 , s2 , . . . , sq ), s′ = (s′1 , s′2 , . . . , s′q ). Let C (resp. C ′ ) be the connected
component of X that contains s (resp. s′ ). For i ∈ [1, q] we set
   s(i) = (. . . , s′1 , s1 , s′1 , s′1 , s1 , s2 , s3 , . . . , si ) (a q-elements sequence in S),
   s(i) = . . . s′1 s1 s′1 s′1 s1 s2 s3 . . . si ∈ W (the product of this sequence).
Let C(i) be the connected component of X that contains s(i). Then s = s(q).
Hence C = C(q).
   We argue by induction on q. The theorem is obvious for q ≤ 1. We now assume
that q ≥ 2 and that the theorem is known for q − 1. We ﬁrst prove the following
weaker statement.
   (A) In the setup of the theorem we have either
   (s1 , s2 , . . . , sq ) ∼ (s′1 , s′2 , . . . , s′q ), or
(a) s1 s2 . . . sq = s′1 s1 s2 . . . sq−1 and (s′1 , s1 , s2 , . . . , sq−1 ) ∼ (s′1 , s′2 , . . . , s′q ).
We have l(s′1 w) = l(w) − 1. By 1.7 we have s′1 s1 s2 . . . si−1 = s1 s2 . . . si for some
i ∈ [1, q], so that w = s′1 s1 s2 . . . si−1 si+1 . . . sq . In particular,
   (s′1 , s1 , s2 , . . . , si−1 , si+1 , . . . , sq ) ∈ X.
By the induction hypothesis, we have (s1 , s2 , . . . , si−1 , si+1 , . . . , sq ) ∼ (s′2 , . . . , s′q ).
Hence
   (b) (s′1 , s1 , s2 , . . . , si−1 , si+1 , . . . , sq ) ∼ (s′1 , s′2 , . . . , s′q ).
Assume ﬁrst that i < q. Then from s′1 s1 s2 . . . si−1 si+1 . . . sq−1 = s1 s2 . . . sq−1 and
the induction hypothesis we deduce that
   (s′1 , s1 , s2 , . . . , si−1 , si+1 , . . . , sq−1 ) ∼ (s1 , s2 , . . . , sq−1 ), hence
   (s′1 , s1 , s2 , . . . , si−1 , si+1 , . . . , sq−1 , sq ) ∈ C.
Combining this with (b) we deduce that C = C ′ .
   Assume next that i = q so that s1 s2 . . . sq = s′1 s1 s2 . . . sq−1 . Then (b) shows
that (a) holds. Thus, (A) is proved.
   Next we prove for p ∈ [0, q − 2] the following generalization of (A).
   (A′p ) In the setup of the theorem we have either C = C ′ or:
   for i ∈ [q − p − 1, q] we have s(i) ∈ X, s(i) = w, Ci = C if i = q mod 2 and
Ci = C ′ if i = q + 1 mod 2.
For p = 0 this reduces to (A). Assume now that p > 0 and that (A′p−1 ) is already
known. We prove that (A′p ) holds.
   If C = C ′ , then we are done. Hence by (A′p−1 ) we may assume that: for
i ∈ [q − p, q] we have s(i) ∈ X, s(i) = w, Ci = C if i = q mod 2 and Ci = C ′ if
i = q + 1 mod 2.
   Applying (A) to s(q − p), s(q − p + 1) (instead of s, s′ ), we see that either
Cq−p = Cq−p+1 or:
   s(q − p), s(q − p − 1) are in X,s(q − p) = s(q − p − 1) and Cq−p−1 = Cq−p+1 .
In both cases, we see that (A′p ) holds.
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                    5

    This completes the inductive proof of (A′p ). In particular, (A′q−2 ) holds. In
other words, in the setup of the theorem, either C = C ′ holds or:
    (c) for i ∈ [1, q] we have s(i) ∈ X, s(i) = w, Ci = C if i = q mod 2 and Ci = C ′
if i = q + 1 mod 2.
If C = C ′ , then we are done. Hence we may assume that (c) holds. In particular,
    (d) s(2) ∈ X, s(1) ∈ X, s(2) = s(1).
From s(1) ∈ X and q ≥ 2 we see that s′ 6= s and that q ≤ m = ms,s′ . From
s(2) = s(1) we see that s2 ∈ hs1 , s′1 i, hence s2 is either s1 or s′1 . In fact we cannot
have s2 = s1 since this would contradict s(2) ∈ X. Hence s2 = s′1 . We see that
s(2) = (. . . , s′1 , s1 , s′1 , s1 , s′1 ) (the number of terms is q, q ≤ m). Since s(2) = s(1),
it follows that q = m, so that s(2), s(1) are joined in X. It follows that C2 = C1 .
By (c), for some permutation a, b of 1, 2 we have Ca = C, Cb = C ′ . Since Ca = Cb
it follows that C = C ′ .It follows that C = C ′ . The theorem is proved.

Proposition 1.10. Let w ∈ W and let s, t ∈ S be such that l(swt) = l(w), l(sw) =
l(wt). Then sw = wt.

    Let w = s1 s2 . . . sq be a reduced expression.
    Assume ﬁrst that l(wt) = q +1. Then s1 s2 . . . sq t is a reduced expression for wt.
Now l(swt) = l(wt)−1 hence by 1.7 there exists i ∈ [1, q] such that ss1 s2 . . . si−1 =
s1 s2 . . . si or else ss1 s2 . . . sq = s1 s2 . . . sq t. If the second alternative occurs, we
are done. If the ﬁrst alternative occurs, we have sw = s1 s2 . . . si−1 si+1 . . . sq hence
l(sw) ≤ q − 1. This contradicts l(sw) = l(wt).
    Assume next that l(wt) = q − 1. Let w′ = wt. Then l(sw′ t) = l(w′ ), l(sw′ ) =
l(w′ t). We have l(w′ t) = l(w′ ) + 1 hence the ﬁrst part of the proof applies and
gives sw′ = w′ t. Hence sw = wt. The proposition is proved.

1.11. We can regard S as the set of vertices of a graph in which s, s′ are joined
if ms,s′ > 2. We say that W is irreducible if this graph is connected. It is easy
to see that in general, W is naturally a product of irreducible Coxeter groups,
corresponding to the connected components of S.
   In the setup of 1.3, let (, ) : E × E → R be the symmetric R-bilinear form given
by (es , es′ ) = − cos mπ ′ . Then σ(w) : E −→ E preserves (, ) for any w ∈ W . We
                        s,s
say that W is tame if (e, e) ≥ 0 for any e ∈ E. It is easy to see that, if W is ﬁnite
then W is tame.
   We say that W is integral if, for any s 6= s′ in S, we have 4 cos2 mπ ′ ∈ Z (or
                                                                          s,s
equivalently ms,s′ ∈ {2, 3, 4, 6, ∞}).
   We will be mainly interested in the case where W is tame. The tame, irreducible
W are of three kinds:
   (a) ﬁnite, integral;
   (b) ﬁnite, non-integral;
   (c) tame, inﬁnite (and automatically integral).
The W of type (c) are called affine Weyl groups.
6                                        G. LUSZTIG

                                 2. Partial order on W
2.1. Let y, w be two elements of W . We say that y ≤ w if there exists a sequence
                                                                                         −1
y = y0 , y1 , y2 , . . . , yn = w such that l(yk ) − l(yk−1 ) = 1 for k ∈ [1, n] and yk yk−1 ∈
                                 −1           −1                 −1
T (or equivalently yk−1 yk ∈ T , or yk yk−1 ∈ T , or yk−1 yk ∈ T ) for k ∈ [1, n].
   This is clearly a partial order on W . Note that y ≤ w implies l(y) ≤ l(w). Also,
y ≤ w implies y −1 ≤ w−1 . If w ∈ W, s ∈ S then, clearly:
   sw < w if and only if l(sw) = l(w) − 1;
   sw > w if and only if l(sw) = l(w) + 1.
Lemma 2.2. Let w = s1 s2 . . . sq be a reduced expression and let t ∈ T . The
following are equivalent:
   (i) U (w−1 )(ǫ, t) = (−ǫ, w−1 tw) for ǫ = ±1;
   (ii) t = s1 s2 . . . si . . . s2 s1 for some i ∈ [1, q];
   (iii) l(tw) < l(w).
   The equivalence of (i),(ii) has been proved earlier.
   Proof of (ii) =⇒ (iii). Assume that (ii) holds. Then tw = s1 . . . si−1 si+1 . . . sq
hence l(tw) < q and (iii) holds.
   Proof of (iii) =⇒ (i). First we check that
   (a) U (t)(ǫ, t) = (−ǫ, t).
If t ∈ S, (a) is clear. If (a) is true for t then it is also true for sts where s ∈ S.
Indeed,

    U (sts)(ǫ, sts) = Us U (t)Us (ǫ, sts) = Us U (t)(ǫ(−1)δs,sts , t) = Us (−ǫ(−1)δs,sts , t)
                   = (−ǫ(−1)δs,sts +δs,t , t) = (−ǫ, t);

(a) follows. Assume now that (i) does not hold; thus, U (w−1 )(ǫ, t) = (ǫ, w−1 tw).
Then

         U ((tw)−1 )(ǫ, t) = U (w−1 )U (t)(ǫ, t) = U (w−1 )(−ǫ, t) = (−ǫ, w−1 tw)
                           = (−ǫ, (tw)−1 t(tw)).

Since (i) =⇒ (iii) we deduce that l(w) < l(tw); thus, (iii) does not hold. The
lemma is proved.
Lemma 2.3. Let y, z ∈ W and let s ∈ S. If sy ≤ z < sz, then y ≤ sz.
   We argue by induction on l(z) − l(sy). If l(z) − l(sy) = 0 then z = sy and the
result is clear. Now assume that l(z) > l(sy). Then sy < z. We can assume that
sy < y (otherwise the result is trivial). We can ﬁnd t ∈ T such that sy < tsy ≤ z
and l(tsy) = l(sy) + 1. If t = s, then y ≤ z and we are done. Hence we may
assume that t 6= s. We show that
   (a) y < stsy.
Assume that (a) does not hold. Then y, tsy, sy, stsy have lengths q + 1, q + 1, q, q.
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                       7

We can ﬁnd a reduced expression y = ss1 s2 . . . sq . Since l(stsy) < l(y), we see
from 2.2 that either sts = ss1 . . . si . . . s1 s for some i ∈ [1, q] or sts = s. (This last
case has been excluded.) It follows that
    tsy = s1 . . . si . . . s1 sss1 s2 . . . sq = s1 . . . si−1 si+1 . . . sq .
Thus, l(tsy) ≤ q − 1, a contradiction. Thus, (a) holds. Let y ′ = stsy. We have
sy ′ ≤ z ≤ sz and l(z) − l(sy ′ ) < l(z) − l(sy). By the induction hypothesis, we have
y ′ ≤ sz. We have y < y ′ by (a), hence y ≤ sz. The lemma is proved.
Proposition 2.4. The following three conditions on y, w ∈ W are equivalent:
   (i) y ≤ w;
   (ii) for any reduced expression w = s1 s2 . . . sq there exists a subsequence i1 <
i2 < · · · < ir of 1, 2, . . . , q such that y = si1 si2 . . . sir , r = l(y);
   (iii) there exists a reduced expression w = s1 s2 . . . sq and a subsequence i1 <
i2 < · · · < ir of 1, 2, . . . , q such that y = si1 si2 . . . sir .
    Proof of (i) =⇒ (ii). We may assume that y < w. Let y = y0 , y1 , y2 , . . . , yn = w
be as in 2.1. Let w = s1 s2 . . . sq be a reduced expression. Since yn−1 yn−1 ∈ T ,
l(yn−1 ) = l(yn )−1, we see from 2.2 that there exists i ∈ [1, q] such that yn−1 yn−1 =
s1 s2 . . . si . . . s2 s1 hence yn−1 = s1 s2 . . . si−1 si+1 . . . sq . This is a reduced expres-
                                     −1
sion. Similarly, since yn−2 yn−1          ∈ T , l(yn−2 ) = l(yn−1 )−1, we see from 2.2 (applied
to yn−1 ) that there exists j ∈ [1, q] − {i} such that yn−2 equals
    s1 s2 . . . si−1 si+1 . . . sj−1 sj+1 . . . sq or s1 s2 . . . sj−1 sj+1 . . . si−1 si+1 . . . sq
(depending on whether i < j or i > j). Continuing in this way we see that y is of
the required form.
    Proof of (ii) =⇒ (iii). This is trivial.
    Proof of (iii) =⇒ (i). Assume that w = s1 s2 . . . sq (reduced expression) and
y = si1 si2 . . . sir where i1 < i2 < · · · < ir is a subsequence of 1, 2, . . . , q. We argue
by induction on q. If q = 0 there is nothing to prove. Now assume q > 0.
    If i1 > 1, then the induction hypothesis is applicable to y, w′ = s2 . . . sq and
yields y ≤ w′ . But w′ ≤ w hence y ≤ w. If i1 = 1 then the induction hypothesis is
applicable to y ′ = si2 . . . sir , w′ = s2 . . . sq and yields y ′ ≤ w′ . Thus, s1 y ≤ s1 w <
w. By 2.3 we then have y ≤ w. The proposition is proved.
Corollary 2.5. Let y, z ∈ W and let s ∈ S.
  (a) Assume that sz < z. Then y ≤ z ↔ sy ≤ z.
  (b) Assume that y < sy. Then y ≤ z ↔ y ≤ sz.
    We prove (a). We can ﬁnd a reduced expression of z of form z = ss1 s2 . . . sq .
Assume that y ≤ z. By 2.4 we can ﬁnd a subsequence i1 < i2 < · · · < ir of
1, 2, . . . , q such that either y = si1 si2 . . . sir or y = ssi1 si2 . . . sir . In the ﬁrst case
we have sy = ssi1 si2 . . . sir and in the second case we have sy = si1 si2 . . . sir . In
both cases we have sy ≤ z by 2.4. The same argument shows that, if sy ≤ z then
y ≤ z. This proves (a).
   We prove (b). Assume that y ≤ z. We must prove that y ≤ sz. If z < sz, this
is clear. Thus we may assume that sz < z. We can ﬁnd a reduced expression of
8                                         G. LUSZTIG

z of form z = ss1 s2 . . . sq . By 2.4 we can ﬁnd a subsequence i1 < i2 < · · · < ir of
1, 2, . . . , q such that either y = si1 si2 . . . sir , l(y) = r or y = ssi1 si2 . . . sir , l(y) =
r + 1. In the second case we have l(sy) = r < l(y), contradicting y < sy. Thus we
are in the ﬁrst case. Hence y is the product of a subsequence of s1 , s2 , . . . , sq and
using again 2.4, we deduce that y ≤ sz (note that sz = s1 s2 . . . sq is a reduced
expression). The lemma is proved.

                                     3. The algebra H
3.1. A map L : W −      → Z is said to be a weight function for W if L(ww′ ) =
L(w) + L(w′ ) for any w, w′ ∈ W such that l(ww′ ) = l(w) + l(w′ ). We will assume
that a weight function L : W −   → Z is ﬁxed; we then say that W, L is a weighted
Coxeter group. (For example we could take L = l; in that case we say that we
are in the split case.) Note that L is determined by its values L(s) on S which
are subject only to the condition that L(s) = L(s′ ) for any s 6= s′ in S such that
ms,s′ is ﬁnite and odd. We necessarily have L(1) = 0 and L(w) = L(w−1 ) for all
w ∈ W.
   Let A = Z[v, v −1 ] where v is an indeterminate. For s ∈ S we set vs = v L(s) ∈ A.
3.2. Let H be the A-algebra with 1 deﬁned by the generators Ts (s ∈ S) and the
relations
   (a) (Ts − vs )(Ts + vs−1 ) = 0 for s ∈ S;
   (b) Ts Ts′ Ts · · · = Ts′ Ts Ts′ . . .
(both products have ms,s′ factors) for any s 6= s′ in S such that ms,s′ < ∞.
   H is called the Hecke algebra or the Iwahori-Hecke algebra.
   For w ∈ W we deﬁne Tw ∈ H by Tw = Ts1 Ts2 . . . Tsq , where w = s1 s2 . . . sq is
a reduced expression. By (b) and 1.9, Tw is independent of the choice of reduced
expression. From the deﬁnitions it is clear that for s ∈ S, w ∈ W we have
   Ts Tw = Tsw if l(sw) = l(w) + 1,
   Ts Tw = Tsw + (vs − vs−1 )Tw if l(sw) = l(w) − 1.
In particular, the A-submodule of H generated by {Tw |w ∈ W } is a left ideal of
H. It contains 1 = T1 hence it is the whole of H. Thus {Tw |w ∈ W } generates
the A-module H.
Proposition 3.3. {Tw |w ∈ W } is an A-basis of H.
  We consider the free A-module E with basis (ew )w∈W . For any s ∈ S we deﬁne
A-linear maps Ps : E → E, Qs : E → E by
  Ps (ew ) = esw if l(sw) = l(w) + 1,
  Ps (ew ) = esw + (vs − vs−1 )ew if l(sw) = l(w) − 1;
  Qs (ew ) = ews if l(ws) = l(w) + 1,
  Qs (ew ) = ews + (vs − vs−1 )ew if l(ws) = l(w) − 1.
We shall continue the proof assuming that
  (a) Ps Qt = Qt Ps for any s, t in S.
Let A be the A-subalgebra with 1 of End(E) generated by {Ps |s ∈ S}. The map
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                 9

A−  → E given by π 7→ π(e1 ) is surjective. Indeed, if w = s1 s2 . . . sq is a reduced
expression, then ew = Ps1 . . . Psq e1 . Assume now that π ∈ A satisﬁes π(e1 ) = 0.
Let π ′ = Qsq . . . Qs1 . By (a) we have ππ ′ = π ′ π hence
    0 = π ′ π(e1 ) = ππ ′ (e1 ) = π(Qsq . . . Qs1 (e1 )) = π(ew ).
Since w is arbitrary, it follows that π = 0. We see that the map A −        → E is injective,
hence an isomorphism of A-modules. Using this isomorphism we transport the
algebra structure of A to an algebra structure on E with unit element e1 . For
this algebra structure we have Ps (e1 )π(e1 ) = Ps (π(e1 )) for s ∈ S, π ∈ A. Hence
es ew = Ps (ew ) for any w ∈ W, s ∈ S. It follows that
    (b) es ew = esw if l(sw) = l(w) + 1,
    (c) es ew = esw + (vs − vs−1 )ew if l(sw) = l(w) − 1.
From (b) it follows that, if w = s1 s2 . . . sq is a reduced expression, then ew =
es1 es2 . . . esq . In particular, if s 6= s′ in S are such that m = ms,s′ < ∞ then
es es′ es · · · = es′ es es′ . . . (both products have m factors); indeed, this follows from
the equality ess′ s... = es′ ss′ ... (see 1.4). From (c) we deduce that e2s = 1 + (vs −
vs−1 )es for s ∈ S, or that (es − vs )(es + vs−1 ) = 0. We see that there is a unique
algebra homomorphism H −             → E preserving 1 such that Ts 7→ es for all s ∈ S. This
homomorphism takes Tw to ew for any w ∈ W             P. Assume now that aw ∈ A (w ∈ W )
are zero forP    all but ﬁnitely many w and that w aw Tw = 0 in H. Applying H −         →E
we obtain w aw ew = 0. Since (ew ) is a basis of E, it follows that aw = 0 for all
w. Thus, {Tw |w ∈ W } is an A-basis of H. This completes the proof, modulo the
veriﬁcation of (a).
    We prove (a). Let w ∈ W . We distinguish six cases.
    Case 1. swt, sw, wt, w have lengths q + 2, q + 1, q + 1, q. Then
    Ps Qt (ew ) = Qt Ps (ew ) = eswt .
Case 2. w, sw, wt, swt have lengths q + 2, q + 1, q + 1, q. Then
        Ps Qt (ew ) = Qt Ps (ew )
         = eswt + (vt − vt−1 )esw + (vs − vs−1 )ewt + (vt − vt−1 )(vs − vs−1 )ew .
Case 3. wt, swt, w, sw have lengths q + 2, q + 1, q + 1, q. Then
   Ps Qt (ew ) = Qt Ps (ew ) = eswt + (vs − vs−1 )ewt .
Case 4. sw, swt, w, wt have lengths q + 2, q + 1, q + 1, q. Then
   Ps Qt (ew ) = Qt Ps (ew ) = eswt + (vt − vt−1 )esw .
Case 5. swt, w, wt, sw have lengths q + 1, q + 1, q, q. Then
   Ps Qt (ew ) = eswt + (vt − vt−1 )esw + (vt − vt−1 )(vs − vs−1 )ew ,
   Qt Ps (ew ) = eswt + (vs − vs−1 )ewt + (vt − vt−1 )(vs − vs−1 )ew .
Case 6. sw, wt, w, swt have lengths q + 1, q + 1, q, q. Then
   Ps Qt (ew ) = eswt + (vs − vs−1 )ewt ,
   Qt Ps (ew ) = eswt + (vt − vt−1 )esw .
In case 5 we have L(t)+L(wt) = L(w) = L(swt) = L(s)+L(wt) hence L(t) = L(s)
and vs = vt . In case 6 we have L(t) + L(swt) = L(sw) = L(wt) = L(s) + L(swt),
hence L(t) = L(s) and vs = vt . In case 5 and 6 we have sw = wt by 1.10. Hence
Ps Qt (ew ) = Qt Ps (ew ) in each case. The proposition is proved.
10                                           G. LUSZTIG

3.4. There is a unique involutive antiautomorphism of the algebra H which carries
Ts to Ts for any s ∈ S. (This follows easily by looking at the deﬁning relations of
H.) It carries Tw to Tw−1 for any w ∈ W .
3.5. There is a unique algebra involution of H denoted h 7→ h† such that Ts† =
−Ts−1 for any s ∈ S. We have Tw† = sgn(w)Tw−1−1 for any w ∈ W .



                                    4. The bar operator
4.1. For s ∈ S, the element Ts ∈ H is invertible: we have Ts−1 = Ts − (vs − vs−1 ).
It follows that Tw is invertible for each w ∈ W ; if w = s1 s2 . . . sq is a reduced
expression, then Tw−1 = Ts−1
                          q
                             . . . Ts−1
                                     2
                                        Ts−1
                                          1
                                             .
   Let¯: A −→ A be the ring involution which takes v n to v −n for any n ∈ Z.
Lemma 4.2. (a) There is a unique ring homomorphism ¯ : H −         → H which is
                                                           −1
                                  → A and satisfies T s = Ts for all s ∈ S.
A-semilinear with respect to ¯: A −
  (b) This homomorphism is involutive. It takes Tw to Tw−1 −1 for any w ∈ W .


   The following two identities can be deduced easily from 3.2(a),(b):
   (Ts−1 − vs−1 )(Ts−1 + vs ) = 0 for s ∈ S,
   Ts−1 Ts−1  −1
           ′ Ts  · · · = Ts−1 −1 −1
                           ′ Ts Ts′ . . .
(both products have ms,s′ factors) for any s 6= s′ in S such that ms,s′ < ∞; (a)
follows.
   We prove (b). Let s ∈ S. Applying¯to Ts Ts = 1 gives T¯s T¯s = 1. We have also
Ts Ts = 1 hence T¯s = Ts . It follows that the square of¯ is 1. The second assertion
of (b) is immediate. The lemma is proved.
         any w ∈ W we can write uniquely
4.3. For P
   T w = y∈W r y,w Ty
where ry,w ∈ A are zero for all but ﬁnitely many y.
Lemma 4.4. Let w ∈ W and s ∈ S be such that w > sw. For y ∈ W we have
  ry,w = rsy,sw if sy < y,
  ry,w = rsy,sw + (vs − vs−1 )ry,sw if sy > y.
     We have
                                                       X
        T w = Ts−1 T sw = (Ts − (vs − vs−1 ))               r̄y,sw Ty
                                                        y
                X                  X                                    X
            =       r̄y,sw Tsy −        (vs − vs−1 )r̄y,sw Ty +              (vs − vs−1 )r̄y,sw Ty
                y                   y                               y;sy<y
                X                   X
            =       r̄sy,sw Ty −            (vs −   vs−1 )r̄y,sw Ty .
                y                  y;sy>y


The lemma follows.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                             11

Lemma 4.5. For any y, w we have r̄y,w = sgn(yw)ry,w .
   We argue by induction on l(w). If w = 1 the result is obvious. Assume now
that l(w) ≥ 1. We can ﬁnd s ∈ S such that w > sw. Assume ﬁrst that sy < y.
From 4.4 we see, using the induction hypothesis, that
   r̄y,w = r̄sy,sw = sgn(sysw)rsy,sw = sgn(yw)ry,w .
Assume next that sy > y. From 4.4 we see, using the induction hypothesis, that

  r̄y,w = r̄sy,sw + (vs−1 − vs )r̄y,sw = sgn(sysw)rsy,sw + (vs−1 − vs )sgn(ysw)ry,sw
       = sgn(yw)(rsy,sw + (vs − vs−1 )ry,sw ) = sgn(yw)ry,w .

The lemma is proved.
                                            P
Lemma 4.6. For any x, z ∈ W we have           y   r x,y ry,z = δx,z .
  Using the fact that¯is an involution, we have
             P            P             P P
  Tz = T z = y r y,z Ty = y ry,z T y = y x ry,z r x,y Tx .
We now compare the coeﬃcients of Tx on both sides. The lemma follows.
Proposition 4.7. Let y, w ∈ W .
  (a) If ry,w 6= 0, then y ≤ w.
  (b) Assume that L(s) > 0 for all s ∈ S. If y ≤ w, then
  ry,w = v L(w)−L(y) mod v L(w)−L(y)−1 Z[v −1 ],
  ry,w = sgn(yw)v −L(w)+L(y) mod v −L(w)+L(y)+1 Z[v].
  (c) Without assumption on L, ry,w ∈ v L(w)−L(y) Z[v 2 , v −2 ].
   We prove (a) by induction on l(w). If w = 1 the result is obvious. Assume now
that l(w) ≥ 1. We can ﬁnd s ∈ S such that w > sw. Assume ﬁrst that sy < y.
From 4.4 we see that rsy,sw 6= 0 hence, by the induction hypothesis, sy ≤ sw.
Thus sy ≤ sw < w and, by 2.3, we deduce y ≤ w. Assume next that sy > y. From
4.4 we see that either rsy,sw 6= 0 or ry,sw 6= 0 hence, by the induction hypothesis,
sy ≤ sw or y ≤ sw. Combining this with y < sy and sw < w we see that y ≤ w.
This proves (a).
   We prove the ﬁrst assertion of (b) by induction on l(w). If w = 1 the result
is obvious. Assume now that l(w) ≥ 1. We can ﬁnd s ∈ S such that w > sw.
Assume ﬁrst that sy < y. Then we have also sy < w and, using 2.5(b), we deduce
sy ≤ sw. By the induction hypothesis, we have

                   rsy,sw = v L(sw)−L(sy) + strictly lower powers
                          = v L(w)−L(y) + strictly lower powers.

But ry,w = rsy,sw and the result follows. Assume next that sy > y. From y <
sy, y ≤ w we deduce using 2.5(b) that y ≤ sw. By the induction hypothesis, we
have
12                                           G. LUSZTIG

  ry,sw = v L(sw)−L(y) + strictly lower powers.
Hence

               (vs − vs−1 )ry,sw = v L(s) v L(sw)−L(y) + strictly lower powers
                = v L(w)−L(y) + strictly lower powers.

On the other hand, if sy ≤ sw, then by the induction hypothesis,

                        rsy,sw = v L(sw)−L(sy) + strictly lower powers
                         = v L(w)−L(y)−2L(s) + strictly lower powers

while if sy 6≤ sw then rsy,sw = 0 by (a). Thus, in
   ry,w = rsy,sw + (vs − vs−1 )ry,sw ,
the term rsy,sw contributes only powers of v which are strictly smaller than L(w)−
L(y) and thus, ry,w = v L(w)−L(y) + strictly lower powers. This proves the ﬁrst
assertion of (b). The second assertion of (b) follows from the ﬁrst using 4.5.
   We prove (c) by induction on l(w). If w = 1 the result is obvious. Assume now
that l(w) ≥ 1. We can ﬁnd s ∈ S such that w > sw. Assume ﬁrst that sy < y.
By the induction hypothesis, we have
   ry,w = rsy,sw ∈ v L(sw)−L(sy) Z[v 2 , v −2 ] = v L(w)−L(y) Z[v 2 , v −2 ]
as required. Assume next that sy > y. By the induction hypothesis, we have

     ry,w = rsy,sw + (vs − vs−1 )ry,sw
     ∈ v L(sw)−L(sy)Z[v 2 , v −2 ] + v L(s) v L(sw)−L(y) Z[v 2 , v −2 ] = v L(w)−L(y) Z[v 2 , v −2 ],

as required. The proposition is proved.
                                                               P
Proposition 4.8. For any x < z in W we have                       y;x≤y≤z   sgn(y) = 0.
   UsingP 4.5 we can rewrite 4.6 (in our case) in the form
   (a) y sgn(xy)rx,y ry,z = 0.
Here we may restrict the summation to y such that x ≤ y ≤ z. In the rest of the
proof we shall take L = l. Then 4.7(b) holds and we see that if x ≤ y ≤ z, then
   rx,y ry,z is v l(y)−l(x) v l(z)−l(y) + strictly lower powers of v.
Hence (a) states that
                           l(z)−l(x)
   P
      y;x≤y≤z sgn(xy)v
                P
                                      + strictly lower powers of v is 0.
In particular y;x≤y≤z sgn(xy) = 0. The proposition is proved.
4.9. The involution¯: H −→ H commutes with the involution in 3.4. (This is clear
on the generators of H.) It follows that
   (a) ry−1 ,w−1 = ry,w
for any y, w ∈ W .
                                           → H and † : H −
   On the other hand, it is clear that¯: H −             → H commute.
       LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                                13

                                    5. The elements cw
5.1. For any n ∈ Z let
   A≤n = ⊕m;m≤n Zv m , A≥n = ⊕m;m≥n Zv m , A<n = ⊕m;m<n Zv m , A>n = ⊕m;m>n Zv m .

Note that A≤0 = Z[v −1 ].
  Let H≤0 = ⊕w A≤0 Tw , H<0 = ⊕w A<0 Tw . We have H<0 ⊂ H≤0 ⊂ H.
Theorem 5.2. (a) Let w ∈ W . There exists a unique element cw ∈ H≤0 such
that cw = cw and cw = Tw mod H<0 .
   (b) {cw |w ∈ W } is an A≤0 -basis of H≤0 and an A-basis of H.
   We prove the existence part of (a). We will construct, for any x such that
x ≤ w, an element ux ∈ A≤0 such that
   (c) uw = 1,                P
   (d) ux ∈ A<0 , ūx − ux = y;x<y≤w rx,y uy for any x < w.
We argue by induction on l(w) − l(x). If l(w) − l(x) = 0 then x = w and we
deﬁne ux by (c). Assume now that l(w) − l(x) > 0 and that uz is already deﬁned
whenever z ≤ w, l(w) − l(z) < l(w) − l(x) so that (c) holds and (d) holds if x is
replaced by any such z. Then the right hand side of the equality in (d) is deﬁned.
We denote it by ax ∈ A. We have
                    X               X
      ax + āx =          rx,y uy +      r̄x,y ūy
                    y;x<y≤w                y;x<y≤w
                      X                         X                       X
               =              rx,y uy +                  r̄x,y (uy +             ry,z uz )
                    y;x<y≤w                y;x<y≤w                     z;y<z≤w
                      X                         X                      X         X
               =              rz,y uy +                 r̄x,z uz +                       r̄x,y ry,z uz
                    z;z<y≤w                z;x<z≤w                   z;x<z≤w y;x<y<z
                      X           X                            X
               =                          r̄x,y ry,z uz =               δx,z uz = 0.
                    z;x<z≤w y;x≤y≤z                         z;x<z≤w

(We have
      P used n4.6 and the equality ry,y = 1.) Since ax + āx = 0, we have
ax = n∈Z γn v (ﬁnite sum) where P    γn ∈ Z satisfy γn + γ−n = 0 for all n and
                                                n
in particular, γ0 = 0. Then ux =       n<0 γn v   ∈ A<0 satisﬁes ūx − ux = ax .
This P
     completes the inductive construction of the elements ux . We now deﬁne
cw = y;y≤w uy Ty ∈ H≤0 . It is clear that cw = Tw mod H<0 . We have
               X                   X            X                      X       X
       cw =           ūy T y =           ūy           r̄x,y Tx =         (           r̄x,y ūy )Tx
              y;y≤w               y;y≤w         x;x≤y                x;x≤w y;x≤y≤w
            X
        =           ux Tx = cw .
            x;x≤w

(We have used the fact that rx,y 6= 0 implies x ≤ y, see 4.7, and (d).) Thus, the
existence of the element cw is established.
14                                        G. LUSZTIG

   To prove uniqueness, it suﬃces to verify the following statement:
   (e) If h ∈ H<0 satisfies h̄P= h then h = 0.
We can write uniquely h = y∈W fy Ty where fy ∈ A<0 are zero for all but ﬁnitely
many y. Assume that not all fy are 0. Then we can ﬁnd l0 ∈ N such that
   Y0 = {y ∈ W |fy 6= 0, l(y) = l0 } =
                                     6 ∅ and {y ∈ W |fy 6= 0, l(y) > l0 } = ∅.
                 P        P
The equality y fy Ty = y fy Ty implies then
   P                P      ¯y Ty mod P
      y∈Y0 f y Ty =  y∈Y0 f              y;l(y)<l(y0 ) ATy
        ¯
hence fy = fy for any y ∈ Y0 . Since fy ∈ A<0 , it follows that fy = 0 for any
y ∈ Y0 , a contradiction. We have proved that fy = 0 for all y; (e) is veriﬁed and
(a) is proved.
   The elements cw constructed in (a) (for various w) are related to the basis Tw
by a triangular matrix (with respect to ≤) with 1 on the diagonal. Hence these
elements satisfy (b). The theorem is proved.
                                      P
5.3. For any w ∈ W we set cw = y∈W py,w Ty where py,w ∈ A≤0 . By the proof
of 5.2 we have
   py,w = 0 unless y ≤ w,
   pw,w = 1,
   py,w ∈ A<0 if y < w.
Moreover, P for any x < w in W we have
   p̄x,w = y;x≤y≤w rx,y py,w .
Proposition 5.4. (a) Assume that L(s) > 0 for all s ∈ S. If x ≤ w, then
  px,w = v −L(w)+L(x) mod v −L(w)+L(x)+1 Z[v].
  (b) Without assumption on L, for x ≤ w we have px,w = v L(w)−L(x) Z[v 2 , v −2 ].
   We prove (a) by induction on l(w)−l(x). If l(w)−l(x) = 0 then x = w, px,w = 1
and the result is obvious. Assume P now that l(w) − l(x) > 0. Using 4.7(b) and the
induction hypothesis, we see that y;x<y≤w rx,y py,w is equal to
   X                                               X
         sgn(x)sgn(y)v −L(y)+L(x) v −L(w)+L(y) =         sgn(x)sgn(y)v −L(w)+L(x)
y;x<y≤w                                                   y;x<y≤w

plus strictly higher powers of v. Using 4.8, we see that this is −v −L(w)+L(x) plus
strictly higher powers of v. Thus,
   p̄x,w − px,w = −v −L(w)+L(x) plus strictly higher powers of v.
Since p̄x,w ∈ vZ[v], it is in particular a Z-linear combination of powers of v strictly
higher than −L(w) + L(y). Hence
   −px,w = −v −L(w)+L(x) plus strictly higher powers of v.
This proves (a).
   We prove (b) by induction on l(w) − l(x). If l(w) − l(x) = 0, then x = w,
px,w = 1 and the result is obvious. Assume now that l(w) − l(x) > 0. Using 4.7(c)
and the induction hypothesis, we see that
   X                   X
         rx,y py,w ∈           v L(y)−L(x) v L(w)−L(y) Z[v 2 , v −2 ] = v L(w)−L(x) Z[v 2 , v −2 ].
y;x<y≤w               y;x<y≤w
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                15

Thus, p̄x,w − px,w ∈ v L(w)−L(x) Z[v 2 , v −2 ]. Hence px,w ∈ v L(w)−L(x) Z[v 2 , v −2 ]. The
proposition is proved.
5.5. Let s ∈ S. From Ts−1 = Ts − (vs − vs−1 ) we see that r1,s = vs − vs−1 . We also
see that
   Ts + vs−1 = Ts − (vs − vs−1 ) + vs = Ts + vs−1 ,
   Ts − vs = Ts − (vs − vs−1 ) − vs−1 = Ts − vs .
If L(s) = 0 we have Ts−1 = Ts . Hence,
   cs = Ts + vs−1 if L(s) > 0,
   cs = Ts − vs if L(s) < 0,
   cs = Ts if L(s) = 0.
5.6. The involution in 3.4 carries Tw to Tw−1 hence it carries H≤0 into itself;
moreover, it commutes with¯: H − → H (as pointed out in 4.9). Hence it carries cw
to cw−1 for any w ∈ W . It follows that
   (a) py−1 ,w−1 = py,w
for any y, w ∈ W .

                     6. Left or right multiplication by cs
6.1. In this section we ﬁx s ∈ S. Assume ﬁrst that L(s) = 0. In this case we have
cs = Ts ; moreover,
           P         Ts Ty =PTsy . Hence forPw ∈ W we have
   cs cw = y py,w Ts Ty = y py,w Tsy = y psy,w Ty .
We see that cs cw ∈ H≤0 and cs cw = Tsw mod H<0 . Since cs cw = cs cw , it follows
that, in this case, cs cw = csw . Similarly we have cw cs = cws .
6.2. In the remainder of this section (except in 6.8) we assume that L(s) > 0.
Proposition 6.3. To any y, w ∈ W such that sy < y < w < sw one can assign
uniquely an element µsy,w ∈ A so that
        s      s
   (i) µP
        y,w = µy,w and
   (ii) z;y≤z<w;sz<z py,z µsz,w − vs py,w ∈ A<0
for any y, w ∈ W such that sy < y < w < sw.
   Let y, w be as above. We may assume that µsz,w are already deﬁned for all z
such that y < z < w; sz < z. Then condition (ii) is of the form:
   µsy,w equals a known element of A modulo A<0 .
This condition determines uniquely the coeﬃcients of v n with n ≥ 0 in µsy,w . Then
condition (i) determines uniquely the coeﬃcients of v n with n < 0 in µsy,w . The
proposition is proved.
Proposition 6.4. Let y, w ∈ W be such that sy < y < w < sw. Then µsy,w
is a Z-linear combination of powers v n with −L(s) + 1 ≤ n ≤ L(s) − 1 and
n = L(w) − L(y) − L(s) mod 2.
  We may assume that this is already known for all µsz,w with z such that y <
z < w; sz < z. Using 6.3(ii) and 5.4, we see that µsy,w is a Z-linear combination
16                                          G. LUSZTIG

of powers v n such that, whenever n ≥ 0, we have n ≤ L(s) − 1 and n = L(w) −
L(y) − L(s) mod 2. Using now 6.3(i), we deduce the remaining assertions of the
proposition.
Corollary 6.5. Assume that L(s) = 1. Let y, w ∈ W be such that sy < y < w <
sw. Then µsy,w is an integer, equal to the coefficient of v −1 in py,w . In particular,
it is 0 unless L(w) − L(y) is odd.
   In this case, the inequalities of 6.4 become 0 ≤ n ≤ 0. They imply n = 0. Thus,
µsy,w is an integer. Picking up the coeﬃcient of v 0 in the two sides of 6.3(ii), we
see that µsy,w is equal to the coeﬃcient of v −1 in py,w . The last assertion follows
from 5.4.
Theorem 6.6. Let w ∈ W .
  (a) If w < sw, then cs cw = csw + z;sz<z<w µsz,w cz .
                                    P

  (b) If sw < w, then cs cw = (vs + vs−1 )cw .
   Since cs = Ts + vs−1 (see 5.5), we see that (b) is equivalent to (Ts − vs )cw = 0,
or to
   (c) px,w = vs−1 psx,w
(where sw < w, x < sx). We prove the theorem by induction on l(w). If w = 1,
the result is obvious. Assume now that l(w) ≥ 1 and that the result holds when
w is replaced by w′ with l(w′ ) < l(w).
   Case 1. Assume that w < sw. Using cs = Ts + vs−1 , we see that the coeﬃcient
of Ty in the left hand side minus the right hand side of (a) is
                                                    X
                fy = vsσ py,w + psy,w − py,sw −              py,z µsz,w
                                                           z;y≤z<w;sz<z

where σ = 1 if sy < y and σ = −1 if sy > y. We must show that fy = 0. We ﬁrst
show that
   (d) fy ∈ A<0 .
If sy < y this follows from 6.3(ii). (The contribution of psy,w − py,sw is in A<0 if
sy 6= w and is 1 − 1 = 0 if sy = w.)
   If sy > y then, by (c) (applied to z in the sum, instead of w), we have
                                                  X
             fy = vs−1 py,w + psy,w − py,sw −             vs−1 psy,z µsz,w
                                                       z;y≤z<w;sz<z

                =   vs−1 fsy   +   vs−1 psy,sw   − py,sw

(the second equality holds by 2.5(a)) and this is in A<0 since fsy ∈ A<0 (by the
previous paragraph), vs−1 ∈ A<0 and since y 6= sw. PThus, (d) is proved.
   Since both sides of (a) are ﬁxed by ¯, the sum y fy Ty is ﬁxed by ¯. From (d)
and 5.2(e) we see that fy = 0 for all y, as required.
   Case 2. Assume that w > sw. Then case 1 is aplicable to sw (by the induction
hypothesis). We see that
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                             17

   cw = (Ts + vs−1 )csw − z;sz<z<sw µsz,sw cz .
                          P

Now (Ts − vs )(Ts + vs−1 ) = 0 and (Ts − vs )cz = 0 for each z in the sum (by the
induction hypothesis). Hence (Ts − vs )cw = 0. The theorem is proved.
Corollary 6.7. Let w ∈ W .
  (a) If w < ws, then cw cs = cws + z;zs<z<w µsz−1 ,w−1 cz .
                                    P

  (b) If ws < w, then cw cs = (vs + vs−1 )cw .
   We write the equalities in 6.6(a),(b) for w−1 instead of w and we apply to these
equalities the involution 3.4. Since this involution carries cw to cw−1 , the corollary
follows.
6.8. 6.3, 6.6, 6.7 remain valid when L(s) < 0 provided that we replace in their
statements and proofs vs by −vs−1 .

                                7. Dihedral groups
7.1. In this section we assume that S consists of two elements s1 , s2 . For i = 1, 2,
let Li = L(si ), Ti = Tsi , ci = csi . We assume that L1 > 0, L2 > 0. Let m = ms1 ,s2 .
Let 1k , 2kPbe as in 1.4. For w ∈ W we set
   Γw = y;y≤w v −L(w)+L(y) Ty .
Lemma 7.2. We have
  c1 Γ2k = Γ1k+1 + v L1 −L2 Γ1k−1 if k ∈ [2, m),
  c2 Γ1k = Γ2k+1 + v −L1 +L2 Γ2k−1 if k ∈ [2, m),
  c1 Γ2k = Γ1k+1 if k = 0, 1,
  c2 Γ1k = Γ2k+1 if k = 0, 1.
  Since ci = Ti + v −Li , the proof is an easy exercise.
Proposition 7.3. Assume that L1 = L2 . For any w ∈ W we have cw = Γw .
  This is clear when l(w) ≤ 1. In the present case Lemma 7.2 gives

(c)                Γ1k+1 = c1 Γ2k − Γ1k−1 ,    Γ2k+1 = c2 Γ1k − Γ2k−1

for k ∈ [1, m). This shows by induction on k that Γw = Γw for all w ∈ W . Clearly,
Γw = Tw mod H<0 . The lemma follows.
7.4. In 7.4-7.6 we assume that L2 > L1 . In this case, if m < ∞, then m is even.
(See 3.1.) For 2k + 1 ∈ [1, m) we set
                     X
       Γ′22k+1 =           (1 − v 2L1 + v 4L1 − · · · + (−1)s v 2sL1 )v −sL1 −sL2
                   s∈[0,k−1]

        × (T22k−2s+1 + v −L2 T22k−2s + v −L2 T12k−2s + v −2L2 T12k−2s−1 )
        + (1 − v 2L1 + v 4L1 − · · · + (−1)k v 2kL1 )v −kL1 −kL2 (T21 + v −L2 T20 ).
18                                        G. LUSZTIG

For 2k + 1 ∈ [3, m) we set
Γ′12k+1
                                                               X
= T12k+1 + v −L1 T12k + v −L1 T22k + v −2L1 T22k−1 +                  v −L(w)+L(y) (1 + v 2L1 )Ty .
                                                               y
                                                            y≤12k−1

For w such that l(w) is even and for w = 11 we set Γ′w = Γw .
Lemma 7.5. Let ζ = v L1 −L2 + v L2 −L1 ∈ A. We have
  (a) c1 Γ′2k′ = Γ′1k′ +1 , if k ′ ∈ [0, m);
  (b) c2 Γ′1k′ = Γ′2k′ +1 + ζΓ′2k′ −1 + Γ′2k′ −3 , if k ′ ∈ [4, m);
  (c) c2 Γ′1k′ = Γ′2k′ +1 + ζΓ′2k′ −1 , if k ′ = 2, 3, k ′ < m;
  (d) c2 Γ′1k′ = Γ′2k′ +1 if k ′ = 0, 1.
   From the deﬁnitions   we have
   (e) Γ22k+1 = s∈[0,k] (−1)s v s(L1 −L2 ) Γ22k−2s+1 if 2k + 1 ∈ [1, m),
         ′
                 P

   (f) Γ′12k+1 = Γ12k+1 + v L1 −L2 Γ12k−1 if 2k + 1 ∈ [3, m).
We prove (a) for k ′ = 2k + 1. The left hand side can be computed using (e) and
7.2:
             c1 Γ′22k+1 = c1 (Γ22k+1 − v L1 −L2 Γ22k−1 + v 2L1 −2L2 Γ22k−3 + . . . )
              = Γ12k+2 + v L1 −L2 Γ12k − v L1 −L2 Γ12k − v 2L1 −2L2 Γ12k−2
             + v 2L1 −2L2 Γ12k−2 − v 3L1 −3L2 Γ12k−4 + · · · = Γ12k+2 = Γ′12k+2 .
This proves (a) for k ′ = 2k + 1. Now (a) for k ′ = 0 is trivial. We prove (a) for
k ′ = 2k ≥ 2. The left hand side can be computed using 7.2 and (f):
    c1 Γ′22k = c1 Γ22k = Γ12k+1 + v L1 −L2 Γ12k−1 = Γ′12k+1 .
This proves (a) for k ′ = 2k. We prove (b) for k ′ = 2k. The left hand side can be
computed using 7.2:
    c2 Γ′12k = c2 Γ12k = Γ22k+1 + v −L1 +L2 Γ22k−1 .
The right hand side of (b) is (using (e)):
     Γ22k+1 − v L1 −L2 Γ22k−1 + v 2L1 −2L2 Γ22k−3 + . . .
     + ζΓ22k−1 − v L1 −L2 ζΓ22k−3 + v 2L1 −2L2 ζΓ22k−5 + . . .
     + Γ22k−3 − v L1 −L2 Γ22k−5 + v 2L1 −2L2 Γ22k−7 + · · · = Γ22k+1 + v −L1 +L2 Γ22k−1 .
This proves (b) for k ′ = 2k. We prove (b) for k ′ = 2k + 1. The left hand side can
be computed using (f) and 7.2:
     c2 Γ′12k+1 = c2 (Γ12k+1 + v L1 −L2 Γ12k−1 )
      = Γ22k+2 + v −L1 +L2 Γ22k + v L1 −L2 Γ22k + Γ22k−2 = Γ′22k+2 + ζΓ′22k + Γ′22k−2 .
This proves (b) for k ′ = 2k + 1. The proof of (c),(d) is similar to that of (b). This
completes the proof.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                        19

Proposition 7.6. For any w ∈ W we have cw = Γ′w .
   Clearly, Γ′w = Tw mod H<0 . From the formulas in 7.5 we see by induction on
l(w) that Γ′w = Γ′w for all w. The proposition is proved.
Proposition 7.7. Assume that m = ∞. For a ∈ {1, 2}, let fa = v L(a) + v −L(a) .
                                          ′
  (a) Assume that LP  1 = L2 . For k, k ≥ 0, we have
  ca2k+1 ca2k′ +1 = fa u∈[0,min(2k,2k′ )] ca2k+2k′ +1−2u .
                                          ′
  (b) Assume that LP  2 > L1 . For k, k ≥ 0, we have
  c22k+1 c22k′ +1 = f2 u∈[0,min(k,k′ )] c22k+2k′ +1−4u .
  (c) Assume that L2 > L1 . For k, k ′ ≥ 1, we have
                                                     X
                  c12k+1 c12k′ +1 = f1                           pu c12k+2k′ +1−2u
                                          u∈[0,min(k−1,k′ −1)]

where pu = ζ for u odd, pu ∈ Z for u even.
  We prove (a). For k = k ′ = 0 the equality in (a) is clear. Assume now that
k = 0, k ′ ≥ 1. Using 7.2, 7.3, we have

                c2 c22k′ +1 = c2 (c2 c12k′ − c22k′ −1 ) = f2 c2 c12k′ − f2 c22k′ −1
                 = f2 c22k′ +1 + f2 c22k′ −1 − f2 c22k′ −1 = f2 c22k′ +1 ,

as required. We now prove the equality in (a) for ﬁxed k ′ , by induction on k.
The case k = 0 is already known. Assume now that k = 1. From 7.2,7.3 we have
c23 = c2 c1 c2 − c2 . Using this and 7.2, 7.3, we have

    c23 c22k′ +1 = c2 c1 c2 c22k′ +1 − c2 c22k′ +1 = f2 c2 c12k′ +2 + f2 c2 c12k′ − f2 c22k′ +1
     = f2 c22k′ +3 + f2 c22k′ +1 + f2 c22k′ +1 + (1 − δk′ ,0 )f2 c22k′ −1 − f2 c22k′ +1
     = f2 c22k′ +3 + f2 c22k′ +1 + f2 (1 − δk′ ,0 )c22k′ −1 ,

as required. Assume now that k ≥ 2. From 7.2,7.3 we have
   c22k+1 = c2 c1 c22k−1 − 2c22k−1 − c22k−3 .
Using this and the induction hypothesis we have

    c22k+1 c22k′ +1 = c2 c1 c22k−1 c22k′ +1 − 2c22k−1 c22k′ +1 − c22k−3 c22k′ +1
                       X                                        X
     = f2 c1 c2                     c22k+2k′ −1−2u − f2                     c22k+2k′ −1−2u
                 u∈[0,min(2k−2,k′ )]                       u∈[0,min(2k−2,k′ )]
                   X
     − f2                         c22k+2k′ −3−2u .
            u∈[0,min(2k−4,k′ )]


We now use 7.2,7.3 and (a) follows (for a = 2). The case a = 1 is similar.
20                                              G. LUSZTIG

  We prove (b). For k = k ′ = 0 the equality in (b) is clear. Assume now that
k = 0, k ′ = 1. Using 7.5, 7.6, we have

 c2 c23 = c2 (c2 c12 − ζc21 ) = f2 c2 c12 − f2 ζc21 = f2 c23 + f2 ζc21 − f2 ζc21 = f2 c23 ,

as required. Assume next that k = 0, k ′ ≥ 2. Using 7.5, 7.6, we have

     c2 c22k′ +1 = c2 (c2 c12k′ − ζc22k′ −1 − c22k′ −3 ) = f2 c2 c12k′ − f2 ζc22k′ −1 − f2 c22k′ −3
     = f2 c22k′ +1 + f2 ζc22k′ −1 + f2 c22k′ −3 − f2 ζc22k′ −1 − f2 ζc22k′ −3 = f2 c22k′ +1 ,

as required. We now prove the equality in (a) for ﬁxed k ′ , by induction on k.
The case k = 0 is already known. Assume now that k = 1. From 7.5,7.6 we have
c23 = c2 c1 c2 − ζc2 . Using this and 7.5,7.6, we have

             c23 c22k′ +1 = c2 c1 c2 c22k′ +1 − ζc2 c22k′ +1 = f2 c2 c12k′ +2 − f2 ζc22k′ +1
              = f2 c22k′ +3 + f2 ζc22k′ +1 + (1 − δk′ ,0 )f2 c22k′ −1 − f2 ζc22k′ +1
              = f2 c22k′ +3 + (1 − δk′ ,0 )f2 c22k′ −1

as required. Assume now that k ≥ 2. From 7.5,7.6 we have
   c22k+1 = c2 c1 c22k−1 − ζc22k−1 − c22k−3 .
Using this and the induction hypothesis we have

        c22k+1 c22k′ +1 = c2 c1 c22k−1 c22k′ +1 − ζc22k−1 c22k′ +1 − c22k−3 c22k′ +1
                          X                                         X
         = f2 c2 c1                   c22k+2k′ −1−4u − f2 ζ                    c22k+2k′ −1−4u
                     u∈[0,min(k−1,k′ )]                       u∈[0,min(k−1,k′ )]
                      X
         − f2                        c22k+2k′ −3−4u .
                u∈[0,min(k−2,k′ )]


We now use 7.5,7.6 and (b) follows.
  The proof of (c) is similar to that of (b). This completes the proof.
Proposition 7.8. Assume that 4 ≤ m < ∞ and L2 > L1 . Then m = 2k + 2 with
k ≥ 1. Let
  p = (−1)k (v L2 + v −L2 )(v k(L2 −L1 ) + v (k−2)(L2 −L1 ) + · · · + v −k(L2 −L1 ) ).
Then, for some q ∈ A, we have
  (a) c2m−1 c2m−1 = pc2m−1 + qc2m .
   From 7.5,7.6, we see that Ac2m−1 + Ac2m is a two-sided ideal of H. Hence (a)
holds for some (unknown) p, q ∈ A. It remains to compute p. Let χ : H −      →A
                                                          −L1             L2
be the algebra homomorphism deﬁned by χ(T1 ) = −v             , χ(T2 ) = v . Since
c2m = (T1 + v −L1 )h for some h ∈ H (see 7.5,7.6) we see that χ(c2m ) = 0. Hence
applying χ to (a) gives χ(c2m−1 )2 = pχ(c2m−1 ). It is thus enough to show that
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                         21

  (b) χ(c2m−1 ) = p.
We verify (b) for m = 4:

          χ(T2 T1 T2 + v −L2 T2 T1 + v −L2 T1 T2 + v −2L2 T1
           + (v −L1 −L2 − v L1 −L2 )T2 + (v −L1 −2L2 − v L1 −2L2 ))
           = −v −L1 +2L2 − 2v −L1 − v −L1 −2L2 + (v −L1 −L2 − v L1 −L2 )v L2
           + v −L1 −2L2 − v L1 −2L2 = −v −L1 +2L2 − v −L1 − v L1 − v L1 −2L2 )

and for m = 6:

χ(T2 T1 T2 T1 T2 + v −L2 T2 T1 T2 T1 + v −L2 T1 T2 T1 T2 + v −2L2 T1 T2 T1
+ (v −L1 −L2 − v L1 −L2 )T2 T1 T2 + (v −L1 −2L2 − v L1 −2L2 )T1 T2
+ (v −L1 −2L2 − v L1 −2L2 )T2 T1 + (v −L1 −3L2 − v L1 −3L2 )T1
+ (v −2L1 −2L2 − v −2L2 + v 2L1 −2L2 )T2 + (v −2L1 −3L2 − v −3L2 + v 2L1 −3L2 ))
= v −2L1 +3L2 + 2v −2L1 +L2 + v −2L1 −L2 − v −2L1 +L2 − 2v −2L1 −L2 − v −2L1 −3L2 + v L2
+ 2v −L2 + v −3L2 + v −2L1 −L2 − v −L2 + v 2L1 −L2 + v −2L1 −3L2 − v −3L2 + v 2L1 −3L2
= v −2L1 +3L2 + v −2L1 +L2 + v L2 + v −L2 + v 2L1 −L2 + v 2L1 −3L2 .

Analogous computations can be carried out for any even m. The proposition is
proved.

                                         8. Cells
8.1. For z ∈ W deﬁne Dz ∈ HomA (H, A) by
    Dz (cw ) = δz,w for all w ∈ W .
If w, w′ ∈ W we write w ←L w′ or w′ →L w if there exists s ∈ S such that
Dw (cs cw′ ) 6= 0; we write w ←R w′ or w′ →R w if there exists s ∈ S such that
Dw (cw′ cs ) 6= 0; we write w ←LR w′ or w′ →LR w if there exists s ∈ S such that
Dw (cs cw′ ) 6= 0 or Dw (cw′ cs ) 6= 0.
    If w, w′ ∈ W , we say that w ≤L w′ (resp. w ≤R w′ ) if there exists a sequence
w = w0 , w1 , . . . , wn = w′ in W such that
    w0 ←L w1 , w1 ←L w2 , . . . , wn−1 ←L wn
    (resp. w0 ←R w1 , w1 ←R w2 , . . . , wn−1 ←R wn ).
If w, w′ ∈ W , we say that w ≤LR w′ if there exists a sequence
    w = w0 , w1 , . . . , wn = w′
in W such that
    w0 ←LR w1 , w1 ←LR w2 , . . . , wn−1 ←LR wn .
Clearly ≤L , ≤R , ≤LR are preorders on W . Let ∼L , ∼R , ∼LR be the associated
equivalence relations. (For example, we have w ∼L w′ if and only if w ≤L w′ and
w′ ≤L w.) The equivalence classes on W for ∼L , ∼R , ∼LR are called respectively
left cells, right cells, two-sided cells of W . They depend on L : W −
                                                                     → N.
22                                    G. LUSZTIG

    If w, w′ ∈ W , we say that w <L w′ (resp. w <R w′ ; w <LR w′ ) if w ≤L w′ and
w∼ 6 L w′ (resp. w <R w′ and w 6∼R w′ ; w <LR w′ and w 6∼LR w′ ).
    Let w, w′ ∈ W . It is clear that
    w ≤L w′ if and only if w−1 ≤R w′−1 ,
    w ≤LR w′ if and only if w−1 ≤LR w′−1 .
It follows that w 7→ w−1 carries left cells to right cells, right cells to left cells and
two-sided cells to two-sided cells.
Lemma 8.2. Let w′ ∈ W .
  (a) H≤L w′ = ⊕w;w≤L w′ Acw is a left ideal of H.
  (b) H≤R w′ = ⊕w;w≤R w′ Acw is a right ideal of H.
  (c) H≤LR w′ = ⊕w;w≤LR w′ Acw is a two-sided ideal of H.
   We prove (a). Since cs (s ∈ S) generate H as an A-algebra, it is enough to verify
the following statement:
   if w ∈ W is such that w ≤L w′ and s ∈ S then cs cw ∈ H≤L w′ .
From the deﬁnition, cs cw is an A-linear combination of elements cw′′ with w′′ ←L
w. For such w′′ we clearly have w′′ ≤L w′ . This proves (a). The proof of (b),(c)
is entirely similar.
8.3. Let Y be a left cell of W . From 8.3(a) we see that for y ∈ Y ,
    ⊕w;w≤L y Acw / ⊕w;w<L y Acw
is a quotient of two left ideals of H (independent of the choice of y) hence it is
naturally a left H-module; it has an A-basis consisting of the images of cw (w ∈ Y ).
    Similarly, if Y ′ is a right cell of W then, for y ′ ∈ Y ′ ,
    ⊕w;w≤R y′ Acw / ⊕w;w<R y′ Acw
is a quotient of two right ideals of H (independent of the choice of y ′ ) hence
it is naturally a right H-module; it has an A-basis consisting of the images of
cw (w ∈ Y ′ ).
    If Y ′′ is a two-sided cell of W then, for y ′′ ∈ Y ′′ ,
    ⊕w;w≤LR y′′ Acw / ⊕w;w<LR y′′ Acw
is a quotient of two two-sided ideals of H (independent of the choice of y ′′ ) hence
it is naturally a H-bimodule; it has an A-basis consisting of the images of cw (w ∈
Y ′′ ).
Lemma 8.4. Let s ∈ S. Assume that L(s) > 0. Let Hs = ⊕w;sw<w Acw ,s Hs =
⊕w;ws<w Acw .
  (a) {h ∈ H|(cs − vs − vs−1 )h = 0} = Hs . Hence Hs is a right ideal of H.
  (b) {h ∈ H|h(cs − vs − vs−1 ) = 0} = s H. Hence s H is a left ideal of H.
   We prove the equality in (a). The right hand side is contained in the left hand
side by 6.6(b). Conversely, by 6.6, we have cs h ∈ Hs for any h ∈ H. Hence, if
h ∈ H is such that cs h = (vs + vs−1 )h, then (vs + vs−1 )h ∈ Hs so that h ∈ Hs (since
H/Hs is a free A-module). This proves (a). The proof of (b) is entirely similar.
The lemma is proved.
8.5. For w ∈ W we set L(w) = {s ∈ S|sw < w}, R(w) = {s ∈ S|ws < w}.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                        23

Lemma 8.6. Let w, w′ ∈ W . Assume that L(s) > 0 for all s ∈ S.
  (a) If w ≤L w′ , then R(w′ ) ⊂ R(w). If w ∼L w′ , then R(w′ ) = R(w).
  (b) If w ≤R w′ , then L(w′ ) ⊂ L(w). If w ∼R w′ , then L(w′ ) = L(w).
   To prove the ﬁrst assertion of (a), we may assume that Dw (cs cw′ ) 6= 0 for some
s ∈ S. Let t ∈ R(w′ ). We must prove that t ∈ R(w). We have cw′ ∈ t H. By 8.4,
t
  H is a left ideal of H. Hence cs cw′ ∈ t H. By the deﬁnition of t H, for h ∈ t H we
have Dw (h) = 0 unless wt < w. Hence from Dw (cs cw′ ) 6= 0 we deduce wt < w, as
required. This proves the ﬁrst assertion of (a). The second assertion of (a) follows
immediately from the ﬁrst. The proof of (b) is entirely similar to that of (a). The
lemma is proved.
8.7. We describe the left cells of W in the setup of 7.3. From 7.2 and 7.3 we can
determine all pairs y 6= w such that y ← w (we write ←, → instead of ←L , →L ):
   10 → 21 ⇆ 12 ⇆ 23 ⇆ . . . ,
   20 → 11 ⇆ 22 ⇆ 13 ⇆ . . . ,
if m = ∞,
   10 → 21 ⇆ 12 ⇆ 23 ⇆ . . . ⇆ 2m−1 → 1m ,
   20 → 11 ⇆ 22 ⇆ 13 ⇆ . . . ⇆ 1m−1 → 2m ,
if m < ∞, m even,
   10 → 21 ⇆ 12 ⇆ 23 ⇆ . . . ⇆ 1m−1 → 2m ,
   20 → 11 ⇆ 22 ⇆ 13 ⇆ . . . ⇆ 2m−1 → 1m ,
if m < ∞, m odd. Hence the left cells are
   {10 }, {21 , 12 , 23 , . . . }, {11 , 22 , 13 , . . . },
if m = ∞,
   {10 }, {21 , 12 , 23 , . . . , 2m−1 }, {11 , 22 , 13 , . . . , 1m−1 }, {2m },
if m < ∞, m even,
   {10 }, {21 , 12 , 23 , . . . , 1m−1 }, {11 , 22 , 13 , . . . , 2m−1 }, {2m },
if m < ∞, m odd.
   The two-sided cells are {10 }, W − {10 } if m = ∞ and {10 }, {2m }, W − {10 , 2m }
if m < ∞.
8.8. We describe the left cells of W in the setup of 7.4. From 7.5 and 7.6 we can
determine all pairs y 6= w such that y ← w (we write ←, → instead of ←L , →L ).
If m = ∞, these pairs are:
   10 → 21 ⇆ 12 → 23 ⇆ 14 → . . . , 20 → 11 → 22 ⇆ 13 → 24 ⇆ . . . ,
and 21 ← 14 , 22 ← 15 , 23 ← 16 , . . . .
   If m = 4, these pairs are:
   10 → 21 ⇆ 12 → 23 → 14 , 20 → 11 → 22 ⇆ 13 → 24 .
If m = 6, these pairs are:
   10 → 21 ⇆ 12 → 23 ⇆ 14 → 25 → 16 , 20 → 11 → 22 ⇆ 13 → 24 ⇆ 15 → 26 ,
and 21 ← 14 , 22 ← 15 . An analogous pattern holds for any even m.
   Hence the left cells are
   {10 }, {21 , 12 , 23 , 14 , . . . }, {11 }, {22 , 13 , 24 , 15 , . . . },
if m = ∞,
24                                            G. LUSZTIG

   {10 }, {21 , 12 , 23 , . . . , 1m−2 }, {2m−1 }, {11 }, {22 , 13 , 24 , . . . , 1m−1 }, {2m },
if m < ∞.
   The two-sided cells are
   {10 }, {11 }, W − {10 , 11 }, if m = ∞ and
   {10 }, {11 }, {2m−1 }, {2m }, W − {10 , 11 , 2m−1 , 2m }, if m < ∞.

                           9. Cosets of parabolic subgroups
Lemma 9.1. Assume that w = s1 s2 . . . sq with si ∈ S. We can find a subsequence
i1 < i2 < · · · < ir of 1, 2, . . . , r such that w = si1 si2 . . . sir is a reduced expression.
    We argue by induction on q. If q = 0 the result is obvious. Assume that q > 0.
Using the induction hypothesis we can assume that s2 . . . sq is a reduced expression.
If s1 s2 . . . sq is a reduced expression, we are done. Hence we may assume that
s1 s2 . . . sq is not a reduced expression. Then l(w) = q − 1. By 1.7, we can ﬁnd
j ∈ [2, q] such that s1 s2 . . . sj−1 = s2 s3 . . . sj . Then w = s2 s3 . . . sj−1 sj+1 . . . sq is
a reduced expression. The lemma is proved.
9.2. Let w ∈ W . Let w = s1 s2 . . . sq be a reduced expression of w. Using 1.9, we
see that the set {s ∈ S|s = si for some i ∈ [1, q]} is independent of the choice of
reduced expression. We denote it by Sw .
9.3. In the remainder of this section we ﬁx I ⊂ S. Let WI be the subgroup of W
generated by I.
   If w ∈ WI then we can ﬁnd a reduced expression w = s1 s2 . . . sq in W with
all si ∈ I (we ﬁrst write w = s1 s2 . . . sq a not necessarily reduced expression with
all si ∈ I and then we apply 9.1). Thus, Sw ⊂ I. Conversely, it is clear that if
w′ ∈ W satisﬁes Sw′ ⊂ I then w′ ∈ WI . It follows that
   WI = {w ∈ W |Sw ⊂ I}.
9.4. Replacing S, (ms,s′ )(s,s′ )∈S×S by I, (ms,s′ )(s,s′ )∈I×I in the deﬁnition of W
we obtain a Coxeter group denoted by WI∗ . We have an obvious homomorphism
f : WI∗ −
        → WI which takes s to s for s ∈ I.
Proposition 9.5. f : WI∗ −
                         → WI is an isomorphism.
    We deﬁne f ′ : WI −        → WI∗ as follows: for w ∈ WI we choose a reduced expression
w = s1 s2 . . . sq in W ; then si ∈ I for all i (see 9.3) and we set f ′ (w) = s1 s2 . . . sq
(product in WI∗ ). This map is well deﬁned. Indeed, if s′1 s′2 . . . s′q is another re-
duced expression for w with all si ∈ I, then we can pass from (s1 , s2 , . . . , sq ) to
(s′1 , s′2 , . . . , s′q ) by moving along edges of the graph X (see 1.9); but each edge
involved in this move will necessarily involve only pairs (s, s′ ) in I, hence the
equation s1 s2 . . . sq = s′1 s′2 . . . s′q must hold in WI∗ . It is clear that f f ′ (w) = w for
all w ∈ WI . Hence f ′ is injective.
    We show that f ′ is a group homomorphism. It suﬃces to show that f ′ (sw) =
f (s)f ′ (w) for any w ∈ WI , s ∈ I. This is clear if l(sw) = l(w) + 1 (in W ). Assume
  ′

now that l(sw) = l(w) − 1 (in W ). Let w = s1 s2 . . . sr be a reduced expression in
          LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                          25

W . Then si ∈ I for all i. By 1.7 we have (in W ) sw = s1 s2 . . . si−1 si+1 . . . sq for
some i ∈ [1, q]. Since ss1 s2 . . . si−1 si+1 . . . sq is a reduced expression for w in W ,
we have f ′ (w) = ss1 s2 . . . si−1 si+1 . . . sq (product in WI∗ ). We also have f ′ (w) =
s1 s2 . . . sq (product in WI∗ ). Hence ss1 s2 . . . si−1 si+1 . . . sq = s1 s2 . . . sq (in WI∗ ).
Hence s1 s2 . . . si−1 si+1 . . . sq = ss1 s2 . . . sq (in WI∗ ). Hence f ′ (sw) = f ′ (s)f ′ (w),
as required.
    Since the image of f ′ contains the generators s ∈ I of WI∗ and f ′ is a group
homomorphism, it follows that f ′ is surjective. Hence f ′ is bijective. Since f f ′ = 1
it follows that f is bijective. The proposition is proved.
9.6. We identify WI∗ and WI via f . Thus, WI is naturally a Coxeter group. Let
lI : WI − → N be the length function of this Coxeter group. Let w ∈ WI . Let
w = s1 s2 . . . sq be a reduced expression of w (in W ). Then si ∈ I for all i (see
9.3). Hence lI (w) ≤ l(w). The reverse inequality l(w) ≤ lI (w) is obvious. Hence
lI (w) = l(w).
    From 2.4 we see that the partial order on WI deﬁned in the same way as ≤ on
W is just the restriction of ≤ from W to WI .
Lemma 9.7. Let WI a be a coset in W .
  (a) This coset has a unique element w of minimal length.
  (b) If y ∈ WI then l(yw) = l(y) + l(w).
  (c) w is characterized by the property that l(sw) > l(w) for all s ∈ I.
     Let w be an element of minimal length in the coset. Let w = s1 s2 . . . sq be a
reduced expression. Let y ∈ WI and let y = s′1 s′2 . . . s′p be a reduced expression in
WI . Then yw = s′1 s′2 . . . s′p s1 s2 . . . sq . By 9.1 we can drop some of the factors in
the last product so that we are left with a reduced expression for yw. The factors
dropped cannot contain any among the last q since we would ﬁnd an element in
WI a of strictly smaller length than w. Thus, we can ﬁnd a subsequence i1 < i2 <
· · · < ir of 1, 2, . . . , p such that yw = s′i1 s′i2 . . . s′ir s1 s2 . . . sq is a reduced expression.
It follows that y = s′1 s′2 . . . s′p = s′i1 s′i2 . . . s′ir . Since p = l(y), we must have r = p
so that s′1 s′2 . . . s′p s1 s2 . . . sq is a reduced expression and l(yw) = p+q = l(y)+l(w).
     If now w′ is another element of minimal length in WI a then w′ = yw for some
y ∈ WI . We have l(w) = l(w′ ) = l(y) + l(w) hence l(y) = 0 hence y = 1 and
w′ = w. This proves (a). Now (b) is already proved. Note that by (b), w has the
property in (c). Conversely, let w′ ∈ aWI be an element such that l(sw′ ) > l(w′ )
for all s ∈ I. We have w′ = yw for some y ∈ WI . If y 6= 1 then for some s ∈ I we
have l(y) = l(sy) + 1. By (b) we have l(w′ ) = l(y) + l(w), l(sw′ ) = l(sy) + l(w).
Thus l(w′ ) − l(sw′ ) = l(y) − l(sy) = 1, a contradiction. Thus y = 1 and w′ = w.
The lemma is proved.
Lemma 9.8. Let WI a be a coset in W .
   (a) If WI is finite, this coset has a unique element w of maximal length. If WI
is infinite, this coset has no element of maximal length.
   (b) Assume that WI is finite. If y ∈ WI then l(yw) = l(w) − l(y).
26                                            G. LUSZTIG

   (c) Assume that WI is finite. Then w is characterized by the property that
l(sw) < l(w) for all s ∈ I.
    Assume that w has maximal length in WI a. We show that for any y ∈ WI we
have
    (d) l(yw) = l(w) − l(y).
We argue by induction on l(y). If l(y) = 0, the result is clear. Assume now that
l(y) = p + 1 ≥ 1. Let y = s1 . . . sp sp+1 be a reduced expression. By the induction
hypothesis, l(w) = l(s1 s2 . . . sp w) + p. Hence we can ﬁnd a reduced expression of
w of the form sp . . . s2 s1 s′1 s′2 . . . s′q . Since sp+1 ∈ I, by our assumption on w we
have l(sp+1 w) = l(w) − 1. Using 1.7, we deduce that either
    (1) sp+1 sp . . . sj+1 = sp . . . sj+1 sj for some j ∈ [1, p] or
    (2) sp+1 sp . . . s2 s1 s′1 s′2 . . . s′i+1 = sp . . . s2 s1 s′1 s′2 . . . s′i+1 s′i for some i ∈ [1, q].
In case (1) it follows that y = s1 . . . sp sp+1 = s1 s2 . . . sj−1 sj+1 . . . sp
contradicting l(y) = p + 1. Thus, we must be in case (2). We have
    yw = s′1 s′2 . . . s′i−1 s′i+1 . . . s′q and l(yw) ≤ q − 1 = l(w) − p − 1 = l(w) − l(y).
Thus, l(w) ≥ l(yw) + l(y). The reverse inequality is obvious. Hence l(w) =
l(yw) + l(y). This completes the induction.
    From (d) we see that l(y) ≤ l(w). Thus l : WI −                       → N is bounded above. Hence
there exists y ∈ WI of maximal length in WI . Applying (d) to y, WI instead of
w, WI a we see that
    l(y) = l(y ′−1 ) + l(y ′−1 y) = l(y ′ ) + l(y ′−1 y)
for any y ′ ∈ WI . Hence a reduced expression of y ′ followed by a reduced expression
of y ′−1 y gives a reduced expression of y. In particular y ′ ≤ y. Since the set
{y ′ ∈ W |y ′ ≤ y} is ﬁnite, we see that WI is ﬁnite. Conversely, if WI is ﬁnite then
WI a clearly has some element of maximal length.
    If w′ is another element of maximal length in aWI then w′ = yw for some
y ∈ WI . We have l(w) = l(w′ ) = l(w) − l(y) hence l(y) = 0 hence y = 1 and
w′ = w. This proves (a) and (b). The proof of (c) is entirely similar to that of
9.7(c). The lemma is proved.
9.9. Replacing W, L by WI , L|WI in the deﬁnition of H we obtain an A-algebra HI
(naturally a subalgebra of H); instead of rx,y , px,y , cy , µsx,y we obtain for x, y ∈ WI
           I
elements rx,y ∈ A, pIx,y ∈ A≤0 , cIy ∈ HI , µs,I
                                             x,y ∈ A.

Lemma 9.10. Let z ∈ W be such that z is the element of minimal length of WI z.
Let x, y ∈ WI . We have
   (a) {u′ ∈ W |xz ≤ u′ ≤ yz} = {u ∈ WI |x ≤ u ≤ y}z;
                  I
   (b) rxz,yz = rx,y ;
                  I
   (c) pxz,yz = px,y ;
   (d) cIy = cy .
   (e) If in addition, s ∈ I and sx < x < y < sy, then sxz < xz < yz < syz and
µx,y = µsxz,yz .
 s,I


     We ﬁrst prove the following statement.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                27

    Assume that z1 , z2 have minimal length in WI z1 , WI z2 respectively, that u1 , u2 ∈
WI and that u1 z1 ≤ u2 z2 . Then
    (f ) z1 ≤ z2 ; if in addition, z1 = z2 then u1 ≤ u2 .
Indeed, using 2.4 we see that there exist u′1 , z1′ such that
    u1 z1 = u′1 z1′ , u′1 ≤ u2 , z1′ ≤ z2 .
Then u′1 ∈ WI and z1′ ∈ WI z1 hence z1′ = wz1 where w ∈ WI , l(z1′ ) = l(w) + l(z1 ).
Hence z1 ≤ z1′ . Since z1′ ≤ z2 , we see that z1 ≤ z2 . If we know that z1 = z2 , then
z1′ = z1 hence u1 = u′1 . Since u′1 ≤ u2 , it follows that u1 ≤ u2 and (f) is proved.
    We prove (a). If u ∈ WI and x ≤ u ≤ y, then xz ≤ uz ≤ yz by 2.4 and 9.7(b).
Conversely, assume that u′ ∈ W satisﬁes xz ≤ u′ ≤ yz. Then u′ = uz1 where
z1 has minimal length in WI u′ and u ∈ WI . Applying (f) to xz ≤ uz1 and to
uz1 ≤ yz we deduce z ≤ z1 ≤ z. Hence z = z1 . Applying the second part of (f) to
xz ≤ uz and to uz ≤ yz we deduce x ≤ u ≤ y. This proves (a).
                                                                                I
    We prove (b) by induction on l(y). Assume ﬁrst that y = 1. Then rx,y          = δx,1 .
Now rxz,z = 0 unless xz ≤ z (see 4.7(a)) in which case x = 1 and rz,z = 1. Thus,
(b) holds for y = 1. Assume now that l(y) ≥ 1. We can ﬁnd s ∈ I such that
l(sy) = l(y) − 1. We have
    l(syz) = l(sy) + l(z) = l(y) − 1 + l(z) = l(yz) − 1.
If sx < x then we have (as in the previous line) sxz < xz. Using 4.4 and the
induction hypothesis, we have
                              I          I
    rxz,yz = rsxz,syz = rsx,sy       = rx,y .
If sx > x then we have (as above) sxz > xz. Using 4.4 and the induction hypoth-
esis, we have
    rxz,yz = rsxz,syz + (vs − vs−1 )rxz,syz = rsx,sy
                                                I
                                                     + (vs − vs−1 )rx,sy
                                                                    I       I
                                                                         = rx,y .
This completes the proof of (b).
    We prove (c). Using (a), we may assume that x ≤ y (otherwise, both sides are
zero.) We argue by induction on l(y) − l(x) ≥ 0. If y = x, the result is clear (both
sides are 1). Assume now that l(y) − l(x) ≥ 1. Using 5.3, then (a),(b) and the
induction hypothesis, we have
                             X                                 X
             p̄xz,yz =                   rxz,u′ pu′ ,yz =                 rxz,uz puz,yz
                         u′ ;xz≤u′ ≤yz                      u∈WI ;x≤u≤y
                     X                                 X
                                 I                                I
              =                 rx,u puz,yz =                    rx,u pIu,y + pxz,yz .
                  u∈WI ;x≤u≤y                     u∈WI ;x<u≤y


Using 5.3 for WI we have p̄Ix,y = y;x≤u≤y rx,u      I
                                                       pIu,y . Comparing with the previous
                                       P
equality we deduce
  p̄xz,yz − p̄Ix,y = pxz,yz − pIx,y .
The right hand side of this equality is in A<0 . Since it is ﬁxed by ¯, it must be 0.
This proves (c). Now (d) is an immediate consequence of (c) (with z = 1).
  We
  P prove (e). By 6.3(ii) wes have
     u′ ;xz≤u′ <yz;su′ <u′ pxz,u µu′ ,yz − vs pxz,yz ∈ A<0 .
                                ′

We rewrite this using (a):
28                                     G. LUSZTIG

                         pxz,uz µsuz,yz − vs pxz,yz ∈ A<0 .
     P
     u∈WI ;x≤u<y;su<u
We may assume that for all u in the sum, other than u = x we have µsuz,yz = µs,I u,y .
Using this and
             P (d), we obtain I s,I
   µxz,yz + u∈WI ;x<u<y;su<u px,u µu,y − vs pIx,y ∈ A<0 .
     s

By 6.3(ii)P for WI we have
     s,I
   µx,y + u∈WI ;x<u<y;su<u pIx,u µs,I             I
                                        u,y − vs px,y ∈ A<0 .
It follows that µsxz,yz − µs,I                                s      s,I
                            x,y ∈ A<0 . On the other hand, µxz,yz − µx,y is ﬁxed by¯
(see 6.3(ii)) hence it is 0. This proves (e). The lemma is proved.
Proposition 9.11. Assume that L(s) > 0 for all s ∈ I.
  (a) Let z ∈ W be such that z is the element of minimal length of WI z. If x, y in
WI satisfy x ≤L y (relative to WI ), then xz ≤L yz (in W ). If x, y in WI satisfy
x ∼L y (relative to WI ), then xz ∼L yz (in W ).
  (b) Let z ∈ W be such that z is the element of minimal length of zWI . If x, y in
WI satisfy x ≤R y (relative to WI ), then zx ≤R zy (in W ). If x, y in WI satisfy
x ∼R y (relative to WI ), then zx ∼R zy (in W ).
   We prove the ﬁrst assertion of (a). We may assume that x ←L y (relative to
WI ) and x 6= y. Thus, there exists s ∈ I such that sy > y, sx < x and we have
either x = sy or x < y and µsx,y 6= 0. If x = sy, then sxz < xz = syz > yz, hence
xz ←L yz (in W ). Thus, we may assume that x < y and µsx,y 6= 0. By 9.10(e) we
then have µsxz,yz 6= 0, hence xz ←L yz (in W ). The ﬁrst assertion of (a) is proved.
The second assertion of (a) follows from the ﬁrst. (b) follows by applying (a) to
z −1 , x−1 , y −1 instead of z, x, y.
9.12. Assume that z ∈ W is such that WI z = zWI and z is the element of minimal
length of WI z = zWI . Then y 7→ z −1 yz is an automorphism of WI . If s ∈ I then,
by 9.7, we have l(sz) = l(s) + l(z) = 1 + l(z); by 9.7 applied to WI z −1 instead of
WI z we have l((z −1 sz)z −1 ) = l(z −1 sz) +l(z −1 ) hence l(z −1 s) = l(z −1 sz) +l(z −1 );
since l(z −1 s) = l(sz) and l(z −1 ) = l(z), it follows that l(z −1 sz) +l(z −1 ) = 1 +l(z),
hence l(z −1 sz) = 1. We see that y 7→ z −1 yz maps I onto itself hence it is
an automorphism of WI as a Coxeter group. This automorphism preserves the
function L|WI . Indeed, if y ∈ WI , then
   l(zyz −1 )+l(z) = l((zyz −1 )z) = l(zy) = l(y −1 z −1 ) = l(y −1 )+l(z −1 ) = l(y)+l(z)
(by 9.7 applied to WI z and to WI z −1 ) hence
               L(zyz −1 ) + L(z) = L((zyz −1 )z) = L(zy) = L(y −1 z −1 )
                = L(y −1 ) + L(z −1 ) = L(y) + L(z),
so that L(zyz −1 ) = L(z). In particular, this automorphism respects the preorders
≤L , ≤R , ≤LR of WI (deﬁned in terms of L|WI ) and the associated equivalence
relations.
Proposition 9.13. Assume that L(s) > 0 for all s ∈ I. Let z be as in 9.12. If
x, y in WI satisfy x ≤LR y (relative to WI ), then xz ≤LR yz (in W ). If x, y in
WI satisfy x ∼LR y (relative to WI ), then xz ∼LR yz (in W ).
       LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                        29

   We prove the ﬁrst assertion. We may assume that either x ≤L y (in WI ) or
x ≤R y (in WI ). In the ﬁrst case then, by 9.11(a), we have xz ≤L yz (in W )
hence xz ≤LR yz (in W ). In the second case, by 9.12, we have z −1 xz ≤R z −1 yz.
Applying 9.11(b) to z −1 xz, z −1 yz instead of x, y we see that xz ≤R yz (in W )
hence xz ≤LR yz (in W ). This proves the ﬁrst assertion. The second assertion
follows from the ﬁrst.

                                 10. Inversion
                                    ′
10.1. ForP y, w ∈ W we deﬁne qy,w       ∈ A by
    ′            n
   qy,w = (−1) pz0 ,z1 pz1 ,z2 . . . pzn−1 ,zn
(sum over all sequences y = z0 < z1 < z2 < · · · < zn = w in W ) and
                         ′
   qy,w = sgn(y)sgn(w)qy,w  .
We have
   qw,w = 1,
   qy,w ∈ A<0 if y 6= w,
   qy,w = 0 unless y ≤ w.

         P 10.2. For any y, w ∈ W we have
Proposition
  q̄y,w = z;y≤z≤w qy,z rz,w .
   The (triangular) matrices Q′ = (qy,w
                                     ′
                                        ), P = (py,w ), R = (ry,w ) are related by
         ′          ′
   (a) Q P = P Q = 1, P̄ = RP , R̄R = RR̄ = 1
where¯over a matrix is the matrix obtained by applying¯to each entry. (Although
the matrices may be inﬁnite, the products are well deﬁned as each entry of a
product is obtained by ﬁnitely many operations.) The last three equations in (a)
are obtained from 5.3, 4.6; the equations involving Q′ follow from the deﬁnition.
From (a) we deduce
   Q′ P = 1 = Q̄′ P̄ = Q̄′ RP .
Hence Q′ P = Q̄′ RP . Multiplying on the right by Q′ and using P Q′ = 1 we deduce
Q′ = Q̄′ R. Multiplying on the right by R̄ we deduce
   (b) Q̄′ = Q′ R̄.
Let s be the matrix whose y, w entry is sgn(y)δy,w . We have s2 = 1. Let Q be the
triangular matrix (qy,w ). Note that Q = sQ′ s. By 4.5 we have R̄ = sRs. Hence
by multiplying the two sides of (b) on the left and right by s we obtain Q̄ = QR.
The proposition is proved.
10.3. Let τ : H −
                → A be the A-linear map deﬁned by τ (Tw ) = δw,1 for w ∈ W .
Lemma 10.4. (a) For x, y ∈ W we have τ (Tx Ty ) = δxy,1 .
  (b) For h, h′ ∈ H we have τ (hh′ ) = τ (h′ h).
  (c) Let x, y, z ∈ W and let M = min(L(x), L(y), L(z)). We have τ (Tx Ty Tz ) ∈
v Z[v −1 ].
 M


  We prove (a) by induction on l(y). If l(y) = 0, the result is clear. Assume
now that l(y) ≥ 1. If l(xy) = l(x) + l(y) then Tx Ty = Txy and the result is clear.
30                                            G. LUSZTIG

Hence we may assume that l(xy) 6= l(x) + l(y). Then l(xy) < l(x) + l(y). Let
y = s1 s2 . . . sq be a reduced expression. We can ﬁnd i ∈ [1, q] such that
    (d) l(x) + i − 1 = l(xs1 s2 . . . si−1 ) > l(xs1 s2 . . . si−1 si ).
We show that
    (e) xs1 s2 . . . si−1 si+1 . . . sq 6= 1.
If (e) does not hold, then x = sq . . . si+1 si−1 . . . s1 , so that
    l(xs1 s2 . . . si−1 ) = l(sq . . . si+1 si−1 . . . s1 s1 ...si−1 ) = l(sq . . . si+1 ) = q − i,
    l(xs1 s2 . . . si−1 si ) = l(sq . . . si+1 si−1 . . . s1 s1 ...si ) = l(sq . . . si+1 si ) = q − i + 1,
contradicting (d). Thus (e) holds. We have
           τ (Tx Ty ) = τ (Tx Ts1 Ts2 . . . Tsq ) = τ (Txs1 s2 ...si−1 Tsi Tsi+1 ...sq )
            = τ (Txs1 s2 ...si−1 si Tsi+1 ...sq ) + (vs − vs−1 )τ (Txs1 s2 ...si−1 Tsi+1 ...sq ).
Using the induction hypothesis and (d) we see that this equals
   δxs1 s2 ...si−1 si si+1 ...sq ,1 + (vs − vs−1 )δxs1 s2 ...si−1 si+1 ...sq ,1 = δxy,1 .
This completes the proof of (a). To prove (b), we may assume that h = Tx , h′ = Ty
for x, y ∈ W ; we then use (a) and the obvious equality δxy,1 = δyx,1 .
   We prove (c). Using b) we see that τ (Tx Ty Tz ) = τ (Ty Tz Tx ) = τ (Tz Tx Ty ).
Hence it is enough to show that, for any x, y, z we have
   τ (Tx Ty Tz ) ∈ v L(x) Z[v −1 ].
We argue by induction on l(x). If x = 1, the result follows from (a). Assume
now that l(x) ≥ 1. We can ﬁnd s ∈ S such that xs < x. If sy > y, then by the
induction hypothesis,
   τ (Tx Ty Tz ) = τ (Txs Tsy Tz ) ∈ v L(x)−L(s) Z[v −1 ] ⊂ v L(x) Z[v −1 ].
If sy < y, then by the induction hypothesis,
                τ (Tx Ty Tz ) = τ (Txs Tsy Tz ) + (vs − vs−1 )τ (Txs Ty Tz )
                 ∈ v L(x)−L(s) Z[v −1 ] + vs v L(x)−L(s) Z[v −1 ] ⊂ v L(x) Z[v −1 ].
The lemma is proved.
10.5. Let H′ = HomA (H, A). We regard H′ as a left H-module where, for h ∈
H, φ ∈ H′ we have (hφ)(h1 ) = φ(h1 h) for all h1 ∈ H and as a right H-module
where, for h ∈ H, φ ∈ H′ , we have (φh)(h1 ) = φ(hh1 ) for all h1 ∈ H.
10.6. We sometimes identify H′ with the set of all P
                                                                  P
                                                   formal sums x∈W ax Tx with
ax ∈ A; to φ ∈ H′ corresponds the formal sum          x∈W φ(Tx−1 )Tx . Since H is
contained in the set of such formal sums (it is the set of sums such that cx = 0
for all but ﬁnitely many x), we see that H is naturally a subset of H′ . Using
10.4(a) we see that the imbedding H ⊂ H′ is an imbedding of H-bimodules; it is
an equality if W is ﬁnite.
10.7. Let z ∈ W . Recall that in 8.1 we have deﬁned Dz ∈ H′ by Dz (cw ) = δz,w
for all w. An equivalent deﬁnition is
                    ′
   (a) Dz (Ty ) = qz,y
for all y ∈ W P. Indeed, assuming that (a) holds, we have
                    ′
   Dz (cw ) = y qz,y   py,w = δz,w .
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                 31

Proposition 10.8. Let z ∈ W, s ∈ S. Assume that L(s)
                                                  P > 0.
                                     −1
  (a) If zs < z, then cs Dz = (vs + vs )Dz + Dzs + u;z<u<us µsz−1 ,u−1 Du .
  (b) If zs > z, then cs Dz = 0.
  For a, b ∈ W we deﬁne δa<b to be 1 if a < b and 0 otherwise. Let w ∈ W . If
ws > w, then by 6.7(a), we have
                                                     X
             (cs Dz )(cw ) = Dz (cw cs ) = Dz (cws +   µsx−1 ,w−1 cx )
                                                          x
                                                       xs<x<w
                            X
(c)           = δz,ws +            µsx−1 ,w−1 δz,x .
                             x
                          xs<x<w

If ws < w, then by 6.7(b), we have

(d)       (cs Dz )(cw ) = Dz (cw cs ) = (vs + vs−1 )Dz (cw ) = (vs + vs−1 )δz,w .

If zs < z, ws > w, then by (c):
                                                                   X
(cs Dz )(cw ) = δzs,w +δz<w µsz−1 ,w−1 = ((vs +vs−1 )Dz +Dzs +            µsz−1 ,u−1 Du )(cw ).
                                                                   u
                                                                 z<u<us

If zs < z, ws < w, then by (d):
                                                                 X
 (cs Dz )(cw ) = (vs + vs−1 )δz,w = ((vs + vs−1 )Dz + Dzs +             µsz−1 ,u−1 Du )(cw ).
                                                                 u
                                                               z<u<us

If zs > z, ws > w, then by (c), we have (cs Dz )(cw ) = 0. If zs > z, ws < w, then
by (d), we have (cs Dz )(cw ) = 0. Since (cw ) is an A-basis of H, the proposition
follows.

                  11. The longest element for a finite W
11.1. Let I ⊂ S be such that WI is ﬁnite. By 9.8, there is a unique element of
maximal length of WI . We denote it by w0I . If w1 has minimal length in WI a then
w0I w1 has maximal length in WI a.
11.2. In the remainder of this section we assume that W is ﬁnite. Then w0S , the
unique element of maximal length of W is well deﬁned. Traditionally one writes
w0 instead of w0S . Since l(w0−1 ) = l(w0 ), we must have
   w0−1 = w0 .
By the argument in the proof of 9.8 we have w ≤ w0 for any w ∈ W . By 9.8 we
have
   (a) l(ww0 ) = l(w0 ) − l(w)
for any w ∈ W . Applying this to w−1 and using the equalities l(w−1 w0 ) =
l(w0−1 w) = l(w0 w), l(w−1 ) = l(w), we deduce that
32                                   G. LUSZTIG

   (b) l(w0 w) = l(w0 ) − l(w).
We can rewrite (a),(b) as
   l(w0 ) = l(w−1 ) + l(ww0 ), l(w0 ) = l(w0 w) + l(w−1 ).
Using this and the deﬁnition of L we deduce that
   L(w−1 ) + L(ww0 ) = L(w0 ) = L(w0 w) + L(w−1 ),
hence L(ww0 ) = L(w0 w). This implies L(w0 ww0 ) = L(w) for all w. Replacing
L by l we deduce that l(w0 ww0 ) = l(w). Thus, the (involutive) automorphism
w 7→ w0 ww0 of W maps S into itself hence is a Coxeter group automorphism
preserving the function L.
Lemma 11.3. Let y, w ∈ W . We have
  (a) y ≤ w ⇔ w0 w ≤ w0 y ⇔ ww0 ≤ yw0 .
  (b) ry,w = rww0 ,yw0 = rw0 w,w0 y ;
                  P
  (c) p̄ww0 ,yw0 = z;y≤z≤w pzw0 ,yw0 rz,w .

   We prove (a). To prove that y ≤ w =⇒ w0 w ≤ w0 y, we may assume that
l(w) − l(y) = 1, yw−1 ∈ T . Then
   l(yw0 ) − l(ww0 ) = l(w0 ) − l(y) − (l(w0 ) − l(w)) = l(w) − l(y) = 1
and (ww0 )(yw0 )−1 = wy −1 ∈ T . Hence w0 w ≤ w0 y. The opposite implication
is proved in the same way. The second equivalence in (a) follows from the last
sentence in 11.2.
   We prove the ﬁrst equality in (b) by induction on l(w). If l(w) = 0 then w = 1.
We have ry,1 = δy,1 . Now rw0 ,w0 y is zero unless w0 ≤ w0 y (see 4.7). On the
other hand we have w0 y ≤ w0 (see 11.2). Hence rw0 ,w0 y is zero unless w0 y = w0 ,
that is unless y = 1 in which case it is 1. Thus the desired equality holds when
l(w) = 0. Assume now that l(w) ≥ 1. We can ﬁnd s ∈ S such that sw < w. Then
sww0 > ww0 by (a).
   Assume ﬁrst that sy < y (hence syw0 > yw0 .) Using 4.4 and the induction
hypothesis we have
   ry,w = rsy,sw = rsww0 ,syw0 = rww0 ,yw0 .
Assume next that sy > y (hence syw0 < yw0 .) Using 4.4 and the induction
hypothesis we have

       ry,w = rsy,sw + (vs − vs−1 )ry,sw = rsww0 ,syw0 + (vs − vs−1 )rsww0 ,yw0
        = rsww0 ,syw0 + (vs − vs−1 )rww0 ,syw0 = rww0 ,yw0 .

This proves the ﬁrst equality in (b). The second equality in (b) follows from the
last sentence in 11.2.
   We prove (c). We may assume that y ≤ w. By 5.3 (for ww0 , yw0 instead of
y, w we have
               P
   p̄ww0 ,yw0 = z;y≤z≤w rww0 ,zw0 pzw0 ,yw0
(we have used (a)). Here we substitute rww0 ,zw0 = rz,w (see (b)) and the result
follows. The lemma is proved.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                           33

Proposition 11.4. For any y, w ∈ W we have qy,w = pww0 ,yw0 = pw0 w,w0 y .
   The second equality follows from the last sentence in 11.2. We prove the ﬁrst
equality. We may assume that y ≤ w. We argue by induction on l(w) − l(y) ≥
0. If l(w) − l(y) = 0 we have y = w and both sides are 1. Assume now that
l(w) − l(y) ≥ 1. Substracting the identity in 11.3(c) from that in 10.2 and using
the induction hypothesis, we obtain
   q̄y,w − p̄ww0 ,yw0 = qy,w − pww0 ,yw0 .
The right hand side is in A<0 ; since it is ﬁxed by ¯, it is 0. The proposition is
proved.
Proposition 11.5. We identify H = H′ as in 10.6. If z ∈ W , then Dz−1 ∈ H′
(see 10.7) becomes an element of H. We have
   Dz−1 Tw−1
           0
             = sgn(zw0 )c†zw0 , († as in 3.5).
   By deﬁnition, Dz−1 ∈ H is characterized by
   τ (Dz−1 Ty−1 ) = qz′ −1 ,y−1
for all y ∈ W . Here τ is as in 10.3. Hence, by 10.4(a), we have Dz−1 =
      ′
P
   y qz −1 ,y −1P
                Ty . Using 11.4, we deduce
   Dz−1 = y sgn(yz)pw0 y−1 ,w0 z−1 Ty .
Multiplying on the right by Tw−1    0
                                      gives
   Dz−1 Tw0 = y sgn(yz)pw0 y−1 ,w0 z−1 Tw−1
             −1
                    P
                                                  −1
                                               0y
since Tw0 y−1 Ty = Tw0 . On the other hand,
                        X                            X
   sgn(zw0 )c†zw0 =        sgn(zw0 x)px,zw0 Tx−1
                                               −1  =   sgn(zw0 yw0 )pyw0 ,zw0 Tw−1
                                                                                 0y
                                                                                    −1 .

                     x                             y
We now use the identity pyw0 ,zw0 = pw0 y−1 ,w0 z−1 . The proposition follows.
Proposition 11.6. Let u, z ∈ W, s ∈ S be such that sz < z < u < su. Assume
that L(s) > 0. Then suw0 < uw0 < zw0 < szw0 and
   µsuw0 ,zw0 = −sgn(uz)µsz,u .
  Let z ∈ W, s ∈ S be such that sz < z. Using  P 10.8(a), we see that
                −1
  (cs − (vs + vs ))Dz−1 Tw0 = Dz−1 s Tw0 + u;z−1 <u−1 <u−1 s µsz,u Du−1 Tw−1
                           −1            −1
                                                                              0
                                                                                ,
hence, using 11.5, we have
                                                         X
 (cs − (vs + vs−1 ))sgn(zw0 )c†zw0 = sgn(zsw0 )c†szw0 +        µsz,u sgn(uw0 )c†uw0 .
                                                        u;z<u<su

Applying † to both sides and                        −1 †
                             P using (cs −s (vs + vs )) = −cs gives
   (a) −cs czw0 = −cszw0 + u;z<u<su µz,u sgn(uz)cuw0 .
Since szw0 > zw0 , weP can apply 6.6(a)     and we get
                                       s
   cs czw0 = cszw0 + u′ ;su′ <u′ <zw0 µu′ ,zw0 cu′
or equivalently
   cs czw0 = cszw0 + u;z<u<su µsuw0 ,zw0 cuw0 .
                     P

Comparing    this with (a) we get
   − u;z<u<su µsz,u sgn(uz)cuw0 = u;z<u<su µsuw0 ,zw0 cuw0 ;
      P                               P
the proposition follows.
34                                   G. LUSZTIG

Corollary 11.7. Assume that L(s) > 0 for all s ∈ S. Let y, w ∈ W .
   (a) y ≤L w ⇔ ww0 ≤L yw0 ⇔ w0 w ≤L w0 y;
   (b) y ≤R w ⇔ ww0 ≤R yw0 ⇔ w0 w ≤R w0 y;
   (c) y ≤LR w ⇔ ww0 ≤LR yw0 ⇔ w0 w ≤LR w0 y.
   (d) Left multiplication by w0 carries left cells to left cells, right cells to right
cells, two-sided cells to two-sided cells. The same holds for right multiplication by
w0 .
   We prove the ﬁrst equivalence in (a). It is enough to show that y ≤L w =⇒
ww0 ≤L yw0 . We may assume that y ←L w and y 6= w. Then there exists s ∈ S
such that sw > w, sy < y and Dy (cs cw ) 6= 0. We have syw0 > yw0 , sww0 < ww0 .
From 6.6 we see that either y = ws or y < w and µsy,w 6= 0. In the ﬁrst case
we have ww0 = syw0 ; in the second case we have ww0 < yw0 and µsww0 ,yw0 6= 0
(see 11.6). In both cases, 6.6 shows that Dww0 (cs cyw0 ) 6= 0. Hence ww0 ≤L yw0 .
Thus, the ﬁrst equivalence in (a) is established. The second equivalence in (a)
follows from the last sentence in 11.2.
   Now (b) follows by applying (a) to y −1 , w−1 instead of (a); (c) follows from (a)
and (b); (d) follows from (a),(b),(c). The corollary is proved.

                         12. Examples of elements Dw
Proposition 12.1. Assume that L(s) > 0 for all s ∈ S. For any y ∈ W we have
D1 (Ty ) = sgn(y)v −L(y) . Equivalently, with the identification in 10.6, we have
  D1 = y∈W sgn(y)v −L(y) Ty .
          P

                                         ′
   An equivalent statement
                   P ′         is that q1,y = sgn(y)v −L(y) . Since q1,y
                                                                     ′
                                                                         are determined
by the equations y q1,y py,w = δ1,w (see 10.2(a)) it is enough to show that
                −L(y)
   P
      y sgn(y)v       py,w = δ1,w
for all w ∈ W . If w = 1 this is clear. Assume now that w 6= 1. We can ﬁnd s ∈ S
such
   Pthat sw < w. −L(y)We must prove that
      y;y<sy sgn(y)v       (py,w − vs−1 psy,w ) = 0.
Each term of the last sum is 0, by 6.6(c). The proposition is proved.
Corollary        Assume that W is finite and that L(s) > 0 for all s ∈ S. Then
        P 12.2. −L(yw 0)
  cw0 = y∈W v            Ty .
    This follows immediately from 12.1 and 11.5. Alternatively, we can argue as
follows. We prove that py,w0 = v −L(yw0 ) for all y, by descending induction on l(y).
If l(y) is maximal, that is y = w0 , then py,w0 = 1. Assume now that l(y) < l(w0 ).
We can ﬁnd s ∈ S such that l(sy) = l(y) + 1. By the induction hypothesis we have
psy,w0 = v −L(syw0 ) . By 6.6(c), we have

py,w0
 = vs−1 psy,w0 = v −L(s)−L(syw0 ) = v −L(s)−L(w0 )+L(sy) = v −L(w0 )+L(y) = v −L(yw0 ) .

The corollary is proved.
          LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                               35

12.3. From 11.5 we see that Dz−1 can be explicitly computed whenever W is
ﬁnite and czw0 is known. In particular, in the setup of 7.4 with m = 2k + 2 < ∞,
we can compute explicitly all Dz−1 using 7.6(a). For example:
                X
      Ds1 =            (1 − v 2L1 + v 4L1 − · · · + (−1)s v 2sL1 )v −sL1 −sL2
              s∈[0,k−1]

      × (T12s+1 − v −L2 T22s+2 − v −L2 T12s+2 + v −2L2 T22s+3 )
      + (1 − v 2L1 + v 4L1 − · · · + (−1)k v 2kL1 )v −kL1 −kL2 (T12k+1 − v −L2 T22k+2 ).

Using this (for larger and larger m) one can deduce that an analogous formula
holds in the setup of 7.4 with m = ∞:
                      X
              Ds1 =    (1 − v 2L1 + v 4L1 − · · · + (−1)s v 2sL1 )v −sL1 −sL2
                      s≥0

(a)           × (T12s+1 − v −L2 T22s+2 − v −L2 T12s+2 + v −2L2 T22s+3 ) ∈ H′ .

(We use the identiﬁcation in 10.6.)

                                  13. The function a
13.1. In the remainder of these lectures we assume that L(s) > 0 for all s ∈ S.
A reference for this section is [L3].
                                                    ′
   For x, y, z in W we deﬁne fx,y,z ∈ A, fx,y,z       ∈ A, hx,y,z ∈ A by
                                                  ′
            P                    P
   Tx Ty = z∈W fx,y,z Tz = z∈W fx,y,z cz ,
            P
   cx cy = z∈W hx,y,z cz .
We have
                            ′
                 P
   (a) fx,y,z = z′ pz,z′ fx,y,z  ′
         ′            ′
                 P
   (b) fx,y,z = u qz,z′ fx,y,z′ ,
   (c) hx,y,z = x′ ,y′ px′ ,x py′ ,y fx′ ′ ,y′ ,z ,
                 P

(a),(c) follow from the deﬁnitions; (b) follows from (a) using 10.2(a). All sums in
(a)-(c) are ﬁnite. From 8.2, 5.6, we see that
   (d) hx,y,z 6= 0 =⇒ z ≤R x, z ≤L y,
   (e) hx,y,z = hy−1 ,x−1 ,z−1 .

13.2. We say that N ∈ N is a bound for W, L if v −N fx,y,z ∈ A≤0 for all x, y, z in
W . We say that W, L is bounded if there exists N ∈ N such that N is a bound for
W, L. If W is ﬁnite then W, L is obviously bounded. More precisely:
Lemma 13.3. If W is finite, then N = L(w0 ) is a bound for W, L.
  By 10.4(a) we have fx,y,z = τ (Tx Ty Tz−1 ). By 10.4(c) we have τ (Tx Ty Tz−1 ) ∈
 L(w0 )
v    Z[v −1 ]. The lemma is proved.
36                                   G. LUSZTIG

13.4. More generally, according to [L3, 7.2], if W is tame and L = l then W, L is
bounded; as a bound we can take
   (a) N = maxI L(w0I )
where I runs over the subsets of S such that WI is ﬁnite. This result and its proof
remain valid without the assumption L = l.
   We illustrate this in the setup of 7.1 with m = ∞. For a, b ∈ {1, 2} and
k > 0, k ′ > 0, we have
   Tak Tbk′ = Tak+k′ if b = a + k mod 2,
                        P
   Tak Tbk′ = Tak bk′ + u∈[1,min(k,k′ )] ξb+u−1 Tak+k′ −2u+1 if b = a + k + 1 mod 2;
here, for n ∈ Z we set ξn = v L1 − v −L1 if n is odd and ξn = v L2 − v −L2 if n is
even. We see that, in this case, max(L1 , L2 ) is a bound for W, L.
   Question. Is it true, in the general case, that W, L admits a bound? If so, can
the bound be taken as in (a)?
Lemma 13.5. Assume that N is a bound for W, L. Then, for any x, y, z in W
we have
  (a) v −N fx,y,z
            ′
                  ∈ A≤0 ,
       −N
  (b) v hx,y,z ∈ A≤0 .
                                    ′
    (a) follows from 13.1(b) since qz,z ′ ∈ A≤0 . (b) follows from (a) and 13.1(c) since

px′ ,x ∈ A≤0 , py′ ,y ∈ A≤0 .
13.6. In the remainder of this section we assume that W, L is bounded. Let N
be a bound for W, L. By 13.5(b), for any z ∈ W there exists a unique integer
a(z) ∈ [0, N ] such that
   (a) hx,y,z ∈ v a(z) Z[v −1 ] for all x, y ∈ W ,
   (b) hx,y,z ∈  / v a(z)−1 Z[v −1 ] for some x, y ∈ W .
(We use that h1,z,z = 1.) We then have for any x, y, z:
   (c) hx,y,z = γx,y,z−1 v a(z) mod v a(z)−1 Z[v −1 ]
where γx,y,z−1 ∈ Z is well deﬁned; moreover, for any z ∈ W there exists x, y such
that γx,y,z−1 6= 0.
   For any x, y, z we have
         ′
   (d) fx,y,z   = γx,y,z−1 v a(z) mod v a(z)−1 Z[v −1 ].
This is proved (for ﬁxed z) by induction on l(x) + l(y) using (c) and 13.1(c). (Note
that px′ ,x py′ ,y is 1 if x′ = x, y ′ = y and is in A<0 otherwise.)
Proposition 13.7. (a) a(1) = 0.
  (b) If z ∈ W − {1}, then a(z) ≥ mins∈S L(s) > 0.
   We prove (a). Let x, y ∈ W . Assume ﬁrst that y 6= 1. We can ﬁnd s ∈ S such
that ys < y. Then cy ∈ s H. Since s H is a left ideal (see 8.4) we have cx cy ∈ s H.
Since s1 > 1, from the deﬁnition of s H it then follows that hx,y,1 = 0.
   Similarly, if x 6= 1, then hx,y,1 = 0. Since h1,1,1 = 1, (a) follows.
   In the setup of (b) we can ﬁnd s ∈ S such that sz < z. By 6.6(b) we have
hs,z,z = vs + vs−1 . This shows that a(z) ≥ L(s) > 0. The proposition is proved.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                               37

Proposition 13.8. Assume that W is finite.
  (a) We have a(w0 ) = L(w0 ).
  (b) For any w ∈ W − {w0 } we have a(w) < L(w0 ).
   For any w ∈ W we have by deﬁnition a(w) ≤ N where N is a bound for W, L;
by 13.3 we can take N = L(w0 ), hence a(w) ≤ L(w0 ).
   We prove (a). From 6.6(b) we see that Ts cw0 = vs cw0 for any s ∈ S. Using this
and 12.2, weP    see that
   cw0 cw0 = y∈W v −L(yw0 ) v L(y) cw0 ,
hence
   hw0 ,w0 ,w0 = y∈W v −L(w0 ) v 2L(y) ∈ v L(w0 ) mod v L(w0 )−1 Z[v −1 ].
                   P

It follows that a(w0 ) ≥ L(w0 ). Hence a(w0 ) = L(w0 ). This proves (a).
   We prove (b). Let z ∈ W be such that a(z) = L(w0 ). We must prove that
z = w0 . By 13.6(d), we can ﬁnd x, y such that
     ′
   fx,y,z  = bv L(w0 ) + strictly smaller powers of v
where b ∈ Z − {0}. For any z ′ 6= z we have
     ′          L(w0 )
   fx,y,z ′ ∈ v        Z[v −1 ]
(by 13.6 and the ﬁrst sentence in the proof). Since pz,z′ =P1 for z = z ′ and
pz,z′ ∈ A<0 for z ′ < z, we see that the equality fx,y,z =                      ′
                                                                      z ′ pz,z fx,y,z ′ (see
                                                                              ′

13.1(a)), implies that
   fx,y,z = bv L(w0 ) + strictly smaller powers of v
with b 6= 0. Now fx,y,z = τ (Tx Ty Tz−1 ). Using now 10.4(c) we see that
   min(L(x), L(y), L(z −1)) = L(w0 ).
It follows that x = y = z −1 = w0 . The proposition is proved.
Proposition 13.9. (a) For any z ∈ W we have a(z) = a(z −1 ).
  (b) For any x, y, z ∈ W we have γx,y,z = γy−1 ,x−1 ,z−1 .
   This follows from 13.1(e).
13.10. We show that, in the setup of 7.1 with m = ∞ and L2 ≥ L1 , the function
a:W −   → N is given as follows:
   (a) a(1) = 0,
   (b) a(11 ) = L1 , a(21 ) = L2 ,
   (c) a(1k ) = a(2k ) = L2 if k ≥ 2.
Now (a) is contained in 13.7(a). If s2 z < z then, by the proof of 13.7(b) we have
a(z) ≥ L2 . By 13.4, L2 is a bound for W, L hence a(z) ≤ L2 so that a(z) = L2 . If
zs2 < z then the previous argument is applicable to z −1 . Using 13.9, we see that
a(z) = a(z −1 ) = L2 .
   Assume next that z = 12k+1 where k ≥ 1. By 7.5, 7.6, we have
   c12 c22k = c1 c2 c22k = (v L2 + v −L2 )c1 c22k = (v L2 + v −L2 )c12k+1 ,
hence h12 ,22k ,z = v L2 + v −L2 . Thus, a(z) ≥ L2 . By 13.4 we have a(z) ≤ L2 hence
a(z) = L2 .
   It remains to consider the case where z = s1 . Assume ﬁrst that L1 = L2 . Then
a(s1 ) ≤ L1 by 13.4 and a(s1 ) ≥ L1 by 13.7(b). Hence a(s1 ) = L1 .
38                                  G. LUSZTIG

                                                     P
   Assume next that L1 < L2 . Then I = w∈W −{1,s1 } Acw is a two-sided ideal
I of H (see 8.8). Hence if x or y is in W − {1, s1 }, then cx cy ∈ I and hx,y,s1 = 0.
Using
   h1,1,s1 = 0, h1,s1 ,s1 = hs1 ,1,s1 = 1, hs1 ,s1 ,s1 = v L1 + v −L1
we see that a(s1 ) = L1 . Thus, (a),(b),(c) are established.
13.11. In this subsection we assume that we are in the setup of 7.1 with 4 ≤ m <
∞ and L2 > L1 . By 7.8, we have
  h2m−1 ,2m−1 ,2m−1 = (−1)(m−2)/2 v (mL2 −(m−2)L1 )/2 + strictly smaller powers of v.
Hence a(2m−1 ) ≥ (mL2 − (m − 2)L1 )/2.
  One can show that the function a : W −   → N is given as follows:
  a(1) = 0,
  a(11 ) = L1 , a(21 ) = L2 ,
  a(1m−1 ) = L2 , a(2m−1 ) = (mL2 − (m − 2)L1 )/2,
  a(2m ) = m(L1 + L2 )/2,
  a(1k ) = a(2k ) = L2 if 1 < k < m − 1.
This remains true in the case where L1 = L2 .

                                14. Conjectures
14.1. In this section we assume that W, L is bounded.
   For Pan integer n we denote by πn : A − → Z be the group homomorphism deﬁned
by πn ( k∈Z ak v k ) = an .
   For z ∈ W we denote by ∆(z) the integer ≥ 0 deﬁned by
   (a) p1,z = nz v −∆(z) + strictly smaller powers of v, nz ∈ Z − {0}.
Note that ∆(1) = 0, 0 < ∆(z) ≤ L(z) for z 6= 1 (see ...) and ∆(z) = ∆(z −1 ) for
all z. Let
                             D = {z ∈ W |a(z) = ∆(z)}.

Clearly, z ∈ D =⇒ z −1 ∈ D.
Conjectures 14.2. The following properties hold.
   P1. We have a(z) ≤ ∆(z).
   P2. If d ∈ D and x, y ∈ W satisfy γx,y,d 6= 0, then x = y −1 .
   P3. If y ∈ W , there exists a unique d ∈ D such that γy−1 ,y,d 6= 0.
   P4. If z ′ ≤LR z then a(z ′ ) ≥ a(z). Hence, if z ′ ∼LR z, then a(z ′ ) = a(z).
   P5. If d ∈ D, y ∈ W, γy−1 ,y,d 6= 0, then γy−1 ,y,d = nd = ±1.
   P6. If d ∈ D, then d2 = 1.
   P7. For any x, y, z ∈ W we have γx,y,z = γy,z,x .
   P8. Let x, y, z ∈ W be such that γx,y,z 6= 0. Then x ∼L y −1 , y ∼L z −1 ,
z ∼L x−1 .
   P9. If z ′ ≤L z and a(z ′ ) = a(z) then z ′ ∼L z.
   P10. If z ′ ≤R z and a(z ′ ) = a(z) then z ′ ∼R z.
   P11. If z ′ ≤LR z and a(z ′ ) = a(z) then z ′ ∼LR z.
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                     39

   P12. Let I ⊂ S. If y ∈ WI , then a(y) computed in terms of WI is equal to a(y)
computed in terms of W .
   P13. Any left cell Γ of W contains a unique element d ∈ D. We have γx−1 ,x,d 6=
0 for all x ∈ Γ.
   P14. For any z ∈ W we have z ∼LR z −1 .
   P15. Let v ′ be a second indeterminate and let h′x,y,z ∈ Z[v ′ , v ′−1 ] be obtained
from
   P hx,y,z  by the substitution     v 7→ v ′ . If x, x′ , y, w ∈ W satisfy a(w) = a(y), then
          ′                                ′
                              P
     y ′ hw,x′ ,y ′ hx,y ,y =  y ′ hx,w,y hy ′ ,x′ ,y .
                        ′                ′


   In §15-§17 we will verify the conjecture above in a number of cases.
Auxiliary statement 14.3. Let x, y, z, z ′ ∈ W be such that γx,y,z−1 6= 0, z ′ ←L
z. Then there exists x′ ∈ W such that πa(z) (hx′ ,y,z ′ ) 6= 0. In particular, a(z ′ ) ≥
a(z).
   In this section we will show, that, if P1-P3 and 14.3 are assumed to be true,
then P4-P14 are automatically true. The arguments follow [L3], [L4].
14.4. 14.3 =⇒ P4. Let z ′ , z be as in P4. We can assume that z ′ 6= z and
that z ′ ←L z or z ′−1 ←L z −1 . In the ﬁrst case, from 14.3 we get a(z ′ ) ≥ a(z).
(We can ﬁnd x, y such that γx,y,z−1 6= 0.) In the second case, from 14.3 we get
a(z ′−1 ) ≥ a(z −1 ) hence a(z ′ ) ≥ a(z).
                                                                            P
14.5. P1,P3 =⇒ P5. Let x, y ∈ W . Applying τ to cx cy = z hx,y,z cz gives
  X                  X                               X                           X
      hx,y,z p1,z =     px′ ,x py′ ,y τ (Tx′ Ty′ ) =   px′ ,x py′ ,y δx′ y′ ,1 =   px′ ,x px′ −1 ,y
   z                 x′ ,y ′                             x′ ,y ′                x′

hence
                               X
(a)                                hx,y,z p1,z = δxy,1     mod v −1 Z[v −1 ].
                               z

We take x = y −1 and note that hy−1 ,y,z ∈ v a(z) Z[v −1 ], p1,z ∈ v −∆(z) Z[v −1 ], hence
   hy−1 ,y,z p1,z ∈ v a(z)−∆(z) Z[v −1 ].
The same argument shows that, if z ∈ D, then
   hy−1 ,y,z p1,z ∈ γy−1 ,y,z −1 nz + v −1 Z[v −1 ].
     / D then, by P1, we have a(z) − ∆(z) < 0 so that hy−1 ,y,z p1,z ∈ v −1 Z[v −1 ].
If z ∈
WeP  now see that
                                                     −1   −1
                          P
      z hy −1 ,y,z p1,z =   z∈D γy −1 ,y,z
                                        P−1 nz mod v Z[v ].
Comparing
   P           with (a) we see that z∈D γy−1 ,y,z−1 nz = 1. Equivalently,
      z∈D y ,y,z nz = 1.
             γ −1

Using this and P3 we see that, in the setup of P5 we have γy−1 ,y,d nd = 1. Since
γy−1 ,y,d , nd are integers, we must have γy−1 ,y,d = nd = ±1.
14.6. P2,P3 =⇒ P6. We can ﬁnd x, y such that γx,y,d 6= 0. By P2, we have
x = y −1 so that γy−1 ,y,d 6= 0. This implies γy−1 ,y,d−1 6= 0. (See 13.9(b)). We have
d−1 ∈ D. By the uniqueness in P3 we have d = d−1 .
40                                     G. LUSZTIG

14.7. P2,P3,P4,P5 =⇒ P7. We ﬁrst prove the following statement.
   (a) Let x, y, z ∈ W, d ∈ D be such that γx,y,z 6= 0, γz−1 ,z,d 6= 0, a(d) = a(z).
Then γx,y,z = γy,z,x .
Let n = a(d). From γx,y,z 6= 0 we deduce hx,y,z−1 6= 0 hence z −1 ≤R x, hence
n = a(z) = a(z −1 ) ≥ a(x) (see P4). Computing the coeﬃcient of cd in two ways,
we Pobtain                    P
      z ′ hx,y,z hz ,z,d =       x′ hx,x ,d hy,z,x .
                   ′  ′                 ′           ′

Now hz ,z,d 6= 0 implies d ≤R z hence a(z ′ ) ≤ a(d) = n (see P4); similarly,
            ′
                                              ′
                                   ′              ′
   P,d 6= 0 implies d ≤L x hence
hx,x                                  P a(x ) ≤ a(d) = n. Thus we have
    ′


      z ′ ;a(z ′ )≤n hx,y,z hz ,z,d =     x′ ;a(x′ )≤n hx,x ,d hy,z,x .
                           ′  ′                            ′         ′

By P2 and our assumptions, the left hand side is
   γx,y,z γz−1 ,z,d v 2n + strictly smaller powers of v.
Similarly, the right hand side is
   γx,x−1 ,d πn (hy,z,x−1 )v 2n + strictly smaller powers of v.
Hence γx,x−1 ,d πn (hy,z,x−1 ) = γx,y,z γz−1 ,z,d 6= 0. Thus,
   γx,x−1 ,d 6= 0, πn (hy,z,x−1 ) 6= 0.
We see that a(x−1 ) ≥ n. But we have also a(x) ≤ n hence a(x) = n and
πn (hy,z,x−1 ) = γy,z,x . Since γx,x−1 ,d 6= 0, we have (by P5) γx,x−1 ,d = γz−1 ,z,d .
Using this and γx,x−1 ,d γy,z,x = γx,y,z γz−1 ,z,d we deduce γy,z,x = γx,y,z , as required.
   Next we prove the following statement.
   (b) Let z ∈ W, d ∈ D be such that γz−1 ,z,d 6= 0. Then a(z) = a(d).
We shall assume that (b) holds whenever a(z) > N0 and we shall deduce that it
also holds when a(z) = N0 . (This will prove (b) by descending induction on a(z)
since a(z) is bounded above.) Assume that a(z) = N0 . From γz−1 ,z,d = ±1 we
deduce that hz−1 ,z,d−1 6= 0 hence d−1 ≤L z −1 hence a(d−1 ) ≥ a(z −1 ) (see P4) and
a(d) ≥ a(z). Assume that a(d) > a(z), that is, a(d) > N0 . Let d′ ∈ D be such
that γd−1 ,d,d′ 6= 0 (see P3). By the induction hypothesis applied to d, d′ instead
of z, d, we have a(d) = a(d′ ). From γz−1 ,z,d 6= 0, γd−1 ,d,d′ 6= 0, a(d) = a(d′ ),
we deduce (using (a)) that γz,d,z−1 = γz−1 ,z,d . Hence γz,d,z−1 6= 0. It follows
that hz,d,z 6= 0, hence z ≤L d, hence a(z) ≥ a(d) (see P4). This contradicts the
assumption a(d) > a(z). Hence we must have a(z) = a(d), as required.
   We now prove P7. Assume ﬁrst that γx,y,z 6= 0. Let d ∈ D be such that
γz−1 ,z,d 6= 0 (see P3). By (b) we have a(z) = a(d). Using (a) we then have
γx,y,z = γy,z,x . Assume next that γx,y,z = 0; we must show that γy,z,x = 0. We
assume that γy,z,x 6= 0. By the ﬁrst part of the proof, we have
   γy,z,x 6= 0 =⇒ γy,z,x = γz,x,y 6= 0 =⇒ γz,x,y = γx,y,z 6= 0,
a contradiction.
14.8. P7 =⇒ P8. If γx,y,z 6= 0, then hx,y,z−1 6= 0, hence z −1 ≤L y, z ≤L x−1 .
By P7 we also have γy,z,x 6= 0 (hence x−1 ≤L z, x ≤L y −1 ) and γz,x,y 6= 0 (hence
y −1 ≤L x, y ≤L z −1 ). Thus, we have x ∼L y −1 , y ∼L z −1 , z ∼L x−1 .
14.9. 14.3,P4,P8 =⇒ P9. We can ﬁnd a sequence z ′ = z0 , z1 , . . . , zn = z such
that for any j ∈ [1, n] we have zj−1 ≤L zj . By P4 we have a(z ′ ) = a(z0 ) ≥ a(z1 ) ≥
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                 41

· · · ≥ a(zn ) = a(z). Since a(z) = a(z ′ ), we have a(z ′ ) = a(z0 ) = a(z1 ) = · · · =
a(zn ) = a(z). Thus, it suﬃces to show that, if z ′ ←L z and a(z ′ ) = a(z), then
z ′ ∼L z. Let x, y ∈ W be such that γx,y,z−1 6= 0. By 14.3, there exists x′ ∈ W
such that πa(z) (hx′ ,y,z′ ) 6= 0. Since a(z ′ ) = a(z), we have γx′ ,y,z′−1 6= 0. From
γx,y,z−1 6= 0, γx′ ,y,z′−1 6= 0 we deduce, using P8, that y ∼L z, y ∼L z ′ , hence
z ∼L z ′ .
14.10. P9 =⇒ P10. We apply P9 to z −1 , z ′−1 .
14.11. P4,P9,P10 =⇒ P11. We can ﬁnd a sequence z ′ = z0 , z1 , . . . , zn = z
such that for any j ∈ [1, n] we have zj−1 ≤L zj or zj−1 ≤R zj . By P4, we
have a(z ′ ) = a(z0 ) ≥ a(z1 ) ≥ · · · ≥ a(zn ) = a(z). Since a(z) = a(z ′ ), we have
a(z ′ ) = a(z0 ) = a(z1 ) = · · · = a(zn ) = a(z). Applying P9 or P10 to zj−1 , zj we
obtain zj−1 ∼L zj or zj−1 ∼R zj . Hence z ′ ∼LR z.
14.12. P3,P4,P8 for W and WI =⇒ P12. We write aI : WI −                  → N for the
                                                                  I        I
a-function deﬁned in terms of WI . For x, y, z ∈ WI , we write hx,y,z , γx,y,z   for the
analogues of hx,y,z , γx,y,z when W is replaced by WI . Let HI ⊂ H be as in 9.9.
   Let d ∈ D be such that γy−1 ,y,d 6= 0. (See P3.) Then πa(d) (hy−1 ,y,d−1 ) 6= 0. Now
cy−1 cy ∈ HI hence d ∈ WI and πa(d) (hIy−1 ,y,d−1 ) 6= 0. Thus, aI (d−1 ) ≥ a(d−1 ).
The reverse inequality is obvious hence aI (d) = a(d). We see that γyI−1 ,y,d 6= 0.
By P8 we see that y ∼L d (relative to WI ) and y ∼L d (relative to W ). From P4
we deduce that aI (y) = aI (d) and a(y) = a(d). It follows that a(y) = aI (y).
14.13. 14.3,P2,P3,P4,P6,P8 =⇒ P13. If x ∈ Γ then, by P3, there exists d ∈ D
such that γx−1 ,x,d 6= 0. By P8 we have x ∼L d−1 hence d−1 ∈ Γ. By P6, we
have d = d−1 hence d ∈ Γ. It remains to prove the uniqueness of d. Let d′ , d′′
be elements of D ∩ Γ. We must prove that d′ = d′′ . We can ﬁnd x′ , y ′ , x′′ , y ′′
such that γx′ ,y′ ,d′ 6= 0, γx′′ ,y′′ ,d′′ 6= 0. By P2, we have x′ = y ′−1 , x′′ = y ′′−1 . By
P8, we have y ′ ∼L d′−1 = d′ and y ′′ ∼L d′′−1 = d′′ , hence y ′ , y ′′ ∈ Γ. By the
deﬁnition of left cells, we can ﬁnd a sequence y ′ = x0 , x1 , . . . , xn = y ′′ such that
xj−1 ←L xj for j ∈ [1, n]. Since y ′ ∼L y ′′ , we have xj ∈ Γ for all j. For each
j ∈ [1, n − 1] let dj ∈ D be such that γx−1 ,xj ,dj 6= 0. Let d0 = d′ , dn = d′′ . As
                                                   j
in the beginning of the proof, we have dj ∈ Γ for each j. Let j ∈ [1, n]. By P8,
we have γxj ,dj ,x−1 6= 0. Appplying 14.3 to xj , dj , xj , xj−1 instead of x, y, z, z ′ , we
                   j
see that there exists u such that πa(xj ) (hu,dj ,xj−1 ) 6= 0. Since xj−1 ∼ xj , we have
a(xj−1 ) = a(xj ) (see P4), hence πa(xj ) (hu,dj ,xj−1 ) = γu,dj ,x−1 6= 0. Using P8, we
                                                                    j−1
deduce γx−1 ,u,dj 6= 0. Using P2 we see that u = xj−1 and γx−1 ,xj−1 ,dj 6= 0. We
          j−1                                                           j−1
have also γx−1 ,xj−1 ,dj−1 6= 0 and by the uniqueness in P3, it follows that dj−1 = dj .
            j−1
Since this holds for j ∈ [1, n], it follows that d′ = d′′ , as required.
14.14. P6,P13 =⇒ P14. By P13, we can ﬁnd d ∈ D such that z ∼L d. Since
d = d−1 (see P6), it follows that z −1 ∼R d. Thus, z ∼LR z −1 .
14.15. In this subsection we reformulate conjecture P15, assuming that P4,P9,
P10 hold. Let Ã = Z[v, v −1 , v ′ , v ′−1 ] where v, v ′ are indeterminates. Let H̃ be
42                                                    G. LUSZTIG

the free Ã-module with basis ew (w ∈ W ). Let (H′ , c′w , h′x,y,z ) be obtained from
(H, cw , hx,y,z ) by changing the variable v to v ′ . In particular, h′x,y,z ∈ Z[v ′ , v ′−1 ].
    On H̃ we have a left H-module structure given by v nP
                                                                                    P n
                                                                            cy ew =   x v hy,w,x ex
                  ′                                             ′n ′             ′n ′
and a right H -module structure deﬁned by ew (v cy ) = x v hw,y,x ex . These
module structures do not commute in general. For each a ≥ 0 let H̃≥a be the
Ã-submodule of H̃ spanned by {ew |a(w) ≥ a}. By P4, this is a left H-submodule
and a right H′ -submodule of H̃. We have
    . . . H̃≥2 ⊂ H̃≥1 ⊂ H̃≥0 = H̃
and gr H̃ = ⊕a≥0 H̃≥a /H̃≥a+1 inherits a left H-module structure and a right H′ -
module structure from H̃. Clearly, P15 is equivalent to the condition that these
module stuctures on gr H̃ commute. To check this last condition, it is enough
to check that the actions of cs , c′s′ commute on gr H̃ whenever s, s′ ∈ S. Let
s, s′ ∈ S, w ∈ W . A computation using 6.6, 6.7, 8.2 shows that (cs ew )c′s′ −cs (ew cs′ )
is 0 if sw < w or ws′ < w, while if sw > w, ws′ > w, it is
             X                                                                    X
                    (h′w,s′ ,y (vs + vs−1 ) − hs,w,y (vs′ ′ + vs′ ′ −1 ))ey +            αy ey
     y;sy<y,ys′ <y                                                                                  y;sy<y,ys′ <y

where                        X                                                X
             αy =                             h′w,s′ ,y′ hs,y′ ,y −                            hs,w,y′ h′y′ ,s′ ,y .
                     y ′ ;y ′ s′ <y ′ <sy ′                           y ′ ;sy ′ <y ′ <y ′ s′

If y satisﬁes sy < y, ys′ < y and either h′w,s′ ,y or hs,w,y is 6= 0, then a(y) > a(w).
(We certainly have a(y) ≥ a(w) by P4. If we had a(y) = a(w) and hs,w,y 6= 0 then
by P9 we would have y ∼L w hence R(y) = R(w) contradicting ys′ < y, ws′ > w.
If we had a(y) = a(w) and h′s,w,y 6= 0 then by P10 we would have y ∼R w hence
L(y) = L(w) contradicting sy < y, sw > w.) Hence, if sw > w, ws′ > w, we have
                                         X
        (cs ew )c′s′ − cs (ew c′s′ ) =                  αy ey mod H̃≥a(w)+1 .
                                                y;sy<y,ys′ <y,a(y)=a(w)

We see that P15 is equivalent to the following statement.
  (a) If y, w ∈ W, s, s′ ∈ S are such that sw > w, ws′ > w, sy < y, ys′ < y, a(y) =
a(w),
  P then                     ′                                                    ′
                                                 P
     y ′ ;y ′ s′ <y ′ <sy ′ hw,s′ ,y ′ hs,y ,y =   y ′ ;sy ′ <y ′ <y ′ s′ hs,w,y hy ′ ,s′ ,y .
                                           ′                                    ′



                                   15. Example: the split case
15.1. In this section we assume that we are in the split case (see 3.1), that W is
tame and that
    (a) hx,y,z ∈ N[v, v −1 ] for all x, y, z in W ,
    (b) py,w ∈ N[v −1 ] for all y, w in W .
It is known that (a),(b) hold automatically in the split case if W is tame, integral.
    Under these assumptions we will show that 14.3 and P1-P3 hold for W, l hence
all of P1-P14 hold for W, l; we will also show that P15 holds.
    A reference for this section is [L4].
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                             43

15.2. Proof of P1. The weaker inequality a(z) ≤ l(z) was ﬁrst proved in [L3] for
ﬁnite W and then for general W by Springer (unpublished). The present argument
was inspired by Springer’s argument.
   FromP14.5(a) we see that      for x, y ∈ W we have
                              −1
   (a) z hx,y,z p1,z ∈ Z[v ].
From 15.1(a),(b) we see that hx,y,z p1,z ∈ N[v, v −1 ] for any z. Hence in (a) there
are no cancellations, so that
   (b) hx,y,z p1,z ∈ N[v −1 ] for any z.
We now ﬁx z and choose x, y so that γx,y,z−1 6= 0. From the deﬁnitions we have
   (c) hx,y,z p1,z ∈ γx,y,z−1 nz v a(z)−∆(z) + strictly smaller powers of v
and the coeﬃcient of v a(z)−∆(z) is 6= 0. Comparing with (b) we deduce that
a(z) − ∆(z) ≤ 0.
15.3. PProof of P2. Assume that x 6= y −1 . From 14.5(a) we see that
   (a) z hx,y,z p1,z ∈ v −1 Z[v −1 ].
As in 15.2, this implies (using 15.1(a),(b)) that
   (b) hx,y,z p1,z ∈ v −1 N[v −1 ] for any z.
Assume now that z = d−1 ∈ D. The equality 15.2(c) becomes in our case
   hx,y,z p1,z ∈ γx,y,z−1 nz + v −1 Z[v −1 ].
Comparing with (b) we deduce that γx,y,z−1 nz = 0. Since nz 6= 0, we have
γx,y,z−1 = 0. This proves P2.
15.4. P Proof of P3. From 14.5(a) we see that
   (a) z hy−1 ,y,z p1,z ∈ 1 + v −1 Z[v −1 ].
As in 15.2, this implies (using 15.1(a),(b)) that there is a unique z, say z = d−1
such that
   (b) hy−1 ,y,d−1 p1,d−1 ∈ 1 + v −1 N[v −1 ]
and that
   (c) hy−1 ,y,z p1,z ∈ v −1 N[v −1 ]
for all z 6= d−1 . For z = d−1 , the equality 15.2(c) becomes
   hy−1 ,y,d−1 p1,d−1 ∈ γy−1 ,y,d nd−1 v a(d)−∆(d) + strictly smaller powers of v.
Here a(d) − ∆(d) ≤ 0. Comparing with (b) we deduce that a(d) − ∆(d) = 0 and
γy−1 ,y,d nd−1 = 1. Thus, d ∈ D and γy−1 ,y,d 6= 0. Thus, the existence part of P3 is
established.
   Assume that there exists d′ 6= d such that d′ ∈ D and γy−1 ,y,d′ 6= 0. For z = d′−1
the equality 15.2(c) becomes
   hy−1 ,y,d′−1 p1,d′ −1 ∈ γy−1 ,y,d′ nd′ −1 + v −1 Z[v −1 ].
Comparing with (c) (with z = d′−1 ) we deduce that γy−1 ,y,d′ nd′ −1 = 0 hence
γy−1 ,y,d′ = 0, a contradiction. This proves the uniqueness part of P3.
15.5. Proof of 14.3. We may assume that z ′ 6= z. Then we can ﬁnd s ∈ S such
that sz ′ < z ′ , sz > z and hs,z,z′ 6= 0. Since hx,y,z 6= 0, we have (by 13.1(d)) z ≤R x
hence L(x) ⊂ L(z)P(by 8.6). Since s ∈       / L(z), we have s ∈   / L(x), that is, sx > x.
We have cs cx cy = u pu cu , where
44                                        G. LUSZTIG

         P                         P
   pu = w hx,y,w hs,w,u = x′ hs,x,x′ hx′ ,y,u .
In particular,
          P                                            P
   pz′ = w hx,y,w hs,w,z ′ = hx,y,z hs,z,z′ + w;w6=z hx,y,w hs,w,z ′ .
By 6.5, we have hs,z,z′ ∈ Z hence, taking
                                            P
   (a) πn (pz′ ) = πn (hx,y,z )hs,z,z′ + w;w6=z πn (hx,y,w hs,w,z ′ ).
for any n ∈ Z. In particular, this holds for n = a(z). By assumption, we have
πn (hx,y,z ) 6= 0 and hs,z,z′ 6= 0; hence, by 15.1(a), we have πn (hx,y,z ) > 0 and
hs,z,z′ > 0. Again, by 15.1(a) we have πn (hx,y,w P      hs,w,z ′ ) ≥ 0 for any w 6= z. Hence
from (a) we deduce πn (pz ) > 0. Since pz = x′ hs,x,x′ hx′ ,y,z ′ , there exists x′
                                 ′                     ′

such that πn (hs,x,x′ hx′ ,y,z′ ) 6= 0. Since sx > x, we see from 6.5 that hs,x,x′ ∈ Z
hence
   πn (hs,x,x′ hx′ ,y,z′ ) = hs,x,x′ πn (hx′ ,y,z ′ ).
Thus we have πn (hx′ ,y,z′ ) 6= 0. This proves 14.3 in our case.
15.6. Since 14.3 and P1-P3 are known, we see that P1-P11 and P13,P14 hold in
our case (see §14). The same arguments can be applied to WI where I ⊂ W , hence
P1-P11 and P13,P14 hold for WI . By 14.12, P12 holds for W . Thus, P1-P14 hold
for W .
15.7. Proof of P15. By 14.15, we see that it is enough to prove 14.15(a). Let
y, w, s, s′ be as in 14.15(a). In our case, by 6.5, the equation in 14.15(a) involves
only integers, hence it is enough to prove it after specializing v = v ′ . If in 14.15
we specialize v = v ′ , then the left and right module structures in 14.15 clearly
commute, since the left and right regular representations of H commute. Hence
the coeﬃcient of ey in ((cs ew )c′s′ − cs (ew cs′ ))v=v ′ is 0. By the computation in
14.15, this coeﬃcient is
(a)                               X                             X
(hw,s′ ,y − hs,w,y )(v + v −1 ) +        hw,s′ ,y′ hs,y′ ,y −        hs,w,y′ hy′ ,s′ ,y = 0
                                       y′                          y′
                               y ′ s′ <y ′ <sy ′             sy ′ <y ′ <y ′ s′


By 6.5, hs,w,y is the coeﬃcient of v −1 in py,w and hw,s′ ,y = hs′ ,w−1 ,y−1 is the
coeﬃcient of v −1 in py−1 ,w−1 = py,w . Thus, hs,w,y = hw,s′ ,y and (a) reduces to the
equation in 14.15(a) (specialized at v = v ′ ). This proves 14.15(a).

                        16. Example: the quasisplit case
16.1. Let (W̃ , S̃) be a Coxeter group and let σ : W̃ −
                                                      → W̃ be an automorphism of
ﬁnite order of W̃ which restricts to a permutation of S̃ such that any σ-orbit on
S̃ generates a ﬁnite subgroup of W̃ . Assume also that the following condition is
satisﬁed: if s, s′ ∈ S and k ∈ N are such that ms,s′ ≥ 4 and σ k maps {s, s′ } into
itself then σ k (s) = s, σ k (s′ ) = s′ .
   Let W̃ σ = {w ∈ W̃ |σ(w) = w}. For any σ-orbit o on S̃, we set so = w0o ∈ W̃ σ .
The elements so for various o as above form a subset S̃σ of W̃ σ .
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                   45

Lemma 16.2. (W̃ σ , S̃σ ) is a Coxeter group and the restriction to W̃ σ of the
length function ˜l : W̃ −
                        → N is a weight function L : W̃ σ −
                                                          → N.
   We omit the proof.
16.3. In this section we assume that W̃ is tame, (W, S) is the Coxeter group
(W̃ σ , S̃σ ) and that L : W −          → N is as in 16.2. We then say that we are in the
quasisplit case.
   We denote hx,y,z , px,y , a(z), γx,y,z , ∆(z), D deﬁned in terms of W̃ , ˜l by
                                      ˜
   h̃x,y,z , p̃x,y , ã(z), γ̃x,y,z , ∆(z), D̃.
We shall assume that the following holds.
                                                                                             n
   (a) For any x, y, z ∈ W̃ and any integer n there exists a Q-vector space Vx,y,z
                                        n
                                             v n ; for any x,P
                          P
such that h̃x,y,z = n dim Vx,y,z                             y ∈ W̃ and any integer n ≤ 0 there
                                      n                                  n n
exists a Q-vector space Vx,y such that p̃x,y = n≤0 dim Vx,y                v .
   In other words, (W̃ , ˜l) satisﬁes the requirements of 15.1. We shall further assume
that the following holds.
                                                                  n
   (b) For any x, y, z ∈ W and any integer                   n, Vx,y,z carries a linear transfor-
mation σ of finite order and hx,y,z = n tr(σ, Vx,y,z )v n ; for any x, y ∈ W and
                                                                 n
                                                      P
                                 n
          P n ≤ n0, Vnx,y carries a linear transformation σ of finite order and
any integer
px,y = n tr(σ, Vx,y )v .
It is known that this is automatically satisﬁed if W̃ is tame, integral.
   We deduce that (c)-(f) below hold:
   (c) If x, y, z ∈ W, n ∈ Z and πn (hx,y,z ) 6= 0 then πn (h̃x,y,z ) 6= 0.
   (d) If x, y ∈ W, n ∈ Z and πn (px,y ) 6= 0 then πn (p̃x,y ) 6= 0.
   (e) If x, y, z ∈ W, n ∈ Z and πn (h̃x,y,z ) = ±1 then πn (hx,y,z ) = ±1.
   (f) If x, y ∈ W, n ∈ Z and πn (p̃x,y ) = ±1 then πn (px,y ) = ±1.
16.4. By our assumptions, the results of §15 are applicable to W̃ , ˜l. Under the
assumptions above, we will show that 14.3 and P1-P3 hold for W, L hence all of
P1-P14 hold for W, L.
Lemma 16.5. For z ∈ W we have a(z) = ã(z) and ∆(z)˜    ≤ ∆(z).
   We can ﬁnd x, y ∈ W such that πa(z) (hx,y,z ) 6= 0. By 16.3(c) we have
πa(z) (h̃x,y,z ) 6= 0. Hence a(z) ≤ ã(z). By P3,P5 for W̃ , there is a unique d ∈ D̃
such that γ̃z−1 ,z,d = ±1. The uniqueness of d implies that d is ﬁxed by σ. Thus
d ∈ W . By P7 for W̃ , we have γ̃z,d,z−1 = ±1. Hence πã(z) (h̃z,d,z ) = ±1. By
16.3(e), we have πã(z) (hz,d,z ) = ±1. Hence ã(z) ≤ a(z) so that ã(z) = a(z).
   By deﬁnition, we have π−∆(z) (p1,z ) 6= 0. Using 16.3(d), we deduce that
                                        ˜
π−∆(z) (p̃1,z ) 6= 0. Hence −∆(z) ≤ −∆(z).    The lemma is proved.
Lemma 16.6. D = D̃ ∩ W .
  Let d ∈ D. We have a(d) = ∆(d). Using 16.5, we deduce ã(d) = ∆(d). By
                            ˜
P1 for W̃ , we have ã(d) ≤ ∆(d).              ˜
                                  Hence ∆(d) ≤ ∆(d). Using 16.5, we deduce
        ˜             ˜
∆(d) = ∆(d) so that ∆(d) = ã(d) and d ∈ D̃.
46                                     G. LUSZTIG

   Conversely, let d ∈ D̃ ∩ W . We have ã(d) = ∆(d).˜     Using 16.5 we deduce
        ˜
a(d) = ∆(d). By P5 for W̃ , we have π−∆(d)
                                      ˜    (p̃1,d ) = ±1. Using 16.3(f) we deduce
π−∆(d)
   ˜
                             ˜
       (p1,d ) = ±1. Hence −∆(d) ≤ −∆(d). Using 16.5 we deduce ∆(d) = ∆(d)   ˜
so that ∆(d) = a(d) and d ∈ D. The lemma is proved.
Lemma 16.7. (a) Let x, y, z ∈ W be such that γx,y,z 6= 0. Then γ̃x,y,z 6= 0.
  (b) Let x, y, z ∈ W be such that γ̃x,y,z = ±1. Then γx,y,z = ±1.
    In the setup of (a) we have πa(z−1 ) (hx,y,z−1 ) 6= 0. Using 16.5 we deduce that
πã(z−1 ) (hx,y,z−1 ) 6= 0. Using 16.3(c), we deduce that πã(z−1 ) (h̃x,y,z−1 ) 6= 0. Hence
γ̃x,y,z 6= 0.
    In the setup of (b) we have πã(z−1 ) (h̃x,y,z−1 ) = ±1. Using 16.5, we deduce
πa(z−1 ) (h̃x,y,z−1 ) = ±1. Using 16.3(e), we deduce πa(z−1 ) (hx,y,z−1 ) = ±1. Hence
γx,y,z = ±1.
                                                                  ˜
16.8. Proof of P1. By 16.5 and P1 for W̃ , we have a(z) = ã(z) ≤ ∆(z) ≤ ∆(z),
hence a(z) ≤ ∆(z).
16.9. Proof of P2. In the setup of P2, we have (by 16.7) γ̃x,y,d 6= 0 and d ∈ D̃
(see 16.6). Using P2 for W̃ , we deduce x = y −1 .
16.10. Proof of P3. Let y ∈ W . By P3 for W̃ , there is a unique d ∈ D̃ such that
γ̃y−1 ,y,d 6= 0. By the uniqueness of d, we have σ(d) = d hence d ∈ W . Using P5 for
W̃ , we see that γ̃y−1 ,y,d = ±1. Using 16.7, we deduce γy−1 ,y,d = ±1. Since d ∈ D
by 16.6, the existence part of P3 is established. Assume now that d′ ∈ D satisﬁes
γy−1 ,y,d′ 6= 0. Using 16.7, we deduce γ̃y−1 ,y,d′ 6= 0. Since d′ ∈ D̃ by 16.6, we can
use the uniqueness in P3 for W̃ to deduce that d = d′ . Thus P3 holds for W .
16.11. Proof of P4. We may assume that there exists s ∈ S such that hs,z,z′ 6= 0
or hz,s,z′ 6= 0. In the ﬁrst case, using 16.3(c), we deduce h̃s,z,z′ 6= 0. Hence z ′ ≤L z
(in W̃ ) and using P4 for W̃ , we deduce that ã(z ′ ) ≥ ã(z). Using now 16.5, we see
that a(z ′ ) ≥ a(z). The proof in the second case is entirely similar.
16.12. Now P5 is proved as in 14.5; P6 is proved as in 14.6; P7 is proved as in
14.7; P8 is proved as in 14.8; P12 is proved as in 14.12.
16.13. Proof of P13. If z ′ ←L z in W , then there exists s ∈ S such that hs,z,z′ 6= 0
hence, by 16.3(c), h̃s,z,z′ 6= 0, hence z ′ ≤L z in W̃ . It follows that
   (a) z ′ ≤L z (in W ) implies z ′ ≤L z (in W̃ ).
Hence
   (b) z ′ ∼L z (in W ) implies z ′ ∼L z (in W̃ ).
Thus any left cell of W is contained in a left cell of W̃ .
   In the setup of P13, let Γ̃ be the left cell of W̃ containing Γ. Let x ∈ Γ. By P3
for W , there exists d ∈ D such that γx−1 ,x,d 6= 0. By P8 for W , we have x ∼L d−1
hence d−1 ∈ Γ. Using P6 we have d = d−1 , hence d ∈ Γ. It remains to prove the
uniqueness of d. Let d′ , d′′ be elements of D ∩ Γ. We must prove that d′ = d′′ .
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                     47

Now d′ , d′′ belong to Γ̃ and, by 16.6, are in D̃. Using P13 for W̃ , it follows that
d′ = d′′ . Thus P13 holds for W .
Lemma 16.14. Let x, y ∈ W . We have x ∼L y (in W ) if and only if x ∼L y (in
W̃ ).

   If x ∼L y (in W ) then x ∼L y (in W̃ ), by 16.13(b).
   Assume now that x ∼L y (in W̃ ). Let d, d′ ∈ D be such that x ∼L d (in W )
and y ∼L d′ (in W ); see P13. By the ﬁrst line of the proof we have x ∼L d (in
W̃ ) and y ∼L d′ (in W̃ ). Hence d ∼L d′ (in W̃ ). Since d, d′ ∈ D̃, we deduce (using
P13 for W̃ ) that d = d′ . It follows that x ∼L y (in W ). The lemma is proved.
16.15. Proof of P9. We assume that z ′ ≤L z (in W ) and a(z ′ ) = a(z). By
16.13(a), it follows that z ′ ≤L z (in W̃ ) and, using 16.5, that ã(z ′ ) = ã(z). Using
now P9 in W̃ , it follows that z ′ ∼L z (in W̃ ). Using 16.14, we deduce that z ′ ∼L z
(in W ).
16.16. Now P10 is proved as in 14.10; P11 is proved as in 14.11; P14 is proved
as in 14.14.
16.17. Assuming that (W̃ , S̃) is tame, integral, P15 can be shown to hold in our
case. We sketch a proof which is almost (but not entirely) correct.
   The proof of P15 given in 14.15,15.7, can be reﬁned to a proof of the following
statement:
   For any w, y, x, x′ in W̃ and any k there exists a natural isomorphism of vector
spaces
                            j′              j      ∼                           j        j′
   ⊕j+j ′ =k ⊕y′ ∈W̃ Vw,x       ′ ,y ′ ⊗ Vx,y ′ ,y −
                                                   → ⊕j+j ′ =k ⊕y′ ∈W̃ Vx,w,y     ′ ⊗ Vy ′ ,x′ ,y .

When ã(w) = ã(y), this restricts to an isomorphism
             j′               j        ∼             j             j′
   ⊕y′ ∈W̃ Vw,x   ′ ,y ′ ⊗ Vx,y ′ ,y − → ⊕y′ ∈W̃ Vx,w,y     ′ ⊗ Vy ′ ,x′ ,y

for any j, j ′ such that j + j ′ = k.
Assuming now that w, y, x, x′ ∈ W and taking traces of σ in both sides, we deduce
   P                                               P
     y ′ ∈W πj (hw,x ,y )πj (hx,y ,y ) =             y ′ ∈W πj (hx,w,y )πj (hy ,x ,y )
                ′         ′ ′             ′                                ′ ′   ′ ′


(the summands corresponding to y ′ ∈ W̃ − W do not contibute to the trace) or
equivalently
              ′                                             ′
   P                                   P
     y ′ ∈W hw,x′ ,y ′ hx,y ,y =          y ′ ∈W hx,w,y hy ′ ,x′ ,y ,
                              ′                           ′

as required. (The actual proof is slightly more complicated since the direct sum
decompositions are not natural, only certain ﬁltrations attached to them are.)

                    17. Example: the infinite dihedral case
17.1. In this section we preserve the setup of 7.1. We assume that m = ∞ and
that L2 > L1 . We will show that P1-P15 hold in this case.
   Let ζ = v L2 −L1 + v L1 −L2 . For a ∈ {1, 2}, let fa = v La + v −La . For m, n ∈ Z
we deﬁne δm<n to be 1 if m < n and to be 0 otherwise.
48                                           G. LUSZTIG

17.2. From 7.5, 7.6 we have for all k ′ ∈ N:
  c1 c2k′ = c1k′ +1 ,
  c2 c1k′ = c2k′ +1 + δk′ >1 ζc2k′ −1 + δk′ >3 c2k′ −3 .
                                  ′
Proposition 17.3. For P k ≥ 0, k ≥ 1 we have
  (a) c22k+1 c2k′ = f2 u∈[0,k];2u≤k′ −1 c22k+k′ −4u ,
                      P
  (b) c12k+2 c2k′ = f2 u∈[0,k];2u≤k′ −1 c12k+k′ +1−4u .
  Assume that k = 0. Using 17.2 we have c2 c2k′ = f2 c2k′ .
  Assume now that k = 1. Using 17.2, we have c23 = c2 c1 c2 − ζc2 . Using this
and 17.2, we have

       c23 c2k′ = c2 c1 c2 c2k′ − ζc2 c2k′ = f2 c2 c1k′ +1 − f2 ζc2k′
        = f2 c2k′ +2 + f2 ζc2k′ + δk′ >2 f2 c2k′ −2 − f2 ζc2k′ = f2 c2k′ +2 + δk′ >2 f2 c2k′ −2 ,

as required. We prove the equality in (a) for ﬁxed k ′ , by induction on k. The
cases k = 0, 1 are already known. If k = 2 then using 17.2, we have c25 =
c2 c1 c23 − ζc23 − c21 . Using this, 17.2, and the induction hypothesis, we have

  c25 c2k′ = c2 c1 c23 c2k′ − ζc23 c2k′ − c21 c2k′
   = f2 c2 c1 c2k′ +2 + δk′ >2 f2 c2 c1 c2k′ −2 − ζf2 c2k′ +2 − δk′ >2 ζf2 c2k′ −2 − f2 c2k′
     = f2 c2 c1k′ +3 + δk′ >2 f2 c2 c1k′ −1 − ζf2 c2k′ +2 − δk′ >2 ζf2 c2k′ −2 − f2 c2k′
     = f2 c2k′ +4 + f2 ζc2k′ +2 + f2 c2k′ + δk′ >2 f2 c2k′ + δk′ >2 f2 ζc2k′ −2 + δk′ >4 f2 c2k′ −4
     − ζf2 c2k′ +2 − δk′ >2 ζf2 c2k′ −2 − f2 c2k′ = f2 c2k′ +4 + δk′ >2 f2 c2k′ + δk′ >4 f2 c2k′ −4 ,

as required. A similar argument applies for k ≥ 3. This proves (a).
   (b) is obtained by multiplying both sides of (a) by c1 on the left. The proposition
is proved.
Proposition 17.4.PFor k ≥ 0, k ′ ≥ 1, we have
  (a) c22k+1 c1k′ = u∈[0,2k+2] pu c2k′ +2k+1−2u ,
                     P
  (b) c12k+2 c1k′ = u∈[0,2k+2] pu c1k′ +2k+2−2u ,
                     P
  (c) c1−1′ c22k+1 = u∈[0,2k+2] pu c2−1′              ,
         k           P                    k +2k+1−2u
  (d) c1−1′ c1−1 = u∈[0,2k+2] pu c1−1′                ,
         k     2k+2                        k +2k+1−2u
                     P
  (e) c22k+2 c1k′ = u∈[0,2k+2] f1 pu c2k′ +2k+1−2u ,
                     P
  (f ) c12k+3 c1k′ = u∈[0,2k+2] f1 pu c1k′ +2k+2−2u ,
  (g) c11 c1k′ = f1 c1k′ ,
where
  p0 = 1, p2k+2 = δk′ >2k+3 ,
  pu = δk′ >u ζ for u = 1, 3, 5, . . . , 2k + 1,
  pu = δk′ >u−1 + δk′ >u+1 for u = 2, 4, 6, . . . , 2k.
    We prove (a). For k = 0 the equality in (a) is c2 c1k′ = c2k′ +1 + δk′ >1 ζc2k′ −1 +
δk′ >3 c2k′ −3 which is contained in 17.2. Assume now that k = 1. Using c23 =
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                          49

c2 c1 c2 − ζc2 and 17.2, we have
c23 c1k′ = c2 c1 c2 c1k′ − ζc2 c1k′ = c2 c1 c2k′ +1 + δk′ >1 ζc2 c1 c2k′ −1 + δk′ >3 c2 c1 c2k′ −3
− ζc2k′ +1 − δk′ >1 ζ 2 c2k′ −1 − δk′ >3 ζc2k′ −3 = c2 c1k′ +2 + δk′ >1 ζc2 c1k′
+ δk′ >3 c2 c1k′ −2 − ζc2k′ +1 − δk′ >1 ζ 2 c2k′ −1 − δk′ >3 ζc2k′ −3
= c2k′ +3 + ζc2k′ +1 + δk′ >1 c2k′ −1 + δk′ >1 ζc2k′ +1 + δk′ >1 ζ 2 c2k′ −1 + δk′ >3 ζc2k′ −3
+ δk′ >3 c2k′ −1 + δk′ >3 ζc2k′ −3 + δk′ >5 c2k′ −5 − ζc2k′ +1 − δk′ >1 ζ 2 c2k′ −1 − δk′ >3 ζc2k′ −3
= c2k′ +3 + δk′ >1 ζc2k′ +1 + (δk′ >1 + δk′ >3 )c2k′ −1 + δk′ >3 ζc2k′ −3 + δk′ >5 c2k′ −5 ,
as required.
   We prove the equality in (a) for ﬁxed k ′ , by induction on k. The cases k = 0, 1
are already known. Assume now that k = 2. Using c25 = c2 c1 c23 − ζc23 − c21 ,
17.2, and the case k = 1, we have
c25 c1k′ = c2 c1 c23 c1k′ − ζc23 c1k′ − c21 c1k′
 = c2 c1 c2k′ +3 + δk′ >1 ζc2 c1 c2k′ +1 + (δk′ >1 + δk′ >3 )c2 c1 c2k′ −1 + δk′ >3 ζc2 c1 c2k′ −3
 + δk′ >5 c2 c1 c2k′ −5 − ζc2k′ +3 − δk′ >1 ζ 2 c2k′ +1 − (δk′ >1 + δk′ >3 )ζc2k′ −1
 − δk′ >3 ζ 2 c2k′ −3 − δk′ >5 ζc2k′ −5 − c2k′ +1 − δk′ >1 ζc2k′ −1 − δk′ >3 c2k′ −3
 = c2 c1k′ +4 + δk′ >1 ζc2 c1k′ +2 + (δk′ >1 + δk′ >3 )c2 c1k′ + δk′ >3 ζc2 c1k′ −2
 + δk′ >5 c2 c1k′ −4 − ζc2k′ +3 − δk′ >1 ζ 2 c2k′ +1 − (δk′ >1 + δk′ >3 )ζc2k′ −1
 − δk′ >3 ζ 2 c2k′ −3 − δk′ >5 ζc2k′ −5 − c2k′ +1 − δk′ >1 ζc2k′ −1 − δk′ >3 c2k′ −3
 = c2k′ +5 + ζc2k′ +3 + c2k′ +1 + δk′ >1 ζc2k′ +3 + δk′ >1 ζ 2 c2k′ +1 + δk′ >1 ζc2k′ −1
 + (δk′ >1 + δk′ >3 )c2k′ +1 + (δk′ >1 + δk′ >3 )ζc2k′ −1 + 2δk′ >3 c2k′ −3 + δk′ >3 ζc2k′ −1
 + δk′ >3 ζ 2 c2k′ −3 + δk′ >5 ζc2k′ −5 + δk′ >5 c2k′ −3 + δk′ >5 ζc2k′ −5 + δk′ >7 c2k′ −7
 − ζc2k′ +3 − δk′ >1 ζ 2 c2k′ +1 − (δk′ >1 + δk′ >3 )ζc2k′ −1 − δk′ >3 ζ 2 c2k′ −3 − δk′ >5 ζc2k′ −5
 − c2k′ +1 − δk′ >1 ζc2k′ −1 − δk′ >3 c2k′ −3
 = c2k′ +5 + δk′ >1 ζc2k′ +3 + (δk′ >1 + δk′ >3 )c2k′ +1 + δk′ >3 c2k′ −3 + δk′ >3 ζc2k′ −1
 + δk′ >5 c2k′ −3 + δk′ >5 ζc2k′ −5 + δk′ >7 c2k′ −7
 = c2k′ +5 + δk′ >1 ζc2k′ +3 + (δk′ >1 + δk′ >3 )c2k′ +1
 + δk′ >3 ζc2k′ −1 + (δk′ >3 + δk′ >5 )c2k′ −3 + δk′ >5 ζc2k′ −5 + δk′ >7 c2k′ −7 .

A similar argument applies for k ≥ 4. This proves (a).
   (b) is obtained by multiplying both sides of (a) by c1 on the left. (c),(d) are
obtained by applying the involution in 3.4 to both sides of (a),(b). We prove (e).
We have
   c22k+2 c1k′ = c22k+1 c1 c1k′ = f1 c22k+1 c1k′
and the last expression can be computed from (a). This proves (e). Similarly, (f)
follows from (b); (g) is a special case of 6.6. The proposition is proved.
50                                        G. LUSZTIG

17.5. From 7.4,7.6 we see that the function ∆ : W −               → N has the following values:
   ∆(22k ) = kL1 + kL2 ,
   ∆(22k+1 ) = −kL1 + (k + 1)L2 ,
   ∆(11 ) = L1 ,
   ∆(12k+1 ) = (k − 1)L1 + kL2 , if k ≥ 1,
   ∆(12k ) = kL1 + kL2 .
   It follows that P1 holds and that D consists of the involutions 20 = 10 , 21 , 11 , 13 .
Thus, P6 holds.
   The formulas in 17.3, 17.4 determine hx,y,z for all x, y, z except when x = 1 or
y = 1, in which case h1,y,z = δy,z , hx,1,z = δx,z . From these formulas we see that
the triples (x, y, d) with d ∈ D, γx,y,d 6= 0 are:
   (22k+1 , 22k+1 , 21 ), (12k+2 , 22k+2 , 13 ), (11 , 11 , 11 ),
   (1, 1, 1), (22k+2 , 12k+2 , 21 ),(12k+3 , 12k+3 , 13 ),
where k ≥ 0. This implies that P2,P3 hold. From the results in 8.8 we see that
P4,P9,P13 hold. From 14.5 we see that P5 holds. From 14.7 we see that P7 holds.
From 14.8 we see that P8 holds. From 14.10 we see that P10 holds. From 14.11
we see that P11 holds. From 14.12 we see that P12 holds. From 14.14 we see that
P14 holds.
   We now verify P15 in our case. With the notation in 14.15, it is enough to show
that, if a, b ∈ {1, 2}, w ∈ W , sa w > w, wsb > w, then

                             (ca ew )c′b − ca (ew c′b ) ∈ H̃≥a(w)+1 .
Here ca = csa , c′b = c′sb . If a or b is 1, then from 17.2 we have (ca ew )c′b −ca (ew c′b ) =
0. Hence we may assume that a = b = 2 and w = 12k+1 . Using 17.2 we have
          c2 (e12k+1 c′2 ) = c2 (e12k+2 + δk>0 )ζ ′ e12k + δk>1 e12k−2
             = e22k+3 + ζe22k+1 + δk>0 e22k−1 + δk>0 ζ ′ e22k+1 + δk>0 ζζ ′ e22k−1
             + δk>1 ζ ′ e22k−3 + δk>1 e22k−1 + δk>1 ζe22k−3 + δk>2 e22k−5
             = e22k+3 + ζe22k+1 + δk>0 ζ ′ e22k+1 + δk>0 e22k−1 + δk>1 e22k−1
             + δk>0 ζζ ′ e22k−1 + δk>1 (ζ + ζ ′ )e22k−3 + δk>2 e22k−5 .
Similarly,
     (c2 e12k+1 )c′2 = e22k+3 + ζ ′ e22k+1 + δk>0 ζe22k+1 + δk>0 )e22k−1 + δk>1 e22k−1
     + δk>0 ζζ ′ e22k−1 + δk>1 (ζ + ζ ′ )e22k−3 + δk>2 e22k−5 .
Hence
   c2 (e12k+1 c′2 ) − (c2 e12k+1 )c′2 = (ζ − ζ ′ )(1 − δk>0 )e22k+1 .
If k > 0, the right hand side is zero. Thus we may assume that k = 0. In this
case,
   c2 (e11 c′2 ) − (c2 e11 )c′2 = (ζ − ζ ′ )e21 .
We have a(11 ) = L1 < L2 = a(21 ). This completes the veriﬁcation of P15 in our
case.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                        51

                                 18. The ring J
18.1. In this section we assume that W is tame and that P1-P15 in §14 are valid.
  A reference for this section is [L4].
Theorem 18.2. (a) W has only finitely many left cells.
  (b) W has only finitely many right cells.
  (c) W has only finitely many two-sided cells.
  (d) D is a finite set.
   We prove (a). Since a(w) is bounded above it is enough to show that, for any
a ∈ N, a−1 (a) is a union of ﬁnitely many left cells. By P4, a−1 (a) is a union of
left cells. Let H1 be the Z-algebra Z ⊗A H where Z is regarded as an A-algebra
via v 7→ 1. We write cw instead of 1 ⊗ cw . For any a′ ≥ 0 let H≥a
                                                                 1
                                                                    ′ be the subgroup
      1                            ′                          1
of H spanned by {cw |a(w) ≥ a } (a two-sided ideal of H , by P4). We have a
direct sum decomposition
          1     1
   (e) H≥a  /H≥a+1   = ⊕Γ EΓ
where Γ runs over the left cells contained in a−1 (a) and EΓ is generated as a
group by the images of cw , w ∈ Γ; these images form a Z-basis of EΓ . Now
  1      1
H≥a  /H≥a+1    inherits a left H1 -module structure from H1 and (by P9) each EΓ
is a H1 -submodule. Since W is tame, there exists a ﬁnitely generated abelian
subgroup W1 of ﬁnite index of W . Now H1 = Z[W ] contains Z[W1 ] as a subring.
          1     1
Since H≥a   /H≥a+1    is a subquotient of H1 (a ﬁnitely generated Z[W1 ]-module)
                                                   1    1
and Z[W1 ] is a noetherian ring, it follows that H≥a /H≥a+1    is a ﬁnitely generated
Z[W1 ]-module. Hence in the direct sum decomposition (e) with only non-zero
summands, the number of summands must be ﬁnite. This proves (a).
   Since any right cell is of the form Γ−1 where Γ is a left cell, we see that (b)
follows from (a). Since any two-sided cell is a union of left cells, we see that (c)
follows from (a). From P16 we see that (d) follows from (a). The theorem is
proved.
18.3. Let J be the free abelian group with basis (tw )w∈W . We deﬁne
                                      X
                              tx ty =   γx,y,z−1 tz .
                                      z∈W

The sum is ﬁnite since γx,y,z−1 6= 0 =⇒ hx,y,z 6= 0 and this implies that z runs
through a ﬁnite set (for ﬁxed x, y). We show that this deﬁnes an (associative) ring
structure on J. We must check the identity
                    X                        X
(a)                     γx,y,z−1 γz,u,u′−1 =   γy,u,w−1 γx,w,u′−1
                     z                      w

for any x, y, u, u′ ∈ W . From P8,P4 we see that both sides of (a) are 0 unless
   (b) a(x) = a(y) = a(u) = a(u′ ) = a
for some a ∈ N. Hence we may assume that (b) holds. By P8,P4, in the ﬁrst sum
52                                   G. LUSZTIG

in (a) we may assume that a(z) = a and in the second sum in (a) we may assume
that a(w) = a. The equation (cx cy )cu = cx (cy cu ) in H implies
                      X                   X
(c)                      hx,y,z hz,u,u′ =     hy,u,w hx,w,u′ .
                          z                  w

If hx,y,z hz,u,u′ 6= 0 then u′ ≤R z ≤R x hence, by P4, a(u′ ) ≥ a(z) ≥ a(x) and
a(z) = a. Hence in the ﬁrst sum in (c) we may assume that a(z) = a. Similarly
in the second sum in (c) we may assume that a(w) = a. Taking the coeﬃcient of
v 2a(z) in both sides of (c) we ﬁnd (a).
                                      P
    The ring J has a unit element d∈D nd td . Here nd = ±1 is asP       in 14.1(a), see
P5. (The sum is well deﬁned by 18.2(d).) P       Let us check that tx d td = tx for
x ∈ W . This P    is equivalent to the identity d nd γx,d,z−1 = δz,x . By P7 this is
equivalent
 P           to d nd γz−1 ,x,d = δz,x . This follows from P2,P3,P5. The equality
( d td )tx = tx is checked in a similar way.
    For any subset X of W , let J X be the subgroup of J generated by {tx |x ∈ X}.
If c is a two-sided cell of W, L then, by P8, J c is a subring of J and JP  = ⊕c J c is
                                                                      c
a direct sum decomposition of J as a ring. The unit element of J is d∈D∩c td .
                                                 −1
Similarlym if Γ is a left cell of W, L then J Γ∩Γ is a subring of J with unit element
td where d ∈ D ∩ Γ.
Proposition 18.4. Assume that we are in the setup of 15.1. Let x, y ∈ W .
   (a) The condition x ∼L y is equivalent to the condition that tx ty−1 6= 0 and to
the condition that, for some u, ty appears with 6= 0 coefficient in tu tx .
   (b) The condition x ∼R y is equivalent to the condition that tx−1 ty 6= 0 and to
the condition that, for some u, ty appears with 6= 0 coefficient in tx tu .
   (c) The condition x ∼LR y is equivalent to the condition that tx tu ty 6= 0 for
some u and to the condition that, for some u, u′ , ty appears with 6= 0 coefficient
in tu′ tx tu .
   Let J + = z Ntz . By 15.1(a) we have J + J + ⊂ J + .
                P
   We prove (a). The second condition is equivalent to γx,y−1 ,u 6= 0 for some u;
the third condition is equivalent to γx,u,y−1 6= 0 for some u. These conditions are
equivalent by P7.
   Assume that γx,y−1 ,u 6= 0 for some u. Using P8 we deduce that x ∼L y.
   Assume now that x ∼L y. Let d ∈ D be such that x ∼L d. Then we have also
y ∼L d. By P13 we have γx−1 ,x,d 6= 0, γy−1 ,y,d 6= 0. Hence γx−1 ,x,d = 1, γy−1 ,y,d =
1. Hence tx−1 tx ∈ td + J + , ty−1 ty ∈ td + J + . Since td td = td , it follows that
tx−1 tx ty−1 ty ∈ td td + J + = td + J + . In particular, tx ty−1 6= 0. This proves (a).
   The proof of (b) is entirely similar.
   We prove (c). Using the associativity of J we see that the third condition on x, y
is a transitive relation on W . Hence to prove that the ﬁrst condition implies the
third condition we may assume that either x ∼L y or x ∼R y, in which case this
follows from (a) or (b). The fact that the third condition implies the ﬁrst condition
also follows from (a),(b). Thus the ﬁrst and third condition are equivalent.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                                                    53

    Assume that tx tu ty 6= 0 for some u. By (a),(b) we then have x ∼L u−1 , u−1 ∼R
y. Hence x ∼LR y.
    Conversely, assume that x ∼LR y. Using P14 we deduce that x ∼LR y −1 . By
the earlier part of the proof, ty−1 appears with 6= 0 coeﬃcient in tu′ tx tu for some
u, u′ . We have tu′ tx tu ∈ aty−1 + J + where a > 0. Hence tu′ tx tu ty ∈ aty−1 ty + J + .
Since ty−1 ty has a coeﬃcient 1 and the other coeﬃcients are ≥ 0, it folows that
tu′ tx tu ty 6= 0. Thus, tx tu ty 6= 0. We see that the ﬁrst and second conditions are
equivalent. The proposition is proved.
18.5. Assume now that we are in the setup of 7.1 with m = ∞ and L2 > L1 .
From the formulas in 17.3,17.4 we can determine the multiplication table of J. We
ﬁnd                   P
   t22k+1 t22k′ +1 = u∈[0,k̃] t22k+2k′ +1−4u ,
                      P
   t12k+3 t12k′ +3 = u∈[0,k̃] t12k+2k′ +3−4u ,
                      P
   t22k+1 t22k′ +2 = u∈[0,k̃] t22k+2k′ +2−4u ,
                      P
   t12k+3 t12k′ +2 = u∈[0,k̃] t12k+2k′ +2−4u ,
                      P
   t22k+2 t12k′ +3 = u∈[0,k̃] t22k+2k′ +2−4u ,
                      P
   t22k+2 t12k′ +2 = u∈[0,k̃] t22k+2k′ +1−4u ,
                      P
   t12k+2 t22k′ +1 = u∈[0,k̃] t12k+2k′ +2−4u ,
                      P
   t12k+2 t22k′ +2 = u∈[0,k̃] t12k+2k′ +3−4u ,
   t1 1 t1 1 = t1 1 ,
   t1 t1 = t1 ;
here k, k ′ ≥ 0 and k̃ = min(k, k ′ ). All other products are 0.
   Let R be the free abelian group with basis (bk )k∈N . We regard R as a commu-
tative ring P  with multiplication
   bk bk′ = u∈[0,min(k,k′ )] bk+k′ −2u .
             P
Let J0 = w∈W −{1,11 } Ztw . The formulas above show that J = J0 ⊕ Zt1 ⊕ Zt11
(direct sum of rings) and that the ring J0 is isomorphic to the ring of 2×2 matrices
with entries in R, via the isomorphism deﬁned by:
                                                                                                               
                  bk 0                           0 0                            0 bk                            0 0
  t22k+1 7→        0 0
                             ,   t12k+3 7→       0 bk
                                                            ,   t22k+2 7→       0 0
                                                                                           ,   t12k+2 7→       bk 0
                                                                                                                          .

Note that R is canonically isomorphic to the representation ring of SL2 (C) with
its canonical basis consisting of irreducible representations.
18.6. Assume that we are in the setup of 7.1 with m = ∞ and L2 = L1 . By
methods similar (butP simpler) to those of §17 and 18.5, we ﬁnd
   t22k+1 t22k′ +1 = u∈[0,2 min(k,k′ )] t22k+2k′ +1−2u .
Let J 1 be the subring of J generated by t22k+1 , k ∈ N. While, in 18.5, the analogue
of J 1 was isomorphic to R as a ring with basis, in the present case, J 1 is canonically
isomorphic to R′ , the subgroup of R generated by bk with k even. (Note that R′
is a subring of R, naturally isomorphic to the representation ring of P GL2 (C).)
54                                             G. LUSZTIG

18.7. In the setup of 7.1 with m = 4 and L2 = 2, L1 = 1 (a special case of the
situation in §15), we have
   J = Zt1 ⊕ Zt11 ⊕ J0 ⊕ Zt23 ⊕ Zt24
(direct sum of rings) where J0 is the subgroup of J generated by t21 , t22 , t12 , t13 .
The ring J0 is isomorphic to the ring of 2 × 2 matrices with entries in Z, via the
isomorphism deﬁned by:
                                                           
           t21 7→ 10 00 , t13 7→ 00 01 , t22 7→ 00 10 , t12 7→ 01 00 .

Moreover, t1 , t11 , t24 are idempotent. On the other hand,
  t23 t23 = −t23 .
Notice the minus sign! (It is a special case of the computation in ....)
18.8. For any z ∈ W we set n̂z = nd where d is the unique element of D such
that d ∼L z −1 and nd = ±1 is as in 14.1(a), see P5. Note that z 7→ n̂z is constant
on right cells.
Theorem 18.9. Let JA = A ⊗ J and let φ : H − → JA be the A-linear map given
by
   φ(c†x ) = z∈W,d∈D;a(d)=a(z) hx,d,z n̂z tz
            P

for all x ∈ W . Then φ is a homomorphism of A-algebras with 1.
   Consider  the equality
   (a) w hx1 ,x2 ,w h′w,x3 ,y = w hx1 ,w,y h′x2 ,x3 ,w
       P                       P
(see P15) with a(x2 ) = a(y) = a. In the left hand side we may assume that
y ≤R w ≤L x2 hence (by P4) a(y) ≥ a(w) ≥ a(x2 ), hence a(w) = a. Similarly in
the right hand side we may assume that a(w) = a. Picking the coeﬃcient of v ′a
in bothPsides of (a) gives         P
   (b) w hx1 ,x2 ,w γw,x3 ,y−1 = w hx1 ,w,y γx2 ,x3 ,w−1 .
Let x, x′ ∈ W . The desired identity φ(c†x c†x′ ) = φ(c†x )φ(c†x′ ) is equivalent to
           X                              X
                 hx,x′ ,w hw,d,u n̂u =                 hx,d,z hx′ ,d′ ,z′ γz,z′ ,u−1 n̂z n̂z′
        w∈W,d∈D                               z,z ′ ∈W,d,d′ ∈D
         a(d)=a′                                 a(d)=a(z)
                                                a(d′ )=a(z ′ )

for any u ∈ W such that a(u) = a′ . In the right hand we may assume that
   a(d) = a(z) = a(d′ ) = a(z ′ ) = a′ and n̂z = n̂u
(by P8,P4). Hence the right hand side can be rewritten (using (b)):
                  X                         X
                                hx′ ,d′ ,z′      hx,d,z γz,z′ ,u−1 n̂u n̂z′
                 z ′ ∈W,d,d′ ∈D                   z;a(z)=a′
             a(d)=a(d′ )=a(z ′ )=a′
                           X                               X
              =                            hx′ ,d′ ,z′               hx,w,u γd,z′ ,w−1 n̂u n̂z′ .
                       ′       ′                         w;a(w)=a′
                      z ∈W,d,d ∈D
                  a(d)=a(d′ )=a(z ′ )=a′
          LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                              55

By P2,P3,P5, this equals
                                        X
                                                             hx′ ,d′ ,z′ hx,z′ ,u n̂u
                           z ′ ∈W,d′ ∈D;a(d′ )=a(z ′ )=a′


which by the identity (cx cx′ )cd′ = cx (cx′ cd′ ) equals
                                        X
                                                         hx,x′ ,w hw,d′ ,u n̂u .
                               w∈W,d′ ∈D;a(d′ )=a′


Thus φ is compatible with multiplication.
   Next we show that φ is compatible with the unit elements of the two algebras.
P equivalent statement is that for any z ∈ W such that a(z) = a, the sum
An
  d∈D;a(d)=a h1,d,z n̂z equals nz if z ∈ D and is 0 if z ∈
                                                         / D. This is clear since
h1,d,z = δz,d .
18.10. If we identify the A-modules H and JA via c†w 7→ n̂w tw , the obvious left
JA -module structure   on JA becomes the left JA -module structure on H given by
         †
   tx ∗ cw = z∈W γx,w,z−1 n̂w n̂z c†z
             P

Let Ha = ⊕w;a(w)=a Ac†w , H≥a = ⊕w;a(w)≥a Ac†w . Note that tx ∗ c†w ∈ Ha(w) for all
x, w. For any h ∈ H, w ∈ W we have
   (a) hc†w = φ(h) ∗ c†w mod H≥a(w)+1 .
Indeed, we may assume that h = c†x . Using 18.9(b), we have
                          X
     φ(c†x ) ∗ c†w =               hx,d,z n̂z tz ∗ c†w
                         d∈D,z
                       a(d)=a(z)
            X                                                      X
      =               hx,d,z γz,w,u−1 n̂z n̂w n̂u c†u =                         hx,d,z γz,w,u−1 n̂w c†u
           d∈D,z,u                                              d∈D,z,u
          a(d)=a(z)                                         a(d)=a(w)=a(u)
               X                                                   X
      =                     hx,t,u γd,w,t−1 n̂w c†u =                           hx,w,u γd,w,w−1 n̂w c†u
              d∈D,t,u                                           d∈D,u
          a(d)=a(w)=a(u)                                   a(d)=a(w)=a(u)
            X
      =               hx,w,u c†u = c†x c†w mod H≥a(w)+1 ,
              u
          a(w)=a(u)


as required.
18.11. Let A −  → R be a ring homomorphism of A into a commutative ring R
with 1. Let HR = R ⊗A H, JR = R ⊗A (JA ) = R ⊗ J, HR,≥a = R ⊗A H≥a . Then
φ extends to a homomorphism of R-algebras φR : HR −   → JR . The JA -module in
18.10 extends to a JA -module structure on HR denoted again by ∗. From 18.10(a)
we deduce
   (a) hc†w = φR (h) ∗ c†w mod HR,≥a(w)+1 for any h ∈ HR , w ∈ W .
56                                     G. LUSZTIG

Proposition 18.12. (a) If N is a bound for W, L, then (ker φR )N+1 = 0.
  (b) If R = R0 [v, v −1 ] where R0 is a commutative ring with 1, v is an indeter-
minate and A −
             → R is the obvious ring homomorphism, then ker φR = 0.
    We prove (a). If h ∈ ker φR then by 18.11(a), we have hHR,≥a ⊂ HR,≥a+1 for
any a ≥ 0. Applying this repeatedly, we see that, if h1 , h2 , . . . , hN+1 ∈ H, we have
h1 h2 . . . hN+1 ∈ HR,≥N+1 = 0. This proves (a).
    We prove (b). Let h = x px c†x ∈ ker φR where px ∈ R. Assume that h 6= 0.
                               P
Then px 6= 0 for some x. We can ﬁnd a ≥ 0 such that px 6= 0 =⇒ a(x) ≥ a
and X = {x ∈ W |px 6= 0, a(x) = a} is non-empty. We can ﬁnd b ∈ Z such that
px ∈ v b Z[v −1 ] for all x ∈ X and such that X ′ = {x ∈ X|πb (px ) 6= 0} is non-empty.
Let x0 ∈ X ′ . We can ﬁnd d ∈ D such that γx0 ,d,x−1 = γx−1 ,x0 ,d 6= 0. We have
                                                            0      0

hcd = x px cx cd . If a(x) > a, then cx cd ∈ HR,≥a+1 . Hence hc†d = x∈X px c†x c†d
   †             † †                          † †
         P                                                                  P

mod HR,≥a+1 . Since φR (h) = 0, from 18.11(a) we have hc†d ∈ mod HR,≥a+1 .
It follows that x∈X px c†x c†d ∈ HR,≥a+1 . In particular the coeﬃcient of c†x0 in
                   P
             † †                                                                    a+b
P                                        P
   x∈X px cx cd is 0. In other words,        x∈X px hx,d,x0 = 0. The coeﬃcient of v     in
the last sum is
    P
      x∈X πb (px )γx,d,x−10
                             = πb (px0 )γx0 ,d,x−1
                                                0
and this is on the one hand 0 and on the other hand is non-zero since πb (px0 ) 6= 0
and γx0 ,d,x−1 6= 0, by the choice of x0 , d. This contradiction completes the proof.
            0



                         19. Algebras with trace form
19.1. Let R be a ﬁeld and let A be an associative R-algebra with 1 of ﬁnite
dimension over R. We assume that A is semisimple and split over R and that we
are given a trace form on A that is, an R-linear map τ : A −     → R such that (a, a′ ) =
τ (aa′ ) = τ (a′ a) is a non-degenerate (symmetric) R-bilinear form (,):A × A −      → R.
                  ′ ′′         ′ ′′             ′ ′′
Note that (aa , a ) = (a, a a ) for all a, a , a in A. Let ModA be the category
whose objects are left A-modules of ﬁnite dimension over R. We write E ∈ IrrA
for ”E is a simple object of ModA”.
    Let (ai )i∈I be an R-basis of A and let (a′i )i∈I be the R-basis deﬁned by (ai , a′j ) =
δij . Then
    (a) i ai ⊗ a′i ∈ A ⊗ A is independent of the choice of (ai ).
        P

Proposition 19.2. (a) We have i τ (ai )a′i = 1.
                                       P

    (b) If E ∈ IrrA, then i tr(ai , E)a′i is in the centre of A. It acts on E as a
                             P
scalar fE ∈ R times the identity and on E ′ ∈ IrrA, not isomorphic to E, as zero.
Moreover, fE does not depend on the choice of (ai ).
    (c) One can attach uniquely to each E ∈ IrrA a scalar gE ∈ R (depending only
on the isomorphism class of E), so that
    P
       E gE tr(a, E) = τ (a) for all a ∈ A,
where the sum is taken over all E ∈ IrrA up to isomorphism.
    (d) For any E ∈ IrrA we have fE gE = 1. In particular, fE 6= 0, gE 6= 0.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                  57

   (e) If E, E ′ ∈ IrrA, then                       ′    ′
                                                              is fE dim E if E, E ′ are isomor-
                                P
                                    i tr(ai , E)tr(ai , E )
phic and is 0, otherwise.
    Let A = ⊕tn=1 An be the decomposition of A as a sum of simple algebras. Let
τ n : An −  → R be the restriction of τ . Then τn is a trace form for An , whose
associated form is the restriction of (, ) and (An , An′ ) = 0 for n 6= n′ . Hence
we can choose (ai ) so that each ai is contained in some An and then a′i will be
contained in the same An as a′i .
    We prove (a). From 19.1(a) we see that i τ (ai )a′i is independent of the choice
                                                 P
of (ai ). Hence we may choose (ai ) as in the ﬁrst paragraph of the proof. We are
thus reduced to the case where A is simple. In that case the assertion is easily
veriﬁed.
    We prove (b). From 19.1(a) we see that i tr(ai , E)a′i is independent of the
                                                  P
choice of (ai ). Hence we may choose (ai ) as in the ﬁrst paragraph of the proof.
We are thus reduced to the case where A is simple. In that case the assertion is
easily veriﬁed.
    We prove (c). It is enough to note that a 7→ tr(a, E) form a basis of the space
of R-linear functions A −   → R which vanish on all aa′ − a′ a and τ is such a function.
    We prove (d). We consider the equation in (c) for a = ai and we multiply both
            ′
sides
    P byPai and sum over     i.PUsing (a), we obtain
                          ′               ′
                 P i , E)ai = ′ i τ (ai )ai = 1.
       i PE gE tr(a
Hence E gE i tr(ai , E)ai = 1. By (b), the left hand side acts on a E ′ ∈ IrrA
as a scalar gE ′ fE ′ times the identity. This proves (d).
    (e) follows immediately from (b). The proposition is proved.
19.3. Now let A′ be a semisimple subalgebra of A such that τ ′ , the restriction of
τ to A′ is a trace form of A′ . (We do not assume that the unit element 1A′ of A′
coincides to the unit element 1 of A.) If E ∈ ModA then 1A′ E is naturally an
object of ModA′ . Hence if E ′ ∈ IrrA′ , then the multiplicity [E ′ : 1A′ E] of E ′ in
1A′ E ′ is well deﬁned.
   Note that, if a′ ∈ A′ , then tr(a′ , 1A′ E) = tr(a′ , E).
Lemma P 19.4. Let E ′ ∈ IrrA′ . We have
  gE ′ = E [E ′ : 1A′ E]gE ,
sum over all E ∈ IrrA (up to isomorphism).
   By the
      P deﬁnition        of gE ′ , it is enough to show that
   (a) E ′ E [E : 1′ E]gE tr(a′ , E ′ ) = τ (a′ )
                    ′
           P
for any a′ ∈ A′ . Here E ′ (resp. E) runs over the isomorphism classes of simple
objects
   P of P  ModA′ (resp. ModA). The             Pleft hand′ of′ (a) is P
                  ′       ′        ′     ′                                      ′
     E Eg   E′ [E     : 1   E]tr(a   , E   ) =  E gE tr(a , 1 E) =     E gE tr(a , E)
which, by the deﬁnition of gE is equal to τ (a′ ). This completes the proof.

                                20. The function aE
20.1. In this section we assume that the assumptions of 18.1 hold and that W is
ﬁnite.
58                                   G. LUSZTIG

   The results of §19 will be applied in the following cases.
   (a) A = HC , R = C. Here A −       → C takes v to 1. We identify HC with the group
algebra C[W ] by w 7→ Tw for all w. It is well known that C[W ] is a semisimple
split algebra. We take τ so that τ (x) = δx,1 for x ∈ W . Then the bases (x) and
(x−1 ) are dual with respect to (, ).
   We will say W -module instead of C[W ]-module. We will write ModW, IrrW
instead of ModC[W ], IrrC[W ].
   (b) A = JC , R = C. Since C[W ] is semisimple, we see from 18.12(a) that the
kernel of φC : C[W ] −  → JC is 0 so that φC is injective. Since dim C[W ] = dim JC =
♯W it follows that φC is an isomorphism. In particular JC is a semisimple split
algebra. We take τ : JC −    → C so that τ (tz ) is nz if z ∈ D and 0, otherwise. Then
(tx , ty ) = δxy,1 . The bases (tx ) and (tx−1 ) are dual with respect to (, ).
   (c) A = HC(v) , R = C(v). Here A −         → C takes v to v. The homomorphism
φC(v) : HC(v) −   → JC(v) is injective. This follows from 18.12(b), using the fact that
injectivity is preserved by tensoring with a ﬁeld of fractions. Since HC(v) , JC(v)
have the same dimension, it follows that φC(v) is an isomorphism. Since JC(v) =
C(v) ⊗ JC , and JC is semisimple, split, it follows that JC(v) is semisimple, split,
hence HC(v) is semisimple, split. We take τ : HC(v) so that τ (Tw ) = δw,1 . The
bases (Tx ) and (Tx−1 ) are dual with respect to (, ).
   Remark. The argument above shows also that,
   (d) if R = R0 (v), with R0 an arbitrary ﬁeld and A −       → R carries v to v, then
φR : HR −   → JR is an isomorphism;
   (e) if R in 18.11 is a ﬁeld of characteristic 0 then φR : HR −   → JR is an isomor-
phism if and only if HR is a semisimple R-algebra.
20.2. For any E ∈ ModW we denote by E♠ the corresponding JC -module. Thus,
E♠ coincides with E as a C-vector space and the action of j ∈ JC on E♠ is the
same as the action of φ−1
                        C (j) on E. The JC -module structure on E♠ extends in a
natural way to a JC(v) -module structure on Ev = C(v)⊗C E♠ . We will also regard
                                                                   ∼
Ev as an HC(v) -module via the algebra isomorphism φC(v) : HC(v) −→ JC(v) . If E
is simple, then E♠ and Ev are simple.
                                        c
    If E ∈ IrrW . Then E♠ is a simple JC  -module for a unique two-sided cell c of
W . Then for any x ∈ c, we write E ∼LR x. If E, E ′ ∈ IrrW , we write E ∼LR E ′
if for some x ∈ W we have E ∼LR x,E ′ ∼LR x.
20.3. There is the following direct relationship between E and Ev (without going
through J):
   (a) tr(x, E) = tr(Tx , Ev )|v=1 for all x ∈ W .
                                          †        †
Indeed,
   P it is enough to show that tr(cx , E) = tr(cx , Ev )|v=1 . Both sides are equal
to z∈W,d∈D γx,d,z−1 n̂z tr(tz , E♠ ).

20.4. Assume that E ∈ IrrW . We have
   (a) (fEv )v=1 dim(E) =P|W |.
Indeed, setting v = 1 in x∈W tr(Tx , Ev )tr(Tx−1 , Ev ) = fEv dim(E) gives
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                59

          tr(x, E)tr(x−1 , E) = (fEv )v=1 dim(E).
   P
     x∈W
The left hand side equals |W |; (a) follows.
20.5. Let I ⊂ S, let E ′ ∈ IrrWI and let E ∈ IrrW . We have
  (a) [Ev′ : Ev ] = [E ′ : E].
The right hand side is |WI |−1 x∈WI tr(x, E ′ )tr(x−1 , E). The left hand side is
                                P
                                     X
                     fE−1       ′ −1
                         ′ dim(E )
                         v
                                       tr(Tx , Ev′ )tr(Tx−1 , Ev ).
                                         x∈WI

Since this is a constant,Pit is equal to its value for v = 1. Hence it is equal to
   (fE−1            ′ −1
       ′ )v=1 dim(E )
       v
                                         ′
                           x∈WI tr(x, Ev )tr(x
                                               −1
                                                  , Ev ).
Thus it is enough to show that (fEv )v=1 dim(E ′ ) = |WI |. But this is a special case
                                     ′

of 20.4(a).
Proposition 20.6. Let E ∈ IrrW .
   (a) There exists a unique integer aE ≥ 0 such that tr(Tx , Ev ) ∈ v −aE C[v] for
                           / v −aE +1 C[v] for some x ∈ W .
all x ∈ W and tr(Tx , Ev ) ∈
   (b) For x ∈ W we have tr(Tx , Ev ) = sgn(x)v −aE tr(tx , E♠ ) mod v −aE +1 C[v].
                                                        c
   (c) Let c be the two-sided cell such that E♠ ∈ IrrJC   . Then aE = a(x) for any
x ∈ c.
   Let a = a(x)P     for any x ∈ c. By deﬁnition,
        †
   tr(cx , Ev ) = z∈W,d∈D;a(d)=a(z) hx,d,z n̂z tr(tz , E♠ ).
In the last sum we have tr(tz , E♠ ) = 0 unless z ∈ c in which case a(z) = a. For
such z we have hx,d,z = h̄x,d,z = γx,d,z−1 v −a mod v −a+1 Z[v], hence we have
   tr(c†x , Ev ) = z∈W,d∈D γx,d,z−1 n̂z v −a tr(tz , E♠ ) mod v −a+1 C[v].
                    P
                                             P
For each z in the last sum we have d∈D γx,d,z−1 n̂z = δx,z nd n̂z = δx,z . From this
we deduce that
   (d) tr(c†x , Ev )P= v −a tr(tx , E♠ ) mod v −a+1 C[v].
                              ′
                                  cy . Hence sgn(x)T̄x = Tx† = y;y≤x qy,x ′
                                                                             c†y . Applying ¯
                                                                  P
We have Tx = y;y≤x qy,x
                                       ′
                                          c†y . Hence
                           P
we obtain sgn(x)Tx = y;y≤x q̄y,x
                                       ′
                                          tr(c†y , Ev ).
                           P
   tr(Tx , Ev ) = sgn(x) y;y≤x q̄y,x
                                ′           ′
Using (d) together with q̄x,x        = 1, q̄y,x ∈ vZ[v] (see 10.1), we deduce
   tr(Tx , Ev ) = sgn(x)v tr(tx , E♠ ) mod v −a+1 C[v].
                            −a

Since E♠ ∈ IrrJC , we have tr(tx , E♠ ) 6= 0 for some x ∈ W . The proposition
follows.
Corollary 20.7. fEv = fE♠ v −2aE + strictly higher powers of v.
   Using 19.2(e) for HC(v) and JC , we obtain
                            X
                fEv dim E =     tr(Tx , Ev )tr(Tx−1 , Ev )
                                    x
                              X
                       −2aE
                  ∈v               tr(tx , E♠ )tr(tx−1 , E♠ ) + v −2aE +1 C[v]
                               x
                       −2aE
                  =v          fE♠ dim E + v −2aE +1 C[v].
60                                       G. LUSZTIG

The corollary follows.

   Let ¯: C[v, v −1 ] −
                      → C[v, v −1 ] be the C-algebra homomorphism given by v n 7→
v −n for all n.

Corollary 20.8. For any x ∈ W we have Tr(Tx−1
                                            −1 , Ev ) = tr(Tx , Ev ).


                                       ′
                                           c†y , Tx−1                   ′    †
                              P                                 P
     We have Tx = sgn(x) y;y≤x q̄y,x                −1 = sgn(x)  y;y≤x qy,x cy , hence
                                    ′
                                         tr(c†y , Ev ),
                           P
     tr(Tx , Ev ) = sgn(x) y;y≤x q̄y,x
     tr(Tx−1                            ′         †
                              P
           −1 , Ev ) = sgn(x)   y;y≤x qy,x tr(cy , Ev ).

Thus, it suﬃces to show that Tr(c†y , Ev ) = tr(c†y , Ev ) for any y ∈ W . As in the
proof of 20.6 we have
   tr(c†y , Ev ) = z∈W,d∈D;a(d)=a(z) hy,d,z n̂z tr(tz , E♠ ).
                  P

Hence it suﬃces to show that hy,d,z = hy,d,z for all d, z in the last sum. But this
is clearly true for any y, d, z in W .

   For any E ∈ ModW we write E † instead of E ⊗ sgn. We write Ev† instead of
(E † )v

Lemma 20.9. Let E ∈ IrrW . For any x ∈ W we have
  tr(Tx , (E † )v ) = (−1)l(x) tr(Tx , Ev )
     †
    :H−  → H (see 3.5) extends uniquely to a C(v)-algebra involution † : HC(v) −
                                                                               →
                 †
HC(v) . Let (Ev ) be the HC(v) -module with underlying vector space Ev such that
the action of h on Ev† is the same as the action of h† on Ev . Clearly, (Ev )† ∈
IrrHC(v) . For x ∈ W we have
  tr(Tx , (Ev )† ) = (−1)l(x) tr(Tx−1
                                    −1 , Ev ) = (−1)
                                                     l(x)
                                                          tr(Tx , Ev ).
(The last equation follows from 20.8.) Setting v = 1 we obtain
  tr(Tx , (Ev )† )|v=1 = (−1)l(x) tr(x, E) = tr(x, E † ).
Using 20.3, we deduce that (Ev )† ∼     = Ev† in ModHC(v) . The lemma follows.

Proposition 20.10. For any x ∈ W we have
                                †
  tr(Tx , Ev ) = v aE† tr(tx , E♠ ) + strictly lower powers of v.

     Using 20.9 and 20.6 we have

     tr(Tx , Ev ) = sgn(x)tr(Tx , Ev† ) = v −aE† tr(tx , E♠
                                                          †
                                                            ) + strictly higher powers of v
                      †
     = v aE† tr(tx , E♠ ) + strictly lower powers of v.

The proposition is proved.

Corollary 20.11. fEv = fE † v 2aE† + strictly lower powers of v.
                                  ♠
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                      61

   Using 20.10 we have
                                    X
                  fEv dim E =             tr(Tx , Ev )tr(Tx−1 , Ev )
                                      x
                                             †             †
                                X
                        2aE †
                   ∈v               tr(tx , E♠ )tr(tx−1 , E♠ ) + v 2aE† −1 C[v −1 ]
                                x
                        2aE †
                    fE † dim E + v 2aE† −1 C[v −1 ].
                   =v
                      ♠


Lemma 20.12. Let E ′ ∈ IrrWI . We have gEv′ = E;E∈IrrW [E ′ : E]gEv .
                                                 P

   We apply 19.4 with A = HC(v) and A′ the analogous algebra for WI instead of
W , identiﬁed naturally with a subspace of A. (In this case the unit elements of
the two algebras are compatible hence 1A′ Ev = Ev .) It remains to use 20.5(a).
Lemma 20.13. Let E ∈ IrrW .
  (a) For any x ∈ W , tr(tx−1 , E♠ ) is the complex conjugate of tr(tx , E♠ ).
  (b) fE♠ is a strictly positive real number.
    We prove (a). Let h, i be a positive deﬁnite hermitian form on E. We deﬁne
h, i′ : E♠ × EP   ♠ −→ C by
    he, e i = z∈W htz e, tz e′ i.
          ′ ′

This is again a positive deﬁnite hermitian form on E♠ . We show that
    htx e, e′ i′ = he, tx−1 e′ i′
forP all e, e′ . This is equivalent   Pto
                                 ′                                 ′
        y,z γz,x,y −1 hty e, tz e i =  y,z γy,x−1 ,z −1 hty e, tz e i
which follows from γz,x,y−1 = γy,x−1 ,z−1 . We see that tx−1 is the adjoint of tx with
respect to a positive deﬁnite hermitian form. (a) follows.            P
    We prove (b). By 19.2(e) we have fE♠ dim(E) =                      x tr(tx , E♠ )tr(tx−1 , E♠ ).
The right hand side of this equality is a real number ≥ 0, by (a). Hence so is the
left hand side. Now fE♠ 6= 0 by 19.2(d) and (b) follows.
Proposition 20.14. Let E ′ ∈ IrrWI .
   (a) For any E ∈ IrrW
                      P such  that [E ′ : E] 6= 0 we have aE ′ ≤ aE .
                          ′
   (b) We have gE♠
                 ′ =    [E : E]gE♠ , sum over all E ∈ IrrW (up to isomorphism)
such that aE = aE ′ .
   Let X be the set of all E (up to isomorphism) such that [E ′ : E] 6= 0 and such
that aE is minimum, say equal to a. Assume ﬁrst that a < aE ′ .
   Using 19.2(d) we  P rewrite   20.12 in the form
         −2a −1
   (c) v     fE ′ = E [E : E]v −2a fE−1
                           ′
                                           v
                                             .
               v
By 20.7, we have
   (d) (v −2aE fE−1
                  v
                    )|v=0 = fE−1 ♠
                                   , (v −2aE′ fE−1          −1
                                                 ′ )|v=0 = fE ′ ,
                                                 v           ♠
hence by   setting  v = 0 in   (c) we   obtain
   0 = E∈X [E ′ : E]fE−1
        P
                           ♠
                             .
The right hand side is a real number > 0 by 20.8(b). This is a contradiction. Thus
we must have a ≥ aE ′ and (a) is proved.
62                                  G. LUSZTIG

  We now rewrite (c)P in the form
        −2aE ′ −1
  (e) v       fE ′ = E [E : E]v −2aE′ fE−1
                          ′
                                         v
                                           .
                v
Using (d) P
          and (a) we see that, setting v = 0 in (e) gives
  fE ′ = E;aE =aE′ [E ′ : E]fE−1
    −1
                               ♠
                                 .
     ♠
This proves (b).
20.15. Let K(W ) be the C-vector space with basis indexed by the E ∈ IrrW (up
                                                                        P
to isomorphism). If Ẽ ∈ ModW we identify Ẽ with the element E [E : Ẽ]E ∈
K(W ) (E as above).
   We deﬁne a C-linear map jW        WI : K(WI ) −   → K(W ) by
    W      ′              ′
                  P
   jWI (E ) = E [E : E]E,
sum over all E ∈ IrrW (up to isomorphism) such that aE = aE ′ ; here E ′ ∈ IrrWI .
We call this truncated induction.
   Let I ′′ ⊂ I ′ ⊂ S. We show that the following transitivity formula holds:
                WI ′
   (a) jW                W
          WI ′ jWI ′′ = jWI ′′ : K(WI ′′ ) −
                                           → K(W ).
       ′′
Let E ∈ IrrWP        I . We must show that
                      ′′

   [E ′′ : E] = E ′ ;aE′ =aE′′ [E ′′ : E ′ ][E ′ : E]
for any E ′′ ∈ IrrWI ′′ , E ∈ IrrW such that aE ′′ = aE ; in the sum we have E ′ ∈
IrrWI ′ . It is clear
                  P that
   [E ′′ : E] = E ′ [E ′′ : E ′ ][E ′ : E].
Hence it is enough to show that, if [E ′′ : E ′ ][E ′ : E] 6= 0, then we have automat-
ically aE ′ = aE ′′ . By 2.10(a) we have aE ′′ ≤ aE ′ ≤ aE . Since aE ′′ = aE , the
desired conclusion follows.

         P any x ∈ W deﬁne
20.16. For
   γx = E;E∈IrrW tr(tx , E♠ )E ∈ K(W ).
We sometimes write γxW instead of γx , to emphasize dependence on W .
   Note that γx is a C-linear combination of E such that E ∼LR x. Hence, if
E, E ′ appear with 6= 0 coeﬃcient in γx then E ∼LR E ′ .
Proposition 20.17. If x ∈ WI , then γxW = jW    WI
                                           WI (γx ).

   An equivalent statement     is
                                            ′
                                              )[E ′ : E]
                     P
   (a) tr(tx , E♠ ) = E ′ ;aE =aE′ tr(tx , E♠
                                               ′
for any E ∈ IrrW ; in the
                        Psum we haveaEE ∈ IrrW′ I . Clearly,     we have
   (b) v tr(Tx , Ev ) = E ′ ;E ′ ∈IrrWI v tr(Tx , Ev )[E ′ : E].
        aE

In the right hand side we may assume that aE ′ ≤ aE . Using this and 20.6, we see
that setting v = 0 in (b) gives (a). The proposition is proved.
Lemma 20.18. (a) We have asgn = L(w0 ).
  (b) We have fsgn♠ = 1.
  (c) We have γw0 = sgn.
   sgnv is the one dimensional HC(v) -module on which Tx acts as sgn(x)v −L(x) .
(This follows from 20.3.) From 20.6(b) we see that asgn = L(w0 ) and that
tr(tw0 , sgn♠ ) = 1. This proves (a).
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                           63

   To prove (c) it remains to show that, if tr(tw0 , E♠ ) 6= 0 (E simple) then E ∼
                                                                                 = sgn.
                                                        c
This assumption shows, by 20.6(c), that E♠ ∈ IrrJC where c is the two-sided cell
                        c
such that sgn♠ ∈ IrrJC    . Since tr(tw0 , sgn♠ ) = 1, we have w0 ∈ c. From 13.8 it
                                                                  c
follows that {w0 } is a two-sided cell. Thus c = {w0 } and JC        is one dimensional.
Hence it cannot have more than one simple module. Thus, E ∼           = sgn. This yields
(c) and also (b). The lemma is proved.
20.19. Assume that I, I ′ form a partition of S such that W = WI × WI ′ (direct
product). If E ∈ IrrWI and E ′ ∈ IrrWI ′ , then E ⊠E ′ ∈ IrrW . From the deﬁnitions
one checks easily that
  aE⊠E ′ = aE + aE ′ , f(E⊠E ′ )♠ = fE♠ fE♠′ .

                          ′
Moreover, if x ∈ WI , x ∈ WI ′ , then
    W      WI     W
  γxx ′ = γx  ⊠ γx′ I ′ .
20.20. In the remainder of this section we assume that w0 is in the centre of W .
Then, for any E ∈ IrrW , w0 acts on E as ǫE times identity where ǫE = ±1. Now
E 7→ ǫE E extends to a C-linear involution ζ : K(W ) −
                                                     → K(W ).
Lemma 20.21. Let E ∈ IrrW . For any x ∈ W we have
  tr(Tw0 x , Ev ) = ǫE v −aE +aE† tr(Tx , Ev ).
   Since w0 is in the centre of W , Tw0 is in the centre of HC(v) hence it acts
on Ev as a scalar λ ∈ C(v) times the identity. Now tr(Tx , Ev ) ∈ C[v, v −1 ] and
tr(Tx−1 , Ev ) ∈ C[v, v −1 ]. In particular, λ ∈ C[v, v −1 ] and λ−1 ∈ C[v, v −1 ]. This
implies λ = cv n where c ∈ C. For v = 1, λ becomes ǫE . Hence λ = ǫE v n for some
n. We have
   tr(Tw0 x , Ev ) = tr(Tw0 Tx−1                      −1
                                  −1 , Ev ) = λtr(Tx−1 , Ev ) = λtr(Tx , Ev ).

WeP have
                                                2
                                                  P
      x tr(T w 0 x , E v )tr(Tx−1 w , Ev ) = λ
                                   0                 x tr(Tx , Ev )tr(Tx−1 , Ev )
hence fEv dim(E) = λ fEv dim(E) so that fEv = v 2n fEv . By 20.9, we have
                             2
                                                        †             †
   P                                    P
      x tr(Tx , Ev )tr(Tx−1 , Ev ) =        x tr(Tx , Ev )tr(Tx−1 , Ev )
hence fEv = fEv† . We see that fEv = v 2n f(E † )v . Comparing the lowest terms we
see that
   −2aE = 2n − 2aE † hence n = −aE + aE †
and that
   (a) fE♠ = fE † .
                 ♠


Lemma 20.22. v aE tr(Tw0 x , Ev ) = ǫE (−1)l(x) v aE† tr(Tx , Ev† ).
   We combine 20.8, 20.21.
Lemma 20.23. For any x ∈ W we have γxw0 = sgn(x)ζ(γx ) ⊗ sgn.
   An equivalent statement is
                                   †
   tr(txw0 , E♠ ) = sgn(x)tr(tx , E♠ )ǫE †
for any E ∈ IrrW . Setting v = 0 in the identity in 20.22 gives
64                                   G. LUSZTIG

                                          †
   sgn(xw0 )tr(tw0 x , E♠ ) = ǫE tr(tx , E♠ ).
It remains to show that ǫE † = ǫE sgn(w0 ). This is clear.
20.24. By the Cayley-Hamilton theorem, any element r ∈ J satisﬁes an equation
of the form r n + a1 r n−1 + · · · + an = 0 where ai ∈ Z. (We use that the structure
constants of J are integers.) This holds in particular for r = tx where x ∈ W .
Hence for any E ∈ IrrJC , tr(tx , E) is an algebraic integer. If R is a subﬁeld of C
such that the group algebra R[W ] is split over R, then JR is split over R and it
follows that for x, E as above, tr(tx , E) is an algebraic integer in R. In particular,
if we can take R = Q, then tr(tx , E) ∈ Z.

                            21. Study of a left cell
21.1. In this section we preserve the setup of 20.1. Let ΓPbe a left cell of W, L.
Let d be the unique element in Γ ∩ D. The A-submodule y∈Γ Ac†y of H can be
regarded as an H-module by the rule c†x · c†w = z∈Γ hx,y,z c†z with x ∈ W, y ∈ W .
                                                  P
By change of scalars (v 7→ 1) this gives rise to an HC = C[W ]-module [Γ]. On the
              Γ
other hand, JC  = ⊕y∈Γ Cty is a left ideal in JC by 14.2(P8).
Lemma 21.2. The C-linear isomorphism ty 7→ n̂y c†y for y ∈ Γ is an isomorphism
                Γ ∼
of JC -modules JC −→ [Γ]♠ .

P We have† Γ ⊂ Xa = {w ∈ W |a(x) = a} for some a ∈ N. The A-submodule
   y∈Xa Acy of H can be regarded as an H-module by the rule
   c†x · c†w = z∈Xa hx,y,z c†z
              P
with x ∈ W, y ∈ W . By change of scalars (v 7→ 1) this gives rise to an HC = C[W ]-
                                    Xa
module [Xa ]. On the other hand, JC    = ⊕y∈Xa Cty is a left (even two-sided) ideal
in JC . The C-linear map in the lemma extends by the same formula to a C-linear
                Xa ∼
isomorphism JC     −→ [Xa ]♠ . It is enough to show that this is JC -linear. This
follows from the computation in 18.10. The lemma is proved.
                                                         Γ
Lemma 21.3. Let E ∈ IrrJC . The C-linear map u : HomJC (JC , E) −
                                                                → td E given
by ξ 7→ ξ(nd td ) is an isomorphism.
   u is well deﬁned since ξ(nd td ) = td ξ(td ) ∈ td E. We deﬁne a linear map in the
opposite direction by e 7→ [j 7→ je]. It is clear that this is the inverse of u. (We
                             Γ
use that jnd td = j for j ∈ JC .) The lemma is proved.
                                          P
Proposition 21.4. We have γd = nd E [E : [Γ]]E (sum over all E ∈ IrrW up
to isomorphism).
   An equivalent statement is that tr(nd td , E♠ ) = [E : [Γ]], for E as above. By
                                  Γ
21.2, we have [E : [Γ]] = [E♠ : JC  ]. Hence it remains to show that tr(nd td , E) =
      Γ
[E : JC ] for any E ∈ IrrJC . Since E = ⊕d′ ∈D nd′ td′ E and nd td : E − → E is the
projection to the summand nd td E, we see that tr(nd td , E) = dim(td E). It remains
                               Γ
to show that dim(td E) = [E : JC ]. This follows from 21.3.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                             65

Proposition 21.5. [Γ]† , [Γw0 ] are isomorphic in ModW .
                        †
                      P with the W -module with C-basis ey (y ∈ Γ) where s ∈ S
    We may identify [Γ]
acts by ey 7→ −ey + z∈Γ hs,y,z ez .
    On the other hand we may identify [Γw0 ] with      P the W -module with C-basis
e′yw0 (y ∈ Γ) where s ∈ S acts by e′yw0 7→ e′yw0 − z∈Γ hs,yw0 ,zw0 e′zw0 .
    The W -module dual to [Γ]† has a C-basis     e′′y (y ∈ Γ) (dual to (ey )) in which the
action of s ∈ S is given by e′′y 7→ −e′′y + z∈Γ hs,z,y e′′z . We deﬁne a C-isomorphism
                                           P
between this last space and [Γw0 ] by e′′y 7→ sgn(y)e′yw0 for all y. We show that this
comutes with the action of W . It suﬃces to show that for any s ∈ S, we have
    (a) −hs,z,y = sgn(y)sgn(z)hs,yw0 ,zw0 for all z 6= y and
    (b) 1 − hs,y,y = −1 + hs,yw0 ,yw0 for all y.
We use 6.6. Assume ﬁrst that sz > z. If sy > y and y 6= z, both sides of (a) are
0. If sy < y < z then (a) follows from 11.6. If y = sz then both sides of (a) are
−1. If sy < y but y 6< z or y 6= sz then both sides of (a) are 0.
    Assume next that sz < z. If z 6= y then both sides of (a) are 0.
    If sy > y, both sides of (b) are 1. If sy < y, both sides of (b) are −1. Thus
(a),(b) are veriﬁed. Since [Γ]† and its dual are isomorphic in ModW (they are
deﬁned over Q), the lemma follows.
Corollary 21.6. Let E ∈ IrrW and let c be the two-sided cell of W such that
         c         †       cw0
E♠ ∈ IrrJC . Then E♠ ∈ IrrJC   .
   Replacing Γ by c in the deﬁnition of [Γ] we obtain a W -module [c]. Then 21.2,
21.5 hold with Γ replaced by c with the same proof. Our assumption implies
(by 21.2 for c) that E appears in the W -module [c]. Using 21.5 for c we deduce
                                                                               †
that E † appears in the W -module [cw0 ]. Using 21.2 for cw0 , we deduce that E♠
                            cw0
appears in the JC -module JC . The corollary follows.
Corollary 21.7. Let E, E ′ ∈ IrrW be such that E ∼LR E ′ . Then E † ∼LR E ′† .
                                                                 ′       c
   By assumption there exists a two-sided cell c such that E♠ , E♠ ∈ IrrJC . By
       †    ′†       cw0
21.6, E♠ , E ♠ ∈ IrrJC . The corollary follows.
                                                                       −1
                                                                    Γ∩Γ
21.8. The results of §19 are applicable to A, the C-subspace JC            of JC spanned
          −1
by Γ ∩ Γ and R = C. This is a C-subalgebra of JC with unit element td . In
                             Γ∩Γ−1
21.9 we will show that JC           is semisimple. It is then clearly split. We take
     Γ∩Γ−1
τ : JC       −→ C so that τ (tx ) = δx,d . (This is the restriction of τ : JC −→ C.) We
have (tx , ty ) = δxy,1 . The bases (tx ) and (tx−1 ) (where x runs through Γ ∩ Γ−1 )
are dual with respect to (, ).
                                             −1
                                       Γ∩Γ
21.9. We show that the C-algebra JC         is semisimple. It is enough to prove
the analogous statement for the Q-algebra A′ , the Q-span of Γ ∩ Γ−1 in JQ . We
deﬁne a Q-bilinear pairing (|) : A′ × A′ → Q by (tx |ty ) = δx,y for x, y ∈ Γ ∩ Γ−1 .
Let j 7→ j̃ be the Q-linear map A′ → A′ given by t̃x = tx−1 for all x. We show
that
66                                     G. LUSZTIG

   (a) (j1 j2 |j3 ) = (j2 |j̃1 j3 )
for all j1 , j2 , j3 in our ring. We may assume that j1 = tx , j2 = ty , j3 = tz . Then
(a) follows from
   γx,y,z−1 = γx−1 ,z,y−1 .
Now let I be a left ideal of A′ . Let I ⊥ = {a ∈ A′ |(a|I) = 0}. Since (|) is positive
deﬁnite, we have A′ = I ⊕ I ⊥ . From (c) we see that I ⊥ is a left ideal. This proves
that A′ is semisimple.
   The same proof could be used to show directly that JC is semisimple.
Proposition 21.10. Let E, E ′ ∈ IrrW . Let N = x∈Γ∩Γ−1 tr(tx , E♠ )tr(tx−1 , E♠       ′
                                                    P
                                                                                        ).
                                    ′
Then N = fE♠ [E : [Γ]] if E, E are isomorphic and N = 0, otherwise.
                                                      −1
                                                     Γ∩Γ
    If E ∈ IrrJC , then td E is either 0 or in IrrJC       . Moreover, E 7→ td E deﬁnes a
bijection between the set of simple JC -modules (up to isomorphism) which appear
                        Γ                           Γ∩Γ−1
in the JC -module JC      and the set of simple JC        -modules (up to isomorphism).
                                     Γ                          Γ∩Γ−1
We then have dim(td E) = [E : JC ]. Note that, for j ∈ JC             we have tr(j, E) =
                                     ′
tr(j, td E). If td E♠ = 0 or td E♠ = 0, then N = 0 and the result is clear. If
td E♠ 6= 0 and t′d E♠ 6= 0 then, by 19.2(e), we see that N = ftd E♠ [E♠ : JC         Γ
                                                                                       ] if
       ′
E, E are isomorphic and to 0, otherwise. It remains to show that ftd E♠ = fE♠ ,
                     Γ
[E : [Γ]] = [E♠ : JC   ] and the analogous equalities for E ′ . Now ftd E♠ = fE♠ follows
                                       Γ∩Γ−1
from 19.4 applied to (A′ , A) = (JC           , JC ); the equality [E : [Γ]] = [E♠ : JC Γ
                                                                                          ]
follows from 21.2. The proposition is proved.

                      22. Constructible representations
22.1. In this section we preserve the setup of 20.1.
   We deﬁne a class Con(W ) of W -modules (relative to our ﬁxed L : W −      → N)
by induction on |S|. If |S| = 0 so that W = {1}, Con(W ) consists of the unit
representation. Assume now that |S| > 0. Then Con(W ) consists of the W -
modules of the form jW      ′      W    ′
                       WI (E ) or jWI (E ) ⊗ sgn for various subsets I ⊂ S, I 6= S
and various E ′ ∈ Con(WI ). (If we restrict ourselves to I such that |I| = |S| − 1
we get the same class of W -modules, by the transitivity of truncated induction.)
The W -modules in Con(W ) are said to be the constructible representations of W .
   Note that the unit representation of W is constructible (it is obtained by trun-
cated induction from the unit representation of the subgroup with one element).
Hence sgn ∈ Con(W ).
Lemma 22.2. If E ∈ Con(W ), then there exists a left cell Γ of W such that
E = [Γ].
   We argue by induction on |S|. If |S| = 0 the result is obvious. Assume now
that |S| > 0. Let E ∈ Con(W ).
   Case 1. E = jW      ′                             ′
                 WI (E ) where I ⊂ S, I 6= S and E ∈ Con(WI ). By the induction
hypothesis there exists a left cell Γ′ of WI such that E ′ = [Γ′ ]. Let d ∈ Γ′ ∩ D. By
21.4 we have γdWI = [Γ′ ] = E ′ . By 20.17 we have E = jW       ′      W    WI
                                                          WI (E ) = jWI (γd ) = γd .
                                                                                    W
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                              67

Let Γ be the left cell of W that contains d. By 21.4 we have γdW = [Γ]. Hence
E = [Γ].
   Case 2. E = jW      ′                                   ′
                 WI (E ) ⊗ sgn where I ⊂ S, I 6= S and E ∈ Con(WI ). Then by
Case 1, E ⊗ sgn = [Γ] for some left cell Γ of W . By 21.5 we have E = [Γw0 ]. The
lemma is proved.
Proposition 22.3. For any E ∈ IrrW there exists a constructible representation
of W which contains a simple component isomorphic to E.
   The general case can be easily reduced to the case where W is irreducible.
Assume now that W is irreducible. If L = al for some a > 0, the constructible
representations of W are listed in [...] and the proposition is easily checked. (See
also the discussion of types A, D in 22.5, 22.26.) In the cases where W is irreducible
but L is not of the form al, the constructible representations are described later
in this section and this yields the proposition in all cases.
22.4. Let W = Sn be the group of permutations of 1, 2, . . . , n. We regard W as
a Coxeter group with generators
   s1 = (1, 2), s2 = (2, 3), . . . , sn−1 = (n − 1, n),
(transpositions). We take L = al where a > 0.
   The simple W -modules (up to isomorphism) are in 1-1 correspondence P     with the
partitions α = (α1 ≥ α2 ≥ . . . ) such that αN = 0 for large N and i αi = n. The
correspondence (denoted by α 7→ πα ) is deﬁned as follows. Let α be as above, let
(α′1 ≥ α′2 ≥ . . . ) be the partition dual to α. Let πα be the simple W -module whose
restriction to Sα1 × Sα2 . . . contains 1 and whose restriction to Sα′1 × Sα′2 . . .
contains the sign representation. We have (a consequence of results of Steinberg):

                                                al′
                                           2(         ) + strictly higher powers ofv.
                                   P
                 f(πα )v = v −
                                                  i
                                       i         2




It follows thatP
                   α′i
                         
   (a) aπα = i a   2         and f(πα )♠ = 1.
Lemma 22.5. In the setup of 22.4, a W -module is constructible if and only if it
is simple.

P For any sequence β = (β1 , β2 , . . . ) in N such that βN = 0 for large N and
  i βi = n, we set
   Iβ = {si |i ∈ [1, n − 1], i 6= β1 , i 6= β1 + β2 , . . . }.
From 22.4(a) we see easily that, if β is the same as α′ up to order, then
   (a) jW
        WIβ (sgn) = πα .
Since the sgn ∈ Con(WIβ ), it follows that πα ∈ Con(W ). Thus any simple W -
module is constructible.
   We now show that any constructible representation E of W = Sn is simple. We
may assume that n ≥ 1 and that the analogous result is true for any WI ′ 6= W . We
may assume that E = jW    WI (C) where β is as above, WIβ 6= W and C ∈ Con(WIβ ).
                               β
68                                        G. LUSZTIG

By the induction hypothesis, C is simple. Since the analogue of (a) holds for WIβ
                                  WI
(instead of W ) we have C = jWIβ (sgn) for some β ′ such that WIβ′ ⊂ WIβ . By the
                                     β′

transitivity of truncated induction we have E = jW
                                                 WI ′ (sgn). Hence, by (a), for β
                                                                                  ′
                                                                 β
instead of β, E is simple. The lemma is proved.
22.6. We now develop some combinatorics which is useful for the veriﬁcation of
22.3 for W of classical type.
   Let a > 0, b ≥ 0 be integers. We can write uniquely b = ar + b′ where r, b′ ∈ N
and b′ < a. Let N ∈ N. Let MN             a,b be the set of multisets Z̃ = {z̃1 ≤ z̃2 ≤ · · · ≤
z̃2N+r } of integers ≥ 0 such that
   (a) if b′ = 0, there are at least N + r distinct entries in Z̃, no entry is repeated
more than twice and all entries of Z̃ are divisible by a;
   (b) if b′ > 0, all inequalities in Z̃ are strict and N entries of Z̃ are divisible by
a and N + r entries of Z̃ are equal to b′ modulo a.
The entries which appear in Z̃ exactly once are called the singles of Z̃; they form
a set Z. The other entries of Z̃ are called the doubles of Z̃.
   For example, the multiset Z̃ 0 whose entries are (up to order)
   0, a, 2a, . . . , (N − 1)a, b′ , a + b′ , 2a + b′ , . . . , (N + r − 1)a + b′
belongs to MN      a,b . Clearly, the sum of entries of Z̃ minus the sum of entries of Z̃
                                                                                              0

is ≥ 0 and divisible by a, hence it is equal to an for a well deﬁned n ∈ N said to
be the rank of Z̃. We have
                         2N+r                                          
                          X
                                                2                      r
                              z̃k = an + aN + N (b − a) + a                + b′ r.
                                                                       2
                     k=1

Note that Z̃ 0 has rank 0. Let MN                                                        N
                                          a,b;n be the set of multisets of rank n in Ma,b .
We deﬁne an (injective) map MN         a,b − → MN+1  a,b  by
                                       ′
   {z̃1 ≤ z̃2 ≤ . . . z̃2N+r } 7→ {0, b , z̃1 + a ≤ z̃2 + a ≤ . . . z̃2N+r + a}.
This restricts for any n ∈ N to an (injective) map
   (c) MN       → MN+1
          a,b;n −        a,b;n .
It is easy to see that, for ﬁxed n, |MN       a,b;n | is bounded as N → ∞, hence the maps
(c) are bijections for large N . Let Ma,b;n be the inductive limit of MN            a,b;n as
N → ∞ (with respect to the maps (c)).
22.7. Let SyN
            a,b;n be the set consisting of all tableaux (or symbols)

                                       λ1 , λ2 , . . . , λN+r
(a)                                       µ1 , µ2 , . . . , µN
where λ1 < λ2 < · · · < λN+r are integers ≥ 0, congruent to b′ modulo a,
µ1 , µ2 , . . . , µN are integers ≥ 0, divisible by a and
                                                               
                    X        X
                                                2              r
                        λi +     µj = an + aN + N (b − a) + a     + b′ r.
                     i        j
                                                               2
          LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                         69

If we arrange the entries of Λ in a single row, we obtain a multiset Z̃ ∈ MN
                                                                           a,b;n .
                                        N         N
This deﬁnes a (surjective) map πN : Sya,b;n −→ Ma,b;n .
   We deﬁne an (injective) map
   (b) SyN     → SyN+1
         a,b;n −    a,b;n
by associating to (a) the symbol

                           b′ , λ1 + a, λ2 + a, . . . , λN+r + a
                                      0, µ1 + a, µ2 + a, . . . , µN + a.

This is compatible with the map MN        → MN+1
                                      a,b −    a,b   in 22.6 (via πN , πN+1 ).
                          N
   Since for ﬁxed n, |Sya,b;n | is bounded as N → ∞, the maps (b) are bijections
for large N . Let Sya,b;n be the inductive limit of SyNa,b;n as N → ∞ (with respect
to the maps (b)).
22.8. Let Z̃ = {z̃1 ≤ z̃2 ≤ . . . z̃2N+r } ∈ MN             a,b;n . Let t be an integer which is large
enough so that the multiset
   (a) {at + b′ − z̃1 , at + b′ − z̃2 , . . . , at + b′ − z̃2N+r }
is contained in the multiset
   (b) {0, a, 2a, . . . , ta, b′ , a + b′ , 2a + b′ , . . . , ta + b′ }
         ¯ be the complement of (a) in (b). Then Z̃
and let Z̃                                                              ¯ ∈ Mt+1−N−r . The sum of
                                                                               a,b
           ¯
entries of Z̃ is
  X                                              X
       (2ka + b′ ) − (at + b′ )(2N + r) +             z̃h
k∈[0,t]                                           h
                                                                       
                            ′            ′                           2 r
 = at(t + 1) + (t + 1)b − (at + b )(2N + r) + an + aN + N (b − a) + a     + b′ r
                                                                       2
                                                       
                         2                             r
 = an + a(t + 1 − N − r) + (t + 1 − N − r)(b − a) + a     + b′ r.
                                                       2

       ¯ has rank n.
Thus, Z̃
                         −1
   We deﬁne a bijection πN
                                  ∼  −1
                            (Z̃) −→ πt+1−N−r  ¯ by Λ 7→ Λ̄ where Λ is as in
                                             (Z̃)
22.7(a) and Λ̄ is

{b′ , a + b′ , 2a + b′ , 3a + b′ , . . . , ta + b′ } − {at + b′ − µ1 , at + b′ − µ2 , . . . , at + b′ − µN }
{0, a, 2a, 3a, . . . , ta} − {at + b′ − λ1 , at + b′ − λ2 , . . . , at + b′ − λN+r }.

22.9. Let W = Wn be the group of permutations of 1, 2, . . . , n, n′ , . . . , 2′ , 1′ which
commute with the involution i 7→ i′ , i′ 7→ i. We regard Wn as a Coxeter group
with generators s1 , s2 , . . . , sn given as products of transpositions by
   s1 = (1, 2)(1′ , 2′ ), s2 = (2, 3)(2′ , 3′ ), . . . , sn−1 = (n − 1, n)((n − 1)′ , n′ ),
   sn = (n, n′ ).
70                                               G. LUSZTIG

22.10. A permutation in W deﬁnes a permutation of the n element set consisting
of the pairs (1, 1′ ), (2, 2′ ), . . . , (n, n′ ). Thus we have a natural homomorphism of
Wn onto Sn , the symmetric group in n letters. Let χn : Wn −                      → ±1 be the
homomorphism deﬁned by
   χn (σ) = 1 if {σ(1), σ(2), . . . , σ(n)} ∩ {1′ , 2′ , . . . , n′ } has even cardinality,
   χn (σ) = −1, otherwise.
The simple W -modules (up to isomorphism) are in 1-1 correspondence with the
ordered pairs α, β where α = (α1 ≥ α2 ≥ . . . ) and βP= (β1 P                   ≥ β2 ≥ . . . ) are
partitions such that αN = EN = 0 for large N and i αi + j βj = n. The
correspondence (denoted by α, β 7→ E α,β ) is deﬁned as follows. Let α, β be as
above, let (α′1 ≥ α′2 ≥ . . . ) be the partition  P
                                                                                  ′      ′
                                                           P to α and let (β1 ≥ β2 ≥ . . . )
                                                         dual
be the partition dual to β. Let k = i αi , l = j βj . Let πα be the simple Sk -
module deﬁned as in 22.4 and let πβ be the analogously deﬁned simple Sl -module.
We regard πα , πβ as simple modules of Wk , Wl via the natural homomorphisms
Wk − → Sk , Wl − → Sl as above. We identify Wk × Wl with the subgroup of W
consisting of all permutations in W which map 1, 2, . . . , k, k′ , . . . , 2′ , 1′ into itself
hence also map k + 1, k + 2, . . . , n, n′ , . . . , (k + 2)′ , (k + 1)′ into itself. Consider
the representation πα ⊗ (πβ ⊗ χl ) of Wk × Wl . We induce it to W ; the resulting
representation of W is irreducible; we denote it by E α,β .
   We ﬁx a > 0, b ≥ 0 and we write b = ar + b′ as in 22.6.
   Let α, β be as in 22.10. Let N be an integer such that αN+r+1 = 0, βN+1 = 0.
(Any large enough integer satisﬁes these conditions.) We set

λi = a(αN+r−i+1 +i−1)+b′ , (i ∈ [1, N +r]),                         µj = a(βN−j+1 +j −1), (j ∈ [1, N ]).

We have 0 ≤ λ1 < λ2 < · · · < λN+r , 0 ≤ µ1 < µ2 < · · · < µN . Let Λ denote
the tableau 22.7(a). It is easy to see that Λ ∈ SyN a,b;n . Moreover, if N is replaced
by N + 1, then Λ is replaced by its image under SyN          → SyN+1
                                                       a,b;n −    a,b;n (see 22.7). Let
          α,β
[Λ] = E . Note that [Λ] depends only on the image of Λ under the canonical
map SyN  a,b;n −
               → Sya,b;n . In this way, we see that
   the simple W -modules are naturally in bijection with the set Sya,b;n .
For i ∈ [1, N ] we have a(αN−i+1 +i−1)+b = a(αN+r−i−r+1 +i+r −1)+b′ = λi+r .
   If N is large we have λi = a(i − 1) + b′ for i ∈ [1, r] and µj = a(j − 1) for
j ∈ [1, r].
22.11. Let q, y be indeterminates. With the notation in 22.15, let
                                                    ′     Y q αi +α′j −i−j+1 − 1
                                                 (α2i )
                                         P
                                     −
                        Hα (q) = q           i                                     ,
                                                          i,j
                                                                      q−1

                                                 α′i βi′ /2            ′
                                         P                    Y
                   Gα,β (q, y) = q −         i                 (q αi +βj −i−j+1 y + 1);
                                                              i,j

both products are taken over all i ≥ 1, j ≥ 1 such that αi ≥ j, α′j ≥ i.
          LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                                      71

     Let L : W −→ N be the weight function deﬁned be deﬁned by L(s1 ) = L(s2 ) =
· · · = L(sn−1 ) = a, L(sn ) = b. We now assume that both a, b are > 0. We also
assume that a, b are such that W, L satisﬁes the assumptions of 18.1. Then fEvα,β
is deﬁned in terms of this L.
Lemma 22.12 (Hoefsmit [Ho]). We have

                 fEvα,β = Hα (v 2a )Hβ (v 2a )Gα,β (v 2a , v 2b )Gβ,α (v 2a , v −2b ).

  We will rewrite the expression above using the following result.
Lemma 22.13. Let N be a large integer. We have

                                                   QN Q                            q h −1
                                    i
             Hα (q) = q i∈[1,N −1] (2) Q
                                                     i=1        h∈[1,αN −i+1 +i−1] q−1
                          P
                                                                                                   ,
                                                         q αN −j+1 +j−1 −q αN −i+1 +i−1
                                                 1≤i<j≤N              q−1



                                        P
                                                         i2√   √ −1
      Gα,β (q, y)Gβ,α (q, y −1 ) = q        i∈[1,N −1]    ( y + y )N
        QN Q                                h
                                                         QN Q                                 h −1
           i=1     h∈[1,αN −i+1 +i−1] (q        y + 1)        j=1    h∈[1,βN −j+1 +j−1] (q     y       + 1)
      ×                                                                                                       .
                                        αN −i+1 +i−1 √              βN −j+1 +j−1 √ −1
                      Q
                         i,j∈[1,N] (q                         y+q                     y   )

  The proof is by induction on n. We omit it.
Proposition 22.14. (a) If b′ = 0 then f[Λ]♠ is equal to 2d where 2d + r is the
number of singles in Λ. If b′ > 0 then f[Λ]♠ = 1.
  (b) We have a[Λ] = AN − BN where
                 X                                       X                                X
 AN =                         inf(λi , µj ) +                       inf(λi , λj ) +                inf(µi , µj ),
          i∈[1,N+r],j∈[1,N]                       1≤i<j≤N+r                           1≤i<j≤N



                  X
 BN =                         inf(a(i − 1) + b′ , a(j − 1))
          i∈[1,N+r],j∈[1,N]
          X                                                             X
  +                inf(a(i − 1) + b′ , a(j − 1) + b′ ) +                        inf(a(i − 1), a(j − 1)).
      1≤i<j≤N+r                                                      1≤i<j≤N


  It is enough to prove (a) assuming that N is large. Since
  AN+1 − AN = a(N + r)N + a N2 + a N+r         + b′ N + b′ (N + r) = BN+1 − BN ,
                                            
                                           2
we have AN+1 − BN+1 = AN − BN hence it is enough to prove (b) assuming that
N is large. In the remainder of the proof we assume that N is large.
72                                               G. LUSZTIG

   For f, f ′ ∈ C(v) we write f ∼
                                = f ′ if f ′ = f g with g ∈ C(v), g|v=0 = 1. Using
22.12, 22.13, we see that

               f[Λ]v ∼
                           Y
                     =          (v 2a−2b + 1)(v 4a−2b + 1) . . . (v 2µi −2b + 1)
                         i∈[1,N]
                                     P N −1
                                              (2i2 −i)
                                                           Y
               (v b + v −b )N v 2a     i=1                       (v 2λi+r −b + v 2µj −b )−1
                                                         i,j∈[1,N]
                  Y                                                     Y
                          (v 2λj+r −2b − v 2λi+r −2b )−1                       (v 2µj − v 2µi )−1
               1≤i<j≤N                                           1≤i<j≤N


hence
                              f[Λ]v = 2d v −K + higher powers of v
where
  d = 0 if b′ > 0,

     d = ♯(j ∈ [1, N ] : b ≤ µj ) − ♯(i, j ∈ [1, N ] : λi+r = µj )
     = N − ♯(i ∈ [1, r], j ∈ [1, N ] : (i − 1)a = µj ) − ♯(i, j ∈ [1, N ] : λi+r = µj )
     = N − ♯(i ∈ [1, r], j ∈ [1, N ] : λi = µj ) − ♯(i, j ∈ [1, N ] : λi+r = µj )
     = N − ♯(i ∈ [1, N + r], j ∈ [1, N ] : λi = µj ) = (♯singles − r)/2, if b′ = 0,


                                      X                              X       X
        − K = −bN + 2a                         (2i2 − i) +                         (2ak − 2b)
                                   i∈[1,N−1]                    j∈[1,N] k∈[1,r]
                                                                        ak≤µj
               X                                               X
        −             (−b + 2 inf(λi+r , µj )) −                         (−2b + 2 inf(λi+r , λj+r ))
             i,j∈[1,N]                                      1≤i<j≤N
                X                                                X
        −                2 inf(µi , µj ) = −bN + 2a                         (2i2 − i) + 2bN 2 − bN
             1≤i<j≤N                                          i∈[1,N−1]
              X            X                                  X
        +                             (2ak − 2b) −                      2 inf(λi+r , µj )
             j∈[1,N] k∈[1,r],ak≤µj                         i,j∈[1,N]
                X                                         X
        −                2 inf(λi+r , λj+r ) −                       2 inf(µi , µj )
             1≤i<j≤N                                1≤i<j≤N
               X           X                                  X
         =                            (2ak − 2b) −                      2 inf(λi+r , µj )
             j∈[1,N] k∈[1,r],ak≤µj                          i,j∈[1,N]
                X                                         X
        −                2 inf(λi+r , λj+r ) −                       2 inf(µi , µj ) + ⋆.
             1≤i<j≤N                                1≤i<j≤N

                                ⋆
(We will generally write             for an expression which depends only on a, b, N .) We
           LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                            73

have
                  X                           X                         X
                           (2ak − 2b) =            (2ak − 2b) +                 (2ak − 2b)
                 j∈[1,N]                    j∈[1,r]                  j∈[r+1,N]
                 k∈[1,r]                    k∈[1,r]                   k∈[1,r]
                 ak≤µj                      ak≤µj                      ak≤µj
                          X                              X
                 =               (2ak − 2b) +                  (2ak − 2b) = ⋆,
                       j∈[1,r]                     j∈[r+1,N]
                       k∈[1,r]                      k∈[1,r]
                     ak≤a(j−1)

hence
                 X                              X                                   X
−K = −2(                   inf(λi+r , µj )−               inf(λi+r , λj+r )−              inf(µi , µj ))+⋆.
              i,j∈[1,N]                       1≤i<j≤N                          1≤i<j≤N


We have
     X                                      X
                     inf(λi , µj ) =                     inf(a(i − 1) + b′ , µj )
  i∈[1,r],j∈[1,N]                      i∈[1,r],j∈[1,N]
             X                                                       X
  =                      inf(a(i − 1) + b′ , a(j − 1)) +                          inf(a(i − 1) + b′ , µj )
       i∈[1,r],j∈[1,r]                                        i∈[1,r],j∈[r+1,N]
             X                                                       X
  =                      inf(a(i − 1) + b′ , a(j − 1)) +                         (a(i − 1) + b′ ) = ⋆,
       i∈[1,r],j∈[1,r]                                        i∈[1,r],j∈[r+1,N]

hence                 X                                      X
                               inf(λi+r , µj ) =                        inf(λi , µj ) + ⋆.
                   i,j∈[1,N]                       i∈[1,N+r],j∈[1,N]

We have
             X                                X                              X
                         inf(λi , λj ) =              inf(λi+r , λj+r ) +             λi (N + r − i)
         1≤i<j≤N+r                         1≤i<j≤N                          i∈[1,r]
               X                                 X
         =                inf(λi+r , λj+r ) +            (a(i − 1) + b′ )(N + r − i)
             1≤i<j≤N                            i∈[1,r]
               X
         =                inf(λi+r , λj+r ) + ⋆.
             1≤i<j≤N

We see that

(c)                                         −K = −2AN + ⋆.

In the special case where α = β = (0 ≥ 0 ≥ . . . ) we have K = 0. On the other
hand, by (c), we have 0 = −2BN + ⋆ where ⋆ is as in (c). Hence in general we have
−K = −2AN + 2BN . This proves the proposition, in view of 20.11 and 20.21(a).
74                                     G. LUSZTIG

22.15. We identify Sk × Wl (k + l = n) with the subgroup of W consisting of all
permutations in W which map {1, 2, . . . , k} into itself (hence also map {1, 2, . . . , k′ }
and {k + 1, . . . , n, n′ . . . , (k + 1)′ } into themselves. This is a standard parabolic
subgroup of W . We consider an irreducible representation of Sk × Wl of the form
sgnk ⊠ [Λ′ ] where sgnk is the sign representation of Sk and Λ′ ∈ SyN        a,b;l . We may
assume that Λ′ has at least k entries. We want to associate to Λ′ a symbol in
SyN                                                            ′
   a,b;n by increasing each of the k largest entries in Λ by a. It may happen that
the set of r largest entries of Λ′ is not uniquely deﬁned but there are two choices
for it. (This can only happen if b′ = 0.) Then the same procedure gives rise to
two distinct symbols ΛI , ΛII in SyN        a,b;n .

Lemma 22.16. (a) g(sgnk ⊗[Λ′ ])♠ = g[Λ′ ]♠ is equal to g[Λ]♠ or to g[ΛI ]♠ + g[ΛII ]♠ .
  (b) asgnk ⊗[Λ′ ] = a k2 + a[Λ′ ] is equal to a[Λ] or to a[ΛI ] = a[ΛII ] .
                         

   Λ, if deﬁned, has the same number of singles as Λ′ . Moreover, ΛI (and ΛII ), if
deﬁned, has one more single than Λ′ . Hence (a) follows from 22.14(a) using 20.18,
20.19.
   By 22.14(b), the diﬀerence a[Λ̃] − a[Λ] (where Λ̃ is either Λ or ΛI or ΛII ) is a
times the number of i < j in [1, k]. Thus, it is a k2 . Hence (a) follows from 20.18,
                                                     

20.19. The lemma is proved.
Lemma 22.17. jW                ′                   I      II
              Sk ×Wl (sgnk ⊗ [Λ ]) equals [Λ] or [Λ ] + [Λ ].

   By a direct computation (involving representations of symmetric groups) we
see that:
   (a) if Λ is deﬁned then [[Λ′ ] : [Λ]] ≥ 1;
   (b) if ΛI , ΛII are deﬁned then [[Λ′ ] : [ΛI ]] ≥ 1 and [[Λ′ ] : [ΛII ]] ≥ 1.
In the setupPof (a) we have (by 20.14(b)):
   g[Λ′ ]♠ = E;aE =aE′ [[Λ′ ] : E]gE♠ hence using 22.16(a) we have
   (c) g[Λ]♠ = E;aE =aE′ [[Λ′ ] : E]gE♠ .
                P

By 22.16(b), E = [Λ] enters in the last sum and its contribution is ≥ g[Λ]♠ ; the
contribution of the other E is ≥ 0 (see 20.13(b)). Hence (c) forces [[Λ′ ] : [Λ]] = 1
and [[Λ′ ] : E] = 0 for all other E in the sum. In this case the lemma follows.
   In the setup
             P of (b) we ′have (by 20.14(b)):
   g[Λ′ ]♠ = E;aE =aE′ [[Λ ] : E]gE♠ hence, using 22.16(a), we have
   (d) g[ΛI ]♠ + g[ΛII ]♠ = E;aE =aE′ [[Λ′ ] : E]gE♠ .
                             P

By 22.16(b), E = [ΛI ] and E = [ΛII ] enter in the last sum and their contribution
is ≥ g[ΛI ]♠ + g[ΛII ]♠ ; the contribution of the other E is ≥ 0 (see 20.13(b)). Hence
(d) forces [[Λ′ ] : [ΛI ]] = [[Λ′ ] : [ΛII ]] = 1 and [[Λ′ ] : E] = 0 for all other E in the
sum. The lemma follows.
Lemma 22.18. [Λ] ⊗ sgn = [Λ̄]. (Notation of 22.14.)
  This can be reduced to a known statement about the symmetric group. We
omit the details.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                75

22.19. Let Z be a totally ordered ﬁnite set z1 < z2 < · · · < zM . For any r ∈ [0, M ]
such that r = M mod 2 let Z r be the set of subsets of Z of cardinal (M − r)/2.
An involution ι : Z − → Z is said to be r-admissible if the following hold:
   (a) ι has exactly r ﬁxed points;
   (b) if M = r, there is no further condition; if M > r, there exist two consecutive
elements z, z ′ of Z such that ι(z) = z ′ , ι(z ′ ) = z and the induced involution of
Z − {z, z ′ } is r-admissible.
Let Invr (Z) be the set of r-admissible involutions of Z. To ι ∈ Invr (Z) we associate
a subset Sι of Z r as follows: a subset Y ⊂ Z is in Sι if it contains exactly one
element in each non-trivial ι-orbit. Clearly |Sι | = 2p where p = (M − r)/2. (In
fact, Sι is naturally an aﬃne space over the ﬁeld F2 .)
Lemma 22.20. Assume that p > 0. Let Y ∈ Z r .
    (a) We can find two consecutive elements z, z ′ of Z such that exactly one of
z, z ′ is in Y .
    (b) There exists ι ∈ Invr (Z) such that Y ∈ Sι .
    (c) Assume that for some k ∈ [0, p − 1], z1 , z2 , . . . , zk belong to Y but zk+1 ∈
                                                                                       / Y.
Let l be the smallest number such that l > k and zl ∈ Y . There exists ι ∈ Invr (Z)
such that Y ∈ Sι and ι(zl ) = zl−1 .
   We prove (a). Let zk be the smallest element of Y . If k > 1 then we can
take (z, z ′ ) = (zk−1 , zk ). Hence we may assume that z1 ∈ Y . Let zk′ be the next
smallest elememt of Y . If k ′ > 2 then we can take (z, z ′ ) = (zk′ −1 , zk′ ). Continuing
like this we see that we may assume that Y = {z1 , z2 , . . . , zp } Since p < M we
may take (z, z ′ ) = (zp , zp+1 ).
   We prove (b). Let z, z ′ be as in (a). Let Z ′ = Z − {z, z ′ } with the induced
order. Let Y ′ = Y ∩ Z ′ . If p ≥ 2 then by induction on p we may assume that
there exists ι′ ∈ Invr (Z ′ ) such that Y ′ ∈ Sι′ . Extend ι′ to an involution ι of Z by
z 7→ z ′ , z ′ 7→ z. Then ι ∈ Invr (Z) and Y ∈ Sι . If p = 1, deﬁne ι : Z −    → Z so that
      ′ ′                                ′
z 7→ z , z 7→ z and ι = 1 on Z − {z, z }. Then ι ∈ Invr (Z) and Y ∈ Sι .
   We prove (c). We have l ≥ k + 2. Hence zl−1 ∈          / Y . Let (z, z ′ ) = (zl−1 , zl ).
We continue as in the proof of (b), except that instead of invoking an induction
hypothesis, we invoke (b) itself.
22.21. Assume that M > r. We consider the graph whose set of vertices is Z r
and in which two vertices Y 6= Y ′ are joined if there exists ι ∈ Invr (Z) such that
Y ∈ Sι , Y ′ ∈ Sι .
Lemma 22.22. This graph is connected.
   We show that any vertex Y = {zi1 , zi2 , . . . , zip } is in the same connected com-
ponent as Y0 = {z1 , z2 , . . . , zp }. We argue by induction on mY = i1 + i2 + · · · + ip .
If mY = 1 + 2 + · · · + p then Y = Y0 and there is nothing to prove. Assume now
that m > 1 + 2 + · · · + p so that Y 6= Y0 . Then the assumption of Lemma 22.20(c)
is satisﬁed. Hence we can ﬁnd l such that zl ∈ Y, zl−1 ∈       / Y and ι ∈ Invr (Z) such
that Y ∈ Sι and ι(zl ) = zl−1 . Let Y = (Y − {zl }) ∪ {zl−1 }. Then Y ′ ∈ Sι hence
                                           ′
76                                        G. LUSZTIG

Y, Y ′ are joined in our graph. We have mY ′ = mY − 1 hence by the induction
hypothesis Y ′ , Y0 are in the same connected component. It follows that Y, Y0 are
in the same connected component. The lemma is proved.
22.23. Assume that b′ = 0. Let Z̃ ∈ MN     a,b;n . Let Z be the set of singles of Z̃.
                                                  −1
Each set Y ∈ Z r gives rise to a symbol ΛY in πN     (Z̃): the ﬁrst row of ΛY consists
of Z − Y and one of each double of Z̃; the second row consists of Y and one of
each double of Z̃. For any ι ∈ Invr (Z) we deﬁne
   c(Z̃, ι) = ⊕Y ∈Sι [ΛY ] ∈ ModW .
Proposition 22.24. (a) In the setup of 22.23, let ι ∈ Invr (Z). Then c(Z̃, ι) ∈
Con(W ).
  (b) All constructible representations of W are obtained as in (a).
    We prove (a) by induction on n. If n = 0 the result is clear. Assume now that
n ≥ 1. We may assume that 0 is not a double of Z̃. Let at be the largest entry of
Z̃.
    (A) Assume that there exists i, 0 ≤ i < t, such that ai does not appear in Z̃.
Then Z̃ is obtained from Z̃ ′ ∈ MN      a,b;n−k with n − k < n by increasing each of
the k largest entries by a and this set of largest entries is unambiguously deﬁned.
The set Z ′ of singles of Z̃ ′ is naturally in order preserving bijection with Z. Let
ι′ correspond to ι under this bijection. By the induction hypothesis, c(Z̃ ′ , ι′ ) ∈
Con(Wn−k ). Since, by 22.5, the sign representation sgnk of Sk is constructible, it
follows that sgnk ⊠ c(Z̃ ′ , ι′ ) ∈ Con(Sk × Wn−k ). Using 22.17, we have

                           jW                    ′ ′
                            Sk ×Wn−k (sgnk ⊠ c(Z̃ , ι )) = c(Z̃, ι)


hence c(Z̃, ι) ∈ Con(W ).
    (B) Assume that there exists i, 0 < i ≤ t such that ai is a double of Z̃. Let Z̃            ¯ be
as in 22.8 (with respect to our t). Then 0 is not a double of Z̃            ¯ and the largest entry
    ¯ is at. Let Z̄ be the set of singles of Z̃.
of Z̃                                                   ¯ We have Z̄ = {at − z|z ∈ Z}. Thus
Z̄, Z are naturally in (order reversing) bijection under j 7→ at −j. Let ι′ ∈ Invr (Z̄)
correspond to ι under this bijection. Since at − ai does not appear in Z̃,                 ¯ (A) is
applicable to Z̃.   ¯ Hence c(Z̃,     ¯ ι′ ) ∈ Con(W ). By 22.18 we have c(Z̃,       ¯ ι′ ) ⊗ sgn =
c(Z̃, ι) hence c(Z̃, ι) ∈ Con(W ).
    (C) Assume that we are not in case (A) and not in case (B). Then Z̃ =
{0, a, 2a, . . . , ta} = Z. We can ﬁnd ia, (i + 1)a in Z such that ι interchanges
ia, (i + 1)a and induces on Z − {ia, (i + 1)a} an r-admissible involution ι1 . We
have
    Z̃ ′ = {0, a, 2a, . . . , ia, ia, (i + 1)a, (i + 2)a, . . . , (t − 1)a} ∈ MNa,b;n−k
                                                    ′
with n − k < n. The set of singles of Z̃ is
    Z ′ = {0, a, 2a, . . . , (i − 1)a, (i + 1)a, . . . , (t − 1)a}.
It is in natural (order preserving) bijection with Z −{ia, (i+1)a}. Hence ι1 induces
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                         77

ι′ ∈ Invr (Z ′ ). By the induction hypothesis we have c(Z̃ ′ , ι′ ) ∈ Con(Wn−k ). Hence
sgnk ⊠ c(Z̃ ′ , ι′ ) ∈ Con(Sk × Wn−k ) where sgnk is as in (A). Using 22.17, we have
                            jW                    ′ ′
                             Sk ×Wn−k (sgnk ⊠ c(Z̃ , ι )) = c(Z̃, ι)

hence c(Z̃, ι) ∈ Con(W ). This proves (a).
   We prove (b) by induction on n. If n = 0 the result is clear. Assume now
that n ≥ 1. By an argument like the ones used in (B) we see that the class of
representations of W obtained in (a) is closed under ⊗sgn. Therefore, to show
that C ∈ Con(W ) is obtained in (a), we may assume that C = jW              ′
                                                                Sk ×Wn−k (C ) for
some k > 0 and some C ′ ∈ Con(Sk × Wn−k ). By 22.5 we have C ′ = E ⊠ C ′′
where E is a simple Sk -module and C ′′ ∈ Con(Wn−k ). Using 22.5(a) we have
E = jS                  ′         ′   ′′     ′         ′
      Sk′ ×Sk′′ (sgn ⊠ E ) where k + k = k, k > 0 and E is a simple Sk′′ -module.
       k

            W     ′
Let C̃ = jSkn−k
             ′′ ×Wn−k
                      (E ′ ⊗ C ′ ) ∈ Con(Wn−k′ ). Then C = jW
                                                            Sk′ ×Wn−k′ (sgnk′ ⊗ C̃).
By the induction hypothesis, C̃ is of the form described in (a). Using an argument
as in (A) or (C) we deduce that C is of the form described in (a). The proposition
is proved.
Proposition 22.25. Assume that b′ > 0.
  (a) Let E ∈ IrrW . Then E ∈ Con(W ).
  (b) All constructible representations of W are obtained as in (a).
     We prove (a). We may assume that E = [Λ] where Λ ∈ SyN                      a,b;n does not contain
                ′
both 0 and b . We argue by induction on n. If n = 0 the result is clear. Assume
now that n ≥ 1.
     (A) Assume that either (1) there exist two entries z, z ′ of Λ such that z ′ − z > a
and there is no entry z ′′ of Λ such that z < z ′′ < z ′ , or (2) there exists an
entry z ′ of Λ such that z ′ ≥ a and there is no entry z ′′ of Λ such that z ′′ <
z ′ . Let Λ′ be the symbol obtained from Λ by substracting a from each entry
z̃ of Λ such that z̃ ≥ z ′ and leaving the other entries of Λ unchanged. Then
Λ′ ∈ SyN  a,b;n−k with n − k < n. By the induction hypothesis, [Λ ] ∈ Con(Wn−k ).
                                                                                      ′

Since, by 22.5, the sign representation sgnk of Sk is constructible, it follows that
sgnk ⊠ [Λ′ ] ∈ Con(Sk × Wn−k ). Using 22.17, we have jW                                        ′
                                                                         Sk ×Wn−k (sgnk ⊠ [Λ ]) = [Λ]
hence [Λ] ∈ Con(W ).
     (B) Assume that there exist two entries z, z ′ of Λ such that 0 < z ′ − z < a. Let
t be the smallest integer such that at + b′ ≥ λi for all i ∈ [1, N + r] and at ≥ µj
                                    t+1−N−r
for all j ∈ [1, N ]. Let Λ̄ ∈ Sya,b;n           be as in 22.8 with respect to this t. Then Λ̄
                                     ′
does not contain both 0 and b . Now (A) is applicable to Λ̄. Hence [Λ̄] ∈ Con(W ).
By 22.18 we have [Λ̄] ⊗ sgn = [Λ] hence [Λ] ∈ Con(W ).
     (C) Assume that we are not in case (A) and not in case (B). Then the entries
of Λ are either 0, a, 2a, . . . , ta or b′ , a + b′ , 2a + b′ , . . . , ta + b′ . This cannot happen
for n ≥ 1. This proves (a).
     The proof of (b) is entirely similar to that of 22.24(b). The proposition is
proved.
78                                        G. LUSZTIG

22.26. We now assume that n ≥ 2 and that W ′ = Wn′ is the kernel of χn : Wn −          →
                               ′
±1 in 22.10. We regard Wn as a Coxeter group with generators s1 , s2 , . . . , sn−1 as
in 22.9 and s′n = (n−1, n′ )((n−1)′ , n) (product of transpositions). Let L : W ′ − →N
be the weight function given by L(w) = al(w) for all w. Here a > 0.
   For Λ ∈ SyN   a,0 we denote by Λ
                                       tr
                                          the symbol whose ﬁrst (resp. second) row is
the second (resp. ﬁrst) row of Λ. We then have Λtr ∈ SyN        a,0 . From the deﬁnitions
we see that the simple Wn -modules [Λ], [Λtr ] have the same restriction to W ′ ;
this restriction is a simple W ′ -module [Λ] if Λ 6= Λtr and is a direct sum of two
non-isomorphic simple W ′ -modules [I Λ],[II Λ] if Λ = Λtr . In this way we see that
   the simple W ′ -modules are naturally in bijection with the set of orbits of the
involution of Sya,0;n induced by Λ 7→ Λtr except that each fixed point of this invo-
lution corresponds to two simple W ′ -modules.
   Let Z̃ ∈ MN    a,0;n . Let Z be the set of singles of Z̃. Assume ﬁrst that Z 6= ∅.
Each set Y ∈ Z 0 gives rise to a symbol ΛY in SyN     a,0;n : the ﬁrst row of ΛY consists
of Z − Y and one of each double of Z̃; the second row consists of Y and one of
each double of Z̃. For any ι ∈ Inv0 (Z) we deﬁne c(Z̃, ι) ∈ ModW by
   c(Z̃, ι) ⊕ c(Z̃, ι) = ⊕Y ∈Sι [ΛY ] ∈ ModW .
Note that Y and Z − Y have the same contribution to the sum. A proof entirely
similar to that of 22.24 shows that c(Z̃, ι) ∈ Con(W ). Moreover, if Z = ∅ and Λ =
                                                  I ]
Λtr ∈ SyN                                                                II
          a,1;n is deﬁned by πN (Λ) = Z̃, then [ Λ ∈ Con(W ) and [ Λ] ∈ Con(W ).
All constructible representations of W are obtained in this way.
22.27. Assume that W is of type F4 and that the values of L : W −             → N on S are
a, a, b, b where a > b > 0.
   Case 1. Assume that a = 2b. There are four simple W -modules ρ1 , ρ2 , ρ8 , ρ9
(subscript equals dimension) with a = 3b. Then
   ρ1 ⊕ ρ2 , ρ1 ⊕ ρ8 , ρ2 ⊕ ρ9 , ρ8 ⊕ ρ9 ∈ Con(W ).
(They are obtained by j from the WI of type B3 with parameters a, b, b.)
   The simple W -modules ρ†1 , ρ†2 , ρ†8 , ρ†9 have a = 15b and
   ρ†1 ⊕ ρ†2 , ρ†1 ⊕ ρ†8 , ρ†2 ⊕ ρ†9 , ρ†8 ⊕ ρ†9 ∈ Con(W ).
There are ﬁve simple W -modules ρ12 , ρ16 , ρ6 , ρ′6 , ρ4 (subscript equals dimension)
with a = 7b. Then
   ρ4 ⊕ ρ16 , ρ12 ⊕ ρ16 ⊕ ρ6 , ρ12 ⊕ ρ16 ⊕ ρ′6 ∈ Con(W ).
All 12 simple W -modules other than the 13 listed above, are constructible. All
constructible representations of W are thus obtained.
   Case 2. Assume that a ∈            / {b, 2b}. The simple W -modules ρ12 , ρ16 , ρ6 , ρ′6 , ρ4 in
Case 1 now have a = 3a + b and
   ρ4 ⊕ ρ16 , ρ12 ⊕ ρ16 ⊕ ρ6 , ρ12 ⊕ ρ16 ⊕ ρ′6 ∈ Con(W ).
All 20 simple W -modules other than the 5 listed above, are constructible. All
constructible representations of W are thus obtained.
22.28. Assume that W is of type G2 and that the values of L : W −      → N on S
                                    ′
are a, b where a > b > 0. Let ρ2 , ρ2 be the two 2-dimensional simple W -modules.
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                            79

They have a = a and ρ2 ⊕ ρ′2 is constructible. All 4 simple W -modules other than
the 2 listed above, are constructible. All constructible representations of W are
thus obtained.

                               23. Two-sided cells
23.1. We deﬁne a graph GW as follows. The vertices of GW are the simple W -
modules up to isomorphism. Two non-isomorphic simple W -modules are joined in
GW if they both appear as components of some constructible representation of W .
Let GW / ∼ be the set of connected components of GW . The connected components
of G/ ∼ are determined explicitly by the results in §22 for W irreducible.
   For example, in the setup of 22.4,22.5 we have GW = GW / ∼. In the setup of
22.24, GW / ∼ is naturally in bijection with Ma,b;n . (Here, 22.22 is used). In the
setup of 22.25, we have GW = GW / ∼.
   We show that:
   (a) if E, E ′ are in the same connected component of GW then E ∼LR E ′ .
We may assume that both E, E ′ appear in some constructible representation of
W . By 22.2, there exists a left cell Γ such that [E : [Γ]] 6= 0, [E ′ : [Γ]] 6= 0. By
                        Γ           ′    Γ
21.2, we have [E♠ : JC    ] 6= 0, [E♠ : JC ] 6= 0. Hence E ∼LR E ′ , as desired.
23.2. Let cW be the set of two-sided cells of W, L. Consider the (surjective) map
IrrW − → cW which to E associates the two-sided cell c such that E ∼LR x for
x ∈ c. From 23.1 we see that this map induces a (surjective) map
   (a) ωW : GW / ∼−
                  → cW .
We conjecture that ωW is a bijection. This is made plausible by:
Proposition 23.3. Assume that W, L is split. Then ωW is a bijection.
    Let E, E ′ ∈ IrrW be such that E ∼LR E ′ . By 22.3, we can ﬁnd constructible
representations C, C ′ such that [E : C] 6= 0, [E ′ : C ′ ] 6= 0. By 22.2, we can ﬁnd
left cells Γ, Γ′ such that C = [Γ], C ′ = [Γ′ ]. Then [E : [Γ]] 6= 0, [E ′ : [Γ′ ]] 6= 0.
Let d ∈ D ∩ Γ, d′ ∈ D ∩ Γ′ . Since γd = [Γ] and [E : [Γ] 6= 0, we have E ∼LR d.
Similarly, E ′ ∼LR d′ . Hence d′ ∼LR d′ . By 18.4(c), there exists u ∈ W such that
td tu td′ 6= 0. (Here we use the splitness assumption.) Note that j 7→ jtu td′ is a
                    Γ     Γ′
JC -linear map JC     −
                      → JC   . This map is non-zero since it takes td to td tu td′ 6= 0.
                       Γ′
                   Γ
Thus, HomJC (JC , JC ) 6= 0. Using 21.2, we deduce that HomW ([Γ], [Γ′ ]) 6= 0.
Hence there exists Ẽ ∈ IrrW such that Ẽ is a component of both [Γ] = C and
[Γ′ ] = C ′ . Thus, both E, Ẽ appear in C and both Ẽ, E ′ appear in C ′ . Hence E, E ′
are in the same connected component of GW . The proposition is proved.
23.4. Assume now that W, L is quasisplit, associated as in 16.2 to W̃ and the
automorphism σ : W̃ −→ W̃ with W̃ ﬁnite, irreducible.
  Let cW̃ be the set of all σ-stable two-sided cells of W̃ . Let c♯W̃ be the set of all
       !

two-sided cells of W̃ which meet W . We have c♯W̃ ⊂ c!W̃ ⊂ cW̃ . Let f : cW −
                                                                            → c♯W̃
be the map which attaches to a two-sided cell of W the unique two-sided cell of
W̃ containing it; this map is well deﬁned by 16.13(a) and is obviously surjective.
80                                     G. LUSZTIG

                                                                     → c♯W̃ is
Proposition 23.5. In the setup of 23.4, ωW is a bijection and f : cW −
a bijection.
   Since ωW , f are surjective, the composition f ωW : GW / ∼−→ c♯W̃ is surjective.
Hence it is enough to show that this composition is injective. For this it suﬃces
to check one of the two statements below:
   (a) |GW / ∼ | = |c♯W̃ |;
                                     f ωW                  f′
   (b) the composition GW / ∼−−−→ c♯W̃ ⊂ cW̃ −→ N ⊕ N (where f ′ (c) =
(a(x), a(xw0 )) for x ∈ c) is injective.
Note that the value of the composition (b) at E is (aE , aE † ).
   Case 1. W is of type G2 and W̃ is of type D4 . Then (b) holds: the composi-
tion (b) takes distinct values (0, 12), (1, 7), (3, 3), (7, 1), (12, 0) on the 5 elements of
GW / ∼.
   Case 2. W is of type F4 and W̃ is of type E6 . Then again (b) holds.
   Case 3. W is of type Bn with n ≥ 2 and W̃ is of type A2n or A2n+1 . Then σ
is conjugation by the longest element w̃0 of W̃ . We show that (a) holds.
   Let Y be the set of all E ∈ IrrW̃ (up to isomorphism) such that tr(w̃0 , E) 6= 0.
Let Y ′ be the set of all E ′ ∈ IrrW (up to isomorphism). By 23.4 and 23.1 we have
a natural bijection between cW̃ and the set of isomorphism classes of E ∈ IrrW̃ .
If c ∈ cW̃ corresponds to E, then the number of ﬁxed points of σ on c is clearly
± dim(E)tr(w̃0 , E). Hence |c♯W̃ | = |Y |. From 23.1 we have |GW / ∼ | = |Y |. Hence
to show (a) it suﬃces to show that |Y | = |Y ′ |. But this is shown in [L2].
   Case 4. Assume that W̃ is of type Dn and W is of type Bn−1 with n ≥ 3. We
will show that (a) holds. We change notation and write W ′ instead of W̃ , W ′σ
instead of W . Then W ′ is as in 22.26 and we may assume that σ : W ′ −             → W ′ is
                                                N,!
conjugation by sn (as in 22.26). Let M1,0;n be the set of all elements in MN           1,0;n
whose set of singles is non-empty. Let
   M!1,0;n = limN→∞ MN,!       1,0;n .
                          !
By 22.26 and 23.3, cW ′ is naturally in bijection with M!1,0;n . By 23.1, GW ′ σ / ∼
is naturally in bijection with M1,2;n−1 . The identity map is clearly a bijection
             ∼     N+1,!                                        ∼
MN 1,2;n−1 − → M1,0;n      . It induces a bijection M1,2;n−1 −→ M!1,0;n . Hence to prove
|GW ′ σ / ∼ | ≤ |c♯W ′ | it suﬃces to prove that |M!1,0;n| = |M♯1,0;n |. In other words,
we must show that
   (c) any σ-stable two-sided cell of W ′ meets W ′σ .
Now 26.26 and 23.3 provide an inductive procedure to obtain any σ-stable two-
sided cell of W ′ . Namely such a cell is obtained by one of two procedures:
   (i) we consider a σ-stable two-sided cell in a parabolic subgroup of type Sk ×
Dn−k (where n − k ∈ [2, n − 1]) and we attach to it the unique two-sided cell of
W ′ that contains it;
   (ii) we take a two-sided cell obtained in (i) and multiply it on the right by the
longest element of W ′ .
Since we may assume that (c) holds when n is replaced by n − k ∈ [2, n − 1], we
        LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                          81

see that the procedures (i) and (ii) yield only two-sided cells that contain σ-ﬁxed
elements. This proves (c). The proposition is proved.

                                24. Virtual cells
24.1. In this section we preserve the setup of 20.1.
   A virtual cell of W (with respect to L : W −
                                              → N) is an element of K(W ) of the
form γx for some x ∈ W .
Lemma 24.2. Let x ∈ W and let Γ be the left cell containing x.
  (a) If γx 6= 0 then x ∈ Γ ∩ Γ−1 .
  (b) γx is a C-linear combination of E ∈ IrrW such that [E : [Γ]] 6= 0.
    Assume that γx 6= 0. Then there exists E ∈ IrrJC such that tr(tx , E) 6= 0. We
have E = ⊕d∈D td E and tx : E − → E maps the summand td E (where x ∼L d) into
td′ , where d′ ∼L x−1 and all other summands to 0. Since tr(tx , E) 6= 0, we must
                  6 0 hence d = d′ and x ∼L x−1 . This proves (a).
have td E = td′ E =
    We prove (b). Let d ∈ D ∩ Γ. Assume that E ∈ IrrW appears with 6= 0
coeﬃcient in γx . Then tr(tx , E♠ ) 6= 0. As we have seen in the proof of (a), we
                                                     Γ
have td E♠ 6= 0. Using 21.3,21.2, we deduce [E♠ : JC   ] 6= 0 and [E♠ : [Γ]♠ ] 6= 0.
Hence [E : [Γ]] 6= 0. The lemma is proved.
24.3. In the remainder of this section we will give a number of expicit computa-
tions of virtual cells.
Lemma 24.4.P In the setup of 22.10, w0 acts on [Λ] as multiplication by
                  −1
  ǫ[Λ] = (−1) j (a µj −j+1) .
   Using the deﬁnitions we are reduced to the case where k = n or l = n. If k = n
we have ǫ[Λ] = 1 since [Λ] factors through Sn and the longest element of Wn is
in the kernel of Wn −→ Sn . Similarly, if l = n we have ǫ[Λ] = ǫχn = (−1)n . The
lemma is proved.
Proposition 24.5. Assume that we are in the setup of 22.23. Let ι ∈ Invr (Z) and
           → F2 be an affine-linear function. Let c(Z̃, ι, κ) = Y ∈Sι (−1)κ(Y ) [ΛY ] ∈
                                                               P
let κ : Sι −
K(W ). There exists x ∈ W such that γx = ±c(Z̃, ι, κ).
   To some extent the proof is a repetition of the proof of 22.24(a), but we have
to keep track of κ, a complicating factor.
   We argue by induction on the rank n of Z̃. If n = 0 the result is clear. Assume
now that n ≥ 1. We may assume that 0 is not a double of Z̃. Let at be the largest
entry of Z̃.
   (A) Assume that there exists i, 0 ≤ i < t, such that ai does not appear in Z̃.
Then Z̃ is obtained from a multiset Z̃ ′ of rank n − k < n by increasing each of the
k largest entries by a and this set of largest entries is unambiguously deﬁned. The
set Z ′ of singles of Z̃ ′ is naturally in bijection with Z.
82                                           G. LUSZTIG

   Let ι′ , κ′ correspond to ι, κ under this bijection. By the induction hypothesis,
                                     W
there exists x′ ∈ Wn−k such that γx′ n−k = ±c(Z̃ ′ , ι′ , κ′ )] ∈ K(Wn−k ). Let w0,k be
the longest element of Sk . Then

                         S ×W
                          k      n−k    Sk        W               W
                        γw0,k x′     = γw 0,k
                                              ⊠ γx′ n−k = sgnk ⊠ γx′ n−k

and

      W           W           S ×W
                              k      n−k
     γw 0,k x
             ′ = jS ×W
                   k   n−k
                           (γw0,k x′     )
                               W
     = jW
        Sk ×Wn−k (sgnk ⊠ γx′
                             n−k
                                 ) = ±jW                    ′ ′     ′
                                       Sk ×Wn−k (sgnk ⊠ c(Z̃ , ι , κ )) = ±c(Z̃, ι, κ),


as required.
   (B) Assume that there exists i, 0 < i ≤ t such that ai is a double of Z̃. Let Z̃     ¯
be as in 22.8 (with respect to our t). Then 0 is not a double of Z̃     ¯ and the largest
          ¯ is at. Let Z̄ be the set of singles of Z̃.
entry of Z̃                                            ¯ We have Z̄ = {at − z|z ∈ Z}.
Thus Z̄, Z are naturally in (order reversing) bijection under j 7→ at − j. Let
ι′ ∈ Invr (Z̄) correspond to ι this bijection and let κ′ : Sι′ −  → F2 correspond    to κ
under this bijection. Let κ′′ : Sι′ −   → F2 be given by κ′′ (Y ) = κ′ (Y ) + y∈Y a−1 y
                                                                             P

(an aﬃne-linear function). Since at − ai does not appear in Z̃,     ¯ (A) is applicable
    ¯ Hence there exists x′ ∈ W such that
to Z̃.
   γ ′ = ±c(Z̃,¯ ι′ , κ′′ ). By 20.23, 22.18, 24.4, we have
      x

                ′                 ¯ ι′ , κ′′ )) ⊗ sgn = ±c(Z̃,
γx′ w0 = (−1)l(x ) ζ(γx′ ) = ±ζ(c(Z̃,                      ¯ ι′ , κ′ ) ⊗ sgn = ±c(Z̃, ι, κ),

as desired.
    (C) Assume that we are not in case (A) and not in case (B). Then Z̃ =
{0, a, 2a, . . . , ta} = Z. We can ﬁnd ia, (i + 1)a in Z such that ι interchanges
ia, (i + 1)a and induces on Z − {ia, (i + 1)a} an r-admissible involution ι1 .
    (C1) Assume ﬁrst that κ(Y ) = κ(Y ∗ {ia, (i + 1)a}) for any Y ∈ Sι . (∗ is
symmetric diﬀerence.) Let
    Z̃ ′ = {0, a, 2a, . . . , ia, ia, (i + 1)a, (i + 2)a, . . . , (t − 1)a}.
This has rank n − k < n. The set of singles of Z̃ ′ is
    Z ′ = {0, a, 2a, . . . , (i − 1)a, (i + 1)a, . . . , (t − 1)a}.
It is in natural (order preserving) bijection with Z −{ia, (i+1)a}. Hence ι1 induces
ι′ ∈ Invr (Z ′ ). We have an obvious surjective map of aﬃne spaces p : Sι −    → Sι′
and κ is constant on the ﬁbres of this map. Hence there is an aﬃne-linear map
κ′ : Sι′ −  → F2 such that κ = κ′ p. By the induction hypothesis, there exists
                                W
x′ ∈ Wn−k such that γx′ n−k = ±c(Z̃ ′ , ι′ , κ′ ) ∈ K(Wn−k ). Let w0,k be the longest
element of Sk . Then
                         S ×W
                          k      n−k    Sk        W               W
                        γw0,k x′     = γw 0,k
                                              ⊠ γx′ n−k = sgnk ⊠ γx′ n−k
         LECTURES ON HECKE ALGEBRAS WITH UNEQUAL PARAMETERS                                    83

and
   W           W           k S ×W n−k
  γw 0,k x
          ′ = jS ×W
                k   n−k
                        (γw0,k x′     )
                             W
   = jW
      Sk ×Wn−k (sgnk ⊠ γx′
                           n−k
                               ) = ±jW                    ′ ′     ′
                                     Sk ×Wn−k (sgnk ⊠ c(Z̃ , ι , κ )) = ±c(Z̃, ι, κ),


as required.
   (C2) Assume next that κ(Y ) 6= κ(Y ∗ {ia, (i + 1)a}) for some (or equivalently
any) Y ∈ Sι . We have

      ¯ = {0, 0, a, a, 2a, 2a, . . . , ta, ta} − {at − 0, at − a, . . . , at − at} = Z̃ = Z.
      Z̃

Let ι′ ∈ Invr (Z) correspond to ι under the bijection z 7→ ta − z of Z with itself; let
κ′ : Sι′ −
         → F2 correspond    to κ under this bijection. Let κ′′ : Sι′ − → F2 be given by
κ (Y ) = κ (Y ) + y∈Y a y (an aﬃne-linear function). Note that ι′ interchanges
  ′′       ′                −1
                   P

(t − i − 1)a, (t − i)a and induces on Z − {(t − i − 1)a, (t − i)a} an r-admissible
involution. We show that for any Y ∈ Sι′ we have κ′′ (Y ) = κ′′ (Y ∗{(t−i−1)a, (t−
i)a}) or equivalently κ′ (Y ) = κ′ (Y ∗ {(t − i − 1)a, (t − i)a}) + 1. This follows from
our assumption κ(Y ) = κ(Y ∗ {ia, (i + 1)a}) + 1 for any Y ∈ Sι . We see that case
(C1) applies to ι′ , κ′′ so that there exists x′ ∈ W with γx′ = ±c(Z̃, ι′ , κ′′ ). By
20.23, 22.18, 24.4, we have
                ′                 ¯ ι′ , κ′′ )) ⊗ sgn = ±c(Z̃,
γx′ w0 = (−1)l(x ) ζ(γx′ ) = ±ζ(c(Z̃,                      ¯ ι′ , κ′ ) ⊗ sgn = ±c(Z̃, ι, κ),

as desired. The proposition is proved.
24.6. Assume that we are in the setup of 22.27. By 22.27,
   ρ4 + ρ16 , ρ12 + ρ16 + ρ6 , ρ12 + ρ16 + ρ′6
are constructible, hence (by 22.2, 21.4) are of the form nd γd for suitable d ∈ D,
hence are ± virtual cells.
   Let d ∈ D be such that nd γd = ρ12 + ρ16 + ρ6 . Let Γ be the left cell such that
d ∈ Γ. Recall (21.4) that [Γ] = A ⊕ B ⊕ C where A = ρ12 , B = ρ16 , C = ρ6 . By
                                          Γ∩Γ−1
the discussion in 21.10 we see that JC           has exactly three simple modules (up
to isomorphism), namely td A♠ , td B♠ , td C♠ , and these are 1-dimensional. Since
       −1
J Γ∩Γ is a semisimple algebra (21.9), it follows that it is commutative of dimen-
sion 3. Hence Γ ∩ Γ−1 consists of three elements d, x, y. Let pA , pB , pC denote the
traces of tx on A♠ , B♠ , C♠ respectively. Let qA , qB , qC denote the traces of ty on
A♠ , B♠ , C♠ respectively. By 20.24, pA , pB , pC , qA , qB , qC are integers. Recall that
the traces of nd td on A♠ , B♠ , C♠ are 1, 1, 1 respectively. Since fA♠ , fB♠ , fC♠ are
6, 2, 3 we see that the orthogonality formula 21.10 gives
    1 + p2A + qA
               2
                  = 6, 1 + p2B + qB2
                                     = 2, 1 + p2C + qC
                                                     2
                                                        = 3,
   1 + pA pB + qA qB = 0, 1 + pA pC + qA qC = 0, 1 + pB pC + qB qC = 0.
Solving these equations with integer unknowns we see that there exist ǫ, ǫ′ ∈
{1, −1} so that (up to interchanging x, y) we have
84                                       G. LUSZTIG

   (pA , qA ) = (2ǫ, ǫ′ ), (pB , qB ) = (0, −ǫ′ ), (pC , qC ) = (−ǫ, ǫ′ ).
Then ǫγx = 2ρ12 − ρ6 , ǫ′ γy = ρ12 − ρ16 + ρ6 . Hence
   2ρ12 − ρ6 , ρ12 − ρ16 + ρ6 are ± virtual cells.
Exactly the same argument shows that
   2ρ12 − ρ6′ , ρ12 − ρ16 + ρ6′ are ± virtual cells.
A similar (but simpler) argument shows that
   ρ4 − ρ16 is ± a virtual cell.
Assume now that we are in the setup of 22.27 (Case 1). By 22.27,
   ρ1 + ρ2 , ρ1 + ρ8 , ρ2 + ρ9 , ρ8 + ρ9 , ρ†1 + ρ†2 , ρ†1 + ρ†8 , ρ†2 + ρ†9 , ρ†8 + ρ†9 ,
are constructible, hence by 22.2, 21.4 are of the form nd γd for suitable d ∈ D,
hence are ± virtual cells. By an argument similar to that above (but simpler) we
see that
   ρ1 − ρ2 , ρ1 − ρ8 , ρ2 − ρ9 , ρ8 − ρ9 , ρ†1 − ρ†2 , ρ†1 − ρ†8 , ρ†2 − ρ†9 , ρ†8 − ρ†9 ,
are ± virtual cells.
24.7. Assume that we are in the setup of 22.29. By 22.29, ρ2 + ρ′2 is constructible,
hence by 22.2, 21.4, is of the form nd γd for some d ∈ D, hence is ± a virtual cell.
As in 24.6, we see that ρ2 − ρ′2 is ± a virtual cell.

                                        References
[B] N.Bourbaki, Groupes et algèbres de Lie, Ch. 4,5,6, Hermann, Paris, 1968.
[Br] K.Bremke, Kazhdan-Lusztig polynomials and cells for affine Weyl groups and unequal pa-
     rameters, Thesis, M.I.T. (1996).
[Ho] P.N.Hoefsmit, Representations of Hecke algebras of finite groups with BN-pairs of classical
     type, Thesis, Univ. of British Columbia, Vancouver (1994).
[KL] D.Kazhdan and G.Lusztig, Representations of Coxeter groups and Hecke algebras, Invent.
     Math. 53 (1979), 165-184.
[L1] G.Lusztig, Unipotent characters of the Symplectic and odd orthogonal groups over a finite
     field, Invent.Math. 64 (1981), 263-296.
[L2] G.Lusztig, Left cells in Weyl groups, Lie group representations, I, Lecture Notes in Math.,
     vol. 1024, Springer Verlag, 1983, pp. 99-111.
[L3] G.Lusztig, Cells in affine Weyl groups, Algebraic groups and related topics, Adv.Stud.Pure
     Math. 6, North-Holland and Kinokuniya, Tokyo and Amsterdam, 1985, pp. 255-287.
[L4] G.Lusztig, Cells in affine Weyl groups, II, J.Algebra 109 (1987), 536-548.
[L5] G.Lusztig, Leading coefficients of character values of Hecke algebras, Proc. Symp.Pure
     Math. 47 (1987), 235-262.
